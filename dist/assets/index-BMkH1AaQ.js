(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Lh(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const Qt={},Yl=[],Vs=()=>{},FD=()=>!1,Nd=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),s1=t=>t.startsWith("onUpdate:"),xr=Object.assign,a1=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},ND=Object.prototype.hasOwnProperty,ur=(t,e)=>ND.call(t,e),ut=Array.isArray,Ql=t=>Rc(t)==="[object Map]",ol=t=>Rc(t)==="[object Set]",cE=t=>Rc(t)==="[object Date]",OD=t=>Rc(t)==="[object RegExp]",At=t=>typeof t=="function",Ar=t=>typeof t=="string",pa=t=>typeof t=="symbol",gr=t=>t!==null&&typeof t=="object",i1=t=>(gr(t)||At(t))&&At(t.then)&&At(t.catch),GS=Object.prototype.toString,Rc=t=>GS.call(t),MD=t=>Rc(t).slice(8,-1),Bh=t=>Rc(t)==="[object Object]",o1=t=>Ar(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Jl=Lh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Uh=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},LD=/-(\w)/g,Cn=Uh(t=>t.replace(LD,(e,r)=>r?r.toUpperCase():"")),BD=/\B([A-Z])/g,xs=Uh(t=>t.replace(BD,"-$1").toLowerCase()),Od=Uh(t=>t.charAt(0).toUpperCase()+t.slice(1)),Iu=Uh(t=>t?`on${Od(t)}`:""),is=(t,e)=>!Object.is(t,e),Zl=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},Mg=(t,e,r,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:r})},N0=t=>{const e=parseFloat(t);return isNaN(e)?t:e},O0=t=>{const e=Ar(t)?Number(t):NaN;return isNaN(e)?t:e};let uE;const $h=()=>uE||(uE=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),UD="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",$D=Lh(UD);function Nr(t){if(ut(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],s=Ar(n)?GD(n):Nr(n);if(s)for(const i in s)e[i]=s[i]}return e}else if(Ar(t)||gr(t))return t}const VD=/;(?![^(]*\))/g,HD=/:([^]+)/,jD=/\/\*[^]*?\*\//g;function GD(t){const e={};return t.replace(jD,"").split(VD).forEach(r=>{if(r){const n=r.split(HD);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Qe(t){let e="";if(Ar(t))e=t;else if(ut(t))for(let r=0;r<t.length;r++){const n=Qe(t[r]);n&&(e+=n+" ")}else if(gr(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}function WD(t){if(!t)return null;let{class:e,style:r}=t;return e&&!Ar(e)&&(t.class=Qe(e)),r&&(t.style=Nr(r)),t}const zD="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",KD=Lh(zD);function WS(t){return!!t||t===""}function qD(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=io(t[n],e[n]);return r}function io(t,e){if(t===e)return!0;let r=cE(t),n=cE(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=pa(t),n=pa(e),r||n)return t===e;if(r=ut(t),n=ut(e),r||n)return r&&n?qD(t,e):!1;if(r=gr(t),n=gr(e),r||n){if(!r||!n)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const a in t){const o=t.hasOwnProperty(a),l=e.hasOwnProperty(a);if(o&&!l||!o&&l||!io(t[a],e[a]))return!1}}return String(t)===String(e)}function Vh(t,e){return t.findIndex(r=>io(r,e))}const zS=t=>!!(t&&t.__v_isRef===!0),Y=t=>Ar(t)?t:t==null?"":ut(t)||gr(t)&&(t.toString===GS||!At(t.toString))?zS(t)?Y(t.value):JSON.stringify(t,KS,2):String(t),KS=(t,e)=>zS(e)?KS(t,e.value):Ql(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,s],i)=>(r[Xp(n,i)+" =>"]=s,r),{})}:ol(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>Xp(r))}:pa(e)?Xp(e):gr(e)&&!ut(e)&&!Bh(e)?String(e):e,Xp=(t,e="")=>{var r;return pa(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let $n;class l1{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=$n,!e&&$n&&(this.index=($n.scopes||($n.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=$n;try{return $n=this,e()}finally{$n=r}}}on(){++this._on===1&&(this.prevScope=$n,$n=this)}off(){this._on>0&&--this._on===0&&($n=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function c1(t){return new l1(t)}function u1(){return $n}function qS(t,e=!1){$n&&$n.cleanups.push(t)}let _r;const Yp=new WeakSet;class ad{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,$n&&$n.active&&$n.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Yp.has(this)&&(Yp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||YS(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,dE(this),QS(this);const e=_r,r=da;_r=this,da=!0;try{return this.fn()}finally{JS(this),_r=e,da=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)h1(e);this.deps=this.depsTail=void 0,dE(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Yp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Lg(this)&&this.run()}get dirty(){return Lg(this)}}let XS=0,ku,Du;function YS(t,e=!1){if(t.flags|=8,e){t.next=Du,Du=t;return}t.next=ku,ku=t}function d1(){XS++}function f1(){if(--XS>0)return;if(Du){let e=Du;for(Du=void 0;e;){const r=e.next;e.next=void 0,e.flags&=-9,e=r}}let t;for(;ku;){let e=ku;for(ku=void 0;e;){const r=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=r}}if(t)throw t}function QS(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function JS(t){let e,r=t.depsTail,n=r;for(;n;){const s=n.prevDep;n.version===-1?(n===r&&(r=s),h1(n),XD(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}t.deps=e,t.depsTail=r}function Lg(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(ZS(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function ZS(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===id)||(t.globalVersion=id,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Lg(t))))return;t.flags|=2;const e=t.dep,r=_r,n=da;_r=t,da=!0;try{QS(t);const s=t.fn(t._value);(e.version===0||is(s,t._value))&&(t.flags|=128,t._value=s,e.version++)}catch(s){throw e.version++,s}finally{_r=r,da=n,JS(t),t.flags&=-3}}function h1(t,e=!1){const{dep:r,prevSub:n,nextSub:s}=t;if(n&&(n.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=n,t.nextSub=void 0),r.subs===t&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)h1(i,!0)}!e&&!--r.sc&&r.map&&r.map.delete(r.key)}function XD(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}function YD(t,e){t.effect instanceof ad&&(t=t.effect.fn);const r=new ad(t);e&&xr(r,e);try{r.run()}catch(s){throw r.stop(),s}const n=r.run.bind(r);return n.effect=r,n}function QD(t){t.effect.stop()}let da=!0;const eA=[];function mi(){eA.push(da),da=!1}function gi(){const t=eA.pop();da=t===void 0?!0:t}function dE(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=_r;_r=void 0;try{e()}finally{_r=r}}}let id=0,JD=class{constructor(e,r){this.sub=e,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Hh{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!_r||!da||_r===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==_r)r=this.activeLink=new JD(_r,this),_r.deps?(r.prevDep=_r.depsTail,_r.depsTail.nextDep=r,_r.depsTail=r):_r.deps=_r.depsTail=r,tA(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=_r.depsTail,r.nextDep=void 0,_r.depsTail.nextDep=r,_r.depsTail=r,_r.deps===r&&(_r.deps=n)}return r}trigger(e){this.version++,id++,this.notify(e)}notify(e){d1();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{f1()}}}function tA(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)tA(n)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}}const M0=new WeakMap,Uo=Symbol(""),Bg=Symbol(""),od=Symbol("");function jn(t,e,r){if(da&&_r){let n=M0.get(t);n||M0.set(t,n=new Map);let s=n.get(r);s||(n.set(r,s=new Hh),s.map=n,s.key=r),s.track()}}function Ja(t,e,r,n,s,i){const a=M0.get(t);if(!a){id++;return}const o=l=>{l&&l.trigger()};if(d1(),e==="clear")a.forEach(o);else{const l=ut(t),c=l&&o1(r);if(l&&r==="length"){const u=Number(n);a.forEach((f,h)=>{(h==="length"||h===od||!pa(h)&&h>=u)&&o(f)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),c&&o(a.get(od)),e){case"add":l?c&&o(a.get("length")):(o(a.get(Uo)),Ql(t)&&o(a.get(Bg)));break;case"delete":l||(o(a.get(Uo)),Ql(t)&&o(a.get(Bg)));break;case"set":Ql(t)&&o(a.get(Uo));break}}f1()}function ZD(t,e){const r=M0.get(t);return r&&r.get(e)}function Il(t){const e=Xt(t);return e===t?e:(jn(e,"iterate",od),ks(t)?e:e.map(Tn))}function jh(t){return jn(t=Xt(t),"iterate",od),t}const e3={__proto__:null,[Symbol.iterator](){return Qp(this,Symbol.iterator,Tn)},concat(...t){return Il(this).concat(...t.map(e=>ut(e)?Il(e):e))},entries(){return Qp(this,"entries",t=>(t[1]=Tn(t[1]),t))},every(t,e){return qa(this,"every",t,e,void 0,arguments)},filter(t,e){return qa(this,"filter",t,e,r=>r.map(Tn),arguments)},find(t,e){return qa(this,"find",t,e,Tn,arguments)},findIndex(t,e){return qa(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return qa(this,"findLast",t,e,Tn,arguments)},findLastIndex(t,e){return qa(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return qa(this,"forEach",t,e,void 0,arguments)},includes(...t){return Jp(this,"includes",t)},indexOf(...t){return Jp(this,"indexOf",t)},join(t){return Il(this).join(t)},lastIndexOf(...t){return Jp(this,"lastIndexOf",t)},map(t,e){return qa(this,"map",t,e,void 0,arguments)},pop(){return eu(this,"pop")},push(...t){return eu(this,"push",t)},reduce(t,...e){return fE(this,"reduce",t,e)},reduceRight(t,...e){return fE(this,"reduceRight",t,e)},shift(){return eu(this,"shift")},some(t,e){return qa(this,"some",t,e,void 0,arguments)},splice(...t){return eu(this,"splice",t)},toReversed(){return Il(this).toReversed()},toSorted(t){return Il(this).toSorted(t)},toSpliced(...t){return Il(this).toSpliced(...t)},unshift(...t){return eu(this,"unshift",t)},values(){return Qp(this,"values",Tn)}};function Qp(t,e,r){const n=jh(t),s=n[e]();return n!==t&&!ks(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=r(i.value)),i}),s}const t3=Array.prototype;function qa(t,e,r,n,s,i){const a=jh(t),o=a!==t&&!ks(t),l=a[e];if(l!==t3[e]){const f=l.apply(t,i);return o?Tn(f):f}let c=r;a!==t&&(o?c=function(f,h){return r.call(this,Tn(f),h,t)}:r.length>2&&(c=function(f,h){return r.call(this,f,h,t)}));const u=l.call(a,c,n);return o&&s?s(u):u}function fE(t,e,r,n){const s=jh(t);let i=r;return s!==t&&(ks(t)?r.length>3&&(i=function(a,o,l){return r.call(this,a,o,l,t)}):i=function(a,o,l){return r.call(this,a,Tn(o),l,t)}),s[e](i,...n)}function Jp(t,e,r){const n=Xt(t);jn(n,"iterate",od);const s=n[e](...r);return(s===-1||s===!1)&&zh(r[0])?(r[0]=Xt(r[0]),n[e](...r)):s}function eu(t,e,r=[]){mi(),d1();const n=Xt(t)[e].apply(t,r);return f1(),gi(),n}const r3=Lh("__proto__,__v_isRef,__isVue"),rA=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(pa));function n3(t){pa(t)||(t=String(t));const e=Xt(this);return jn(e,"has",t),e.hasOwnProperty(t)}class nA{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,n){if(r==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(s?i?cA:lA:i?oA:iA).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=ut(e);if(!s){let l;if(a&&(l=e3[r]))return l;if(r==="hasOwnProperty")return n3}const o=Reflect.get(e,r,Cr(e)?e:n);return(pa(r)?rA.has(r):r3(r))||(s||jn(e,"get",r),i)?o:Cr(o)?a&&o1(r)?o:o.value:gr(o)?s?m1(o):Rs(o):o}}class sA extends nA{constructor(e=!1){super(!1,e)}set(e,r,n,s){let i=e[r];if(!this._isShallow){const l=vi(i);if(!ks(n)&&!vi(n)&&(i=Xt(i),n=Xt(n)),!ut(e)&&Cr(i)&&!Cr(n))return l?!1:(i.value=n,!0)}const a=ut(e)&&o1(r)?Number(r)<e.length:ur(e,r),o=Reflect.set(e,r,n,Cr(e)?e:s);return e===Xt(s)&&(a?is(n,i)&&Ja(e,"set",r,n):Ja(e,"add",r,n)),o}deleteProperty(e,r){const n=ur(e,r);e[r];const s=Reflect.deleteProperty(e,r);return s&&n&&Ja(e,"delete",r,void 0),s}has(e,r){const n=Reflect.has(e,r);return(!pa(r)||!rA.has(r))&&jn(e,"has",r),n}ownKeys(e){return jn(e,"iterate",ut(e)?"length":Uo),Reflect.ownKeys(e)}}class aA extends nA{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const s3=new sA,a3=new aA,i3=new sA(!0),o3=new aA(!0),Ug=t=>t,Tf=t=>Reflect.getPrototypeOf(t);function l3(t,e,r){return function(...n){const s=this.__v_raw,i=Xt(s),a=Ql(i),o=t==="entries"||t===Symbol.iterator&&a,l=t==="keys"&&a,c=s[t](...n),u=r?Ug:e?L0:Tn;return!e&&jn(i,"iterate",l?Bg:Uo),{next(){const{value:f,done:h}=c.next();return h?{value:f,done:h}:{value:o?[u(f[0]),u(f[1])]:u(f),done:h}},[Symbol.iterator](){return this}}}}function wf(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function c3(t,e){const r={get(s){const i=this.__v_raw,a=Xt(i),o=Xt(s);t||(is(s,o)&&jn(a,"get",s),jn(a,"get",o));const{has:l}=Tf(a),c=e?Ug:t?L0:Tn;if(l.call(a,s))return c(i.get(s));if(l.call(a,o))return c(i.get(o));i!==a&&i.get(s)},get size(){const s=this.__v_raw;return!t&&jn(Xt(s),"iterate",Uo),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,a=Xt(i),o=Xt(s);return t||(is(s,o)&&jn(a,"has",s),jn(a,"has",o)),s===o?i.has(s):i.has(s)||i.has(o)},forEach(s,i){const a=this,o=a.__v_raw,l=Xt(o),c=e?Ug:t?L0:Tn;return!t&&jn(l,"iterate",Uo),o.forEach((u,f)=>s.call(i,c(u),c(f),a))}};return xr(r,t?{add:wf("add"),set:wf("set"),delete:wf("delete"),clear:wf("clear")}:{add(s){!e&&!ks(s)&&!vi(s)&&(s=Xt(s));const i=Xt(this);return Tf(i).has.call(i,s)||(i.add(s),Ja(i,"add",s,s)),this},set(s,i){!e&&!ks(i)&&!vi(i)&&(i=Xt(i));const a=Xt(this),{has:o,get:l}=Tf(a);let c=o.call(a,s);c||(s=Xt(s),c=o.call(a,s));const u=l.call(a,s);return a.set(s,i),c?is(i,u)&&Ja(a,"set",s,i):Ja(a,"add",s,i),this},delete(s){const i=Xt(this),{has:a,get:o}=Tf(i);let l=a.call(i,s);l||(s=Xt(s),l=a.call(i,s)),o&&o.call(i,s);const c=i.delete(s);return l&&Ja(i,"delete",s,void 0),c},clear(){const s=Xt(this),i=s.size!==0,a=s.clear();return i&&Ja(s,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(s=>{r[s]=l3(s,t,e)}),r}function Gh(t,e){const r=c3(t,e);return(n,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?n:Reflect.get(ur(r,s)&&s in n?r:n,s,i)}const u3={get:Gh(!1,!1)},d3={get:Gh(!1,!0)},f3={get:Gh(!0,!1)},h3={get:Gh(!0,!0)},iA=new WeakMap,oA=new WeakMap,lA=new WeakMap,cA=new WeakMap;function p3(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function m3(t){return t.__v_skip||!Object.isExtensible(t)?0:p3(MD(t))}function Rs(t){return vi(t)?t:Wh(t,!1,s3,u3,iA)}function p1(t){return Wh(t,!1,i3,d3,oA)}function m1(t){return Wh(t,!0,a3,f3,lA)}function g3(t){return Wh(t,!0,o3,h3,cA)}function Wh(t,e,r,n,s){if(!gr(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=m3(t);if(i===0)return t;const a=s.get(t);if(a)return a;const o=new Proxy(t,i===2?n:r);return s.set(t,o),o}function Pa(t){return vi(t)?Pa(t.__v_raw):!!(t&&t.__v_isReactive)}function vi(t){return!!(t&&t.__v_isReadonly)}function ks(t){return!!(t&&t.__v_isShallow)}function zh(t){return t?!!t.__v_raw:!1}function Xt(t){const e=t&&t.__v_raw;return e?Xt(e):t}function Kh(t){return!ur(t,"__v_skip")&&Object.isExtensible(t)&&Mg(t,"__v_skip",!0),t}const Tn=t=>gr(t)?Rs(t):t,L0=t=>gr(t)?m1(t):t;function Cr(t){return t?t.__v_isRef===!0:!1}function se(t){return uA(t,!1)}function g1(t){return uA(t,!0)}function uA(t,e){return Cr(t)?t:new v3(t,e)}class v3{constructor(e,r){this.dep=new Hh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:Xt(e),this._value=r?e:Tn(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,n=this.__v_isShallow||ks(e)||vi(e);e=n?e:Xt(e),is(e,r)&&(this._rawValue=e,this._value=n?e:Tn(e),this.dep.trigger())}}function y3(t){t.dep&&t.dep.trigger()}function X(t){return Cr(t)?t.value:t}function x3(t){return At(t)?t():X(t)}const E3={get:(t,e,r)=>e==="__v_raw"?t:X(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const s=t[e];return Cr(s)&&!Cr(r)?(s.value=r,!0):Reflect.set(t,e,r,n)}};function v1(t){return Pa(t)?t:new Proxy(t,E3)}class _3{constructor(e){this.__v_isRef=!0,this._value=void 0;const r=this.dep=new Hh,{get:n,set:s}=e(r.track.bind(r),r.trigger.bind(r));this._get=n,this._set=s}get value(){return this._value=this._get()}set value(e){this._set(e)}}function dA(t){return new _3(t)}function fA(t){const e=ut(t)?new Array(t.length):{};for(const r in t)e[r]=hA(t,r);return e}class b3{constructor(e,r,n){this._object=e,this._key=r,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return ZD(Xt(this._object),this._key)}}class S3{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function A3(t,e,r){return Cr(t)?t:At(t)?new S3(t):gr(t)&&arguments.length>1?hA(t,e,r):se(t)}function hA(t,e,r){const n=t[e];return Cr(n)?n:new b3(t,e,r)}class T3{constructor(e,r,n){this.fn=e,this.setter=r,this._value=void 0,this.dep=new Hh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=id-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&_r!==this)return YS(this,!0),!0}get value(){const e=this.dep.track();return ZS(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function w3(t,e,r=!1){let n,s;return At(t)?n=t:(n=t.get,s=t.set),new T3(n,s,r)}const C3={GET:"get",HAS:"has",ITERATE:"iterate"},I3={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},Cf={},B0=new WeakMap;let Hi;function k3(){return Hi}function pA(t,e=!1,r=Hi){if(r){let n=B0.get(r);n||B0.set(r,n=[]),n.push(t)}}function D3(t,e,r=Qt){const{immediate:n,deep:s,once:i,scheduler:a,augmentJob:o,call:l}=r,c=I=>s?I:ks(I)||s===!1||s===0?Za(I,1):Za(I);let u,f,h,p,v=!1,g=!1;if(Cr(t)?(f=()=>t.value,v=ks(t)):Pa(t)?(f=()=>c(t),v=!0):ut(t)?(g=!0,v=t.some(I=>Pa(I)||ks(I)),f=()=>t.map(I=>{if(Cr(I))return I.value;if(Pa(I))return c(I);if(At(I))return l?l(I,2):I()})):At(t)?e?f=l?()=>l(t,2):t:f=()=>{if(h){mi();try{h()}finally{gi()}}const I=Hi;Hi=u;try{return l?l(t,3,[p]):t(p)}finally{Hi=I}}:f=Vs,e&&s){const I=f,D=s===!0?1/0:s;f=()=>Za(I(),D)}const y=u1(),b=()=>{u.stop(),y&&y.active&&a1(y.effects,u)};if(i&&e){const I=e;e=(...D)=>{I(...D),b()}}let E=g?new Array(t.length).fill(Cf):Cf;const x=I=>{if(!(!(u.flags&1)||!u.dirty&&!I))if(e){const D=u.run();if(s||v||(g?D.some((P,w)=>is(P,E[w])):is(D,E))){h&&h();const P=Hi;Hi=u;try{const w=[D,E===Cf?void 0:g&&E[0]===Cf?[]:E,p];E=D,l?l(e,3,w):e(...w)}finally{Hi=P}}}else u.run()};return o&&o(x),u=new ad(f),u.scheduler=a?()=>a(x,!1):x,p=I=>pA(I,!1,u),h=u.onStop=()=>{const I=B0.get(u);if(I){if(l)l(I,4);else for(const D of I)D();B0.delete(u)}},e?n?x(!0):E=u.run():a?a(x.bind(null,!0),!0):u.run(),b.pause=u.pause.bind(u),b.resume=u.resume.bind(u),b.stop=b,b}function Za(t,e=1/0,r){if(e<=0||!gr(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),e--,Cr(t))Za(t.value,e,r);else if(ut(t))for(let n=0;n<t.length;n++)Za(t[n],e,r);else if(ol(t)||Ql(t))t.forEach(n=>{Za(n,e,r)});else if(Bh(t)){for(const n in t)Za(t[n],e,r);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&Za(t[n],e,r)}return t}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const mA=[];function P3(t){mA.push(t)}function R3(){mA.pop()}function F3(t,e){}const N3={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},O3={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function Fc(t,e,r,n){try{return n?t(...n):t()}catch(s){ll(s,e,r)}}function Gs(t,e,r,n){if(At(t)){const s=Fc(t,e,r,n);return s&&i1(s)&&s.catch(i=>{ll(i,e,r)}),s}if(ut(t)){const s=[];for(let i=0;i<t.length;i++)s.push(Gs(t[i],e,r,n));return s}}function ll(t,e,r,n=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||Qt;if(e){let o=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const u=o.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](t,l,c)===!1)return}o=o.parent}if(i){mi(),Fc(i,null,10,[t,l,c]),gi();return}}M3(t,r,s,n,a)}function M3(t,e,r,n=!0,s=!1){if(s)throw t;console.error(t)}const os=[];let Ca=-1;const ec=[];let ji=null,Ll=0;const gA=Promise.resolve();let U0=null;function cl(t){const e=U0||gA;return t?e.then(this?t.bind(this):t):e}function L3(t){let e=Ca+1,r=os.length;for(;e<r;){const n=e+r>>>1,s=os[n],i=cd(s);i<t||i===t&&s.flags&2?e=n+1:r=n}return e}function y1(t){if(!(t.flags&1)){const e=cd(t),r=os[os.length-1];!r||!(t.flags&2)&&e>=cd(r)?os.push(t):os.splice(L3(e),0,t),t.flags|=1,vA()}}function vA(){U0||(U0=gA.then(yA))}function ld(t){ut(t)?ec.push(...t):ji&&t.id===-1?ji.splice(Ll+1,0,t):t.flags&1||(ec.push(t),t.flags|=1),vA()}function hE(t,e,r=Ca+1){for(;r<os.length;r++){const n=os[r];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;os.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function $0(t){if(ec.length){const e=[...new Set(ec)].sort((r,n)=>cd(r)-cd(n));if(ec.length=0,ji){ji.push(...e);return}for(ji=e,Ll=0;Ll<ji.length;Ll++){const r=ji[Ll];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}ji=null,Ll=0}}const cd=t=>t.id==null?t.flags&2?-1:1/0:t.id;function yA(t){try{for(Ca=0;Ca<os.length;Ca++){const e=os[Ca];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Fc(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Ca<os.length;Ca++){const e=os[Ca];e&&(e.flags&=-2)}Ca=-1,os.length=0,$0(),U0=null,(os.length||ec.length)&&yA()}}let Bl,If=[];function xA(t,e){var r,n;Bl=t,Bl?(Bl.enabled=!0,If.forEach(({event:s,args:i})=>Bl.emit(s,...i)),If=[]):typeof window<"u"&&window.HTMLElement&&!((n=(r=window.navigator)==null?void 0:r.userAgent)!=null&&n.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(i=>{xA(i,e)}),setTimeout(()=>{Bl||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,If=[])},3e3)):If=[]}let ln=null,qh=null;function ud(t){const e=ln;return ln=t,qh=t&&t.type.__scopeId||null,e}function B3(t){qh=t}function U3(){qh=null}const $3=t=>Xh;function Xh(t,e=ln,r){if(!e||t._n)return t;const n=(...s)=>{n._d&&Kg(-1);const i=ud(e);let a;try{a=t(...s)}finally{ud(i),n._d&&Kg(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Be(t,e){if(ln===null)return t;const r=Ud(ln),n=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,a,o,l=Qt]=e[s];i&&(At(i)&&(i={mounted:i,updated:i}),i.deep&&Za(a),n.push({dir:i,instance:r,value:a,oldValue:void 0,arg:o,modifiers:l}))}return t}function Ia(t,e,r,n){const s=t.dirs,i=e&&e.dirs;for(let a=0;a<s.length;a++){const o=s[a];i&&(o.oldValue=i[a].value);let l=o.dir[n];l&&(mi(),Gs(l,r,8,[t.el,o,t,e]),gi())}}const EA=Symbol("_vte"),_A=t=>t.__isTeleport,Pu=t=>t&&(t.disabled||t.disabled===""),pE=t=>t&&(t.defer||t.defer===""),mE=t=>typeof SVGElement<"u"&&t instanceof SVGElement,gE=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,$g=(t,e)=>{const r=t&&t.to;return Ar(r)?e?e(r):null:r},bA={name:"Teleport",__isTeleport:!0,process(t,e,r,n,s,i,a,o,l,c){const{mc:u,pc:f,pbc:h,o:{insert:p,querySelector:v,createText:g,createComment:y}}=c,b=Pu(e.props);let{shapeFlag:E,children:x,dynamicChildren:I}=e;if(t==null){const D=e.el=g(""),P=e.anchor=g("");p(D,r,n),p(P,r,n);const w=(m,T)=>{E&16&&(s&&s.isCE&&(s.ce._teleportTarget=m),u(x,m,T,s,i,a,o,l))},S=()=>{const m=e.target=$g(e.props,v),T=SA(m,e,g,p);m&&(a!=="svg"&&mE(m)?a="svg":a!=="mathml"&&gE(m)&&(a="mathml"),b||(w(m,T),f0(e,!1)))};b&&(w(r,P),f0(e,!0)),pE(e.props)?(e.el.__isMounted=!1,sn(()=>{S(),delete e.el.__isMounted},i)):S()}else{if(pE(e.props)&&t.el.__isMounted===!1){sn(()=>{bA.process(t,e,r,n,s,i,a,o,l,c)},i);return}e.el=t.el,e.targetStart=t.targetStart;const D=e.anchor=t.anchor,P=e.target=t.target,w=e.targetAnchor=t.targetAnchor,S=Pu(t.props),m=S?r:P,T=S?D:w;if(a==="svg"||mE(P)?a="svg":(a==="mathml"||gE(P))&&(a="mathml"),I?(h(t.dynamicChildren,I,m,s,i,a,o),D1(t,e,!0)):l||f(t,e,m,T,s,i,a,o,!1),b)S?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):kf(e,r,D,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const _=e.target=$g(e.props,v);_&&kf(e,_,null,c,0)}else S&&kf(e,P,w,c,1);f0(e,b)}},remove(t,e,r,{um:n,o:{remove:s}},i){const{shapeFlag:a,children:o,anchor:l,targetStart:c,targetAnchor:u,target:f,props:h}=t;if(f&&(s(c),s(u)),i&&s(l),a&16){const p=i||!Pu(h);for(let v=0;v<o.length;v++){const g=o[v];n(g,e,r,p,!!g.dynamicChildren)}}},move:kf,hydrate:V3};function kf(t,e,r,{o:{insert:n},m:s},i=2){i===0&&n(t.targetAnchor,e,r);const{el:a,anchor:o,shapeFlag:l,children:c,props:u}=t,f=i===2;if(f&&n(a,e,r),(!f||Pu(u))&&l&16)for(let h=0;h<c.length;h++)s(c[h],e,r,2);f&&n(o,e,r)}function V3(t,e,r,n,s,i,{o:{nextSibling:a,parentNode:o,querySelector:l,insert:c,createText:u}},f){const h=e.target=$g(e.props,l);if(h){const p=Pu(e.props),v=h._lpa||h.firstChild;if(e.shapeFlag&16)if(p)e.anchor=f(a(t),e,o(t),r,n,s,i),e.targetStart=v,e.targetAnchor=v&&a(v);else{e.anchor=a(t);let g=v;for(;g;){if(g&&g.nodeType===8){if(g.data==="teleport start anchor")e.targetStart=g;else if(g.data==="teleport anchor"){e.targetAnchor=g,h._lpa=e.targetAnchor&&a(e.targetAnchor);break}}g=a(g)}e.targetAnchor||SA(h,e,u,c),f(v&&a(v),e,h,r,n,s,i)}f0(e,p)}return e.anchor&&a(e.anchor)}const H3=bA;function f0(t,e){const r=t.ctx;if(r&&r.ut){let n,s;for(e?(n=t.el,s=t.anchor):(n=t.targetStart,s=t.targetAnchor);n&&n!==s;)n.nodeType===1&&n.setAttribute("data-v-owner",r.uid),n=n.nextSibling;r.ut()}}function SA(t,e,r,n){const s=e.targetStart=r(""),i=e.targetAnchor=r("");return s[EA]=i,t&&(n(s,t),n(i,t)),i}const Gi=Symbol("_leaveCb"),Df=Symbol("_enterCb");function x1(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return jt(()=>{t.isMounted=!0}),Zh(()=>{t.isUnmounting=!0}),t}const Ns=[Function,Array],E1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ns,onEnter:Ns,onAfterEnter:Ns,onEnterCancelled:Ns,onBeforeLeave:Ns,onLeave:Ns,onAfterLeave:Ns,onLeaveCancelled:Ns,onBeforeAppear:Ns,onAppear:Ns,onAfterAppear:Ns,onAppearCancelled:Ns},AA=t=>{const e=t.subTree;return e.component?AA(e.component):e},j3={name:"BaseTransition",props:E1,setup(t,{slots:e}){const r=Ks(),n=x1();return()=>{const s=e.default&&Yh(e.default(),!0);if(!s||!s.length)return;const i=TA(s),a=Xt(t),{mode:o}=a;if(n.isLeaving)return Zp(i);const l=vE(i);if(!l)return Zp(i);let c=pc(l,a,n,r,f=>c=f);l.type!==Kr&&yi(l,c);let u=r.subTree&&vE(r.subTree);if(u&&u.type!==Kr&&!sa(l,u)&&AA(r).type!==Kr){let f=pc(u,a,n,r);if(yi(u,f),o==="out-in"&&l.type!==Kr)return n.isLeaving=!0,f.afterLeave=()=>{n.isLeaving=!1,r.job.flags&8||r.update(),delete f.afterLeave,u=void 0},Zp(i);o==="in-out"&&l.type!==Kr?f.delayLeave=(h,p,v)=>{const g=CA(n,u);g[String(u.key)]=u,h[Gi]=()=>{p(),h[Gi]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{v(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function TA(t){let e=t[0];if(t.length>1){for(const r of t)if(r.type!==Kr){e=r;break}}return e}const wA=j3;function CA(t,e){const{leavingVNodes:r}=t;let n=r.get(e.type);return n||(n=Object.create(null),r.set(e.type,n)),n}function pc(t,e,r,n,s){const{appear:i,mode:a,persisted:o=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:f,onBeforeLeave:h,onLeave:p,onAfterLeave:v,onLeaveCancelled:g,onBeforeAppear:y,onAppear:b,onAfterAppear:E,onAppearCancelled:x}=e,I=String(t.key),D=CA(r,t),P=(m,T)=>{m&&Gs(m,n,9,T)},w=(m,T)=>{const _=T[1];P(m,T),ut(m)?m.every(A=>A.length<=1)&&_():m.length<=1&&_()},S={mode:a,persisted:o,beforeEnter(m){let T=l;if(!r.isMounted)if(i)T=y||l;else return;m[Gi]&&m[Gi](!0);const _=D[I];_&&sa(t,_)&&_.el[Gi]&&_.el[Gi](),P(T,[m])},enter(m){let T=c,_=u,A=f;if(!r.isMounted)if(i)T=b||c,_=E||u,A=x||f;else return;let k=!1;const U=m[Df]=L=>{k||(k=!0,L?P(A,[m]):P(_,[m]),S.delayedLeave&&S.delayedLeave(),m[Df]=void 0)};T?w(T,[m,U]):U()},leave(m,T){const _=String(t.key);if(m[Df]&&m[Df](!0),r.isUnmounting)return T();P(h,[m]);let A=!1;const k=m[Gi]=U=>{A||(A=!0,T(),U?P(g,[m]):P(v,[m]),m[Gi]=void 0,D[_]===t&&delete D[_])};D[_]=t,p?w(p,[m,k]):k()},clone(m){const T=pc(m,e,r,n,s);return s&&s(T),T}};return S}function Zp(t){if(Ld(t))return t=Ma(t),t.children=null,t}function vE(t){if(!Ld(t))return _A(t.type)&&t.children?TA(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:r}=t;if(r){if(e&16)return r[0];if(e&32&&At(r.default))return r.default()}}function yi(t,e){t.shapeFlag&6&&t.component?(t.transition=e,yi(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Yh(t,e=!1,r){let n=[],s=0;for(let i=0;i<t.length;i++){let a=t[i];const o=r==null?a.key:String(r)+String(a.key!=null?a.key:i);a.type===Fe?(a.patchFlag&128&&s++,n=n.concat(Yh(a.children,e,o))):(e||a.type!==Kr)&&n.push(o!=null?Ma(a,{key:o}):a)}if(s>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function Md(t,e){return At(t)?xr({name:t.name},e,{setup:t}):t}function G3(){const t=Ks();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function _1(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function W3(t){const e=Ks(),r=g1(null);if(e){const s=e.refs===Qt?e.refs={}:e.refs;Object.defineProperty(s,t,{enumerable:!0,get:()=>r.value,set:i=>r.value=i})}return r}function tc(t,e,r,n,s=!1){if(ut(t)){t.forEach((v,g)=>tc(v,e&&(ut(e)?e[g]:e),r,n,s));return}if(to(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&tc(t,e,r,n.component.subTree);return}const i=n.shapeFlag&4?Ud(n.component):n.el,a=s?null:i,{i:o,r:l}=t,c=e&&e.r,u=o.refs===Qt?o.refs={}:o.refs,f=o.setupState,h=Xt(f),p=f===Qt?()=>!1:v=>ur(h,v);if(c!=null&&c!==l&&(Ar(c)?(u[c]=null,p(c)&&(f[c]=null)):Cr(c)&&(c.value=null)),At(l))Fc(l,o,12,[a,u]);else{const v=Ar(l),g=Cr(l);if(v||g){const y=()=>{if(t.f){const b=v?p(l)?f[l]:u[l]:l.value;s?ut(b)&&a1(b,i):ut(b)?b.includes(i)||b.push(i):v?(u[l]=[i],p(l)&&(f[l]=u[l])):(l.value=[i],t.k&&(u[t.k]=l.value))}else v?(u[l]=a,p(l)&&(f[l]=a)):g&&(l.value=a,t.k&&(u[t.k]=a))};a?(y.id=-1,sn(y,r)):y()}}}let yE=!1;const kl=()=>{yE||(console.error("Hydration completed but contains mismatches."),yE=!0)},z3=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",K3=t=>t.namespaceURI.includes("MathML"),Pf=t=>{if(t.nodeType===1){if(z3(t))return"svg";if(K3(t))return"mathml"}},zl=t=>t.nodeType===8;function q3(t){const{mt:e,p:r,o:{patchProp:n,createText:s,nextSibling:i,parentNode:a,remove:o,insert:l,createComment:c}}=t,u=(x,I)=>{if(!I.hasChildNodes()){r(null,x,I),$0(),I._vnode=x;return}f(I.firstChild,x,null,null,null),$0(),I._vnode=x},f=(x,I,D,P,w,S=!1)=>{S=S||!!I.dynamicChildren;const m=zl(x)&&x.data==="[",T=()=>g(x,I,D,P,w,m),{type:_,ref:A,shapeFlag:k,patchFlag:U}=I;let L=x.nodeType;I.el=x,U===-2&&(S=!1,I.dynamicChildren=null);let R=null;switch(_){case ro:L!==3?I.children===""?(l(I.el=s(""),a(x),x),R=x):R=T():(x.data!==I.children&&(kl(),x.data=I.children),R=i(x));break;case Kr:E(x)?(R=i(x),b(I.el=x.content.firstChild,x,D)):L!==8||m?R=T():R=i(x);break;case Vo:if(m&&(x=i(x),L=x.nodeType),L===1||L===3){R=x;const F=!I.children.length;for(let N=0;N<I.staticCount;N++)F&&(I.children+=R.nodeType===1?R.outerHTML:R.data),N===I.staticCount-1&&(I.anchor=R),R=i(R);return m?i(R):R}else T();break;case Fe:m?R=v(x,I,D,P,w,S):R=T();break;default:if(k&1)(L!==1||I.type.toLowerCase()!==x.tagName.toLowerCase())&&!E(x)?R=T():R=h(x,I,D,P,w,S);else if(k&6){I.slotScopeIds=w;const F=a(x);if(m?R=y(x):zl(x)&&x.data==="teleport start"?R=y(x,x.data,"teleport end"):R=i(x),e(I,F,null,D,P,Pf(F),S),to(I)&&!I.type.__asyncResolved){let N;m?(N=Le(Fe),N.anchor=R?R.previousSibling:F.lastChild):N=x.nodeType===3?Ce(""):Le("div"),N.el=x,I.component.subTree=N}}else k&64?L!==8?R=T():R=I.type.hydrate(x,I,D,P,w,S,t,p):k&128&&(R=I.type.hydrate(x,I,D,P,Pf(a(x)),w,S,t,f))}return A!=null&&tc(A,null,P,I),R},h=(x,I,D,P,w,S)=>{S=S||!!I.dynamicChildren;const{type:m,props:T,patchFlag:_,shapeFlag:A,dirs:k,transition:U}=I,L=m==="input"||m==="option";if(L||_!==-1){k&&Ia(I,null,D,"created");let R=!1;if(E(x)){R=ZA(null,U)&&D&&D.vnode.props&&D.vnode.props.appear;const N=x.content.firstChild;if(R){const M=N.getAttribute("class");M&&(N.$cls=M),U.beforeEnter(N)}b(N,x,D),I.el=x=N}if(A&16&&!(T&&(T.innerHTML||T.textContent))){let N=p(x.firstChild,I,x,D,P,w,S);for(;N;){Rf(x,1)||kl();const M=N;N=N.nextSibling,o(M)}}else if(A&8){let N=I.children;N[0]===`
`&&(x.tagName==="PRE"||x.tagName==="TEXTAREA")&&(N=N.slice(1)),x.textContent!==N&&(Rf(x,0)||kl(),x.textContent=I.children)}if(T){if(L||!S||_&48){const N=x.tagName.includes("-");for(const M in T)(L&&(M.endsWith("value")||M==="indeterminate")||Nd(M)&&!Jl(M)||M[0]==="."||N)&&n(x,M,null,T[M],void 0,D)}else if(T.onClick)n(x,"onClick",null,T.onClick,void 0,D);else if(_&4&&Pa(T.style))for(const N in T.style)T.style[N]}let F;(F=T&&T.onVnodeBeforeMount)&&gs(F,D,I),k&&Ia(I,null,D,"beforeMount"),((F=T&&T.onVnodeMounted)||k||R)&&lT(()=>{F&&gs(F,D,I),R&&U.enter(x),k&&Ia(I,null,D,"mounted")},P)}return x.nextSibling},p=(x,I,D,P,w,S,m)=>{m=m||!!I.dynamicChildren;const T=I.children,_=T.length;for(let A=0;A<_;A++){const k=m?T[A]:T[A]=ys(T[A]),U=k.type===ro;x?(U&&!m&&A+1<_&&ys(T[A+1]).type===ro&&(l(s(x.data.slice(k.children.length)),D,i(x)),x.data=k.children),x=f(x,k,P,w,S,m)):U&&!k.children?l(k.el=s(""),D):(Rf(D,1)||kl(),r(null,k,D,null,P,w,Pf(D),S))}return x},v=(x,I,D,P,w,S)=>{const{slotScopeIds:m}=I;m&&(w=w?w.concat(m):m);const T=a(x),_=p(i(x),I,T,D,P,w,S);return _&&zl(_)&&_.data==="]"?i(I.anchor=_):(kl(),l(I.anchor=c("]"),T,_),_)},g=(x,I,D,P,w,S)=>{if(Rf(x.parentElement,1)||kl(),I.el=null,S){const _=y(x);for(;;){const A=i(x);if(A&&A!==_)o(A);else break}}const m=i(x),T=a(x);return o(x),r(null,I,T,m,D,P,Pf(T),w),D&&(D.vnode.el=I.el,tp(D,I.el)),m},y=(x,I="[",D="]")=>{let P=0;for(;x;)if(x=i(x),x&&zl(x)&&(x.data===I&&P++,x.data===D)){if(P===0)return i(x);P--}return x},b=(x,I,D)=>{const P=I.parentNode;P&&P.replaceChild(x,I);let w=D;for(;w;)w.vnode.el===I&&(w.vnode.el=w.subTree.el=x),w=w.parent},E=x=>x.nodeType===1&&x.tagName==="TEMPLATE";return[u,f]}const xE="data-allow-mismatch",X3={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function Rf(t,e){if(e===0||e===1)for(;t&&!t.hasAttribute(xE);)t=t.parentElement;const r=t&&t.getAttribute(xE);if(r==null)return!1;if(r==="")return!0;{const n=r.split(",");return e===0&&n.includes("children")?!0:n.includes(X3[e])}}const Y3=$h().requestIdleCallback||(t=>setTimeout(t,1)),Q3=$h().cancelIdleCallback||(t=>clearTimeout(t)),J3=(t=1e4)=>e=>{const r=Y3(e,{timeout:t});return()=>Q3(r)};function Z3(t){const{top:e,left:r,bottom:n,right:s}=t.getBoundingClientRect(),{innerHeight:i,innerWidth:a}=window;return(e>0&&e<i||n>0&&n<i)&&(r>0&&r<a||s>0&&s<a)}const eP=t=>(e,r)=>{const n=new IntersectionObserver(s=>{for(const i of s)if(i.isIntersecting){n.disconnect(),e();break}},t);return r(s=>{if(s instanceof Element){if(Z3(s))return e(),n.disconnect(),!1;n.observe(s)}}),()=>n.disconnect()},tP=t=>e=>{if(t){const r=matchMedia(t);if(r.matches)e();else return r.addEventListener("change",e,{once:!0}),()=>r.removeEventListener("change",e)}},rP=(t=[])=>(e,r)=>{Ar(t)&&(t=[t]);let n=!1;const s=a=>{n||(n=!0,i(),e(),a.target.dispatchEvent(new a.constructor(a.type,a)))},i=()=>{r(a=>{for(const o of t)a.removeEventListener(o,s)})};return r(a=>{for(const o of t)a.addEventListener(o,s,{once:!0})}),i};function nP(t,e){if(zl(t)&&t.data==="["){let r=1,n=t.nextSibling;for(;n;){if(n.nodeType===1){if(e(n)===!1)break}else if(zl(n))if(n.data==="]"){if(--r===0)break}else n.data==="["&&r++;n=n.nextSibling}}else e(t)}const to=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function sP(t){At(t)&&(t={loader:t});const{loader:e,loadingComponent:r,errorComponent:n,delay:s=200,hydrate:i,timeout:a,suspensible:o=!0,onError:l}=t;let c=null,u,f=0;const h=()=>(f++,c=null,p()),p=()=>{let v;return c||(v=c=e().catch(g=>{if(g=g instanceof Error?g:new Error(String(g)),l)return new Promise((y,b)=>{l(g,()=>y(h()),()=>b(g),f+1)});throw g}).then(g=>v!==c&&c?c:(g&&(g.__esModule||g[Symbol.toStringTag]==="Module")&&(g=g.default),u=g,g)))};return Md({name:"AsyncComponentWrapper",__asyncLoader:p,__asyncHydrate(v,g,y){const b=i?()=>{const x=i(()=>{y()},I=>nP(v,I));x&&(g.bum||(g.bum=[])).push(x),(g.u||(g.u=[])).push(()=>!0)}:y;u?b():p().then(()=>!g.isUnmounted&&b())},get __asyncResolved(){return u},setup(){const v=on;if(_1(v),u)return()=>em(u,v);const g=x=>{c=null,ll(x,v,13,!n)};if(o&&v.suspense||mc)return p().then(x=>()=>em(x,v)).catch(x=>(g(x),()=>n?Le(n,{error:x}):null));const y=se(!1),b=se(),E=se(!!s);return s&&setTimeout(()=>{E.value=!1},s),a!=null&&setTimeout(()=>{if(!y.value&&!b.value){const x=new Error(`Async component timed out after ${a}ms.`);g(x),b.value=x}},a),p().then(()=>{y.value=!0,v.parent&&Ld(v.parent.vnode)&&v.parent.update()}).catch(x=>{g(x),b.value=x}),()=>{if(y.value&&u)return em(u,v);if(b.value&&n)return Le(n,{error:b.value});if(r&&!E.value)return Le(r)}}})}function em(t,e){const{ref:r,props:n,children:s,ce:i}=e.vnode,a=Le(t,n,s);return a.ref=r,a.ce=i,delete e.vnode.ce,a}const Ld=t=>t.type.__isKeepAlive,aP={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const r=Ks(),n=r.ctx;if(!n.renderer)return()=>{const E=e.default&&e.default();return E&&E.length===1?E[0]:E};const s=new Map,i=new Set;let a=null;const o=r.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:f}}}=n,h=f("div");n.activate=(E,x,I,D,P)=>{const w=E.component;c(E,x,I,0,o),l(w.vnode,E,x,I,w,o,D,E.slotScopeIds,P),sn(()=>{w.isDeactivated=!1,w.a&&Zl(w.a);const S=E.props&&E.props.onVnodeMounted;S&&gs(S,w.parent,E)},o)},n.deactivate=E=>{const x=E.component;H0(x.m),H0(x.a),c(E,h,null,1,o),sn(()=>{x.da&&Zl(x.da);const I=E.props&&E.props.onVnodeUnmounted;I&&gs(I,x.parent,E),x.isDeactivated=!0},o)};function p(E){tm(E),u(E,r,o,!0)}function v(E){s.forEach((x,I)=>{const D=Jg(x.type);D&&!E(D)&&g(I)})}function g(E){const x=s.get(E);x&&(!a||!sa(x,a))?p(x):a&&tm(a),s.delete(E),i.delete(E)}Vt(()=>[t.include,t.exclude],([E,x])=>{E&&v(I=>mu(E,I)),x&&v(I=>!mu(x,I))},{flush:"post",deep:!0});let y=null;const b=()=>{y!=null&&(j0(r.subTree.type)?sn(()=>{s.set(y,Ff(r.subTree))},r.subTree.suspense):s.set(y,Ff(r.subTree)))};return jt(b),Jh(b),Zh(()=>{s.forEach(E=>{const{subTree:x,suspense:I}=r,D=Ff(x);if(E.type===D.type&&E.key===D.key){tm(D);const P=D.component.da;P&&sn(P,I);return}p(E)})}),()=>{if(y=null,!e.default)return a=null;const E=e.default(),x=E[0];if(E.length>1)return a=null,E;if(!xi(x)||!(x.shapeFlag&4)&&!(x.shapeFlag&128))return a=null,x;let I=Ff(x);if(I.type===Kr)return a=null,I;const D=I.type,P=Jg(to(I)?I.type.__asyncResolved||{}:D),{include:w,exclude:S,max:m}=t;if(w&&(!P||!mu(w,P))||S&&P&&mu(S,P))return I.shapeFlag&=-257,a=I,x;const T=I.key==null?D:I.key,_=s.get(T);return I.el&&(I=Ma(I),x.shapeFlag&128&&(x.ssContent=I)),y=T,_?(I.el=_.el,I.component=_.component,I.transition&&yi(I,I.transition),I.shapeFlag|=512,i.delete(T),i.add(T)):(i.add(T),m&&i.size>parseInt(m,10)&&g(i.values().next().value)),I.shapeFlag|=256,a=I,j0(x.type)?x:I}}},iP=aP;function mu(t,e){return ut(t)?t.some(r=>mu(r,e)):Ar(t)?t.split(",").includes(e):OD(t)?(t.lastIndex=0,t.test(e)):!1}function IA(t,e){DA(t,"a",e)}function kA(t,e){DA(t,"da",e)}function DA(t,e,r=on){const n=t.__wdc||(t.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Qh(e,n,r),r){let s=r.parent;for(;s&&s.parent;)Ld(s.parent.vnode)&&oP(n,e,r,s),s=s.parent}}function oP(t,e,r,n){const s=Qh(e,t,n,!0);Va(()=>{a1(n[e],s)},r)}function tm(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Ff(t){return t.shapeFlag&128?t.ssContent:t}function Qh(t,e,r=on,n=!1){if(r){const s=r[t]||(r[t]=[]),i=e.__weh||(e.__weh=(...a)=>{mi();const o=Xo(r),l=Gs(e,r,t,a);return o(),gi(),l});return n?s.unshift(i):s.push(i),i}}const wi=t=>(e,r=on)=>{(!mc||t==="sp")&&Qh(t,(...n)=>e(...n),r)},PA=wi("bm"),jt=wi("m"),b1=wi("bu"),Jh=wi("u"),Zh=wi("bum"),Va=wi("um"),RA=wi("sp"),FA=wi("rtg"),NA=wi("rtc");function OA(t,e=on){Qh("ec",t,e)}const S1="components",lP="directives";function fr(t,e){return T1(S1,t,!0,e)||t}const MA=Symbol.for("v-ndc");function A1(t){return Ar(t)?T1(S1,t,!1)||t:t||MA}function cP(t){return T1(lP,t)}function T1(t,e,r=!0,n=!1){const s=ln||on;if(s){const i=s.type;if(t===S1){const o=Jg(i,!1);if(o&&(o===e||o===Cn(e)||o===Od(Cn(e))))return i}const a=EE(s[t]||i[t],e)||EE(s.appContext[t],e);return!a&&n?i:a}}function EE(t,e){return t&&(t[e]||t[Cn(e)]||t[Od(Cn(e))])}function He(t,e,r,n){let s;const i=r&&r[n],a=ut(t);if(a||Ar(t)){const o=a&&Pa(t);let l=!1,c=!1;o&&(l=!ks(t),c=vi(t),t=jh(t)),s=new Array(t.length);for(let u=0,f=t.length;u<f;u++)s[u]=e(l?c?L0(Tn(t[u])):Tn(t[u]):t[u],u,void 0,i&&i[u])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=e(o+1,o,void 0,i&&i[o])}else if(gr(t))if(t[Symbol.iterator])s=Array.from(t,(o,l)=>e(o,l,void 0,i&&i[l]));else{const o=Object.keys(t);s=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const u=o[l];s[l]=e(t[u],u,l,i&&i[l])}}else s=[];return r&&(r[n]=s),s}function uP(t,e){for(let r=0;r<e.length;r++){const n=e[r];if(ut(n))for(let s=0;s<n.length;s++)t[n[s].name]=n[s].fn;else n&&(t[n.name]=n.key?(...s)=>{const i=n.fn(...s);return i&&(i.key=n.key),i}:n.fn)}return t}function LA(t,e,r={},n,s){if(ln.ce||ln.parent&&to(ln.parent)&&ln.parent.ce)return e!=="default"&&(r.name=e),O(),tr(Fe,null,[Le("slot",r,n&&n())],64);let i=t[e];i&&i._c&&(i._d=!1),O();const a=i&&w1(i(r)),o=r.key||a&&a.key,l=tr(Fe,{key:(o&&!pa(o)?o:`_${e}`)+(!a&&n?"_fb":"")},a||(n?n():[]),a&&t._===1?64:-2);return!s&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function w1(t){return t.some(e=>xi(e)?!(e.type===Kr||e.type===Fe&&!w1(e.children)):!0)?t:null}function dP(t,e){const r={};for(const n in t)r[e&&/[A-Z]/.test(n)?`on:${n}`:Iu(n)]=t[n];return r}const Vg=t=>t?mT(t)?Ud(t):Vg(t.parent):null,Ru=xr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Vg(t.parent),$root:t=>Vg(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>C1(t),$forceUpdate:t=>t.f||(t.f=()=>{y1(t.update)}),$nextTick:t=>t.n||(t.n=cl.bind(t.proxy)),$watch:t=>HP.bind(t)}),rm=(t,e)=>t!==Qt&&!t.__isScriptSetup&&ur(t,e),Hg={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:n,data:s,props:i,accessCache:a,type:o,appContext:l}=t;let c;if(e[0]!=="$"){const p=a[e];if(p!==void 0)switch(p){case 1:return n[e];case 2:return s[e];case 4:return r[e];case 3:return i[e]}else{if(rm(n,e))return a[e]=1,n[e];if(s!==Qt&&ur(s,e))return a[e]=2,s[e];if((c=t.propsOptions[0])&&ur(c,e))return a[e]=3,i[e];if(r!==Qt&&ur(r,e))return a[e]=4,r[e];jg&&(a[e]=0)}}const u=Ru[e];let f,h;if(u)return e==="$attrs"&&jn(t.attrs,"get",""),u(t);if((f=o.__cssModules)&&(f=f[e]))return f;if(r!==Qt&&ur(r,e))return a[e]=4,r[e];if(h=l.config.globalProperties,ur(h,e))return h[e]},set({_:t},e,r){const{data:n,setupState:s,ctx:i}=t;return rm(s,e)?(s[e]=r,!0):n!==Qt&&ur(n,e)?(n[e]=r,!0):ur(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:s,propsOptions:i}},a){let o;return!!r[a]||t!==Qt&&ur(t,a)||rm(e,a)||(o=i[0])&&ur(o,a)||ur(n,a)||ur(Ru,a)||ur(s.config.globalProperties,a)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:ur(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}},fP=xr({},Hg,{get(t,e){if(e!==Symbol.unscopables)return Hg.get(t,e,t)},has(t,e){return e[0]!=="_"&&!$D(e)}});function hP(){return null}function pP(){return null}function mP(t){}function gP(t){}function vP(){return null}function yP(){}function xP(t,e){return null}function EP(){return BA().slots}function _P(){return BA().attrs}function BA(){const t=Ks();return t.setupContext||(t.setupContext=yT(t))}function dd(t){return ut(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}function bP(t,e){const r=dd(t);for(const n in e){if(n.startsWith("__skip"))continue;let s=r[n];s?ut(s)||At(s)?s=r[n]={type:s,default:e[n]}:s.default=e[n]:s===null&&(s=r[n]={default:e[n]}),s&&e[`__skip_${n}`]&&(s.skipFactory=!0)}return r}function SP(t,e){return!t||!e?t||e:ut(t)&&ut(e)?t.concat(e):xr({},dd(t),dd(e))}function AP(t,e){const r={};for(const n in t)e.includes(n)||Object.defineProperty(r,n,{enumerable:!0,get:()=>t[n]});return r}function TP(t){const e=Ks();let r=t();return Xg(),i1(r)&&(r=r.catch(n=>{throw Xo(e),n})),[r,()=>Xo(e)]}let jg=!0;function wP(t){const e=C1(t),r=t.proxy,n=t.ctx;jg=!1,e.beforeCreate&&_E(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:f,mounted:h,beforeUpdate:p,updated:v,activated:g,deactivated:y,beforeDestroy:b,beforeUnmount:E,destroyed:x,unmounted:I,render:D,renderTracked:P,renderTriggered:w,errorCaptured:S,serverPrefetch:m,expose:T,inheritAttrs:_,components:A,directives:k,filters:U}=e;if(c&&CP(c,n,null),a)for(const F in a){const N=a[F];At(N)&&(n[F]=N.bind(r))}if(s){const F=s.call(r,r);gr(F)&&(t.data=Rs(F))}if(jg=!0,i)for(const F in i){const N=i[F],M=At(N)?N.bind(r,r):At(N.get)?N.get.bind(r,r):Vs,z=!At(N)&&At(N.set)?N.set.bind(r):Vs,G=be({get:M,set:z});Object.defineProperty(n,F,{enumerable:!0,configurable:!0,get:()=>G.value,set:H=>G.value=H})}if(o)for(const F in o)UA(o[F],n,r,F);if(l){const F=At(l)?l.call(r):l;Reflect.ownKeys(F).forEach(N=>{Fu(N,F[N])})}u&&_E(u,t,"c");function R(F,N){ut(N)?N.forEach(M=>F(M.bind(r))):N&&F(N.bind(r))}if(R(PA,f),R(jt,h),R(b1,p),R(Jh,v),R(IA,g),R(kA,y),R(OA,S),R(NA,P),R(FA,w),R(Zh,E),R(Va,I),R(RA,m),ut(T))if(T.length){const F=t.exposed||(t.exposed={});T.forEach(N=>{Object.defineProperty(F,N,{get:()=>r[N],set:M=>r[N]=M})})}else t.exposed||(t.exposed={});D&&t.render===Vs&&(t.render=D),_!=null&&(t.inheritAttrs=_),A&&(t.components=A),k&&(t.directives=k),m&&_1(t)}function CP(t,e,r=Vs){ut(t)&&(t=Gg(t));for(const n in t){const s=t[n];let i;gr(s)?"default"in s?i=Ds(s.from||n,s.default,!0):i=Ds(s.from||n):i=Ds(s),Cr(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):e[n]=i}}function _E(t,e,r){Gs(ut(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function UA(t,e,r,n){let s=n.includes(".")?sT(r,n):()=>r[n];if(Ar(t)){const i=e[t];At(i)&&Vt(s,i)}else if(At(t))Vt(s,t.bind(r));else if(gr(t))if(ut(t))t.forEach(i=>UA(i,e,r,n));else{const i=At(t.handler)?t.handler.bind(r):e[t.handler];At(i)&&Vt(s,i,t)}}function C1(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=t.appContext,o=i.get(e);let l;return o?l=o:!s.length&&!r&&!n?l=e:(l={},s.length&&s.forEach(c=>V0(l,c,a,!0)),V0(l,e,a)),gr(e)&&i.set(e,l),l}function V0(t,e,r,n=!1){const{mixins:s,extends:i}=e;i&&V0(t,i,r,!0),s&&s.forEach(a=>V0(t,a,r,!0));for(const a in e)if(!(n&&a==="expose")){const o=IP[a]||r&&r[a];t[a]=o?o(t[a],e[a]):e[a]}return t}const IP={data:bE,props:SE,emits:SE,methods:gu,computed:gu,beforeCreate:ns,created:ns,beforeMount:ns,mounted:ns,beforeUpdate:ns,updated:ns,beforeDestroy:ns,beforeUnmount:ns,destroyed:ns,unmounted:ns,activated:ns,deactivated:ns,errorCaptured:ns,serverPrefetch:ns,components:gu,directives:gu,watch:DP,provide:bE,inject:kP};function bE(t,e){return e?t?function(){return xr(At(t)?t.call(this,this):t,At(e)?e.call(this,this):e)}:e:t}function kP(t,e){return gu(Gg(t),Gg(e))}function Gg(t){if(ut(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function ns(t,e){return t?[...new Set([].concat(t,e))]:e}function gu(t,e){return t?xr(Object.create(null),t,e):e}function SE(t,e){return t?ut(t)&&ut(e)?[...new Set([...t,...e])]:xr(Object.create(null),dd(t),dd(e??{})):e}function DP(t,e){if(!t)return e;if(!e)return t;const r=xr(Object.create(null),t);for(const n in e)r[n]=ns(t[n],e[n]);return r}function $A(){return{app:null,config:{isNativeTag:FD,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let PP=0;function RP(t,e){return function(n,s=null){At(n)||(n=xr({},n)),s!=null&&!gr(s)&&(s=null);const i=$A(),a=new WeakSet,o=[];let l=!1;const c=i.app={_uid:PP++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:ET,get config(){return i.config},set config(u){},use(u,...f){return a.has(u)||(u&&At(u.install)?(a.add(u),u.install(c,...f)):At(u)&&(a.add(u),u(c,...f))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,f){return f?(i.components[u]=f,c):i.components[u]},directive(u,f){return f?(i.directives[u]=f,c):i.directives[u]},mount(u,f,h){if(!l){const p=c._ceVNode||Le(n,s);return p.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),f&&e?e(p,u):t(p,u,h),l=!0,c._container=u,u.__vue_app__=c,Ud(p.component)}},onUnmount(u){o.push(u)},unmount(){l&&(Gs(o,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,f){return i.provides[u]=f,c},runWithContext(u){const f=$o;$o=c;try{return u()}finally{$o=f}}};return c}}let $o=null;function Fu(t,e){if(on){let r=on.provides;const n=on.parent&&on.parent.provides;n===r&&(r=on.provides=Object.create(n)),r[t]=e}}function Ds(t,e,r=!1){const n=on||ln;if(n||$o){let s=$o?$o._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return r&&At(e)?e.call(n&&n.proxy):e}}function VA(){return!!(on||ln||$o)}const HA={},jA=()=>Object.create(HA),GA=t=>Object.getPrototypeOf(t)===HA;function FP(t,e,r,n=!1){const s={},i=jA();t.propsDefaults=Object.create(null),WA(t,e,s,i);for(const a in t.propsOptions[0])a in s||(s[a]=void 0);r?t.props=n?s:p1(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function NP(t,e,r,n){const{props:s,attrs:i,vnode:{patchFlag:a}}=t,o=Xt(s),[l]=t.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=t.vnode.dynamicProps;for(let f=0;f<u.length;f++){let h=u[f];if(ep(t.emitsOptions,h))continue;const p=e[h];if(l)if(ur(i,h))p!==i[h]&&(i[h]=p,c=!0);else{const v=Cn(h);s[v]=Wg(l,o,v,p,t,!1)}else p!==i[h]&&(i[h]=p,c=!0)}}}else{WA(t,e,s,i)&&(c=!0);let u;for(const f in o)(!e||!ur(e,f)&&((u=xs(f))===f||!ur(e,u)))&&(l?r&&(r[f]!==void 0||r[u]!==void 0)&&(s[f]=Wg(l,o,f,void 0,t,!0)):delete s[f]);if(i!==o)for(const f in i)(!e||!ur(e,f))&&(delete i[f],c=!0)}c&&Ja(t.attrs,"set","")}function WA(t,e,r,n){const[s,i]=t.propsOptions;let a=!1,o;if(e)for(let l in e){if(Jl(l))continue;const c=e[l];let u;s&&ur(s,u=Cn(l))?!i||!i.includes(u)?r[u]=c:(o||(o={}))[u]=c:ep(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(i){const l=Xt(r),c=o||Qt;for(let u=0;u<i.length;u++){const f=i[u];r[f]=Wg(s,l,f,c[f],t,!ur(c,f))}}return a}function Wg(t,e,r,n,s,i){const a=t[r];if(a!=null){const o=ur(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&At(l)){const{propsDefaults:c}=s;if(r in c)n=c[r];else{const u=Xo(s);n=c[r]=l.call(null,e),u()}}else n=l;s.ce&&s.ce._setProp(r,n)}a[0]&&(i&&!o?n=!1:a[1]&&(n===""||n===xs(r))&&(n=!0))}return n}const OP=new WeakMap;function zA(t,e,r=!1){const n=r?OP:e.propsCache,s=n.get(t);if(s)return s;const i=t.props,a={},o=[];let l=!1;if(!At(t)){const u=f=>{l=!0;const[h,p]=zA(f,e,!0);xr(a,h),p&&o.push(...p)};!r&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!l)return gr(t)&&n.set(t,Yl),Yl;if(ut(i))for(let u=0;u<i.length;u++){const f=Cn(i[u]);AE(f)&&(a[f]=Qt)}else if(i)for(const u in i){const f=Cn(u);if(AE(f)){const h=i[u],p=a[f]=ut(h)||At(h)?{type:h}:xr({},h),v=p.type;let g=!1,y=!0;if(ut(v))for(let b=0;b<v.length;++b){const E=v[b],x=At(E)&&E.name;if(x==="Boolean"){g=!0;break}else x==="String"&&(y=!1)}else g=At(v)&&v.name==="Boolean";p[0]=g,p[1]=y,(g||ur(p,"default"))&&o.push(f)}}const c=[a,o];return gr(t)&&n.set(t,c),c}function AE(t){return t[0]!=="$"&&!Jl(t)}const I1=t=>t[0]==="_"||t==="$stable",k1=t=>ut(t)?t.map(ys):[ys(t)],MP=(t,e,r)=>{if(e._n)return e;const n=Xh((...s)=>k1(e(...s)),r);return n._c=!1,n},KA=(t,e,r)=>{const n=t._ctx;for(const s in t){if(I1(s))continue;const i=t[s];if(At(i))e[s]=MP(s,i,n);else if(i!=null){const a=k1(i);e[s]=()=>a}}},qA=(t,e)=>{const r=k1(e);t.slots.default=()=>r},XA=(t,e,r)=>{for(const n in e)(r||!I1(n))&&(t[n]=e[n])},LP=(t,e,r)=>{const n=t.slots=jA();if(t.vnode.shapeFlag&32){const s=e.__;s&&Mg(n,"__",s,!0);const i=e._;i?(XA(n,e,r),r&&Mg(n,"_",i,!0)):KA(e,n)}else e&&qA(t,e)},BP=(t,e,r)=>{const{vnode:n,slots:s}=t;let i=!0,a=Qt;if(n.shapeFlag&32){const o=e._;o?r&&o===1?i=!1:XA(s,e,r):(i=!e.$stable,KA(e,s)),a=e}else e&&(qA(t,e),a={default:1});if(i)for(const o in s)!I1(o)&&a[o]==null&&delete s[o]},sn=lT;function YA(t){return JA(t)}function QA(t){return JA(t,q3)}function JA(t,e){const r=$h();r.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:h,setScopeId:p=Vs,insertStaticContent:v}=t,g=(q,J,pe,ge=null,ee=null,ie=null,ve=void 0,we=null,De=!!J.dynamicChildren)=>{if(q===J)return;q&&!sa(q,J)&&(ge=le(q),H(q,ee,ie,!0),q=null),J.patchFlag===-2&&(De=!1,J.dynamicChildren=null);const{type:Te,ref:ze,shapeFlag:ke}=J;switch(Te){case ro:y(q,J,pe,ge);break;case Kr:b(q,J,pe,ge);break;case Vo:q==null&&E(J,pe,ge,ve);break;case Fe:A(q,J,pe,ge,ee,ie,ve,we,De);break;default:ke&1?D(q,J,pe,ge,ee,ie,ve,we,De):ke&6?k(q,J,pe,ge,ee,ie,ve,we,De):(ke&64||ke&128)&&Te.process(q,J,pe,ge,ee,ie,ve,we,De,Z)}ze!=null&&ee?tc(ze,q&&q.ref,ie,J||q,!J):ze==null&&q&&q.ref!=null&&tc(q.ref,null,ie,q,!0)},y=(q,J,pe,ge)=>{if(q==null)n(J.el=o(J.children),pe,ge);else{const ee=J.el=q.el;J.children!==q.children&&c(ee,J.children)}},b=(q,J,pe,ge)=>{q==null?n(J.el=l(J.children||""),pe,ge):J.el=q.el},E=(q,J,pe,ge)=>{[q.el,q.anchor]=v(q.children,J,pe,ge,q.el,q.anchor)},x=({el:q,anchor:J},pe,ge)=>{let ee;for(;q&&q!==J;)ee=h(q),n(q,pe,ge),q=ee;n(J,pe,ge)},I=({el:q,anchor:J})=>{let pe;for(;q&&q!==J;)pe=h(q),s(q),q=pe;s(J)},D=(q,J,pe,ge,ee,ie,ve,we,De)=>{J.type==="svg"?ve="svg":J.type==="math"&&(ve="mathml"),q==null?P(J,pe,ge,ee,ie,ve,we,De):m(q,J,ee,ie,ve,we,De)},P=(q,J,pe,ge,ee,ie,ve,we)=>{let De,Te;const{props:ze,shapeFlag:ke,transition:Ve,dirs:Ae}=q;if(De=q.el=a(q.type,ie,ze&&ze.is,ze),ke&8?u(De,q.children):ke&16&&S(q.children,De,null,ge,ee,nm(q,ie),ve,we),Ae&&Ia(q,null,ge,"created"),w(De,q,q.scopeId,ve,ge),ze){for(const Ke in ze)Ke!=="value"&&!Jl(Ke)&&i(De,Ke,null,ze[Ke],ie,ge);"value"in ze&&i(De,"value",null,ze.value,ie),(Te=ze.onVnodeBeforeMount)&&gs(Te,ge,q)}Ae&&Ia(q,null,ge,"beforeMount");const Ge=ZA(ee,Ve);Ge&&Ve.beforeEnter(De),n(De,J,pe),((Te=ze&&ze.onVnodeMounted)||Ge||Ae)&&sn(()=>{Te&&gs(Te,ge,q),Ge&&Ve.enter(De),Ae&&Ia(q,null,ge,"mounted")},ee)},w=(q,J,pe,ge,ee)=>{if(pe&&p(q,pe),ge)for(let ie=0;ie<ge.length;ie++)p(q,ge[ie]);if(ee){let ie=ee.subTree;if(J===ie||j0(ie.type)&&(ie.ssContent===J||ie.ssFallback===J)){const ve=ee.vnode;w(q,ve,ve.scopeId,ve.slotScopeIds,ee.parent)}}},S=(q,J,pe,ge,ee,ie,ve,we,De=0)=>{for(let Te=De;Te<q.length;Te++){const ze=q[Te]=we?Wi(q[Te]):ys(q[Te]);g(null,ze,J,pe,ge,ee,ie,ve,we)}},m=(q,J,pe,ge,ee,ie,ve)=>{const we=J.el=q.el;let{patchFlag:De,dynamicChildren:Te,dirs:ze}=J;De|=q.patchFlag&16;const ke=q.props||Qt,Ve=J.props||Qt;let Ae;if(pe&&Co(pe,!1),(Ae=Ve.onVnodeBeforeUpdate)&&gs(Ae,pe,J,q),ze&&Ia(J,q,pe,"beforeUpdate"),pe&&Co(pe,!0),(ke.innerHTML&&Ve.innerHTML==null||ke.textContent&&Ve.textContent==null)&&u(we,""),Te?T(q.dynamicChildren,Te,we,pe,ge,nm(J,ee),ie):ve||N(q,J,we,null,pe,ge,nm(J,ee),ie,!1),De>0){if(De&16)_(we,ke,Ve,pe,ee);else if(De&2&&ke.class!==Ve.class&&i(we,"class",null,Ve.class,ee),De&4&&i(we,"style",ke.style,Ve.style,ee),De&8){const Ge=J.dynamicProps;for(let Ke=0;Ke<Ge.length;Ke++){const Ee=Ge[Ke],ye=ke[Ee],Se=Ve[Ee];(Se!==ye||Ee==="value")&&i(we,Ee,ye,Se,ee,pe)}}De&1&&q.children!==J.children&&u(we,J.children)}else!ve&&Te==null&&_(we,ke,Ve,pe,ee);((Ae=Ve.onVnodeUpdated)||ze)&&sn(()=>{Ae&&gs(Ae,pe,J,q),ze&&Ia(J,q,pe,"updated")},ge)},T=(q,J,pe,ge,ee,ie,ve)=>{for(let we=0;we<J.length;we++){const De=q[we],Te=J[we],ze=De.el&&(De.type===Fe||!sa(De,Te)||De.shapeFlag&198)?f(De.el):pe;g(De,Te,ze,null,ge,ee,ie,ve,!0)}},_=(q,J,pe,ge,ee)=>{if(J!==pe){if(J!==Qt)for(const ie in J)!Jl(ie)&&!(ie in pe)&&i(q,ie,J[ie],null,ee,ge);for(const ie in pe){if(Jl(ie))continue;const ve=pe[ie],we=J[ie];ve!==we&&ie!=="value"&&i(q,ie,we,ve,ee,ge)}"value"in pe&&i(q,"value",J.value,pe.value,ee)}},A=(q,J,pe,ge,ee,ie,ve,we,De)=>{const Te=J.el=q?q.el:o(""),ze=J.anchor=q?q.anchor:o("");let{patchFlag:ke,dynamicChildren:Ve,slotScopeIds:Ae}=J;Ae&&(we=we?we.concat(Ae):Ae),q==null?(n(Te,pe,ge),n(ze,pe,ge),S(J.children||[],pe,ze,ee,ie,ve,we,De)):ke>0&&ke&64&&Ve&&q.dynamicChildren?(T(q.dynamicChildren,Ve,pe,ee,ie,ve,we),(J.key!=null||ee&&J===ee.subTree)&&D1(q,J,!0)):N(q,J,pe,ze,ee,ie,ve,we,De)},k=(q,J,pe,ge,ee,ie,ve,we,De)=>{J.slotScopeIds=we,q==null?J.shapeFlag&512?ee.ctx.activate(J,pe,ge,ve,De):U(J,pe,ge,ee,ie,ve,De):L(q,J,De)},U=(q,J,pe,ge,ee,ie,ve)=>{const we=q.component=pT(q,ge,ee);if(Ld(q)&&(we.ctx.renderer=Z),gT(we,!1,ve),we.asyncDep){if(ee&&ee.registerDep(we,R,ve),!q.el){const De=we.subTree=Le(Kr);b(null,De,J,pe)}}else R(we,q,J,pe,ee,ie,ve)},L=(q,J,pe)=>{const ge=J.component=q.component;if(qP(q,J,pe))if(ge.asyncDep&&!ge.asyncResolved){F(ge,J,pe);return}else ge.next=J,ge.update();else J.el=q.el,ge.vnode=J},R=(q,J,pe,ge,ee,ie,ve)=>{const we=()=>{if(q.isMounted){let{next:ke,bu:Ve,u:Ae,parent:Ge,vnode:Ke}=q;{const We=eT(q);if(We){ke&&(ke.el=Ke.el,F(q,ke,ve)),We.asyncDep.then(()=>{q.isUnmounted||we()});return}}let Ee=ke,ye;Co(q,!1),ke?(ke.el=Ke.el,F(q,ke,ve)):ke=Ke,Ve&&Zl(Ve),(ye=ke.props&&ke.props.onVnodeBeforeUpdate)&&gs(ye,Ge,ke,Ke),Co(q,!0);const Se=h0(q),Oe=q.subTree;q.subTree=Se,g(Oe,Se,f(Oe.el),le(Oe),q,ee,ie),ke.el=Se.el,Ee===null&&tp(q,Se.el),Ae&&sn(Ae,ee),(ye=ke.props&&ke.props.onVnodeUpdated)&&sn(()=>gs(ye,Ge,ke,Ke),ee)}else{let ke;const{el:Ve,props:Ae}=J,{bm:Ge,m:Ke,parent:Ee,root:ye,type:Se}=q,Oe=to(J);if(Co(q,!1),Ge&&Zl(Ge),!Oe&&(ke=Ae&&Ae.onVnodeBeforeMount)&&gs(ke,Ee,J),Co(q,!0),Ve&&Q){const We=()=>{q.subTree=h0(q),Q(Ve,q.subTree,q,ee,null)};Oe&&Se.__asyncHydrate?Se.__asyncHydrate(Ve,q,We):We()}else{ye.ce&&ye.ce._def.shadowRoot!==!1&&ye.ce._injectChildStyle(Se);const We=q.subTree=h0(q);g(null,We,pe,ge,q,ee,ie),J.el=We.el}if(Ke&&sn(Ke,ee),!Oe&&(ke=Ae&&Ae.onVnodeMounted)){const We=J;sn(()=>gs(ke,Ee,We),ee)}(J.shapeFlag&256||Ee&&to(Ee.vnode)&&Ee.vnode.shapeFlag&256)&&q.a&&sn(q.a,ee),q.isMounted=!0,J=pe=ge=null}};q.scope.on();const De=q.effect=new ad(we);q.scope.off();const Te=q.update=De.run.bind(De),ze=q.job=De.runIfDirty.bind(De);ze.i=q,ze.id=q.uid,De.scheduler=()=>y1(ze),Co(q,!0),Te()},F=(q,J,pe)=>{J.component=q;const ge=q.vnode.props;q.vnode=J,q.next=null,NP(q,J.props,ge,pe),BP(q,J.children,pe),mi(),hE(q),gi()},N=(q,J,pe,ge,ee,ie,ve,we,De=!1)=>{const Te=q&&q.children,ze=q?q.shapeFlag:0,ke=J.children,{patchFlag:Ve,shapeFlag:Ae}=J;if(Ve>0){if(Ve&128){z(Te,ke,pe,ge,ee,ie,ve,we,De);return}else if(Ve&256){M(Te,ke,pe,ge,ee,ie,ve,we,De);return}}Ae&8?(ze&16&&he(Te,ee,ie),ke!==Te&&u(pe,ke)):ze&16?Ae&16?z(Te,ke,pe,ge,ee,ie,ve,we,De):he(Te,ee,ie,!0):(ze&8&&u(pe,""),Ae&16&&S(ke,pe,ge,ee,ie,ve,we,De))},M=(q,J,pe,ge,ee,ie,ve,we,De)=>{q=q||Yl,J=J||Yl;const Te=q.length,ze=J.length,ke=Math.min(Te,ze);let Ve;for(Ve=0;Ve<ke;Ve++){const Ae=J[Ve]=De?Wi(J[Ve]):ys(J[Ve]);g(q[Ve],Ae,pe,null,ee,ie,ve,we,De)}Te>ze?he(q,ee,ie,!0,!1,ke):S(J,pe,ge,ee,ie,ve,we,De,ke)},z=(q,J,pe,ge,ee,ie,ve,we,De)=>{let Te=0;const ze=J.length;let ke=q.length-1,Ve=ze-1;for(;Te<=ke&&Te<=Ve;){const Ae=q[Te],Ge=J[Te]=De?Wi(J[Te]):ys(J[Te]);if(sa(Ae,Ge))g(Ae,Ge,pe,null,ee,ie,ve,we,De);else break;Te++}for(;Te<=ke&&Te<=Ve;){const Ae=q[ke],Ge=J[Ve]=De?Wi(J[Ve]):ys(J[Ve]);if(sa(Ae,Ge))g(Ae,Ge,pe,null,ee,ie,ve,we,De);else break;ke--,Ve--}if(Te>ke){if(Te<=Ve){const Ae=Ve+1,Ge=Ae<ze?J[Ae].el:ge;for(;Te<=Ve;)g(null,J[Te]=De?Wi(J[Te]):ys(J[Te]),pe,Ge,ee,ie,ve,we,De),Te++}}else if(Te>Ve)for(;Te<=ke;)H(q[Te],ee,ie,!0),Te++;else{const Ae=Te,Ge=Te,Ke=new Map;for(Te=Ge;Te<=Ve;Te++){const Et=J[Te]=De?Wi(J[Te]):ys(J[Te]);Et.key!=null&&Ke.set(Et.key,Te)}let Ee,ye=0;const Se=Ve-Ge+1;let Oe=!1,We=0;const ot=new Array(Se);for(Te=0;Te<Se;Te++)ot[Te]=0;for(Te=Ae;Te<=ke;Te++){const Et=q[Te];if(ye>=Se){H(Et,ee,ie,!0);continue}let Ut;if(Et.key!=null)Ut=Ke.get(Et.key);else for(Ee=Ge;Ee<=Ve;Ee++)if(ot[Ee-Ge]===0&&sa(Et,J[Ee])){Ut=Ee;break}Ut===void 0?H(Et,ee,ie,!0):(ot[Ut-Ge]=Te+1,Ut>=We?We=Ut:Oe=!0,g(Et,J[Ut],pe,null,ee,ie,ve,we,De),ye++)}const gt=Oe?UP(ot):Yl;for(Ee=gt.length-1,Te=Se-1;Te>=0;Te--){const Et=Ge+Te,Ut=J[Et],pt=Et+1<ze?J[Et+1].el:ge;ot[Te]===0?g(null,Ut,pe,pt,ee,ie,ve,we,De):Oe&&(Ee<0||Te!==gt[Ee]?G(Ut,pe,pt,2):Ee--)}}},G=(q,J,pe,ge,ee=null)=>{const{el:ie,type:ve,transition:we,children:De,shapeFlag:Te}=q;if(Te&6){G(q.component.subTree,J,pe,ge);return}if(Te&128){q.suspense.move(J,pe,ge);return}if(Te&64){ve.move(q,J,pe,Z);return}if(ve===Fe){n(ie,J,pe);for(let ke=0;ke<De.length;ke++)G(De[ke],J,pe,ge);n(q.anchor,J,pe);return}if(ve===Vo){x(q,J,pe);return}if(ge!==2&&Te&1&&we)if(ge===0)we.beforeEnter(ie),n(ie,J,pe),sn(()=>we.enter(ie),ee);else{const{leave:ke,delayLeave:Ve,afterLeave:Ae}=we,Ge=()=>{q.ctx.isUnmounted?s(ie):n(ie,J,pe)},Ke=()=>{ke(ie,()=>{Ge(),Ae&&Ae()})};Ve?Ve(ie,Ge,Ke):Ke()}else n(ie,J,pe)},H=(q,J,pe,ge=!1,ee=!1)=>{const{type:ie,props:ve,ref:we,children:De,dynamicChildren:Te,shapeFlag:ze,patchFlag:ke,dirs:Ve,cacheIndex:Ae}=q;if(ke===-2&&(ee=!1),we!=null&&(mi(),tc(we,null,pe,q,!0),gi()),Ae!=null&&(J.renderCache[Ae]=void 0),ze&256){J.ctx.deactivate(q);return}const Ge=ze&1&&Ve,Ke=!to(q);let Ee;if(Ke&&(Ee=ve&&ve.onVnodeBeforeUnmount)&&gs(Ee,J,q),ze&6)ne(q.component,pe,ge);else{if(ze&128){q.suspense.unmount(pe,ge);return}Ge&&Ia(q,null,J,"beforeUnmount"),ze&64?q.type.remove(q,J,pe,Z,ge):Te&&!Te.hasOnce&&(ie!==Fe||ke>0&&ke&64)?he(Te,J,pe,!1,!0):(ie===Fe&&ke&384||!ee&&ze&16)&&he(De,J,pe),ge&&j(q)}(Ke&&(Ee=ve&&ve.onVnodeUnmounted)||Ge)&&sn(()=>{Ee&&gs(Ee,J,q),Ge&&Ia(q,null,J,"unmounted")},pe)},j=q=>{const{type:J,el:pe,anchor:ge,transition:ee}=q;if(J===Fe){K(pe,ge);return}if(J===Vo){I(q);return}const ie=()=>{s(pe),ee&&!ee.persisted&&ee.afterLeave&&ee.afterLeave()};if(q.shapeFlag&1&&ee&&!ee.persisted){const{leave:ve,delayLeave:we}=ee,De=()=>ve(pe,ie);we?we(q.el,ie,De):De()}else ie()},K=(q,J)=>{let pe;for(;q!==J;)pe=h(q),s(q),q=pe;s(J)},ne=(q,J,pe)=>{const{bum:ge,scope:ee,job:ie,subTree:ve,um:we,m:De,a:Te,parent:ze,slots:{__:ke}}=q;H0(De),H0(Te),ge&&Zl(ge),ze&&ut(ke)&&ke.forEach(Ve=>{ze.renderCache[Ve]=void 0}),ee.stop(),ie&&(ie.flags|=8,H(ve,q,J,pe)),we&&sn(we,J),sn(()=>{q.isUnmounted=!0},J),J&&J.pendingBranch&&!J.isUnmounted&&q.asyncDep&&!q.asyncResolved&&q.suspenseId===J.pendingId&&(J.deps--,J.deps===0&&J.resolve())},he=(q,J,pe,ge=!1,ee=!1,ie=0)=>{for(let ve=ie;ve<q.length;ve++)H(q[ve],J,pe,ge,ee)},le=q=>{if(q.shapeFlag&6)return le(q.component.subTree);if(q.shapeFlag&128)return q.suspense.next();const J=h(q.anchor||q.el),pe=J&&J[EA];return pe?h(pe):J};let fe=!1;const te=(q,J,pe)=>{q==null?J._vnode&&H(J._vnode,null,null,!0):g(J._vnode||null,q,J,null,null,null,pe),J._vnode=q,fe||(fe=!0,hE(),$0(),fe=!1)},Z={p:g,um:H,m:G,r:j,mt:U,mc:S,pc:N,pbc:T,n:le,o:t};let xe,Q;return e&&([xe,Q]=e(Z)),{render:te,hydrate:xe,createApp:RP(te,xe)}}function nm({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function Co({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function ZA(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function D1(t,e,r=!1){const n=t.children,s=e.children;if(ut(n)&&ut(s))for(let i=0;i<n.length;i++){const a=n[i];let o=s[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[i]=Wi(s[i]),o.el=a.el),!r&&o.patchFlag!==-2&&D1(a,o)),o.type===ro&&(o.el=a.el),o.type===Kr&&!o.el&&(o.el=a.el)}}function UP(t){const e=t.slice(),r=[0];let n,s,i,a,o;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(s=r[r.length-1],t[s]<c){e[n]=s,r.push(n);continue}for(i=0,a=r.length-1;i<a;)o=i+a>>1,t[r[o]]<c?i=o+1:a=o;c<t[r[i]]&&(i>0&&(e[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=e[a];return r}function eT(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:eT(e)}function H0(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const tT=Symbol.for("v-scx"),rT=()=>Ds(tT);function $P(t,e){return Bd(t,null,e)}function VP(t,e){return Bd(t,null,{flush:"post"})}function nT(t,e){return Bd(t,null,{flush:"sync"})}function Vt(t,e,r){return Bd(t,e,r)}function Bd(t,e,r=Qt){const{immediate:n,deep:s,flush:i,once:a}=r,o=xr({},r),l=e&&n||!e&&i!=="post";let c;if(mc){if(i==="sync"){const p=rT();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=Vs,p.resume=Vs,p.pause=Vs,p}}const u=on;o.call=(p,v,g)=>Gs(p,u,v,g);let f=!1;i==="post"?o.scheduler=p=>{sn(p,u&&u.suspense)}:i!=="sync"&&(f=!0,o.scheduler=(p,v)=>{v?p():y1(p)}),o.augmentJob=p=>{e&&(p.flags|=4),f&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const h=D3(t,e,o);return mc&&(c?c.push(h):l&&h()),h}function HP(t,e,r){const n=this.proxy,s=Ar(t)?t.includes(".")?sT(n,t):()=>n[t]:t.bind(n,n);let i;At(e)?i=e:(i=e.handler,r=e);const a=Xo(this),o=Bd(s,i.bind(n),r);return a(),o}function sT(t,e){const r=e.split(".");return()=>{let n=t;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}function jP(t,e,r=Qt){const n=Ks(),s=Cn(e),i=xs(e),a=aT(t,s),o=dA((l,c)=>{let u,f=Qt,h;return nT(()=>{const p=t[s];is(u,p)&&(u=p,c())}),{get(){return l(),r.get?r.get(u):u},set(p){const v=r.set?r.set(p):p;if(!is(v,u)&&!(f!==Qt&&is(p,f)))return;const g=n.vnode.props;g&&(e in g||s in g||i in g)&&(`onUpdate:${e}`in g||`onUpdate:${s}`in g||`onUpdate:${i}`in g)||(u=p,c()),n.emit(`update:${e}`,v),is(p,v)&&is(p,f)&&!is(v,h)&&c(),f=p,h=v}}});return o[Symbol.iterator]=()=>{let l=0;return{next(){return l<2?{value:l++?a||Qt:o,done:!1}:{done:!0}}}},o}const aT=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Cn(e)}Modifiers`]||t[`${xs(e)}Modifiers`];function GP(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||Qt;let s=r;const i=e.startsWith("update:"),a=i&&aT(n,e.slice(7));a&&(a.trim&&(s=r.map(u=>Ar(u)?u.trim():u)),a.number&&(s=r.map(N0)));let o,l=n[o=Iu(e)]||n[o=Iu(Cn(e))];!l&&i&&(l=n[o=Iu(xs(e))]),l&&Gs(l,t,6,s);const c=n[o+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,Gs(c,t,6,s)}}function iT(t,e,r=!1){const n=e.emitsCache,s=n.get(t);if(s!==void 0)return s;const i=t.emits;let a={},o=!1;if(!At(t)){const l=c=>{const u=iT(c,e,!0);u&&(o=!0,xr(a,u))};!r&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!o?(gr(t)&&n.set(t,null),null):(ut(i)?i.forEach(l=>a[l]=null):xr(a,i),gr(t)&&n.set(t,a),a)}function ep(t,e){return!t||!Nd(e)?!1:(e=e.slice(2).replace(/Once$/,""),ur(t,e[0].toLowerCase()+e.slice(1))||ur(t,xs(e))||ur(t,e))}function h0(t){const{type:e,vnode:r,proxy:n,withProxy:s,propsOptions:[i],slots:a,attrs:o,emit:l,render:c,renderCache:u,props:f,data:h,setupState:p,ctx:v,inheritAttrs:g}=t,y=ud(t);let b,E;try{if(r.shapeFlag&4){const I=s||n,D=I;b=ys(c.call(D,I,u,f,p,h,v)),E=o}else{const I=e;b=ys(I.length>1?I(f,{attrs:o,slots:a,emit:l}):I(f,null)),E=e.props?o:zP(o)}}catch(I){Nu.length=0,ll(I,t,1),b=Le(Kr)}let x=b;if(E&&g!==!1){const I=Object.keys(E),{shapeFlag:D}=x;I.length&&D&7&&(i&&I.some(s1)&&(E=KP(E,i)),x=Ma(x,E,!1,!0))}return r.dirs&&(x=Ma(x,null,!1,!0),x.dirs=x.dirs?x.dirs.concat(r.dirs):r.dirs),r.transition&&yi(x,r.transition),b=x,ud(y),b}function WP(t,e=!0){let r;for(let n=0;n<t.length;n++){const s=t[n];if(xi(s)){if(s.type!==Kr||s.children==="v-if"){if(r)return;r=s}}else return}return r}const zP=t=>{let e;for(const r in t)(r==="class"||r==="style"||Nd(r))&&((e||(e={}))[r]=t[r]);return e},KP=(t,e)=>{const r={};for(const n in t)(!s1(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function qP(t,e,r){const{props:n,children:s,component:i}=t,{props:a,children:o,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?TE(n,a,c):!!a;if(l&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const h=u[f];if(a[h]!==n[h]&&!ep(c,h))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?TE(n,a,c):!0:!!a;return!1}function TE(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(e[i]!==t[i]&&!ep(r,i))return!0}return!1}function tp({vnode:t,parent:e},r){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=r,e=e.parent;else break}}const j0=t=>t.__isSuspense;let zg=0;const XP={name:"Suspense",__isSuspense:!0,process(t,e,r,n,s,i,a,o,l,c){if(t==null)QP(e,r,n,s,i,a,o,l,c);else{if(i&&i.deps>0&&!t.suspense.isInFallback){e.suspense=t.suspense,e.suspense.vnode=e,e.el=t.el;return}JP(t,e,r,n,s,a,o,l,c)}},hydrate:ZP,normalize:e8},YP=XP;function fd(t,e){const r=t.props&&t.props[e];At(r)&&r()}function QP(t,e,r,n,s,i,a,o,l){const{p:c,o:{createElement:u}}=l,f=u("div"),h=t.suspense=oT(t,s,n,e,f,r,i,a,o,l);c(null,h.pendingBranch=t.ssContent,f,null,n,h,i,a),h.deps>0?(fd(t,"onPending"),fd(t,"onFallback"),c(null,t.ssFallback,e,r,n,null,i,a),rc(h,t.ssFallback)):h.resolve(!1,!0)}function JP(t,e,r,n,s,i,a,o,{p:l,um:c,o:{createElement:u}}){const f=e.suspense=t.suspense;f.vnode=e,e.el=t.el;const h=e.ssContent,p=e.ssFallback,{activeBranch:v,pendingBranch:g,isInFallback:y,isHydrating:b}=f;if(g)f.pendingBranch=h,sa(h,g)?(l(g,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0?f.resolve():y&&(b||(l(v,p,r,n,s,null,i,a,o),rc(f,p)))):(f.pendingId=zg++,b?(f.isHydrating=!1,f.activeBranch=g):c(g,s,f),f.deps=0,f.effects.length=0,f.hiddenContainer=u("div"),y?(l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0?f.resolve():(l(v,p,r,n,s,null,i,a,o),rc(f,p))):v&&sa(h,v)?(l(v,h,r,n,s,f,i,a,o),f.resolve(!0)):(l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0&&f.resolve()));else if(v&&sa(h,v))l(v,h,r,n,s,f,i,a,o),rc(f,h);else if(fd(e,"onPending"),f.pendingBranch=h,h.shapeFlag&512?f.pendingId=h.component.suspenseId:f.pendingId=zg++,l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0)f.resolve();else{const{timeout:E,pendingId:x}=f;E>0?setTimeout(()=>{f.pendingId===x&&f.fallback(p)},E):E===0&&f.fallback(p)}}function oT(t,e,r,n,s,i,a,o,l,c,u=!1){const{p:f,m:h,um:p,n:v,o:{parentNode:g,remove:y}}=c;let b;const E=t8(t);E&&e&&e.pendingBranch&&(b=e.pendingId,e.deps++);const x=t.props?O0(t.props.timeout):void 0,I=i,D={vnode:t,parent:e,parentComponent:r,namespace:a,container:n,hiddenContainer:s,deps:0,pendingId:zg++,timeout:typeof x=="number"?x:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(P=!1,w=!1){const{vnode:S,activeBranch:m,pendingBranch:T,pendingId:_,effects:A,parentComponent:k,container:U}=D;let L=!1;D.isHydrating?D.isHydrating=!1:P||(L=m&&T.transition&&T.transition.mode==="out-in",L&&(m.transition.afterLeave=()=>{_===D.pendingId&&(h(T,U,i===I?v(m):i,0),ld(A))}),m&&(g(m.el)===U&&(i=v(m)),p(m,k,D,!0)),L||h(T,U,i,0)),rc(D,T),D.pendingBranch=null,D.isInFallback=!1;let R=D.parent,F=!1;for(;R;){if(R.pendingBranch){R.effects.push(...A),F=!0;break}R=R.parent}!F&&!L&&ld(A),D.effects=[],E&&e&&e.pendingBranch&&b===e.pendingId&&(e.deps--,e.deps===0&&!w&&e.resolve()),fd(S,"onResolve")},fallback(P){if(!D.pendingBranch)return;const{vnode:w,activeBranch:S,parentComponent:m,container:T,namespace:_}=D;fd(w,"onFallback");const A=v(S),k=()=>{D.isInFallback&&(f(null,P,T,A,m,null,_,o,l),rc(D,P))},U=P.transition&&P.transition.mode==="out-in";U&&(S.transition.afterLeave=k),D.isInFallback=!0,p(S,m,null,!0),U||k()},move(P,w,S){D.activeBranch&&h(D.activeBranch,P,w,S),D.container=P},next(){return D.activeBranch&&v(D.activeBranch)},registerDep(P,w,S){const m=!!D.pendingBranch;m&&D.deps++;const T=P.vnode.el;P.asyncDep.catch(_=>{ll(_,P,0)}).then(_=>{if(P.isUnmounted||D.isUnmounted||D.pendingId!==P.suspenseId)return;P.asyncResolved=!0;const{vnode:A}=P;Yg(P,_,!1),T&&(A.el=T);const k=!T&&P.subTree.el;w(P,A,g(T||P.subTree.el),T?null:v(P.subTree),D,a,S),k&&y(k),tp(P,A.el),m&&--D.deps===0&&D.resolve()})},unmount(P,w){D.isUnmounted=!0,D.activeBranch&&p(D.activeBranch,r,P,w),D.pendingBranch&&p(D.pendingBranch,r,P,w)}};return D}function ZP(t,e,r,n,s,i,a,o,l){const c=e.suspense=oT(e,n,r,t.parentNode,document.createElement("div"),null,s,i,a,o,!0),u=l(t,c.pendingBranch=e.ssContent,r,c,i,a);return c.deps===0&&c.resolve(!1,!0),u}function e8(t){const{shapeFlag:e,children:r}=t,n=e&32;t.ssContent=wE(n?r.default:r),t.ssFallback=n?wE(r.fallback):Le(Kr)}function wE(t){let e;if(At(t)){const r=qo&&t._c;r&&(t._d=!1,O()),t=t(),r&&(t._d=!0,e=Kn,cT())}return ut(t)&&(t=WP(t)),t=ys(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(r=>r!==t)),t}function lT(t,e){e&&e.pendingBranch?ut(t)?e.effects.push(...t):e.effects.push(t):ld(t)}function rc(t,e){t.activeBranch=e;const{vnode:r,parentComponent:n}=t;let s=e.el;for(;!s&&e.component;)e=e.component.subTree,s=e.el;r.el=s,n&&n.subTree===r&&(n.vnode.el=s,tp(n,s))}function t8(t){const e=t.props&&t.props.suspensible;return e!=null&&e!==!1}const Fe=Symbol.for("v-fgt"),ro=Symbol.for("v-txt"),Kr=Symbol.for("v-cmt"),Vo=Symbol.for("v-stc"),Nu=[];let Kn=null;function O(t=!1){Nu.push(Kn=t?null:[])}function cT(){Nu.pop(),Kn=Nu[Nu.length-1]||null}let qo=1;function Kg(t,e=!1){qo+=t,t<0&&Kn&&e&&(Kn.hasOnce=!0)}function uT(t){return t.dynamicChildren=qo>0?Kn||Yl:null,cT(),qo>0&&Kn&&Kn.push(t),t}function B(t,e,r,n,s,i){return uT(d(t,e,r,n,s,i,!0))}function tr(t,e,r,n,s){return uT(Le(t,e,r,n,s,!0))}function xi(t){return t?t.__v_isVNode===!0:!1}function sa(t,e){return t.type===e.type&&t.key===e.key}function r8(t){}const dT=({key:t})=>t??null,p0=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?Ar(t)||Cr(t)||At(t)?{i:ln,r:t,k:e,f:!!r}:t:null);function d(t,e=null,r=null,n=0,s=null,i=t===Fe?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&dT(e),ref:e&&p0(e),scopeId:qh,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ln};return o?(P1(l,r),i&128&&t.normalize(l)):r&&(l.shapeFlag|=Ar(r)?8:16),qo>0&&!a&&Kn&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Kn.push(l),l}const Le=n8;function n8(t,e=null,r=null,n=0,s=null,i=!1){if((!t||t===MA)&&(t=Kr),xi(t)){const o=Ma(t,e,!0);return r&&P1(o,r),qo>0&&!i&&Kn&&(o.shapeFlag&6?Kn[Kn.indexOf(t)]=o:Kn.push(o)),o.patchFlag=-2,o}if(u8(t)&&(t=t.__vccOpts),e){e=fT(e);let{class:o,style:l}=e;o&&!Ar(o)&&(e.class=Qe(o)),gr(l)&&(zh(l)&&!ut(l)&&(l=xr({},l)),e.style=Nr(l))}const a=Ar(t)?1:j0(t)?128:_A(t)?64:gr(t)?4:At(t)?2:0;return d(t,e,r,n,s,a,i,!0)}function fT(t){return t?zh(t)||GA(t)?xr({},t):t:null}function Ma(t,e,r=!1,n=!1){const{props:s,ref:i,patchFlag:a,children:o,transition:l}=t,c=e?hT(s||{},e):s,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&dT(c),ref:e&&e.ref?r&&i?ut(i)?i.concat(p0(e)):[i,p0(e)]:p0(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Fe?a===-1?16:a|16:a,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ma(t.ssContent),ssFallback:t.ssFallback&&Ma(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&yi(u,l.clone(u)),u}function Ce(t=" ",e=0){return Le(ro,null,t,e)}function In(t,e){const r=Le(Vo,null,t);return r.staticCount=e,r}function _e(t="",e=!1){return e?(O(),tr(Kr,null,t)):Le(Kr,null,t)}function ys(t){return t==null||typeof t=="boolean"?Le(Kr):ut(t)?Le(Fe,null,t.slice()):xi(t)?Wi(t):Le(ro,null,String(t))}function Wi(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ma(t)}function P1(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(ut(e))r=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),P1(t,s()),s._c&&(s._d=!0));return}else{r=32;const s=e._;!s&&!GA(e)?e._ctx=ln:s===3&&ln&&(ln.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else At(e)?(e={default:e,_ctx:ln},r=32):(e=String(e),n&64?(r=16,e=[Ce(e)]):r=8);t.children=e,t.shapeFlag|=r}function hT(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=Qe([e.class,n.class]));else if(s==="style")e.style=Nr([e.style,n.style]);else if(Nd(s)){const i=e[s],a=n[s];a&&i!==a&&!(ut(i)&&i.includes(a))&&(e[s]=i?[].concat(i,a):a)}else s!==""&&(e[s]=n[s])}return e}function gs(t,e,r,n=null){Gs(t,e,7,[r,n])}const s8=$A();let a8=0;function pT(t,e,r){const n=t.type,s=(e?e.appContext:t.appContext)||s8,i={uid:a8++,vnode:t,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new l1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:zA(n,s),emitsOptions:iT(n,s),emit:null,emitted:null,propsDefaults:Qt,inheritAttrs:n.inheritAttrs,ctx:Qt,data:Qt,props:Qt,attrs:Qt,slots:Qt,refs:Qt,setupState:Qt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=GP.bind(null,i),t.ce&&t.ce(i),i}let on=null;const Ks=()=>on||ln;let G0,qg;{const t=$h(),e=(r,n)=>{let s;return(s=t[r])||(s=t[r]=[]),s.push(n),i=>{s.length>1?s.forEach(a=>a(i)):s[0](i)}};G0=e("__VUE_INSTANCE_SETTERS__",r=>on=r),qg=e("__VUE_SSR_SETTERS__",r=>mc=r)}const Xo=t=>{const e=on;return G0(t),t.scope.on(),()=>{t.scope.off(),G0(e)}},Xg=()=>{on&&on.scope.off(),G0(null)};function mT(t){return t.vnode.shapeFlag&4}let mc=!1;function gT(t,e=!1,r=!1){e&&qg(e);const{props:n,children:s}=t.vnode,i=mT(t);FP(t,n,i,e),LP(t,s,r||e);const a=i?i8(t,e):void 0;return e&&qg(!1),a}function i8(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Hg);const{setup:n}=r;if(n){mi();const s=t.setupContext=n.length>1?yT(t):null,i=Xo(t),a=Fc(n,t,0,[t.props,s]),o=i1(a);if(gi(),i(),(o||t.sp)&&!to(t)&&_1(t),o){if(a.then(Xg,Xg),e)return a.then(l=>{Yg(t,l,e)}).catch(l=>{ll(l,t,0)});t.asyncDep=a}else Yg(t,a,e)}else vT(t,e)}function Yg(t,e,r){At(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:gr(e)&&(t.setupState=v1(e)),vT(t,r)}let W0,Qg;function o8(t){W0=t,Qg=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,fP))}}const l8=()=>!W0;function vT(t,e,r){const n=t.type;if(!t.render){if(!e&&W0&&!n.render){const s=n.template||C1(t).template;if(s){const{isCustomElement:i,compilerOptions:a}=t.appContext.config,{delimiters:o,compilerOptions:l}=n,c=xr(xr({isCustomElement:i,delimiters:o},a),l);n.render=W0(s,c)}}t.render=n.render||Vs,Qg&&Qg(t)}{const s=Xo(t);mi();try{wP(t)}finally{gi(),s()}}}const c8={get(t,e){return jn(t,"get",""),t[e]}};function yT(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,c8),slots:t.slots,emit:t.emit,expose:e}}function Ud(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(v1(Kh(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in Ru)return Ru[r](t)},has(e,r){return r in e||r in Ru}})):t.proxy}function Jg(t,e=!0){return At(t)?t.displayName||t.name:t.name||e&&t.__name}function u8(t){return At(t)&&"__vccOpts"in t}const be=(t,e)=>w3(t,e,mc);function Yo(t,e,r){const n=arguments.length;return n===2?gr(e)&&!ut(e)?xi(e)?Le(t,null,[e]):Le(t,e):Le(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&xi(r)&&(r=[r]),Le(t,e,r))}function d8(){}function f8(t,e,r,n){const s=r[n];if(s&&xT(s,t))return s;const i=e();return i.memo=t.slice(),i.cacheIndex=n,r[n]=i}function xT(t,e){const r=t.memo;if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(is(r[n],e[n]))return!1;return qo>0&&Kn&&Kn.push(t),!0}const ET="3.5.17",h8=Vs,p8=O3,m8=Bl,g8=xA,v8={createComponentInstance:pT,setupComponent:gT,renderComponentRoot:h0,setCurrentRenderingInstance:ud,isVNode:xi,normalizeVNode:ys,getComponentPublicInstance:Ud,ensureValidVNode:w1,pushWarningContext:P3,popWarningContext:R3},y8=v8,x8=null,E8=null,_8=null;/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Zg;const CE=typeof window<"u"&&window.trustedTypes;if(CE)try{Zg=CE.createPolicy("vue",{createHTML:t=>t})}catch{}const _T=Zg?t=>Zg.createHTML(t):t=>t,b8="http://www.w3.org/2000/svg",S8="http://www.w3.org/1998/Math/MathML",Qa=typeof document<"u"?document:null,IE=Qa&&Qa.createElement("template"),A8={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const s=e==="svg"?Qa.createElementNS(b8,t):e==="mathml"?Qa.createElementNS(S8,t):r?Qa.createElement(t,{is:r}):Qa.createElement(t);return t==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:t=>Qa.createTextNode(t),createComment:t=>Qa.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Qa.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,s,i){const a=r?r.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{IE.innerHTML=_T(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const o=IE.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,r)}return[a?a.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},Oi="transition",tu="animation",gc=Symbol("_vtc"),bT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ST=xr({},E1,bT),T8=t=>(t.displayName="Transition",t.props=ST,t),w8=T8((t,{slots:e})=>Yo(wA,AT(t),e)),Io=(t,e=[])=>{ut(t)?t.forEach(r=>r(...e)):t&&t(...e)},kE=t=>t?ut(t)?t.some(e=>e.length>1):t.length>1:!1;function AT(t){const e={};for(const A in t)A in bT||(e[A]=t[A]);if(t.css===!1)return e;const{name:r="v",type:n,duration:s,enterFromClass:i=`${r}-enter-from`,enterActiveClass:a=`${r}-enter-active`,enterToClass:o=`${r}-enter-to`,appearFromClass:l=i,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:f=`${r}-leave-from`,leaveActiveClass:h=`${r}-leave-active`,leaveToClass:p=`${r}-leave-to`}=t,v=C8(s),g=v&&v[0],y=v&&v[1],{onBeforeEnter:b,onEnter:E,onEnterCancelled:x,onLeave:I,onLeaveCancelled:D,onBeforeAppear:P=b,onAppear:w=E,onAppearCancelled:S=x}=e,m=(A,k,U,L)=>{A._enterCancelled=L,$i(A,k?u:o),$i(A,k?c:a),U&&U()},T=(A,k)=>{A._isLeaving=!1,$i(A,f),$i(A,p),$i(A,h),k&&k()},_=A=>(k,U)=>{const L=A?w:E,R=()=>m(k,A,U);Io(L,[k,R]),DE(()=>{$i(k,A?l:i),Ta(k,A?u:o),kE(L)||PE(k,n,g,R)})};return xr(e,{onBeforeEnter(A){Io(b,[A]),Ta(A,i),Ta(A,a)},onBeforeAppear(A){Io(P,[A]),Ta(A,l),Ta(A,c)},onEnter:_(!1),onAppear:_(!0),onLeave(A,k){A._isLeaving=!0;const U=()=>T(A,k);Ta(A,f),A._enterCancelled?(Ta(A,h),ev()):(ev(),Ta(A,h)),DE(()=>{A._isLeaving&&($i(A,f),Ta(A,p),kE(I)||PE(A,n,y,U))}),Io(I,[A,U])},onEnterCancelled(A){m(A,!1,void 0,!0),Io(x,[A])},onAppearCancelled(A){m(A,!0,void 0,!0),Io(S,[A])},onLeaveCancelled(A){T(A),Io(D,[A])}})}function C8(t){if(t==null)return null;if(gr(t))return[sm(t.enter),sm(t.leave)];{const e=sm(t);return[e,e]}}function sm(t){return O0(t)}function Ta(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t[gc]||(t[gc]=new Set)).add(e)}function $i(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const r=t[gc];r&&(r.delete(e),r.size||(t[gc]=void 0))}function DE(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let I8=0;function PE(t,e,r,n){const s=t._endId=++I8,i=()=>{s===t._endId&&n()};if(r!=null)return setTimeout(i,r);const{type:a,timeout:o,propCount:l}=TT(t,e);if(!a)return n();const c=a+"end";let u=0;const f=()=>{t.removeEventListener(c,h),i()},h=p=>{p.target===t&&++u>=l&&f()};setTimeout(()=>{u<l&&f()},o+1),t.addEventListener(c,h)}function TT(t,e){const r=window.getComputedStyle(t),n=v=>(r[v]||"").split(", "),s=n(`${Oi}Delay`),i=n(`${Oi}Duration`),a=RE(s,i),o=n(`${tu}Delay`),l=n(`${tu}Duration`),c=RE(o,l);let u=null,f=0,h=0;e===Oi?a>0&&(u=Oi,f=a,h=i.length):e===tu?c>0&&(u=tu,f=c,h=l.length):(f=Math.max(a,c),u=f>0?a>c?Oi:tu:null,h=u?u===Oi?i.length:l.length:0);const p=u===Oi&&/\b(transform|all)(,|$)/.test(n(`${Oi}Property`).toString());return{type:u,timeout:f,propCount:h,hasTransform:p}}function RE(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,n)=>FE(r)+FE(t[n])))}function FE(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function ev(){return document.body.offsetHeight}function k8(t,e,r){const n=t[gc];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const z0=Symbol("_vod"),wT=Symbol("_vsh"),CT={beforeMount(t,{value:e},{transition:r}){t[z0]=t.style.display==="none"?"":t.style.display,r&&e?r.beforeEnter(t):ru(t,e)},mounted(t,{value:e},{transition:r}){r&&e&&r.enter(t)},updated(t,{value:e,oldValue:r},{transition:n}){!e!=!r&&(n?e?(n.beforeEnter(t),ru(t,!0),n.enter(t)):n.leave(t,()=>{ru(t,!1)}):ru(t,e))},beforeUnmount(t,{value:e}){ru(t,e)}};function ru(t,e){t.style.display=e?t[z0]:"none",t[wT]=!e}function D8(){CT.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const IT=Symbol("");function P8(t){const e=Ks();if(!e)return;const r=e.ut=(s=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(i=>K0(i,s))},n=()=>{const s=t(e.proxy);e.ce?K0(e.ce,s):tv(e.subTree,s),r(s)};b1(()=>{ld(n)}),jt(()=>{Vt(n,Vs,{flush:"post"});const s=new MutationObserver(n);s.observe(e.subTree.el.parentNode,{childList:!0}),Va(()=>s.disconnect())})}function tv(t,e){if(t.shapeFlag&128){const r=t.suspense;t=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{tv(r.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)K0(t.el,e);else if(t.type===Fe)t.children.forEach(r=>tv(r,e));else if(t.type===Vo){let{el:r,anchor:n}=t;for(;r&&(K0(r,e),r!==n);)r=r.nextSibling}}function K0(t,e){if(t.nodeType===1){const r=t.style;let n="";for(const s in e)r.setProperty(`--${s}`,e[s]),n+=`--${s}: ${e[s]};`;r[IT]=n}}const R8=/(^|;)\s*display\s*:/;function F8(t,e,r){const n=t.style,s=Ar(r);let i=!1;if(r&&!s){if(e)if(Ar(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&m0(n,o,"")}else for(const a in e)r[a]==null&&m0(n,a,"");for(const a in r)a==="display"&&(i=!0),m0(n,a,r[a])}else if(s){if(e!==r){const a=n[IT];a&&(r+=";"+a),n.cssText=r,i=R8.test(r)}}else e&&t.removeAttribute("style");z0 in t&&(t[z0]=i?n.display:"",t[wT]&&(n.display="none"))}const NE=/\s*!important$/;function m0(t,e,r){if(ut(r))r.forEach(n=>m0(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=N8(t,e);NE.test(r)?t.setProperty(xs(n),r.replace(NE,""),"important"):t[n]=r}}const OE=["Webkit","Moz","ms"],am={};function N8(t,e){const r=am[e];if(r)return r;let n=Cn(e);if(n!=="filter"&&n in t)return am[e]=n;n=Od(n);for(let s=0;s<OE.length;s++){const i=OE[s]+n;if(i in t)return am[e]=i}return e}const ME="http://www.w3.org/1999/xlink";function LE(t,e,r,n,s,i=KD(e)){n&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(ME,e.slice(6,e.length)):t.setAttributeNS(ME,e,r):r==null||i&&!WS(r)?t.removeAttribute(e):t.setAttribute(e,i?"":pa(r)?String(r):r)}function BE(t,e,r,n,s){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?_T(r):r);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const o=i==="OPTION"?t.getAttribute("value")||"":t.value,l=r==null?t.type==="checkbox"?"on":"":String(r);(o!==l||!("_value"in t))&&(t.value=l),r==null&&t.removeAttribute(e),t._value=r;return}let a=!1;if(r===""||r==null){const o=typeof t[e];o==="boolean"?r=WS(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{t[e]=r}catch{}a&&t.removeAttribute(s||e)}function ei(t,e,r,n){t.addEventListener(e,r,n)}function O8(t,e,r,n){t.removeEventListener(e,r,n)}const UE=Symbol("_vei");function M8(t,e,r,n,s=null){const i=t[UE]||(t[UE]={}),a=i[e];if(n&&a)a.value=n;else{const[o,l]=L8(e);if(n){const c=i[e]=$8(n,s);ei(t,o,c,l)}else a&&(O8(t,o,a,l),i[e]=void 0)}}const $E=/(?:Once|Passive|Capture)$/;function L8(t){let e;if($E.test(t)){e={};let n;for(;n=t.match($E);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):xs(t.slice(2)),e]}let im=0;const B8=Promise.resolve(),U8=()=>im||(B8.then(()=>im=0),im=Date.now());function $8(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;Gs(V8(n,r.value),e,5,[n])};return r.value=t,r.attached=U8(),r}function V8(t,e){if(ut(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const VE=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,H8=(t,e,r,n,s,i)=>{const a=s==="svg";e==="class"?k8(t,n,a):e==="style"?F8(t,r,n):Nd(e)?s1(e)||M8(t,e,r,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):j8(t,e,n,a))?(BE(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&LE(t,e,n,a,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Ar(n))?BE(t,Cn(e),n,i,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),LE(t,e,n,a))};function j8(t,e,r,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&VE(e)&&At(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return VE(e)&&Ar(r)?!1:e in t}const HE={};/*! #__NO_SIDE_EFFECTS__ */function kT(t,e,r){const n=Md(t,e);Bh(n)&&xr(n,e);class s extends rp{constructor(a){super(n,a,r)}}return s.def=n,s}/*! #__NO_SIDE_EFFECTS__ */const G8=(t,e)=>kT(t,e,VT),W8=typeof HTMLElement<"u"?HTMLElement:class{};class rp extends W8{constructor(e,r={},n=X0){super(),this._def=e,this._props=r,this._createApp=n,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&n!==X0?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this}connectedCallback(){if(!this.isConnected)return;!this.shadowRoot&&!this._resolved&&this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof rp){this._parent=e;break}this._instance||(this._resolved?this._mount(this._def):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._inheritParentContext(e))}_inheritParentContext(e=this._parent){e&&this._app&&Object.setPrototypeOf(this._app._context.provides,e._instance.provides)}disconnectedCallback(){this._connected=!1,cl(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);this._ob=new MutationObserver(n=>{for(const s of n)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(n,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:i,styles:a}=n;let o;if(i&&!ut(i))for(const l in i){const c=i[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=O0(this._props[l])),(o||(o=Object.create(null)))[Cn(l)]=!0)}this._numberProps=o,this._resolveProps(n),this.shadowRoot&&this._applyStyles(a),this._mount(n)},r=this._def.__asyncLoader;r?this._pendingResolve=r().then(n=>{n.configureApp=this._def.configureApp,e(this._def=n,!0)}):e(this._def)}_mount(e){this._app=this._createApp(e),this._inheritParentContext(),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const r=this._instance&&this._instance.exposed;if(r)for(const n in r)ur(this,n)||Object.defineProperty(this,n,{get:()=>X(r[n])})}_resolveProps(e){const{props:r}=e,n=ut(r)?r:Object.keys(r||{});for(const s of Object.keys(this))s[0]!=="_"&&n.includes(s)&&this._setProp(s,this[s]);for(const s of n.map(Cn))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(i){this._setProp(s,i,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const r=this.hasAttribute(e);let n=r?this.getAttribute(e):HE;const s=Cn(e);r&&this._numberProps&&this._numberProps[s]&&(n=O0(n)),this._setProp(s,n,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,r,n=!0,s=!1){if(r!==this._props[e]&&(r===HE?delete this._props[e]:(this._props[e]=r,e==="key"&&this._app&&(this._app._ceVNode.key=r)),s&&this._instance&&this._update(),n)){const i=this._ob;i&&i.disconnect(),r===!0?this.setAttribute(xs(e),""):typeof r=="string"||typeof r=="number"?this.setAttribute(xs(e),r+""):r||this.removeAttribute(xs(e)),i&&i.observe(this,{attributes:!0})}}_update(){const e=this._createVNode();this._app&&(e.appContext=this._app._context),$T(e,this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const r=Le(this._def,xr(e,this._props));return this._instance||(r.ce=n=>{this._instance=n,n.ce=this,n.isCE=!0;const s=(i,a)=>{this.dispatchEvent(new CustomEvent(i,Bh(a[0])?xr({detail:a},a[0]):{detail:a}))};n.emit=(i,...a)=>{s(i,a),xs(i)!==i&&s(xs(i),a)},this._setParent()}),r}_applyStyles(e,r){if(!e)return;if(r){if(r===this._def||this._styleChildren.has(r))return;this._styleChildren.add(r)}const n=this._nonce;for(let s=e.length-1;s>=0;s--){const i=document.createElement("style");n&&i.setAttribute("nonce",n),i.textContent=e[s],this.shadowRoot.prepend(i)}}_parseSlots(){const e=this._slots={};let r;for(;r=this.firstChild;){const n=r.nodeType===1&&r.getAttribute("slot")||"default";(e[n]||(e[n]=[])).push(r),this.removeChild(r)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),r=this._instance.type.__scopeId;for(let n=0;n<e.length;n++){const s=e[n],i=s.getAttribute("name")||"default",a=this._slots[i],o=s.parentNode;if(a)for(const l of a){if(r&&l.nodeType===1){const c=r+"-s",u=document.createTreeWalker(l,1);l.setAttribute(c,"");let f;for(;f=u.nextNode();)f.setAttribute(c,"")}o.insertBefore(l,s)}else for(;s.firstChild;)o.insertBefore(s.firstChild,s);o.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}function DT(t){const e=Ks(),r=e&&e.ce;return r||null}function z8(){const t=DT();return t&&t.shadowRoot}function K8(t="$style"){{const e=Ks();if(!e)return Qt;const r=e.type.__cssModules;if(!r)return Qt;const n=r[t];return n||Qt}}const PT=new WeakMap,RT=new WeakMap,q0=Symbol("_moveCb"),jE=Symbol("_enterCb"),q8=t=>(delete t.props.mode,t),X8=q8({name:"TransitionGroup",props:xr({},ST,{tag:String,moveClass:String}),setup(t,{slots:e}){const r=Ks(),n=x1();let s,i;return Jh(()=>{if(!s.length)return;const a=t.moveClass||`${t.name||"v"}-move`;if(!eR(s[0].el,r.vnode.el,a)){s=[];return}s.forEach(Q8),s.forEach(J8);const o=s.filter(Z8);ev(),o.forEach(l=>{const c=l.el,u=c.style;Ta(c,a),u.transform=u.webkitTransform=u.transitionDuration="";const f=c[q0]=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",f),c[q0]=null,$i(c,a))};c.addEventListener("transitionend",f)}),s=[]}),()=>{const a=Xt(t),o=AT(a);let l=a.tag||Fe;if(s=[],i)for(let c=0;c<i.length;c++){const u=i[c];u.el&&u.el instanceof Element&&(s.push(u),yi(u,pc(u,o,n,r)),PT.set(u,u.el.getBoundingClientRect()))}i=e.default?Yh(e.default()):[];for(let c=0;c<i.length;c++){const u=i[c];u.key!=null&&yi(u,pc(u,o,n,r))}return Le(l,null,i)}}}),Y8=X8;function Q8(t){const e=t.el;e[q0]&&e[q0](),e[jE]&&e[jE]()}function J8(t){RT.set(t,t.el.getBoundingClientRect())}function Z8(t){const e=PT.get(t),r=RT.get(t),n=e.left-r.left,s=e.top-r.top;if(n||s){const i=t.el.style;return i.transform=i.webkitTransform=`translate(${n}px,${s}px)`,i.transitionDuration="0s",t}}function eR(t,e,r){const n=t.cloneNode(),s=t[gc];s&&s.forEach(o=>{o.split(/\s+/).forEach(l=>l&&n.classList.remove(l))}),r.split(/\s+/).forEach(o=>o&&n.classList.add(o)),n.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(n);const{hasTransform:a}=TT(n);return i.removeChild(n),a}const oo=t=>{const e=t.props["onUpdate:modelValue"]||!1;return ut(e)?r=>Zl(e,r):e};function tR(t){t.target.composing=!0}function GE(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Hs=Symbol("_assign"),ht={created(t,{modifiers:{lazy:e,trim:r,number:n}},s){t[Hs]=oo(s);const i=n||s.props&&s.props.type==="number";ei(t,e?"change":"input",a=>{if(a.target.composing)return;let o=t.value;r&&(o=o.trim()),i&&(o=N0(o)),t[Hs](o)}),r&&ei(t,"change",()=>{t.value=t.value.trim()}),e||(ei(t,"compositionstart",tR),ei(t,"compositionend",GE),ei(t,"change",GE))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:n,trim:s,number:i}},a){if(t[Hs]=oo(a),t.composing)return;const o=(i||t.type==="number")&&!/^0\d/.test(t.value)?N0(t.value):t.value,l=e??"";o!==l&&(document.activeElement===t&&t.type!=="range"&&(n&&e===r||s&&t.value.trim()===l)||(t.value=l))}},wt={deep:!0,created(t,e,r){t[Hs]=oo(r),ei(t,"change",()=>{const n=t._modelValue,s=vc(t),i=t.checked,a=t[Hs];if(ut(n)){const o=Vh(n,s),l=o!==-1;if(i&&!l)a(n.concat(s));else if(!i&&l){const c=[...n];c.splice(o,1),a(c)}}else if(ol(n)){const o=new Set(n);i?o.add(s):o.delete(s),a(o)}else a(FT(t,i))})},mounted:WE,beforeUpdate(t,e,r){t[Hs]=oo(r),WE(t,e,r)}};function WE(t,{value:e,oldValue:r},n){t._modelValue=e;let s;if(ut(e))s=Vh(e,n.props.value)>-1;else if(ol(e))s=e.has(n.props.value);else{if(e===r)return;s=io(e,FT(t,!0))}t.checked!==s&&(t.checked=s)}const ma={created(t,{value:e},r){t.checked=io(e,r.props.value),t[Hs]=oo(r),ei(t,"change",()=>{t[Hs](vc(t))})},beforeUpdate(t,{value:e,oldValue:r},n){t[Hs]=oo(n),e!==r&&(t.checked=io(e,n.props.value))}},cr={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const s=ol(e);ei(t,"change",()=>{const i=Array.prototype.filter.call(t.options,a=>a.selected).map(a=>r?N0(vc(a)):vc(a));t[Hs](t.multiple?s?new Set(i):i:i[0]),t._assigning=!0,cl(()=>{t._assigning=!1})}),t[Hs]=oo(n)},mounted(t,{value:e}){zE(t,e)},beforeUpdate(t,e,r){t[Hs]=oo(r)},updated(t,{value:e}){t._assigning||zE(t,e)}};function zE(t,e){const r=t.multiple,n=ut(e);if(!(r&&!n&&!ol(e))){for(let s=0,i=t.options.length;s<i;s++){const a=t.options[s],o=vc(a);if(r)if(n){const l=typeof o;l==="string"||l==="number"?a.selected=e.some(c=>String(c)===String(o)):a.selected=Vh(e,o)>-1}else a.selected=e.has(o);else if(io(vc(a),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function vc(t){return"_value"in t?t._value:t.value}function FT(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const NT={created(t,e,r){Nf(t,e,r,null,"created")},mounted(t,e,r){Nf(t,e,r,null,"mounted")},beforeUpdate(t,e,r,n){Nf(t,e,r,n,"beforeUpdate")},updated(t,e,r,n){Nf(t,e,r,n,"updated")}};function OT(t,e){switch(t){case"SELECT":return cr;case"TEXTAREA":return ht;default:switch(e){case"checkbox":return wt;case"radio":return ma;default:return ht}}}function Nf(t,e,r,n,s){const a=OT(t.tagName,r.props&&r.props.type)[s];a&&a(t,e,r,n)}function rR(){ht.getSSRProps=({value:t})=>({value:t}),ma.getSSRProps=({value:t},e)=>{if(e.props&&io(e.props.value,t))return{checked:!0}},wt.getSSRProps=({value:t},e)=>{if(ut(t)){if(e.props&&Vh(t,e.props.value)>-1)return{checked:!0}}else if(ol(t)){if(e.props&&t.has(e.props.value))return{checked:!0}}else if(t)return{checked:!0}},NT.getSSRProps=(t,e)=>{if(typeof e.type!="string")return;const r=OT(e.type.toUpperCase(),e.props&&e.props.type);if(r.getSSRProps)return r.getSSRProps(t,e)}}const nR=["ctrl","shift","alt","meta"],sR={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>nR.some(r=>t[`${r}Key`]&&!e.includes(r))},dn=(t,e)=>{const r=t._withMods||(t._withMods={}),n=e.join(".");return r[n]||(r[n]=(s,...i)=>{for(let a=0;a<e.length;a++){const o=sR[e[a]];if(o&&o(s,e))return}return t(s,...i)})},aR={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},MT=(t,e)=>{const r=t._withKeys||(t._withKeys={}),n=e.join(".");return r[n]||(r[n]=s=>{if(!("key"in s))return;const i=xs(s.key);if(e.some(a=>a===i||aR[a]===i))return t(s)})},LT=xr({patchProp:H8},A8);let Ou,KE=!1;function BT(){return Ou||(Ou=YA(LT))}function UT(){return Ou=KE?Ou:QA(LT),KE=!0,Ou}const $T=(...t)=>{BT().render(...t)},iR=(...t)=>{UT().hydrate(...t)},X0=(...t)=>{const e=BT().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=jT(n);if(!s)return;const i=e._component;!At(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const a=r(s,!1,HT(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},e},VT=(...t)=>{const e=UT().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=jT(n);if(s)return r(s,!0,HT(s))},e};function HT(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function jT(t){return Ar(t)?document.querySelector(t):t}let qE=!1;const oR=()=>{qE||(qE=!0,rR(),D8())};/**
* vue v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const lR=()=>{},cR=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:wA,BaseTransitionPropsValidators:E1,Comment:Kr,DeprecationTypes:_8,EffectScope:l1,ErrorCodes:N3,ErrorTypeStrings:p8,Fragment:Fe,KeepAlive:iP,ReactiveEffect:ad,Static:Vo,Suspense:YP,Teleport:H3,Text:ro,TrackOpTypes:C3,Transition:w8,TransitionGroup:Y8,TriggerOpTypes:I3,VueElement:rp,assertNumber:F3,callWithAsyncErrorHandling:Gs,callWithErrorHandling:Fc,camelize:Cn,capitalize:Od,cloneVNode:Ma,compatUtils:E8,compile:lR,computed:be,createApp:X0,createBlock:tr,createCommentVNode:_e,createElementBlock:B,createElementVNode:d,createHydrationRenderer:QA,createPropsRestProxy:AP,createRenderer:YA,createSSRApp:VT,createSlots:uP,createStaticVNode:In,createTextVNode:Ce,createVNode:Le,customRef:dA,defineAsyncComponent:sP,defineComponent:Md,defineCustomElement:kT,defineEmits:pP,defineExpose:mP,defineModel:yP,defineOptions:gP,defineProps:hP,defineSSRCustomElement:G8,defineSlots:vP,devtools:m8,effect:YD,effectScope:c1,getCurrentInstance:Ks,getCurrentScope:u1,getCurrentWatcher:k3,getTransitionRawChildren:Yh,guardReactiveProps:fT,h:Yo,handleError:ll,hasInjectionContext:VA,hydrate:iR,hydrateOnIdle:J3,hydrateOnInteraction:rP,hydrateOnMediaQuery:tP,hydrateOnVisible:eP,initCustomFormatter:d8,initDirectivesForSSR:oR,inject:Ds,isMemoSame:xT,isProxy:zh,isReactive:Pa,isReadonly:vi,isRef:Cr,isRuntimeOnly:l8,isShallow:ks,isVNode:xi,markRaw:Kh,mergeDefaults:bP,mergeModels:SP,mergeProps:hT,nextTick:cl,normalizeClass:Qe,normalizeProps:WD,normalizeStyle:Nr,onActivated:IA,onBeforeMount:PA,onBeforeUnmount:Zh,onBeforeUpdate:b1,onDeactivated:kA,onErrorCaptured:OA,onMounted:jt,onRenderTracked:NA,onRenderTriggered:FA,onScopeDispose:qS,onServerPrefetch:RA,onUnmounted:Va,onUpdated:Jh,onWatcherCleanup:pA,openBlock:O,popScopeId:U3,provide:Fu,proxyRefs:v1,pushScopeId:B3,queuePostFlushCb:ld,reactive:Rs,readonly:m1,ref:se,registerRuntimeCompiler:o8,render:$T,renderList:He,renderSlot:LA,resolveComponent:fr,resolveDirective:cP,resolveDynamicComponent:A1,resolveFilter:x8,resolveTransitionHooks:pc,setBlockTracking:Kg,setDevtoolsHook:g8,setTransitionHooks:yi,shallowReactive:p1,shallowReadonly:g3,shallowRef:g1,ssrContextKey:tT,ssrUtils:y8,stop:QD,toDisplayString:Y,toHandlerKey:Iu,toHandlers:dP,toRaw:Xt,toRef:A3,toRefs:fA,toValue:x3,transformVNodeArgs:r8,triggerRef:y3,unref:X,useAttrs:_P,useCssModule:K8,useCssVars:P8,useHost:DT,useId:G3,useModel:jP,useSSRContext:rT,useShadowRoot:z8,useSlots:EP,useTemplateRef:W3,useTransitionState:x1,vModelCheckbox:wt,vModelDynamic:NT,vModelRadio:ma,vModelSelect:cr,vModelText:ht,vShow:CT,version:ET,warn:h8,watch:Vt,watchEffect:$P,watchPostEffect:VP,watchSyncEffect:nT,withAsyncContext:TP,withCtx:Xh,withDefaults:xP,withDirectives:Be,withKeys:MT,withMemo:f8,withModifiers:dn,withScopeId:$3},Symbol.toStringTag,{value:"Module"}));/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let GT;const np=t=>GT=t,WT=Symbol();function rv(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Mu;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Mu||(Mu={}));function uR(){const t=c1(!0),e=t.run(()=>se({}));let r=[],n=[];const s=Kh({install(i){np(s),s._a=i,i.provide(WT,s),i.config.globalProperties.$pinia=s,n.forEach(a=>r.push(a)),n=[]},use(i){return this._a?r.push(i):n.push(i),this},_p:r,_a:null,_e:t,_s:new Map,state:e});return s}const zT=()=>{};function XE(t,e,r,n=zT){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),n())};return!r&&u1()&&qS(s),s}function Dl(t,...e){t.slice().forEach(r=>{r(...e)})}const dR=t=>t(),YE=Symbol(),om=Symbol();function nv(t,e){t instanceof Map&&e instanceof Map?e.forEach((r,n)=>t.set(n,r)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const r in e){if(!e.hasOwnProperty(r))continue;const n=e[r],s=t[r];rv(s)&&rv(n)&&t.hasOwnProperty(r)&&!Cr(n)&&!Pa(n)?t[r]=nv(s,n):t[r]=n}return t}const fR=Symbol();function hR(t){return!rv(t)||!t.hasOwnProperty(fR)}const{assign:Vi}=Object;function pR(t){return!!(Cr(t)&&t.effect)}function mR(t,e,r,n){const{state:s,actions:i,getters:a}=e,o=r.state.value[t];let l;function c(){o||(r.state.value[t]=s?s():{});const u=fA(r.state.value[t]);return Vi(u,i,Object.keys(a||{}).reduce((f,h)=>(f[h]=Kh(be(()=>{np(r);const p=r._s.get(t);return a[h].call(p,p)})),f),{}))}return l=KT(t,c,e,r,n,!0),l}function KT(t,e,r={},n,s,i){let a;const o=Vi({actions:{}},r),l={deep:!0};let c,u,f=[],h=[],p;const v=n.state.value[t];!i&&!v&&(n.state.value[t]={}),se({});let g;function y(S){let m;c=u=!1,typeof S=="function"?(S(n.state.value[t]),m={type:Mu.patchFunction,storeId:t,events:p}):(nv(n.state.value[t],S),m={type:Mu.patchObject,payload:S,storeId:t,events:p});const T=g=Symbol();cl().then(()=>{g===T&&(c=!0)}),u=!0,Dl(f,m,n.state.value[t])}const b=i?function(){const{state:m}=r,T=m?m():{};this.$patch(_=>{Vi(_,T)})}:zT;function E(){a.stop(),f=[],h=[],n._s.delete(t)}const x=(S,m="")=>{if(YE in S)return S[om]=m,S;const T=function(){np(n);const _=Array.from(arguments),A=[],k=[];function U(F){A.push(F)}function L(F){k.push(F)}Dl(h,{args:_,name:T[om],store:D,after:U,onError:L});let R;try{R=S.apply(this&&this.$id===t?this:D,_)}catch(F){throw Dl(k,F),F}return R instanceof Promise?R.then(F=>(Dl(A,F),F)).catch(F=>(Dl(k,F),Promise.reject(F))):(Dl(A,R),R)};return T[YE]=!0,T[om]=m,T},I={_p:n,$id:t,$onAction:XE.bind(null,h),$patch:y,$reset:b,$subscribe(S,m={}){const T=XE(f,S,m.detached,()=>_()),_=a.run(()=>Vt(()=>n.state.value[t],A=>{(m.flush==="sync"?u:c)&&S({storeId:t,type:Mu.direct,events:p},A)},Vi({},l,m)));return T},$dispose:E},D=Rs(I);n._s.set(t,D);const w=(n._a&&n._a.runWithContext||dR)(()=>n._e.run(()=>(a=c1()).run(()=>e({action:x}))));for(const S in w){const m=w[S];if(Cr(m)&&!pR(m)||Pa(m))i||(v&&hR(m)&&(Cr(m)?m.value=v[S]:nv(m,v[S])),n.state.value[t][S]=m);else if(typeof m=="function"){const T=x(m,S);w[S]=T,o.actions[S]=m}}return Vi(D,w),Vi(Xt(D),w),Object.defineProperty(D,"$state",{get:()=>n.state.value[t],set:S=>{y(m=>{Vi(m,S)})}}),n._p.forEach(S=>{Vi(D,a.run(()=>S({store:D,app:n._a,pinia:n,options:o})))}),v&&i&&r.hydrate&&r.hydrate(D.$state,v),c=!0,u=!0,D}/*! #__NO_SIDE_EFFECTS__ */function qT(t,e,r){let n,s;const i=typeof e=="function";typeof t=="string"?(n=t,s=i?r:e):(s=t,n=t.id);function a(o,l){const c=VA();return o=o||(c?Ds(WT,null):null),o&&np(o),o=GT,o._s.has(n)||(i?KT(n,e,s,o):mR(n,s,o)),o._s.get(n)}return a.$id=n,a}var QE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},gR=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},YT={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,f=(i&3)<<4|o>>4;let h=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(h=64)),n.push(r[u],r[f],r[h],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(XT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const f=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||c==null||f==null)throw new vR;const h=i<<2|o>>4;if(n.push(h),c!==64){const p=o<<4&240|c>>2;if(n.push(p),f!==64){const v=c<<6&192|f;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class vR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yR=function(t){const e=XT(t);return YT.encodeByteArray(e,!0)},Y0=function(t){return yR(t).replace(/\./g,"")},QT=function(t){try{return YT.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER=()=>xR().__FIREBASE_DEFAULTS__,_R=()=>{if(typeof process>"u"||typeof QE>"u")return;const t=QE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},bR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&QT(t[1]);return e&&JSON.parse(e)},sp=()=>{try{return ER()||_R()||bR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},JT=t=>{var e,r;return(r=(e=sp())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},R1=t=>{const e=JT(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},ZT=()=>{var t;return(t=sp())===null||t===void 0?void 0:t.config},ew=t=>{var e;return(e=sp())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Y0(JSON.stringify(r)),Y0(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function AR(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jn())}function TR(){var t;const e=(t=sp())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function wR(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function IR(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kR(){const t=Jn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function DR(){return!TR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PR(){try{return typeof indexedDB=="object"}catch{return!1}}function RR(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR="FirebaseError";class xa extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=FR,Object.setPrototypeOf(this,xa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$d.prototype.create)}}class $d{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?NR(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new xa(s,o,n)}}function NR(t,e){return t.replace(OR,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const OR=/\{\$([^}]+)}/g;function MR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Q0(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(JE(i)&&JE(a)){if(!Q0(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function JE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function LR(t,e){const r=new BR(t,e);return r.subscribe.bind(r)}class BR{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");UR(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=lm),s.error===void 0&&(s.error=lm),s.complete===void 0&&(s.complete=lm);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function UR(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function lm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t){return t&&t._delegate?t._delegate:t}class Ei{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ro="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new SR;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HR(e))try{this.getOrInitializeService({instanceIdentifier:Ro})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=Ro){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ro){return this.instances.has(e)}getOptions(e=Ro){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:VR(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ro){return this.component?this.component.multipleInstances?e:Ro:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VR(t){return t===Ro?void 0:t}function HR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new $R(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Yt||(Yt={}));const GR={debug:Yt.DEBUG,verbose:Yt.VERBOSE,info:Yt.INFO,warn:Yt.WARN,error:Yt.ERROR,silent:Yt.SILENT},WR=Yt.INFO,zR={[Yt.DEBUG]:"log",[Yt.VERBOSE]:"log",[Yt.INFO]:"info",[Yt.WARN]:"warn",[Yt.ERROR]:"error"},KR=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=zR[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class F1{constructor(e){this.name=e,this._logLevel=WR,this._logHandler=KR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Yt.DEBUG,...e),this._logHandler(this,Yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Yt.VERBOSE,...e),this._logHandler(this,Yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Yt.INFO,...e),this._logHandler(this,Yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Yt.WARN,...e),this._logHandler(this,Yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Yt.ERROR,...e),this._logHandler(this,Yt.ERROR,...e)}}const qR=(t,e)=>e.some(r=>t instanceof r);let ZE,e_;function XR(){return ZE||(ZE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function YR(){return e_||(e_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const rw=new WeakMap,sv=new WeakMap,nw=new WeakMap,cm=new WeakMap,N1=new WeakMap;function QR(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(no(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&rw.set(r,t)}).catch(()=>{}),N1.set(e,t),e}function JR(t){if(sv.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});sv.set(t,e)}let av={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return sv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||nw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return no(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function ZR(t){av=t(av)}function eF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(um(this),e,...r);return nw.set(n,e.sort?e.sort():[e]),no(n)}:YR().includes(t)?function(...e){return t.apply(um(this),e),no(rw.get(this))}:function(...e){return no(t.apply(um(this),e))}}function tF(t){return typeof t=="function"?eF(t):(t instanceof IDBTransaction&&JR(t),qR(t,XR())?new Proxy(t,av):t)}function no(t){if(t instanceof IDBRequest)return QR(t);if(cm.has(t))return cm.get(t);const e=tF(t);return e!==t&&(cm.set(t,e),N1.set(e,t)),e}const um=t=>N1.get(t);function rF(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=no(a);return n&&a.addEventListener("upgradeneeded",l=>{n(no(a.result),l.oldVersion,l.newVersion,no(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const nF=["get","getKey","getAll","getAllKeys","count"],sF=["put","add","delete","clear"],dm=new Map;function t_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(dm.get(e))return dm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=sF.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||nF.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return dm.set(e,i),i}ZR(t=>({...t,get:(e,r,n)=>t_(e,r)||t.get(e,r,n),has:(e,r)=>!!t_(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(iF(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function iF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const iv="@firebase/app",r_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i=new F1("@firebase/app"),oF="@firebase/app-compat",lF="@firebase/analytics-compat",cF="@firebase/analytics",uF="@firebase/app-check-compat",dF="@firebase/app-check",fF="@firebase/auth",hF="@firebase/auth-compat",pF="@firebase/database",mF="@firebase/data-connect",gF="@firebase/database-compat",vF="@firebase/functions",yF="@firebase/functions-compat",xF="@firebase/installations",EF="@firebase/installations-compat",_F="@firebase/messaging",bF="@firebase/messaging-compat",SF="@firebase/performance",AF="@firebase/performance-compat",TF="@firebase/remote-config",wF="@firebase/remote-config-compat",CF="@firebase/storage",IF="@firebase/storage-compat",kF="@firebase/firestore",DF="@firebase/vertexai-preview",PF="@firebase/firestore-compat",RF="firebase",FF="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ov="[DEFAULT]",NF={[iv]:"fire-core",[oF]:"fire-core-compat",[cF]:"fire-analytics",[lF]:"fire-analytics-compat",[dF]:"fire-app-check",[uF]:"fire-app-check-compat",[fF]:"fire-auth",[hF]:"fire-auth-compat",[pF]:"fire-rtdb",[mF]:"fire-data-connect",[gF]:"fire-rtdb-compat",[vF]:"fire-fn",[yF]:"fire-fn-compat",[xF]:"fire-iid",[EF]:"fire-iid-compat",[_F]:"fire-fcm",[bF]:"fire-fcm-compat",[SF]:"fire-perf",[AF]:"fire-perf-compat",[TF]:"fire-rc",[wF]:"fire-rc-compat",[CF]:"fire-gcs",[IF]:"fire-gcs-compat",[kF]:"fire-fst",[PF]:"fire-fst-compat",[DF]:"fire-vertex","fire-js":"fire-js",[RF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J0=new Map,OF=new Map,lv=new Map;function n_(t,e){try{t.container.addComponent(e)}catch(r){_i.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function lo(t){const e=t.name;if(lv.has(e))return _i.debug(`There were multiple attempts to register component ${e}.`),!1;lv.set(e,t);for(const r of J0.values())n_(r,t);for(const r of OF.values())n_(r,t);return!0}function Hd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ai(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},so=new $d("app","Firebase",MF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LF{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Ei("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw so.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ul=FF;function sw(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ov,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw so.create("bad-app-name",{appName:String(s)});if(r||(r=ZT()),!r)throw so.create("no-options");const i=J0.get(s);if(i){if(Q0(r,i.options)&&Q0(n,i.config))return i;throw so.create("duplicate-app",{appName:s})}const a=new jR(s);for(const l of lv.values())a.addComponent(l);const o=new LF(r,n,a);return J0.set(s,o),o}function jd(t=ov){const e=J0.get(t);if(!e&&t===ov&&ZT())return sw();if(!e)throw so.create("no-app",{appName:t});return e}function js(t,e,r){var n;let s=(n=NF[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),_i.warn(o.join(" "));return}lo(new Ei(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BF="firebase-heartbeat-database",UF=1,hd="firebase-heartbeat-store";let fm=null;function aw(){return fm||(fm=rF(BF,UF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(hd)}catch(r){console.warn(r)}}}}).catch(t=>{throw so.create("idb-open",{originalErrorMessage:t.message})})),fm}async function $F(t){try{const r=(await aw()).transaction(hd),n=await r.objectStore(hd).get(iw(t));return await r.done,n}catch(e){if(e instanceof xa)_i.warn(e.message);else{const r=so.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});_i.warn(r.message)}}}async function s_(t,e){try{const n=(await aw()).transaction(hd,"readwrite");await n.objectStore(hd).put(e,iw(t)),await n.done}catch(r){if(r instanceof xa)_i.warn(r.message);else{const n=so.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});_i.warn(n.message)}}}function iw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF=1024,HF=30*24*60*60*1e3;class jF{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new WF(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=a_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=HF}),this._storage.overwrite(this._heartbeatsCache))}catch(n){_i.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=a_(),{heartbeatsToSend:n,unsentEntries:s}=GF(this._heartbeatsCache.heartbeats),i=Y0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return _i.warn(r),""}}}function a_(){return new Date().toISOString().substring(0,10)}function GF(t,e=VF){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),i_(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),i_(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class WF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PR()?RR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await $F(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return s_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return s_(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function i_(t){return Y0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zF(t){lo(new Ei("platform-logger",e=>new aF(e),"PRIVATE")),lo(new Ei("heartbeat",e=>new jF(e),"PRIVATE")),js(iv,r_,t),js(iv,r_,"esm2017"),js("fire-js","")}zF("");function O1(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function ow(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const lw=ow,cw=new $d("auth","Firebase",ow());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0=new F1("@firebase/auth");function KF(t,...e){Z0.logLevel<=Yt.WARN&&Z0.warn(`Auth (${ul}): ${t}`,...e)}function g0(t,...e){Z0.logLevel<=Yt.ERROR&&Z0.error(`Auth (${ul}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function La(t,...e){throw L1(t,...e)}function fa(t,...e){return L1(t,...e)}function M1(t,e,r){const n=Object.assign(Object.assign({},lw()),{[e]:r});return new $d("auth","Firebase",n).create(e,{appName:t.name})}function Ho(t){return M1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qF(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&La(t,"argument-error"),M1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function L1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return cw.create(t,...e)}function kt(t,e,...r){if(!t)throw L1(e,...r)}function ii(t){const e="INTERNAL ASSERTION FAILED: "+t;throw g0(e),new Error(e)}function bi(t,e){t||ii(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function XF(){return o_()==="http:"||o_()==="https:"}function o_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(XF()||CR()||"connection"in navigator)?navigator.onLine:!0}function QF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gd{constructor(e,r){this.shortDelay=e,this.longDelay=r,bi(r>e,"Short delay should be less than long delay!"),this.isMobile=AR()||IR()}get(){return YF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B1(t,e){bi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uw{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ii("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ii("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ii("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=new Gd(3e4,6e4);function U1(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Nc(t,e,r,n,s={}){return dw(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=Vd(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return wR()||(c.referrerPolicy="no-referrer"),uw.fetch()(fw(t,t.config.apiHost,r,o),c)})}async function dw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},JF),e);try{const s=new t6(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Of(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Of(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Of(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Of(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw M1(t,u,c);La(t,u)}}catch(s){if(s instanceof xa)throw s;La(t,"network-request-failed",{message:String(s)})}}async function e6(t,e,r,n,s={}){const i=await Nc(t,e,r,n,s);return"mfaPendingCredential"in i&&La(t,"multi-factor-auth-required",{_serverResponse:i}),i}function fw(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?B1(t.config,s):`${t.config.apiScheme}://${s}`}class t6{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(fa(this.auth,"network-request-failed")),ZF.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Of(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=fa(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r6(t,e){return Nc(t,"POST","/v1/accounts:delete",e)}async function hw(t,e){return Nc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(t,e=!1){return dr(t).getIdToken(e)}async function mw(t,e=!1){const r=dr(t),n=await r.getIdToken(e),s=$1(n);kt(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Lu(hm(s.auth_time)),issuedAtTime:Lu(hm(s.iat)),expirationTime:Lu(hm(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function hm(t){return Number(t)*1e3}function $1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return g0("JWT malformed, contained fewer than 3 sections"),null;try{const s=QT(r);return s?JSON.parse(s):(g0("Failed to decode base64 JWT payload"),null)}catch(s){return g0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function l_(t){const e=$1(t);return kt(e,"internal-error"),kt(typeof e.exp<"u","internal-error"),kt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pd(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof xa&&n6(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function n6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lu(this.lastLoginAt),this.creationTime=Lu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eh(t){var e;const r=t.auth,n=await t.getIdToken(),s=await pd(t,hw(r,{idToken:n}));kt(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?vw(i.providerUserInfo):[],o=a6(t.providerData,a),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new uv(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function gw(t){const e=dr(t);await eh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function a6(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function vw(t){return t.map(e=>{var{providerId:r}=e,n=O1(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i6(t,e){const r=await dw(t,{},async()=>{const n=Vd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=fw(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",uw.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function o6(t,e){return Nc(t,"POST","/v2/accounts:revokeToken",U1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){kt(e.idToken,"internal-error"),kt(typeof e.idToken<"u","internal-error"),kt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):l_(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){kt(e.length!==0,"internal-error");const r=l_(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(kt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await i6(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new nc;return n&&(kt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(kt(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(kt(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nc,this.toJSON())}_performRefresh(){return ii("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(t,e){kt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class oi{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=O1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new s6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new uv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await pd(this,this.stsTokenManager.getToken(this.auth,e));return kt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return mw(this,e)}reload(){return gw(this)}_assign(e){this!==e&&(kt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new oi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){kt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await eh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ai(this.auth.app))return Promise.reject(Ho(this.auth));const e=await this.getIdToken();return await pd(this,r6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(s=r.email)!==null&&s!==void 0?s:void 0,p=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,g=(o=r.tenantId)!==null&&o!==void 0?o:void 0,y=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,b=(c=r.createdAt)!==null&&c!==void 0?c:void 0,E=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:x,emailVerified:I,isAnonymous:D,providerData:P,stsTokenManager:w}=r;kt(x&&w,e,"internal-error");const S=nc.fromJSON(this.name,w);kt(typeof x=="string",e,"internal-error"),Mi(f,e.name),Mi(h,e.name),kt(typeof I=="boolean",e,"internal-error"),kt(typeof D=="boolean",e,"internal-error"),Mi(p,e.name),Mi(v,e.name),Mi(g,e.name),Mi(y,e.name),Mi(b,e.name),Mi(E,e.name);const m=new oi({uid:x,auth:e,email:h,emailVerified:I,displayName:f,isAnonymous:D,photoURL:v,phoneNumber:p,tenantId:g,stsTokenManager:S,createdAt:b,lastLoginAt:E});return P&&Array.isArray(P)&&(m.providerData=P.map(T=>Object.assign({},T))),y&&(m._redirectEventId=y),m}static async _fromIdTokenResponse(e,r,n=!1){const s=new nc;s.updateFromServerResponse(r);const i=new oi({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await eh(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];kt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?vw(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new nc;o.updateFromIdToken(n);const l=new oi({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new uv(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c_=new Map;function li(t){bi(t instanceof Function,"Expected a class definition");let e=c_.get(t);return e?(bi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,c_.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}yw.type="NONE";const dv=yw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0(t,e,r){return`firebase:${t}:${e}:${r}`}class sc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=v0(this.userKey,s.apiKey,i),this.fullPersistenceKey=v0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?oi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new sc(li(dv),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||li(dv);const a=v0(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=oi._fromJSON(e,u);c!==i&&(o=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new sc(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new sc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u_(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Aw(e))return"Blackberry";if(Tw(e))return"Webos";if(Ew(e))return"Safari";if((e.includes("chrome/")||_w(e))&&!e.includes("edge/"))return"Chrome";if(Sw(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function xw(t=Jn()){return/firefox\//i.test(t)}function Ew(t=Jn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function _w(t=Jn()){return/crios\//i.test(t)}function bw(t=Jn()){return/iemobile/i.test(t)}function Sw(t=Jn()){return/android/i.test(t)}function Aw(t=Jn()){return/blackberry/i.test(t)}function Tw(t=Jn()){return/webos/i.test(t)}function V1(t=Jn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function l6(t=Jn()){var e;return V1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function c6(){return kR()&&document.documentMode===10}function ww(t=Jn()){return V1(t)||Sw(t)||Tw(t)||Aw(t)||/windows phone/i.test(t)||bw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw(t,e=[]){let r;switch(t){case"Browser":r=u_(Jn());break;case"Worker":r=`${u_(Jn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${ul}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d6(t,e={}){return Nc(t,"GET","/v2/passwordPolicy",U1(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f6=6;class h6{constructor(e){var r,n,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:f6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p6{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new d_(this),this.idTokenSubscription=new d_(this),this.beforeStateQueue=new u6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=li(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await sc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await hw(this,{idToken:e}),n=await oi._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(ai(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return kt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await eh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=QF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ai(this.app))return Promise.reject(Ho(this));const r=e?dr(e):null;return r&&kt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&kt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ai(this.app)?Promise.reject(Ho(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ai(this.app)?Promise.reject(Ho(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(li(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await d6(this),r=new h6(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new $d("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await o6(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&li(e)||this._popupRedirectResolver;kt(r,this,"argument-error"),this.redirectPersistenceManager=await sc.create(this,[li(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(kt(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return kt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Cw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&KF(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function ap(t){return dr(t)}class d_{constructor(e){this.auth=e,this.observer=null,this.addObserver=LR(r=>this.observer=r)}get next(){return kt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let H1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function m6(t){H1=t}function g6(t){return H1.loadJS(t)}function v6(){return H1.gapiScript}function y6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iw(t,e){const r=Hd(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(Q0(i,e??{}))return s;La(s,"already-initialized")}return r.initialize({options:e})}function x6(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(li);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function kw(t,e,r){const n=ap(t);kt(n._canInitEmulator,n,"emulator-config-failed"),kt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=Dw(e),{host:a,port:o}=E6(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${i}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),_6()}function Dw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function E6(t){const e=Dw(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:f_(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:f_(a)}}}function f_(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function _6(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return ii("not implemented")}_getIdTokenResponse(e){return ii("not implemented")}_linkToIdToken(e,r){return ii("not implemented")}_getReauthenticationResolver(e){return ii("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ac(t,e){return e6(t,"POST","/v1/accounts:signInWithIdp",U1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6="http://localhost";class co extends j1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new co(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):La("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=O1(r,["providerId","signInMethod"]);if(!n||!s)return null;const a=new co(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return ac(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,ac(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,ac(e,r)}buildRequest(){const e={requestUri:b6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Vd(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd extends G1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti extends Wd{constructor(){super("facebook.com")}static credential(e){return co._fromParams({providerId:ti.PROVIDER_ID,signInMethod:ti.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ti.credentialFromTaggedObject(e)}static credentialFromError(e){return ti.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ti.credential(e.oauthAccessToken)}catch{return null}}}ti.FACEBOOK_SIGN_IN_METHOD="facebook.com";ti.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa extends Wd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return co._fromParams({providerId:aa.PROVIDER_ID,signInMethod:aa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return aa.credentialFromTaggedObject(e)}static credentialFromError(e){return aa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return aa.credential(r,n)}catch{return null}}}aa.GOOGLE_SIGN_IN_METHOD="google.com";aa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri extends Wd{constructor(){super("github.com")}static credential(e){return co._fromParams({providerId:ri.PROVIDER_ID,signInMethod:ri.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ri.credentialFromTaggedObject(e)}static credentialFromError(e){return ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ri.credential(e.oauthAccessToken)}catch{return null}}}ri.GITHUB_SIGN_IN_METHOD="github.com";ri.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni extends Wd{constructor(){super("twitter.com")}static credential(e,r){return co._fromParams({providerId:ni.PROVIDER_ID,signInMethod:ni.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ni.credentialFromTaggedObject(e)}static credentialFromError(e){return ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ni.credential(r,n)}catch{return null}}}ni.TWITTER_SIGN_IN_METHOD="twitter.com";ni.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await oi._fromIdTokenResponse(e,n,s),a=h_(n);return new yc({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=h_(n);return new yc({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function h_(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th extends xa{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,th.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new th(e,r,n,s)}}function Pw(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?th._fromErrorAndOperation(t,i,e,n):i})}async function S6(t,e,r=!1){const n=await pd(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return yc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A6(t,e,r=!1){const{auth:n}=t;if(ai(n.app))return Promise.reject(Ho(n));const s="reauthenticate";try{const i=await pd(t,Pw(n,s,e,t),r);kt(i.idToken,n,"internal-error");const a=$1(i.idToken);kt(a,n,"internal-error");const{sub:o}=a;return kt(t.uid===o,n,"user-mismatch"),yc._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&La(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T6(t,e,r=!1){if(ai(t.app))return Promise.reject(Ho(t));const n="signIn",s=await Pw(t,n,e),i=await yc._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function Rw(t,e,r,n){return dr(t).onIdTokenChanged(e,r,n)}function Fw(t,e,r){return dr(t).beforeAuthStateChanged(e,r)}function ip(t,e,r,n){return dr(t).onAuthStateChanged(e,r,n)}function op(t){return dr(t).signOut()}const rh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(rh,"1"),this.storage.removeItem(rh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w6=1e3,C6=10;class Ow extends Nw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ww(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);c6()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,C6):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},w6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ow.type="LOCAL";const Mw=Ow;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw extends Nw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Lw.type="SESSION";const W1=Lw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new lp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(r.origin,i)),l=await I6(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}lp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=z1("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(h.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(){return window}function D6(t){Ra().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bw(){return typeof Ra().WorkerGlobalScope<"u"&&typeof Ra().importScripts=="function"}async function P6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function R6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function F6(){return Bw()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uw="firebaseLocalStorageDb",N6=1,nh="firebaseLocalStorage",$w="fbase_key";class zd{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function cp(t,e){return t.transaction([nh],e?"readwrite":"readonly").objectStore(nh)}function O6(){const t=indexedDB.deleteDatabase(Uw);return new zd(t).toPromise()}function fv(){const t=indexedDB.open(Uw,N6);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(nh,{keyPath:$w})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(nh)?e(n):(n.close(),await O6(),e(await fv()))})})}async function p_(t,e,r){const n=cp(t,!0).put({[$w]:e,value:r});return new zd(n).toPromise()}async function M6(t,e){const r=cp(t,!1).get(e),n=await new zd(r).toPromise();return n===void 0?null:n.value}function m_(t,e){const r=cp(t,!0).delete(e);return new zd(r).toPromise()}const L6=800,B6=3;class Vw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fv(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>B6)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Bw()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=lp._getInstance(F6()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await P6(),!this.activeServiceWorker)return;this.sender=new k6(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||R6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fv();return await p_(e,rh,"1"),await m_(e,rh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>p_(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>M6(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>m_(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=cp(s,!1).getAll();return new zd(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),L6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Vw.type="LOCAL";const Hw=Vw;new Gd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(t,e){return e?li(e):(kt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1 extends j1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ac(e,this._buildIdpRequest())}_linkToIdToken(e,r){return ac(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return ac(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function U6(t){return T6(t.auth,new K1(t),t.bypassAuthState)}function $6(t){const{auth:e,user:r}=t;return kt(r,e,"internal-error"),A6(r,new K1(t),t.bypassAuthState)}async function V6(t){const{auth:e,user:r}=t;return kt(r,e,"internal-error"),S6(r,new K1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return U6;case"linkViaPopup":case"linkViaRedirect":return V6;case"reauthViaPopup":case"reauthViaRedirect":return $6;default:La(this.auth,"internal-error")}}resolve(e){bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){bi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H6=new Gd(2e3,1e4);async function q1(t,e,r){if(ai(t.app))return Promise.reject(fa(t,"operation-not-supported-in-this-environment"));const n=ap(t);qF(t,e,G1);const s=jw(n,r);return new Oo(n,"signInViaPopup",e,s).executeNotNull()}class Oo extends Gw{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Oo.currentPopupAction&&Oo.currentPopupAction.cancel(),Oo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return kt(e,this.auth,"internal-error"),e}async onExecution(){bi(this.filter.length===1,"Popup operations only handle one event");const e=z1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(fa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(fa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Oo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,H6.get())};e()}}Oo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6="pendingRedirect",y0=new Map;class G6 extends Gw{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=y0.get(this.auth._key());if(!e){try{const n=await W6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}y0.set(this.auth._key(),e)}return this.bypassAuthState||y0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function W6(t,e){const r=q6(e),n=K6(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function z6(t,e){y0.set(t._key(),e)}function K6(t){return li(t._redirectPersistence)}function q6(t){return v0(j6,t.config.apiKey,t.name)}async function X6(t,e,r=!1){if(ai(t.app))return Promise.reject(Ho(t));const n=ap(t),s=jw(n,e),a=await new G6(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6=10*60*1e3;class Q6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!J6(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!Ww(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(fa(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Y6&&this.cachedEventUids.clear(),this.cachedEventUids.has(g_(e))}saveEventToCache(e){this.cachedEventUids.add(g_(e)),this.lastProcessedEventTime=Date.now()}}function g_(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Ww({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function J6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ww(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z6(t,e={}){return Nc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,t5=/^https?/;async function r5(t){if(t.config.emulator)return;const{authorizedDomains:e}=await Z6(t);for(const r of e)try{if(n5(r))return}catch{}La(t,"unauthorized-domain")}function n5(t){const e=cv(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!t5.test(r))return!1;if(e5.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=new Gd(3e4,6e4);function v_(){const t=Ra().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function a5(t){return new Promise((e,r)=>{var n,s,i;function a(){v_(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{v_(),r(fa(t,"network-request-failed"))},timeout:s5.get()})}if(!((s=(n=Ra().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Ra().gapi)===null||i===void 0)&&i.load)a();else{const o=y6("iframefcb");return Ra()[o]=()=>{gapi.load?a():r(fa(t,"network-request-failed"))},g6(`${v6()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw x0=null,e})}let x0=null;function i5(t){return x0=x0||a5(t),x0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o5=new Gd(5e3,15e3),l5="__/auth/iframe",c5="emulator/auth/iframe",u5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},d5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function f5(t){const e=t.config;kt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?B1(e,c5):`https://${t.config.authDomain}/${l5}`,n={apiKey:e.apiKey,appName:t.name,v:ul},s=d5.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Vd(n).slice(1)}`}async function h5(t){const e=await i5(t),r=Ra().gapi;return kt(r,t,"internal-error"),e.open({where:document.body,url:f5(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:u5,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=fa(t,"network-request-failed"),o=Ra().setTimeout(()=>{i(a)},o5.get());function l(){Ra().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},m5=500,g5=600,v5="_blank",y5="http://localhost";class y_{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function x5(t,e,r,n=m5,s=g5){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},p5),{width:n.toString(),height:s.toString(),top:i,left:a}),c=Jn().toLowerCase();r&&(o=_w(c)?v5:r),xw(c)&&(e=e||y5,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[p,v])=>`${h}${p}=${v},`,"");if(l6(c)&&o!=="_self")return E5(e||"",o),new y_(null);const f=window.open(e||"",o,u);kt(f,t,"popup-blocked");try{f.focus()}catch{}return new y_(f)}function E5(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _5="__/auth/handler",b5="emulator/auth/handler",S5=encodeURIComponent("fac");async function x_(t,e,r,n,s,i){kt(t.config.authDomain,t,"auth-domain-config-required"),kt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:ul,eventId:s};if(e instanceof G1){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",MR(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries({}))a[u]=f}if(e instanceof Wd){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${S5}=${encodeURIComponent(l)}`:"";return`${A5(t)}?${Vd(o).slice(1)}${c}`}function A5({config:t}){return t.emulator?B1(t,b5):`https://${t.authDomain}/${_5}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm="webStorageSupport";class T5{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=W1,this._completeRedirectFn=X6,this._overrideRedirectResult=z6}async _openPopup(e,r,n,s){var i;bi((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await x_(e,r,n,cv(),s);return x5(e,a,z1())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await x_(e,r,n,cv(),s);return D6(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(bi(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await h5(e),n=new Q6(e);return r.register("authEvent",s=>(kt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(pm,{type:pm},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[pm];a!==void 0&&r(!!a),La(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=r5(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return ww()||Ew()||V1()}}const zw=T5;var E_="@firebase/auth",__="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){kt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C5(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function I5(t){lo(new Ei("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;kt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Cw(t)},c=new p6(n,s,i,l);return x6(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),lo(new Ei("auth-internal",e=>{const r=ap(e.getProvider("auth").getImmediate());return(n=>new w5(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),js(E_,__,C5(t)),js(E_,__,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k5=5*60,D5=ew("authIdTokenMaxAge")||k5;let b_=null;const P5=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>D5)return;const s=r==null?void 0:r.token;b_!==s&&(b_=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Qo(t=jd()){const e=Hd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Iw(t,{popupRedirectResolver:zw,persistence:[Hw,Mw,W1]}),n=ew("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=P5(i.toString());Fw(r,a,()=>a(r.currentUser)),Rw(r,o=>a(o))}}const s=JT("auth");return s&&kw(r,`http://${s}`),r}function R5(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}m6({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=fa("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",R5().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});I5("Browser");const F5=Object.freeze(Object.defineProperty({__proto__:null,AuthCredential:j1,FacebookAuthProvider:ti,GithubAuthProvider:ri,GoogleAuthProvider:aa,OAuthCredential:co,TwitterAuthProvider:ni,beforeAuthStateChanged:Fw,browserLocalPersistence:Mw,browserPopupRedirectResolver:zw,browserSessionPersistence:W1,connectAuthEmulator:kw,getAuth:Qo,getIdToken:pw,getIdTokenResult:mw,inMemoryPersistence:dv,indexedDBLocalPersistence:Hw,initializeAuth:Iw,onAuthStateChanged:ip,onIdTokenChanged:Rw,prodErrorMap:lw,reload:gw,signInWithPopup:q1,signOut:op},Symbol.toStringTag,{value:"Module"}));var S_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var jo,Kw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,S){function m(){}m.prototype=S.prototype,w.D=S.prototype,w.prototype=new m,w.prototype.constructor=w,w.C=function(T,_,A){for(var k=Array(arguments.length-2),U=2;U<arguments.length;U++)k[U-2]=arguments[U];return S.prototype[_].apply(T,k)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,S,m){m||(m=0);var T=Array(16);if(typeof S=="string")for(var _=0;16>_;++_)T[_]=S.charCodeAt(m++)|S.charCodeAt(m++)<<8|S.charCodeAt(m++)<<16|S.charCodeAt(m++)<<24;else for(_=0;16>_;++_)T[_]=S[m++]|S[m++]<<8|S[m++]<<16|S[m++]<<24;S=w.g[0],m=w.g[1],_=w.g[2];var A=w.g[3],k=S+(A^m&(_^A))+T[0]+3614090360&4294967295;S=m+(k<<7&4294967295|k>>>25),k=A+(_^S&(m^_))+T[1]+3905402710&4294967295,A=S+(k<<12&4294967295|k>>>20),k=_+(m^A&(S^m))+T[2]+606105819&4294967295,_=A+(k<<17&4294967295|k>>>15),k=m+(S^_&(A^S))+T[3]+3250441966&4294967295,m=_+(k<<22&4294967295|k>>>10),k=S+(A^m&(_^A))+T[4]+4118548399&4294967295,S=m+(k<<7&4294967295|k>>>25),k=A+(_^S&(m^_))+T[5]+1200080426&4294967295,A=S+(k<<12&4294967295|k>>>20),k=_+(m^A&(S^m))+T[6]+2821735955&4294967295,_=A+(k<<17&4294967295|k>>>15),k=m+(S^_&(A^S))+T[7]+4249261313&4294967295,m=_+(k<<22&4294967295|k>>>10),k=S+(A^m&(_^A))+T[8]+1770035416&4294967295,S=m+(k<<7&4294967295|k>>>25),k=A+(_^S&(m^_))+T[9]+2336552879&4294967295,A=S+(k<<12&4294967295|k>>>20),k=_+(m^A&(S^m))+T[10]+4294925233&4294967295,_=A+(k<<17&4294967295|k>>>15),k=m+(S^_&(A^S))+T[11]+2304563134&4294967295,m=_+(k<<22&4294967295|k>>>10),k=S+(A^m&(_^A))+T[12]+1804603682&4294967295,S=m+(k<<7&4294967295|k>>>25),k=A+(_^S&(m^_))+T[13]+4254626195&4294967295,A=S+(k<<12&4294967295|k>>>20),k=_+(m^A&(S^m))+T[14]+2792965006&4294967295,_=A+(k<<17&4294967295|k>>>15),k=m+(S^_&(A^S))+T[15]+1236535329&4294967295,m=_+(k<<22&4294967295|k>>>10),k=S+(_^A&(m^_))+T[1]+4129170786&4294967295,S=m+(k<<5&4294967295|k>>>27),k=A+(m^_&(S^m))+T[6]+3225465664&4294967295,A=S+(k<<9&4294967295|k>>>23),k=_+(S^m&(A^S))+T[11]+643717713&4294967295,_=A+(k<<14&4294967295|k>>>18),k=m+(A^S&(_^A))+T[0]+3921069994&4294967295,m=_+(k<<20&4294967295|k>>>12),k=S+(_^A&(m^_))+T[5]+3593408605&4294967295,S=m+(k<<5&4294967295|k>>>27),k=A+(m^_&(S^m))+T[10]+38016083&4294967295,A=S+(k<<9&4294967295|k>>>23),k=_+(S^m&(A^S))+T[15]+3634488961&4294967295,_=A+(k<<14&4294967295|k>>>18),k=m+(A^S&(_^A))+T[4]+3889429448&4294967295,m=_+(k<<20&4294967295|k>>>12),k=S+(_^A&(m^_))+T[9]+568446438&4294967295,S=m+(k<<5&4294967295|k>>>27),k=A+(m^_&(S^m))+T[14]+3275163606&4294967295,A=S+(k<<9&4294967295|k>>>23),k=_+(S^m&(A^S))+T[3]+4107603335&4294967295,_=A+(k<<14&4294967295|k>>>18),k=m+(A^S&(_^A))+T[8]+1163531501&4294967295,m=_+(k<<20&4294967295|k>>>12),k=S+(_^A&(m^_))+T[13]+2850285829&4294967295,S=m+(k<<5&4294967295|k>>>27),k=A+(m^_&(S^m))+T[2]+4243563512&4294967295,A=S+(k<<9&4294967295|k>>>23),k=_+(S^m&(A^S))+T[7]+1735328473&4294967295,_=A+(k<<14&4294967295|k>>>18),k=m+(A^S&(_^A))+T[12]+2368359562&4294967295,m=_+(k<<20&4294967295|k>>>12),k=S+(m^_^A)+T[5]+4294588738&4294967295,S=m+(k<<4&4294967295|k>>>28),k=A+(S^m^_)+T[8]+2272392833&4294967295,A=S+(k<<11&4294967295|k>>>21),k=_+(A^S^m)+T[11]+1839030562&4294967295,_=A+(k<<16&4294967295|k>>>16),k=m+(_^A^S)+T[14]+4259657740&4294967295,m=_+(k<<23&4294967295|k>>>9),k=S+(m^_^A)+T[1]+2763975236&4294967295,S=m+(k<<4&4294967295|k>>>28),k=A+(S^m^_)+T[4]+1272893353&4294967295,A=S+(k<<11&4294967295|k>>>21),k=_+(A^S^m)+T[7]+4139469664&4294967295,_=A+(k<<16&4294967295|k>>>16),k=m+(_^A^S)+T[10]+3200236656&4294967295,m=_+(k<<23&4294967295|k>>>9),k=S+(m^_^A)+T[13]+681279174&4294967295,S=m+(k<<4&4294967295|k>>>28),k=A+(S^m^_)+T[0]+3936430074&4294967295,A=S+(k<<11&4294967295|k>>>21),k=_+(A^S^m)+T[3]+3572445317&4294967295,_=A+(k<<16&4294967295|k>>>16),k=m+(_^A^S)+T[6]+76029189&4294967295,m=_+(k<<23&4294967295|k>>>9),k=S+(m^_^A)+T[9]+3654602809&4294967295,S=m+(k<<4&4294967295|k>>>28),k=A+(S^m^_)+T[12]+3873151461&4294967295,A=S+(k<<11&4294967295|k>>>21),k=_+(A^S^m)+T[15]+530742520&4294967295,_=A+(k<<16&4294967295|k>>>16),k=m+(_^A^S)+T[2]+3299628645&4294967295,m=_+(k<<23&4294967295|k>>>9),k=S+(_^(m|~A))+T[0]+4096336452&4294967295,S=m+(k<<6&4294967295|k>>>26),k=A+(m^(S|~_))+T[7]+1126891415&4294967295,A=S+(k<<10&4294967295|k>>>22),k=_+(S^(A|~m))+T[14]+2878612391&4294967295,_=A+(k<<15&4294967295|k>>>17),k=m+(A^(_|~S))+T[5]+4237533241&4294967295,m=_+(k<<21&4294967295|k>>>11),k=S+(_^(m|~A))+T[12]+1700485571&4294967295,S=m+(k<<6&4294967295|k>>>26),k=A+(m^(S|~_))+T[3]+2399980690&4294967295,A=S+(k<<10&4294967295|k>>>22),k=_+(S^(A|~m))+T[10]+4293915773&4294967295,_=A+(k<<15&4294967295|k>>>17),k=m+(A^(_|~S))+T[1]+2240044497&4294967295,m=_+(k<<21&4294967295|k>>>11),k=S+(_^(m|~A))+T[8]+1873313359&4294967295,S=m+(k<<6&4294967295|k>>>26),k=A+(m^(S|~_))+T[15]+4264355552&4294967295,A=S+(k<<10&4294967295|k>>>22),k=_+(S^(A|~m))+T[6]+2734768916&4294967295,_=A+(k<<15&4294967295|k>>>17),k=m+(A^(_|~S))+T[13]+1309151649&4294967295,m=_+(k<<21&4294967295|k>>>11),k=S+(_^(m|~A))+T[4]+4149444226&4294967295,S=m+(k<<6&4294967295|k>>>26),k=A+(m^(S|~_))+T[11]+3174756917&4294967295,A=S+(k<<10&4294967295|k>>>22),k=_+(S^(A|~m))+T[2]+718787259&4294967295,_=A+(k<<15&4294967295|k>>>17),k=m+(A^(_|~S))+T[9]+3951481745&4294967295,w.g[0]=w.g[0]+S&4294967295,w.g[1]=w.g[1]+(_+(k<<21&4294967295|k>>>11))&4294967295,w.g[2]=w.g[2]+_&4294967295,w.g[3]=w.g[3]+A&4294967295}n.prototype.u=function(w,S){S===void 0&&(S=w.length);for(var m=S-this.blockSize,T=this.B,_=this.h,A=0;A<S;){if(_==0)for(;A<=m;)s(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<S;)if(T[_++]=w.charCodeAt(A++),_==this.blockSize){s(this,T),_=0;break}}else for(;A<S;)if(T[_++]=w[A++],_==this.blockSize){s(this,T),_=0;break}}this.h=_,this.o+=S},n.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var S=1;S<w.length-8;++S)w[S]=0;var m=8*this.o;for(S=w.length-8;S<w.length;++S)w[S]=m&255,m/=256;for(this.u(w),w=Array(16),S=m=0;4>S;++S)for(var T=0;32>T;T+=8)w[m++]=this.g[S]>>>T&255;return w};function i(w,S){var m=o;return Object.prototype.hasOwnProperty.call(m,w)?m[w]:m[w]=S(w)}function a(w,S){this.h=S;for(var m=[],T=!0,_=w.length-1;0<=_;_--){var A=w[_]|0;T&&A==S||(m[_]=A,T=!1)}this.g=m}var o={};function l(w){return-128<=w&&128>w?i(w,function(S){return new a([S|0],0>S?-1:0)}):new a([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return f;if(0>w)return y(c(-w));for(var S=[],m=1,T=0;w>=m;T++)S[T]=w/m|0,m*=4294967296;return new a(S,0)}function u(w,S){if(w.length==0)throw Error("number format error: empty string");if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(w.charAt(0)=="-")return y(u(w.substring(1),S));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var m=c(Math.pow(S,8)),T=f,_=0;_<w.length;_+=8){var A=Math.min(8,w.length-_),k=parseInt(w.substring(_,_+A),S);8>A?(A=c(Math.pow(S,A)),T=T.j(A).add(c(k))):(T=T.j(m),T=T.add(c(k)))}return T}var f=l(0),h=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(g(this))return-y(this).m();for(var w=0,S=1,m=0;m<this.g.length;m++){var T=this.i(m);w+=(0<=T?T:4294967296+T)*S,S*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(v(this))return"0";if(g(this))return"-"+y(this).toString(w);for(var S=c(Math.pow(w,6)),m=this,T="";;){var _=I(m,S).g;m=b(m,_.j(S));var A=((0<m.g.length?m.g[0]:m.h)>>>0).toString(w);if(m=_,v(m))return A+T;for(;6>A.length;)A="0"+A;T=A+T}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function v(w){if(w.h!=0)return!1;for(var S=0;S<w.g.length;S++)if(w.g[S]!=0)return!1;return!0}function g(w){return w.h==-1}t.l=function(w){return w=b(this,w),g(w)?-1:v(w)?0:1};function y(w){for(var S=w.g.length,m=[],T=0;T<S;T++)m[T]=~w.g[T];return new a(m,~w.h).add(h)}t.abs=function(){return g(this)?y(this):this},t.add=function(w){for(var S=Math.max(this.g.length,w.g.length),m=[],T=0,_=0;_<=S;_++){var A=T+(this.i(_)&65535)+(w.i(_)&65535),k=(A>>>16)+(this.i(_)>>>16)+(w.i(_)>>>16);T=k>>>16,A&=65535,k&=65535,m[_]=k<<16|A}return new a(m,m[m.length-1]&-2147483648?-1:0)};function b(w,S){return w.add(y(S))}t.j=function(w){if(v(this)||v(w))return f;if(g(this))return g(w)?y(this).j(y(w)):y(y(this).j(w));if(g(w))return y(this.j(y(w)));if(0>this.l(p)&&0>w.l(p))return c(this.m()*w.m());for(var S=this.g.length+w.g.length,m=[],T=0;T<2*S;T++)m[T]=0;for(T=0;T<this.g.length;T++)for(var _=0;_<w.g.length;_++){var A=this.i(T)>>>16,k=this.i(T)&65535,U=w.i(_)>>>16,L=w.i(_)&65535;m[2*T+2*_]+=k*L,E(m,2*T+2*_),m[2*T+2*_+1]+=A*L,E(m,2*T+2*_+1),m[2*T+2*_+1]+=k*U,E(m,2*T+2*_+1),m[2*T+2*_+2]+=A*U,E(m,2*T+2*_+2)}for(T=0;T<S;T++)m[T]=m[2*T+1]<<16|m[2*T];for(T=S;T<2*S;T++)m[T]=0;return new a(m,0)};function E(w,S){for(;(w[S]&65535)!=w[S];)w[S+1]+=w[S]>>>16,w[S]&=65535,S++}function x(w,S){this.g=w,this.h=S}function I(w,S){if(v(S))throw Error("division by zero");if(v(w))return new x(f,f);if(g(w))return S=I(y(w),S),new x(y(S.g),y(S.h));if(g(S))return S=I(w,y(S)),new x(y(S.g),S.h);if(30<w.g.length){if(g(w)||g(S))throw Error("slowDivide_ only works with positive integers.");for(var m=h,T=S;0>=T.l(w);)m=D(m),T=D(T);var _=P(m,1),A=P(T,1);for(T=P(T,2),m=P(m,2);!v(T);){var k=A.add(T);0>=k.l(w)&&(_=_.add(m),A=k),T=P(T,1),m=P(m,1)}return S=b(w,_.j(S)),new x(_,S)}for(_=f;0<=w.l(S);){for(m=Math.max(1,Math.floor(w.m()/S.m())),T=Math.ceil(Math.log(m)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),A=c(m),k=A.j(S);g(k)||0<k.l(w);)m-=T,A=c(m),k=A.j(S);v(A)&&(A=h),_=_.add(A),w=b(w,k)}return new x(_,w)}t.A=function(w){return I(this,w).h},t.and=function(w){for(var S=Math.max(this.g.length,w.g.length),m=[],T=0;T<S;T++)m[T]=this.i(T)&w.i(T);return new a(m,this.h&w.h)},t.or=function(w){for(var S=Math.max(this.g.length,w.g.length),m=[],T=0;T<S;T++)m[T]=this.i(T)|w.i(T);return new a(m,this.h|w.h)},t.xor=function(w){for(var S=Math.max(this.g.length,w.g.length),m=[],T=0;T<S;T++)m[T]=this.i(T)^w.i(T);return new a(m,this.h^w.h)};function D(w){for(var S=w.g.length+1,m=[],T=0;T<S;T++)m[T]=w.i(T)<<1|w.i(T-1)>>>31;return new a(m,w.h)}function P(w,S){var m=S>>5;S%=32;for(var T=w.g.length-m,_=[],A=0;A<T;A++)_[A]=0<S?w.i(A+m)>>>S|w.i(A+m+1)<<32-S:w.i(A+m);return new a(_,w.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Kw=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,jo=a}).apply(typeof S_<"u"?S_:typeof self<"u"?self:typeof window<"u"?window:{});var Mf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qw,vu,Xw,E0,hv,Yw,Qw,Jw;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(C,V,W){return C==Array.prototype||C==Object.prototype||(C[V]=W.value),C};function r(C){C=[typeof globalThis=="object"&&globalThis,C,typeof window=="object"&&window,typeof self=="object"&&self,typeof Mf=="object"&&Mf];for(var V=0;V<C.length;++V){var W=C[V];if(W&&W.Math==Math)return W}throw Error("Cannot find global object")}var n=r(this);function s(C,V){if(V)e:{var W=n;C=C.split(".");for(var ae=0;ae<C.length-1;ae++){var Ie=C[ae];if(!(Ie in W))break e;W=W[Ie]}C=C[C.length-1],ae=W[C],V=V(ae),V!=ae&&V!=null&&e(W,C,{configurable:!0,writable:!0,value:V})}}function i(C,V){C instanceof String&&(C+="");var W=0,ae=!1,Ie={next:function(){if(!ae&&W<C.length){var Ue=W++;return{value:V(Ue,C[Ue]),done:!1}}return ae=!0,{done:!0,value:void 0}}};return Ie[Symbol.iterator]=function(){return Ie},Ie}s("Array.prototype.values",function(C){return C||function(){return i(this,function(V,W){return W})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(C){var V=typeof C;return V=V!="object"?V:C?Array.isArray(C)?"array":V:"null",V=="array"||V=="object"&&typeof C.length=="number"}function c(C){var V=typeof C;return V=="object"&&C!=null||V=="function"}function u(C,V,W){return C.call.apply(C.bind,arguments)}function f(C,V,W){if(!C)throw Error();if(2<arguments.length){var ae=Array.prototype.slice.call(arguments,2);return function(){var Ie=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Ie,ae),C.apply(V,Ie)}}return function(){return C.apply(V,arguments)}}function h(C,V,W){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:f,h.apply(null,arguments)}function p(C,V){var W=Array.prototype.slice.call(arguments,1);return function(){var ae=W.slice();return ae.push.apply(ae,arguments),C.apply(this,ae)}}function v(C,V){function W(){}W.prototype=V.prototype,C.aa=V.prototype,C.prototype=new W,C.prototype.constructor=C,C.Qb=function(ae,Ie,Ue){for(var tt=Array(arguments.length-2),yr=2;yr<arguments.length;yr++)tt[yr-2]=arguments[yr];return V.prototype[Ie].apply(ae,tt)}}function g(C){const V=C.length;if(0<V){const W=Array(V);for(let ae=0;ae<V;ae++)W[ae]=C[ae];return W}return[]}function y(C,V){for(let W=1;W<arguments.length;W++){const ae=arguments[W];if(l(ae)){const Ie=C.length||0,Ue=ae.length||0;C.length=Ie+Ue;for(let tt=0;tt<Ue;tt++)C[Ie+tt]=ae[tt]}else C.push(ae)}}class b{constructor(V,W){this.i=V,this.j=W,this.h=0,this.g=null}get(){let V;return 0<this.h?(this.h--,V=this.g,this.g=V.next,V.next=null):V=this.i(),V}}function E(C){return/^[\s\xa0]*$/.test(C)}function x(){var C=o.navigator;return C&&(C=C.userAgent)?C:""}function I(C){return I[" "](C),C}I[" "]=function(){};var D=x().indexOf("Gecko")!=-1&&!(x().toLowerCase().indexOf("webkit")!=-1&&x().indexOf("Edge")==-1)&&!(x().indexOf("Trident")!=-1||x().indexOf("MSIE")!=-1)&&x().indexOf("Edge")==-1;function P(C,V,W){for(const ae in C)V.call(W,C[ae],ae,C)}function w(C,V){for(const W in C)V.call(void 0,C[W],W,C)}function S(C){const V={};for(const W in C)V[W]=C[W];return V}const m="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(C,V){let W,ae;for(let Ie=1;Ie<arguments.length;Ie++){ae=arguments[Ie];for(W in ae)C[W]=ae[W];for(let Ue=0;Ue<m.length;Ue++)W=m[Ue],Object.prototype.hasOwnProperty.call(ae,W)&&(C[W]=ae[W])}}function _(C){var V=1;C=C.split(":");const W=[];for(;0<V&&C.length;)W.push(C.shift()),V--;return C.length&&W.push(C.join(":")),W}function A(C){o.setTimeout(()=>{throw C},0)}function k(){var C=M;let V=null;return C.g&&(V=C.g,C.g=C.g.next,C.g||(C.h=null),V.next=null),V}class U{constructor(){this.h=this.g=null}add(V,W){const ae=L.get();ae.set(V,W),this.h?this.h.next=ae:this.g=ae,this.h=ae}}var L=new b(()=>new R,C=>C.reset());class R{constructor(){this.next=this.g=this.h=null}set(V,W){this.h=V,this.g=W,this.next=null}reset(){this.next=this.g=this.h=null}}let F,N=!1,M=new U,z=()=>{const C=o.Promise.resolve(void 0);F=()=>{C.then(G)}};var G=()=>{for(var C;C=k();){try{C.h.call(C.g)}catch(W){A(W)}var V=L;V.j(C),100>V.h&&(V.h++,C.next=V.g,V.g=C)}N=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(C,V){this.type=C,this.g=this.target=V,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var C=!1,V=Object.defineProperty({},"passive",{get:function(){C=!0}});try{const W=()=>{};o.addEventListener("test",W,V),o.removeEventListener("test",W,V)}catch{}return C}();function ne(C,V){if(j.call(this,C?C.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,C){var W=this.type=C.type,ae=C.changedTouches&&C.changedTouches.length?C.changedTouches[0]:null;if(this.target=C.target||C.srcElement,this.g=V,V=C.relatedTarget){if(D){e:{try{I(V.nodeName);var Ie=!0;break e}catch{}Ie=!1}Ie||(V=null)}}else W=="mouseover"?V=C.fromElement:W=="mouseout"&&(V=C.toElement);this.relatedTarget=V,ae?(this.clientX=ae.clientX!==void 0?ae.clientX:ae.pageX,this.clientY=ae.clientY!==void 0?ae.clientY:ae.pageY,this.screenX=ae.screenX||0,this.screenY=ae.screenY||0):(this.clientX=C.clientX!==void 0?C.clientX:C.pageX,this.clientY=C.clientY!==void 0?C.clientY:C.pageY,this.screenX=C.screenX||0,this.screenY=C.screenY||0),this.button=C.button,this.key=C.key||"",this.ctrlKey=C.ctrlKey,this.altKey=C.altKey,this.shiftKey=C.shiftKey,this.metaKey=C.metaKey,this.pointerId=C.pointerId||0,this.pointerType=typeof C.pointerType=="string"?C.pointerType:he[C.pointerType]||"",this.state=C.state,this.i=C,C.defaultPrevented&&ne.aa.h.call(this)}}v(ne,j);var he={2:"touch",3:"pen",4:"mouse"};ne.prototype.h=function(){ne.aa.h.call(this);var C=this.i;C.preventDefault?C.preventDefault():C.returnValue=!1};var le="closure_listenable_"+(1e6*Math.random()|0),fe=0;function te(C,V,W,ae,Ie){this.listener=C,this.proxy=null,this.src=V,this.type=W,this.capture=!!ae,this.ha=Ie,this.key=++fe,this.da=this.fa=!1}function Z(C){C.da=!0,C.listener=null,C.proxy=null,C.src=null,C.ha=null}function xe(C){this.src=C,this.g={},this.h=0}xe.prototype.add=function(C,V,W,ae,Ie){var Ue=C.toString();C=this.g[Ue],C||(C=this.g[Ue]=[],this.h++);var tt=q(C,V,ae,Ie);return-1<tt?(V=C[tt],W||(V.fa=!1)):(V=new te(V,this.src,Ue,!!ae,Ie),V.fa=W,C.push(V)),V};function Q(C,V){var W=V.type;if(W in C.g){var ae=C.g[W],Ie=Array.prototype.indexOf.call(ae,V,void 0),Ue;(Ue=0<=Ie)&&Array.prototype.splice.call(ae,Ie,1),Ue&&(Z(V),C.g[W].length==0&&(delete C.g[W],C.h--))}}function q(C,V,W,ae){for(var Ie=0;Ie<C.length;++Ie){var Ue=C[Ie];if(!Ue.da&&Ue.listener==V&&Ue.capture==!!W&&Ue.ha==ae)return Ie}return-1}var J="closure_lm_"+(1e6*Math.random()|0),pe={};function ge(C,V,W,ae,Ie){if(Array.isArray(V)){for(var Ue=0;Ue<V.length;Ue++)ge(C,V[Ue],W,ae,Ie);return null}return W=Ve(W),C&&C[le]?C.K(V,W,c(ae)?!!ae.capture:!1,Ie):ee(C,V,W,!1,ae,Ie)}function ee(C,V,W,ae,Ie,Ue){if(!V)throw Error("Invalid event type");var tt=c(Ie)?!!Ie.capture:!!Ie,yr=ze(C);if(yr||(C[J]=yr=new xe(C)),W=yr.add(V,W,ae,tt,Ue),W.proxy)return W;if(ae=ie(),W.proxy=ae,ae.src=C,ae.listener=W,C.addEventListener)K||(Ie=tt),Ie===void 0&&(Ie=!1),C.addEventListener(V.toString(),ae,Ie);else if(C.attachEvent)C.attachEvent(De(V.toString()),ae);else if(C.addListener&&C.removeListener)C.addListener(ae);else throw Error("addEventListener and attachEvent are unavailable.");return W}function ie(){function C(W){return V.call(C.src,C.listener,W)}const V=Te;return C}function ve(C,V,W,ae,Ie){if(Array.isArray(V))for(var Ue=0;Ue<V.length;Ue++)ve(C,V[Ue],W,ae,Ie);else ae=c(ae)?!!ae.capture:!!ae,W=Ve(W),C&&C[le]?(C=C.i,V=String(V).toString(),V in C.g&&(Ue=C.g[V],W=q(Ue,W,ae,Ie),-1<W&&(Z(Ue[W]),Array.prototype.splice.call(Ue,W,1),Ue.length==0&&(delete C.g[V],C.h--)))):C&&(C=ze(C))&&(V=C.g[V.toString()],C=-1,V&&(C=q(V,W,ae,Ie)),(W=-1<C?V[C]:null)&&we(W))}function we(C){if(typeof C!="number"&&C&&!C.da){var V=C.src;if(V&&V[le])Q(V.i,C);else{var W=C.type,ae=C.proxy;V.removeEventListener?V.removeEventListener(W,ae,C.capture):V.detachEvent?V.detachEvent(De(W),ae):V.addListener&&V.removeListener&&V.removeListener(ae),(W=ze(V))?(Q(W,C),W.h==0&&(W.src=null,V[J]=null)):Z(C)}}}function De(C){return C in pe?pe[C]:pe[C]="on"+C}function Te(C,V){if(C.da)C=!0;else{V=new ne(V,this);var W=C.listener,ae=C.ha||C.src;C.fa&&we(C),C=W.call(ae,V)}return C}function ze(C){return C=C[J],C instanceof xe?C:null}var ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ve(C){return typeof C=="function"?C:(C[ke]||(C[ke]=function(V){return C.handleEvent(V)}),C[ke])}function Ae(){H.call(this),this.i=new xe(this),this.M=this,this.F=null}v(Ae,H),Ae.prototype[le]=!0,Ae.prototype.removeEventListener=function(C,V,W,ae){ve(this,C,V,W,ae)};function Ge(C,V){var W,ae=C.F;if(ae)for(W=[];ae;ae=ae.F)W.push(ae);if(C=C.M,ae=V.type||V,typeof V=="string")V=new j(V,C);else if(V instanceof j)V.target=V.target||C;else{var Ie=V;V=new j(ae,C),T(V,Ie)}if(Ie=!0,W)for(var Ue=W.length-1;0<=Ue;Ue--){var tt=V.g=W[Ue];Ie=Ke(tt,ae,!0,V)&&Ie}if(tt=V.g=C,Ie=Ke(tt,ae,!0,V)&&Ie,Ie=Ke(tt,ae,!1,V)&&Ie,W)for(Ue=0;Ue<W.length;Ue++)tt=V.g=W[Ue],Ie=Ke(tt,ae,!1,V)&&Ie}Ae.prototype.N=function(){if(Ae.aa.N.call(this),this.i){var C=this.i,V;for(V in C.g){for(var W=C.g[V],ae=0;ae<W.length;ae++)Z(W[ae]);delete C.g[V],C.h--}}this.F=null},Ae.prototype.K=function(C,V,W,ae){return this.i.add(String(C),V,!1,W,ae)},Ae.prototype.L=function(C,V,W,ae){return this.i.add(String(C),V,!0,W,ae)};function Ke(C,V,W,ae){if(V=C.i.g[String(V)],!V)return!0;V=V.concat();for(var Ie=!0,Ue=0;Ue<V.length;++Ue){var tt=V[Ue];if(tt&&!tt.da&&tt.capture==W){var yr=tt.listener,En=tt.ha||tt.src;tt.fa&&Q(C.i,tt),Ie=yr.call(En,ae)!==!1&&Ie}}return Ie&&!ae.defaultPrevented}function Ee(C,V,W){if(typeof C=="function")W&&(C=h(C,W));else if(C&&typeof C.handleEvent=="function")C=h(C.handleEvent,C);else throw Error("Invalid listener argument");return 2147483647<Number(V)?-1:o.setTimeout(C,V||0)}function ye(C){C.g=Ee(()=>{C.g=null,C.i&&(C.i=!1,ye(C))},C.l);const V=C.h;C.h=null,C.m.apply(null,V)}class Se extends H{constructor(V,W){super(),this.m=V,this.l=W,this.h=null,this.i=!1,this.g=null}j(V){this.h=arguments,this.g?this.i=!0:ye(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Oe(C){H.call(this),this.h=C,this.g={}}v(Oe,H);var We=[];function ot(C){P(C.g,function(V,W){this.g.hasOwnProperty(W)&&we(V)},C),C.g={}}Oe.prototype.N=function(){Oe.aa.N.call(this),ot(this)},Oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gt=o.JSON.stringify,Et=o.JSON.parse,Ut=class{stringify(C){return o.JSON.stringify(C,void 0)}parse(C){return o.JSON.parse(C,void 0)}};function pt(){}pt.prototype.h=null;function ct(C){return C.h||(C.h=C.i())}function mt(){}var Pt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Mt(){j.call(this,"d")}v(Mt,j);function Tr(){j.call(this,"c")}v(Tr,j);var ts={},Pi=null;function hs(){return Pi=Pi||new Ae}ts.La="serverreachability";function bl(C){j.call(this,ts.La,C)}v(bl,j);function Ga(C){const V=hs();Ge(V,new bl(V))}ts.STAT_EVENT="statevent";function bo(C,V){j.call(this,ts.STAT_EVENT,C),this.stat=V}v(bo,j);function nn(C){const V=hs();Ge(V,new bo(V,C))}ts.Ma="timingevent";function So(C,V){j.call(this,ts.Ma,C),this.size=V}v(So,j);function Rr(C,V){if(typeof C!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){C()},V)}function Fn(){this.g=!0}Fn.prototype.xa=function(){this.g=!1};function Sl(C,V,W,ae,Ie,Ue){C.info(function(){if(C.g)if(Ue)for(var tt="",yr=Ue.split("&"),En=0;En<yr.length;En++){var ir=yr[En].split("=");if(1<ir.length){var Nn=ir[0];ir=ir[1];var On=Nn.split("_");tt=2<=On.length&&On[1]=="type"?tt+(Nn+"="+ir+"&"):tt+(Nn+"=redacted&")}}else tt=null;else tt=Ue;return"XMLHTTP REQ ("+ae+") [attempt "+Ie+"]: "+V+`
`+W+`
`+tt})}function zc(C,V,W,ae,Ie,Ue,tt){C.info(function(){return"XMLHTTP RESP ("+ae+") [ attempt "+Ie+"]: "+V+`
`+W+`
`+Ue+" "+tt})}function re(C,V,W,ae){C.info(function(){return"XMLHTTP TEXT ("+V+"): "+oe(C,W)+(ae?" "+ae:"")})}function ue(C,V){C.info(function(){return"TIMEOUT: "+V})}Fn.prototype.info=function(){};function oe(C,V){if(!C.g)return V;if(!V)return null;try{var W=JSON.parse(V);if(W){for(C=0;C<W.length;C++)if(Array.isArray(W[C])){var ae=W[C];if(!(2>ae.length)){var Ie=ae[1];if(Array.isArray(Ie)&&!(1>Ie.length)){var Ue=Ie[0];if(Ue!="noop"&&Ue!="stop"&&Ue!="close")for(var tt=1;tt<Ie.length;tt++)Ie[tt]=""}}}}return gt(W)}catch{return V}}var ce={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},de={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},me;function Pe(){}v(Pe,pt),Pe.prototype.g=function(){return new XMLHttpRequest},Pe.prototype.i=function(){return{}},me=new Pe;function $e(C,V,W,ae){this.j=C,this.i=V,this.l=W,this.R=ae||1,this.U=new Oe(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Re}function Re(){this.i=null,this.g="",this.h=!1}var Ne={},Me={};function Ye(C,V,W){C.L=1,C.v=gf(za(V)),C.m=W,C.P=!0,et(C,null)}function et(C,V){C.F=Date.now(),st(C),C.A=za(C.v);var W=C.A,ae=C.R;Array.isArray(ae)||(ae=[String(ae)]),Vx(W.i,"t",ae),C.C=0,W=C.j.J,C.h=new Re,C.g=aE(C.j,W?V:null,!C.m),0<C.O&&(C.M=new Se(h(C.Y,C,C.g),C.O)),V=C.U,W=C.g,ae=C.ca;var Ie="readystatechange";Array.isArray(Ie)||(Ie&&(We[0]=Ie.toString()),Ie=We);for(var Ue=0;Ue<Ie.length;Ue++){var tt=ge(W,Ie[Ue],ae||V.handleEvent,!1,V.h||V);if(!tt)break;V.g[tt.key]=tt}V=C.H?S(C.H):{},C.m?(C.u||(C.u="POST"),V["Content-Type"]="application/x-www-form-urlencoded",C.g.ea(C.A,C.u,C.m,V)):(C.u="GET",C.g.ea(C.A,C.u,null,V)),Ga(),Sl(C.i,C.u,C.A,C.l,C.R,C.m)}$e.prototype.ca=function(C){C=C.target;const V=this.M;V&&Ka(C)==3?V.j():this.Y(C)},$e.prototype.Y=function(C){try{if(C==this.g)e:{const On=Ka(this.g);var V=this.g.Ba();const Cl=this.g.Z();if(!(3>On)&&(On!=3||this.g&&(this.h.h||this.g.oa()||qx(this.g)))){this.J||On!=4||V==7||(V==8||0>=Cl?Ga(3):Ga(2)),vr(this);var W=this.g.Z();this.X=W;t:if(lt(this)){var ae=qx(this.g);C="";var Ie=ae.length,Ue=Ka(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ir(this),pr(this);var tt="";break t}this.h.i=new o.TextDecoder}for(V=0;V<Ie;V++)this.h.h=!0,C+=this.h.i.decode(ae[V],{stream:!(Ue&&V==Ie-1)});ae.length=0,this.h.g+=C,this.C=0,tt=this.h.g}else tt=this.g.oa();if(this.o=W==200,zc(this.i,this.u,this.A,this.l,this.R,On,W),this.o){if(this.T&&!this.K){t:{if(this.g){var yr,En=this.g;if((yr=En.g?En.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(yr)){var ir=yr;break t}}ir=null}if(W=ir)re(this.i,this.l,W,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Wa(this,W);else{this.o=!1,this.s=3,nn(12),Ir(this),pr(this);break e}}if(this.P){W=!0;let Ys;for(;!this.J&&this.C<tt.length;)if(Ys=Je(this,tt),Ys==Me){On==4&&(this.s=4,nn(14),W=!1),re(this.i,this.l,null,"[Incomplete Response]");break}else if(Ys==Ne){this.s=4,nn(15),re(this.i,this.l,tt,"[Invalid Chunk]"),W=!1;break}else re(this.i,this.l,Ys,null),Wa(this,Ys);if(lt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),On!=4||tt.length!=0||this.h.h||(this.s=1,nn(16),W=!1),this.o=this.o&&W,!W)re(this.i,this.l,tt,"[Invalid Chunked Response]"),Ir(this),pr(this);else if(0<tt.length&&!this.W){this.W=!0;var Nn=this.j;Nn.g==this&&Nn.ba&&!Nn.M&&(Nn.j.info("Great, no buffering proxy detected. Bytes received: "+tt.length),Kp(Nn),Nn.M=!0,nn(11))}}else re(this.i,this.l,tt,null),Wa(this,tt);On==4&&Ir(this),this.o&&!this.J&&(On==4?tE(this.j,this):(this.o=!1,st(this)))}else PD(this.g),W==400&&0<tt.indexOf("Unknown SID")?(this.s=3,nn(12)):(this.s=0,nn(13)),Ir(this),pr(this)}}}catch{}finally{}};function lt(C){return C.g?C.u=="GET"&&C.L!=2&&C.j.Ca:!1}function Je(C,V){var W=C.C,ae=V.indexOf(`
`,W);return ae==-1?Me:(W=Number(V.substring(W,ae)),isNaN(W)?Ne:(ae+=1,ae+W>V.length?Me:(V=V.slice(ae,ae+W),C.C=ae+W,V)))}$e.prototype.cancel=function(){this.J=!0,Ir(this)};function st(C){C.S=Date.now()+C.I,It(C,C.I)}function It(C,V){if(C.B!=null)throw Error("WatchDog timer not null");C.B=Rr(h(C.ba,C),V)}function vr(C){C.B&&(o.clearTimeout(C.B),C.B=null)}$e.prototype.ba=function(){this.B=null;const C=Date.now();0<=C-this.S?(ue(this.i,this.A),this.L!=2&&(Ga(),nn(17)),Ir(this),this.s=2,pr(this)):It(this,this.S-C)};function pr(C){C.j.G==0||C.J||tE(C.j,C)}function Ir(C){vr(C);var V=C.M;V&&typeof V.ma=="function"&&V.ma(),C.M=null,ot(C.U),C.g&&(V=C.g,C.g=null,V.abort(),V.ma())}function Wa(C,V){try{var W=C.j;if(W.G!=0&&(W.g==C||_s(W.h,C))){if(!C.K&&_s(W.h,C)&&W.G==3){try{var ae=W.Da.g.parse(V)}catch{ae=null}if(Array.isArray(ae)&&ae.length==3){var Ie=ae;if(Ie[0]==0){e:if(!W.u){if(W.g)if(W.g.F+3e3<C.F)bf(W),Ef(W);else break e;zp(W),nn(18)}}else W.za=Ie[1],0<W.za-W.T&&37500>Ie[2]&&W.F&&W.v==0&&!W.C&&(W.C=Rr(h(W.Za,W),6e3));if(1>=Al(W.h)&&W.ca){try{W.ca()}catch{}W.ca=void 0}}else wo(W,11)}else if((C.K||W.g==C)&&bf(W),!E(V))for(Ie=W.Da.g.parse(V),V=0;V<Ie.length;V++){let ir=Ie[V];if(W.T=ir[0],ir=ir[1],W.G==2)if(ir[0]=="c"){W.K=ir[1],W.ia=ir[2];const Nn=ir[3];Nn!=null&&(W.la=Nn,W.j.info("VER="+W.la));const On=ir[4];On!=null&&(W.Aa=On,W.j.info("SVER="+W.Aa));const Cl=ir[5];Cl!=null&&typeof Cl=="number"&&0<Cl&&(ae=1.5*Cl,W.L=ae,W.j.info("backChannelRequestTimeoutMs_="+ae)),ae=W;const Ys=C.g;if(Ys){const Af=Ys.g?Ys.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Af){var Ue=ae.h;Ue.g||Af.indexOf("spdy")==-1&&Af.indexOf("quic")==-1&&Af.indexOf("h2")==-1||(Ue.j=Ue.l,Ue.g=new Set,Ue.h&&(jp(Ue,Ue.h),Ue.h=null))}if(ae.D){const qp=Ys.g?Ys.g.getResponseHeader("X-HTTP-Session-Id"):null;qp&&(ae.ya=qp,wr(ae.I,ae.D,qp))}}W.G=3,W.l&&W.l.ua(),W.ba&&(W.R=Date.now()-C.F,W.j.info("Handshake RTT: "+W.R+"ms")),ae=W;var tt=C;if(ae.qa=sE(ae,ae.J?ae.ia:null,ae.W),tt.K){Fx(ae.h,tt);var yr=tt,En=ae.L;En&&(yr.I=En),yr.B&&(vr(yr),st(yr)),ae.g=tt}else Zx(ae);0<W.i.length&&_f(W)}else ir[0]!="stop"&&ir[0]!="close"||wo(W,7);else W.G==3&&(ir[0]=="stop"||ir[0]=="close"?ir[0]=="stop"?wo(W,7):Wp(W):ir[0]!="noop"&&W.l&&W.l.ta(ir),W.v=0)}}Ga(4)}catch{}}var Ao=class{constructor(C,V){this.g=C,this.map=V}};function Ri(C){this.l=C||10,o.PerformanceNavigationTiming?(C=o.performance.getEntriesByType("navigation"),C=0<C.length&&(C[0].nextHopProtocol=="hq"||C[0].nextHopProtocol=="h2")):C=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=C?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ba(C){return C.h?!0:C.g?C.g.size>=C.j:!1}function Al(C){return C.h?1:C.g?C.g.size:0}function _s(C,V){return C.h?C.h==V:C.g?C.g.has(V):!1}function jp(C,V){C.g?C.g.add(V):C.h=V}function Fx(C,V){C.h&&C.h==V?C.h=null:C.g&&C.g.has(V)&&C.g.delete(V)}Ri.prototype.cancel=function(){if(this.i=Nx(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const C of this.g.values())C.cancel();this.g.clear()}};function Nx(C){if(C.h!=null)return C.i.concat(C.h.D);if(C.g!=null&&C.g.size!==0){let V=C.i;for(const W of C.g.values())V=V.concat(W.D);return V}return g(C.i)}function gD(C){if(C.V&&typeof C.V=="function")return C.V();if(typeof Map<"u"&&C instanceof Map||typeof Set<"u"&&C instanceof Set)return Array.from(C.values());if(typeof C=="string")return C.split("");if(l(C)){for(var V=[],W=C.length,ae=0;ae<W;ae++)V.push(C[ae]);return V}V=[],W=0;for(ae in C)V[W++]=C[ae];return V}function vD(C){if(C.na&&typeof C.na=="function")return C.na();if(!C.V||typeof C.V!="function"){if(typeof Map<"u"&&C instanceof Map)return Array.from(C.keys());if(!(typeof Set<"u"&&C instanceof Set)){if(l(C)||typeof C=="string"){var V=[];C=C.length;for(var W=0;W<C;W++)V.push(W);return V}V=[],W=0;for(const ae in C)V[W++]=ae;return V}}}function Ox(C,V){if(C.forEach&&typeof C.forEach=="function")C.forEach(V,void 0);else if(l(C)||typeof C=="string")Array.prototype.forEach.call(C,V,void 0);else for(var W=vD(C),ae=gD(C),Ie=ae.length,Ue=0;Ue<Ie;Ue++)V.call(void 0,ae[Ue],W&&W[Ue],C)}var Mx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yD(C,V){if(C){C=C.split("&");for(var W=0;W<C.length;W++){var ae=C[W].indexOf("="),Ie=null;if(0<=ae){var Ue=C[W].substring(0,ae);Ie=C[W].substring(ae+1)}else Ue=C[W];V(Ue,Ie?decodeURIComponent(Ie.replace(/\+/g," ")):"")}}}function To(C){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,C instanceof To){this.h=C.h,pf(this,C.j),this.o=C.o,this.g=C.g,mf(this,C.s),this.l=C.l;var V=C.i,W=new Xc;W.i=V.i,V.g&&(W.g=new Map(V.g),W.h=V.h),Lx(this,W),this.m=C.m}else C&&(V=String(C).match(Mx))?(this.h=!1,pf(this,V[1]||"",!0),this.o=Kc(V[2]||""),this.g=Kc(V[3]||"",!0),mf(this,V[4]),this.l=Kc(V[5]||"",!0),Lx(this,V[6]||"",!0),this.m=Kc(V[7]||"")):(this.h=!1,this.i=new Xc(null,this.h))}To.prototype.toString=function(){var C=[],V=this.j;V&&C.push(qc(V,Bx,!0),":");var W=this.g;return(W||V=="file")&&(C.push("//"),(V=this.o)&&C.push(qc(V,Bx,!0),"@"),C.push(encodeURIComponent(String(W)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),W=this.s,W!=null&&C.push(":",String(W))),(W=this.l)&&(this.g&&W.charAt(0)!="/"&&C.push("/"),C.push(qc(W,W.charAt(0)=="/"?_D:ED,!0))),(W=this.i.toString())&&C.push("?",W),(W=this.m)&&C.push("#",qc(W,SD)),C.join("")};function za(C){return new To(C)}function pf(C,V,W){C.j=W?Kc(V,!0):V,C.j&&(C.j=C.j.replace(/:$/,""))}function mf(C,V){if(V){if(V=Number(V),isNaN(V)||0>V)throw Error("Bad port number "+V);C.s=V}else C.s=null}function Lx(C,V,W){V instanceof Xc?(C.i=V,AD(C.i,C.h)):(W||(V=qc(V,bD)),C.i=new Xc(V,C.h))}function wr(C,V,W){C.i.set(V,W)}function gf(C){return wr(C,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),C}function Kc(C,V){return C?V?decodeURI(C.replace(/%25/g,"%2525")):decodeURIComponent(C):""}function qc(C,V,W){return typeof C=="string"?(C=encodeURI(C).replace(V,xD),W&&(C=C.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),C):null}function xD(C){return C=C.charCodeAt(0),"%"+(C>>4&15).toString(16)+(C&15).toString(16)}var Bx=/[#\/\?@]/g,ED=/[#\?:]/g,_D=/[#\?]/g,bD=/[#\?@]/g,SD=/#/g;function Xc(C,V){this.h=this.g=null,this.i=C||null,this.j=!!V}function Fi(C){C.g||(C.g=new Map,C.h=0,C.i&&yD(C.i,function(V,W){C.add(decodeURIComponent(V.replace(/\+/g," ")),W)}))}t=Xc.prototype,t.add=function(C,V){Fi(this),this.i=null,C=Tl(this,C);var W=this.g.get(C);return W||this.g.set(C,W=[]),W.push(V),this.h+=1,this};function Ux(C,V){Fi(C),V=Tl(C,V),C.g.has(V)&&(C.i=null,C.h-=C.g.get(V).length,C.g.delete(V))}function $x(C,V){return Fi(C),V=Tl(C,V),C.g.has(V)}t.forEach=function(C,V){Fi(this),this.g.forEach(function(W,ae){W.forEach(function(Ie){C.call(V,Ie,ae,this)},this)},this)},t.na=function(){Fi(this);const C=Array.from(this.g.values()),V=Array.from(this.g.keys()),W=[];for(let ae=0;ae<V.length;ae++){const Ie=C[ae];for(let Ue=0;Ue<Ie.length;Ue++)W.push(V[ae])}return W},t.V=function(C){Fi(this);let V=[];if(typeof C=="string")$x(this,C)&&(V=V.concat(this.g.get(Tl(this,C))));else{C=Array.from(this.g.values());for(let W=0;W<C.length;W++)V=V.concat(C[W])}return V},t.set=function(C,V){return Fi(this),this.i=null,C=Tl(this,C),$x(this,C)&&(this.h-=this.g.get(C).length),this.g.set(C,[V]),this.h+=1,this},t.get=function(C,V){return C?(C=this.V(C),0<C.length?String(C[0]):V):V};function Vx(C,V,W){Ux(C,V),0<W.length&&(C.i=null,C.g.set(Tl(C,V),g(W)),C.h+=W.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const C=[],V=Array.from(this.g.keys());for(var W=0;W<V.length;W++){var ae=V[W];const Ue=encodeURIComponent(String(ae)),tt=this.V(ae);for(ae=0;ae<tt.length;ae++){var Ie=Ue;tt[ae]!==""&&(Ie+="="+encodeURIComponent(String(tt[ae]))),C.push(Ie)}}return this.i=C.join("&")};function Tl(C,V){return V=String(V),C.j&&(V=V.toLowerCase()),V}function AD(C,V){V&&!C.j&&(Fi(C),C.i=null,C.g.forEach(function(W,ae){var Ie=ae.toLowerCase();ae!=Ie&&(Ux(this,ae),Vx(this,Ie,W))},C)),C.j=V}function TD(C,V){const W=new Fn;if(o.Image){const ae=new Image;ae.onload=p(Ni,W,"TestLoadImage: loaded",!0,V,ae),ae.onerror=p(Ni,W,"TestLoadImage: error",!1,V,ae),ae.onabort=p(Ni,W,"TestLoadImage: abort",!1,V,ae),ae.ontimeout=p(Ni,W,"TestLoadImage: timeout",!1,V,ae),o.setTimeout(function(){ae.ontimeout&&ae.ontimeout()},1e4),ae.src=C}else V(!1)}function wD(C,V){const W=new Fn,ae=new AbortController,Ie=setTimeout(()=>{ae.abort(),Ni(W,"TestPingServer: timeout",!1,V)},1e4);fetch(C,{signal:ae.signal}).then(Ue=>{clearTimeout(Ie),Ue.ok?Ni(W,"TestPingServer: ok",!0,V):Ni(W,"TestPingServer: server error",!1,V)}).catch(()=>{clearTimeout(Ie),Ni(W,"TestPingServer: error",!1,V)})}function Ni(C,V,W,ae,Ie){try{Ie&&(Ie.onload=null,Ie.onerror=null,Ie.onabort=null,Ie.ontimeout=null),ae(W)}catch{}}function CD(){this.g=new Ut}function ID(C,V,W){const ae=W||"";try{Ox(C,function(Ie,Ue){let tt=Ie;c(Ie)&&(tt=gt(Ie)),V.push(ae+Ue+"="+encodeURIComponent(tt))})}catch(Ie){throw V.push(ae+"type="+encodeURIComponent("_badmap")),Ie}}function vf(C){this.l=C.Ub||null,this.j=C.eb||!1}v(vf,pt),vf.prototype.g=function(){return new yf(this.l,this.j)},vf.prototype.i=function(C){return function(){return C}}({});function yf(C,V){Ae.call(this),this.D=C,this.o=V,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(yf,Ae),t=yf.prototype,t.open=function(C,V){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=C,this.A=V,this.readyState=1,Qc(this)},t.send=function(C){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const V={headers:this.u,method:this.B,credentials:this.m,cache:void 0};C&&(V.body=C),(this.D||o).fetch(new Request(this.A,V)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Yc(this)),this.readyState=0},t.Sa=function(C){if(this.g&&(this.l=C,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=C.headers,this.readyState=2,Qc(this)),this.g&&(this.readyState=3,Qc(this),this.g)))if(this.responseType==="arraybuffer")C.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in C){if(this.j=C.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Hx(this)}else C.text().then(this.Ra.bind(this),this.ga.bind(this))};function Hx(C){C.j.read().then(C.Pa.bind(C)).catch(C.ga.bind(C))}t.Pa=function(C){if(this.g){if(this.o&&C.value)this.response.push(C.value);else if(!this.o){var V=C.value?C.value:new Uint8Array(0);(V=this.v.decode(V,{stream:!C.done}))&&(this.response=this.responseText+=V)}C.done?Yc(this):Qc(this),this.readyState==3&&Hx(this)}},t.Ra=function(C){this.g&&(this.response=this.responseText=C,Yc(this))},t.Qa=function(C){this.g&&(this.response=C,Yc(this))},t.ga=function(){this.g&&Yc(this)};function Yc(C){C.readyState=4,C.l=null,C.j=null,C.v=null,Qc(C)}t.setRequestHeader=function(C,V){this.u.append(C,V)},t.getResponseHeader=function(C){return this.h&&this.h.get(C.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const C=[],V=this.h.entries();for(var W=V.next();!W.done;)W=W.value,C.push(W[0]+": "+W[1]),W=V.next();return C.join(`\r
`)};function Qc(C){C.onreadystatechange&&C.onreadystatechange.call(C)}Object.defineProperty(yf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(C){this.m=C?"include":"same-origin"}});function jx(C){let V="";return P(C,function(W,ae){V+=ae,V+=":",V+=W,V+=`\r
`}),V}function Gp(C,V,W){e:{for(ae in W){var ae=!1;break e}ae=!0}ae||(W=jx(W),typeof C=="string"?W!=null&&encodeURIComponent(String(W)):wr(C,V,W))}function Mr(C){Ae.call(this),this.headers=new Map,this.o=C||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Mr,Ae);var kD=/^https?$/i,DD=["POST","PUT"];t=Mr.prototype,t.Ha=function(C){this.J=C},t.ea=function(C,V,W,ae){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+C);V=V?V.toUpperCase():"GET",this.D=C,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():me.g(),this.v=this.o?ct(this.o):ct(me),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(V,String(C),!0),this.B=!1}catch(Ue){Gx(this,Ue);return}if(C=W||"",W=new Map(this.headers),ae)if(Object.getPrototypeOf(ae)===Object.prototype)for(var Ie in ae)W.set(Ie,ae[Ie]);else if(typeof ae.keys=="function"&&typeof ae.get=="function")for(const Ue of ae.keys())W.set(Ue,ae.get(Ue));else throw Error("Unknown input type for opt_headers: "+String(ae));ae=Array.from(W.keys()).find(Ue=>Ue.toLowerCase()=="content-type"),Ie=o.FormData&&C instanceof o.FormData,!(0<=Array.prototype.indexOf.call(DD,V,void 0))||ae||Ie||W.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ue,tt]of W)this.g.setRequestHeader(Ue,tt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Kx(this),this.u=!0,this.g.send(C),this.u=!1}catch(Ue){Gx(this,Ue)}};function Gx(C,V){C.h=!1,C.g&&(C.j=!0,C.g.abort(),C.j=!1),C.l=V,C.m=5,Wx(C),xf(C)}function Wx(C){C.A||(C.A=!0,Ge(C,"complete"),Ge(C,"error"))}t.abort=function(C){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=C||7,Ge(this,"complete"),Ge(this,"abort"),xf(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xf(this,!0)),Mr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?zx(this):this.bb())},t.bb=function(){zx(this)};function zx(C){if(C.h&&typeof a<"u"&&(!C.v[1]||Ka(C)!=4||C.Z()!=2)){if(C.u&&Ka(C)==4)Ee(C.Ea,0,C);else if(Ge(C,"readystatechange"),Ka(C)==4){C.h=!1;try{const tt=C.Z();e:switch(tt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var V=!0;break e;default:V=!1}var W;if(!(W=V)){var ae;if(ae=tt===0){var Ie=String(C.D).match(Mx)[1]||null;!Ie&&o.self&&o.self.location&&(Ie=o.self.location.protocol.slice(0,-1)),ae=!kD.test(Ie?Ie.toLowerCase():"")}W=ae}if(W)Ge(C,"complete"),Ge(C,"success");else{C.m=6;try{var Ue=2<Ka(C)?C.g.statusText:""}catch{Ue=""}C.l=Ue+" ["+C.Z()+"]",Wx(C)}}finally{xf(C)}}}}function xf(C,V){if(C.g){Kx(C);const W=C.g,ae=C.v[0]?()=>{}:null;C.g=null,C.v=null,V||Ge(C,"ready");try{W.onreadystatechange=ae}catch{}}}function Kx(C){C.I&&(o.clearTimeout(C.I),C.I=null)}t.isActive=function(){return!!this.g};function Ka(C){return C.g?C.g.readyState:0}t.Z=function(){try{return 2<Ka(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(C){if(this.g){var V=this.g.responseText;return C&&V.indexOf(C)==0&&(V=V.substring(C.length)),Et(V)}};function qx(C){try{if(!C.g)return null;if("response"in C.g)return C.g.response;switch(C.H){case"":case"text":return C.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in C.g)return C.g.mozResponseArrayBuffer}return null}catch{return null}}function PD(C){const V={};C=(C.g&&2<=Ka(C)&&C.g.getAllResponseHeaders()||"").split(`\r
`);for(let ae=0;ae<C.length;ae++){if(E(C[ae]))continue;var W=_(C[ae]);const Ie=W[0];if(W=W[1],typeof W!="string")continue;W=W.trim();const Ue=V[Ie]||[];V[Ie]=Ue,Ue.push(W)}w(V,function(ae){return ae.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Jc(C,V,W){return W&&W.internalChannelParams&&W.internalChannelParams[C]||V}function Xx(C){this.Aa=0,this.i=[],this.j=new Fn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Jc("failFast",!1,C),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Jc("baseRetryDelayMs",5e3,C),this.cb=Jc("retryDelaySeedMs",1e4,C),this.Wa=Jc("forwardChannelMaxRetries",2,C),this.wa=Jc("forwardChannelRequestTimeoutMs",2e4,C),this.pa=C&&C.xmlHttpFactory||void 0,this.Xa=C&&C.Tb||void 0,this.Ca=C&&C.useFetchStreams||!1,this.L=void 0,this.J=C&&C.supportsCrossDomainXhr||!1,this.K="",this.h=new Ri(C&&C.concurrentRequestLimit),this.Da=new CD,this.P=C&&C.fastHandshake||!1,this.O=C&&C.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=C&&C.Rb||!1,C&&C.xa&&this.j.xa(),C&&C.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&C&&C.detectBufferingProxy||!1,this.ja=void 0,C&&C.longPollingTimeout&&0<C.longPollingTimeout&&(this.ja=C.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Xx.prototype,t.la=8,t.G=1,t.connect=function(C,V,W,ae){nn(0),this.W=C,this.H=V||{},W&&ae!==void 0&&(this.H.OSID=W,this.H.OAID=ae),this.F=this.X,this.I=sE(this,null,this.W),_f(this)};function Wp(C){if(Yx(C),C.G==3){var V=C.U++,W=za(C.I);if(wr(W,"SID",C.K),wr(W,"RID",V),wr(W,"TYPE","terminate"),Zc(C,W),V=new $e(C,C.j,V),V.L=2,V.v=gf(za(W)),W=!1,o.navigator&&o.navigator.sendBeacon)try{W=o.navigator.sendBeacon(V.v.toString(),"")}catch{}!W&&o.Image&&(new Image().src=V.v,W=!0),W||(V.g=aE(V.j,null),V.g.ea(V.v)),V.F=Date.now(),st(V)}nE(C)}function Ef(C){C.g&&(Kp(C),C.g.cancel(),C.g=null)}function Yx(C){Ef(C),C.u&&(o.clearTimeout(C.u),C.u=null),bf(C),C.h.cancel(),C.s&&(typeof C.s=="number"&&o.clearTimeout(C.s),C.s=null)}function _f(C){if(!ba(C.h)&&!C.s){C.s=!0;var V=C.Ga;F||z(),N||(F(),N=!0),M.add(V,C),C.B=0}}function RD(C,V){return Al(C.h)>=C.h.j-(C.s?1:0)?!1:C.s?(C.i=V.D.concat(C.i),!0):C.G==1||C.G==2||C.B>=(C.Va?0:C.Wa)?!1:(C.s=Rr(h(C.Ga,C,V),rE(C,C.B)),C.B++,!0)}t.Ga=function(C){if(this.s)if(this.s=null,this.G==1){if(!C){this.U=Math.floor(1e5*Math.random()),C=this.U++;const Ie=new $e(this,this.j,C);let Ue=this.o;if(this.S&&(Ue?(Ue=S(Ue),T(Ue,this.S)):Ue=this.S),this.m!==null||this.O||(Ie.H=Ue,Ue=null),this.P)e:{for(var V=0,W=0;W<this.i.length;W++){t:{var ae=this.i[W];if("__data__"in ae.map&&(ae=ae.map.__data__,typeof ae=="string")){ae=ae.length;break t}ae=void 0}if(ae===void 0)break;if(V+=ae,4096<V){V=W;break e}if(V===4096||W===this.i.length-1){V=W+1;break e}}V=1e3}else V=1e3;V=Jx(this,Ie,V),W=za(this.I),wr(W,"RID",C),wr(W,"CVER",22),this.D&&wr(W,"X-HTTP-Session-Id",this.D),Zc(this,W),Ue&&(this.O?V="headers="+encodeURIComponent(String(jx(Ue)))+"&"+V:this.m&&Gp(W,this.m,Ue)),jp(this.h,Ie),this.Ua&&wr(W,"TYPE","init"),this.P?(wr(W,"$req",V),wr(W,"SID","null"),Ie.T=!0,Ye(Ie,W,null)):Ye(Ie,W,V),this.G=2}}else this.G==3&&(C?Qx(this,C):this.i.length==0||ba(this.h)||Qx(this))};function Qx(C,V){var W;V?W=V.l:W=C.U++;const ae=za(C.I);wr(ae,"SID",C.K),wr(ae,"RID",W),wr(ae,"AID",C.T),Zc(C,ae),C.m&&C.o&&Gp(ae,C.m,C.o),W=new $e(C,C.j,W,C.B+1),C.m===null&&(W.H=C.o),V&&(C.i=V.D.concat(C.i)),V=Jx(C,W,1e3),W.I=Math.round(.5*C.wa)+Math.round(.5*C.wa*Math.random()),jp(C.h,W),Ye(W,ae,V)}function Zc(C,V){C.H&&P(C.H,function(W,ae){wr(V,ae,W)}),C.l&&Ox({},function(W,ae){wr(V,ae,W)})}function Jx(C,V,W){W=Math.min(C.i.length,W);var ae=C.l?h(C.l.Na,C.l,C):null;e:{var Ie=C.i;let Ue=-1;for(;;){const tt=["count="+W];Ue==-1?0<W?(Ue=Ie[0].g,tt.push("ofs="+Ue)):Ue=0:tt.push("ofs="+Ue);let yr=!0;for(let En=0;En<W;En++){let ir=Ie[En].g;const Nn=Ie[En].map;if(ir-=Ue,0>ir)Ue=Math.max(0,Ie[En].g-100),yr=!1;else try{ID(Nn,tt,"req"+ir+"_")}catch{ae&&ae(Nn)}}if(yr){ae=tt.join("&");break e}}}return C=C.i.splice(0,W),V.D=C,ae}function Zx(C){if(!C.g&&!C.u){C.Y=1;var V=C.Fa;F||z(),N||(F(),N=!0),M.add(V,C),C.v=0}}function zp(C){return C.g||C.u||3<=C.v?!1:(C.Y++,C.u=Rr(h(C.Fa,C),rE(C,C.v)),C.v++,!0)}t.Fa=function(){if(this.u=null,eE(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var C=2*this.R;this.j.info("BP detection timer enabled: "+C),this.A=Rr(h(this.ab,this),C)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nn(10),Ef(this),eE(this))};function Kp(C){C.A!=null&&(o.clearTimeout(C.A),C.A=null)}function eE(C){C.g=new $e(C,C.j,"rpc",C.Y),C.m===null&&(C.g.H=C.o),C.g.O=0;var V=za(C.qa);wr(V,"RID","rpc"),wr(V,"SID",C.K),wr(V,"AID",C.T),wr(V,"CI",C.F?"0":"1"),!C.F&&C.ja&&wr(V,"TO",C.ja),wr(V,"TYPE","xmlhttp"),Zc(C,V),C.m&&C.o&&Gp(V,C.m,C.o),C.L&&(C.g.I=C.L);var W=C.g;C=C.ia,W.L=1,W.v=gf(za(V)),W.m=null,W.P=!0,et(W,C)}t.Za=function(){this.C!=null&&(this.C=null,Ef(this),zp(this),nn(19))};function bf(C){C.C!=null&&(o.clearTimeout(C.C),C.C=null)}function tE(C,V){var W=null;if(C.g==V){bf(C),Kp(C),C.g=null;var ae=2}else if(_s(C.h,V))W=V.D,Fx(C.h,V),ae=1;else return;if(C.G!=0){if(V.o)if(ae==1){W=V.m?V.m.length:0,V=Date.now()-V.F;var Ie=C.B;ae=hs(),Ge(ae,new So(ae,W)),_f(C)}else Zx(C);else if(Ie=V.s,Ie==3||Ie==0&&0<V.X||!(ae==1&&RD(C,V)||ae==2&&zp(C)))switch(W&&0<W.length&&(V=C.h,V.i=V.i.concat(W)),Ie){case 1:wo(C,5);break;case 4:wo(C,10);break;case 3:wo(C,6);break;default:wo(C,2)}}}function rE(C,V){let W=C.Ta+Math.floor(Math.random()*C.cb);return C.isActive()||(W*=2),W*V}function wo(C,V){if(C.j.info("Error code "+V),V==2){var W=h(C.fb,C),ae=C.Xa;const Ie=!ae;ae=new To(ae||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||pf(ae,"https"),gf(ae),Ie?TD(ae.toString(),W):wD(ae.toString(),W)}else nn(2);C.G=0,C.l&&C.l.sa(V),nE(C),Yx(C)}t.fb=function(C){C?(this.j.info("Successfully pinged google.com"),nn(2)):(this.j.info("Failed to ping google.com"),nn(1))};function nE(C){if(C.G=0,C.ka=[],C.l){const V=Nx(C.h);(V.length!=0||C.i.length!=0)&&(y(C.ka,V),y(C.ka,C.i),C.h.i.length=0,g(C.i),C.i.length=0),C.l.ra()}}function sE(C,V,W){var ae=W instanceof To?za(W):new To(W);if(ae.g!="")V&&(ae.g=V+"."+ae.g),mf(ae,ae.s);else{var Ie=o.location;ae=Ie.protocol,V=V?V+"."+Ie.hostname:Ie.hostname,Ie=+Ie.port;var Ue=new To(null);ae&&pf(Ue,ae),V&&(Ue.g=V),Ie&&mf(Ue,Ie),W&&(Ue.l=W),ae=Ue}return W=C.D,V=C.ya,W&&V&&wr(ae,W,V),wr(ae,"VER",C.la),Zc(C,ae),ae}function aE(C,V,W){if(V&&!C.J)throw Error("Can't create secondary domain capable XhrIo object.");return V=C.Ca&&!C.pa?new Mr(new vf({eb:W})):new Mr(C.pa),V.Ha(C.J),V}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function iE(){}t=iE.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Sf(){}Sf.prototype.g=function(C,V){return new bs(C,V)};function bs(C,V){Ae.call(this),this.g=new Xx(V),this.l=C,this.h=V&&V.messageUrlParams||null,C=V&&V.messageHeaders||null,V&&V.clientProtocolHeaderRequired&&(C?C["X-Client-Protocol"]="webchannel":C={"X-Client-Protocol":"webchannel"}),this.g.o=C,C=V&&V.initMessageHeaders||null,V&&V.messageContentType&&(C?C["X-WebChannel-Content-Type"]=V.messageContentType:C={"X-WebChannel-Content-Type":V.messageContentType}),V&&V.va&&(C?C["X-WebChannel-Client-Profile"]=V.va:C={"X-WebChannel-Client-Profile":V.va}),this.g.S=C,(C=V&&V.Sb)&&!E(C)&&(this.g.m=C),this.v=V&&V.supportsCrossDomainXhr||!1,this.u=V&&V.sendRawJson||!1,(V=V&&V.httpSessionIdParam)&&!E(V)&&(this.g.D=V,C=this.h,C!==null&&V in C&&(C=this.h,V in C&&delete C[V])),this.j=new wl(this)}v(bs,Ae),bs.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},bs.prototype.close=function(){Wp(this.g)},bs.prototype.o=function(C){var V=this.g;if(typeof C=="string"){var W={};W.__data__=C,C=W}else this.u&&(W={},W.__data__=gt(C),C=W);V.i.push(new Ao(V.Ya++,C)),V.G==3&&_f(V)},bs.prototype.N=function(){this.g.l=null,delete this.j,Wp(this.g),delete this.g,bs.aa.N.call(this)};function oE(C){Mt.call(this),C.__headers__&&(this.headers=C.__headers__,this.statusCode=C.__status__,delete C.__headers__,delete C.__status__);var V=C.__sm__;if(V){e:{for(const W in V){C=W;break e}C=void 0}(this.i=C)&&(C=this.i,V=V!==null&&C in V?V[C]:void 0),this.data=V}else this.data=C}v(oE,Mt);function lE(){Tr.call(this),this.status=1}v(lE,Tr);function wl(C){this.g=C}v(wl,iE),wl.prototype.ua=function(){Ge(this.g,"a")},wl.prototype.ta=function(C){Ge(this.g,new oE(C))},wl.prototype.sa=function(C){Ge(this.g,new lE)},wl.prototype.ra=function(){Ge(this.g,"b")},Sf.prototype.createWebChannel=Sf.prototype.g,bs.prototype.send=bs.prototype.o,bs.prototype.open=bs.prototype.m,bs.prototype.close=bs.prototype.close,Jw=function(){return new Sf},Qw=function(){return hs()},Yw=ts,hv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ce.NO_ERROR=0,ce.TIMEOUT=8,ce.HTTP_ERROR=6,E0=ce,de.COMPLETE="complete",Xw=de,mt.EventType=Pt,Pt.OPEN="a",Pt.CLOSE="b",Pt.ERROR="c",Pt.MESSAGE="d",Ae.prototype.listen=Ae.prototype.K,vu=mt,Mr.prototype.listenOnce=Mr.prototype.L,Mr.prototype.getLastError=Mr.prototype.Ka,Mr.prototype.getLastErrorCode=Mr.prototype.Ba,Mr.prototype.getStatus=Mr.prototype.Z,Mr.prototype.getResponseJson=Mr.prototype.Oa,Mr.prototype.getResponseText=Mr.prototype.oa,Mr.prototype.send=Mr.prototype.ea,Mr.prototype.setWithCredentials=Mr.prototype.Ha,qw=Mr}).apply(typeof Mf<"u"?Mf:typeof self<"u"?self:typeof window<"u"?window:{});const A_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Vn.UNAUTHENTICATED=new Vn(null),Vn.GOOGLE_CREDENTIALS=new Vn("google-credentials-uid"),Vn.FIRST_PARTY=new Vn("first-party-uid"),Vn.MOCK_USER=new Vn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jo=new F1("@firebase/firestore");function nu(){return Jo.logLevel}function dt(t,...e){if(Jo.logLevel<=Yt.DEBUG){const r=e.map(X1);Jo.debug(`Firestore (${Oc}): ${t}`,...r)}}function Si(t,...e){if(Jo.logLevel<=Yt.ERROR){const r=e.map(X1);Jo.error(`Firestore (${Oc}): ${t}`,...r)}}function Zo(t,...e){if(Jo.logLevel<=Yt.WARN){const r=e.map(X1);Jo.warn(`Firestore (${Oc}): ${t}`,...r)}}function X1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t="Unexpected state"){const e=`FIRESTORE (${Oc}) INTERNAL ASSERTION FAILED: `+t;throw Si(e),new Error(e)}function mr(t,e){t||Dt()}function Ot(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const je={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends xa{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ui{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class eC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Vn.UNAUTHENTICATED))}shutdown(){}}class N5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class O5{constructor(e){this.t=e,this.currentUser=Vn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){mr(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new ui;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ui,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{dt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(dt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ui)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(dt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mr(typeof n.accessToken=="string"),new Zw(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mr(e===null||typeof e=="string"),new Vn(e)}}class M5{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Vn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class L5{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new M5(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Vn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class B5{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class U5{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){mr(this.o===void 0);const n=i=>{i.error!=null&&dt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,dt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{dt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):dt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(mr(typeof r.token=="string"),this.R=r.token,new B5(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=$5(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function lr(t,e){return t<e?-1:t>e?1:0}function xc(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new nt(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new nt(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new nt(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rn.fromMillis(Date.now())}static fromDate(e){return rn.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new rn(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?lr(this.nanoseconds,e.nanoseconds):lr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ft(e)}static min(){return new Ft(new rn(0,0))}static max(){return new Ft(new rn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(e,r,n){r===void 0?r=0:r>e.length&&Dt(),n===void 0?n=e.length-r:n>e.length-r&&Dt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return md.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof md?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),a=r.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class br extends md{construct(e,r,n){return new br(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new nt(je.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new br(r)}static emptyPath(){return new br([])}}const V5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class gn extends md{construct(e,r,n){return new gn(e,r,n)}static isValidIdentifier(e){return V5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),gn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new gn(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new nt(je.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new nt(je.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new nt(je.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new nt(je.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new gn(r)}static emptyPath(){return new gn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.path=e}static fromPath(e){return new vt(br.fromString(e))}static fromName(e){return new vt(br.fromString(e).popFirst(5))}static empty(){return new vt(br.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&br.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return br.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new vt(new br(e.slice()))}}function H5(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ft.fromTimestamp(n===1e9?new rn(r+1,0):new rn(r,n));return new uo(s,vt.empty(),e)}function j5(t){return new uo(t.readTime,t.key,-1)}class uo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new uo(Ft.min(),vt.empty(),-1)}static max(){return new uo(Ft.max(),vt.empty(),-1)}}function G5(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=vt.comparator(t.documentKey,e.documentKey),r!==0?r:lr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W5="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class z5{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kd(t){if(t.code!==je.FAILED_PRECONDITION||t.message!==W5)throw t;dt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Dt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Xe((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Xe?r:Xe.resolve(r)}catch(r){return Xe.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Xe.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Xe.reject(r)}static resolve(e){return new Xe((r,n)=>{r(e)})}static reject(e){return new Xe((r,n)=>{n(e)})}static waitFor(e){return new Xe((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=Xe.resolve(!1);for(const n of e)r=r.next(s=>s?Xe.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new Xe((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===i&&n(a)},u=>s(u))}})}static doWhile(e,r){return new Xe((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function K5(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function qd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Q1.oe=-1;function up(t){return t==null}function sh(t){return t===0&&1/t==-1/0}function q5(t){return typeof t=="number"&&Number.isInteger(t)&&!sh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function dl(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function tC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,r){this.comparator=e,this.root=r||Sn.EMPTY}insert(e,r){return new Or(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Sn.BLACK,null,null))}remove(e){return new Or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Sn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Lf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Lf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Lf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Lf(this.root,e,this.comparator,!0)}}class Lf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Sn{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??Sn.RED,this.left=s??Sn.EMPTY,this.right=i??Sn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new Sn(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Sn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Sn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Sn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Sn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Dt();const e=this.left.check();if(e!==this.right.check())throw Dt();return e+(this.isRed()?0:1)}}Sn.EMPTY=null,Sn.RED=!0,Sn.BLACK=!1;Sn.EMPTY=new class{constructor(){this.size=0}get key(){throw Dt()}get value(){throw Dt()}get color(){throw Dt()}get left(){throw Dt()}get right(){throw Dt()}copy(e,r,n,s,i){return this}insert(e,r,n){return new Sn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.comparator=e,this.data=new Or(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new w_(this.data.getIterator())}getIteratorFrom(e){return new w_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof kn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new kn(this.comparator);return r.data=e,r}}class w_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e){this.fields=e,e.sort(gn.comparator)}static empty(){return new Cs([])}unionWith(e){let r=new kn(gn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Cs(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return xc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new rC("Invalid base64 string: "+i):i}}(e);return new yn(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new yn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yn.EMPTY_BYTE_STRING=new yn("");const X5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fo(t){if(mr(!!t),typeof t=="string"){let e=0;const r=X5.exec(t);if(mr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:zr(t.seconds),nanos:zr(t.nanos)}}function zr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function el(t){return typeof t=="string"?yn.fromBase64String(t):yn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dp(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function J1(t){const e=t.mapValue.fields.__previous_value__;return dp(e)?J1(e):e}function gd(t){const e=fo(t.mapValue.fields.__local_write_time__.timestampValue);return new rn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y5{constructor(e,r,n,s,i,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Ec{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Ec("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ec&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bf={mapValue:{}};function tl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?dp(t)?4:J5(t)?9007199254740991:Q5(t)?10:11:Dt()}function Ba(t,e){if(t===e)return!0;const r=tl(t);if(r!==tl(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return gd(t).isEqual(gd(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=fo(s.timestampValue),o=fo(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return el(s.bytesValue).isEqual(el(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return zr(s.geoPointValue.latitude)===zr(i.geoPointValue.latitude)&&zr(s.geoPointValue.longitude)===zr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return zr(s.integerValue)===zr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=zr(s.doubleValue),o=zr(i.doubleValue);return a===o?sh(a)===sh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return xc(t.arrayValue.values||[],e.arrayValue.values||[],Ba);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(T_(a)!==T_(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Ba(a[l],o[l])))return!1;return!0}(t,e);default:return Dt()}}function vd(t,e){return(t.values||[]).find(r=>Ba(r,e))!==void 0}function _c(t,e){if(t===e)return 0;const r=tl(t),n=tl(e);if(r!==n)return lr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return lr(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=zr(i.integerValue||i.doubleValue),l=zr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return C_(t.timestampValue,e.timestampValue);case 4:return C_(gd(t),gd(e));case 5:return lr(t.stringValue,e.stringValue);case 6:return function(i,a){const o=el(i),l=el(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=lr(o[c],l[c]);if(u!==0)return u}return lr(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=lr(zr(i.latitude),zr(a.latitude));return o!==0?o:lr(zr(i.longitude),zr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return I_(t.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,c,u;const f=i.fields||{},h=a.fields||{},p=(o=f.value)===null||o===void 0?void 0:o.arrayValue,v=(l=h.value)===null||l===void 0?void 0:l.arrayValue,g=lr(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=v==null?void 0:v.values)===null||u===void 0?void 0:u.length)||0);return g!==0?g:I_(p,v)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Bf.mapValue&&a===Bf.mapValue)return 0;if(i===Bf.mapValue)return 1;if(a===Bf.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const h=lr(l[f],u[f]);if(h!==0)return h;const p=_c(o[l[f]],c[u[f]]);if(p!==0)return p}return lr(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Dt()}}function C_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return lr(t,e);const r=fo(t),n=fo(e),s=lr(r.seconds,n.seconds);return s!==0?s:lr(r.nanos,n.nanos)}function I_(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=_c(r[s],n[s]);if(i)return i}return lr(r.length,n.length)}function bc(t){return pv(t)}function pv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=fo(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return el(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return vt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=pv(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${pv(r.fields[a])}`;return s+"}"}(t.mapValue):Dt()}function ah(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mv(t){return!!t&&"integerValue"in t}function Z1(t){return!!t&&"arrayValue"in t}function k_(t){return!!t&&"nullValue"in t}function D_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _0(t){return!!t&&"mapValue"in t}function Q5(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function Bu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return dl(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Bu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Bu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function J5(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e){this.value=e}static empty(){return new Es({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!_0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Bu(r)}setAll(e){let r=gn.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=Bu(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());_0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Ba(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];_0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){dl(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new Es(Bu(this.value))}}function nC(t){const e=[];return dl(t.fields,(r,n)=>{const s=new gn([r]);if(_0(n)){const i=nC(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Cs(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Gn(e,0,Ft.min(),Ft.min(),Ft.min(),Es.empty(),0)}static newFoundDocument(e,r,n,s){return new Gn(e,1,r,Ft.min(),n,s,0)}static newNoDocument(e,r){return new Gn(e,2,r,Ft.min(),Ft.min(),Es.empty(),0)}static newUnknownDocument(e,r){return new Gn(e,3,r,Ft.min(),Ft.min(),Es.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ft.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Es.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Es.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ft.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Gn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sc{constructor(e,r){this.position=e,this.inclusive=r}}function P_(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=vt.comparator(vt.fromName(a.referenceValue),r.key):n=_c(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function R_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Ba(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,r="asc"){this.field=e,this.dir=r}}function Z5(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{}class en extends sC{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new tN(e,r,n):r==="array-contains"?new sN(e,n):r==="in"?new aN(e,n):r==="not-in"?new iN(e,n):r==="array-contains-any"?new oN(e,n):new en(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new rN(e,n):new nN(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(_c(r,this.value)):r!==null&&tl(this.value)===tl(r)&&this.matchesComparison(_c(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Dt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ga extends sC{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new ga(e,r)}matches(e){return aC(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function aC(t){return t.op==="and"}function iC(t){return eN(t)&&aC(t)}function eN(t){for(const e of t.filters)if(e instanceof ga)return!1;return!0}function gv(t){if(t instanceof en)return t.field.canonicalString()+t.op.toString()+bc(t.value);if(iC(t))return t.filters.map(e=>gv(e)).join(",");{const e=t.filters.map(r=>gv(r)).join(",");return`${t.op}(${e})`}}function oC(t,e){return t instanceof en?function(n,s){return s instanceof en&&n.op===s.op&&n.field.isEqual(s.field)&&Ba(n.value,s.value)}(t,e):t instanceof ga?function(n,s){return s instanceof ga&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&oC(a,s.filters[o]),!0):!1}(t,e):void Dt()}function lC(t){return t instanceof en?function(r){return`${r.field.canonicalString()} ${r.op} ${bc(r.value)}`}(t):t instanceof ga?function(r){return r.op.toString()+" {"+r.getFilters().map(lC).join(" ,")+"}"}(t):"Filter"}class tN extends en{constructor(e,r,n){super(e,r,n),this.key=vt.fromName(n.referenceValue)}matches(e){const r=vt.comparator(e.key,this.key);return this.matchesComparison(r)}}class rN extends en{constructor(e,r){super(e,"in",r),this.keys=cC("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class nN extends en{constructor(e,r){super(e,"not-in",r),this.keys=cC("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function cC(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>vt.fromName(n.referenceValue))}class sN extends en{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return Z1(r)&&vd(r.arrayValue,this.value)}}class aN extends en{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&vd(this.value.arrayValue,r)}}class iN extends en{constructor(e,r){super(e,"not-in",r)}matches(e){if(vd(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!vd(this.value.arrayValue,r)}}class oN extends en{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!Z1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>vd(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function F_(t,e=null,r=[],n=[],s=null,i=null,a=null){return new lN(t,e,r,n,s,i,a)}function ey(t){const e=Ot(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>gv(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),up(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>bc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>bc(n)).join(",")),e.ue=r}return e.ue}function ty(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Z5(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!oC(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!R_(t.startAt,e.startAt)&&R_(t.endAt,e.endAt)}function vv(t){return vt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function cN(t,e,r,n,s,i,a,o){return new fl(t,e,r,n,s,i,a,o)}function fp(t){return new fl(t)}function N_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ry(t){return t.collectionGroup!==null}function ic(t){const e=Ot(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new kn(gn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new yd(i,n))}),r.has(gn.keyField().canonicalString())||e.ce.push(new yd(gn.keyField(),n))}return e.ce}function Fa(t){const e=Ot(t);return e.le||(e.le=uN(e,ic(t))),e.le}function uN(t,e){if(t.limitType==="F")return F_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new yd(s.field,i)});const r=t.endAt?new Sc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Sc(t.startAt.position,t.startAt.inclusive):null;return F_(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function yv(t,e){const r=t.filters.concat([e]);return new fl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function ih(t,e,r){return new fl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function hp(t,e){return ty(Fa(t),Fa(e))&&t.limitType===e.limitType}function uC(t){return`${ey(Fa(t))}|lt:${t.limitType}`}function Ul(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>lC(s)).join(", ")}]`),up(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>bc(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>bc(s)).join(",")),`Target(${n})`}(Fa(t))}; limitType=${t.limitType})`}function pp(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):vt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of ic(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const c=P_(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,ic(n),s)||n.endAt&&!function(a,o,l){const c=P_(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,ic(n),s))}(t,e)}function dN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function dC(t){return(e,r)=>{let n=!1;for(const s of ic(t)){const i=fN(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function fN(t,e,r){const n=t.field.isKeyField()?vt.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?_c(l,c):Dt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Dt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){dl(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return tC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hN=new Or(vt.comparator);function Ai(){return hN}const fC=new Or(vt.comparator);function yu(...t){let e=fC;for(const r of t)e=e.insert(r.key,r);return e}function hC(t){let e=fC;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Mo(){return Uu()}function pC(){return Uu()}function Uu(){return new Mc(t=>t.toString(),(t,e)=>t.isEqual(e))}const pN=new Or(vt.comparator),mN=new kn(vt.comparator);function qt(...t){let e=mN;for(const r of t)e=e.add(r);return e}const gN=new kn(lr);function vN(){return gN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:sh(e)?"-0":e}}function mC(t){return{integerValue:""+t}}function yN(t,e){return q5(e)?mC(e):ny(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(){this._=void 0}}function xN(t,e,r){return t instanceof xd?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&dp(i)&&(i=J1(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(r,e):t instanceof Ed?vC(t,e):t instanceof _d?yC(t,e):function(s,i){const a=gC(s,i),o=O_(a)+O_(s.Pe);return mv(a)&&mv(s.Pe)?mC(o):ny(s.serializer,o)}(t,e)}function EN(t,e,r){return t instanceof Ed?vC(t,e):t instanceof _d?yC(t,e):r}function gC(t,e){return t instanceof oh?function(n){return mv(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class xd extends mp{}class Ed extends mp{constructor(e){super(),this.elements=e}}function vC(t,e){const r=xC(e);for(const n of t.elements)r.some(s=>Ba(s,n))||r.push(n);return{arrayValue:{values:r}}}class _d extends mp{constructor(e){super(),this.elements=e}}function yC(t,e){let r=xC(e);for(const n of t.elements)r=r.filter(s=>!Ba(s,n));return{arrayValue:{values:r}}}class oh extends mp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function O_(t){return zr(t.integerValue||t.doubleValue)}function xC(t){return Z1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,r){this.field=e,this.transform=r}}function bN(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Ed&&s instanceof Ed||n instanceof _d&&s instanceof _d?xc(n.elements,s.elements,Ba):n instanceof oh&&s instanceof oh?Ba(n.Pe,s.Pe):n instanceof xd&&s instanceof xd}(t.transform,e.transform)}class SN{constructor(e,r){this.version=e,this.transformResults=r}}class us{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new us}static exists(e){return new us(void 0,e)}static updateTime(e){return new us(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function b0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class gp{}function EC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vp(t.key,us.none()):new Xd(t.key,t.data,us.none());{const r=t.data,n=Es.empty();let s=new kn(gn.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new vo(t.key,n,new Cs(s.toArray()),us.none())}}function AN(t,e,r){t instanceof Xd?function(s,i,a){const o=s.value.clone(),l=L_(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof vo?function(s,i,a){if(!b0(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=L_(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(_C(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function $u(t,e,r,n){return t instanceof Xd?function(i,a,o,l){if(!b0(i.precondition,a))return o;const c=i.value.clone(),u=B_(i.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof vo?function(i,a,o,l){if(!b0(i.precondition,a))return o;const c=B_(i.fieldTransforms,l,a),u=a.data;return u.setAll(_C(i)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(i,a,o){return b0(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function TN(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=gC(n.transform,s||null);i!=null&&(r===null&&(r=Es.empty()),r.set(n.field,i))}return r||null}function M_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&xc(n,s,(i,a)=>bN(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xd extends gp{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class vo extends gp{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function _C(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function L_(t,e,r){const n=new Map;mr(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,EN(a,o,r[s]))}return n}function B_(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,xN(i,a,e))}return n}class vp extends gp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wN extends gp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&AN(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=$u(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=$u(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=pC();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=EC(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Ft.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),qt())}isEqual(e){return this.batchId===e.batchId&&xc(this.mutations,e.mutations,(r,n)=>M_(r,n))&&xc(this.baseMutations,e.baseMutations,(r,n)=>M_(r,n))}}class sy{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){mr(e.mutations.length===n.length);let s=function(){return pN}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new sy(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Yr,er;function DN(t){switch(t){default:return Dt();case je.CANCELLED:case je.UNKNOWN:case je.DEADLINE_EXCEEDED:case je.RESOURCE_EXHAUSTED:case je.INTERNAL:case je.UNAVAILABLE:case je.UNAUTHENTICATED:return!1;case je.INVALID_ARGUMENT:case je.NOT_FOUND:case je.ALREADY_EXISTS:case je.PERMISSION_DENIED:case je.FAILED_PRECONDITION:case je.ABORTED:case je.OUT_OF_RANGE:case je.UNIMPLEMENTED:case je.DATA_LOSS:return!0}}function bC(t){if(t===void 0)return Si("GRPC error has no .code"),je.UNKNOWN;switch(t){case Yr.OK:return je.OK;case Yr.CANCELLED:return je.CANCELLED;case Yr.UNKNOWN:return je.UNKNOWN;case Yr.DEADLINE_EXCEEDED:return je.DEADLINE_EXCEEDED;case Yr.RESOURCE_EXHAUSTED:return je.RESOURCE_EXHAUSTED;case Yr.INTERNAL:return je.INTERNAL;case Yr.UNAVAILABLE:return je.UNAVAILABLE;case Yr.UNAUTHENTICATED:return je.UNAUTHENTICATED;case Yr.INVALID_ARGUMENT:return je.INVALID_ARGUMENT;case Yr.NOT_FOUND:return je.NOT_FOUND;case Yr.ALREADY_EXISTS:return je.ALREADY_EXISTS;case Yr.PERMISSION_DENIED:return je.PERMISSION_DENIED;case Yr.FAILED_PRECONDITION:return je.FAILED_PRECONDITION;case Yr.ABORTED:return je.ABORTED;case Yr.OUT_OF_RANGE:return je.OUT_OF_RANGE;case Yr.UNIMPLEMENTED:return je.UNIMPLEMENTED;case Yr.DATA_LOSS:return je.DATA_LOSS;default:return Dt()}}(er=Yr||(Yr={}))[er.OK=0]="OK",er[er.CANCELLED=1]="CANCELLED",er[er.UNKNOWN=2]="UNKNOWN",er[er.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",er[er.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",er[er.NOT_FOUND=5]="NOT_FOUND",er[er.ALREADY_EXISTS=6]="ALREADY_EXISTS",er[er.PERMISSION_DENIED=7]="PERMISSION_DENIED",er[er.UNAUTHENTICATED=16]="UNAUTHENTICATED",er[er.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",er[er.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",er[er.ABORTED=10]="ABORTED",er[er.OUT_OF_RANGE=11]="OUT_OF_RANGE",er[er.UNIMPLEMENTED=12]="UNIMPLEMENTED",er[er.INTERNAL=13]="INTERNAL",er[er.UNAVAILABLE=14]="UNAVAILABLE",er[er.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN=new jo([4294967295,4294967295],0);function U_(t){const e=PN().encode(t),r=new Kw;return r.update(e),new Uint8Array(r.digest())}function $_(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new jo([r,n],0),new jo([s,i],0)]}class ay{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new xu(`Invalid padding: ${r}`);if(n<0)throw new xu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new xu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new xu(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=jo.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(jo.fromNumber(n)));return s.compare(RN)===1&&(s=new jo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=U_(e),[n,s]=$_(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);if(!this.de(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new ay(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=U_(e),[n,s]=$_(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class xu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Yd.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new yp(Ft.min(),s,new Or(lr),Ai(),qt())}}class Yd{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Yd(n,r,qt(),qt(),qt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class SC{constructor(e,r){this.targetId=e,this.me=r}}class AC{constructor(e,r,n=yn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class V_{constructor(){this.fe=0,this.ge=j_(),this.pe=yn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=qt(),r=qt(),n=qt();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Dt()}}),new Yd(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=j_()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,mr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class FN{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ai(),this.qe=H_(),this.Qe=new Or(lr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Dt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(vv(i))if(n===0){const a=new vt(i.path);this.Ue(r,a,Gn.newNoDocument(a,Ft.min()))}else mr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=el(n).toUint8Array()}catch(l){if(l instanceof rC)return Zo("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new ay(a,s,i)}catch(l){return Zo(l instanceof xu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&vv(o.target)){const l=new vt(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Gn.newNoDocument(l,e))}i.be&&(r.set(a,i.ve()),i.Ce())}});let n=qt();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new yp(e,r,this.Qe,this.ke,n);return this.ke=Ai(),this.qe=H_(),this.Qe=new Or(lr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new V_,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new kn(lr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||dt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new V_),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function H_(){return new Or(vt.comparator)}function j_(){return new Or(vt.comparator)}const NN={asc:"ASCENDING",desc:"DESCENDING"},ON={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},MN={and:"AND",or:"OR"};class LN{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function xv(t,e){return t.useProto3Json||up(e)?e:{value:e}}function lh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function BN(t,e){return lh(t,e.toTimestamp())}function Na(t){return mr(!!t),Ft.fromTimestamp(function(r){const n=fo(r);return new rn(n.seconds,n.nanos)}(t))}function iy(t,e){return Ev(t,e).canonicalString()}function Ev(t,e){const r=function(s){return new br(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function wC(t){const e=br.fromString(t);return mr(PC(e)),e}function _v(t,e){return iy(t.databaseId,e.path)}function mm(t,e){const r=wC(e);if(r.get(1)!==t.databaseId.projectId)throw new nt(je.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new nt(je.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new vt(IC(r))}function CC(t,e){return iy(t.databaseId,e)}function UN(t){const e=wC(t);return e.length===4?br.emptyPath():IC(e)}function bv(t){return new br(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function IC(t){return mr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function G_(t,e,r){return{name:_v(t,e),fields:r.value.mapValue.fields}}function $N(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Dt()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(mr(u===void 0||typeof u=="string"),yn.fromBase64String(u||"")):(mr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),yn.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?je.UNKNOWN:bC(c.code);return new nt(u,c.message||"")}(a);r=new AC(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=mm(t,n.document.name),i=Na(n.document.updateTime),a=n.document.createTime?Na(n.document.createTime):Ft.min(),o=new Es({mapValue:{fields:n.document.fields}}),l=Gn.newFoundDocument(s,i,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new S0(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=mm(t,n.document),i=n.readTime?Na(n.readTime):Ft.min(),a=Gn.newNoDocument(s,i),o=n.removedTargetIds||[];r=new S0([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=mm(t,n.document),i=n.removedTargetIds||[];r=new S0([],i,s,null)}else{if(!("filter"in e))return Dt();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new kN(s,i),o=n.targetId;r=new SC(o,a)}}return r}function VN(t,e){let r;if(e instanceof Xd)r={update:G_(t,e.key,e.value)};else if(e instanceof vp)r={delete:_v(t,e.key)};else if(e instanceof vo)r={update:G_(t,e.key,e.data),updateMask:YN(e.fieldMask)};else{if(!(e instanceof wN))return Dt();r={verify:_v(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof xd)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ed)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof _d)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof oh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Dt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:BN(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Dt()}(t,e.precondition)),r}function HN(t,e){return t&&t.length>0?(mr(e!==void 0),t.map(r=>function(s,i){let a=s.updateTime?Na(s.updateTime):Na(i);return a.isEqual(Ft.min())&&(a=Na(i)),new SN(a,s.transformResults||[])}(r,e))):[]}function jN(t,e){return{documents:[CC(t,e.path)]}}function GN(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=CC(t,s);const i=function(c){if(c.length!==0)return DC(ga.create(c,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:$l(h.field),direction:KN(h.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=xv(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:s}}function WN(t){let e=UN(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){mr(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];r.where&&(i=function(f){const h=kC(f);return h instanceof ga&&iC(h)?h.getFilters():[h]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(h=>function(v){return new yd(Vl(v.field),function(y){switch(y){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(f){let h;return h=typeof f=="object"?f.value:f,up(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(f){const h=!!f.before,p=f.values||[];return new Sc(p,h)}(r.startAt));let c=null;return r.endAt&&(c=function(f){const h=!f.before,p=f.values||[];return new Sc(p,h)}(r.endAt)),cN(e,s,a,i,o,"F",l,c)}function zN(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Dt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function kC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Vl(r.unaryFilter.field);return en.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Vl(r.unaryFilter.field);return en.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Vl(r.unaryFilter.field);return en.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Vl(r.unaryFilter.field);return en.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Dt()}}(t):t.fieldFilter!==void 0?function(r){return en.create(Vl(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Dt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ga.create(r.compositeFilter.filters.map(n=>kC(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Dt()}}(r.compositeFilter.op))}(t):Dt()}function KN(t){return NN[t]}function qN(t){return ON[t]}function XN(t){return MN[t]}function $l(t){return{fieldPath:t.canonicalString()}}function Vl(t){return gn.fromServerFormat(t.fieldPath)}function DC(t){return t instanceof en?function(r){if(r.op==="=="){if(D_(r.value))return{unaryFilter:{field:$l(r.field),op:"IS_NAN"}};if(k_(r.value))return{unaryFilter:{field:$l(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(D_(r.value))return{unaryFilter:{field:$l(r.field),op:"IS_NOT_NAN"}};if(k_(r.value))return{unaryFilter:{field:$l(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:$l(r.field),op:qN(r.op),value:r.value}}}(t):t instanceof ga?function(r){const n=r.getFilters().map(s=>DC(s));return n.length===1?n[0]:{compositeFilter:{op:XN(r.op),filters:n}}}(t):Dt()}function YN(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function PC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,r,n,s,i=Ft.min(),a=Ft.min(),o=yn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e){this.ct=e}}function JN(t){const e=WN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ih(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(){this.un=new eO}addToCollectionParentIndex(e,r){return this.un.add(r),Xe.resolve()}getCollectionParents(e,r){return Xe.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Xe.resolve()}deleteFieldIndex(e,r){return Xe.resolve()}deleteAllFieldIndexes(e){return Xe.resolve()}createTargetIndexes(e,r){return Xe.resolve()}getDocumentsMatchingTarget(e,r){return Xe.resolve(null)}getIndexType(e,r){return Xe.resolve(0)}getFieldIndexes(e,r){return Xe.resolve([])}getNextCollectionGroupToUpdate(e){return Xe.resolve(null)}getMinOffset(e,r){return Xe.resolve(uo.min())}getMinOffsetFromCollectionGroup(e,r){return Xe.resolve(uo.min())}updateCollectionGroup(e,r,n){return Xe.resolve()}updateIndexEntries(e,r){return Xe.resolve()}}class eO{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new kn(br.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new kn(br.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Ac(0)}static kn(){return new Ac(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(){this.changes=new Mc(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Gn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Xe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&$u(n.mutation,s,Cs.empty(),rn.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,qt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=qt()){const s=Mo();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=yu();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Mo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,qt()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=Ai();const a=Uu(),o=function(){return Uu()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof vo)?i=i.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),$u(u.mutation,c,u.mutation.getFieldMask(),rn.now())):a.set(c.key,Cs.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var f;return o.set(c,new rO(u,(f=a.get(c))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Uu();let s=new Or((a,o)=>a-o),i=qt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Cs.empty();u=o.applyToLocalView(c,u),n.set(l,u);const f=(s.get(o.batchId)||qt()).add(l);s=s.insert(o.batchId,f)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,f=pC();u.forEach(h=>{if(!i.has(h)){const p=EC(r.get(h),n.get(h));p!==null&&f.set(h,p),i=i.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,f))}return Xe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return vt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):ry(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):Xe.resolve(Mo());let o=-1,l=i;return a.next(c=>Xe.forEach(c,(u,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),i.get(u)?Xe.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,qt())).next(u=>({batchId:o,changes:hC(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new vt(r)).next(n=>{let s=yu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=yu();return this.indexManager.getCollectionParents(e,i).next(o=>Xe.forEach(o,l=>{const c=function(f,h){return new fl(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((f,h)=>{a=a.insert(f,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Gn.newInvalidDocument(u)))});let o=yu();return a.forEach((l,c)=>{const u=i.get(l);u!==void 0&&$u(u.mutation,c,Cs.empty(),rn.now()),pp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Xe.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Na(s.createTime)}}(r)),Xe.resolve()}getNamedQuery(e,r){return Xe.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:JN(s.bundledQuery),readTime:Na(s.readTime)}}(r)),Xe.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(){this.overlays=new Or(vt.comparator),this.Ir=new Map}getOverlay(e,r){return Xe.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Mo();return Xe.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),Xe.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),Xe.resolve()}getOverlaysForCollection(e,r,n){const s=Mo(),i=r.length+1,a=new vt(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return Xe.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Or((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=i.get(c.largestBatchId);u===null&&(u=Mo(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Mo(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return Xe.resolve(o)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new IN(r,n));let i=this.Ir.get(r);i===void 0&&(i=qt(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(){this.sessionToken=yn.EMPTY_BYTE_STRING}getSessionToken(e){return Xe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Xe.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(){this.Tr=new kn(fn.Er),this.dr=new kn(fn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new fn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new fn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new vt(new br([])),n=new fn(r,e),s=new fn(r,e+1),i=[];return this.dr.forEachInRange([n,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new vt(new br([])),n=new fn(r,e),s=new fn(r,e+1);let i=qt();return this.dr.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new fn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class fn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return vt.comparator(e.key,r.key)||lr(e.wr,r.wr)}static Ar(e,r){return lr(e.wr,r.wr)||vt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new kn(fn.Er)}checkEmpty(e){return Xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new CN(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.br=this.br.add(new fn(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Xe.resolve(a)}lookupMutationBatch(e,r){return Xe.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return Xe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Xe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new fn(r,0),s=new fn(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],a=>{const o=this.Dr(a.wr);i.push(o)}),Xe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new kn(lr);return r.forEach(s=>{const i=new fn(s,0),a=new fn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{n=n.add(o.wr)})}),Xe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;vt.isDocumentKey(i)||(i=i.child(""));const a=new fn(new vt(i),0);let o=new kn(lr);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},a),Xe.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){mr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Xe.forEach(r.mutations,s=>{const i=new fn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new fn(r,0),s=this.br.firstAfterOrEqual(n);return Xe.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Xe.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e){this.Mr=e,this.docs=function(){return new Or(vt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Xe.resolve(n?n.document.mutableCopy():Gn.newInvalidDocument(r))}getEntries(e,r){let n=Ai();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Gn.newInvalidDocument(s))}),Xe.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=Ai();const a=r.path,o=new vt(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||G5(j5(u),n)<=0||(s.has(u.key)||pp(r,u))&&(i=i.insert(u.key,u.mutableCopy()))}return Xe.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Dt()}Or(e,r){return Xe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new cO(this)}getSize(e){return Xe.resolve(this.size)}}class cO extends tO{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),Xe.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e){this.persistence=e,this.Nr=new Mc(r=>ey(r),ty),this.lastRemoteSnapshotVersion=Ft.min(),this.highestTargetId=0,this.Lr=0,this.Br=new oy,this.targetCount=0,this.kr=Ac.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),Xe.resolve()}getLastRemoteSnapshotVersion(e){return Xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Xe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Xe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Xe.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Ac(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Xe.resolve()}updateTargetData(e,r){return this.Kn(r),Xe.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Xe.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),Xe.waitFor(i).next(()=>s)}getTargetCount(e){return Xe.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Xe.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Xe.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),Xe.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Xe.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Xe.resolve(n)}containsKey(e,r){return Xe.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e,r){this.qr={},this.overlays={},this.Qr=new Q1(0),this.Kr=!1,this.Kr=!0,this.$r=new iO,this.referenceDelegate=e(this),this.Ur=new uO(this),this.indexManager=new ZN,this.remoteDocumentCache=function(s){return new lO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new QN(r),this.Gr=new sO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new aO,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new oO(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){dt("MemoryPersistence","Starting transaction:",e);const s=new fO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return Xe.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class fO extends z5{constructor(e){super(),this.currentSequenceNumber=e}}class ly{constructor(e){this.persistence=e,this.Jr=new oy,this.Yr=null}static Zr(e){return new ly(e)}get Xr(){if(this.Yr)return this.Yr;throw Dt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Xe.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Xe.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Xe.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xe.forEach(this.Xr,n=>{const s=vt.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,Ft.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Xe.or([()=>Xe.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cy{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=qt(),s=qt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new cy(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return DR()?8:K5(Jn())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new hO;return this.Xi(e,r,a).next(o=>{if(i.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(nu()<=Yt.DEBUG&&dt("QueryEngine","SDK will not create cache indexes for query:",Ul(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Xe.resolve()):(nu()<=Yt.DEBUG&&dt("QueryEngine","Query:",Ul(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(nu()<=Yt.DEBUG&&dt("QueryEngine","The SDK decides to create cache indexes for query:",Ul(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fa(r))):Xe.resolve())}Yi(e,r){if(N_(r))return Xe.resolve(null);let n=Fa(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=ih(r,null,"F"),n=Fa(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=qt(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,ih(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,s){return N_(r)||s.isEqual(Ft.min())?Xe.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const a=this.ts(r,i);return this.ns(r,a,n,s)?Xe.resolve(null):(nu()<=Yt.DEBUG&&dt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ul(r)),this.rs(e,a,r,H5(s,-1)).next(o=>o))})}ts(e,r){let n=new kn(dC(e));return r.forEach((s,i)=>{pp(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return nu()<=Yt.DEBUG&&dt("QueryEngine","Using full collection scan to execute query:",Ul(r)),this.Ji.getDocumentsMatchingQuery(e,r,uo.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Or(lr),this._s=new Mc(i=>ey(i),ty),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new nO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function gO(t,e,r,n){return new mO(t,e,r,n)}async function RC(t,e){const r=Ot(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=qt();for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function vO(t,e){const r=Ot(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const f=c.batch,h=f.keys();let p=Xe.resolve();return h.forEach(v=>{p=p.next(()=>u.getEntry(l,v)).next(g=>{const y=c.docVersions.get(v);mr(y!==null),g.version.compareTo(y)<0&&(f.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),u.addEntry(g)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=qt();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function FC(t){const e=Ot(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function yO(t,e){const r=Ot(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];e.targetChanges.forEach((u,f)=>{const h=s.get(f);if(!h)return;o.push(r.Ur.removeMatchingKeys(i,u.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(i,u.addedDocuments,f)));let p=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?p=p.withResumeToken(yn.EMPTY_BYTE_STRING,Ft.min()).withLastLimboFreeSnapshotVersion(Ft.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(f,p),function(g,y,b){return g.resumeToken.approximateByteSize()===0||y.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(h,p,u)&&o.push(r.Ur.updateTargetData(i,p))});let l=Ai(),c=qt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,u))}),o.push(xO(i,a,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ft.min())){const u=r.Ur.getLastRemoteSnapshotVersion(i).next(f=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(u)}return Xe.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(r.os=s,i))}function xO(t,e,r){let n=qt(),s=qt();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=Ai();return r.forEach((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ft.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):dt("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:s}})}function EO(t,e){const r=Ot(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function _O(t,e){const r=Ot(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,Xe.resolve(s)):r.Ur.allocateTargetId(n).next(a=>(s=new Qi(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function Sv(t,e,r){const n=Ot(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!qd(a))throw a;dt("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function W_(t,e,r){const n=Ot(t);let s=Ft.min(),i=qt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const f=Ot(l),h=f._s.get(u);return h!==void 0?Xe.resolve(f.os.get(h)):f.Ur.getTargetData(c,u)}(n,a,Fa(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?s:Ft.min(),r?i:qt())).next(o=>(bO(n,dN(e),o),{documents:o,Ts:i})))}function bO(t,e,r){let n=t.us.get(e)||Ft.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class z_{constructor(){this.activeTargetIds=vN()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class SO{constructor(){this.so=new z_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new z_,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){dt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){dt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uf=null;function gm(){return Uf===null?Uf=function(){return 268435456+Math.round(2147483648*Math.random())}():Uf++,"0x"+Uf.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mn="WebChannelConnection";class CO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,a){const o=gm(),l=this.xo(r,n.toUriEncodedString());dt("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,a),this.No(r,l,c,s).then(u=>(dt("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw Zo("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,i,a,o){return this.Mo(r,n,s,i,a)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Oc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>r[a]=i),s&&s.headers.forEach((i,a)=>r[a]=i)}xo(r,n){const s=TO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=gm();return new Promise((a,o)=>{const l=new qw;l.setWithCredentials(!0),l.listenOnce(Xw.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case E0.NO_ERROR:const u=l.getResponseJson();dt(Mn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),a(u);break;case E0.TIMEOUT:dt(Mn,`RPC '${e}' ${i} timed out`),o(new nt(je.DEADLINE_EXCEEDED,"Request time out"));break;case E0.HTTP_ERROR:const f=l.getStatus();if(dt(Mn,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const p=h==null?void 0:h.error;if(p&&p.status&&p.message){const v=function(y){const b=y.toLowerCase().replace(/_/g,"-");return Object.values(je).indexOf(b)>=0?b:je.UNKNOWN}(p.status);o(new nt(v,p.message))}else o(new nt(je.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new nt(je.UNAVAILABLE,"Connection failed."));break;default:Dt()}}finally{dt(Mn,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);dt(Mn,`RPC '${e}' ${i} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const s=gm(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Jw(),o=Qw(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=i.join("");dt(Mn,`Creating RPC '${e}' stream ${s}: ${u}`,l);const f=a.createWebChannel(u,l);let h=!1,p=!1;const v=new wO({Io:y=>{p?dt(Mn,`Not sending because RPC '${e}' stream ${s} is closed:`,y):(h||(dt(Mn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),h=!0),dt(Mn,`RPC '${e}' stream ${s} sending:`,y),f.send(y))},To:()=>f.close()}),g=(y,b,E)=>{y.listen(b,x=>{try{E(x)}catch(I){setTimeout(()=>{throw I},0)}})};return g(f,vu.EventType.OPEN,()=>{p||(dt(Mn,`RPC '${e}' stream ${s} transport opened.`),v.yo())}),g(f,vu.EventType.CLOSE,()=>{p||(p=!0,dt(Mn,`RPC '${e}' stream ${s} transport closed`),v.So())}),g(f,vu.EventType.ERROR,y=>{p||(p=!0,Zo(Mn,`RPC '${e}' stream ${s} transport errored:`,y),v.So(new nt(je.UNAVAILABLE,"The operation could not be completed")))}),g(f,vu.EventType.MESSAGE,y=>{var b;if(!p){const E=y.data[0];mr(!!E);const x=E,I=x.error||((b=x[0])===null||b===void 0?void 0:b.error);if(I){dt(Mn,`RPC '${e}' stream ${s} received error:`,I);const D=I.status;let P=function(m){const T=Yr[m];if(T!==void 0)return bC(T)}(D),w=I.message;P===void 0&&(P=je.INTERNAL,w="Unknown error status: "+D+" with message "+I.message),p=!0,v.So(new nt(P,w)),f.close()}else dt(Mn,`RPC '${e}' stream ${s} received:`,E),v.bo(E)}}),g(o,Yw.STAT_EVENT,y=>{y.stat===hv.PROXY?dt(Mn,`RPC '${e}' stream ${s} detected buffering proxy`):y.stat===hv.NOPROXY&&dt(Mn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function vm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xp(t){return new LN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&dt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,r,n,s,i,a,o,l){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new NC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===je.RESOURCE_EXHAUSTED?(Si(r.toString()),Si("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===je.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new nt(je.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return dt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(dt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IO extends OC{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=$N(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ft.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ft.min():a.readTime?Na(a.readTime):Ft.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=bv(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=vv(l)?{documents:jN(i,l)}:{query:GN(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=TC(i,a.resumeToken);const c=xv(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ft.min())>0){o.readTime=lh(i,a.snapshotVersion.toTimestamp());const c=xv(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=zN(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=bv(this.serializer),r.removeTarget=e,this.a_(r)}}class kO extends OC{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return mr(!!e.streamToken),this.lastStreamToken=e.streamToken,mr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){mr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=HN(e.writeResults,e.commitTime),n=Na(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=bv(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>VN(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new nt(je.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Ev(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new nt(je.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Ev(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new nt(je.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class PO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Si(r),this.D_=!1):dt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{n.enqueueAndForget(async()=>{hl(this)&&(dt("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Ot(l);c.L_.add(4),await Qd(c),c.q_.set("Unknown"),c.L_.delete(4),await Ep(c)}(this))})}),this.q_=new PO(n,s)}}async function Ep(t){if(hl(t))for(const e of t.B_)await e(!0)}async function Qd(t){for(const e of t.B_)await e(!1)}function MC(t,e){const r=Ot(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),hy(r)?fy(r):Lc(r).r_()&&dy(r,e))}function uy(t,e){const r=Ot(t),n=Lc(r);r.N_.delete(e),n.r_()&&LC(r,e),r.N_.size===0&&(n.r_()?n.o_():hl(r)&&r.q_.set("Unknown"))}function dy(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ft.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Lc(t).A_(e)}function LC(t,e){t.Q_.xe(e),Lc(t).R_(e)}function fy(t){t.Q_=new FN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Lc(t).start(),t.q_.v_()}function hy(t){return hl(t)&&!Lc(t).n_()&&t.N_.size>0}function hl(t){return Ot(t).L_.size===0}function BC(t){t.Q_=void 0}async function FO(t){t.q_.set("Online")}async function NO(t){t.N_.forEach((e,r)=>{dy(t,e)})}async function OO(t,e){BC(t),hy(t)?(t.q_.M_(e),fy(t)):t.q_.set("Unknown")}async function MO(t,e,r){if(t.q_.set("Online"),e instanceof AC&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.N_.delete(o),s.Q_.removeTarget(o))}(t,e)}catch(n){dt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await ch(t,n)}else if(e instanceof S0?t.Q_.Ke(e):e instanceof SC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ft.min()))try{const n=await FC(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(yn.EMPTY_BYTE_STRING,u.snapshotVersion)),LC(i,l);const f=new Qi(u.target,l,c,u.sequenceNumber);dy(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){dt("RemoteStore","Failed to raise snapshot:",n),await ch(t,n)}}async function ch(t,e,r){if(!qd(e))throw e;t.L_.add(1),await Qd(t),t.q_.set("Offline"),r||(r=()=>FC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{dt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await Ep(t)})}function UC(t,e){return e().catch(r=>ch(t,r,e))}async function _p(t){const e=Ot(t),r=ho(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;LO(e);)try{const s=await EO(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,BO(e,s)}catch(s){await ch(e,s)}$C(e)&&VC(e)}function LO(t){return hl(t)&&t.O_.length<10}function BO(t,e){t.O_.push(e);const r=ho(t);r.r_()&&r.V_&&r.m_(e.mutations)}function $C(t){return hl(t)&&!ho(t).n_()&&t.O_.length>0}function VC(t){ho(t).start()}async function UO(t){ho(t).p_()}async function $O(t){const e=ho(t);for(const r of t.O_)e.m_(r.mutations)}async function VO(t,e,r){const n=t.O_.shift(),s=sy.from(n,e,r);await UC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await _p(t)}async function HO(t,e){e&&ho(t).V_&&await async function(n,s){if(function(a){return DN(a)&&a!==je.ABORTED}(s.code)){const i=n.O_.shift();ho(n).s_(),await UC(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await _p(n)}}(t,e),$C(t)&&VC(t)}async function q_(t,e){const r=Ot(t);r.asyncQueue.verifyOperationInProgress(),dt("RemoteStore","RemoteStore received new credentials");const n=hl(r);r.L_.add(3),await Qd(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await Ep(r)}async function jO(t,e){const r=Ot(t);e?(r.L_.delete(2),await Ep(r)):e||(r.L_.add(2),await Qd(r),r.q_.set("Unknown"))}function Lc(t){return t.K_||(t.K_=function(r,n,s){const i=Ot(r);return i.w_(),new IO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:FO.bind(null,t),Ro:NO.bind(null,t),mo:OO.bind(null,t),d_:MO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),hy(t)?fy(t):t.q_.set("Unknown")):(await t.K_.stop(),BC(t))})),t.K_}function ho(t){return t.U_||(t.U_=function(r,n,s){const i=Ot(r);return i.w_(),new kO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:UO.bind(null,t),mo:HO.bind(null,t),f_:$O.bind(null,t),g_:VO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await _p(t)):(await t.U_.stop(),t.O_.length>0&&(dt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new ui,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new py(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(je.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function my(t,e){if(Si("AsyncQueue",`${e}: ${t}`),qd(t))return new nt(je.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||vt.comparator(r.key,n.key):(r,n)=>vt.comparator(r.key,n.key),this.keyedMap=yu(),this.sortedSet=new Or(this.comparator)}static emptySet(e){return new oc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof oc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new oc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(){this.W_=new Or(vt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Dt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Tc{constructor(e,r,n,s,i,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Tc(e,r,oc.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class WO{constructor(){this.queries=Y_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Ot(r),i=s.queries;s.queries=Y_(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new nt(je.ABORTED,"Firestore shutting down"))}}function Y_(){return new Mc(t=>uC(t),hp)}async function gy(t,e){const r=Ot(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new GO,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=my(a,`Initialization of query '${Ul(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&yy(r)}async function vy(t,e){const r=Ot(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function zO(t,e){const r=Ot(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.j_)o.X_(s)&&(n=!0);a.z_=s}}n&&yy(r)}function KO(t,e,r){const n=Ot(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function yy(t){t.Y_.forEach(e=>{e.next()})}var Av,Q_;(Q_=Av||(Av={})).ea="default",Q_.Cache="cache";class xy{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Tc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Tc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Av.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.key=e}}class jC{constructor(e){this.key=e}}class qO{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=qt(),this.mutatedKeys=qt(),this.Aa=dC(e),this.Ra=new oc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new X_,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,f)=>{const h=s.get(u),p=pp(this.query,f)?f:null,v=!!h&&this.mutatedKeys.has(h.key),g=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let y=!1;h&&p?h.data.isEqual(p.data)?v!==g&&(n.track({type:3,doc:p}),y=!0):this.ga(h,p)||(n.track({type:2,doc:p}),y=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!h&&p?(n.track({type:0,doc:p}),y=!0):h&&!p&&(n.track({type:1,doc:h}),y=!0,(l||c)&&(o=!0)),y&&(p?(a=a.add(p),i=g?i.add(u):i.delete(u)):(a=a.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,f)=>function(p,v){const g=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dt()}};return g(p)-g(v)}(u.type,f.type)||this.Aa(u.doc,f.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new Tc(this.query,e.Ra,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new X_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=qt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new jC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new HC(n))}),r}ba(e){this.Ta=e.Ts,this.da=qt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Tc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class XO{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class YO{constructor(e){this.key=e,this.va=!1}}class QO{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Mc(o=>uC(o),hp),this.Ma=new Map,this.xa=new Set,this.Oa=new Or(vt.comparator),this.Na=new Map,this.La=new oy,this.Ba={},this.ka=new Map,this.qa=Ac.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function JO(t,e,r=!0){const n=XC(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await GC(n,e,r,!0),s}async function ZO(t,e){const r=XC(t);await GC(r,e,!0,!1)}async function GC(t,e,r,n){const s=await _O(t.localStore,Fa(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await e9(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&MC(t.remoteStore,s),o}async function e9(t,e,r,n,s){t.Ka=(f,h,p)=>async function(g,y,b,E){let x=y.view.ma(b);x.ns&&(x=await W_(g.localStore,y.query,!1).then(({documents:w})=>y.view.ma(w,x)));const I=E&&E.targetChanges.get(y.targetId),D=E&&E.targetMismatches.get(y.targetId)!=null,P=y.view.applyChanges(x,g.isPrimaryClient,I,D);return Z_(g,y.targetId,P.wa),P.snapshot}(t,f,h,p);const i=await W_(t.localStore,e,!0),a=new qO(e,i.Ts),o=a.ma(i.documents),l=Yd.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=a.applyChanges(o,t.isPrimaryClient,l);Z_(t,r,c.wa);const u=new XO(e,r,a);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function t9(t,e,r){const n=Ot(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(a=>!hp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Sv(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&uy(n.remoteStore,s.targetId),Tv(n,s.targetId)}).catch(Kd)):(Tv(n,s.targetId),await Sv(n.localStore,s.targetId,!0))}async function r9(t,e){const r=Ot(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),uy(r.remoteStore,n.targetId))}async function n9(t,e,r){const n=u9(t);try{const s=await function(a,o){const l=Ot(a),c=rn.now(),u=o.reduce((p,v)=>p.add(v.key),qt());let f,h;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=Ai(),g=qt();return l.cs.getEntries(p,u).next(y=>{v=y,v.forEach((b,E)=>{E.isValidDocument()||(g=g.add(b))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,v)).next(y=>{f=y;const b=[];for(const E of o){const x=TN(E,f.get(E.key).overlayedDocument);x!=null&&b.push(new vo(E.key,x,nC(x.value.mapValue),us.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,b,o)}).next(y=>{h=y;const b=y.applyToLocalDocumentSet(f,g);return l.documentOverlayCache.saveOverlays(p,y.batchId,b)})}).then(()=>({batchId:h.batchId,changes:hC(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Or(lr)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,s.batchId,r),await Jd(n,s.changes),await _p(n.remoteStore)}catch(s){const i=my(s,"Failed to persist write");r.reject(i)}}async function WC(t,e){const r=Ot(t);try{const n=await yO(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Na.get(i);a&&(mr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?mr(a.va):s.removedDocuments.size>0&&(mr(a.va),a.va=!1))}),await Jd(r,n,e)}catch(n){await Kd(n)}}function J_(t,e,r){const n=Ot(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Ot(a);l.onlineState=o;let c=!1;l.queries.forEach((u,f)=>{for(const h of f.j_)h.Z_(o)&&(c=!0)}),c&&yy(l)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function s9(t,e,r){const n=Ot(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let a=new Or(vt.comparator);a=a.insert(i,Gn.newNoDocument(i,Ft.min()));const o=qt().add(i),l=new yp(Ft.min(),new Map,new Or(lr),a,o);await WC(n,l),n.Oa=n.Oa.remove(i),n.Na.delete(e),Ey(n)}else await Sv(n.localStore,e,!1).then(()=>Tv(n,e,r)).catch(Kd)}async function a9(t,e){const r=Ot(t),n=e.batch.batchId;try{const s=await vO(r.localStore,e);KC(r,n,null),zC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Jd(r,s)}catch(s){await Kd(s)}}async function i9(t,e,r){const n=Ot(t);try{const s=await function(a,o){const l=Ot(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(f=>(mr(f!==null),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);KC(n,e,r),zC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Jd(n,s)}catch(s){await Kd(s)}}function zC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function KC(t,e,r){const n=Ot(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function Tv(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||qC(t,n)})}function qC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(uy(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Ey(t))}function Z_(t,e,r){for(const n of r)n instanceof HC?(t.La.addReference(n.key,e),o9(t,n)):n instanceof jC?(dt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||qC(t,n.key)):Dt()}function o9(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(dt("SyncEngine","New document in limbo: "+r),t.xa.add(n),Ey(t))}function Ey(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new vt(br.fromString(e)),n=t.qa.next();t.Na.set(n,new YO(r)),t.Oa=t.Oa.insert(r,n),MC(t.remoteStore,new Qi(Fa(fp(r.path)),n,"TargetPurposeLimboResolution",Q1.oe))}}async function Jd(t,e,r){const n=Ot(t),s=[],i=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const f=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=cy.Wi(l.targetId,c);i.push(f)}}))}),await Promise.all(a),n.Ca.d_(s),await async function(l,c){const u=Ot(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Xe.forEach(c,h=>Xe.forEach(h.$i,p=>u.persistence.referenceDelegate.addReference(f,h.targetId,p)).next(()=>Xe.forEach(h.Ui,p=>u.persistence.referenceDelegate.removeReference(f,h.targetId,p)))))}catch(f){if(!qd(f))throw f;dt("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const h=f.targetId;if(!f.fromCache){const p=u.os.get(h),v=p.snapshotVersion,g=p.withLastLimboFreeSnapshotVersion(v);u.os=u.os.insert(h,g)}}}(n.localStore,i))}async function l9(t,e){const r=Ot(t);if(!r.currentUser.isEqual(e)){dt("SyncEngine","User change. New user:",e.toKey());const n=await RC(r.localStore,e);r.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new nt(je.CANCELLED,a))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Jd(r,n.hs)}}function c9(t,e){const r=Ot(t),n=r.Na.get(e);if(n&&n.va)return qt().add(n.key);{let s=qt();const i=r.Ma.get(e);if(!i)return s;for(const a of i){const o=r.Fa.get(a);s=s.unionWith(o.view.Va)}return s}}function XC(t){const e=Ot(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=WC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=c9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=s9.bind(null,e),e.Ca.d_=zO.bind(null,e.eventManager),e.Ca.$a=KO.bind(null,e.eventManager),e}function u9(t){const e=Ot(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=a9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=i9.bind(null,e),e}class uh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return gO(this.persistence,new pO,e.initialUser,this.serializer)}Ga(e){return new dO(ly.Zr,this.serializer)}Wa(e){return new SO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}uh.provider={build:()=>new uh};class wv{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>J_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=l9.bind(null,this.syncEngine),await jO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new WO}()}createDatastore(e){const r=xp(e.databaseInfo.databaseId),n=function(i){return new CO(i)}(e.databaseInfo);return function(i,a,o,l){return new DO(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new RO(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>J_(this.syncEngine,r,0),function(){return K_.D()?new K_:new AO}())}createSyncEngine(e,r){return function(s,i,a,o,l,c,u){const f=new QO(s,i,a,o,l,c);return u&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Ot(s);dt("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Qd(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}wv.provider={build:()=>new wv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Si("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Vn.UNAUTHENTICATED,this.clientId=Y1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{dt("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(dt("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ui;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=my(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function ym(t,e){t.asyncQueue.verifyOperationInProgress(),dt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await RC(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function e2(t,e){t.asyncQueue.verifyOperationInProgress();const r=await f9(t);dt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>q_(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>q_(e.remoteStore,s)),t._onlineComponents=e}async function f9(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){dt("FirestoreClient","Using user provided OfflineComponentProvider");try{await ym(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===je.FAILED_PRECONDITION||s.code===je.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;Zo("Error using user provided cache. Falling back to memory cache: "+r),await ym(t,new uh)}}else dt("FirestoreClient","Using default OfflineComponentProvider"),await ym(t,new uh);return t._offlineComponents}async function YC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(dt("FirestoreClient","Using user provided OnlineComponentProvider"),await e2(t,t._uninitializedComponentsProvider._online)):(dt("FirestoreClient","Using default OnlineComponentProvider"),await e2(t,new wv))),t._onlineComponents}function h9(t){return YC(t).then(e=>e.syncEngine)}async function dh(t){const e=await YC(t),r=e.eventManager;return r.onListen=JO.bind(null,e.syncEngine),r.onUnlisten=t9.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=ZO.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=r9.bind(null,e.syncEngine),r}function p9(t,e,r={}){const n=new ui;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new _y({next:h=>{u.Za(),a.enqueueAndForget(()=>vy(i,f));const p=h.docs.has(o);!p&&h.fromCache?c.reject(new nt(je.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&h.fromCache&&l&&l.source==="server"?c.reject(new nt(je.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new xy(fp(o.path),u,{includeMetadataChanges:!0,_a:!0});return gy(i,f)}(await dh(t),t.asyncQueue,e,r,n)),n.promise}function m9(t,e,r={}){const n=new ui;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new _y({next:h=>{u.Za(),a.enqueueAndForget(()=>vy(i,f)),h.fromCache&&l.source==="server"?c.reject(new nt(je.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new xy(o,u,{includeMetadataChanges:!0,_a:!0});return gy(i,f)}(await dh(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JC(t,e,r){if(!r)throw new nt(je.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ZC(t,e,r,n){if(e===!0&&n===!0)throw new nt(je.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function r2(t){if(!vt.isDocumentKey(t))throw new nt(je.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function n2(t){if(vt.isDocumentKey(t))throw new nt(je.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Dt()}function Yn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new nt(je.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=bp(t);throw new nt(je.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function g9(t,e){if(e<=0)throw new nt(je.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new nt(je.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new nt(je.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ZC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=QC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Sp{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new s2({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(je.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(je.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new s2(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new eC;switch(n.type){case"firstParty":return new L5(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new nt(je.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=t2.get(r);n&&(dt("ComponentProvider","Removing Datastore"),t2.delete(r),n.terminate())}(this),Promise.resolve()}}function e4(t,e,r,n={}){var s;const i=(t=Yn(t,Sp))._getSettings(),a=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&Zo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Vn.MOCK_USER;else{o=tw(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new nt(je.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Vn(c)}t._authCredentials=new N5(new Zw(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ea(this.firestore,e,this._query)}}class Dn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new di(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Dn(this.firestore,e,this._key)}}class di extends Ea{constructor(e,r,n){super(e,r,fp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Dn(this.firestore,null,new vt(e))}withConverter(e){return new di(this.firestore,e,this._path)}}function _t(t,e,...r){if(t=dr(t),JC("collection","path",e),t instanceof Sp){const n=br.fromString(e,...r);return n2(n),new di(t,null,n)}{if(!(t instanceof Dn||t instanceof di))throw new nt(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(br.fromString(e,...r));return n2(n),new di(t.firestore,null,n)}}function Ze(t,e,...r){if(t=dr(t),arguments.length===1&&(e=Y1.newId()),JC("doc","path",e),t instanceof Sp){const n=br.fromString(e,...r);return r2(n),new Dn(t,null,new vt(n))}{if(!(t instanceof Dn||t instanceof di))throw new nt(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(br.fromString(e,...r));return r2(n),new Dn(t.firestore,t instanceof di?t.converter:null,new vt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a2{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new NC(this,"async_queue_retry"),this.Vu=()=>{const n=vm();n&&dt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=vm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=vm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new ui;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!qd(e))throw e;dt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Si("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=py.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Dt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function i2(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class va extends Sp{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new a2,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new a2(e),this._firestoreClient=void 0,await e}}}function yo(t,e){const r=typeof t=="object"?t:jd(),n=typeof t=="string"?t:"(default)",s=Hd(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=R1("firestore");i&&e4(s,...i)}return s}function Bc(t){if(t._terminated)throw new nt(je.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||v9(t),t._firestoreClient}function v9(t){var e,r,n;const s=t._freezeSettings(),i=function(o,l,c,u){return new Y5(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,QC(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new d9(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rl(yn.fromBase64String(e))}catch(r){throw new nt(je.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new rl(yn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new nt(je.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new gn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new nt(je.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new nt(je.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return lr(this._lat,e._lat)||lr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y9=/^__.*__$/;class x9{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new vo(e,this.data,this.fieldMask,r,this.fieldTransforms):new Xd(e,this.data,r,this.fieldTransforms)}}class t4{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new vo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function r4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Dt()}}class by{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new by(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return fh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(r4(this.Cu)&&y9.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class E9{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||xp(e)}Qu(e,r,n,s=!1){return new by({Cu:e,methodName:r,qu:n,path:gn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function $c(t){const e=t._freezeSettings(),r=xp(t._databaseId);return new E9(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Sy(t,e,r,n,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);Ty("Data must be an object, but it was:",a,n);const o=i4(n,a);let l,c;if(i.merge)l=new Cs(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const u=[];for(const f of i.mergeFields){const h=Cv(e,f,r);if(!a.contains(h))throw new nt(je.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);l4(u,h)||u.push(h)}l=new Cs(u),c=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=a.fieldTransforms;return new x9(new Es(o),l,c)}class wp extends Zd{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wp}}class Ay extends Zd{_toFieldTransform(e){return new _N(e.path,new xd)}isEqual(e){return e instanceof Ay}}function n4(t,e,r,n){const s=t.Qu(1,e,r);Ty("Data must be an object, but it was:",s,n);const i=[],a=Es.empty();dl(n,(l,c)=>{const u=wy(e,l,r);c=dr(c);const f=s.Nu(u);if(c instanceof wp)i.push(u);else{const h=ef(c,f);h!=null&&(i.push(u),a.set(u,h))}});const o=new Cs(i);return new t4(a,o,s.fieldTransforms)}function s4(t,e,r,n,s,i){const a=t.Qu(1,e,r),o=[Cv(e,n,r)],l=[s];if(i.length%2!=0)throw new nt(je.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(Cv(e,i[h])),l.push(i[h+1]);const c=[],u=Es.empty();for(let h=o.length-1;h>=0;--h)if(!l4(c,o[h])){const p=o[h];let v=l[h];v=dr(v);const g=a.Nu(p);if(v instanceof wp)c.push(p);else{const y=ef(v,g);y!=null&&(c.push(p),u.set(p,y))}}const f=new Cs(c);return new t4(u,f,a.fieldTransforms)}function a4(t,e,r,n=!1){return ef(r,t.Qu(n?4:3,e))}function ef(t,e){if(o4(t=dr(t)))return Ty("Unsupported field value:",e,t),i4(t,e);if(t instanceof Zd)return function(n,s){if(!r4(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=ef(o,s.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=dr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return yN(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=rn.fromDate(n);return{timestampValue:lh(s.serializer,i)}}if(n instanceof rn){const i=new rn(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:lh(s.serializer,i)}}if(n instanceof Ap)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof rl)return{bytesValue:TC(s.serializer,n._byteString)};if(n instanceof Dn){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:iy(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof Tp)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return ny(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${bp(n)}`)}(t,e)}function i4(t,e){const r={};return tC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):dl(t,(n,s)=>{const i=ef(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function o4(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof rn||t instanceof Ap||t instanceof rl||t instanceof Dn||t instanceof Zd||t instanceof Tp)}function Ty(t,e,r){if(!o4(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=bp(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Cv(t,e,r){if((e=dr(e))instanceof Uc)return e._internalPath;if(typeof e=="string")return wy(t,e);throw fh("Field path arguments must be of type string or ",t,!1,void 0,r)}const _9=new RegExp("[~\\*/\\[\\]]");function wy(t,e,r){if(e.search(_9)>=0)throw fh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Uc(...e.split("."))._internalPath}catch{throw fh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function fh(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new nt(je.INVALID_ARGUMENT,o+t+l)}function l4(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Dn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new b9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Cp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class b9 extends Cy{data(){return super.data()}}function Cp(t,e){return typeof e=="string"?wy(t,e):e instanceof Uc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c4(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new nt(je.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Iy{}class tf extends Iy{}function or(t,e,...r){let n=[];e instanceof Iy&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof Ip).length,o=i.filter(l=>l instanceof rf).length;if(a>1||a>0&&o>0)throw new nt(je.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class rf extends tf{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new rf(e,r,n)}_apply(e){const r=this._parse(e);return u4(e._query,r),new Ea(e.firestore,e.converter,yv(e._query,r))}_parse(e){const r=$c(e.firestore);return function(i,a,o,l,c,u,f){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new nt(je.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){l2(f,u);const p=[];for(const v of f)p.push(o2(l,i,v));h={arrayValue:{values:p}}}else h=o2(l,i,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||l2(f,u),h=a4(o,a,f,u==="in"||u==="not-in");return en.create(c,u,h)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ur(t,e,r){const n=e,s=Cp("where",t);return rf._create(s,n,r)}class Ip extends Iy{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new Ip(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:ga.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)u4(a,l),a=yv(a,l)}(e._query,r),new Ea(e.firestore,e.converter,yv(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class kp extends tf{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new kp(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new nt(je.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new nt(je.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yd(i,a)}(e._query,this._field,this._direction);return new Ea(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new fl(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function hn(t,e="asc"){const r=e,n=Cp("orderBy",t);return kp._create(n,r)}class Dp extends tf{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Dp(e,r,n)}_apply(e){return new Ea(e.firestore,e.converter,ih(e._query,this._limit,this._limitType))}}function ia(t){return g9("limit",t),Dp._create("limit",t,"F")}class Pp extends tf{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new Pp(e,r,n)}_apply(e){const r=S9(e,this.type,this._docOrFields,this._inclusive);return new Ea(e.firestore,e.converter,function(s,i){return new fl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,r))}}function hh(...t){return Pp._create("startAfter",t,!1)}function S9(t,e,r,n){if(r[0]=dr(r[0]),r[0]instanceof Cy)return function(i,a,o,l,c){if(!l)throw new nt(je.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const f of ic(i))if(f.field.isKeyField())u.push(ah(a,l.key));else{const h=l.data.field(f.field);if(dp(h))throw new nt(je.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const p=f.field.canonicalString();throw new nt(je.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}u.push(h)}return new Sc(u,c)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const s=$c(t.firestore);return function(a,o,l,c,u,f){const h=a.explicitOrderBy;if(u.length>h.length)throw new nt(je.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let v=0;v<u.length;v++){const g=u[v];if(h[v].field.isKeyField()){if(typeof g!="string")throw new nt(je.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!ry(a)&&g.indexOf("/")!==-1)throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);const y=a.path.child(br.fromString(g));if(!vt.isDocumentKey(y))throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${y}' is not because it contains an odd number of segments.`);const b=new vt(y);p.push(ah(o,b))}else{const y=a4(l,c,g);p.push(y)}}return new Sc(p,f)}(t._query,t.firestore._databaseId,s,e,r,n)}}function o2(t,e,r){if(typeof(r=dr(r))=="string"){if(r==="")throw new nt(je.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ry(e)&&r.indexOf("/")!==-1)throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(br.fromString(r));if(!vt.isDocumentKey(n))throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return ah(t,new vt(n))}if(r instanceof Dn)return ah(t,r._key);throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bp(r)}.`)}function l2(t,e){if(!Array.isArray(t)||t.length===0)throw new nt(je.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function u4(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new nt(je.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(je.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class d4{convertValue(e,r="none"){switch(tl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return zr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(el(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Dt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return dl(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(a=>zr(a.doubleValue));return new Tp(i)}convertGeoPoint(e){return new Ap(zr(e.latitude),zr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=J1(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(gd(e));default:return null}}convertTimestamp(e){const r=fo(e);return new rn(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=br.fromString(e);mr(PC(n));const s=new Ec(n.get(1),n.get(3)),i=new vt(n.popFirst(5));return s.isEqual(r)||Si(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ky(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Dy extends Cy{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Vu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Cp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class Vu extends Dy{data(e={}){return super.data(e)}}class Py{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Kl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Vu(this._firestore,this._userDataWriter,n.key,n,new Kl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new nt(je.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new Vu(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Kl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new Vu(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Kl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:A9(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function A9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(t){t=Yn(t,Dn);const e=Yn(t.firestore,va);return p9(Bc(e),t._key).then(r=>h4(e,t,r))}class Ry extends d4{constructor(e){super(),this.firestore=e}convertBytes(e){return new rl(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Dn(this.firestore,null,r)}}function Gt(t){t=Yn(t,Ea);const e=Yn(t.firestore,va),r=Bc(e),n=new Ry(e);return c4(t._query),m9(r,t._query).then(s=>new Py(e,n,t,s))}function Ht(t,e,r){t=Yn(t,Dn);const n=Yn(t.firestore,va),s=ky(t.converter,e,r);return Vc(n,[Sy($c(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,us.none())])}function Rp(t,e,r,...n){t=Yn(t,Dn);const s=Yn(t.firestore,va),i=$c(s);let a;return a=typeof(e=dr(e))=="string"||e instanceof Uc?s4(i,"updateDoc",t._key,e,r,n):n4(i,"updateDoc",t._key,e),Vc(s,[a.toMutation(t._key,us.exists(!0))])}function po(t){return Vc(Yn(t.firestore,va),[new vp(t._key,us.none())])}function f4(t,e){const r=Yn(t.firestore,va),n=Ze(t),s=ky(t.converter,e);return Vc(r,[Sy($c(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,us.exists(!1))]).then(()=>n)}function nf(t,...e){var r,n,s;t=dr(t);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||i2(e[a])||(i=e[a],a++);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(i2(e[a])){const f=e[a];e[a]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[a+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[a+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,u;if(t instanceof Dn)c=Yn(t.firestore,va),u=fp(t._key.path),l={next:f=>{e[a]&&e[a](h4(c,t,f))},error:e[a+1],complete:e[a+2]};else{const f=Yn(t,Ea);c=Yn(f.firestore,va),u=f._query;const h=new Ry(c);l={next:p=>{e[a]&&e[a](new Py(c,h,f,p))},error:e[a+1],complete:e[a+2]},c4(t._query)}return function(h,p,v,g){const y=new _y(g),b=new xy(p,y,v);return h.asyncQueue.enqueueAndForget(async()=>gy(await dh(h),b)),()=>{y.Za(),h.asyncQueue.enqueueAndForget(async()=>vy(await dh(h),b))}}(Bc(c),u,o,l)}function Vc(t,e){return function(n,s){const i=new ui;return n.asyncQueue.enqueueAndForget(async()=>n9(await h9(n),s,i)),i.promise}(Bc(t),e)}function h4(t,e,r){const n=r.docs.get(e._key),s=new Ry(t);return new Dy(t,s,e._key,n,new Kl(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p4{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=$c(e)}set(e,r,n){this._verifyNotCommitted();const s=xm(e,this._firestore),i=ky(s.converter,r,n),a=Sy(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,us.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=xm(e,this._firestore);let a;return a=typeof(r=dr(r))=="string"||r instanceof Uc?s4(this._dataReader,"WriteBatch.update",i._key,r,n,s):n4(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(a.toMutation(i._key,us.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=xm(e,this._firestore);return this._mutations=this._mutations.concat(new vp(r._key,us.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new nt(je.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function xm(t,e){if((t=dr(t)).firestore!==e)throw new nt(je.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function wn(){return new Ay("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(t){return Bc(t=Yn(t,va)),new p4(t,e=>Vc(t,e))}(function(e,r=!0){(function(s){Oc=s})(ul),lo(new Ei("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new va(new O5(n.getProvider("auth-internal")),new U5(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new nt(je.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ec(c.options.projectId,u)}(a,s),a);return i=Object.assign({useFetchStreams:r},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),js(A_,"4.7.3",e),js(A_,"4.7.3","esm2017")})();const T9=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:d4,Bytes:rl,CollectionReference:di,DocumentReference:Dn,DocumentSnapshot:Dy,FieldPath:Uc,FieldValue:Zd,Firestore:va,FirestoreError:nt,GeoPoint:Ap,Query:Ea,QueryCompositeFilterConstraint:Ip,QueryConstraint:tf,QueryDocumentSnapshot:Vu,QueryFieldFilterConstraint:rf,QueryLimitConstraint:Dp,QueryOrderByConstraint:kp,QuerySnapshot:Py,QueryStartAtConstraint:Pp,SnapshotMetadata:Kl,Timestamp:rn,VectorValue:Tp,WriteBatch:p4,_AutoId:Y1,_ByteString:yn,_DatabaseId:Ec,_DocumentKey:vt,_EmptyAuthCredentialsProvider:eC,_FieldPath:gn,_cast:Yn,_logWarn:Zo,_validateIsNotUsedTogether:ZC,addDoc:f4,collection:_t,connectFirestoreEmulator:e4,deleteDoc:po,doc:Ze,ensureFirestoreConfigured:Bc,executeWrite:Vc,getDoc:nr,getDocs:Gt,getFirestore:yo,limit:ia,onSnapshot:nf,orderBy:hn,query:or,serverTimestamp:wn,setDoc:Ht,startAfter:hh,updateDoc:Rp,where:Ur,writeBatch:Fy},Symbol.toStringTag,{value:"Module"}));var w9="firebase",C9="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */js(w9,C9,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4="firebasestorage.googleapis.com",g4="storageBucket",I9=2*60*1e3,k9=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr extends xa{constructor(e,r,n=0){super(Em(e),`Firebase Storage: ${r} (${Em(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Gr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Em(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Hr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Hr||(Hr={}));function Em(t){return"storage/"+t}function Ny(){const t="An unknown error occurred, please check the error payload for server response.";return new Gr(Hr.UNKNOWN,t)}function D9(t){return new Gr(Hr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function P9(t){return new Gr(Hr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function R9(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Gr(Hr.UNAUTHENTICATED,t)}function F9(){return new Gr(Hr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function N9(t){return new Gr(Hr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function O9(){return new Gr(Hr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function M9(){return new Gr(Hr.CANCELED,"User canceled the upload/download.")}function L9(t){return new Gr(Hr.INVALID_URL,"Invalid URL '"+t+"'.")}function B9(t){return new Gr(Hr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function U9(){return new Gr(Hr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+g4+"' property when initializing the app?")}function $9(){return new Gr(Hr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function V9(t){return new Gr(Hr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ph(t){return new Gr(Hr.INVALID_ARGUMENT,t)}function v4(){return new Gr(Hr.APP_DELETED,"The Firebase app was deleted.")}function y4(t){return new Gr(Hr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Hu(t,e){return new Gr(Hr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function su(t){throw new Gr(Hr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=qn.makeFromUrl(e,r)}catch{return new qn(e,"")}if(n.path==="")return n;throw B9(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function c(I){I.path_=decodeURIComponent(I.path)}const u="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${u}/b/${s}/o${h}`,"i"),v={bucket:1,path:3},g=r===m4?"(?:storage.googleapis.com|storage.cloud.google.com)":r,y="([^?#]*)",b=new RegExp(`^https?://${g}/${s}/${y}`,"i"),x=[{regex:o,indices:l,postModify:i},{regex:p,indices:v,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let I=0;I<x.length;I++){const D=x[I],P=D.regex.exec(e);if(P){const w=P[D.indices.bucket];let S=P[D.indices.path];S||(S=""),n=new qn(w,S),D.postModify(n);break}}if(n==null)throw L9(e);return n}}class H9{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j9(t,e,r){let n=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...y){c||(c=!0,e.apply(null,y))}function f(y){s=setTimeout(()=>{s=null,t(p,l())},y)}function h(){i&&clearTimeout(i)}function p(y,...b){if(c){h();return}if(y){h(),u.call(null,y,...b);return}if(l()||a){h(),u.call(null,y,...b);return}n<64&&(n*=2);let x;o===1?(o=2,x=0):x=(n+Math.random())*1e3,f(x)}let v=!1;function g(y){v||(v=!0,h(),!c&&(s!==null?(y||(o=2),clearTimeout(s),f(0)):y||(o=1)))}return f(0),i=setTimeout(()=>{a=!0,g(!0)},r),g}function G9(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W9(t){return t!==void 0}function z9(t){return typeof t=="object"&&!Array.isArray(t)}function x4(t){return typeof t=="string"||t instanceof String}function c2(t){return Oy()&&t instanceof Blob}function Oy(){return typeof Blob<"u"}function Iv(t,e,r,n){if(n<e)throw ph(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw ph(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function K9(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var Go;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Go||(Go={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q9(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X9{constructor(e,r,n,s,i,a,o,l,c,u,f,h=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,v)=>{this.resolve_=p,this.reject_=v,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new $f(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===Go.NO_ERROR,l=i.getStatus();if(!o||q9(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===Go.ABORT;n(!1,new $f(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new $f(c,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());W9(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=Ny();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?v4():M9();a(l)}else{const l=O9();a(l)}};this.canceled_?r(!1,new $f(!1,null,!0)):this.backoffId_=j9(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&G9(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class $f{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function Y9(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Q9(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function J9(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Z9(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function eM(t,e,r,n,s,i,a=!0){const o=K9(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return J9(c,e),Y9(c,r),Q9(c,i),Z9(c,n),new X9(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function rM(...t){const e=tM();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(Oy())return new Blob(t);throw new Gr(Hr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function nM(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sM(t){if(typeof atob>"u")throw V9("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class _m{constructor(e,r){this.data=e,this.contentType=r||null}}function Ly(t,e){switch(t){case $s.RAW:return new _m(E4(e));case $s.BASE64:case $s.BASE64URL:return new _m(_4(t,e));case $s.DATA_URL:return new _m(iM(e),oM(e))}throw Ny()}function E4(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const i=n,a=t.charCodeAt(++r);n=65536|(i&1023)<<10|a&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function aM(t){let e;try{e=decodeURIComponent(t)}catch{throw Hu($s.DATA_URL,"Malformed data URL.")}return E4(e)}function _4(t,e){switch(t){case $s.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Hu(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case $s.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Hu(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=sM(e)}catch(s){throw s.message.includes("polyfill")?s:Hu(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}class b4{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Hu($s.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=lM(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function iM(t){const e=new b4(t);return e.base64?_4($s.BASE64,e.rest):aM(e.rest)}function oM(t){return new b4(t).contentType}function lM(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,r){let n=0,s="";c2(e)?(this.data_=e,n=e.size,s=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,r){if(c2(this.data_)){const n=this.data_,s=nM(n,e,r);return s===null?null:new si(s)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new si(n,!0)}}static getBlob(...e){if(Oy()){const r=e.map(n=>n instanceof si?n.data_:n);return new si(rM.apply(null,r))}else{const r=e.map(a=>x4(a)?Ly($s.RAW,a).data:a.data_);let n=0;r.forEach(a=>{n+=a.byteLength});const s=new Uint8Array(n);let i=0;return r.forEach(a=>{for(let o=0;o<a.length;o++)s[i++]=a[o]}),new si(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S4(t){let e;try{e=JSON.parse(t)}catch{return null}return z9(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function uM(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function A4(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dM(t,e){return e}class rs{constructor(e,r,n,s){this.server=e,this.local=r||e,this.writable=!!n,this.xform=s||dM}}let Vf=null;function fM(t){return!x4(t)||t.length<2?t:A4(t)}function hM(){if(Vf)return Vf;const t=[];t.push(new rs("bucket")),t.push(new rs("generation")),t.push(new rs("metageneration")),t.push(new rs("name","fullPath",!0));function e(i,a){return fM(a)}const r=new rs("name");r.xform=e,t.push(r);function n(i,a){return a!==void 0?Number(a):a}const s=new rs("size");return s.xform=n,t.push(s),t.push(new rs("timeCreated")),t.push(new rs("updated")),t.push(new rs("md5Hash",null,!0)),t.push(new rs("cacheControl",null,!0)),t.push(new rs("contentDisposition",null,!0)),t.push(new rs("contentEncoding",null,!0)),t.push(new rs("contentLanguage",null,!0)),t.push(new rs("contentType",null,!0)),t.push(new rs("metadata","customMetadata",!0)),Vf=t,Vf}function pM(t,e){function r(){const n=t.bucket,s=t.fullPath,i=new qn(n,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:r})}function mM(t,e,r){const n={};n.type="file";const s=r.length;for(let i=0;i<s;i++){const a=r[i];n[a.local]=a.xform(n,e[a.server])}return pM(n,t),n}function gM(t,e,r){const n=S4(e);return n===null?null:mM(t,n,r)}function vM(t,e){const r={},n=e.length;for(let s=0;s<n;s++){const i=e[s];i.writable&&(r[i.server]=t[i.local])}return JSON.stringify(r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u2="prefixes",d2="items";function yM(t,e,r){const n={prefixes:[],items:[],nextPageToken:r.nextPageToken};if(r[u2])for(const s of r[u2]){const i=s.replace(/\/$/,""),a=t._makeStorageReference(new qn(e,i));n.prefixes.push(a)}if(r[d2])for(const s of r[d2]){const i=t._makeStorageReference(new qn(e,s.name));n.items.push(i)}return n}function xM(t,e,r){const n=S4(r);return n===null?null:yM(t,e,n)}class By{constructor(e,r,n,s){this.url=e,this.method=r,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(t){if(!t)throw Ny()}function EM(t,e){function r(n,s){const i=gM(t,s,e);return T4(i!==null),i}return r}function _M(t,e){function r(n,s){const i=xM(t,e,s);return T4(i!==null),i}return r}function Uy(t){function e(r,n){let s;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?s=F9():s=R9():r.getStatus()===402?s=P9(t.bucket):r.getStatus()===403?s=N9(t.path):s=n,s.status=r.getStatus(),s.serverResponse=n.serverResponse,s}return e}function bM(t){const e=Uy(t);function r(n,s){let i=e(n,s);return n.getStatus()===404&&(i=D9(t.path)),i.serverResponse=s.serverResponse,i}return r}function SM(t,e,r,n,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",r.length>0&&(i.delimiter=r),n&&(i.pageToken=n),s&&(i.maxResults=s);const a=e.bucketOnlyServerUrl(),o=My(a,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,u=new By(o,l,_M(t,e.bucket),c);return u.urlParams=i,u.errorHandler=Uy(e),u}function AM(t,e){const r=e.fullServerUrl(),n=My(r,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(l,c){}const o=new By(n,s,a,i);return o.successCodes=[200,204],o.errorHandler=bM(e),o}function TM(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function wM(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=TM(null,e)),n}function CM(t,e,r,n,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let x="";for(let I=0;I<2;I++)x=x+Math.random().toString().slice(2);return x}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=wM(e,n,s),u=vM(c,r),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",p=si.getBlob(f,n,h);if(p===null)throw $9();const v={name:c.fullPath},g=My(i,t.host,t._protocol),y="POST",b=t.maxUploadRetryTime,E=new By(g,y,EM(t,r),b);return E.urlParams=v,E.headers=a,E.body=p.uploadData(),E.errorHandler=Uy(e),E}class IM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Go.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Go.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Go.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,s){if(this.sent_)throw su("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw su("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw su("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw su("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw su("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class kM extends IM{initXhr(){this.xhr_.responseType="text"}}function $y(){return new kM}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,r){this._service=e,r instanceof qn?this._location=r:this._location=qn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new nl(e,r)}get root(){const e=new qn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return A4(this._location.path)}get storage(){return this._service}get parent(){const e=cM(this._location.path);if(e===null)return null;const r=new qn(this._location.bucket,e);return new nl(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw y4(e)}}function w4(t,e,r){t._throwIfRoot("uploadBytes");const n=CM(t.storage,t._location,hM(),new si(e,!0),r);return t.storage.makeRequestWithTokens(n,$y).then(s=>({metadata:s,ref:t}))}function DM(t,e,r=$s.RAW,n){t._throwIfRoot("uploadString");const s=Ly(r,e),i=Object.assign({},n);return i.contentType==null&&s.contentType!=null&&(i.contentType=s.contentType),w4(t,s.data,i)}function PM(t){const e={prefixes:[],items:[]};return C4(t,e).then(()=>e)}async function C4(t,e,r){const s=await RM(t,{pageToken:r});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await C4(t,e,s.nextPageToken)}function RM(t,e){e!=null&&typeof e.maxResults=="number"&&Iv("options.maxResults",1,1e3,e.maxResults);const r=e||{},n=SM(t.storage,t._location,"/",r.pageToken,r.maxResults);return t.storage.makeRequestWithTokens(n,$y)}function FM(t){t._throwIfRoot("deleteObject");const e=AM(t.storage,t._location);return t.storage.makeRequestWithTokens(e,$y)}function NM(t,e){const r=uM(t._location.path,e),n=new qn(t._location.bucket,r);return new nl(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OM(t){return/^[A-Za-z]+:\/\//.test(t)}function MM(t,e){return new nl(t,e)}function I4(t,e){if(t instanceof Vy){const r=t;if(r._bucket==null)throw U9();const n=new nl(r,r._bucket);return e!=null?I4(n,e):n}else return e!==void 0?NM(t,e):t}function LM(t,e){if(e&&OM(e)){if(t instanceof Vy)return MM(t,e);throw ph("To use ref(service, url), the first argument must be a Storage instance.")}else return I4(t,e)}function f2(t,e){const r=e==null?void 0:e[g4];return r==null?null:qn.makeFromBucketSpec(r,t)}function BM(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:tw(s,t.app.options.projectId))}class Vy{constructor(e,r,n,s,i){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=m4,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=I9,this._maxUploadRetryTime=k9,this._requests=new Set,s!=null?this._bucket=qn.makeFromBucketSpec(s,this._host):this._bucket=f2(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=qn.makeFromBucketSpec(this._url,e):this._bucket=f2(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Iv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Iv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new nl(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new H9(v4());{const a=eM(e,this._appId,n,s,r,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const h2="@firebase/storage",p2="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4="storage";function D4(t,e,r){return t=dr(t),w4(t,e,r)}function P4(t,e,r,n){return t=dr(t),DM(t,e,r,n)}function R4(t){return t=dr(t),PM(t)}function kv(t){return t=dr(t),FM(t)}function mh(t,e){return t=dr(t),LM(t,e)}function F4(t=jd(),e){t=dr(t);const n=Hd(t,k4).getImmediate({identifier:e}),s=R1("storage");return s&&N4(n,...s),n}function N4(t,e,r,n={}){BM(t,e,r,n)}function UM(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Vy(r,n,s,e,ul)}function $M(){lo(new Ei(k4,UM,"PUBLIC").setMultipleInstances(!0)),js(h2,p2,""),js(h2,p2,"esm2017")}$M();const VM=Object.freeze(Object.defineProperty({__proto__:null,StorageError:Gr,get StorageErrorCode(){return Hr},StringFormat:$s,_FbsBlob:si,_Location:qn,_dataFromString:Ly,_invalidArgument:ph,_invalidRootOperation:y4,connectStorageEmulator:N4,deleteObject:kv,getStorage:F4,listAll:R4,ref:mh,uploadBytes:D4,uploadString:P4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HM="type.googleapis.com/google.protobuf.Int64Value",jM="type.googleapis.com/google.protobuf.UInt64Value";function O4(t,e){const r={};for(const n in t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r}function Dv(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Dv(e));if(typeof t=="function"||typeof t=="object")return O4(t,e=>Dv(e));throw new Error("Data cannot be encoded in JSON: "+t)}function gh(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case HM:case jM:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>gh(e)):typeof t=="function"||typeof t=="object"?O4(t,e=>gh(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hy="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class lc extends xa{constructor(e,r,n){super(`${Hy}/${e}`,r||""),this.details=n}}function GM(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function WM(t,e){let r=GM(t),n=r,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!m2[a])return new lc("internal","internal");r=m2[a],n=a}const o=i.message;typeof o=="string"&&(n=o),s=i.details,s!==void 0&&(s=gh(s))}}catch{}return r==="ok"?null:new lc(r,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zM{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv="us-central1";function KM(t){let e=null;return{promise:new Promise((r,n)=>{e=setTimeout(()=>{n(new lc("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class qM{constructor(e,r,n,s,i=Pv,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new zM(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(i);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Pv}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function XM(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}function YM(t,e,r){return n=>JM(t,e,n,r||{})}async function QM(t,e,r,n){r["Content-Type"]="application/json";let s;try{s=await n(t,{method:"POST",body:JSON.stringify(e),headers:r})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function JM(t,e,r,n){const s=t._url(e);return ZM(t,s,r,n)}async function ZM(t,e,r,n){r=Dv(r);const s={data:r},i={},a=await t.contextProvider.getContext(n.limitedUseAppCheckTokens);a.authToken&&(i.Authorization="Bearer "+a.authToken),a.messagingToken&&(i["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=a.appCheckToken);const o=n.timeout||7e4,l=KM(o),c=await Promise.race([QM(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new lc("cancelled","Firebase Functions instance was deleted.");const u=WM(c.status,c.json);if(u)throw u;if(!c.json)throw new lc("internal","Response is not valid JSON object.");let f=c.json.data;if(typeof f>"u"&&(f=c.json.result),typeof f>"u")throw new lc("internal","Response is missing data field.");return{data:gh(f)}}const g2="@firebase/functions",v2="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eL="auth-internal",tL="app-check-internal",rL="messaging-internal";function nL(t,e){const r=(n,{instanceIdentifier:s})=>{const i=n.getProvider("app").getImmediate(),a=n.getProvider(eL),o=n.getProvider(rL),l=n.getProvider(tL);return new qM(i,a,o,l,s,t)};lo(new Ei(Hy,r,"PUBLIC").setMultipleInstances(!0)),js(g2,v2,e),js(g2,v2,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(t=jd(),e=Pv){const n=Hd(dr(t),Hy).getImmediate({identifier:e}),s=R1("functions");return s&&M4(n,...s),n}function M4(t,e,r){XM(dr(t),e,r)}function Da(t,e,r){return YM(dr(t),e,r)}nL(fetch.bind(self));const A0=Object.freeze(Object.defineProperty({__proto__:null,connectFunctionsEmulator:M4,getFunctions:cc,httpsCallable:Da},Symbol.toStringTag,{value:"Module"})),L4={apiKey:"AIzaSyDx1jbQT-FzgzjASFqVA2kbAHWJ_TeUzdY",authDomain:"casemangervue.firebaseapp.com",projectId:"casemangervue",storageBucket:"casemangervue.firebasestorage.app",messagingSenderId:"756483333257",appId:"1:756483333257:web:694e2ad2415b7886563a58",measurementId:"G-YBRDQX9NFR"},Fp=sw(L4),St=Qo(Fp),qe=yo(Fp),wc=F4(Fp),B4=cc(Fp),U4=new aa;console.log(" Connected to Firebase project:",L4.projectId);const $4=Object.freeze(Object.defineProperty({__proto__:null,auth:St,db:qe,functions:B4,googleProvider:U4,storage:wc},Symbol.toStringTag,{value:"Module"}));/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Hl=typeof document<"u";function V4(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function sL(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&V4(t.default)}const hr=Object.assign;function bm(t,e){const r={};for(const n in e){const s=e[n];r[n]=ya(s)?s.map(t):t(s)}return r}const ju=()=>{},ya=Array.isArray,H4=/#/g,aL=/&/g,iL=/\//g,oL=/=/g,lL=/\?/g,j4=/\+/g,cL=/%5B/g,uL=/%5D/g,G4=/%5E/g,dL=/%60/g,W4=/%7B/g,fL=/%7C/g,z4=/%7D/g,hL=/%20/g;function jy(t){return encodeURI(""+t).replace(fL,"|").replace(cL,"[").replace(uL,"]")}function pL(t){return jy(t).replace(W4,"{").replace(z4,"}").replace(G4,"^")}function Rv(t){return jy(t).replace(j4,"%2B").replace(hL,"+").replace(H4,"%23").replace(aL,"%26").replace(dL,"`").replace(W4,"{").replace(z4,"}").replace(G4,"^")}function mL(t){return Rv(t).replace(oL,"%3D")}function gL(t){return jy(t).replace(H4,"%23").replace(lL,"%3F")}function vL(t){return t==null?"":gL(t).replace(iL,"%2F")}function bd(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const yL=/\/$/,xL=t=>t.replace(yL,"");function Sm(t,e,r="/"){let n,s={},i="",a="";const o=e.indexOf("#");let l=e.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(n=e.slice(0,l),i=e.slice(l+1,o>-1?o:e.length),s=t(i)),o>-1&&(n=n||e.slice(0,o),a=e.slice(o,e.length)),n=SL(n??e,r),{fullPath:n+(i&&"?")+i+a,path:n,query:s,hash:bd(a)}}function EL(t,e){const r=e.query?t(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function y2(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function _L(t,e,r){const n=e.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&Cc(e.matched[n],r.matched[s])&&K4(e.params,r.params)&&t(e.query)===t(r.query)&&e.hash===r.hash}function Cc(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function K4(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!bL(t[r],e[r]))return!1;return!0}function bL(t,e){return ya(t)?x2(t,e):ya(e)?x2(e,t):t===e}function x2(t,e){return ya(e)?t.length===e.length&&t.every((r,n)=>r===e[n]):t.length===1&&t[0]===e}function SL(t,e){if(t.startsWith("/"))return t;if(!t)return e;const r=e.split("/"),n=t.split("/"),s=n[n.length-1];(s===".."||s===".")&&n.push("");let i=r.length-1,a,o;for(a=0;a<n.length;a++)if(o=n[a],o!==".")if(o==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a).join("/")}const Li={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var Sd;(function(t){t.pop="pop",t.push="push"})(Sd||(Sd={}));var Gu;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Gu||(Gu={}));function AL(t){if(!t)if(Hl){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),xL(t)}const TL=/^[^#]+#/;function wL(t,e){return t.replace(TL,"#")+e}function CL(t,e){const r=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-r.left-(e.left||0),top:n.top-r.top-(e.top||0)}}const Np=()=>({left:window.scrollX,top:window.scrollY});function IL(t){let e;if("el"in t){const r=t.el,n=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;e=CL(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function E2(t,e){return(history.state?history.state.position-e:-1)+t}const Fv=new Map;function kL(t,e){Fv.set(t,e)}function DL(t){const e=Fv.get(t);return Fv.delete(t),e}let PL=()=>location.protocol+"//"+location.host;function q4(t,e){const{pathname:r,search:n,hash:s}=e,i=t.indexOf("#");if(i>-1){let o=s.includes(t.slice(i))?t.slice(i).length:1,l=s.slice(o);return l[0]!=="/"&&(l="/"+l),y2(l,"")}return y2(r,t)+n+s}function RL(t,e,r,n){let s=[],i=[],a=null;const o=({state:h})=>{const p=q4(t,location),v=r.value,g=e.value;let y=0;if(h){if(r.value=p,e.value=h,a&&a===v){a=null;return}y=g?h.position-g.position:0}else n(p);s.forEach(b=>{b(r.value,v,{delta:y,type:Sd.pop,direction:y?y>0?Gu.forward:Gu.back:Gu.unknown})})};function l(){a=r.value}function c(h){s.push(h);const p=()=>{const v=s.indexOf(h);v>-1&&s.splice(v,1)};return i.push(p),p}function u(){const{history:h}=window;h.state&&h.replaceState(hr({},h.state,{scroll:Np()}),"")}function f(){for(const h of i)h();i=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function _2(t,e,r,n=!1,s=!1){return{back:t,current:e,forward:r,replaced:n,position:window.history.length,scroll:s?Np():null}}function FL(t){const{history:e,location:r}=window,n={value:q4(t,r)},s={value:e.state};s.value||i(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const f=t.indexOf("#"),h=f>-1?(r.host&&document.querySelector("base")?t:t.slice(f))+l:PL()+t+l;try{e[u?"replaceState":"pushState"](c,"",h),s.value=c}catch(p){console.error(p),r[u?"replace":"assign"](h)}}function a(l,c){const u=hr({},e.state,_2(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,u,!0),n.value=l}function o(l,c){const u=hr({},s.value,e.state,{forward:l,scroll:Np()});i(u.current,u,!0);const f=hr({},_2(n.value,l,null),{position:u.position+1},c);i(l,f,!1),n.value=l}return{location:n,state:s,push:o,replace:a}}function NL(t){t=AL(t);const e=FL(t),r=RL(t,e.state,e.location,e.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const s=hr({location:"",base:t,go:n,createHref:wL.bind(null,t)},e,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function OL(t){return typeof t=="string"||t&&typeof t=="object"}function X4(t){return typeof t=="string"||typeof t=="symbol"}const Y4=Symbol("");var b2;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(b2||(b2={}));function Ic(t,e){return hr(new Error,{type:t,[Y4]:!0},e)}function Xa(t,e){return t instanceof Error&&Y4 in t&&(e==null||!!(t.type&e))}const S2="[^/]+?",ML={sensitive:!1,strict:!1,start:!0,end:!0},LL=/[.+*?^${}()[\]/\\]/g;function BL(t,e){const r=hr({},ML,e),n=[];let s=r.start?"^":"";const i=[];for(const c of t){const u=c.length?[]:[90];r.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const h=c[f];let p=40+(r.sensitive?.25:0);if(h.type===0)f||(s+="/"),s+=h.value.replace(LL,"\\$&"),p+=40;else if(h.type===1){const{value:v,repeatable:g,optional:y,regexp:b}=h;i.push({name:v,repeatable:g,optional:y});const E=b||S2;if(E!==S2){p+=10;try{new RegExp(`(${E})`)}catch(I){throw new Error(`Invalid custom RegExp for param "${v}" (${E}): `+I.message)}}let x=g?`((?:${E})(?:/(?:${E}))*)`:`(${E})`;f||(x=y&&c.length<2?`(?:/${x})`:"/"+x),y&&(x+="?"),s+=x,p+=20,y&&(p+=-8),g&&(p+=-20),E===".*"&&(p+=-50)}u.push(p)}n.push(u)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function o(c){const u=c.match(a),f={};if(!u)return null;for(let h=1;h<u.length;h++){const p=u[h]||"",v=i[h-1];f[v.name]=p&&v.repeatable?p.split("/"):p}return f}function l(c){let u="",f=!1;for(const h of t){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const p of h)if(p.type===0)u+=p.value;else if(p.type===1){const{value:v,repeatable:g,optional:y}=p,b=v in c?c[v]:"";if(ya(b)&&!g)throw new Error(`Provided param "${v}" is an array but it is not repeatable (* or + modifiers)`);const E=ya(b)?b.join("/"):b;if(!E)if(y)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${v}"`);u+=E}}return u||"/"}return{re:a,score:n,keys:i,parse:o,stringify:l}}function UL(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=e[r]-t[r];if(n)return n;r++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function Q4(t,e){let r=0;const n=t.score,s=e.score;for(;r<n.length&&r<s.length;){const i=UL(n[r],s[r]);if(i)return i;r++}if(Math.abs(s.length-n.length)===1){if(A2(n))return 1;if(A2(s))return-1}return s.length-n.length}function A2(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const $L={type:0,value:""},VL=/[a-zA-Z0-9_]/;function HL(t){if(!t)return[[]];if(t==="/")return[[$L]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(p){throw new Error(`ERR (${r})/"${c}": ${p}`)}let r=0,n=r;const s=[];let i;function a(){i&&s.push(i),i=[]}let o=0,l,c="",u="";function f(){c&&(r===0?i.push({type:0,value:c}):r===1||r===2||r===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;o<t.length;){if(l=t[o++],l==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:l==="/"?(c&&f(),a()):l===":"?(f(),r=1):h();break;case 4:h(),r=n;break;case 1:l==="("?r=2:VL.test(l)?h():(f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:r=3:u+=l;break;case 3:f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),a(),s}function jL(t,e,r){const n=BL(HL(t.path),r),s=hr(n,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function GL(t,e){const r=[],n=new Map;e=I2({strict:!1,end:!0,sensitive:!1},e);function s(f){return n.get(f)}function i(f,h,p){const v=!p,g=w2(f);g.aliasOf=p&&p.record;const y=I2(e,f),b=[g];if("alias"in f){const I=typeof f.alias=="string"?[f.alias]:f.alias;for(const D of I)b.push(w2(hr({},g,{components:p?p.record.components:g.components,path:D,aliasOf:p?p.record:g})))}let E,x;for(const I of b){const{path:D}=I;if(h&&D[0]!=="/"){const P=h.record.path,w=P[P.length-1]==="/"?"":"/";I.path=h.record.path+(D&&w+D)}if(E=jL(I,h,y),p?p.alias.push(E):(x=x||E,x!==E&&x.alias.push(E),v&&f.name&&!C2(E)&&a(f.name)),J4(E)&&l(E),g.children){const P=g.children;for(let w=0;w<P.length;w++)i(P[w],E,p&&p.children[w])}p=p||E}return x?()=>{a(x)}:ju}function a(f){if(X4(f)){const h=n.get(f);h&&(n.delete(f),r.splice(r.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=r.indexOf(f);h>-1&&(r.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function o(){return r}function l(f){const h=KL(f,r);r.splice(h,0,f),f.record.name&&!C2(f)&&n.set(f.record.name,f)}function c(f,h){let p,v={},g,y;if("name"in f&&f.name){if(p=n.get(f.name),!p)throw Ic(1,{location:f});y=p.record.name,v=hr(T2(h.params,p.keys.filter(x=>!x.optional).concat(p.parent?p.parent.keys.filter(x=>x.optional):[]).map(x=>x.name)),f.params&&T2(f.params,p.keys.map(x=>x.name))),g=p.stringify(v)}else if(f.path!=null)g=f.path,p=r.find(x=>x.re.test(g)),p&&(v=p.parse(g),y=p.record.name);else{if(p=h.name?n.get(h.name):r.find(x=>x.re.test(h.path)),!p)throw Ic(1,{location:f,currentLocation:h});y=p.record.name,v=hr({},h.params,f.params),g=p.stringify(v)}const b=[];let E=p;for(;E;)b.unshift(E.record),E=E.parent;return{name:y,path:g,params:v,matched:b,meta:zL(b)}}t.forEach(f=>i(f));function u(){r.length=0,n.clear()}return{addRoute:i,resolve:c,removeRoute:a,clearRoutes:u,getRoutes:o,getRecordMatcher:s}}function T2(t,e){const r={};for(const n of e)n in t&&(r[n]=t[n]);return r}function w2(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:WL(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function WL(t){const e={},r=t.props||!1;if("component"in t)e.default=r;else for(const n in t.components)e[n]=typeof r=="object"?r[n]:r;return e}function C2(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function zL(t){return t.reduce((e,r)=>hr(e,r.meta),{})}function I2(t,e){const r={};for(const n in t)r[n]=n in e?e[n]:t[n];return r}function KL(t,e){let r=0,n=e.length;for(;r!==n;){const i=r+n>>1;Q4(t,e[i])<0?n=i:r=i+1}const s=qL(t);return s&&(n=e.lastIndexOf(s,n-1)),n}function qL(t){let e=t;for(;e=e.parent;)if(J4(e)&&Q4(t,e)===0)return e}function J4({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function XL(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(j4," "),a=i.indexOf("="),o=bd(a<0?i:i.slice(0,a)),l=a<0?null:bd(i.slice(a+1));if(o in e){let c=e[o];ya(c)||(c=e[o]=[c]),c.push(l)}else e[o]=l}return e}function k2(t){let e="";for(let r in t){const n=t[r];if(r=mL(r),n==null){n!==void 0&&(e+=(e.length?"&":"")+r);continue}(ya(n)?n.map(i=>i&&Rv(i)):[n&&Rv(n)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+r,i!=null&&(e+="="+i))})}return e}function YL(t){const e={};for(const r in t){const n=t[r];n!==void 0&&(e[r]=ya(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return e}const QL=Symbol(""),D2=Symbol(""),Op=Symbol(""),Gy=Symbol(""),Nv=Symbol("");function au(){let t=[];function e(n){return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}function r(){t=[]}return{add:e,list:()=>t.slice(),reset:r}}function zi(t,e,r,n,s,i=a=>a()){const a=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((o,l)=>{const c=h=>{h===!1?l(Ic(4,{from:r,to:e})):h instanceof Error?l(h):OL(h)?l(Ic(2,{from:e,to:h})):(a&&n.enterCallbacks[s]===a&&typeof h=="function"&&a.push(h),o())},u=i(()=>t.call(n&&n.instances[s],e,r,c));let f=Promise.resolve(u);t.length<3&&(f=f.then(c)),f.catch(h=>l(h))})}function Am(t,e,r,n,s=i=>i()){const i=[];for(const a of t)for(const o in a.components){let l=a.components[o];if(!(e!=="beforeRouteEnter"&&!a.instances[o]))if(V4(l)){const u=(l.__vccOpts||l)[e];u&&i.push(zi(u,r,n,a,o,s))}else{let c=l();i.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${o}" at "${a.path}"`);const f=sL(u)?u.default:u;a.mods[o]=u,a.components[o]=f;const p=(f.__vccOpts||f)[e];return p&&zi(p,r,n,a,o,s)()}))}}return i}function P2(t){const e=Ds(Op),r=Ds(Gy),n=be(()=>{const l=X(t.to);return e.resolve(l)}),s=be(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],f=r.matched;if(!u||!f.length)return-1;const h=f.findIndex(Cc.bind(null,u));if(h>-1)return h;const p=R2(l[c-2]);return c>1&&R2(u)===p&&f[f.length-1].path!==p?f.findIndex(Cc.bind(null,l[c-2])):h}),i=be(()=>s.value>-1&&rB(r.params,n.value.params)),a=be(()=>s.value>-1&&s.value===r.matched.length-1&&K4(r.params,n.value.params));function o(l={}){if(tB(l)){const c=e[X(t.replace)?"replace":"push"](X(t.to)).catch(ju);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:be(()=>n.value.href),isActive:i,isExactActive:a,navigate:o}}function JL(t){return t.length===1?t[0]:t}const ZL=Md({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:P2,setup(t,{slots:e}){const r=Rs(P2(t)),{options:n}=Ds(Op),s=be(()=>({[F2(t.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[F2(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=e.default&&JL(e.default(r));return t.custom?i:Yo("a",{"aria-current":r.isExactActive?t.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},i)}}}),eB=ZL;function tB(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function rB(t,e){for(const r in e){const n=e[r],s=t[r];if(typeof n=="string"){if(n!==s)return!1}else if(!ya(s)||s.length!==n.length||n.some((i,a)=>i!==s[a]))return!1}return!0}function R2(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const F2=(t,e,r)=>t??e??r,nB=Md({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:r}){const n=Ds(Nv),s=be(()=>t.route||n.value),i=Ds(D2,0),a=be(()=>{let c=X(i);const{matched:u}=s.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),o=be(()=>s.value.matched[a.value]);Fu(D2,be(()=>a.value+1)),Fu(QL,o),Fu(Nv,s);const l=se();return Vt(()=>[l.value,o.value,t.name],([c,u,f],[h,p,v])=>{u&&(u.instances[f]=c,p&&p!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!Cc(u,p)||!h)&&(u.enterCallbacks[f]||[]).forEach(g=>g(c))},{flush:"post"}),()=>{const c=s.value,u=t.name,f=o.value,h=f&&f.components[u];if(!h)return N2(r.default,{Component:h,route:c});const p=f.props[u],v=p?p===!0?c.params:typeof p=="function"?p(c):p:null,y=Yo(h,hr({},v,e,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return N2(r.default,{Component:y,route:c})||y}}});function N2(t,e){if(!t)return null;const r=t(e);return r.length===1?r[0]:r}const sB=nB;function aB(t){const e=GL(t.routes,t),r=t.parseQuery||XL,n=t.stringifyQuery||k2,s=t.history,i=au(),a=au(),o=au(),l=g1(Li);let c=Li;Hl&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=bm.bind(null,le=>""+le),f=bm.bind(null,vL),h=bm.bind(null,bd);function p(le,fe){let te,Z;return X4(le)?(te=e.getRecordMatcher(le),Z=fe):Z=le,e.addRoute(Z,te)}function v(le){const fe=e.getRecordMatcher(le);fe&&e.removeRoute(fe)}function g(){return e.getRoutes().map(le=>le.record)}function y(le){return!!e.getRecordMatcher(le)}function b(le,fe){if(fe=hr({},fe||l.value),typeof le=="string"){const J=Sm(r,le,fe.path),pe=e.resolve({path:J.path},fe),ge=s.createHref(J.fullPath);return hr(J,pe,{params:h(pe.params),hash:bd(J.hash),redirectedFrom:void 0,href:ge})}let te;if(le.path!=null)te=hr({},le,{path:Sm(r,le.path,fe.path).path});else{const J=hr({},le.params);for(const pe in J)J[pe]==null&&delete J[pe];te=hr({},le,{params:f(J)}),fe.params=f(fe.params)}const Z=e.resolve(te,fe),xe=le.hash||"";Z.params=u(h(Z.params));const Q=EL(n,hr({},le,{hash:pL(xe),path:Z.path})),q=s.createHref(Q);return hr({fullPath:Q,hash:xe,query:n===k2?YL(le.query):le.query||{}},Z,{redirectedFrom:void 0,href:q})}function E(le){return typeof le=="string"?Sm(r,le,l.value.path):hr({},le)}function x(le,fe){if(c!==le)return Ic(8,{from:fe,to:le})}function I(le){return w(le)}function D(le){return I(hr(E(le),{replace:!0}))}function P(le){const fe=le.matched[le.matched.length-1];if(fe&&fe.redirect){const{redirect:te}=fe;let Z=typeof te=="function"?te(le):te;return typeof Z=="string"&&(Z=Z.includes("?")||Z.includes("#")?Z=E(Z):{path:Z},Z.params={}),hr({query:le.query,hash:le.hash,params:Z.path!=null?{}:le.params},Z)}}function w(le,fe){const te=c=b(le),Z=l.value,xe=le.state,Q=le.force,q=le.replace===!0,J=P(te);if(J)return w(hr(E(J),{state:typeof J=="object"?hr({},xe,J.state):xe,force:Q,replace:q}),fe||te);const pe=te;pe.redirectedFrom=fe;let ge;return!Q&&_L(n,Z,te)&&(ge=Ic(16,{to:pe,from:Z}),G(Z,Z,!0,!1)),(ge?Promise.resolve(ge):T(pe,Z)).catch(ee=>Xa(ee)?Xa(ee,2)?ee:z(ee):N(ee,pe,Z)).then(ee=>{if(ee){if(Xa(ee,2))return w(hr({replace:q},E(ee.to),{state:typeof ee.to=="object"?hr({},xe,ee.to.state):xe,force:Q}),fe||pe)}else ee=A(pe,Z,!0,q,xe);return _(pe,Z,ee),ee})}function S(le,fe){const te=x(le,fe);return te?Promise.reject(te):Promise.resolve()}function m(le){const fe=K.values().next().value;return fe&&typeof fe.runWithContext=="function"?fe.runWithContext(le):le()}function T(le,fe){let te;const[Z,xe,Q]=iB(le,fe);te=Am(Z.reverse(),"beforeRouteLeave",le,fe);for(const J of Z)J.leaveGuards.forEach(pe=>{te.push(zi(pe,le,fe))});const q=S.bind(null,le,fe);return te.push(q),he(te).then(()=>{te=[];for(const J of i.list())te.push(zi(J,le,fe));return te.push(q),he(te)}).then(()=>{te=Am(xe,"beforeRouteUpdate",le,fe);for(const J of xe)J.updateGuards.forEach(pe=>{te.push(zi(pe,le,fe))});return te.push(q),he(te)}).then(()=>{te=[];for(const J of Q)if(J.beforeEnter)if(ya(J.beforeEnter))for(const pe of J.beforeEnter)te.push(zi(pe,le,fe));else te.push(zi(J.beforeEnter,le,fe));return te.push(q),he(te)}).then(()=>(le.matched.forEach(J=>J.enterCallbacks={}),te=Am(Q,"beforeRouteEnter",le,fe,m),te.push(q),he(te))).then(()=>{te=[];for(const J of a.list())te.push(zi(J,le,fe));return te.push(q),he(te)}).catch(J=>Xa(J,8)?J:Promise.reject(J))}function _(le,fe,te){o.list().forEach(Z=>m(()=>Z(le,fe,te)))}function A(le,fe,te,Z,xe){const Q=x(le,fe);if(Q)return Q;const q=fe===Li,J=Hl?history.state:{};te&&(Z||q?s.replace(le.fullPath,hr({scroll:q&&J&&J.scroll},xe)):s.push(le.fullPath,xe)),l.value=le,G(le,fe,te,q),z()}let k;function U(){k||(k=s.listen((le,fe,te)=>{if(!ne.listening)return;const Z=b(le),xe=P(Z);if(xe){w(hr(xe,{replace:!0,force:!0}),Z).catch(ju);return}c=Z;const Q=l.value;Hl&&kL(E2(Q.fullPath,te.delta),Np()),T(Z,Q).catch(q=>Xa(q,12)?q:Xa(q,2)?(w(hr(E(q.to),{force:!0}),Z).then(J=>{Xa(J,20)&&!te.delta&&te.type===Sd.pop&&s.go(-1,!1)}).catch(ju),Promise.reject()):(te.delta&&s.go(-te.delta,!1),N(q,Z,Q))).then(q=>{q=q||A(Z,Q,!1),q&&(te.delta&&!Xa(q,8)?s.go(-te.delta,!1):te.type===Sd.pop&&Xa(q,20)&&s.go(-1,!1)),_(Z,Q,q)}).catch(ju)}))}let L=au(),R=au(),F;function N(le,fe,te){z(le);const Z=R.list();return Z.length?Z.forEach(xe=>xe(le,fe,te)):console.error(le),Promise.reject(le)}function M(){return F&&l.value!==Li?Promise.resolve():new Promise((le,fe)=>{L.add([le,fe])})}function z(le){return F||(F=!le,U(),L.list().forEach(([fe,te])=>le?te(le):fe()),L.reset()),le}function G(le,fe,te,Z){const{scrollBehavior:xe}=t;if(!Hl||!xe)return Promise.resolve();const Q=!te&&DL(E2(le.fullPath,0))||(Z||!te)&&history.state&&history.state.scroll||null;return cl().then(()=>xe(le,fe,Q)).then(q=>q&&IL(q)).catch(q=>N(q,le,fe))}const H=le=>s.go(le);let j;const K=new Set,ne={currentRoute:l,listening:!0,addRoute:p,removeRoute:v,clearRoutes:e.clearRoutes,hasRoute:y,getRoutes:g,resolve:b,options:t,push:I,replace:D,go:H,back:()=>H(-1),forward:()=>H(1),beforeEach:i.add,beforeResolve:a.add,afterEach:o.add,onError:R.add,isReady:M,install(le){const fe=this;le.component("RouterLink",eB),le.component("RouterView",sB),le.config.globalProperties.$router=fe,Object.defineProperty(le.config.globalProperties,"$route",{enumerable:!0,get:()=>X(l)}),Hl&&!j&&l.value===Li&&(j=!0,I(s.location).catch(xe=>{}));const te={};for(const xe in Li)Object.defineProperty(te,xe,{get:()=>l.value[xe],enumerable:!0});le.provide(Op,fe),le.provide(Gy,p1(te)),le.provide(Nv,l);const Z=le.unmount;K.add(le),le.unmount=function(){K.delete(le),K.size<1&&(c=Li,k&&k(),k=null,l.value=Li,j=!1,F=!1),Z()}}};function he(le){return le.reduce((fe,te)=>fe.then(()=>m(te)),Promise.resolve())}return ne}function iB(t,e){const r=[],n=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let a=0;a<i;a++){const o=e.matched[a];o&&(t.matched.find(c=>Cc(c,o))?n.push(o):r.push(o));const l=t.matched[a];l&&(e.matched.find(c=>Cc(c,l))||s.push(l))}return[r,n,s]}function Ci(){return Ds(Op)}function oB(t){return Ds(Gy)}class lB{constructor(){this.enabled=!0}async logStudentAccess(e,r,n={}){if(!(!this.enabled||!St.currentUser))try{const s=Ze(_t(qe,"auditLogs"));await Ht(s,{type:"student_access",studentId:e,userId:St.currentUser.uid,userEmail:St.currentUser.email,action:r,details:n,timestamp:wn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}async logUserManagement(e,r,n={}){if(!(!this.enabled||!St.currentUser))try{const s=Ze(_t(qe,"auditLogs"));await Ht(s,{type:"user_management",targetUserId:e,performedBy:St.currentUser.uid,performedByEmail:St.currentUser.email,action:r,details:n,timestamp:wn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}async logSystemAccess(e,r={}){var n,s;if(this.enabled)try{const i=Ze(_t(qe,"auditLogs"));await Ht(i,{type:"system_access",userId:((n=St.currentUser)==null?void 0:n.uid)||"unknown",userEmail:((s=St.currentUser)==null?void 0:s.email)||"unknown",action:e,details:r,timestamp:wn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(i){console.error("Audit logging failed:",i)}}async logDataExport(e,r,n={}){if(!(!this.enabled||!St.currentUser))try{const s=Ze(_t(qe,"auditLogs"));await Ht(s,{type:"data_export",exportType:e,studentIds:Array.isArray(r)?r:[r],studentCount:Array.isArray(r)?r.length:1,userId:St.currentUser.uid,userEmail:St.currentUser.email,details:n,timestamp:wn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}getSessionId(){return sessionStorage.getItem("sessionId")||sessionStorage.setItem("sessionId",`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),sessionStorage.getItem("sessionId")}async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return"unknown"}}async generateAccessReport(e,r){try{const n=new Date(r.start),s=new Date(r.end);return{studentId:e,accessCount:0,uniqueUsers:[],actions:[],timeRange:r}}catch(n){return console.error("Report generation failed:",n),null}}}const tn=new lB,Fs=qT("auth",()=>{const t=se(null),e=se(""),r=se(!0),n=Ci(),s=()=>{ip(St,async u=>{if(r.value=!0,u)try{const f=await nr(Ze(qe,"users",u.uid));f.exists()?(t.value={uid:u.uid,email:u.email,name:u.displayName,...f.data()},console.log(" User authenticated:",t.value)):(console.log(" User not found in Firestore"),t.value=null)}catch(f){console.error(" Error fetching user data:",f),t.value=null}else t.value=null,console.log(" No user authenticated");r.value=!1})},i=async()=>{e.value="";try{const u=new aa,h=(await q1(St,u)).user,p=await nr(Ze(qe,"users",h.uid));if(!p.exists()){e.value=" User not found in system.";return}t.value={uid:h.uid,email:h.email,name:h.displayName,...p.data()},n.push("/")}catch(u){console.error(" Login error:",u),e.value=u.message||"Authentication failed."}},a=async()=>{try{t.value&&await tn.logSystemAccess("logout",{userRole:t.value.role,success:!0}),await op(St),t.value=null,n.push("/login")}catch(u){console.error(" Logout error:",u),await tn.logSystemAccess("logout_error",{error:u.message,success:!1})}},o=u=>{t.value=u},l=async()=>{if(St.currentUser)try{return await pw(St.currentUser,!0),console.log(" Token refreshed successfully"),!0}catch(u){return console.error(" Error refreshing token:",u),!1}return!1},c=be(()=>t.value);return s(),{currentUser:t,user:c,errorMsg:e,isLoading:r,loginWithGoogle:i,logout:a,setUser:o,refreshToken:l}}),cB=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:Fs},Symbol.toStringTag,{value:"Module"})),uc=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"],uB=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"],iu=["admin","school_admin","admin_504","sped_chair"],at={VIEW_USERS:"view_users",EDIT_USER:"edit_user",DELETE_USER:"delete_user",VIEW_STUDENTS:"view_students",EDIT_STUDENT_CM:"edit_student_CM",EDIT_STUDENT_ALL:"edit_student_All",ACCESS_ADMIN_PANEL:"access_admin_panel",MANAGE_AIDES:"manage_aides",MANAGE_SYSTEM_SETTINGS:"manage_system_settings",MANAGE_TEACHER_FEEDBACK:"manage_teacher_feedback",MANAGE_IMPORTS:"manage_imports",MANAGE_BACKUPS:"manage_backups"},Z4={admin:[at.VIEW_USERS,at.EDIT_USER,at.DELETE_USER,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL,at.ACCESS_ADMIN_PANEL,at.MANAGE_AIDES,at.MANAGE_SYSTEM_SETTINGS,at.MANAGE_TEACHER_FEEDBACK,at.MANAGE_IMPORTS,at.MANAGE_BACKUPS],school_admin:[at.VIEW_USERS,at.EDIT_USER,at.DELETE_USER,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL,at.ACCESS_ADMIN_PANEL,at.MANAGE_AIDES,at.MANAGE_TEACHER_FEEDBACK,at.MANAGE_IMPORTS,at.MANAGE_BACKUPS],staff_view:[at.VIEW_USERS,at.VIEW_STUDENTS],staff_edit:[at.VIEW_USERS,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL],admin_504:[at.VIEW_USERS,at.EDIT_USER,at.DELETE_USER,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL,at.ACCESS_ADMIN_PANEL,at.MANAGE_AIDES,at.MANAGE_TEACHER_FEEDBACK],sped_chair:[at.VIEW_USERS,at.EDIT_USER,at.DELETE_USER,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL,at.ACCESS_ADMIN_PANEL,at.MANAGE_AIDES,at.MANAGE_TEACHER_FEEDBACK],case_manager:[at.VIEW_USERS,at.VIEW_STUDENTS,at.EDIT_STUDENT_CM,at.MANAGE_TEACHER_FEEDBACK],teacher:[at.VIEW_USERS,at.VIEW_STUDENTS],service_provider:[at.VIEW_USERS,at.VIEW_STUDENTS,at.EDIT_STUDENT_CM],paraeducator:[at.VIEW_USERS,at.VIEW_STUDENTS]};function O2(t){return uc.includes(t)}const dB={admin:"System Administrator - Full access to all features and settings",school_admin:"School Administrator - Manage students, aides, and users (no system settings)",staff_view:"Staff Viewer - IEP access for counselors, nurses, intervention specialists",staff_edit:"Staff Editor - Edit all students, no admin panel access",admin_504:"504 Plan Coordinator - Manage 504 plans, students, and aides",sped_chair:"Special Education Chair - Manage special education programs",case_manager:"Case Manager - Manage assigned student caseload only",teacher:"Teacher - View students in assigned classes",service_provider:"Service Provider - Manage students receiving services",paraeducator:"Paraeducator - View assigned students only"},Wy=qT("permission",()=>{const t=Fs(),e=se([]),r=se({}),n=se({}),s=se(!1),i=async()=>{n.value=Z4,s.value=!0,console.log("Using static permissions matrix:",n.value),e.value.length>0&&(r.value=a(e.value))};function a(c){const u={};return console.log("Deriving permissions for roles:",c),console.log("Current permissions matrix:",n.value),console.log("Matrix loaded:",s.value),c.forEach(f=>{const h=n.value[f]||[];console.log(`Role ${f} has permissions:`,h),h.forEach(p=>u[p]=!0)}),console.log("Final derived permissions:",u),u}let o=null;return Vt(()=>{var c;return(c=t.currentUser)==null?void 0:c.uid},()=>{var c;if(o&&o(),(c=t.currentUser)!=null&&c.uid){const u=Ze(qe,"users",t.currentUser.uid);o=nf(u,f=>{const h=f.data()||{};e.value=h.role?[h.role]:[],console.log("User roles updated:",e.value),t.currentUser&&(t.currentUser.value={...t.currentUser.value,...h},console.log(" Updated auth store user data:",t.currentUser.value)),s.value&&(r.value=a(e.value))})}else e.value=[],r.value={}},{immediate:!0}),i(),{userRoles:e,userPermissions:r,permissionsMatrix:n,matrixLoaded:s,hasRole:c=>e.value.includes(c),can:c=>r.value[c]===!0,loadPermissionsMatrix:i}});function fB(){const t=Wy(),e=be(()=>t.hasRole("admin")),r=be(()=>t.can("manage_users")),n=s=>t.can(s);return{isAdmin:e,canManageUsers:r,hasRole:t.hasRole,can:t.can,hasPermission:n}}const xt=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r},hB={name:"UserRoleSwitcher",setup(){const t=Fs();fB();const e=se(!1),r=se(""),n=se({}),s=se(!1),i=be(()=>t.user),a=[{value:"admin",label:"Admin"},{value:"school_admin",label:"School Admin"},{value:"admin_504",label:"504 Coordinator"},{value:"sped_chair",label:"SPED Chair"},{value:"staff_view",label:"Staff (View)"},{value:"staff_edit",label:"Staff (Edit)"},{value:"case_manager",label:"Case Manager"},{value:"teacher",label:"Teacher"},{value:"service_provider",label:"Service Provider"},{value:"paraeducator",label:"Paraeducator"}],o=[{uid:"test-admin",name:"Test Admin",email:"admin@test.com",role:"admin"},{uid:"test-school-admin",name:"Test School Admin",email:"schooladmin@test.com",role:"school_admin"},{uid:"test-admin-504",name:"Test 504 Coordinator",email:"admin504@test.com",role:"admin_504"},{uid:"test-sped-chair",name:"Test SPED Chair",email:"spedchair@test.com",role:"sped_chair"},{uid:"test-case-manager",name:"Test Case Manager",email:"cm@test.com",role:"case_manager"},{uid:"test-paraeducator",name:"Test Paraeducator",email:"para@test.com",role:"paraeducator"},{uid:"test-teacher",name:"Test Teacher",email:"teacher@test.com",role:"teacher"},{uid:"test-service-provider",name:"Test Service Provider",email:"service@test.com",role:"service_provider"}],l=async()=>{s.value=!0;try{const b=Ze(qe,"config","permissions_matrix"),E=await nr(b);E.exists()?n.value=E.data():(console.warn("Permissions matrix not found in database"),n.value={})}catch(b){console.error("Error loading permissions matrix:",b),n.value={}}finally{s.value=!1}},c=be(()=>{var I;const b=[{action:at.VIEW_USERS,label:"View Users"},{action:at.EDIT_USER,label:"Edit User"},{action:at.DELETE_USER,label:"Delete User"},{action:at.MANAGE_SUBJECTS,label:"Manage Subjects"},{action:at.MANAGE_ROLES,label:"Manage Roles"},{action:at.VIEW_STUDENTS,label:"View Students"},{action:at.EDIT_STUDENT_CM,label:"Edit Students (Own Caseload)"},{action:at.EDIT_STUDENT_ALL,label:"Edit All Students"},{action:at.TESTING,label:"Testing"}],E=(I=i.value)==null?void 0:I.role,x=n.value[E]||[];return b.map(D=>({...D,granted:x.includes(D.action)}))}),u=()=>{e.value=!e.value},f=()=>{if(!r.value)return;const b={uid:`test-${r.value}-${Date.now()}`,email:`${r.value}@test.com`,name:`Test ${r.value.charAt(0).toUpperCase()+r.value.slice(1)}`,role:r.value,lastSyncTrigger:new Date().toISOString()};t.setUser(b),localStorage.setItem("debug-user",JSON.stringify(b)),r.value=""},h=b=>{t.setUser(b),localStorage.setItem("debug-user",JSON.stringify(b))},p=()=>{localStorage.removeItem("debug-user"),window.location.reload()},v=()=>{window.location.reload()};return jt(async()=>{await l();const b=localStorage.getItem("debug-user");if(b)try{const E=JSON.parse(b);t.setUser(E)}catch(E){console.error("Error parsing debug user:",E),localStorage.removeItem("debug-user")}return()=>{}}),{canSwitchRoles:be(()=>{var E;const b=(E=i.value)==null?void 0:E.role;return["admin","administrator"].includes(b)}),hideRoleSwitcher:()=>{console.log("Role switcher hidden")},isExpanded:e,selectedRole:r,currentUser:i,availableRoles:a,testUsers:o,currentPermissions:c,loadingPermissions:s,toggleExpanded:u,switchRole:f,switchToUser:h,resetToRealUser:p,refreshPage:v}}},pB=["title"],mB={key:0,class:"debug-label"},gB={key:0,class:"switcher-content"},vB={class:"current-user-info"},yB={class:"role-selector"},xB=["value"],EB={class:"test-users"},_B={class:"test-user-buttons"},bB=["onClick"],SB={class:"permission-info"},AB={key:0,class:"loading-permissions"},TB={key:1,class:"permission-list"},wB={class:"permission-icon"},CB={class:"actions"};function IB(t,e,r,n,s,i){var a,o,l,c,u;return n.canSwitchRoles?(O(),B("div",{key:0,class:Qe(["user-role-switcher",{collapsed:!n.isExpanded}])},[d("div",{class:"switcher-header",onClick:e[1]||(e[1]=(...f)=>n.toggleExpanded&&n.toggleExpanded(...f)),title:n.isExpanded?"Collapse Debug Panel":"Expand Debug Panel"},[e[6]||(e[6]=d("span",{class:"debug-icon"},"",-1)),n.isExpanded?(O(),B("span",mB,"Debug Role Switcher")):_e("",!0),e[7]||(e[7]=d("span",{class:"beta-label"},"BETA",-1)),d("button",{onClick:e[0]||(e[0]=dn((...f)=>n.hideRoleSwitcher&&n.hideRoleSwitcher(...f),["stop"])),class:"close-debug-btn",title:"Close Role Switcher"},"")],8,pB),n.isExpanded?(O(),B("div",gB,[e[18]||(e[18]=d("div",{class:"beta-warning"},[d("strong",null," BETA WARNING:"),Ce(" This debug tool is not working correctly and should be used with caution. It may not properly switch roles or could cause unexpected behavior. ")],-1)),d("div",vB,[e[8]||(e[8]=d("strong",null,"Current User:",-1)),Ce(" "+Y(((a=n.currentUser)==null?void 0:a.name)||((o=n.currentUser)==null?void 0:o.email)||"Unknown")+" ",1),e[9]||(e[9]=d("br",null,null,-1)),e[10]||(e[10]=d("strong",null,"Role:",-1)),e[11]||(e[11]=Ce()),d("span",{class:Qe("role-"+((l=n.currentUser)==null?void 0:l.role))},Y(((c=n.currentUser)==null?void 0:c.role)||"None"),3),e[12]||(e[12]=d("br",null,null,-1)),e[13]||(e[13]=d("strong",null,"UID:",-1)),Ce(" "+Y(((u=n.currentUser)==null?void 0:u.uid)||"None"),1)]),d("div",yB,[e[15]||(e[15]=d("label",{for:"role-select"},"Switch to Role:",-1)),Be(d("select",{id:"role-select","onUpdate:modelValue":e[2]||(e[2]=f=>n.selectedRole=f),onChange:e[3]||(e[3]=(...f)=>n.switchRole&&n.switchRole(...f))},[e[14]||(e[14]=d("option",{value:""},"-- Select Role --",-1)),(O(!0),B(Fe,null,He(n.availableRoles,f=>(O(),B("option",{key:f.value,value:f.value},Y(f.label),9,xB))),128))],544),[[cr,n.selectedRole]])]),d("div",EB,[e[16]||(e[16]=d("h5",null,"Quick Test Users:",-1)),d("div",_B,[(O(!0),B(Fe,null,He(n.testUsers,f=>{var h;return O(),B("button",{key:f.uid,onClick:p=>n.switchToUser(f),class:Qe(["test-user-btn",{active:((h=n.currentUser)==null?void 0:h.uid)===f.uid}])},[Ce(Y(f.name)+" ",1),d("small",null,"("+Y(f.role)+")",1)],10,bB)}),128))])]),d("div",SB,[e[17]||(e[17]=d("h5",null,"Current Permissions:",-1)),n.loadingPermissions?(O(),B("div",AB," Loading permissions... ")):(O(),B("div",TB,[(O(!0),B(Fe,null,He(n.currentPermissions,f=>(O(),B("div",{key:f.action,class:Qe(["permission-item",{granted:f.granted}])},[d("span",wB,Y(f.granted?"":""),1),Ce(" "+Y(f.label),1)],2))),128))]))]),e[19]||(e[19]=In('<div class="testing-scenarios" data-v-26d536da><h5 data-v-26d536da> Testing Scenarios:</h5><div class="scenario-list" data-v-26d536da><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Students Page:</strong><ul data-v-26d536da><li data-v-26d536da> Can view students</li><li data-v-26d536da> Can edit own caseload (CM)</li><li data-v-26d536da> Can edit all students (Admin)</li><li data-v-26d536da> Paraeducator filter works</li></ul></div><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Admin Panel:</strong><ul data-v-26d536da><li data-v-26d536da> Users management</li><li data-v-26d536da> Permissions matrix</li><li data-v-26d536da> Aide assignments</li><li data-v-26d536da> App settings</li></ul></div><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Navigation:</strong><ul data-v-26d536da><li data-v-26d536da> Admin button visibility</li><li data-v-26d536da> My Schedule button (Para)</li><li data-v-26d536da> Role-based menu items</li></ul></div></div></div>',1)),d("div",CB,[d("button",{onClick:e[4]||(e[4]=(...f)=>n.resetToRealUser&&n.resetToRealUser(...f)),class:"reset-btn"},"  Reset to Real User "),d("button",{onClick:e[5]||(e[5]=(...f)=>n.refreshPage&&n.refreshPage(...f)),class:"refresh-btn"},"  Refresh Page ")])])):_e("",!0)],2)):_e("",!0)}const kB=xt(hB,[["render",IB],["__scopeId","data-v-26d536da"]]),DB={key:0,class:"debug-access-info"},PB={__name:"DebugAccessInfo",setup(t){const e=Fs(),r=se(!1),n=be(()=>e.currentUser),s=be(()=>{var o;const a=(o=n.value)==null?void 0:o.role;return["admin","administrator"].includes(a)}),i=()=>{r.value=!1,localStorage.setItem("debug-info-hidden","true")};return jt(()=>{const a=localStorage.getItem("debug-info-hidden");s.value&&!a&&setTimeout(()=>{r.value=!0},3e3)}),(a,o)=>r.value?(O(),B("div",DB,[d("div",{class:"debug-info-content"},[o[0]||(o[0]=d("span",{class:"debug-info-icon"},"",-1)),o[1]||(o[1]=d("span",{class:"debug-info-text"},[Ce("Debug tools available - Press "),d("kbd",null,"Ctrl+Shift+D")],-1)),d("button",{onClick:i,class:"debug-info-close"},"")])])):_e("",!0)}},RB=xt(PB,[["__scopeId","data-v-358a31dd"]]);class FB{constructor(){this.timeoutId=null,this.warningTimeoutId=null,this.isEnabled=se(!1),this.timeoutMinutes=se(30),this.showWarning=se(!1),this.warningCountdown=se(0),this.lastActivity=Date.now(),this.router=null,this.unsubscribeSettings=null,this.activityEvents=["mousedown","mousemove","keypress","scroll","touchstart","click","keydown"],this.init()}init(){this.loadSettings(),this.setupActivityListeners(),this.setupAuthWatcher()}setupAuthWatcher(){ip(St,e=>{e?setTimeout(()=>{this.resetTimeout()},1e3):(this.clearTimeouts(),this.hideWarning())})}async loadSettings(){try{const e=Ze(qe,"app_settings","security");this.unsubscribeSettings=nf(e,r=>{if(r.exists()){const n=r.data(),s=this.isEnabled.value;this.isEnabled.value=n.sessionTimeoutEnabled||!1,this.timeoutMinutes.value=n.sessionTimeoutMinutes||30,St.currentUser&&this.resetTimeout()}else this.isEnabled.value=!1,this.timeoutMinutes.value=30})}catch(e){console.error("Failed to load session timeout settings:",e)}}async updateSettings(e,r){var n;try{const s=Ze(qe,"app_settings","security");await Ht(s,{sessionTimeoutEnabled:e,sessionTimeoutMinutes:r,updatedAt:new Date().toISOString(),updatedBy:(n=St.currentUser)==null?void 0:n.uid},{merge:!0})}catch(s){console.error("Failed to update session timeout settings:",s)}}setupActivityListeners(){this.boundActivityHandler=this.handleActivity.bind(this),this.activityEvents.forEach(e=>{document.addEventListener(e,this.boundActivityHandler,!0)})}handleActivity(){this.isEnabled.value&&(this.lastActivity=Date.now(),this.hideWarning(),this.resetTimeout())}resetTimeout(){if(!this.isEnabled.value||!St.currentUser)return;this.clearTimeouts();const e=Math.round(this.timeoutMinutes.value*60*1e3),r=Math.max(1e3,e-2*60*1e3);console.log(` Session timeout reset: ${this.timeoutMinutes.value} minutes (${e}ms), warning in ${r}ms`),e>1e4&&(this.warningTimeoutId=setTimeout(()=>{console.log(" Showing session warning"),this.showSessionWarning()},r)),this.timeoutId=setTimeout(()=>{console.log(" Session timeout triggered"),this.handleSessionTimeout()},e)}showSessionWarning(){if(this.showWarning.value)return;this.showWarning.value=!0,this.warningCountdown.value=Math.min(120,Math.floor(this.timeoutMinutes.value*60/2)),console.log(` Session warning displayed, countdown: ${this.warningCountdown.value} seconds`);const e=setInterval(()=>{this.warningCountdown.value--,this.warningCountdown.value<=0&&(clearInterval(e),this.handleSessionTimeout())},1e3);this.countdownInterval=e}hideWarning(){this.showWarning.value=!1,this.warningCountdown.value=0,this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null)}async handleSessionTimeout(){console.log(" Handling session timeout");try{if(St.currentUser){const e=Ze(qe,"auditLogs",`timeout_${Date.now()}_${St.currentUser.uid}`);await Ht(e,{type:"session_timeout",userId:St.currentUser.uid,userEmail:St.currentUser.email,timeoutMinutes:this.timeoutMinutes.value,lastActivity:new Date(this.lastActivity),timestamp:new Date,userAgent:navigator.userAgent})}this.clearTimeouts(),this.hideWarning(),await op(St),console.log(" User signed out due to session timeout"),this.router?this.router.push("/login"):window.location.href="/login"}catch(e){console.error("Error during session timeout:",e),window.location.href="/login"}}extendSession(){this.hideWarning(),this.resetTimeout()}clearTimeouts(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.warningTimeoutId&&(clearTimeout(this.warningTimeoutId),this.warningTimeoutId=null)}setRouter(e){this.router=e}destroy(){this.clearTimeouts(),this.hideWarning(),this.boundActivityHandler&&this.activityEvents.forEach(e=>{document.removeEventListener(e,this.boundActivityHandler,!0)}),this.unsubscribeSettings&&this.unsubscribeSettings()}}const Qs=new FB;function zy(){const t=Ci();return Qs.setRouter(t),{isEnabled:Qs.isEnabled,timeoutMinutes:Qs.timeoutMinutes,showWarning:Qs.showWarning,warningCountdown:Qs.warningCountdown,updateSettings:Qs.updateSettings.bind(Qs),extendSession:Qs.extendSession.bind(Qs),resetTimeout:Qs.resetTimeout.bind(Qs)}}/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),NB=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),OB=t=>{const e=NB(t);return e.charAt(0).toUpperCase()+e.slice(1)},MB=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Hf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=({size:t,strokeWidth:e=2,absoluteStrokeWidth:r,color:n,iconNode:s,name:i,class:a,...o},{slots:l})=>Yo("svg",{...Hf,width:t||Hf.width,height:t||Hf.height,stroke:n||Hf.stroke,"stroke-width":r?Number(e)*24/Number(t):e,class:MB("lucide",...i?[`lucide-${M2(OB(i))}-icon`,`lucide-${M2(i)}`]:["lucide-icon"]),...o},[...s.map(c=>Yo(...c)),...l.default?[l.default()]:[]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=(t,e)=>(r,{slots:n})=>Yo(LB,{...r,iconNode:e,name:t},n);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=bt("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UB=bt("arrow-down-wide-narrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jf=bt("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $B=bt("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VB=bt("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HB=bt("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=bt("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=bt("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=bt("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GB=bt("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=bt("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eI=bt("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WB=bt("columns-2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=bt("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zB=bt("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=bt("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KB=bt("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qB=bt("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XB=bt("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wm=bt("hand-heart",[["path",{d:"M11 14h2a2 2 0 0 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1v1a37"}],["path",{d:"m14.45 13.39 5.05-4.694C20.196 8 21 6.85 21 5.75a2.75 2.75 0 0 0-4.797-1.837.276.276 0 0 1-.406 0A2.75 2.75 0 0 0 11 5.75c0 1.2.802 2.248 1.5 2.946L16 11.95",key:"fhfbnt"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a1 1 0 0 0-2.75-2.91",key:"1x6kdw"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YB=bt("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QB=bt("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JB=bt("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZB=bt("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e7=bt("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t7=bt("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tI=bt("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r7=bt("monitor-speaker",[["path",{d:"M5.5 20H8",key:"1k40s5"}],["path",{d:"M17 9h.01",key:"1j24nn"}],["rect",{width:"10",height:"16",x:"12",y:"4",rx:"2",key:"ixliua"}],["path",{d:"M8 6H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h4",key:"1mp6e1"}],["circle",{cx:"17",cy:"15",r:"1",key:"tqvash"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n7=bt("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s7=bt("presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a7=bt("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=bt("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yh=bt("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i7=bt("school",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=bt("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o7=bt("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=bt("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l7=bt("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=bt("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c7=bt("test-tube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=bt("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u7=bt("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d7=bt("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T0=bt("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=bt("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=bt("user-pen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=bt("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f7=bt("user-search",[["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}],["path",{d:"M10.3 15H7a4 4 0 0 0-4 4v2",key:"3bnktk"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["path",{d:"m21 21-1.9-1.9",key:"1g2n9r"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=bt("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jl=bt("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h7=bt("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p7=bt("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),m7={key:0,class:"session-timeout-overlay"},g7={class:"session-timeout-dialog"},v7={class:"dialog-header"},y7={class:"dialog-content"},x7={class:"countdown-section"},E7={class:"countdown-time"},_7={class:"info-note"},b7={class:"dialog-actions"},S7={__name:"SessionTimeoutDialog",setup(t){const e=Ci(),{showWarning:r,warningCountdown:n,extendSession:s}=zy(),i=o=>{const l=Math.floor(o/60),c=o%60;return`${l}:${c.toString().padStart(2,"0")}`},a=async()=>{try{await op(St),e.push("/login")}catch(o){console.error("Error signing out:",o)}};return(o,l)=>X(r)?(O(),B("div",m7,[d("div",g7,[d("div",v7,[Le(X(eI),{class:"header-icon",size:24}),l[1]||(l[1]=d("h3",null,"Session Timeout",-1))]),d("div",y7,[d("div",x7,[d("div",E7,Y(i(X(n))),1),l[2]||(l[2]=d("p",{class:"countdown-label"},"until automatic logout",-1))]),d("div",_7,[Le(X(QB),{size:16}),l[3]||(l[3]=d("span",null,"Any activity will extend your session",-1))])]),d("div",b7,[d("button",{onClick:l[0]||(l[0]=(...c)=>X(s)&&X(s)(...c)),class:"btn btn-primary"},[Le(X(Lv),{size:16}),l[4]||(l[4]=Ce(" Stay Logged In "))]),d("button",{onClick:a,class:"btn btn-secondary"},[Le(X(e7),{size:16}),l[5]||(l[5]=Ce(" Logout Now "))])])])])):_e("",!0)}},A7=xt(S7,[["__scopeId","data-v-9d2333fd"]]),ou={primaryColor:"#1976d2",primaryHover:"#1565c0",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",secondaryColor:"#6c757d",secondaryHover:"#545b62",secondaryLight:"#f8f9fa",secondaryDark:"#495057",bgPrimary:"#f4f6f9",bgSecondary:"#ffffff",bgTertiary:"#f8f9fa",bgMuted:"#e9ecef",textPrimary:"#333333",textSecondary:"#666666",textMuted:"#999999",textInverse:"#ffffff",headerTextColor:"#1a1a1a",accentColor:"#e3f2fd",borderColor:"#dee2e6",borderLight:"#e9ecef",borderDark:"#adb5bd",borderFocus:"#1976d2",successColor:"#28a745",successHover:"#218838",successLight:"#d4edda",warningColor:"#ffc107",warningHover:"#e0a800",warningLight:"#fff3cd",errorColor:"#dc3545",errorHover:"#c82333",errorLight:"#f8d7da",infoColor:"#17a2b8",infoHover:"#138496",infoLight:"#d1ecf1",adminTabBg:"#f8f9fa",adminTabActive:"#2a79c9",adminTabHover:"#e3eaf6",tableHeaderBg:"#dfe7f3",tableStripeBg:"#f8fafd",tableBorder:"#d1d1d1",tableHover:"#f0f0f0",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",shadowSm:"0 1px 2px rgba(0, 0, 0, 0.05)",shadowMd:"0 2px 4px rgba(0, 0, 0, 0.1)",shadowLg:"0 4px 6px rgba(0, 0, 0, 0.1)",shadowXl:"0 4px 20px rgba(0, 0, 0, 0.3)",fontFamilyBase:"'Inter', 'Segoe UI', 'Arial', sans-serif",fontSizeXs:"0.75rem",fontSizeSm:"0.875rem",fontSizeBase:"1rem",fontSizeLg:"1.125rem",fontSizeXl:"1.25rem",fontSizeXxl:"1.5rem",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"standard",lineHeight:"1.5"},U2={primaryColor:"--primary-color",primaryHover:"--primary-hover",primaryLight:"--primary-light",primaryDark:"--primary-dark",secondaryColor:"--secondary-color",secondaryHover:"--secondary-hover",secondaryLight:"--secondary-light",secondaryDark:"--secondary-dark",bgPrimary:"--bg-primary",bgSecondary:"--bg-secondary",bgTertiary:"--bg-tertiary",bgMuted:"--bg-muted",textPrimary:"--text-primary",textSecondary:"--text-secondary",textMuted:"--text-muted",textInverse:"--text-inverse",headerTextColor:"--header-text-color",accentColor:"--accent-color",borderColor:"--border-color",borderLight:"--border-light",borderDark:"--border-dark",borderFocus:"--border-focus",successColor:"--success-color",successHover:"--success-hover",successLight:"--success-light",warningColor:"--warning-color",warningHover:"--warning-hover",warningLight:"--warning-light",errorColor:"--error-color",errorHover:"--error-hover",errorLight:"--error-light",infoColor:"--info-color",infoHover:"--info-hover",infoLight:"--info-light",adminTabBg:"--admin-tab-bg",adminTabActive:"--admin-tab-active",adminTabHover:"--admin-tab-hover",tableHeaderBg:"--table-header-bg",tableStripeBg:"--table-stripe-bg",tableBorder:"--table-border",tableHover:"--table-hover",borderRadiusSm:"--border-radius-sm",borderRadiusMd:"--border-radius-md",borderRadiusLg:"--border-radius-lg",borderRadiusXl:"--border-radius-xl",shadowSm:"--shadow-sm",shadowMd:"--shadow-md",shadowLg:"--shadow-lg",shadowXl:"--shadow-xl",fontFamilyBase:"--font-family-base",fontSizeXs:"--font-size-xs",fontSizeSm:"--font-size-sm",fontSizeBase:"--font-size-base",fontSizeLg:"--font-size-lg",fontSizeXl:"--font-size-xl",fontSizeXxl:"--font-size-xxl",lineHeight:"--line-height-base"};function iI(){const t=se({...ou}),e=se(!1),r=se(null),n=se(!1),s=async()=>{if(e.value)return t.value;e.value=!0,r.value=null;try{const v=Ze(qe,"app_settings","theme"),g=await nr(v);if(g.exists()){const y=g.data();t.value={...ou,...y},console.log("Theme loaded from database:",t.value)}else t.value={...ou},console.log("No saved theme found, using defaults");return n.value=!0,a(t.value),t.value}catch(v){throw r.value=v.message,console.error("Error loading theme:",v),v}finally{e.value=!1}},i=async(v=t.value)=>{e.value=!0,r.value=null;try{const g=Ze(qe,"app_settings","theme");return await Ht(g,{...v,lastUpdated:new Date().toISOString()}),t.value={...v},a(v),console.log("Theme saved successfully"),!0}catch(g){throw r.value=g.message,console.error("Error saving theme:",g),g}finally{e.value=!1}},a=v=>{const g=document.documentElement;Object.entries(U2).forEach(([y,b])=>{v[y]!==void 0&&g.style.setProperty(b,v[y])})},o=(v,g)=>{t.value[v]=g,a(t.value)},l=async()=>{t.value={...ou},a(t.value),await i(t.value)},c=v=>{a(v)},u=()=>{a(t.value)},f=v=>getComputedStyle(document.documentElement).getPropertyValue(v),h=v=>/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$|^rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d.]+\s*\)$/.test(v),p=v=>({light:v,dark:v,hover:v});return jt(()=>{n.value||s()}),{currentTheme:t,loading:e,error:r,isInitialized:n,loadTheme:s,saveTheme:i,applyTheme:a,updateThemeProperty:o,resetTheme:l,previewTheme:c,revertTheme:u,getCssVariableValue:f,validateColor:h,generateColorVariations:p,CSS_VARIABLE_MAP:U2,DEFAULT_THEME:ou}}function T7(){const{loadTheme:t,currentTheme:e,isInitialized:r}=iI();return jt(async()=>{if(!r.value)try{await t(),console.log("Theme initialized successfully")}catch(n){console.error("Failed to initialize theme:",n)}}),{currentTheme:e,isInitialized:r}}const w7={id:"app"},C7={id:"main-content"},I7={__name:"App",setup(t){const e=se(!1);T7();const r=n=>{n.ctrlKey&&n.shiftKey&&n.key==="D"&&(n.preventDefault(),e.value=!e.value,console.log("Debug Role Switcher:",e.value?"Shown":"Hidden"))};return jt(()=>{document.addEventListener("keydown",r)}),Va(()=>{document.removeEventListener("keydown",r)}),(n,s)=>{const i=fr("router-view");return O(),B("div",w7,[d("div",C7,[Le(i)]),e.value?(O(),tr(kB,{key:0})):_e("",!0),Le(RB),Le(A7)])}}},k7="modulepreload",D7=function(t){return"/"+t},$2={},la=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=D7(l),l in $2)return;$2[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":k7,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};function mn(t,e=255){return typeof t!="string"?"":t.trim().replace(/\0/g,"").replace(/[<>'"&]/g,"").substring(0,e)}function P7(t){return typeof t!="string"?"":t.trim().toLowerCase().substring(0,255)}function V2(t,e=0,r=999999){const n=parseFloat(t);return isNaN(n)?0:Math.max(e,Math.min(r,n))}function w0(t,e){return!t||typeof t=="string"&&t.trim()===""?{isValid:!1,error:`${e} is required`}:{isValid:!0}}function R7(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?{isValid:!0}:{isValid:!1,error:"Invalid email format"}}function Ad(t,e,r=0,n=255){return typeof t!="string"?{isValid:!1,error:`${e} must be a string`}:t.length<r?{isValid:!1,error:`${e} must be at least ${r} characters`}:t.length>n?{isValid:!1,error:`${e} must be no more than ${n} characters`}:{isValid:!0}}function F7(t){return["admin","school_admin","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"].includes(t)?{isValid:!0}:{isValid:!1,error:"Invalid role"}}function N7(t,e=[],r=10*1024*1024){return t?e.length>0&&!e.includes(t.type)?{isValid:!1,error:`Invalid file type. Allowed: ${e.join(", ")}`}:t.size>r?{isValid:!1,error:`File too large. Maximum size: ${r/(1024*1024)}MB`}:[/\.exe$/i,/\.bat$/i,/\.cmd$/i,/\.scr$/i,/\.vbs$/i,/\.js$/i,/\.jar$/i].some(s=>s.test(t.name))?{isValid:!1,error:"Suspicious file type detected"}:{isValid:!0}:{isValid:!1,error:"No file selected"}}function qr(t){if(typeof t!="string")return{isSafe:!0,threats:[]};const e=[];return/<script|javascript:|vbscript:|onload=|onerror=/i.test(t)&&e.push("Script injection attempt"),/(\bunion\b|\bselect\b|\binsert\b|\bupdate\b|\bdelete\b|\bdrop\b).*(\bfrom\b|\binto\b|\bwhere\b)/i.test(t)&&e.push("SQL injection pattern"),/\.\.\/|\.\.\\|%2e%2e%2f|%2e%2e%5c/i.test(t)&&e.push("Path traversal attempt"),/<[^>]*>/i.test(t)&&e.push("HTML injection attempt"),/\0/.test(t)&&e.push("Null byte injection"),{isSafe:e.length===0,threats:e}}const Pl={};function Is(t,e=10,r=6e4){const n=Date.now(),s=`${t}_${Math.floor(n/r)}`;return Pl[s]||(Pl[s]=0),Pl[s]++,Pl[s]>e?{allowed:!1,error:`Rate limit exceeded. Maximum ${e} requests per ${r/1e3} seconds.`}:(Object.keys(Pl).forEach(i=>{const a=parseInt(i.split("_").pop())*r;n-a>r*2&&delete Pl[i]}),{allowed:!0})}function oI(t,e={}){const r=[],{isNew:n=!1}=e;if(!t||typeof t!="object")return{isValid:!1,errors:["Invalid student data"]};if(!t.app||!t.app.studentData)return r.push("Student data structure is invalid"),{isValid:!1,errors:r};const s=t.app.studentData;return[{field:"firstName",name:"First Name"},{field:"lastName",name:"Last Name"},{field:"caseManagerId",name:"Case Manager"}].forEach(({field:l,name:c})=>{const u=w0(s[l],c);u.isValid||r.push(u.error)}),[{field:"firstName",name:"First Name",maxLength:100},{field:"lastName",name:"Last Name",maxLength:100},{field:"studentId",name:"Student ID",maxLength:50},{field:"grade",name:"Grade",maxLength:10}].forEach(({field:l,name:c,maxLength:u})=>{if(s[l]){const f=Ad(s[l],c,1,u);f.isValid||r.push(f.error)}}),["firstName","lastName","studentId","grade"].forEach(l=>{if(s[l]){const c=qr(s[l]);c.isSafe||r.push(`Security threat detected in ${l}: ${c.threats.join(", ")}`)}}),t.app.accommodations&&typeof t.app.accommodations!="string"&&t.app.accommodations!==null&&r.push("Accommodations must be encrypted string or null"),t.app.classServices&&typeof t.app.classServices!="string"&&t.app.classServices!==null&&r.push("Class services must be encrypted string or null"),s.plan&&typeof s.plan!="string"&&s.plan!==null&&r.push("Student plan must be encrypted string or null"),{isValid:r.length===0,errors:r}}function O7(t){const e=[];if(!t||typeof t!="object")return{isValid:!1,errors:["Invalid user data"]};const r=w0(t.name,"Name");r.isValid||e.push(r.error);const n=w0(t.email,"Email");n.isValid||e.push(n.error);const s=w0(t.role,"Role");if(s.isValid||e.push(s.error),t.email){const a=R7(t.email);a.isValid||e.push(a.error)}if(t.role){const a=F7(t.role);a.isValid||e.push(a.error)}if(t.name){const a=Ad(t.name,"Name",1,100);a.isValid||e.push(a.error)}if(t.email){const a=Ad(t.email,"Email",1,255);a.isValid||e.push(a.error)}return["name","email"].forEach(a=>{if(t[a]){const o=qr(t[a]);o.isSafe||e.push(`Security threat detected in ${a}: ${o.threats.join(", ")}`)}}),{isValid:e.length===0,errors:e}}function lI(t){const e={...t};if(e.app&&e.app.studentData){const r=e.app.studentData;["firstName","lastName","studentId","grade"].forEach(s=>{r[s]&&(r[s]=mn(r[s],100))})}else["firstName","lastName","studentId","grade"].forEach(n=>{e[n]&&(e[n]=mn(e[n],100))});return e}function M7(t){const e={...t};return e.name&&(e.name=mn(e.name,100)),e.email&&(e.email=P7(e.email)),e}const L7=async(t,e,r=100,n=1e3)=>{const s=[];for(let a=0;a<t.length;a+=r)s.push(t.slice(a,a+r));const i=[];for(let a=0;a<s.length;a++)try{const o=await e(s[a]);i.push(o),a<s.length-1&&await new Promise(l=>setTimeout(l,n))}catch(o){throw console.error(`Error in batch ${a+1}:`,o),o}return i},Hc=N7;function xh(t){if(!t||typeof t!="object")return t;if(t.toJSON&&typeof t.toJSON=="function")return t.toJSON();if(Array.isArray(t))return t.map(xh);const e={};for(const[r,n]of Object.entries(t)){if(r.toLowerCase().includes("schedule")&&typeof n=="object"&&n!==null)for(const[s,i]of Object.entries(n))i&&typeof i=="object"&&i.teacherId!==void 0&&(n[s].teacherId=String(i.teacherId));e[r]=xh(n)}return e}const Os=se([]);let Cm=null;function Ii(){async function t(){if(!Cm)try{const{useGoogleSheetsRealtime:o}=await la(async()=>{const{useGoogleSheetsRealtime:l}=await Promise.resolve().then(()=>jue);return{useGoogleSheetsRealtime:l}},void 0);Cm=o()}catch(o){console.error("Failed to load Google Sheets sync:",o)}return Cm}async function e(){var c,u,f;const o=await Gt(_t(qe,"students"));Os.value=o.docs.map(h=>{const p=h.data(),v=xh(p);return{id:h.id,...v}});const l=Os.value.find(h=>h.aeries);l&&(console.log(" useStudents DEBUG - Student with aeries:",l),console.log(" useStudents DEBUG - aeries.schedule:",(c=l.aeries)==null?void 0:c.schedule),console.log(" useStudents DEBUG - aeries.schedule type:",typeof((u=l.aeries)==null?void 0:u.schedule)),(f=l.aeries)!=null&&f.schedule&&console.log(" useStudents DEBUG - schedule keys:",Object.keys(l.aeries.schedule)))}function r(o){Os.value=o.map(l=>{const c=xh(l);return{id:l.id,...c}})}async function n(){return(await Gt(_t(qe,"students"))).docs.map(l=>({id:l.id,...l.data()}))}async function s(o,l){await Rp(Ze(qe,"students",o),l);try{const c=await t();if(c&&c.linkedSheetId.value){const u=Os.value.findIndex(f=>f.id===o);u!==-1&&(Os.value[u]={...Os.value[u],...l}),console.log("Syncing student update to Google Sheets..."),await c.updateSheetData(Os.value)}}catch(c){console.error("Failed to sync to Google Sheets:",c)}}async function i(o){var c,u,f,h,p,v,g;const l=Os.value.find(y=>y.id===o);await po(Ze(qe,"students",o)),await tn.logStudentAccess(o,"delete",{studentName:l?`${((u=(c=l.app)==null?void 0:c.studentData)==null?void 0:u.firstName)||""} ${((h=(f=l.app)==null?void 0:f.studentData)==null?void 0:h.lastName)||""}`.trim():"Unknown",ssid:(v=(p=l==null?void 0:l.app)==null?void 0:p.studentData)==null?void 0:v.ssid,deletedFields:l?Object.keys(((g=l.app)==null?void 0:g.studentData)||{}):[]});try{const y=await t();y&&y.linkedSheetId.value&&(Os.value=Os.value.filter(b=>b.id!==o),console.log("Syncing student deletion to Google Sheets..."),await y.updateSheetData(Os.value))}catch(y){console.error("Failed to sync to Google Sheets:",y)}}return{students:Os,fetchStudents:e,setStudents:r,fetchAllStudents:n,updateStudent:s,deleteStudent:i,deleteAllStudents:async()=>{try{const l=(await Gt(_t(qe,"students"))).docs;return await tn.logStudentAccess("bulk_operation","delete_all",{studentCount:l.length,operation:"bulk_delete_all_students",deletedStudentIds:l.map(c=>c.id)}),await L7(l,async c=>{const u=Fy(qe);c.forEach(f=>{u.delete(f.ref)}),await u.commit()},50,2e3),{success:!0}}catch(o){throw console.error("Error deleting all students:",o),await tn.logStudentAccess("bulk_operation","delete_all_failed",{error:o.message,operation:"bulk_delete_all_students_failed"}),o}}}}function _a(){const t=se({}),e=se([]);async function r(){const a=await Gt(_t(qe,"users")),o={},l=[];a.forEach(c=>{const u=c.data();o[c.id]={id:c.id,...u},l.push({id:c.id,...u}),u.aeriesId&&console.log(" Loaded user with Aeries ID:",{name:u.name,email:u.email,aeriesId:u.aeriesId,id:c.id})}),t.value=o,e.value=l,console.log(" Total users loaded:",l.length),console.log(" Users with Aeries IDs:",l.filter(c=>c.aeriesId).length)}const n=be(()=>({teachers:e.value.filter(a=>["teacher","case_manager","sped_chair"].includes(a.role)),caseManagers:e.value.filter(a=>["case_manager","sped_chair","admin_504"].includes(a.role)),speech:e.value.filter(a=>a.provider==="SLP"),ot:e.value.filter(a=>a.provider==="OT"),mh:e.value.filter(a=>a.provider==="MH"),pt:e.value.filter(a=>a.provider==="PT"),sc:e.value.filter(a=>a.provider==="SC"),tr:e.value.filter(a=>a.provider==="TR"),aud:e.value.filter(a=>a.provider==="AUD"),vi:e.value.filter(a=>a.provider==="VI"),at:e.value.filter(a=>a.provider==="AT"),dhh:e.value.filter(a=>a.provider==="DHH"),om:e.value.filter(a=>a.provider==="O&M"),bis:e.value.filter(a=>a.provider==="BIS"),hn:e.value.filter(a=>a.provider==="HN"),sw:e.value.filter(a=>a.provider==="SW")})),s=be(()=>e.value.filter(a=>["case_manager","sped_chair","admin_504"].includes(a.role))),i=be(()=>e.value.filter(a=>["teacher","case_manager","sped_chair"].includes(a.role)));return{users:t,userList:e,fetchUsers:r,caseManagers:s,teacherList:i,userRoles:n}}function Ky(){const t=se({}),e=se(!1);async function r(){e.value=!0;try{const h=await Gt(_t(qe,"aideSchedules")),p={};h.forEach(v=>{p[v.id]=v.data()}),t.value=p}catch(h){console.error("Error loading aide assignments:",h),t.value={}}finally{e.value=!1}}async function n(h){if(!h){console.warn("loadAideAssignment called without aideId");return}e.value=!0;try{const p=await nr(Ze(qe,"aideSchedules",h));p.exists()?t.value[h]=p.data():t.value[h]={classAssignment:{},directAssignment:[]}}catch(p){console.error("Error loading aide assignment:",p),t.value[h]={classAssignment:{},directAssignment:[]}}finally{e.value=!1}}async function s(h,p){try{const v=JSON.parse(JSON.stringify(p));await Ht(Ze(qe,"aideSchedules",h),v,{merge:!0}),t.value[h]=v}catch(v){throw console.error("Error saving aide assignment:",v),v}}async function i(){try{const h=Object.entries(t.value);for(const[p,v]of h){const g=JSON.parse(JSON.stringify(v));await Ht(Ze(qe,"aideSchedules",p),g,{merge:!0})}}catch(h){throw console.error("Error saving all aide assignments:",h),h}}function a(h,p){const v=[];return Object.entries(t.value).forEach(([g,y])=>{y.classAssignment&&y.classAssignment[p]&&(Array.isArray(y.classAssignment[p])?y.classAssignment[p]:[y.classAssignment[p]]).includes(h)&&v.push(g)}),v}function o(h){var v;const p=(v=t.value[h])==null?void 0:v.directAssignment;return Array.isArray(p)?p.length>0?p[0]:null:p||null}function l(h){return Object.keys(t.value).find(v=>{var y;const g=(y=t.value[v])==null?void 0:y.directAssignment;return Array.isArray(g)?g.includes(h):g===h})||null}function c(h,p,v){const g=[],y=t.value[h];return y&&((Array.isArray(y.directAssignment)?y.directAssignment:y.directAssignment?[y.directAssignment]:[]).forEach(E=>{if(E){const x=p.find(I=>I.id===E);x&&g.push({...x,assignmentType:"direct"})}}),Object.entries(y.classAssignment||{}).forEach(([E,x])=>{x&&(Array.isArray(x)?x:[x]).forEach(D=>{D&&p.forEach(P=>{const w=f(P);if(w){const S=w[E];if((typeof S=="string"?S:S==null?void 0:S.teacherId)===D){const T=g.findIndex(_=>_.id===P.id);T===-1?g.push({...P,assignmentType:"class",period:E,teacherId:D}):(g[T].assignmentType="both",g[T].period=E,g[T].teacherId=D)}}})})})),g}function u(h,p,v,g){if(!h||!p||!v||!g)return!1;const y=v.find(P=>P.id===p);if(!y)return!1;const b=t.value[h];if(!b)return!1;if((Array.isArray(b.directAssignment)?b.directAssignment:b.directAssignment?[b.directAssignment]:[]).includes(p))return!0;const x=f(y);if(!x)return!1;const I=b.classAssignment||{};return Object.entries(x).some(([P,w])=>{const S=typeof w=="string"?w:w==null?void 0:w.teacherId,m=I[P];return!m||!S?!1:(Array.isArray(m)?m:[m]).includes(S)})}function f(h){var p,v,g,y,b;return h.schedule?h.schedule:(v=(p=h.app)==null?void 0:p.schedule)!=null&&v.periods?h.app.schedule.periods:(y=(g=h.aeries)==null?void 0:g.schedule)!=null&&y.periods?h.aeries.schedule.periods:(b=h.aeries)!=null&&b.schedule?h.aeries.schedule:null}return{aideAssignment:be(()=>t.value),loading:be(()=>e.value),loadAideAssignments:r,loadAideAssignment:n,saveAideAssignment:s,saveAllAideAssignments:i,getAidesForTeacher:a,getDirectStudentForAide:o,getAideForStudent:l,getStudentsForAide:c,shouldAideSeeStudent:u}}function qy(){const t=se(!1),e=se(""),r=se("");let n,s,i,a;try{n=cc(),s=Da(n,"getStudentFeedback"),i=Da(n,"createFeedbackFormSheet"),a=Da(n,"createFeedbackFormSheetWithUserAuth")}catch(I){console.warn("Firebase Functions not available:",I),s=()=>Promise.reject(new Error("Functions not available")),i=()=>Promise.reject(new Error("Functions not available")),a=()=>Promise.reject(new Error("Functions not available"))}const o=_t(qe,"feedbackForms"),l=se(!1),c=se([]);let u;const f=be(()=>{var D;return(((D=c.value)==null?void 0:D.filter(P=>P.active!==!1))||[]).sort((P,w)=>{var T,_;const S=(T=P.createdAt)!=null&&T.seconds?new Date(P.createdAt.seconds*1e3):new Date(P.createdAt);return((_=w.createdAt)!=null&&_.seconds?new Date(w.createdAt.seconds*1e3):new Date(w.createdAt))-S})}),h=async I=>{try{t.value=!0,e.value="",console.log(" Creating Google Sheet with personal account for form:",I.title);const D=await i({title:I.title,description:I.description,formUrl:I.formUrl,studentId:I.studentId||null,studentName:I.studentName||null});if(!D.data.success)throw new Error("Failed to create Google Sheet: "+D.data.message);console.log(" Google Sheet created:",D.data.spreadsheetUrl);const P={title:I.title,description:I.description,formUrl:I.formUrl,spreadsheetId:D.data.spreadsheetId,spreadsheetUrl:D.data.spreadsheetUrl,userDriveId:D.data.userDriveId,parentFolderId:D.data.parentFolderId,active:!0,createdAt:new Date,createdBy:I.createdBy},w=Ze(o);return await Ht(w,P),r.value="Feedback form and Google Sheet created successfully!",{id:w.id,...P}}catch(D){throw console.error("Error creating feedback form:",D),D.message.includes("storage quota exceeded")||D.message.includes("Service account storage quota exceeded")?D.value=' Cannot create Google Sheet: Service account has no storage quota. Please use the "Test with Personal Account" button in Google Drive Setup to use your personal Google account instead.':D.message.includes("permission")||D.message.includes("access")?D.value=" Permission denied: Please ensure the folder is shared with the service account or use your personal Google account.":D.value=D.message,D}finally{t.value=!1}},p=async(I,D)=>{try{t.value=!0,e.value="";const P=Ze(o,I);await Ht(P,{...D,updatedAt:new Date},{merge:!0}),r.value="Feedback form updated successfully!"}catch(P){throw console.error("Error updating feedback form:",P),e.value=P.message,P}finally{t.value=!1}},v=async I=>{try{t.value=!0,e.value="";const D=Ze(o,I);await po(D),r.value="Feedback form deleted successfully!"}catch(D){throw console.error("Error deleting feedback form:",D),e.value=D.message,D}finally{t.value=!1}},g=()=>{e.value="",r.value=""},y=I=>{const D=I.match(/\/forms\/d\/([a-zA-Z0-9-_]+)/);return D?D[1]:null},b=()=>{try{u=nf(o,I=>{c.value=I.docs.map(D=>({id:D.id,...D.data()})),l.value=!1},I=>{console.warn("Error listening to feedback forms:",I),l.value=!1})}catch(I){console.warn("Error initializing Firestore listeners:",I),l.value=!1}},E=()=>{u&&u()};return jt(()=>{b()}),Va(()=>{E()}),{isLoading:t,error:e,successMessage:r,formsLoading:l,feedbackForms:c,activeForms:f,createFeedbackForm:h,updateFeedbackForm:p,deleteFeedbackForm:v,clearMessages:g,extractFormId:y,createFeedbackFormWithUserAuth:async(I,D)=>{try{t.value=!0,e.value="",console.log(" Creating Google Sheet with personal account for form:",I.title);const P=await a({title:I.title,description:I.description,formUrl:I.formUrl,studentId:I.studentId||null,studentName:I.studentName||null,accessToken:D});if(!P.data.success)throw new Error("Failed to create Google Sheet: "+P.data.message);console.log(" Google Sheet created with personal account:",P.data.spreadsheetUrl);const w={title:I.title,description:I.description,formUrl:I.formUrl,spreadsheetId:P.data.spreadsheetId,spreadsheetUrl:P.data.spreadsheetUrl,driveType:"personal",active:!0,createdAt:new Date,createdBy:I.createdBy},S=Ze(o);return await Ht(S,w),r.value="Feedback form and Google Sheet created successfully in your personal Google Drive!",{id:S.id,...w}}catch(P){throw console.error("Error creating feedback form with user auth:",P),P.value=P.message,P}finally{t.value=!1}}}}function B7(){const t=Fs(),e=se(!1),r=se(null),n=se([]),s=se(0),i=be(()=>t.user),a=be(()=>{var I;return(I=t.user)==null?void 0:I.role}),o=be(()=>{var I;return(I=t.user)==null?void 0:I.uid}),l=async()=>{console.log(" Admin query: Loading all students - START"),console.log(" Admin query: currentUser:",i.value),console.log(" Admin query: currentRole:",a.value),console.log(" Admin query: currentUserId:",o.value);try{const I=or(_t(qe,"students"),hn("app.studentData.lastName","asc"));console.log(" Admin query created:",I);const D=await Gt(I);console.log(" Admin query snapshot:",D.size,"documents");const P=D.docs.map(w=>({id:w.id,...w.data()}));if(console.log(" Admin query result:",P.length,"students"),P.length>0)console.log(" First student structure:",P[0]);else{console.log(" Admin query: NO STUDENTS FOUND - checking collection directly");const w=or(_t(qe,"students")),S=await Gt(w);console.log(" Simple query found:",S.size,"documents")}return P}catch(I){console.error(" Admin query error:",I),console.error(" Admin query error details:",I.message,I.code);try{console.log(" Trying fallback query without ordering...");const D=or(_t(qe,"students")),P=await Gt(D);console.log(" Fallback query found:",P.size,"documents");const w=P.docs.map(S=>({id:S.id,...S.data()}));return console.log(" Fallback query returning:",w.length,"students"),w}catch(D){return console.error(" Fallback query also failed:",D),console.error(" Fallback query error details:",D.message,D.code),[]}}},c=async()=>{console.log(" 504 Admin query: Loading all students (edit restrictions applied at form level)");try{const I=or(_t(qe,"students"),hn("app.studentData.lastName","asc"));return(await Gt(I)).docs.map(P=>({id:P.id,...P.data()}))}catch(I){console.error(" 504 Admin query error:",I);try{const D=or(_t(qe,"students"));return(await Gt(D)).docs.map(w=>({id:w.id,...w.data()}))}catch(D){return console.error(" 504 Admin fallback query failed:",D),[]}}},u=async()=>{console.log(" SPED Chair query: Loading only IEP students");try{const I=or(_t(qe,"students"),Ur("app.studentData.plan","==","IEP"),hn("app.studentData.lastName","asc"));return(await Gt(I)).docs.map(P=>({id:P.id,...P.data()}))}catch(I){console.error(" SPED Chair query error:",I);try{const D=or(_t(qe,"students"),Ur("app.studentData.plan","==","IEP"));return(await Gt(D)).docs.map(w=>({id:w.id,...w.data()}))}catch(D){return console.error(" SPED Chair fallback query failed:",D),[]}}},f=async I=>{console.log(" Security: Loading students for case manager (CM + SP access):",I);try{const D=or(_t(qe,"students"),Ur("app.studentData.caseManagerId","==",I)),w=(await Gt(D)).docs.map(A=>({id:A.id,...A.data()})),S=or(_t(qe,"students"),Ur("app.staffIds","array-contains",I)),T=(await Gt(S)).docs.map(A=>({id:A.id,...A.data()})),_=[...w];return T.forEach(A=>{_.find(k=>k.id===A.id)||_.push(A)}),_.sort((A,k)=>{var R,F,N,M;const U=((F=(R=A.app)==null?void 0:R.studentData)==null?void 0:F.lastName)||"",L=((M=(N=k.app)==null?void 0:N.studentData)==null?void 0:M.lastName)||"";return U.localeCompare(L)}),console.log(" Security: Case manager found:",w.length,"CM students,",T.length,"SP students"),console.log(" Security: Total unique students:",_.length),console.log(" Security: CM accessible students:",_.map(A=>{var k,U,L,R;return`${(U=(k=A.app)==null?void 0:k.studentData)==null?void 0:U.firstName} ${(R=(L=A.app)==null?void 0:L.studentData)==null?void 0:R.lastName}`}).slice(0,8)),_}catch(D){return console.error(" Security: Error loading case manager students:",D),[]}},h=async I=>{console.log(" Teacher query: Loading students for teacher",I);try{const D=or(_t(qe,"students"),Ur("app.staffIds","array-contains",I),hn("app.studentData.lastName","asc")),P=await Gt(D);return console.log(" Teacher query: Found",P.size,"students with teacher in staffIds"),P.docs.map(w=>({id:w.id,...w.data()}))}catch(D){return console.error(" Security: Error loading teacher students:",D),[]}},p=async I=>{var D,P,w,S;console.log(" Service Provider query: Loading students for provider",I),console.log(" Service Provider query: userId type:",typeof I),console.log(" Service Provider query: userId value:",JSON.stringify(I));try{const m=or(_t(qe,"students"),Ur("app.staffIds","array-contains",I));console.log(" Service Provider query: Executing staffIds query...");const T=await Gt(m);console.log(" Service Provider query: Success! Found",T.size,"students");const _=T.docs.map(A=>({id:A.id,...A.data()}));return _.sort((A,k)=>{var R,F,N,M;const U=((F=(R=A.app)==null?void 0:R.studentData)==null?void 0:F.lastName)||"",L=((M=(N=k.app)==null?void 0:N.studentData)==null?void 0:M.lastName)||"";return U.localeCompare(L)}),_}catch(m){console.error(" Service Provider query FAILED:",m),console.error(" Error code:",m.code),console.error(" Error message:",m.message),console.error(" Full error object:",m);const T=Qo();return console.error(" Current auth state:",{uid:(D=T.currentUser)==null?void 0:D.uid,email:(P=T.currentUser)==null?void 0:P.email,customClaims:"Check in browser dev tools"}),console.error(" Auth mismatch check:",{queryUserId:I,authUid:(w=T.currentUser)==null?void 0:w.uid,match:I===((S=T.currentUser)==null?void 0:S.uid)}),[]}},v=async I=>{var D,P,w,S;console.log(" Paraeducator query: Loading students for aide",I),console.log(" Paraeducator query: userId type:",typeof I),console.log(" Paraeducator query: userId value:",JSON.stringify(I));try{console.log(" Paraeducator query: Trying staffIds approach first...");try{const L=or(_t(qe,"students"),Ur("app.staffIds","array-contains",I),hn("app.studentData.lastName","asc")),R=await Gt(L);if(console.log(" Paraeducator query: staffIds approach found",R.size,"students"),R.size>0){const F=R.docs.map(N=>({id:N.id,...N.data()}));return console.log(" Paraeducator query: SUCCESS with staffIds approach"),F}}catch(L){console.log(" Paraeducator query: staffIds approach failed:",L.message)}console.log(" Paraeducator query: Using aideSchedules fallback...");const m=await nr(Ze(qe,"aideSchedules",I));if(!m.exists())return console.log(" Paraeducator query: No aide schedule document found for",I),[];const T=m.data();console.log(" Paraeducator query: Found aide data:",T);let _=[];if(T.studentIds&&Array.isArray(T.studentIds)?(_=T.studentIds,console.log(" Paraeducator query: Using studentIds array:",_)):T.directAssignment&&(_=Array.isArray(T.directAssignment)?T.directAssignment:[T.directAssignment],console.log(" Paraeducator query: Using directAssignment as fallback:",_)),_.length===0)return console.log(" Paraeducator query: No student assignments found for aide",I),[];console.log(" Paraeducator query: Fetching",_.length,"assigned students individually...");const A=_.map(async L=>{try{const R=await nr(Ze(qe,"students",L));return R.exists()?{id:R.id,...R.data()}:null}catch(R){return console.warn(" Paraeducator query: Failed to fetch student",L,":",R.message),null}}),U=(await Promise.all(A)).filter(L=>L!==null);return U.sort((L,R)=>{var M,z,G,H;const F=((z=(M=L.app)==null?void 0:M.studentData)==null?void 0:z.lastName)||"",N=((H=(G=R.app)==null?void 0:G.studentData)==null?void 0:H.lastName)||"";return F.localeCompare(N)}),console.log(" Paraeducator query: Successfully fetched",U.length,"students"),U}catch(m){console.error(" Paraeducator query FAILED:",m),console.error(" Error code:",m.code),console.error(" Error message:",m.message),console.error(" Full error object:",m);const T=Qo();return console.error(" Current auth state:",{uid:(D=T.currentUser)==null?void 0:D.uid,email:(P=T.currentUser)==null?void 0:P.email,customClaims:"Check in browser dev tools"}),console.error(" Auth mismatch check:",{queryUserId:I,authUid:(w=T.currentUser)==null?void 0:w.uid,match:I===((S=T.currentUser)==null?void 0:S.uid)}),[]}},g=async()=>{console.log(" Testing query: Loading students with testing flags");const I=or(_t(qe,"students"),Ur("app.flags.flag2","==",!0),hn("app.studentData.lastName","asc")),D=or(_t(qe,"students"),Ur("app.flags.separateSetting","==",!0),hn("app.studentData.lastName","asc")),[P,w]=await Promise.all([Gt(I),Gt(D)]),S=P.docs.map(_=>({id:_.id,..._.data()})),m=w.docs.map(_=>({id:_.id,..._.data()})),T=[...S];return m.forEach(_=>{T.find(A=>A.id===_.id)||T.push(_)}),T.sort((_,A)=>{var L,R,F,N;const k=((R=(L=_.app)==null?void 0:L.studentData)==null?void 0:R.lastName)||"",U=((N=(F=A.app)==null?void 0:F.studentData)==null?void 0:N.lastName)||"";return k.localeCompare(U)})},y=async(I={})=>{var D,P;if(console.log(" loadStudents called - DEBUG AUTH STATE:"),console.log("  currentUserId.value:",o.value),console.log("  currentRole.value:",a.value),console.log("  authStore.user:",t.user),console.log("  authStore.user?.uid:",(D=t.user)==null?void 0:D.uid),console.log("  authStore.user?.role:",(P=t.user)==null?void 0:P.role),!o.value||!a.value)return console.error(" No authenticated user or role - FAILING AUTH CHECK"),console.error("  currentUserId.value is:",o.value),console.error("  currentRole.value is:",a.value),r.value="Authentication required",[];e.value=!0,r.value=null;try{let w=[];switch(console.log(" ROUTING to query based on role:",a.value),console.log(" Available role cases: admin, school_admin, staff_view, staff_edit, admin_504, sped_chair, case_manager, teacher, service_provider, paraeducator"),a.value){case"admin":case"school_admin":case"staff_view":case"staff_edit":case"administrator":w=await l();break;case"sped_chair":w=await u();break;case"admin_504":w=await c();break;case"case_manager":console.log(" CALLING getCaseManagerStudents with userId:",o.value),w=await f(o.value),console.log(" getCaseManagerStudents COMPLETED, returned:",w.length,"students");break;case"teacher":w=await h(o.value);break;case"service_provider":w=await p(o.value);break;case"paraeducator":w=await v(o.value);break;default:return console.error(" Unknown role:",a.value),r.value="Invalid user role",[]}return I.testingOnly&&(w=await g()),n.value=w,s.value=w.length,console.log(` Loaded ${w.length} students for ${a.value}`),w}catch(w){return console.error(" Error loading students:",w),r.value=w.message||"Failed to load students",[]}finally{e.value=!1}},b=async I=>{if(!I)throw new Error("Student ID is required");if(!o.value||!a.value)throw new Error("Authentication required");e.value=!0,r.value=null;try{const D=await nr(Ze(qe,"students",I));if(!D.exists())throw new Error("Student not found");const P={id:D.id,...D.data()};if(!await E(P,o.value,a.value))throw new Error("Access denied to this student");return P}catch(D){throw console.error(" Error getting student:",D),r.value=D.message,D}finally{e.value=!1}},E=async(I,D,P)=>{var w,S,m,T,_,A,k;if(!I||!D||!P)return!1;if(["admin","school_admin","admin_504","sped_chair"].includes(P))return!0;if(P==="case_manager")return((S=(w=I.app)==null?void 0:w.studentData)==null?void 0:S.caseManagerId)===D;if(P==="teacher"){if(!((T=(m=I.app)==null?void 0:m.schedule)!=null&&T.periods))return!1;const U=I.app.schedule.periods,L=Object.values(U);return L.includes(D)?!0:L.some(R=>{var F;return typeof R=="object"&&R!==null?R.teacherId===D||((F=R.coTeaching)==null?void 0:F.caseManagerId)===D:!1})}if(P==="service_provider"){if((_=I.app)!=null&&_.providers&&Object.values(I.app.providers).includes(D))return!0;if((k=(A=I.app)==null?void 0:A.schedule)!=null&&k.periods){const U=I.app.schedule.periods,L=Object.values(U);return L.includes(D)?!0:L.some(R=>{var F;return typeof R=="object"&&R!==null?R.teacherId===D||((F=R.coTeaching)==null?void 0:F.caseManagerId)===D:!1})}}return!1},x=async(I=50,D=null)=>{if(!o.value||!a.value)throw new Error("Authentication required");e.value=!0,r.value=null;try{let P=or(_t(qe,"students"),hn("app.studentData.lastName","asc"),ia(I));D&&(P=or(P,hh(D))),a.value==="case_manager"&&(P=or(_t(qe,"students"),Ur("app.studentData.caseManagerId","==",o.value),hn("app.studentData.lastName","asc"),ia(I)),D&&(P=or(P,hh(D))));const w=await Gt(P);return{students:w.docs.map(m=>({id:m.id,...m.data()})),lastDoc:w.docs[w.docs.length-1],hasMore:w.docs.length===I}}catch(P){throw console.error(" Error loading paginated students:",P),r.value=P.message,P}finally{e.value=!1}};return{students:be(()=>n.value),loading:be(()=>e.value),error:be(()=>r.value),totalCount:be(()=>s.value),loadStudents:y,getStudent:b,verifyStudentAccess:E,loadStudentsPaginated:x,getAdminStudents:l,getAdmin504Students:c,getCaseManagerStudents:f,getTeacherStudents:h,getServiceProviderStudents:p,getParaeducatorStudents:v,getTestingStudents:g}}function U7(t,e){const r={isSecure:!0,violations:[],summary:"",studentCount:t.length,authorizedCount:0,unauthorizedCount:0};return!e||!e.role?(r.isSecure=!1,r.violations.push("No user or role provided"),r):(t.forEach((n,s)=>{var a,o,l,c;$7(n,e)?r.authorizedCount++:(r.unauthorizedCount++,r.isSecure=!1,r.violations.push({studentIndex:s,studentName:`${(o=(a=n.app)==null?void 0:a.studentData)==null?void 0:o.firstName} ${(c=(l=n.app)==null?void 0:l.studentData)==null?void 0:c.lastName}`,studentId:n.id,reason:V7(n,e)}))}),r.summary=`User ${e.role} (${e.uid}) has access to ${r.authorizedCount}/${r.studentCount} students`,r.isSecure||(r.summary+=`. SECURITY VIOLATION: ${r.unauthorizedCount} unauthorized students accessible!`),r)}function $7(t,e){var s,i,a,o,l,c,u;const{role:r,uid:n}=e;switch(r){case"admin":case"school_admin":case"admin_504":case"sped_chair":case"staff_view":case"staff_edit":return!0;case"case_manager":return((i=(s=t.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId)===n;case"teacher":const f=((o=(a=t.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{};return Object.values(f).includes(n);case"service_provider":const h=((l=t.app)==null?void 0:l.providers)||{},p=((u=(c=t.app)==null?void 0:c.schedule)==null?void 0:u.periods)||{},v=Object.values(h).includes(n),g=Object.values(p).includes(n);return v||g;case"paraeducator":return!0;default:return!1}}function V7(t,e){var s,i,a,o,l,c,u;const{role:r,uid:n}=e;switch(r){case"case_manager":const f=(i=(s=t.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId;return`Case manager ${n} is not assigned to student (assigned to: ${f})`;case"teacher":const h=((o=(a=t.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{},p=Object.values(h);return`Teacher ${n} does not teach this student (teachers: ${p.join(", ")})`;case"service_provider":const v=((l=t.app)==null?void 0:l.providers)||{},g=((u=(c=t.app)==null?void 0:c.schedule)==null?void 0:u.periods)||{},y=Object.values(v).filter(E=>E),b=Object.values(g);return`Service provider ${n} is not assigned to student (providers: ${y.join(", ")}, teachers: ${b.join(", ")})`;case"paraeducator":return null;default:return`Unknown role: ${r}`}}function H7(t){t.isSecure?console.log(" SECURITY TEST PASSED:",t.summary):(console.error(" SECURITY TEST FAILED:",t.summary),console.error("Violations:",t.violations))}function H2(t,e){const r=U7(t,e);return H7(r),r}const cI=(t,e)=>{console.log(` DEBUG: Schedule Operation - ${t}:`,e)};function uI(t){return cI("getTeacherIdFromPeriod",{periodData:t,type:typeof t}),t?typeof t=="string"?t:t.teacherId||null:null}function Mp(t){var e;return cI("getCoTeachingCaseManagerFromPeriod",{periodData:t}),!t||typeof t!="object"?null:((e=t.coTeaching)==null?void 0:e.caseManagerId)||null}function j7(t,e={}){if(!t||!t.periods)return[];const r=new Set;return Object.values(t.periods).forEach(n=>{const s=uI(n);s&&r.add(s);const i=Mp(n);if(i){const a=e[i];a&&(a.role==="teacher"||a.roles&&a.roles.includes("teacher"))&&r.add(i)}}),Array.from(r)}function G7(t){if(!t||!t.periods)return[];const e=new Set;return Object.values(t.periods).forEach(r=>{const n=Mp(r);n&&e.add(n)}),Array.from(e)}function W7(t,e){var r,n;return!((n=(r=t.app)==null?void 0:r.schedule)!=null&&n.periods)||!e?!1:Object.values(t.app.schedule.periods).some(s=>Mp(s)===e)}function z7(){const t=Ci(),e=Fs(),{students:r,setStudents:n}=Ii(),{users:s,userList:i,fetchUsers:a,caseManagers:o,teacherList:l,userRoles:c}=_a(),{loadAideAssignment:u,loadAideAssignments:f,shouldAideSeeStudent:h,aideAssignment:p}=Ky(),{feedbackForms:v,formsLoading:g}=qy(),{loadStudents:y}=B7(),b=se(!1),E=se(null),x=be(()=>e.currentUser),I=be(()=>{var L;const U=(L=x.value)==null?void 0:L.role;return["admin","school_admin","admin_504","sped_chair"].includes(U)}),D=be(()=>{var U;return["case_manager","admin_504","sped_chair"].includes((U=x.value)==null?void 0:U.role)}),P=be(()=>s.value||{}),w=be(()=>{var U;return((U=i.value)==null?void 0:U.filter(L=>L.role==="paraeducator"))||[]}),S=async()=>{var U,L;console.log(" useStudentData: fetchData() called"),b.value=!0,E.value=null;try{console.log(" useStudentData: About to fetchUsers()..."),await a(),console.log(" useStudentData: fetchUsers() completed");const R=x.value;if(console.log(" useStudentData: Checking user for loadStudents call:",R),R){console.log(" Security: Fetching students for user role:",R.role),console.log(" useStudentData: About to call loadStudents()...");const N=await y();console.log(" useStudentData: loadStudents() returned:",N.length,"students"),n(N);const M=H2(N,R);M.isSecure||console.error(" SECURITY VIOLATION DETECTED:",M.violations)}else console.log(" Security: No user found - setting empty student array"),n([]);const F=(U=x.value)==null?void 0:U.role;if(["admin","school_admin","admin_504","sped_chair"].includes(F))await f();else if(F==="paraeducator"&&x.value.uid){console.log(" useStudentData: Loading individual aide assignment for paraeducator:",x.value.uid),await u(x.value.uid);const N=Ze(qe,"aideSchedules",x.value.uid),M=nf(N,async z=>{if(z.exists()){console.log(" useStudentData: Aide schedule updated, reloading students..."),await u(x.value.uid);const G=await y();n(G)}});Va(()=>M())}console.log(" Security: Loaded",r.value.length,"students for",(L=x.value)==null?void 0:L.role),console.log("StudentsView - loaded users:",Object.keys(s.value||{}).length,"users")}catch(R){console.error("Error fetching data:",R),E.value=R.message||"Failed to load data"}finally{b.value=!1}},m=U=>r.value.find(L=>L.id===U)||{},T=U=>{const L=s.value[U];return L&&(L.name||L.email)||U},_=U=>{if(!U)return"N/A";const L=s.value[U];return L&&(L.name||L.email)||U},A=U=>{var L,R;return((R=(L=U.app)==null?void 0:L.studentData)==null?void 0:R.caseManagerId)||U.caseManagerId||U.casemanager_id},k=U=>{var L,R,F,N,M;return U.schedule?U.schedule:(R=(L=U.app)==null?void 0:L.schedule)!=null&&R.periods?U.app.schedule.periods:(N=(F=U.aeries)==null?void 0:F.schedule)!=null&&N.periods?U.aeries.schedule.periods:(M=U.aeries)!=null&&M.schedule?U.aeries.schedule:null};return jt(()=>{console.log(" useStudentData: onMounted triggered, calling fetchData..."),S()}),Vt(()=>{var U;return(U=x.value)==null?void 0:U.role},async(U,L)=>{if(U&&U!==L){console.log(" Security: User role changed from",L,"to",U,"- reloading students");const R=x.value;if(console.log(" useStudentData: Role watcher - checking user:",R),R){console.log(" useStudentData: Role watcher - about to call loadStudents()...");const F=await y();console.log(" useStudentData: Role watcher - loadStudents() returned:",F.length,"students"),n(F);const N=H2(F,R);N.isSecure||console.error(" SECURITY VIOLATION DETECTED:",N.violations),console.log(" Security: Reloaded",F.length,"students for role",U)}}},{immediate:!1}),{isLoading:b,error:E,students:r,userMap:s,userList:i,userMapObj:P,caseManagers:o,teacherList:l,userRoles:c,aideAssignment:p,feedbackForms:v,formsLoading:g,paraeducators:w,currentUser:x,isAdmin:I,showProviderView:D,fetchData:S,getStudentById:m,getUserName:T,getCaseManagerName:_,getCaseManagerId:A,getSchedule:k,shouldAideSeeStudent:h,getTeacherIdFromPeriod:uI,getCoTeachingCaseManagerFromPeriod:Mp,getAllTeacherIdsFromSchedule:j7,getCoTeachingCaseManagersFromSchedule:G7,isCoTeachingCaseManager:W7,router:t}}function it(t,e,r=""){const n=(l,c)=>c.split(".").reduce((u,f)=>u&&u[f]!==void 0?u[f]:null,l),s=n(t.overrides,e);if(t.overrides&&s!=null&&s!=="")return s;if(t.app){if(["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(e)){const c=n(t.app,`studentData.${e}`);if(c!=null&&c!=="")return c}if(["reviewDate","reevalDate","meetingDate"].includes(e)){const c=n(t.app,`dates.${e}`);if(c!=null&&c!=="")return c}if(["instruction","assessment"].includes(e)){const c=n(t.app,`accommodations.${e}`);if(c!=null&&c!=="")return c}const l=n(t.app,e);if(l!=null&&l!=="")return l}const i=n(t.aeries,e);if(t.aeries&&i!=null&&i!=="")return i;const a=n(t.seis,e);if(t.seis&&a!=null&&a!=="")return a;const o=n(t,e);return o!=null&&o!==""?o:r}function lu(t,e){const r=(o,l)=>l.split(".").reduce((c,u)=>c&&c[u]!==void 0?c[u]:null,o),n=r(t.overrides,e);if(t.overrides&&n!=null&&n!=="")return"Override";if(t.app){if(["firstName","lastName","grade","plan"].includes(e)){const l=r(t.app,`studentData.${e}`);if(l!=null&&l!=="")return"App"}if(["reviewDate","reevalDate","meetingDate"].includes(e)){const l=r(t.app,`dates.${e}`);if(l!=null&&l!=="")return"App"}if(["instruction","assessment"].includes(e)){const l=r(t.app,`accommodations.${e}`);if(l!=null&&l!=="")return"App"}const o=r(t.app,e);if(o!=null&&o!=="")return"App"}const s=r(t.aeries,e);if(t.aeries&&s!=null&&s!=="")return"Aeries";const i=r(t.seis,e);if(t.seis&&i!=null&&i!=="")return"SEIS";const a=r(t,e);return a!=null&&a!==""?"Top-level":""}function K7(t){return t?`<ul class="bullet-list">${t.split(/\n|\r|\d+\.\s+|\-\s+|;/).map(r=>r.trim()).filter(Boolean).map(r=>`<li>${r}</li>`).join("")}</ul>`:"<div></div>"}function q7(t){const{students:e,currentUser:r,shouldAideSeeStudent:n,userMap:s,getCaseManagerId:i,getSchedule:a,aideAssignment:o}=t,l=se(!1),c=se([]),u=Rs({sortBy:"firstName",cm:"all",teacher:"all",paraeducator:"all",plan:"all",search:"",providerView:"all",viewMode:"list"});let f=null;const h=()=>{f&&clearTimeout(f),f=setTimeout(()=>{y()},300)},p=()=>{l.value&&v(),l.value=!l.value},v=()=>{u.sortBy="firstName",u.cm="all",u.teacher="all",u.paraeducator="all",u.plan="all",u.search="",u.providerView="all",u.viewMode="list",y()},g=()=>({paraeducator:u.paraeducator,teacher:u.teacher}),y=(b=u)=>{var D,P,w,S;console.log(" FILTER DEBUG: applyFilters called with students.value.length:",e.value.length),console.log(" FILTER DEBUG: currentUser:",(D=r.value)==null?void 0:D.role,(P=r.value)==null?void 0:P.uid);let E=e.value;const x=(w=r.value)==null?void 0:w.role,I=["admin","school_admin"];if(console.log(" FILTER DEBUG: Provider view filtering check:",{userRole:x,providerView:b.providerView,shouldSkip:I.includes(x),resultLengthBefore:E.length}),!I.includes(x)&&b.providerView==="case_manager"?(console.log(" FILTER DEBUG: Applying case_manager filter"),E=E.filter(m=>{var T;return i(m)===((T=r.value)==null?void 0:T.uid)}),console.log(" FILTER DEBUG: After case_manager filter:",E.length)):!I.includes(x)&&b.providerView==="service_provider"?(console.log(" FILTER DEBUG: Applying service_provider filter"),E=E.filter(m=>{var U;const T=a(m),_=T?Object.entries(T).some(([L,R])=>{var F,N;return typeof R=="string"?R===((F=r.value)==null?void 0:F.uid):R&&typeof R=="object"?R.teacherId===((N=r.value)==null?void 0:N.uid):!1}):!1,A=(m.services||[]).some(L=>{var R;return L.includes((R=r.value)==null?void 0:R.uid)}),k=i(m)!==((U=r.value)==null?void 0:U.uid);return(_||A)&&k}),console.log(" FILTER DEBUG: After service_provider filter:",E.length)):console.log(" FILTER DEBUG: Skipping provider view filtering for role:",x),((S=r.value)==null?void 0:S.role)==="paraeducator"&&console.log(" FILTER DEBUG: Paraeducator - using database-filtered students, no additional filtering"),b.search){const m=b.search.toLowerCase();E=E.filter(T=>{const _=it(T,"firstName")||"",A=it(T,"lastName")||"";return`${_} ${A}`.toLowerCase().includes(m)})}if(b.cm&&b.cm!=="all"&&(E=E.filter(m=>i(m)===b.cm)),b.teacher&&b.teacher!=="all"&&(E=E.filter(m=>{const T=a(m);return T?Object.entries(T).some(([_,A])=>typeof A=="string"?A===b.teacher:A&&typeof A=="object"?A.teacherId===b.teacher:!1):!1})),b.paraeducator&&b.paraeducator!=="all"){console.log(" FILTER DEBUG: Applying paraeducator filter for:",b.paraeducator);const m=o.value[b.paraeducator];if(m){console.log(" FILTER DEBUG: Found aide data:",m);let T=[];m.studentIds&&Array.isArray(m.studentIds)?(T=m.studentIds,console.log(" FILTER DEBUG: Using studentIds array:",T)):m.directAssignment&&(T=Array.isArray(m.directAssignment)?m.directAssignment:[m.directAssignment],console.log(" FILTER DEBUG: Using directAssignment as fallback:",T)),E=E.filter(_=>T.includes(_.id)),console.log(" FILTER DEBUG: After paraeducator filter:",E.length,"students")}else console.log(" FILTER DEBUG: No aide data found for:",b.paraeducator),E=[]}b.plan&&b.plan!=="all"&&(E=E.filter(m=>it(m,"plan")===b.plan)),b.sortBy&&E.sort((m,T)=>{const _=it(m,b.sortBy)||"",A=it(T,b.sortBy)||"";if(["reviewDate","reevalDate","meetingDate"].includes(b.sortBy)){const k=_?new Date(_).getTime():0,U=A?new Date(A).getTime():0;return k-U}return _.toString().toLowerCase().localeCompare(A.toString().toLowerCase())}),c.value=E,console.log(" FILTER DEBUG: applyFilters completed. filteredStudents.value.length:",c.value.length)};return Vt(()=>[e.value,r.value],()=>{console.log(" FILTER DEBUG: Watcher triggered. students.value.length:",e.value.length),e.value.length>0?(console.log(" FILTER DEBUG: Calling applyFilters from watcher"),y()):console.log(" FILTER DEBUG: No students to filter")},{deep:!0}),{showFilters:l,filteredStudents:c,currentFilters:u,toggleFilters:p,clearFilters:v,applyFilters:y,debouncedApplyFilters:h,getCurrentFilters:g}}const C0={grades:[],classServices:[{name:"SDC",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"Co-teach",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"RSP",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"Directed Studies",subcategories:["Directed Studies"],enabledSubcategories:["Directed Studies"]},{name:"FA",subcategories:["FA"],enabledSubcategories:["FA"]}],sdcSubcategories:[],customClassServices:[],serviceProviders:["SLP","OT","PT","SC","MH","TR","AUD","VI","AT","DHH","O&M","BIS","HN","SW"],customServiceProviders:[],numPeriods:7,periodLabels:["1","2","3","4","5","6","sh"]},Js=se({...C0}),Sa=se(!1),Bi=se(null);let cu=!1;function qs(){const t=Ze(qe,"app_settings","global"),e=async()=>{if(Sa.value)return new Promise(s=>{const i=Vt(Sa,a=>{a||(i(),s(Js.value))})});if(cu&&!Bi.value)return Js.value;Sa.value=!0,Bi.value=null;try{const s=await nr(t);return s.exists()?(Js.value=s.data(),console.log("useAppSettings: Loaded existing settings:",Js.value)):(Js.value={...C0},console.log("useAppSettings: No existing settings, using defaults:",Js.value)),cu=!0,Js.value}catch(s){throw Bi.value=s.message,console.error("useAppSettings: Error loading settings:",s),s}finally{Sa.value=!1}},r=async s=>{Sa.value=!0,Bi.value=null;try{console.log("useAppSettings: Saving settings:",s),await Ht(t,s),console.log("useAppSettings: Settings saved successfully"),Js.value={...s},cu=!0}catch(i){throw Bi.value=i.message,console.error("useAppSettings: Error saving settings:",i),i}finally{Sa.value=!1}},n=async()=>{Sa.value=!0,Bi.value=null;try{await Ht(t,{...C0}),Js.value={...C0},cu=!0}catch(s){throw Bi.value=s.message,s}finally{Sa.value=!1}};return!cu&&!Sa.value&&e(),Vt(Js,s=>{console.log("appSettings changed:",s)},{deep:!0}),{appSettings:Js,loadAppSettings:e,saveAppSettings:r,resetAppSettings:n,loading:Sa,error:Bi}}function xo(){const{appSettings:t}=qs(),e=be(()=>{var l,c,u,f;if(console.log(" usePeriodLabels: appSettings.value:",t.value),console.log(" usePeriodLabels: periodLabels:",(l=t.value)==null?void 0:l.periodLabels),console.log(" usePeriodLabels: numPeriods:",(c=t.value)==null?void 0:c.numPeriods),(u=t.value)!=null&&u.periodLabels&&((f=t.value)!=null&&f.numPeriods)){const h=t.value.periodLabels.slice(0,t.value.numPeriods);return console.log(" usePeriodLabels: returning labels:",h),h}const o=["1","2","3","4","5","6","7"];return console.log(" usePeriodLabels: returning fallback labels:",o),o}),r=o=>{const l=parseInt(o);if(!l||l<1)return`Period ${o}`;const c=l-1,u=e.value[c]||`Period ${l}`;return console.log(` getLabel(${o}) -> "${u}" (index: ${c}, labels:`,e.value,")"),u},n=o=>{const l=e.value.findIndex(c=>c===o);return l!==-1?l+1:null},s=be(()=>{var l;const o=((l=t.value)==null?void 0:l.numPeriods)||7;return Array.from({length:o},(c,u)=>u+1)}),i=be(()=>{const o={};return e.value.forEach((l,c)=>{o[l]=c+1}),o}),a=be(()=>{const o={};return e.value.forEach((l,c)=>{o[c+1]=l}),o});return{labels:e,getLabel:r,getNumber:n,numericPeriods:s,labelToNumberMap:i,numberToLabelMap:a}}function dI(t,e){const{students:r,userMapObj:n,currentUser:s,getCaseManagerId:i,getSchedule:a,getUserName:o,formatDate:l}=t,{getLabel:c}=xo(),{filteredStudents:u,currentFilters:f,applyFilters:h}=e,p=(L,R)=>{if(!L)return{periods:{},isTeacher:!1,isCoTeacher:!1};let F=!1,N=!1;const M={};return Object.entries(L).forEach(([z,G])=>{const H=typeof G=="string"?G:G==null?void 0:G.teacherId,j=typeof G=="object"?G==null?void 0:G.coTeaching:null,K=j==null?void 0:j.caseManagerId;M[z]={teacherId:H,coTeaching:j,coTeachingCM:K,teacherName:o(H),coTeacherName:K?o(K):null,label:c(z)},H===R&&(F=!0),K===R&&(N=!0)}),{periods:M,isTeacher:F,isCoTeacher:N}},v=(L,R,F)=>{if(!L||!R)return[];switch(F){case"case_manager":return L.filter(N=>i(N)===R);case"service_provider":return L.filter(N=>{const M=a(N);return M?Object.values(M).some(G=>{var H;return typeof G=="string"?G===R:G&&typeof G=="object"?G.teacherId===R||((H=G.coTeaching)==null?void 0:H.caseManagerId)===R:!1}):!1});case"all":return L;default:return console.warn(`Unknown provider view: ${F}`),[]}},g=(L,R)=>!L||!R?[]:L.filter(F=>{const{isTeacher:N,isCoTeacher:M}=p(a(F),R);return N||M}),y=(L,R)=>{const F={};return L.forEach(N=>{const M=a(N);if(!M)return;const{periods:z}=p(M,R);Object.entries(z).forEach(([G,H])=>{(H.teacherId===R||H.coTeachingCM===R)&&(F[G]||(F[G]=[]),F[G].push(N))})}),F},b=be(()=>u.value||[]),E=L=>{const R=it(L,"firstName"),F=it(L,"lastName");return`${R} ${F}`},x=L=>({name:E(L),grade:it(L,"grade"),plan:it(L,"plan"),caseManager:o(i(L))}),I=L=>({reviewDate:l(it(L,"reviewDate")),reevalDate:l(it(L,"reevalDate")),meetingDate:l(it(L,"meetingDate"))}),D=L=>{const R=a(L);return R?Object.entries(R).reduce((F,[N,M])=>(F[N]={teacherId:M,teacherName:o(M)},F),{}):{}},P=L=>{f.search=L,h()},w=L=>{f.cm=L,h()},S=L=>{f.teacher=L,h()},m=L=>{f.viewMode=L,h()},T=be(()=>{const L={};return b.value.forEach(R=>{const F=it(R,"grade");L[F]||(L[F]=[]),L[F].push(R)}),L}),_=be(()=>{const L={};return b.value.forEach(R=>{const F=it(R,"plan");L[F]||(L[F]=[]),L[F].push(R)}),L}),A=be(()=>{var F;const L=(F=s.value)==null?void 0:F.role,R=f;return["teacher","paraeducator"].includes(L)?!1:L==="case_manager"||["sped_chair","admin_504","administrator_504_CM"].includes(L)?R.providerView!=="service_provider"&&R.teacher==="all":["admin","school_admin","staff_view","staff_edit","administrator"].includes(L)?R.teacher==="all"&&R.paraeducator==="all":L==="service_provider"?R.providerView!=="service_provider":!0}),k=be(()=>{var R;const L=(R=s.value)==null?void 0:R.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(L)}),U=be(()=>{var R;const L=(R=s.value)==null?void 0:R.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(L)});return Vt(()=>A.value,L=>{L&&f.viewMode==="class"&&(console.log(" Auto-switching from class view to list view because class view is now disabled"),f.viewMode="list",h())},{immediate:!1}),{visibleStudents:b,currentUser:s,userMapObj:n,standardizeScheduleAccess:p,getProviderViewStudents:v,getClassViewStudents:g,groupStudentsByPeriod:y,groupStudentsByGrade:T,groupStudentsByPlan:_,canAccessFilters:U,isClassViewDisabled:A,isAdminRole:k,formatStudentName:E,formatStudentInfo:x,formatDates:I,getStudentSchedule:D,filterByName:P,filterByCaseManager:w,filterByTeacher:S,setViewMode:m,currentFilters:f,showProviderView:!1,providerViewOptions:be(()=>[])}}const Wt={ADMIN:"admin",SCHOOL_ADMIN:"school_admin",ADMIN_504:"admin_504",SPED_CHAIR:"sped_chair",STAFF_VIEW:"staff_view",STAFF_EDIT:"staff_edit",CASE_MANAGER:"case_manager",TEACHER:"teacher",SERVICE_PROVIDER:"service_provider",PARAEDUCATOR:"paraeducator"},X7={[Wt.ADMIN]:100,[Wt.SCHOOL_ADMIN]:90,[Wt.SPED_CHAIR]:80,[Wt.ADMIN_504]:70,[Wt.STAFF_EDIT]:65,[Wt.CASE_MANAGER]:60,[Wt.SERVICE_PROVIDER]:50,[Wt.STAFF_VIEW]:45,[Wt.TEACHER]:40,[Wt.PARAEDUCATOR]:30},yt={CAN_VIEW_ALL_STUDENTS:"canViewAllStudents",CAN_EDIT_ALL_STUDENTS:"canEditAllStudents",CAN_EDIT_OWN_STUDENTS:"canEditOwnStudents",CAN_SEND_FEEDBACK:"canSendFeedback",CAN_MANAGE_USERS:"canManageUsers",CAN_MANAGE_AIDES:"canManageAides",CAN_ACCESS_TESTING:"canAccessTesting",CAN_ACCESS_FILTERS:"canAccessFilters",SHOW_PROVIDER_VIEW:"showProviderView",CAN_USE_CLASS_VIEW:"canUseClassView"},Y7={[Wt.ADMIN]:[yt.CAN_VIEW_ALL_STUDENTS,yt.CAN_EDIT_ALL_STUDENTS,yt.CAN_SEND_FEEDBACK,yt.CAN_MANAGE_USERS,yt.CAN_MANAGE_AIDES,yt.CAN_ACCESS_TESTING,yt.CAN_ACCESS_FILTERS,yt.SHOW_PROVIDER_VIEW,yt.CAN_USE_CLASS_VIEW],[Wt.ADMINISTRATOR]:[yt.CAN_VIEW_ALL_STUDENTS,yt.CAN_EDIT_ALL_STUDENTS,yt.CAN_SEND_FEEDBACK,yt.CAN_MANAGE_USERS,yt.CAN_MANAGE_AIDES,yt.CAN_ACCESS_TESTING,yt.CAN_ACCESS_FILTERS,yt.SHOW_PROVIDER_VIEW,yt.CAN_USE_CLASS_VIEW],[Wt.SPED_CHAIR]:[yt.CAN_VIEW_ALL_STUDENTS,yt.CAN_EDIT_ALL_STUDENTS,yt.CAN_SEND_FEEDBACK,yt.CAN_MANAGE_AIDES,yt.CAN_ACCESS_TESTING,yt.CAN_ACCESS_FILTERS,yt.SHOW_PROVIDER_VIEW,yt.CAN_USE_CLASS_VIEW],[Wt.ADMINISTRATOR_504_CM]:[yt.CAN_VIEW_ALL_STUDENTS,yt.CAN_EDIT_OWN_STUDENTS,yt.CAN_SEND_FEEDBACK,yt.CAN_MANAGE_USERS,yt.CAN_ACCESS_TESTING,yt.CAN_ACCESS_FILTERS,yt.SHOW_PROVIDER_VIEW,yt.CAN_USE_CLASS_VIEW],[Wt.CASE_MANAGER]:[yt.CAN_EDIT_OWN_STUDENTS,yt.CAN_SEND_FEEDBACK,yt.CAN_ACCESS_TESTING,yt.SHOW_PROVIDER_VIEW,yt.CAN_USE_CLASS_VIEW],[Wt.TEACHER]:[yt.CAN_ACCESS_TESTING,yt.CAN_USE_CLASS_VIEW],[Wt.SERVICE_PROVIDER]:[yt.CAN_EDIT_ALL_STUDENTS,yt.CAN_ACCESS_TESTING,yt.SHOW_PROVIDER_VIEW,yt.CAN_USE_CLASS_VIEW],[Wt.PARAEDUCATOR]:[yt.CAN_ACCESS_TESTING,yt.CAN_USE_CLASS_VIEW]},Q7={[Wt.SPED_CHAIR]:[{value:"all_iep",label:"*"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"},{value:"all",label:"All"}],[Wt.ADMINISTRATOR_504_CM]:[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}],admin_504:[{value:"all_iep",label:"*"},{value:"case_manager",label:"CM"}],[Wt.CASE_MANAGER]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}],[Wt.SERVICE_PROVIDER]:[{value:"all",label:"All"},{value:"service_provider",label:"SP"}]},J7={[Wt.SPED_CHAIR]:"all",[Wt.ADMINISTRATOR_504_CM]:"case_manager",admin_504:"case_manager",[Wt.CASE_MANAGER]:"all",[Wt.SERVICE_PROVIDER]:"service_provider"},Z7={[Wt.CASE_MANAGER]:{patterns:["case_manager","teacher"],description:"Students in their caseload and students they provide services to"},[Wt.TEACHER]:{patterns:["teacher"],description:"Students in their classes"},[Wt.SERVICE_PROVIDER]:{patterns:["teacher"],description:"Students in their classes"},[Wt.PARAEDUCATOR]:{patterns:["paraeducator"],description:"Students they are assigned to assist"},[Wt.SPED_CHAIR]:{patterns:["case_manager","teacher","all_iep"],description:"All students, with special access to IEP students"},[Wt.ADMINISTRATOR_504_CM]:{patterns:["case_manager","all_iep_504"],description:"All students, with special access to IEP/504 students"},[Wt.ADMIN]:{patterns:["all"],description:"All students"},[Wt.ADMINISTRATOR]:{patterns:["all"],description:"All students"}},ka={case_manager:(t,e,r)=>r.getCaseManagerId(e)===t,teacher:(t,e,r)=>{const n=r.getSchedule(e);return n?Object.values(n).some(s=>{var i;return typeof s=="string"?s===t:s&&typeof s=="object"?s.teacherId===t||((i=s.coTeaching)==null?void 0:i.caseManagerId)===t:!1}):!1},paraeducator:(t,e,r)=>r?r.shouldAideSeeStudent(t,e):!1,all_iep:(t,e,r)=>it(e,"plan")==="IEP",all_iep_504:(t,e,r)=>{const n=it(e,"plan");return n==="IEP"||n==="504"},all:()=>!0},eU={[Wt.CASE_MANAGER]:{canSendFeedback:(t,e,r)=>r.getCaseManagerId(e)===t,description:"Can send feedback for students in their caseload"},[Wt.SPED_CHAIR]:{canSendFeedback:(t,e,r)=>{const n=r.getCaseManagerId(e)===t,s=ka.teacher(t,e,r),i=ka.all_iep(t,e,r);return n||s||i},description:"Can send feedback for students they case manage, teach, or have IEP"},[Wt.ADMINISTRATOR_504_CM]:{canSendFeedback:(t,e,r)=>{const n=r.getCaseManagerId(e)===t,s=ka.all_iep_504(t,e,r);return n||s},description:"Can send feedback for students they case manage or have IEP/504"},[Wt.ADMIN]:{canSendFeedback:()=>!0,description:"Can send feedback for all students"},[Wt.ADMINISTRATOR]:{canSendFeedback:()=>!0,description:"Can send feedback for all students"}},Un={hasPermission:(t,e)=>(Y7[t]||[]).includes(e),getProviderViewOptions:t=>Q7[t]||[],getDefaultProviderView:t=>J7[t]||"all",canAccessStudent:(t,e,r,n,s=null)=>{var a;return(((a=Z7[e])==null?void 0:a.patterns)||[]).some(o=>{const l=ka[o];return l?l(t,r,n,s):!1})},canSendFeedback:(t,e,r,n)=>{const s=eU[e];return s?s.canSendFeedback(t,r,n):!1},getRoleLevel:t=>X7[t]||0,hasHigherPrivileges:(t,e)=>Un.getRoleLevel(t)>Un.getRoleLevel(e)};function tU(t,e){const r=dI(t,e),n=be(()=>{var k;return(k=r.currentUser.value)==null?void 0:k.uid}),s=be(()=>{var k;return((k=r.currentUser.value)==null?void 0:k.role)||"guest"}),i=be(()=>Un.getProviderViewOptions(s.value));Vt(i,k=>{if(k.length>0){const U=Un.getDefaultProviderView(s.value);k.map(R=>R.value).includes(e.currentFilters.providerView)||(e.currentFilters.providerView=U,e.applyFilters())}},{immediate:!0});const a=be(()=>{if(!n.value)return[];const k=r.visibleStudents.value,U=e.currentFilters.providerView,L=s.value;switch(U){case"case_manager":return k.filter(R=>ka.case_manager(n.value,R,t));case"service_provider":return k.filter(R=>ka.teacher(n.value,R,t));case"all":return k.filter(R=>Un.canAccessStudent(n.value,L,R,t));case"iep_all":return L==="sped_chair"?k.filter(R=>ka.all_iep(n.value,R,t)):[];case"all_iep":return k.filter(R=>{const F=ka.case_manager(n.value,R,t),N=ka.teacher(n.value,R,t);return F||N});case"iep_504_all":return L==="administrator_504_CM"||L==="admin_504"?k.filter(R=>ka.all_iep_504(n.value,R,t)):[];default:return console.warn(`Unknown provider view: ${U}`),[]}}),o=be(()=>Un.hasPermission(s.value,yt.CAN_EDIT_ALL_STUDENTS)),l=be(()=>Un.hasPermission(s.value,yt.CAN_EDIT_OWN_STUDENTS)),c=be(()=>Un.hasPermission(s.value,yt.CAN_VIEW_ALL_STUDENTS)),u=be(()=>Un.hasPermission(s.value,yt.CAN_MANAGE_USERS)),f=be(()=>Un.hasPermission(s.value,yt.CAN_MANAGE_AIDES)),h=be(()=>Un.hasPermission(s.value,yt.CAN_ACCESS_TESTING)),p=be(()=>h.value),v=be(()=>h.value),g=be(()=>Un.hasPermission(s.value,yt.CAN_ACCESS_FILTERS)),y=be(()=>Un.hasPermission(s.value,yt.SHOW_PROVIDER_VIEW)),b=be(()=>Un.hasPermission(s.value,yt.CAN_USE_CLASS_VIEW)),E=k=>{var R,F;if(!n.value||!k)return!1;const U=s.value;return U==="paraeducator"||U==="teacher"?!1:U==="case_manager"?t.getCaseManagerId(k)===n.value:U==="service_provider"?(F=(R=k.app)==null?void 0:R.staffIds)==null?void 0:F.includes(n.value):["admin","school_admin","staff_edit","admin_504","sped_chair"].includes(U)},x=k=>!n.value||!k?!1:Un.canSendFeedback(n.value,s.value,k,t),I=be(()=>n.value?r.groupStudentsByPeriod(a.value,n.value):{}),D=k=>{if(k==="class"&&!b.value){e.currentFilters.viewMode="list";return}e.currentFilters.viewMode=k},P=be(()=>{if(s.value!=="teacher")return{instruction:[],assessment:[]};const k={instruction:[],assessment:[]};return a.value.forEach(U=>{var L,R,F,N;(R=(L=U.app)==null?void 0:L.accommodations)!=null&&R.instruction&&k.instruction.push(U),(N=(F=U.app)==null?void 0:F.accommodations)!=null&&N.assessment&&k.assessment.push(U)}),k}),w=be(()=>{if(s.value!=="teacher")return{};const k={};return a.value.forEach(U=>{var R;const L=((R=U.app)==null?void 0:R.providers)||{};Object.entries(L).forEach(([F,N])=>{N&&(k[N]||(k[N]={provider:t.getUserName(N),providerType:F,students:[]}),k[N].students.push(U))})}),k}),S=be(()=>s.value==="teacher"),m=be(()=>s.value==="teacher"),T=be(()=>s.value==="teacher"),_=be(()=>!1),A=be(()=>!1);return{...r,visibleStudents:a,studentsByPeriod:I,providerViewOptions:i,showProviderView:y,canEditAllStudents:o,canEditOwnStudents:l,canViewAllStudents:c,canManageUsers:u,canManageAides:f,canAccessTesting:h,canAccessTestingPartial:p,hasAnyTestingAccess:v,canAccessFilters:g,canUseClassView:b,canEditStudent:E,canSendFeedback:x,setViewMode:D,studentsByAccommodation:P,studentsByServiceProvider:w,canViewAccommodations:S,canViewBasicInfo:m,canViewServiceProviders:T,canViewDates:_,canEditStudents:A,currentRole:s,currentUserId:n}}function rU(t,e){const r=dI(t,e),n=be(()=>{var o;return(o=r.currentUser.value)==null?void 0:o.uid}),s=be(()=>[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}]);Vt(s,o=>{const l="case_manager";o.map(u=>u.value).includes(e.currentFilters.providerView)||(e.currentFilters.providerView=l,e.applyFilters())},{immediate:!0});const i=be(()=>{if(!n.value)return[];const o=r.visibleStudents.value;switch(e.currentFilters.providerView){case"case_manager":return r.getProviderViewStudents(o,n.value,"case_manager");case"iep_504_all":return o.filter(c=>{const u=it(c,"plan");return u==="IEP"||u==="504"});default:return[]}}),a=be(()=>n.value?r.groupStudentsByPeriod(i.value,n.value):{});return{...r,visibleStudents:i,studentsByPeriod:a,providerViewOptions:s,showProviderView:!0}}function nU(t,e){const{currentUser:r}=t;Wy();const n=be(()=>{var v;return((v=r.value)==null?void 0:v.role)||"guest"}),i=be(()=>{switch(n.value){case"admin_504":return rU(t,e);default:return tU(t,e)}}).value,a=be(()=>{var g;const v=(g=r.value)==null?void 0:g.role;return["admin","school_admin","staff_edit","sped_chair"].includes(v)}),o=be(()=>{var g;const v=(g=r.value)==null?void 0:g.role;return["case_manager","admin_504"].includes(v)}),l=be(()=>{var g;const v=(g=r.value)==null?void 0:g.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(v)}),c=be(()=>{var g;const v=(g=r.value)==null?void 0:g.role;return["admin","school_admin","admin_504","sped_chair"].includes(v)}),u=be(()=>{var g;const v=(g=r.value)==null?void 0:g.role;return["admin","school_admin","admin_504","sped_chair"].includes(v)}),f=be(()=>!0),h=be(()=>!0),p=be(()=>!0);return{...i,currentRole:n,canEditAllStudents:a,canEditOwnStudents:o,canViewAllStudents:l,canManageUsers:c,canManageAides:u,canAccessTesting:f,canAccessTestingPartial:h,hasAnyTestingAccess:p}}function sU(t){Object.entries(t).reduce((e,[r,n])=>(e[r]=n.length,e),{})}function aU(t,e,r=null){const{aideAssignment:n,getCaseManagerId:s,getSchedule:i,standardizeScheduleAccess:a,currentUser:o}=t,{filteredStudents:l,currentFilters:c,getCurrentFilters:u}=e,f=r||l,h=se("list");Vt(()=>c.viewMode,E=>{h.value=E||"list"});const p=be(()=>f.value.filter(E=>{var x,I,D,P;return((I=(x=E.app)==null?void 0:x.flags)==null?void 0:I.flag2)||((P=(D=E.app)==null?void 0:D.flags)==null?void 0:P.separateSetting)||E.separateSetting||E.flag2||!1})),v=be(()=>{var w,S;const E={};if(h.value!=="class")return E;const x=(w=o.value)==null?void 0:w.uid;if(!x)return console.log(" studentsByClass: No current user ID"),E;console.log(" studentsByClass: Current user ID:",x);const I=(S=t.currentUser.value)==null?void 0:S.role;let D;I==="case_manager"?(D=t.students.value,console.log(" studentsByClass: Case manager - using raw database students:",D.length)):(D=f.value,console.log(" studentsByClass: Other role - using provider-filtered students:",D.length));const P=u();return P.paraeducator&&P.paraeducator,D.forEach(m=>{var _,A;const T=i(m)||{};console.log(` studentsByClass full schedule for ${(A=(_=m.app)==null?void 0:_.studentData)==null?void 0:A.firstName}:`,T),Object.entries(T).forEach(([k,U])=>{var H,j,K;let L,R;if(typeof U=="string")L=U;else if(U&&typeof U=="object")L=U.teacherId,R=(H=U.coTeaching)==null?void 0:H.caseManagerId,U.coTeaching&&console.log(` studentsByClass coTeaching data for ${(K=(j=m.app)==null?void 0:j.studentData)==null?void 0:K.firstName} in period ${k}:`,U.coTeaching);else return;let F=!1;const N=u(),M=N.teacher&&N.teacher!=="all",z=N.paraeducator&&N.paraeducator!=="all";if(I==="paraeducator"){const ne=n.value[x];ne!=null&&ne.classAssignment&&ne.classAssignment[k]&&(F=(Array.isArray(ne.classAssignment[k])?ne.classAssignment[k]:[ne.classAssignment[k]]).includes(L))}else if(["admin","administrator"].includes(I))if(M)F=L===N.teacher||R===N.teacher;else if(z){const ne=n.value[N.paraeducator];ne!=null&&ne.classAssignment&&ne.classAssignment[k]&&(F=(Array.isArray(ne.classAssignment[k])?ne.classAssignment[k]:[ne.classAssignment[k]]).includes(L))}else F=!0;else F=L===x||R===x;!F||(E[k]||(E[k]=[]),E[k].some(ne=>ne.id===m.id))||E[k].push(m)})}),console.log(" studentsByClass: Final groups:",Object.keys(E).map(m=>`Period ${m}: ${E[m].length} students`)),sU(E),Object.keys(E).forEach(m=>{E[m].length===0&&delete E[m]}),Object.keys(E).sort((m,T)=>{const _=parseInt(m.replace(/\D/g,"")),A=parseInt(T.replace(/\D/g,""));return _-A}).reduce((m,T)=>(m[T]=E[T],m),{})}),g=be(()=>{var m,T;const E=u(),x=(m=t.currentUser.value)==null?void 0:m.role,I=(T=t.currentUser.value)==null?void 0:T.uid;let D=null;if(x==="paraeducator")D=I;else{if(!(E.paraeducator&&E.paraeducator!=="all"))return[];D=E.paraeducator}if(!D)return[];const P=n.value[D];if(!P||!P.directAssignment)return console.log(" directAssignmentStudents: No aide data or direct assignment for",D),[];const w=Array.isArray(P.directAssignment)?P.directAssignment:[P.directAssignment];console.log(" directAssignmentStudents: Direct student IDs:",w),console.log(" directAssignmentStudents: Available students:",f.value.length);const S=f.value.filter(_=>w.includes(_.id));return console.log(" directAssignmentStudents: Found direct assignment students:",S.length),S}),y=be(()=>{const E={};return f.value.forEach(x=>{const I=s(x);I&&(E[I]||(E[I]=[]),E[I].push(x))}),E});return{currentViewMode:h,studentsByClass:v,directAssignmentStudents:g,studentsByCaseManager:y,testingViewStudents:p,setViewMode:E=>{h.value=E,c.viewMode=E}}}function iU(t){const{router:e,fetchData:r}=t,n=se(null),s=se(null),i=se(!1),a=se(!1),o=se(!1),l=se(null),c=x=>{n.value=x},u=x=>{s.value=x},f=x=>{l.value=x,o.value=!0},h=()=>{console.log("Teacher feedback form sent successfully")},p=()=>{a.value=!1,r()},v=()=>{console.log("Student saved"),r()},g=()=>{e.push("/admin")},y=()=>{e.push("/aide-schedule")},b=async x=>{switch(x){case"add-student":a.value=!0;break;case"export":i.value=!0;break;case"print":window.print();break;case"admin":g();break;case"aide-schedule":y();break;case"logout":await E();break}},E=async()=>{try{const{useAuthStore:x}=await la(async()=>{const{useAuthStore:D}=await Promise.resolve().then(()=>cB);return{useAuthStore:D}},void 0);await x().logout(),e.push("/login")}catch(x){console.error("Logout failed:",x)}};return{editingStudentId:n,emailingStudentId:s,showExport:i,showAddStudent:a,showFeedbackDialog:o,feedbackStudentId:l,editStudent:c,emailStudent:u,handleTeacherFeedback:f,handleFormSent:h,handleStudentAdded:p,handleStudentSaved:v,navigateToAdmin:g,navigateToAideSchedule:y,handleNavAction:b,handleLogout:E}}const oU={class:"student-nav-menu"},lU=["title"],cU={class:"nav-content"},uU={class:"nav-section"},dU={class:"nav-buttons"},fU={key:0,class:"nav-section"},hU={class:"nav-buttons"},pU={key:1,class:"nav-section"},mU={class:"nav-buttons"},gU={class:"nav-section"},vU={class:"user-info"},yU={class:"user-details"},xU={key:0,class:"user-role"},EU={__name:"StudentNavMenu",props:{currentUser:{type:Object,default:null},isAdmin:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:e}){const r=t,n=e,s=be(()=>{var u;const c=(u=r.currentUser)==null?void 0:u.role;return c!=="paraeducator"&&c!=="teacher"}),i=se(!1);function a(){i.value=!i.value}function o(){i.value=!1}function l(c){n("action",c),o()}return(c,u)=>{var f,h,p,v;return O(),B("div",oU,[d("button",{onClick:a,class:Qe(["hamburger-btn",{active:i.value}]),title:i.value?"Close Menu":"Open Menu"},u[6]||(u[6]=[d("span",{class:"hamburger-line"},null,-1),d("span",{class:"hamburger-line"},null,-1),d("span",{class:"hamburger-line"},null,-1)]),10,lU),i.value?(O(),B("div",{key:0,class:"nav-overlay",onClick:o})):_e("",!0),d("div",{class:Qe(["nav-panel",{open:i.value}])},[d("div",{class:"nav-header"},[u[7]||(u[7]=d("h3",null,"Student Management",-1)),d("button",{onClick:o,class:"close-btn"},"")]),d("div",cU,[d("div",uU,[u[11]||(u[11]=d("h4",null,"Actions",-1)),d("div",dU,[s.value?(O(),B("button",{key:0,onClick:u[0]||(u[0]=g=>l("add-student")),class:"nav-btn primary"},u[8]||(u[8]=[d("span",null,"",-1),Ce(" Add Student ")]))):_e("",!0),d("button",{onClick:u[1]||(u[1]=g=>l("export")),class:"nav-btn"},u[9]||(u[9]=[d("span",null,"",-1),Ce(" Export ")])),d("button",{onClick:u[2]||(u[2]=g=>l("print")),class:"nav-btn print-btn"},u[10]||(u[10]=[d("span",null,"",-1),Ce(" Print ")]))])]),t.isAdmin?(O(),B("div",fU,[u[13]||(u[13]=d("h4",null,"Admin",-1)),d("div",hU,[d("button",{onClick:u[3]||(u[3]=g=>l("admin")),class:"nav-btn"},u[12]||(u[12]=[d("span",null,"",-1),Ce(" Admin Panel ")]))])])):_e("",!0),((f=t.currentUser)==null?void 0:f.role)==="paraeducator"?(O(),B("div",pU,[u[15]||(u[15]=d("h4",null,"Schedule",-1)),d("div",mU,[d("button",{onClick:u[4]||(u[4]=g=>l("aide-schedule")),class:"nav-btn"},u[14]||(u[14]=[d("span",null,"",-1),Ce(" My Schedule ")]))])])):_e("",!0),d("div",gU,[u[17]||(u[17]=d("h4",null,"User",-1)),d("div",vU,[d("div",yU,[d("strong",null,Y(((h=t.currentUser)==null?void 0:h.name)||((p=t.currentUser)==null?void 0:p.email)||"User"),1),(v=t.currentUser)!=null&&v.role?(O(),B("span",xU,"("+Y(t.currentUser.role)+")",1)):_e("",!0)]),d("button",{onClick:u[5]||(u[5]=g=>l("logout")),class:"nav-btn danger"},u[16]||(u[16]=[d("span",null,"",-1),Ce(" Logout ")]))])])])],2)])}}},_U=xt(EU,[["__scopeId","data-v-fd6a61ad"]]);function bU(t){const{appSettings:e,loadAppSettings:r,loading:n,error:s}=qs(),{getLabel:i}=xo();jt(async()=>{var A;try{console.log("StudentTable: Loading app settings..."),await r(),console.log("StudentTable: App settings loaded successfully"),t.studentData.students.value.length>0&&await tn.logStudentAccess("table_view","view",{studentCount:t.studentData.students.value.length,viewType:"student_table",hasFilters:(A=t.filterData)!=null&&A.currentFilters?Object.keys(t.filterData.currentFilters).length>0:!1})}catch(k){console.error("StudentTable: Error loading app settings:",k)}});const a=A=>{const k=t.userMap[A];return k&&(k.name||k.email)||A},o=A=>{const k=t.userMap[A];return k?k.initials?k.initials:k.name?k.name.split(" ").map(L=>L[0]).join("").toUpperCase():k.email?k.email[0].toUpperCase():"?":"?"},l=A=>{const k=t.userMap[A];if(!k)return A;if(k.name){const U=k.name.trim().split(" ");return U.length===1?U[0]:`${U[0][0]}. ${U.slice(1).join(" ")}`}return k.email?k.email[0].toUpperCase():A},c=A=>A?new Date(A).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",u=A=>{if(!A)return"";const k=new Date,U=new Date(A),L=Math.ceil((U-k)/(1e3*60*60*24));return L<=0?"flag-critical":L<=7?"flag-high":L<=14?"flag-medium":L<=21?"flag-mid":L<=28?"flag-low":L<=35?"flag-prep":""},f=A=>{if(!A)return"";const k=new Date,U=new Date(A),L=Math.ceil((U-k)/(1e3*60*60*24));return L<=0?"flag-critical":L<=7?"flag-high":L<=14?"flag-medium":L<=21?"flag-mid":L<=28?"flag-low":L<=60?"flag-prep-reeval":""},h=A=>u(it(A,"meetingDate")),p=A=>u(it(A,"reviewDate")),v=A=>f(it(A,"reevalDate")),g=A=>{var k,U;return((U=(k=A.app)==null?void 0:k.studentData)==null?void 0:U.caseManagerId)||A.caseManagerId||A.casemanager_id},y=(A,k)=>{var U,L;return((L=(U=A.app)==null?void 0:U.flags)==null?void 0:L[k])||A[k]||!1},b=A=>{var k;return((k=A.app)==null?void 0:k.flags)&&Object.values(A.app.flags).some(Boolean)||A.flag1||A.flag2},E=(A,k)=>{var L,R,F,N,M;console.log(" getDocumentUrl called with:",{studentId:A.id,type:k,appDocuments:(L=A.app)==null?void 0:L.documents,directUrl:A[`${k}Url`],underscoreUrl:A[`${k}_url`],appLevel:(R=A.app)==null?void 0:R[k]});const U=((N=(F=A.app)==null?void 0:F.documents)==null?void 0:N[k])||((M=A.app)==null?void 0:M[k])||A[k]||A[`${k}_url`]||null;return console.log(" getDocumentUrl result:",U),U&&U.includes(".enc")&&console.log(" Secure filename detected:",U),U},x=A=>{var k,U,L,R,F;if(A.schedule)return A.schedule;if((U=(k=A.app)==null?void 0:k.schedule)!=null&&U.periods)return A.app.schedule.periods;if((R=(L=A.aeries)==null?void 0:L.schedule)!=null&&R.periods)return A.aeries.schedule.periods;if((F=A.aeries)!=null&&F.schedule){const N={};return Object.entries(A.aeries.schedule).forEach(([M,z])=>{if(z&&z.teacherId){const G=parseInt(M.replace("period","")),H=i(G);let j=z.teacherId;if(t.userMap){let K=Object.values(t.userMap).find(ne=>ne.aeriesId===z.teacherId||ne.aeriesId===parseInt(z.teacherId)||ne.id===z.teacherId);if(K||(K=Object.values(t.userMap).find(ne=>{var he,le,fe,te;return((he=ne.aeriesId)==null?void 0:he.toString())===((le=z.teacherId)==null?void 0:le.toString())||((fe=ne.id)==null?void 0:fe.toString())===((te=z.teacherId)==null?void 0:te.toString())})),K&&K.name){const ne=K.name.split(" ");if(ne.length>=2){const he=ne[0],le=ne[ne.length-1];j=`${he.charAt(0)}. ${le}`}else j=K.name}else console.warn(`Teacher not found for ID: ${z.teacherId}`)}N[H]=j}}),Object.keys(N).length>0?N:null}return null},I=A=>{const k=[],U=x(A);return U&&Object.entries(U).forEach(([L,R])=>{if(R&&typeof R=="object"&&R.coTeaching){const F=R.coTeaching.subject;F&&k.push(`Co-teach: ${F}`)}}),k};return{appSettings:e,appSettingsLoading:n,appSettingsError:s,getUserName:a,getUserInitials:o,getUserInitialLastName:l,formatDate:c,getMeetingUrgencyClass:h,getReviewUrgencyClass:p,getReevalUrgencyClass:v,getCaseManagerId:g,getFlagValue:y,hasFlags:b,getDocumentUrl:E,getSchedule:x,getClassServices:A=>{var N,M;const k=((M=(N=A.app)==null?void 0:N.schedule)==null?void 0:M.classServices)||A.services||[],U=I(A),L=k.filter(z=>z&&z.startsWith&&z.startsWith("Co-teach:")),R=U.filter(z=>!L.includes(z)),F=[...k,...R];if(n.value)return Array.isArray(F)?F.filter(z=>typeof z=="string"&&z.includes(":")):[];if(s.value)return Array.isArray(F)?F.filter(z=>typeof z=="string"&&z.includes(":")):[];if(e.value&&e.value.classServices){const z=e.value.classServices.filter(G=>G.enabledSubcategories&&G.enabledSubcategories.length>0).map(G=>G.name);return Array.isArray(F)?F.filter(G=>{if(typeof G!="string"||!G.includes(":"))return!1;const H=G.split(":")[0];return z.includes(H)}):[]}return Array.isArray(F)?F.filter(z=>typeof z=="string"&&z.includes(":")):[]},getOtherServices:A=>{var U,L;const k=((L=(U=A.app)==null?void 0:U.schedule)==null?void 0:L.otherServices)||A.other_services||[];return Array.isArray(k)?k.filter(R=>!!R):[]},getCoTeachingServices:I,hasServiceProviders:A=>{var R;const k=((R=A.app)==null?void 0:R.providers)||{},U=Object.values(k).some(Boolean);if(n.value||s.value){const F=A.speechId||A.speech_id||A.mhId||A.mh_id||A.otId||A.ot_id||A.ptId||A.pt_id||A.scId||A.sc_id||A.trId||A.tr_id||A.audId||A.aud_id||A.viId||A.vi_id||A.atId||A.at_id||A.dhhId||A.dhh_id||A.omId||A.om_id||A.bisId||A.bis_id||A.hnId||A.hn_id||A.swId||A.sw_id;return U||F}let L=!1;if(e.value&&e.value.serviceProviders){const F=e.value.serviceProviders,N={SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"};L=F.some(M=>{const z=N[M];return A[z]||A[z.replace("Id","_id")]})}else L=A.speechId||A.speech_id||A.mhId||A.mh_id||A.otId||A.ot_id||A.ptId||A.pt_id||A.scId||A.sc_id||A.trId||A.tr_id||A.audId||A.aud_id||A.viId||A.vi_id||A.atId||A.at_id||A.dhhId||A.dhh_id||A.omId||A.om_id||A.bisId||A.bis_id||A.hnId||A.hn_id||A.swId||A.sw_id;return U||L},getServiceProviderId:(A,k)=>{var L,R;return((R=(L=A.app)==null?void 0:L.providers)==null?void 0:R[k])||A[k]||A[k.replace("Id","_id")]||null},getProviderFieldName:A=>({SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"})[A]||`${A.toLowerCase()}Id`,isDirectAssignment:A=>{if(!t.currentUser||t.currentUser.role!=="paraeducator")return!1;const k=t.currentUser.uid;let U=t.aideSchedule[k];if(!U){const L=Object.entries(t.userMap).find(([R,F])=>F.uid===k||F.email===t.currentUser.email);if(L){const[R]=L;U=t.aideSchedule[R]}}return(U==null?void 0:U.directAssignment)===A},formatListFromText:K7,getFlagClass:A=>{const k=A.toLowerCase();return k.includes("critical")?"flag-critical":k.includes("high")?"flag-high":k.includes("medium")?"flag-medium":k.includes("mid")?"flag-mid":k.includes("low")?"flag-low":k.includes("prep")?"flag-prep":"flag-low"},getPeriodLabel:i}}let Gf;const SU=new Uint8Array(16);function AU(){if(!Gf&&(Gf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Gf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Gf(SU)}const _n=[];for(let t=0;t<256;++t)_n.push((t+256).toString(16).slice(1));function TU(t,e=0){return _n[t[e+0]]+_n[t[e+1]]+_n[t[e+2]]+_n[t[e+3]]+"-"+_n[t[e+4]]+_n[t[e+5]]+"-"+_n[t[e+6]]+_n[t[e+7]]+"-"+_n[t[e+8]]+_n[t[e+9]]+"-"+_n[t[e+10]]+_n[t[e+11]]+_n[t[e+12]]+_n[t[e+13]]+_n[t[e+14]]+_n[t[e+15]]}const wU=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),j2={randomUUID:wU};function CU(t,e,r){if(j2.randomUUID&&!t)return j2.randomUUID();t=t||{};const n=t.random||(t.rng||AU)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,TU(n)}var $t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Xy(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var hI={exports:{}};function IU(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Im={exports:{}};const kU={},DU=Object.freeze(Object.defineProperty({__proto__:null,default:kU},Symbol.toStringTag,{value:"Module"})),PU=Xy(DU);var G2;function Zt(){return G2||(G2=1,function(t,e){(function(r,n){t.exports=n()})($t,function(){var r=r||function(n,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof $t<"u"&&$t.crypto&&(i=$t.crypto),!i&&typeof IU=="function")try{i=PU}catch{}var a=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function E(){}return function(x){var I;return E.prototype=x,I=new E,E.prototype=null,I}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(E){var x=o(this);return E&&x.mixIn(E),(!x.hasOwnProperty("init")||this.init===x.init)&&(x.init=function(){x.$super.init.apply(this,arguments)}),x.init.prototype=x,x.$super=this,x},create:function(){var E=this.extend();return E.init.apply(E,arguments),E},init:function(){},mixIn:function(E){for(var x in E)E.hasOwnProperty(x)&&(this[x]=E[x]);E.hasOwnProperty("toString")&&(this.toString=E.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=c.WordArray=u.extend({init:function(E,x){E=this.words=E||[],x!=s?this.sigBytes=x:this.sigBytes=E.length*4},toString:function(E){return(E||p).stringify(this)},concat:function(E){var x=this.words,I=E.words,D=this.sigBytes,P=E.sigBytes;if(this.clamp(),D%4)for(var w=0;w<P;w++){var S=I[w>>>2]>>>24-w%4*8&255;x[D+w>>>2]|=S<<24-(D+w)%4*8}else for(var m=0;m<P;m+=4)x[D+m>>>2]=I[m>>>2];return this.sigBytes+=P,this},clamp:function(){var E=this.words,x=this.sigBytes;E[x>>>2]&=4294967295<<32-x%4*8,E.length=n.ceil(x/4)},clone:function(){var E=u.clone.call(this);return E.words=this.words.slice(0),E},random:function(E){for(var x=[],I=0;I<E;I+=4)x.push(a());return new f.init(x,E)}}),h=l.enc={},p=h.Hex={stringify:function(E){for(var x=E.words,I=E.sigBytes,D=[],P=0;P<I;P++){var w=x[P>>>2]>>>24-P%4*8&255;D.push((w>>>4).toString(16)),D.push((w&15).toString(16))}return D.join("")},parse:function(E){for(var x=E.length,I=[],D=0;D<x;D+=2)I[D>>>3]|=parseInt(E.substr(D,2),16)<<24-D%8*4;return new f.init(I,x/2)}},v=h.Latin1={stringify:function(E){for(var x=E.words,I=E.sigBytes,D=[],P=0;P<I;P++){var w=x[P>>>2]>>>24-P%4*8&255;D.push(String.fromCharCode(w))}return D.join("")},parse:function(E){for(var x=E.length,I=[],D=0;D<x;D++)I[D>>>2]|=(E.charCodeAt(D)&255)<<24-D%4*8;return new f.init(I,x)}},g=h.Utf8={stringify:function(E){try{return decodeURIComponent(escape(v.stringify(E)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(E){return v.parse(unescape(encodeURIComponent(E)))}},y=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(E){typeof E=="string"&&(E=g.parse(E)),this._data.concat(E),this._nDataBytes+=E.sigBytes},_process:function(E){var x,I=this._data,D=I.words,P=I.sigBytes,w=this.blockSize,S=w*4,m=P/S;E?m=n.ceil(m):m=n.max((m|0)-this._minBufferSize,0);var T=m*w,_=n.min(T*4,P);if(T){for(var A=0;A<T;A+=w)this._doProcessBlock(D,A);x=D.splice(0,T),I.sigBytes-=_}return new f.init(x,_)},clone:function(){var E=u.clone.call(this);return E._data=this._data.clone(),E},_minBufferSize:0});c.Hasher=y.extend({cfg:u.extend(),init:function(E){this.cfg=this.cfg.extend(E),this.reset()},reset:function(){y.reset.call(this),this._doReset()},update:function(E){return this._append(E),this._process(),this},finalize:function(E){E&&this._append(E);var x=this._doFinalize();return x},blockSize:16,_createHelper:function(E){return function(x,I){return new E.init(I).finalize(x)}},_createHmacHelper:function(E){return function(x,I){return new b.HMAC.init(E,I).finalize(x)}}});var b=l.algo={};return l}(Math);return r})}(Im)),Im.exports}var km={exports:{}},W2;function Lp(){return W2||(W2=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){return function(n){var s=r,i=s.lib,a=i.Base,o=i.WordArray,l=s.x64={};l.Word=a.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=a.extend({init:function(c,u){c=this.words=c||[],u!=n?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,f=[],h=0;h<u;h++){var p=c[h];f.push(p.high),f.push(p.low)}return o.create(f,this.sigBytes)},clone:function(){for(var c=a.clone.call(this),u=c.words=this.words.slice(0),f=u.length,h=0;h<f;h++)u[h]=u[h].clone();return c}})}(),r})}(km)),km.exports}var Dm={exports:{}},z2;function RU(){return z2||(z2=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){return function(){if(typeof ArrayBuffer=="function"){var n=r,s=n.lib,i=s.WordArray,a=i.init,o=i.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],f=0;f<c;f++)u[f>>>2]|=l[f]<<24-f%4*8;a.call(this,u,c)}else a.apply(this,arguments)};o.prototype=i}}(),r.lib.WordArray})}(Dm)),Dm.exports}var Pm={exports:{}},K2;function FU(){return K2||(K2=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Utf16=a.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,f=[],h=0;h<u;h+=2){var p=c[h>>>2]>>>16-h%4*8&65535;f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,u=[],f=0;f<c;f++)u[f>>>1]|=l.charCodeAt(f)<<16-f%2*16;return i.create(u,c*2)}},a.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,f=[],h=0;h<u;h+=2){var p=o(c[h>>>2]>>>16-h%4*8&65535);f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,u=[],f=0;f<c;f++)u[f>>>1]|=o(l.charCodeAt(f)<<16-f%2*16);return i.create(u,c*2)}};function o(l){return l<<8&4278255360|l>>>8&16711935}}(),r.enc.Utf16})}(Pm)),Pm.exports}var Rm={exports:{}},q2;function pl(){return q2||(q2=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,f=this._map;l.clamp();for(var h=[],p=0;p<u;p+=3)for(var v=c[p>>>2]>>>24-p%4*8&255,g=c[p+1>>>2]>>>24-(p+1)%4*8&255,y=c[p+2>>>2]>>>24-(p+2)%4*8&255,b=v<<16|g<<8|y,E=0;E<4&&p+E*.75<u;E++)h.push(f.charAt(b>>>6*(3-E)&63));var x=f.charAt(64);if(x)for(;h.length%4;)h.push(x);return h.join("")},parse:function(l){var c=l.length,u=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var h=0;h<u.length;h++)f[u.charCodeAt(h)]=h}var p=u.charAt(64);if(p){var v=l.indexOf(p);v!==-1&&(c=v)}return o(l,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(l,c,u){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var v=u[l.charCodeAt(p-1)]<<p%4*2,g=u[l.charCodeAt(p)]>>>6-p%4*2,y=v|g;f[h>>>2]|=y<<24-h%4*8,h++}return i.create(f,h)}}(),r.enc.Base64})}(Rm)),Rm.exports}var Fm={exports:{}},X2;function NU(){return X2||(X2=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,f=l.sigBytes,h=c?this._safe_map:this._map;l.clamp();for(var p=[],v=0;v<f;v+=3)for(var g=u[v>>>2]>>>24-v%4*8&255,y=u[v+1>>>2]>>>24-(v+1)%4*8&255,b=u[v+2>>>2]>>>24-(v+2)%4*8&255,E=g<<16|y<<8|b,x=0;x<4&&v+x*.75<f;x++)p.push(h.charAt(E>>>6*(3-x)&63));var I=h.charAt(64);if(I)for(;p.length%4;)p.push(I);return p.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,f=c?this._safe_map:this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var p=0;p<f.length;p++)h[f.charCodeAt(p)]=p}var v=f.charAt(64);if(v){var g=l.indexOf(v);g!==-1&&(u=g)}return o(l,u,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function o(l,c,u){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var v=u[l.charCodeAt(p-1)]<<p%4*2,g=u[l.charCodeAt(p)]>>>6-p%4*2,y=v|g;f[h>>>2]|=y<<24-h%4*8,h++}return i.create(f,h)}}(),r.enc.Base64url})}(Fm)),Fm.exports}var Nm={exports:{}},Y2;function ml(){return Y2||(Y2=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[];(function(){for(var g=0;g<64;g++)c[g]=n.abs(n.sin(g+1))*4294967296|0})();var u=l.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(g,y){for(var b=0;b<16;b++){var E=y+b,x=g[E];g[E]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}var I=this._hash.words,D=g[y+0],P=g[y+1],w=g[y+2],S=g[y+3],m=g[y+4],T=g[y+5],_=g[y+6],A=g[y+7],k=g[y+8],U=g[y+9],L=g[y+10],R=g[y+11],F=g[y+12],N=g[y+13],M=g[y+14],z=g[y+15],G=I[0],H=I[1],j=I[2],K=I[3];G=f(G,H,j,K,D,7,c[0]),K=f(K,G,H,j,P,12,c[1]),j=f(j,K,G,H,w,17,c[2]),H=f(H,j,K,G,S,22,c[3]),G=f(G,H,j,K,m,7,c[4]),K=f(K,G,H,j,T,12,c[5]),j=f(j,K,G,H,_,17,c[6]),H=f(H,j,K,G,A,22,c[7]),G=f(G,H,j,K,k,7,c[8]),K=f(K,G,H,j,U,12,c[9]),j=f(j,K,G,H,L,17,c[10]),H=f(H,j,K,G,R,22,c[11]),G=f(G,H,j,K,F,7,c[12]),K=f(K,G,H,j,N,12,c[13]),j=f(j,K,G,H,M,17,c[14]),H=f(H,j,K,G,z,22,c[15]),G=h(G,H,j,K,P,5,c[16]),K=h(K,G,H,j,_,9,c[17]),j=h(j,K,G,H,R,14,c[18]),H=h(H,j,K,G,D,20,c[19]),G=h(G,H,j,K,T,5,c[20]),K=h(K,G,H,j,L,9,c[21]),j=h(j,K,G,H,z,14,c[22]),H=h(H,j,K,G,m,20,c[23]),G=h(G,H,j,K,U,5,c[24]),K=h(K,G,H,j,M,9,c[25]),j=h(j,K,G,H,S,14,c[26]),H=h(H,j,K,G,k,20,c[27]),G=h(G,H,j,K,N,5,c[28]),K=h(K,G,H,j,w,9,c[29]),j=h(j,K,G,H,A,14,c[30]),H=h(H,j,K,G,F,20,c[31]),G=p(G,H,j,K,T,4,c[32]),K=p(K,G,H,j,k,11,c[33]),j=p(j,K,G,H,R,16,c[34]),H=p(H,j,K,G,M,23,c[35]),G=p(G,H,j,K,P,4,c[36]),K=p(K,G,H,j,m,11,c[37]),j=p(j,K,G,H,A,16,c[38]),H=p(H,j,K,G,L,23,c[39]),G=p(G,H,j,K,N,4,c[40]),K=p(K,G,H,j,D,11,c[41]),j=p(j,K,G,H,S,16,c[42]),H=p(H,j,K,G,_,23,c[43]),G=p(G,H,j,K,U,4,c[44]),K=p(K,G,H,j,F,11,c[45]),j=p(j,K,G,H,z,16,c[46]),H=p(H,j,K,G,w,23,c[47]),G=v(G,H,j,K,D,6,c[48]),K=v(K,G,H,j,A,10,c[49]),j=v(j,K,G,H,M,15,c[50]),H=v(H,j,K,G,T,21,c[51]),G=v(G,H,j,K,F,6,c[52]),K=v(K,G,H,j,S,10,c[53]),j=v(j,K,G,H,L,15,c[54]),H=v(H,j,K,G,P,21,c[55]),G=v(G,H,j,K,k,6,c[56]),K=v(K,G,H,j,z,10,c[57]),j=v(j,K,G,H,_,15,c[58]),H=v(H,j,K,G,N,21,c[59]),G=v(G,H,j,K,m,6,c[60]),K=v(K,G,H,j,R,10,c[61]),j=v(j,K,G,H,w,15,c[62]),H=v(H,j,K,G,U,21,c[63]),I[0]=I[0]+G|0,I[1]=I[1]+H|0,I[2]=I[2]+j|0,I[3]=I[3]+K|0},_doFinalize:function(){var g=this._data,y=g.words,b=this._nDataBytes*8,E=g.sigBytes*8;y[E>>>5]|=128<<24-E%32;var x=n.floor(b/4294967296),I=b;y[(E+64>>>9<<4)+15]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,y[(E+64>>>9<<4)+14]=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,g.sigBytes=(y.length+1)*4,this._process();for(var D=this._hash,P=D.words,w=0;w<4;w++){var S=P[w];P[w]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}return D},clone:function(){var g=o.clone.call(this);return g._hash=this._hash.clone(),g}});function f(g,y,b,E,x,I,D){var P=g+(y&b|~y&E)+x+D;return(P<<I|P>>>32-I)+y}function h(g,y,b,E,x,I,D){var P=g+(y&E|b&~E)+x+D;return(P<<I|P>>>32-I)+y}function p(g,y,b,E,x,I,D){var P=g+(y^b^E)+x+D;return(P<<I|P>>>32-I)+y}function v(g,y,b,E,x,I,D){var P=g+(b^(y|~E))+x+D;return(P<<I|P>>>32-I)+y}s.MD5=o._createHelper(u),s.HmacMD5=o._createHmacHelper(u)}(Math),r.MD5})}(Nm)),Nm.exports}var Om={exports:{}},Q2;function pI(){return Q2||(Q2=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=s.Hasher,o=n.algo,l=[],c=o.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,f){for(var h=this._hash.words,p=h[0],v=h[1],g=h[2],y=h[3],b=h[4],E=0;E<80;E++){if(E<16)l[E]=u[f+E]|0;else{var x=l[E-3]^l[E-8]^l[E-14]^l[E-16];l[E]=x<<1|x>>>31}var I=(p<<5|p>>>27)+b+l[E];E<20?I+=(v&g|~v&y)+1518500249:E<40?I+=(v^g^y)+1859775393:E<60?I+=(v&g|v&y|g&y)-1894007588:I+=(v^g^y)-899497514,b=y,y=g,g=v<<30|v>>>2,v=p,p=I}h[0]=h[0]+p|0,h[1]=h[1]+v|0,h[2]=h[2]+g|0,h[3]=h[3]+y|0,h[4]=h[4]+b|0},_doFinalize:function(){var u=this._data,f=u.words,h=this._nDataBytes*8,p=u.sigBytes*8;return f[p>>>5]|=128<<24-p%32,f[(p+64>>>9<<4)+14]=Math.floor(h/4294967296),f[(p+64>>>9<<4)+15]=h,u.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});n.SHA1=a._createHelper(c),n.HmacSHA1=a._createHmacHelper(c)}(),r.SHA1})}(Om)),Om.exports}var Mm={exports:{}},J2;function Yy(){return J2||(J2=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[],u=[];(function(){function p(b){for(var E=n.sqrt(b),x=2;x<=E;x++)if(!(b%x))return!1;return!0}function v(b){return(b-(b|0))*4294967296|0}for(var g=2,y=0;y<64;)p(g)&&(y<8&&(c[y]=v(n.pow(g,1/2))),u[y]=v(n.pow(g,1/3)),y++),g++})();var f=[],h=l.SHA256=o.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(p,v){for(var g=this._hash.words,y=g[0],b=g[1],E=g[2],x=g[3],I=g[4],D=g[5],P=g[6],w=g[7],S=0;S<64;S++){if(S<16)f[S]=p[v+S]|0;else{var m=f[S-15],T=(m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3,_=f[S-2],A=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;f[S]=T+f[S-7]+A+f[S-16]}var k=I&D^~I&P,U=y&b^y&E^b&E,L=(y<<30|y>>>2)^(y<<19|y>>>13)^(y<<10|y>>>22),R=(I<<26|I>>>6)^(I<<21|I>>>11)^(I<<7|I>>>25),F=w+R+k+u[S]+f[S],N=L+U;w=P,P=D,D=I,I=x+F|0,x=E,E=b,b=y,y=F+N|0}g[0]=g[0]+y|0,g[1]=g[1]+b|0,g[2]=g[2]+E|0,g[3]=g[3]+x|0,g[4]=g[4]+I|0,g[5]=g[5]+D|0,g[6]=g[6]+P|0,g[7]=g[7]+w|0},_doFinalize:function(){var p=this._data,v=p.words,g=this._nDataBytes*8,y=p.sigBytes*8;return v[y>>>5]|=128<<24-y%32,v[(y+64>>>9<<4)+14]=n.floor(g/4294967296),v[(y+64>>>9<<4)+15]=g,p.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});s.SHA256=o._createHelper(h),s.HmacSHA256=o._createHmacHelper(h)}(Math),r.SHA256})}(Mm)),Mm.exports}var Lm={exports:{}},Z2;function OU(){return Z2||(Z2=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Yy())})($t,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.algo,o=a.SHA256,l=a.SHA224=o.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=o._doFinalize.call(this);return c.sigBytes-=4,c}});n.SHA224=o._createHelper(l),n.HmacSHA224=o._createHmacHelper(l)}(),r.SHA224})}(Lm)),Lm.exports}var Bm={exports:{}},eb;function mI(){return eb||(eb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Lp())})($t,function(r){return function(){var n=r,s=n.lib,i=s.Hasher,a=n.x64,o=a.Word,l=a.WordArray,c=n.algo;function u(){return o.create.apply(o,arguments)}var f=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],h=[];(function(){for(var v=0;v<80;v++)h[v]=u()})();var p=c.SHA512=i.extend({_doReset:function(){this._hash=new l.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(v,g){for(var y=this._hash.words,b=y[0],E=y[1],x=y[2],I=y[3],D=y[4],P=y[5],w=y[6],S=y[7],m=b.high,T=b.low,_=E.high,A=E.low,k=x.high,U=x.low,L=I.high,R=I.low,F=D.high,N=D.low,M=P.high,z=P.low,G=w.high,H=w.low,j=S.high,K=S.low,ne=m,he=T,le=_,fe=A,te=k,Z=U,xe=L,Q=R,q=F,J=N,pe=M,ge=z,ee=G,ie=H,ve=j,we=K,De=0;De<80;De++){var Te,ze,ke=h[De];if(De<16)ze=ke.high=v[g+De*2]|0,Te=ke.low=v[g+De*2+1]|0;else{var Ve=h[De-15],Ae=Ve.high,Ge=Ve.low,Ke=(Ae>>>1|Ge<<31)^(Ae>>>8|Ge<<24)^Ae>>>7,Ee=(Ge>>>1|Ae<<31)^(Ge>>>8|Ae<<24)^(Ge>>>7|Ae<<25),ye=h[De-2],Se=ye.high,Oe=ye.low,We=(Se>>>19|Oe<<13)^(Se<<3|Oe>>>29)^Se>>>6,ot=(Oe>>>19|Se<<13)^(Oe<<3|Se>>>29)^(Oe>>>6|Se<<26),gt=h[De-7],Et=gt.high,Ut=gt.low,pt=h[De-16],ct=pt.high,mt=pt.low;Te=Ee+Ut,ze=Ke+Et+(Te>>>0<Ee>>>0?1:0),Te=Te+ot,ze=ze+We+(Te>>>0<ot>>>0?1:0),Te=Te+mt,ze=ze+ct+(Te>>>0<mt>>>0?1:0),ke.high=ze,ke.low=Te}var Pt=q&pe^~q&ee,Mt=J&ge^~J&ie,Tr=ne&le^ne&te^le&te,ts=he&fe^he&Z^fe&Z,Pi=(ne>>>28|he<<4)^(ne<<30|he>>>2)^(ne<<25|he>>>7),hs=(he>>>28|ne<<4)^(he<<30|ne>>>2)^(he<<25|ne>>>7),bl=(q>>>14|J<<18)^(q>>>18|J<<14)^(q<<23|J>>>9),Ga=(J>>>14|q<<18)^(J>>>18|q<<14)^(J<<23|q>>>9),bo=f[De],nn=bo.high,So=bo.low,Rr=we+Ga,Fn=ve+bl+(Rr>>>0<we>>>0?1:0),Rr=Rr+Mt,Fn=Fn+Pt+(Rr>>>0<Mt>>>0?1:0),Rr=Rr+So,Fn=Fn+nn+(Rr>>>0<So>>>0?1:0),Rr=Rr+Te,Fn=Fn+ze+(Rr>>>0<Te>>>0?1:0),Sl=hs+ts,zc=Pi+Tr+(Sl>>>0<hs>>>0?1:0);ve=ee,we=ie,ee=pe,ie=ge,pe=q,ge=J,J=Q+Rr|0,q=xe+Fn+(J>>>0<Q>>>0?1:0)|0,xe=te,Q=Z,te=le,Z=fe,le=ne,fe=he,he=Rr+Sl|0,ne=Fn+zc+(he>>>0<Rr>>>0?1:0)|0}T=b.low=T+he,b.high=m+ne+(T>>>0<he>>>0?1:0),A=E.low=A+fe,E.high=_+le+(A>>>0<fe>>>0?1:0),U=x.low=U+Z,x.high=k+te+(U>>>0<Z>>>0?1:0),R=I.low=R+Q,I.high=L+xe+(R>>>0<Q>>>0?1:0),N=D.low=N+J,D.high=F+q+(N>>>0<J>>>0?1:0),z=P.low=z+ge,P.high=M+pe+(z>>>0<ge>>>0?1:0),H=w.low=H+ie,w.high=G+ee+(H>>>0<ie>>>0?1:0),K=S.low=K+we,S.high=j+ve+(K>>>0<we>>>0?1:0)},_doFinalize:function(){var v=this._data,g=v.words,y=this._nDataBytes*8,b=v.sigBytes*8;g[b>>>5]|=128<<24-b%32,g[(b+128>>>10<<5)+30]=Math.floor(y/4294967296),g[(b+128>>>10<<5)+31]=y,v.sigBytes=g.length*4,this._process();var E=this._hash.toX32();return E},clone:function(){var v=i.clone.call(this);return v._hash=this._hash.clone(),v},blockSize:1024/32});n.SHA512=i._createHelper(p),n.HmacSHA512=i._createHmacHelper(p)}(),r.SHA512})}(Bm)),Bm.exports}var Um={exports:{}},tb;function MU(){return tb||(tb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Lp(),mI())})($t,function(r){return function(){var n=r,s=n.x64,i=s.Word,a=s.WordArray,o=n.algo,l=o.SHA512,c=o.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});n.SHA384=l._createHelper(c),n.HmacSHA384=l._createHmacHelper(c)}(),r.SHA384})}(Um)),Um.exports}var $m={exports:{}},rb;function LU(){return rb||(rb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Lp())})($t,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.x64,c=l.Word,u=s.algo,f=[],h=[],p=[];(function(){for(var y=1,b=0,E=0;E<24;E++){f[y+5*b]=(E+1)*(E+2)/2%64;var x=b%5,I=(2*y+3*b)%5;y=x,b=I}for(var y=0;y<5;y++)for(var b=0;b<5;b++)h[y+5*b]=b+(2*y+3*b)%5*5;for(var D=1,P=0;P<24;P++){for(var w=0,S=0,m=0;m<7;m++){if(D&1){var T=(1<<m)-1;T<32?S^=1<<T:w^=1<<T-32}D&128?D=D<<1^113:D<<=1}p[P]=c.create(w,S)}})();var v=[];(function(){for(var y=0;y<25;y++)v[y]=c.create()})();var g=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var y=this._state=[],b=0;b<25;b++)y[b]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(y,b){for(var E=this._state,x=this.blockSize/2,I=0;I<x;I++){var D=y[b+2*I],P=y[b+2*I+1];D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,P=(P<<8|P>>>24)&16711935|(P<<24|P>>>8)&4278255360;var w=E[I];w.high^=P,w.low^=D}for(var S=0;S<24;S++){for(var m=0;m<5;m++){for(var T=0,_=0,A=0;A<5;A++){var w=E[m+5*A];T^=w.high,_^=w.low}var k=v[m];k.high=T,k.low=_}for(var m=0;m<5;m++)for(var U=v[(m+4)%5],L=v[(m+1)%5],R=L.high,F=L.low,T=U.high^(R<<1|F>>>31),_=U.low^(F<<1|R>>>31),A=0;A<5;A++){var w=E[m+5*A];w.high^=T,w.low^=_}for(var N=1;N<25;N++){var T,_,w=E[N],M=w.high,z=w.low,G=f[N];G<32?(T=M<<G|z>>>32-G,_=z<<G|M>>>32-G):(T=z<<G-32|M>>>64-G,_=M<<G-32|z>>>64-G);var H=v[h[N]];H.high=T,H.low=_}var j=v[0],K=E[0];j.high=K.high,j.low=K.low;for(var m=0;m<5;m++)for(var A=0;A<5;A++){var N=m+5*A,w=E[N],ne=v[N],he=v[(m+1)%5+5*A],le=v[(m+2)%5+5*A];w.high=ne.high^~he.high&le.high,w.low=ne.low^~he.low&le.low}var w=E[0],fe=p[S];w.high^=fe.high,w.low^=fe.low}},_doFinalize:function(){var y=this._data,b=y.words;this._nDataBytes*8;var E=y.sigBytes*8,x=this.blockSize*32;b[E>>>5]|=1<<24-E%32,b[(n.ceil((E+1)/x)*x>>>5)-1]|=128,y.sigBytes=b.length*4,this._process();for(var I=this._state,D=this.cfg.outputLength/8,P=D/8,w=[],S=0;S<P;S++){var m=I[S],T=m.high,_=m.low;T=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360,_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,w.push(_),w.push(T)}return new a.init(w,D)},clone:function(){for(var y=o.clone.call(this),b=y._state=this._state.slice(0),E=0;E<25;E++)b[E]=b[E].clone();return y}});s.SHA3=o._createHelper(g),s.HmacSHA3=o._createHmacHelper(g)}(Math),r.SHA3})}($m)),$m.exports}var Vm={exports:{}},nb;function BU(){return nb||(nb=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){/** @preserve
			(c) 2012 by Cdric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=a.create([0,1518500249,1859775393,2400959708,2840853838]),v=a.create([1352829926,1548603684,1836072691,2053994217,0]),g=l.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(P,w){for(var S=0;S<16;S++){var m=w+S,T=P[m];P[m]=(T<<8|T>>>24)&16711935|(T<<24|T>>>8)&4278255360}var _=this._hash.words,A=p.words,k=v.words,U=c.words,L=u.words,R=f.words,F=h.words,N,M,z,G,H,j,K,ne,he,le;j=N=_[0],K=M=_[1],ne=z=_[2],he=G=_[3],le=H=_[4];for(var fe,S=0;S<80;S+=1)fe=N+P[w+U[S]]|0,S<16?fe+=y(M,z,G)+A[0]:S<32?fe+=b(M,z,G)+A[1]:S<48?fe+=E(M,z,G)+A[2]:S<64?fe+=x(M,z,G)+A[3]:fe+=I(M,z,G)+A[4],fe=fe|0,fe=D(fe,R[S]),fe=fe+H|0,N=H,H=G,G=D(z,10),z=M,M=fe,fe=j+P[w+L[S]]|0,S<16?fe+=I(K,ne,he)+k[0]:S<32?fe+=x(K,ne,he)+k[1]:S<48?fe+=E(K,ne,he)+k[2]:S<64?fe+=b(K,ne,he)+k[3]:fe+=y(K,ne,he)+k[4],fe=fe|0,fe=D(fe,F[S]),fe=fe+le|0,j=le,le=he,he=D(ne,10),ne=K,K=fe;fe=_[1]+z+he|0,_[1]=_[2]+G+le|0,_[2]=_[3]+H+j|0,_[3]=_[4]+N+K|0,_[4]=_[0]+M+ne|0,_[0]=fe},_doFinalize:function(){var P=this._data,w=P.words,S=this._nDataBytes*8,m=P.sigBytes*8;w[m>>>5]|=128<<24-m%32,w[(m+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,P.sigBytes=(w.length+1)*4,this._process();for(var T=this._hash,_=T.words,A=0;A<5;A++){var k=_[A];_[A]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return T},clone:function(){var P=o.clone.call(this);return P._hash=this._hash.clone(),P}});function y(P,w,S){return P^w^S}function b(P,w,S){return P&w|~P&S}function E(P,w,S){return(P|~w)^S}function x(P,w,S){return P&S|w&~S}function I(P,w,S){return P^(w|~S)}function D(P,w){return P<<w|P>>>32-w}s.RIPEMD160=o._createHelper(g),s.HmacRIPEMD160=o._createHmacHelper(g)}(),r.RIPEMD160})}(Vm)),Vm.exports}var Hm={exports:{}},sb;function Qy(){return sb||(sb=1,function(t,e){(function(r,n){t.exports=n(Zt())})($t,function(r){(function(){var n=r,s=n.lib,i=s.Base,a=n.enc,o=a.Utf8,l=n.algo;l.HMAC=i.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=o.parse(u));var f=c.blockSize,h=f*4;u.sigBytes>h&&(u=c.finalize(u)),u.clamp();for(var p=this._oKey=u.clone(),v=this._iKey=u.clone(),g=p.words,y=v.words,b=0;b<f;b++)g[b]^=1549556828,y[b]^=909522486;p.sigBytes=v.sigBytes=h,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,f=u.finalize(c);u.reset();var h=u.finalize(this._oKey.clone().concat(f));return h}})})()})}(Hm)),Hm.exports}var jm={exports:{}},ab;function UU(){return ab||(ab=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Yy(),Qy())})($t,function(r){return function(){var n=r,s=n.lib,i=s.Base,a=s.WordArray,o=n.algo,l=o.SHA256,c=o.HMAC,u=o.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,h){for(var p=this.cfg,v=c.create(p.hasher,f),g=a.create(),y=a.create([1]),b=g.words,E=y.words,x=p.keySize,I=p.iterations;b.length<x;){var D=v.update(h).finalize(y);v.reset();for(var P=D.words,w=P.length,S=D,m=1;m<I;m++){S=v.finalize(S),v.reset();for(var T=S.words,_=0;_<w;_++)P[_]^=T[_]}g.concat(D),E[0]++}return g.sigBytes=x*4,g}});n.PBKDF2=function(f,h,p){return u.create(p).compute(f,h)}}(),r.PBKDF2})}(jm)),jm.exports}var Gm={exports:{}},ib;function Eo(){return ib||(ib=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),pI(),Qy())})($t,function(r){return function(){var n=r,s=n.lib,i=s.Base,a=s.WordArray,o=n.algo,l=o.MD5,c=o.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,f){for(var h,p=this.cfg,v=p.hasher.create(),g=a.create(),y=g.words,b=p.keySize,E=p.iterations;y.length<b;){h&&v.update(h),h=v.update(u).finalize(f),v.reset();for(var x=1;x<E;x++)h=v.finalize(h),v.reset();g.concat(h)}return g.sigBytes=b*4,g}});n.EvpKDF=function(u,f,h){return c.create(h).compute(u,f)}}(),r.EvpKDF})}(Gm)),Gm.exports}var Wm={exports:{}},ob;function xn(){return ob||(ob=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),Eo())})($t,function(r){r.lib.Cipher||function(n){var s=r,i=s.lib,a=i.Base,o=i.WordArray,l=i.BufferedBlockAlgorithm,c=s.enc;c.Utf8;var u=c.Base64,f=s.algo,h=f.EvpKDF,p=i.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(T,_){return this.create(this._ENC_XFORM_MODE,T,_)},createDecryptor:function(T,_){return this.create(this._DEC_XFORM_MODE,T,_)},init:function(T,_,A){this.cfg=this.cfg.extend(A),this._xformMode=T,this._key=_,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(T){return this._append(T),this._process()},finalize:function(T){T&&this._append(T);var _=this._doFinalize();return _},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function T(_){return typeof _=="string"?m:P}return function(_){return{encrypt:function(A,k,U){return T(k).encrypt(_,A,k,U)},decrypt:function(A,k,U){return T(k).decrypt(_,A,k,U)}}}}()});i.StreamCipher=p.extend({_doFinalize:function(){var T=this._process(!0);return T},blockSize:1});var v=s.mode={},g=i.BlockCipherMode=a.extend({createEncryptor:function(T,_){return this.Encryptor.create(T,_)},createDecryptor:function(T,_){return this.Decryptor.create(T,_)},init:function(T,_){this._cipher=T,this._iv=_}}),y=v.CBC=function(){var T=g.extend();T.Encryptor=T.extend({processBlock:function(A,k){var U=this._cipher,L=U.blockSize;_.call(this,A,k,L),U.encryptBlock(A,k),this._prevBlock=A.slice(k,k+L)}}),T.Decryptor=T.extend({processBlock:function(A,k){var U=this._cipher,L=U.blockSize,R=A.slice(k,k+L);U.decryptBlock(A,k),_.call(this,A,k,L),this._prevBlock=R}});function _(A,k,U){var L,R=this._iv;R?(L=R,this._iv=n):L=this._prevBlock;for(var F=0;F<U;F++)A[k+F]^=L[F]}return T}(),b=s.pad={},E=b.Pkcs7={pad:function(T,_){for(var A=_*4,k=A-T.sigBytes%A,U=k<<24|k<<16|k<<8|k,L=[],R=0;R<k;R+=4)L.push(U);var F=o.create(L,k);T.concat(F)},unpad:function(T){var _=T.words[T.sigBytes-1>>>2]&255;T.sigBytes-=_}};i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:y,padding:E}),reset:function(){var T;p.reset.call(this);var _=this.cfg,A=_.iv,k=_.mode;this._xformMode==this._ENC_XFORM_MODE?T=k.createEncryptor:(T=k.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==T?this._mode.init(this,A&&A.words):(this._mode=T.call(k,this,A&&A.words),this._mode.__creator=T)},_doProcessBlock:function(T,_){this._mode.processBlock(T,_)},_doFinalize:function(){var T,_=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(_.pad(this._data,this.blockSize),T=this._process(!0)):(T=this._process(!0),_.unpad(T)),T},blockSize:128/32});var x=i.CipherParams=a.extend({init:function(T){this.mixIn(T)},toString:function(T){return(T||this.formatter).stringify(this)}}),I=s.format={},D=I.OpenSSL={stringify:function(T){var _,A=T.ciphertext,k=T.salt;return k?_=o.create([1398893684,1701076831]).concat(k).concat(A):_=A,_.toString(u)},parse:function(T){var _,A=u.parse(T),k=A.words;return k[0]==1398893684&&k[1]==1701076831&&(_=o.create(k.slice(2,4)),k.splice(0,4),A.sigBytes-=16),x.create({ciphertext:A,salt:_})}},P=i.SerializableCipher=a.extend({cfg:a.extend({format:D}),encrypt:function(T,_,A,k){k=this.cfg.extend(k);var U=T.createEncryptor(A,k),L=U.finalize(_),R=U.cfg;return x.create({ciphertext:L,key:A,iv:R.iv,algorithm:T,mode:R.mode,padding:R.padding,blockSize:T.blockSize,formatter:k.format})},decrypt:function(T,_,A,k){k=this.cfg.extend(k),_=this._parse(_,k.format);var U=T.createDecryptor(A,k).finalize(_.ciphertext);return U},_parse:function(T,_){return typeof T=="string"?_.parse(T,this):T}}),w=s.kdf={},S=w.OpenSSL={execute:function(T,_,A,k,U){if(k||(k=o.random(64/8)),U)var L=h.create({keySize:_+A,hasher:U}).compute(T,k);else var L=h.create({keySize:_+A}).compute(T,k);var R=o.create(L.words.slice(_),A*4);return L.sigBytes=_*4,x.create({key:L,iv:R,salt:k})}},m=i.PasswordBasedCipher=P.extend({cfg:P.cfg.extend({kdf:S}),encrypt:function(T,_,A,k){k=this.cfg.extend(k);var U=k.kdf.execute(A,T.keySize,T.ivSize,k.salt,k.hasher);k.iv=U.iv;var L=P.encrypt.call(this,T,_,U.key,k);return L.mixIn(U),L},decrypt:function(T,_,A,k){k=this.cfg.extend(k),_=this._parse(_,k.format);var U=k.kdf.execute(A,T.keySize,T.ivSize,_.salt,k.hasher);k.iv=U.iv;var L=P.decrypt.call(this,T,_,U.key,k);return L}})}()})}(Wm)),Wm.exports}var zm={exports:{}},lb;function $U(){return lb||(lb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.mode.CFB=function(){var n=r.lib.BlockCipherMode.extend();n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize;s.call(this,i,a,l,o),this._prevBlock=i.slice(a,a+l)}}),n.Decryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=i.slice(a,a+l);s.call(this,i,a,l,o),this._prevBlock=c}});function s(i,a,o,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var f=0;f<o;f++)i[a+f]^=c[f]}return n}(),r.mode.CFB})}(zm)),zm.exports}var Km={exports:{}},cb;function VU(){return cb||(cb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.mode.CTR=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var f=u.slice(0);o.encryptBlock(f,0),u[l-1]=u[l-1]+1|0;for(var h=0;h<l;h++)i[a+h]^=f[h]}});return n.Decryptor=s,n}(),r.mode.CTR})}(Km)),Km.exports}var qm={exports:{}},ub;function HU(){return ub||(ub=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return r.mode.CTRGladman=function(){var n=r.lib.BlockCipherMode.extend();function s(o){if((o>>24&255)===255){var l=o>>16&255,c=o>>8&255,u=o&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,o=0,o+=l<<16,o+=c<<8,o+=u}else o+=1<<24;return o}function i(o){return(o[0]=s(o[0]))===0&&(o[1]=s(o[1])),o}var a=n.Encryptor=n.extend({processBlock:function(o,l){var c=this._cipher,u=c.blockSize,f=this._iv,h=this._counter;f&&(h=this._counter=f.slice(0),this._iv=void 0),i(h);var p=h.slice(0);c.encryptBlock(p,0);for(var v=0;v<u;v++)o[l+v]^=p[v]}});return n.Decryptor=a,n}(),r.mode.CTRGladman})}(qm)),qm.exports}var Xm={exports:{}},db;function jU(){return db||(db=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.mode.OFB=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var f=0;f<l;f++)i[a+f]^=u[f]}});return n.Decryptor=s,n}(),r.mode.OFB})}(Xm)),Xm.exports}var Ym={exports:{}},fb;function GU(){return fb||(fb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.mode.ECB=function(){var n=r.lib.BlockCipherMode.extend();return n.Encryptor=n.extend({processBlock:function(s,i){this._cipher.encryptBlock(s,i)}}),n.Decryptor=n.extend({processBlock:function(s,i){this._cipher.decryptBlock(s,i)}}),n}(),r.mode.ECB})}(Ym)),Ym.exports}var Qm={exports:{}},hb;function WU(){return hb||(hb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.pad.AnsiX923={pad:function(n,s){var i=n.sigBytes,a=s*4,o=a-i%a,l=i+o-1;n.clamp(),n.words[l>>>2]|=o<<24-l%4*8,n.sigBytes+=o},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Ansix923})}(Qm)),Qm.exports}var Jm={exports:{}},pb;function zU(){return pb||(pb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.pad.Iso10126={pad:function(n,s){var i=s*4,a=i-n.sigBytes%i;n.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Iso10126})}(Jm)),Jm.exports}var Zm={exports:{}},mb;function KU(){return mb||(mb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.pad.Iso97971={pad:function(n,s){n.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(n,s)},unpad:function(n){r.pad.ZeroPadding.unpad(n),n.sigBytes--}},r.pad.Iso97971})}(Zm)),Zm.exports}var eg={exports:{}},gb;function qU(){return gb||(gb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.pad.ZeroPadding={pad:function(n,s){var i=s*4;n.clamp(),n.sigBytes+=i-(n.sigBytes%i||i)},unpad:function(n){for(var s=n.words,i=n.sigBytes-1,i=n.sigBytes-1;i>=0;i--)if(s[i>>>2]>>>24-i%4*8&255){n.sigBytes=i+1;break}}},r.pad.ZeroPadding})}(eg)),eg.exports}var tg={exports:{}},vb;function XU(){return vb||(vb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})}(tg)),tg.exports}var rg={exports:{}},yb;function YU(){return yb||(yb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),xn())})($t,function(r){return function(n){var s=r,i=s.lib,a=i.CipherParams,o=s.enc,l=o.Hex,c=s.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var f=l.parse(u);return a.create({ciphertext:f})}}}(),r.format.Hex})}(rg)),rg.exports}var ng={exports:{}},xb;function QU(){return xb||(xb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),pl(),ml(),Eo(),xn())})($t,function(r){return function(){var n=r,s=n.lib,i=s.BlockCipher,a=n.algo,o=[],l=[],c=[],u=[],f=[],h=[],p=[],v=[],g=[],y=[];(function(){for(var x=[],I=0;I<256;I++)I<128?x[I]=I<<1:x[I]=I<<1^283;for(var D=0,P=0,I=0;I<256;I++){var w=P^P<<1^P<<2^P<<3^P<<4;w=w>>>8^w&255^99,o[D]=w,l[w]=D;var S=x[D],m=x[S],T=x[m],_=x[w]*257^w*16843008;c[D]=_<<24|_>>>8,u[D]=_<<16|_>>>16,f[D]=_<<8|_>>>24,h[D]=_;var _=T*16843009^m*65537^S*257^D*16843008;p[w]=_<<24|_>>>8,v[w]=_<<16|_>>>16,g[w]=_<<8|_>>>24,y[w]=_,D?(D=S^x[x[x[T^S]]],P^=x[x[P]]):D=P=1}})();var b=[0,1,2,4,8,16,32,64,128,27,54],E=a.AES=i.extend({_doReset:function(){var x;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var I=this._keyPriorReset=this._key,D=I.words,P=I.sigBytes/4,w=this._nRounds=P+6,S=(w+1)*4,m=this._keySchedule=[],T=0;T<S;T++)T<P?m[T]=D[T]:(x=m[T-1],T%P?P>6&&T%P==4&&(x=o[x>>>24]<<24|o[x>>>16&255]<<16|o[x>>>8&255]<<8|o[x&255]):(x=x<<8|x>>>24,x=o[x>>>24]<<24|o[x>>>16&255]<<16|o[x>>>8&255]<<8|o[x&255],x^=b[T/P|0]<<24),m[T]=m[T-P]^x);for(var _=this._invKeySchedule=[],A=0;A<S;A++){var T=S-A;if(A%4)var x=m[T];else var x=m[T-4];A<4||T<=4?_[A]=x:_[A]=p[o[x>>>24]]^v[o[x>>>16&255]]^g[o[x>>>8&255]]^y[o[x&255]]}}},encryptBlock:function(x,I){this._doCryptBlock(x,I,this._keySchedule,c,u,f,h,o)},decryptBlock:function(x,I){var D=x[I+1];x[I+1]=x[I+3],x[I+3]=D,this._doCryptBlock(x,I,this._invKeySchedule,p,v,g,y,l);var D=x[I+1];x[I+1]=x[I+3],x[I+3]=D},_doCryptBlock:function(x,I,D,P,w,S,m,T){for(var _=this._nRounds,A=x[I]^D[0],k=x[I+1]^D[1],U=x[I+2]^D[2],L=x[I+3]^D[3],R=4,F=1;F<_;F++){var N=P[A>>>24]^w[k>>>16&255]^S[U>>>8&255]^m[L&255]^D[R++],M=P[k>>>24]^w[U>>>16&255]^S[L>>>8&255]^m[A&255]^D[R++],z=P[U>>>24]^w[L>>>16&255]^S[A>>>8&255]^m[k&255]^D[R++],G=P[L>>>24]^w[A>>>16&255]^S[k>>>8&255]^m[U&255]^D[R++];A=N,k=M,U=z,L=G}var N=(T[A>>>24]<<24|T[k>>>16&255]<<16|T[U>>>8&255]<<8|T[L&255])^D[R++],M=(T[k>>>24]<<24|T[U>>>16&255]<<16|T[L>>>8&255]<<8|T[A&255])^D[R++],z=(T[U>>>24]<<24|T[L>>>16&255]<<16|T[A>>>8&255]<<8|T[k&255])^D[R++],G=(T[L>>>24]<<24|T[A>>>16&255]<<16|T[k>>>8&255]<<8|T[U&255])^D[R++];x[I]=N,x[I+1]=M,x[I+2]=z,x[I+3]=G},keySize:256/32});n.AES=i._createHelper(E)}(),r.AES})}(ng)),ng.exports}var sg={exports:{}},Eb;function JU(){return Eb||(Eb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),pl(),ml(),Eo(),xn())})($t,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=s.BlockCipher,o=n.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=o.DES=a.extend({_doReset:function(){for(var b=this._key,E=b.words,x=[],I=0;I<56;I++){var D=l[I]-1;x[I]=E[D>>>5]>>>31-D%32&1}for(var P=this._subKeys=[],w=0;w<16;w++){for(var S=P[w]=[],m=u[w],I=0;I<24;I++)S[I/6|0]|=x[(c[I]-1+m)%28]<<31-I%6,S[4+(I/6|0)]|=x[28+(c[I+24]-1+m)%28]<<31-I%6;S[0]=S[0]<<1|S[0]>>>31;for(var I=1;I<7;I++)S[I]=S[I]>>>(I-1)*4+3;S[7]=S[7]<<5|S[7]>>>27}for(var T=this._invSubKeys=[],I=0;I<16;I++)T[I]=P[15-I]},encryptBlock:function(b,E){this._doCryptBlock(b,E,this._subKeys)},decryptBlock:function(b,E){this._doCryptBlock(b,E,this._invSubKeys)},_doCryptBlock:function(b,E,x){this._lBlock=b[E],this._rBlock=b[E+1],v.call(this,4,252645135),v.call(this,16,65535),g.call(this,2,858993459),g.call(this,8,16711935),v.call(this,1,1431655765);for(var I=0;I<16;I++){for(var D=x[I],P=this._lBlock,w=this._rBlock,S=0,m=0;m<8;m++)S|=f[m][((w^D[m])&h[m])>>>0];this._lBlock=w,this._rBlock=P^S}var T=this._lBlock;this._lBlock=this._rBlock,this._rBlock=T,v.call(this,1,1431655765),g.call(this,8,16711935),g.call(this,2,858993459),v.call(this,16,65535),v.call(this,4,252645135),b[E]=this._lBlock,b[E+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function v(b,E){var x=(this._lBlock>>>b^this._rBlock)&E;this._rBlock^=x,this._lBlock^=x<<b}function g(b,E){var x=(this._rBlock>>>b^this._lBlock)&E;this._lBlock^=x,this._rBlock^=x<<b}n.DES=a._createHelper(p);var y=o.TripleDES=a.extend({_doReset:function(){var b=this._key,E=b.words;if(E.length!==2&&E.length!==4&&E.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var x=E.slice(0,2),I=E.length<4?E.slice(0,2):E.slice(2,4),D=E.length<6?E.slice(0,2):E.slice(4,6);this._des1=p.createEncryptor(i.create(x)),this._des2=p.createEncryptor(i.create(I)),this._des3=p.createEncryptor(i.create(D))},encryptBlock:function(b,E){this._des1.encryptBlock(b,E),this._des2.decryptBlock(b,E),this._des3.encryptBlock(b,E)},decryptBlock:function(b,E){this._des3.decryptBlock(b,E),this._des2.encryptBlock(b,E),this._des1.decryptBlock(b,E)},keySize:192/32,ivSize:64/32,blockSize:64/32});n.TripleDES=a._createHelper(y)}(),r.TripleDES})}(sg)),sg.exports}var ag={exports:{}},_b;function ZU(){return _b||(_b=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),pl(),ml(),Eo(),xn())})($t,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=a.RC4=i.extend({_doReset:function(){for(var u=this._key,f=u.words,h=u.sigBytes,p=this._S=[],v=0;v<256;v++)p[v]=v;for(var v=0,g=0;v<256;v++){var y=v%h,b=f[y>>>2]>>>24-y%4*8&255;g=(g+p[v]+b)%256;var E=p[v];p[v]=p[g],p[g]=E}this._i=this._j=0},_doProcessBlock:function(u,f){u[f]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,f=this._i,h=this._j,p=0,v=0;v<4;v++){f=(f+1)%256,h=(h+u[f])%256;var g=u[f];u[f]=u[h],u[h]=g,p|=u[(u[f]+u[h])%256]<<24-v*8}return this._i=f,this._j=h,p}n.RC4=i._createHelper(o);var c=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});n.RC4Drop=i._createHelper(c)}(),r.RC4})}(ag)),ag.exports}var ig={exports:{}},bb;function e$(){return bb||(bb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),pl(),ml(),Eo(),xn())})($t,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=[],l=[],c=[],u=a.Rabbit=i.extend({_doReset:function(){for(var h=this._key.words,p=this.cfg.iv,v=0;v<4;v++)h[v]=(h[v]<<8|h[v]>>>24)&16711935|(h[v]<<24|h[v]>>>8)&4278255360;var g=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],y=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var v=0;v<4;v++)f.call(this);for(var v=0;v<8;v++)y[v]^=g[v+4&7];if(p){var b=p.words,E=b[0],x=b[1],I=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,D=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,P=I>>>16|D&4294901760,w=D<<16|I&65535;y[0]^=I,y[1]^=P,y[2]^=D,y[3]^=w,y[4]^=I,y[5]^=P,y[6]^=D,y[7]^=w;for(var v=0;v<4;v++)f.call(this)}},_doProcessBlock:function(h,p){var v=this._X;f.call(this),o[0]=v[0]^v[5]>>>16^v[3]<<16,o[1]=v[2]^v[7]>>>16^v[5]<<16,o[2]=v[4]^v[1]>>>16^v[7]<<16,o[3]=v[6]^v[3]>>>16^v[1]<<16;for(var g=0;g<4;g++)o[g]=(o[g]<<8|o[g]>>>24)&16711935|(o[g]<<24|o[g]>>>8)&4278255360,h[p+g]^=o[g]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,v=0;v<8;v++)l[v]=p[v];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var v=0;v<8;v++){var g=h[v]+p[v],y=g&65535,b=g>>>16,E=((y*y>>>17)+y*b>>>15)+b*b,x=((g&4294901760)*g|0)+((g&65535)*g|0);c[v]=E^x}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}n.Rabbit=i._createHelper(u)}(),r.Rabbit})}(ig)),ig.exports}var og={exports:{}},Sb;function t$(){return Sb||(Sb=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),pl(),ml(),Eo(),xn())})($t,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=[],l=[],c=[],u=a.RabbitLegacy=i.extend({_doReset:function(){var h=this._key.words,p=this.cfg.iv,v=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],g=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var y=0;y<4;y++)f.call(this);for(var y=0;y<8;y++)g[y]^=v[y+4&7];if(p){var b=p.words,E=b[0],x=b[1],I=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360,D=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,P=I>>>16|D&4294901760,w=D<<16|I&65535;g[0]^=I,g[1]^=P,g[2]^=D,g[3]^=w,g[4]^=I,g[5]^=P,g[6]^=D,g[7]^=w;for(var y=0;y<4;y++)f.call(this)}},_doProcessBlock:function(h,p){var v=this._X;f.call(this),o[0]=v[0]^v[5]>>>16^v[3]<<16,o[1]=v[2]^v[7]>>>16^v[5]<<16,o[2]=v[4]^v[1]>>>16^v[7]<<16,o[3]=v[6]^v[3]>>>16^v[1]<<16;for(var g=0;g<4;g++)o[g]=(o[g]<<8|o[g]>>>24)&16711935|(o[g]<<24|o[g]>>>8)&4278255360,h[p+g]^=o[g]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,v=0;v<8;v++)l[v]=p[v];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var v=0;v<8;v++){var g=h[v]+p[v],y=g&65535,b=g>>>16,E=((y*y>>>17)+y*b>>>15)+b*b,x=((g&4294901760)*g|0)+((g&65535)*g|0);c[v]=E^x}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}n.RabbitLegacy=i._createHelper(u)}(),r.RabbitLegacy})}(og)),og.exports}var lg={exports:{}},Ab;function r$(){return Ab||(Ab=1,function(t,e){(function(r,n,s){t.exports=n(Zt(),pl(),ml(),Eo(),xn())})($t,function(r){return function(){var n=r,s=n.lib,i=s.BlockCipher,a=n.algo;const o=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function f(y,b){let E=b>>24&255,x=b>>16&255,I=b>>8&255,D=b&255,P=y.sbox[0][E]+y.sbox[1][x];return P=P^y.sbox[2][I],P=P+y.sbox[3][D],P}function h(y,b,E){let x=b,I=E,D;for(let P=0;P<o;++P)x=x^y.pbox[P],I=f(y,x)^I,D=x,x=I,I=D;return D=x,x=I,I=D,I=I^y.pbox[o],x=x^y.pbox[o+1],{left:x,right:I}}function p(y,b,E){let x=b,I=E,D;for(let P=o+1;P>1;--P)x=x^y.pbox[P],I=f(y,x)^I,D=x,x=I,I=D;return D=x,x=I,I=D,I=I^y.pbox[1],x=x^y.pbox[0],{left:x,right:I}}function v(y,b,E){for(let w=0;w<4;w++){y.sbox[w]=[];for(let S=0;S<256;S++)y.sbox[w][S]=c[w][S]}let x=0;for(let w=0;w<o+2;w++)y.pbox[w]=l[w]^b[x],x++,x>=E&&(x=0);let I=0,D=0,P=0;for(let w=0;w<o+2;w+=2)P=h(y,I,D),I=P.left,D=P.right,y.pbox[w]=I,y.pbox[w+1]=D;for(let w=0;w<4;w++)for(let S=0;S<256;S+=2)P=h(y,I,D),I=P.left,D=P.right,y.sbox[w][S]=I,y.sbox[w][S+1]=D;return!0}var g=a.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var y=this._keyPriorReset=this._key,b=y.words,E=y.sigBytes/4;v(u,b,E)}},encryptBlock:function(y,b){var E=h(u,y[b],y[b+1]);y[b]=E.left,y[b+1]=E.right},decryptBlock:function(y,b){var E=p(u,y[b],y[b+1]);y[b]=E.left,y[b+1]=E.right},blockSize:64/32,keySize:128/32,ivSize:64/32});n.Blowfish=i._createHelper(g)}(),r.Blowfish})}(lg)),lg.exports}(function(t,e){(function(r,n,s){t.exports=n(Zt(),Lp(),RU(),FU(),pl(),NU(),ml(),pI(),Yy(),OU(),mI(),MU(),LU(),BU(),Qy(),UU(),Eo(),xn(),$U(),VU(),HU(),jU(),GU(),WU(),zU(),KU(),qU(),XU(),YU(),QU(),JU(),ZU(),e$(),t$(),r$())})($t,function(r){return r})})(hI);var n$=hI.exports;const qi=fI(n$);class s${constructor(){this.encryptionKey="your-dev-key-here"}async encryptAndUploadPdf(e,r){try{if(console.log(" Starting PDF encryption for student:",r),console.log(" File details:",{name:e.name,size:e.size,type:e.type}),(!this.encryptionKey||this.encryptionKey==="your-dev-key-here")&&console.warn(" Using default encryption key - set VITE_PDF_ENCRYPTION_KEY in production"),!St.currentUser)throw new Error("User not authenticated");if(console.log(" Current user:",St.currentUser.uid),r){console.log(" Checking student access for:",r);try{if(!(await nr(Ze(qe,"students",r))).exists())throw new Error(`Student ${r} not found`);console.log(" Student document exists")}catch(l){throw console.error(" Student access check failed:",l),new Error(`Student access check failed: ${l.message}`)}}console.log(" Reading file as ArrayBuffer...");const n=await e.arrayBuffer();console.log(" ArrayBuffer read, size:",n.byteLength),console.log(" Converting to Base64...");const s=btoa(new Uint8Array(n).reduce((l,c)=>l+String.fromCharCode(c),""));console.log(" Base64 conversion complete, length:",s.length),console.log(" Encrypting content...");const i=qi.AES.encrypt(s,this.encryptionKey).toString();console.log(" Encryption complete, length:",i.length);const a=`${CU()}.enc`;console.log(" Generated filename:",a),console.log(" Uploading to storage...");const o=mh(wc,`students/${r}/${a}`);return console.log(" Storage path:",`students/${r}/${a}`),await P4(o,i),console.log(" Upload to storage successful"),console.log(" Storing metadata in Firestore..."),await Ht(Ze(qe,"pdfMetadata",a),{originalName:e.name,studentId:r,uploadedBy:St.currentUser.uid,uploadedAt:wn(),accessCount:0,lastAccessed:null,encryptionVersion:"1.0",fileSize:e.size,mimeType:e.type}),console.log(" Metadata stored successfully"),a}catch(n){throw console.error(" PDF encryption failed:",n),console.error(" Error details:",{message:n.message,code:n.code,stack:n.stack}),new Error(`Failed to securely store PDF: ${n.message}`)}}async downloadAndDecryptPdf(e,r){try{if(console.log(" Starting secure PDF download process..."),console.log(" Verifying user access permissions..."),!await this.verifyAccess(r))throw new Error("Access denied");console.log(" Access permissions verified"),console.log(" Getting authentication token...");const{auth:s}=await la(async()=>{const{auth:h}=await Promise.resolve().then(()=>$4);return{auth:h}},void 0),i=await s.currentUser.getIdToken(),a=`https://downloadstudentfile-zr6j2ycwuq-uc.a.run.app/downloadStudentFile?studentId=${r}&fileName=${e}`;console.log(" Downloading encrypted file from secure storage...");const o=await fetch(a,{headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}});if(!o.ok)throw new Error(`Failed to fetch file: ${o.status} ${o.statusText}`);const l=await o.text();console.log(" Downloaded encrypted content, size:",l.length,"characters"),console.log(" Decrypting PDF content...");const c=qi.AES.decrypt(l,this.encryptionKey).toString(qi.enc.Utf8);console.log(" Converting to PDF format...");const u=atob(c),f=new Blob([new Uint8Array(u.split("").map(h=>h.charCodeAt(0)))],{type:"application/pdf"});return console.log(" PDF ready for viewing, size:",f.size,"bytes"),f}catch(n){throw console.error(" PDF download failed:",n),new Error("Failed to retrieve PDF: "+n.message)}}async verifyAccess(e){var r,n,s,i,a,o;try{const l=St.currentUser;if(!l)return!1;const u=(await nr(Ze(qe,"users",l.uid))).data();if(["admin","administrator","sped_chair"].includes(u.role))return!0;if(u.role==="case_manager")return((s=(n=(r=(await nr(Ze(qe,"students",e))).data())==null?void 0:r.app)==null?void 0:n.studentData)==null?void 0:s.caseManagerId)===l.uid;if(u.role==="teacher"){const h=((o=(a=(i=(await nr(Ze(qe,"students",e))).data())==null?void 0:i.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{};return Object.values(h).includes(l.uid)}return!1}catch(l){return console.error("Access verification failed:",l),!1}}async logAccess(e,r){try{await Ht(Ze(qe,"pdfAccessLogs",`${e}_${Date.now()}`),{fileId:e,studentId:r,userId:St.currentUser.uid,userEmail:St.currentUser.email,accessTime:wn(),userAgent:navigator.userAgent,accessType:"download"})}catch(n){console.error("Failed to log access:",n)}}async updateAccessMetadata(e){try{const r=Ze(qe,"pdfMetadata",e),n=await nr(r);n.exists()&&await Ht(r,{...n.data(),accessCount:(n.data().accessCount||0)+1,lastAccessed:wn()},{merge:!0})}catch(r){console.error("Failed to update access metadata:",r)}}async getFileAccessHistory(e){try{const r=or(_t(qe,"pdfAccessLogs"),Ur("fileId","==",e),hn("accessTime","desc"));return(await Gt(r)).docs.map(s=>s.data())}catch(r){return console.error("Failed to fetch access history:",r),[]}}}const I0=new s$;function Jy(){const t=se(!1),e=se(!1),r=se(null);return{uploadPdf:async(a,o)=>{t.value=!0,r.value=null;try{if(a.type!=="application/pdf")throw new Error("Only PDF files are allowed");if(a.size>10*1024*1024)throw new Error("File size must be less than 10MB");return await I0.encryptAndUploadPdf(a,o)}catch(l){throw r.value=l.message,l}finally{t.value=!1}},downloadPdf:async(a,o,l)=>{e.value=!0,r.value=null;try{const c=await I0.downloadAndDecryptPdf(a,o),u=window.URL.createObjectURL(c),f=window.open(u,"_blank","noopener,noreferrer");setTimeout(()=>{window.URL.revokeObjectURL(u)},5e3)}catch(c){throw r.value=c.message,c}finally{e.value=!1}},getAccessHistory:async a=>{try{return await I0.getFileAccessHistory(a)}catch(o){return r.value=o.message,[]}},isUploading:t,isDownloading:e,error:r}}const a$={class:"docs-item"},i$={key:0,class:"loading-spinner"},o$={key:0,class:"loading-spinner"},l$={__name:"StudentDocsCell",props:{student:{type:Object,required:!0},getDocumentUrl:{type:Function,required:!0}},setup(t){const e=t,{downloadPdf:r}=Jy(),n=se({ataglance:!1,bip:!1}),s=async(i,a)=>{var o,l,c,u;try{if(!i){alert("File not found.");return}n.value[a]=!0;const f=((l=(o=e.student.app)==null?void 0:o.documents)==null?void 0:l.bipFileName)||((u=(c=e.student.app)==null?void 0:c.documents)==null?void 0:u.ataglanceFileName)||"document.pdf";await r(i,e.student.id,f)}catch(f){console.error("Error opening secure file:",f),alert("Error opening file. Please try again.")}finally{n.value[a]=!1}};return(i,a)=>(O(),B("td",null,[d("div",a$,[t.getDocumentUrl(t.student,"ataglancePdfUrl")?(O(),B("a",{key:0,href:"#",onClick:a[0]||(a[0]=dn(o=>s(t.getDocumentUrl(t.student,"ataglancePdfUrl"),"ataglance"),["prevent"])),class:Qe(["doc-link",{loading:n.value.ataglance}])},[n.value.ataglance?(O(),B("div",i$,[Le(X(yh),{size:14,class:"spin"})])):(O(),tr(X(Mv),{key:1,size:16,class:"doc-icon"})),d("span",null,Y(n.value.ataglance?"Loading...":"At-A-Glance"),1)],2)):_e("",!0),t.getDocumentUrl(t.student,"bipPdfUrl")?(O(),B("a",{key:1,href:"#",onClick:a[1]||(a[1]=dn(o=>s(t.getDocumentUrl(t.student,"bipPdfUrl"),"bip"),["prevent"])),class:Qe(["doc-link",{loading:n.value.bip}])},[n.value.bip?(O(),B("div",o$,[Le(X(yh),{size:14,class:"spin"})])):(O(),tr(X(Mv),{key:1,size:16,class:"doc-icon"})),d("span",null,Y(n.value.bip?"Loading...":"BIP"),1)],2)):_e("",!0),!t.getDocumentUrl(t.student,"ataglancePdfUrl")&&!t.getDocumentUrl(t.student,"bipPdfUrl")?(O(),B(Fe,{key:2},[Ce("")],64)):_e("",!0)])]))}},c$=xt(l$,[["__scopeId","data-v-43590df2"]]),u$={class:"actions-cell"},d$={class:"actions-content"},f$={class:"action-buttons"},h$=["title"],p$={__name:"StudentActionsCell",props:{student:{type:Object,required:!0},currentUser:{type:Object,required:!1},studentData:{type:Object,required:!1},getUserName:{type:Function,required:!0},formatDate:{type:Function,required:!0}},emits:["edit","email","teacher-feedback"],setup(t,{emit:e}){const r=t,n=be(()=>{var o;return(o=r.student)!=null&&o.updatedBy?r.getUserName(r.student.updatedBy):null}),s=be(()=>{var o;if(!((o=r.student)!=null&&o.updatedAt))return"";try{let l="";r.student.updatedAt.seconds?l=new Date(r.student.updatedAt.seconds*1e3).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0}):l=new Date(r.student.updatedAt).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0});const c=n.value?` by ${n.value}`:"";return`Last Updated: ${l}${c}`}catch(l){console.warn("Error formatting date in tooltip:",l);const c=new Date(r.student.updatedAt.seconds*1e3),u=n.value?` by ${n.value}`:"";return`Last Updated: ${c.toLocaleDateString()}${u}`}}),i=be(()=>{var u,f,h,p,v;if(!((u=r.currentUser)!=null&&u.role)||!r.student)return!1;const o=r.currentUser.role,l=r.currentUser.uid;return o==="paraeducator"||o==="teacher"?!1:o==="case_manager"?((h=(f=r.student.app)==null?void 0:f.studentData)==null?void 0:h.caseManagerId)===l:o==="service_provider"?(v=(p=r.student.app)==null?void 0:p.staffIds)==null?void 0:v.includes(l):["admin","school_admin","staff_edit","admin_504","sped_chair"].includes(o)}),a=be(()=>{var o;return!((o=r.currentUser)!=null&&o.role)||!r.student||!r.studentData?!1:Un.canSendFeedback(r.currentUser.uid,r.currentUser.role,r.student,r.studentData)});return(o,l)=>{var c;return O(),B("td",u$,[d("div",d$,[d("div",f$,[i.value?(O(),B("button",{key:0,class:"edit-btn",onClick:l[0]||(l[0]=u=>o.$emit("edit",t.student.id)),title:"Edit Student"},[Le(X(l7),{size:16})])):_e("",!0),d("button",{class:"email-btn",onClick:l[1]||(l[1]=u=>o.$emit("email",t.student.id)),title:"Email Student"},[Le(X(t7),{size:16})]),a.value?(O(),B("button",{key:1,class:"teacher-feedback-btn",onClick:l[2]||(l[2]=u=>o.$emit("teacher-feedback",t.student.id)),title:"Send Teacher Feedback Form"},[Le(X(tI),{size:16})])):_e("",!0)]),(c=t.student)!=null&&c.updatedAt?(O(),B("div",{key:0,class:"action-updated-date",title:s.value},Y(t.student.updatedAt.seconds?new Date(t.student.updatedAt.seconds*1e3).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}):new Date(t.student.updatedAt).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})),9,h$)):_e("",!0)])])}}},m$=xt(p$,[["__scopeId","data-v-a57a20c6"]]),g$={key:0,class:"schedule-list"},v$={class:"period-assignment"},y$={class:"primary-line"},x$={class:"period-label"},E$={class:"primary-teacher"},_$={key:0,class:"coteaching-info"},b$=["title"],S$={key:1,class:"no-schedule"},A$={__name:"StudentScheduleCell",props:{student:{type:Object,required:!0},getSchedule:{type:Function,required:!0},getUserInitialLastName:{type:Function,required:!0},getPeriodLabel:{type:Function,required:!1}},setup(t){const e=r=>r&&typeof r=="object"&&r.coTeaching&&r.teacherId;return(r,n)=>(O(),B("td",null,[t.getSchedule(t.student)?(O(),B("div",g$,[d("ul",null,[(O(!0),B(Fe,null,He(t.getSchedule(t.student),(s,i)=>(O(),B("li",{key:i,class:"schedule-period"},[d("div",v$,[d("div",y$,[d("span",x$,Y(t.getPeriodLabel?t.getPeriodLabel(i):i)+":",1),d("span",E$,Y(t.getUserInitialLastName(s.teacherId||s)),1)]),e(s)?(O(),B("div",_$,[d("span",{class:"coteaching-indicator",title:`Co-teach ${s.coTeaching.subject}`},Y(t.getUserInitialLastName(s.coTeaching.caseManagerId))+" (C"+Y(s.coTeaching.subject.charAt(0))+") ",9,b$)])):_e("",!0)])]))),128))])])):(O(),B("div",S$,""))]))}},T$={key:0,class:"services-section"},w$={class:"services-container"},C$={key:1,class:"services-section"},I$={class:"services-container"},k$={key:0,class:"service-provider-item"},D$={key:0,class:"service-provider-item"},P$={key:1,class:"service-provider-item"},R$={key:2,class:"service-provider-item"},F$={key:3,class:"service-provider-item"},N$={key:4,class:"service-provider-item"},O$={key:5,class:"service-provider-item"},M$={__name:"StudentServicesCell",props:{student:{type:Object,required:!0},appSettings:{type:Object,required:!1},getClassServices:{type:Function,required:!0},getOtherServices:{type:Function,required:!0},hasServiceProviders:{type:Function,required:!0},getServiceProviderId:{type:Function,required:!0},getProviderFieldName:{type:Function,required:!0},getUserInitialLastName:{type:Function,required:!0}},setup(t){return(e,r)=>(O(),B("td",null,[t.getClassServices(t.student).length>0||t.getOtherServices(t.student).length>0||t.hasServiceProviders(t.student)?(O(),B(Fe,{key:0},[t.getClassServices(t.student).length>0?(O(),B("div",T$,[r[0]||(r[0]=d("strong",null,"Class Services:",-1)),d("div",w$,[(O(!0),B(Fe,null,He(t.getClassServices(t.student),n=>(O(),B("span",{key:n,class:"service-item"},Y(n),1))),128))])])):_e("",!0),t.getOtherServices(t.student).length>0||t.hasServiceProviders(t.student)?(O(),B("div",C$,[r[1]||(r[1]=d("strong",null,"Related Services:",-1)),d("div",I$,[(O(!0),B(Fe,null,He(t.getOtherServices(t.student),n=>(O(),B("span",{key:n,class:"service-item"},Y(n),1))),128)),t.appSettings&&t.appSettings.value&&t.appSettings.value.serviceProviders?(O(!0),B(Fe,{key:0},He(t.appSettings.value.serviceProviders,n=>(O(),B(Fe,{key:n},[t.getServiceProviderId(t.student,t.getProviderFieldName(n))?(O(),B("span",k$,Y(n)+" ("+Y(t.getUserInitialLastName(t.getServiceProviderId(t.student,t.getProviderFieldName(n))))+") ",1)):_e("",!0)],64))),128)):(O(),B(Fe,{key:1},[t.getServiceProviderId(t.student,"speechId")?(O(),B("span",D$,"SP ("+Y(t.getUserInitialLastName(t.getServiceProviderId(t.student,"speechId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"mhId")?(O(),B("span",P$,"MH ("+Y(t.getUserInitialLastName(t.getServiceProviderId(t.student,"mhId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"otId")?(O(),B("span",R$,"OT ("+Y(t.getUserInitialLastName(t.getServiceProviderId(t.student,"otId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"ptId")?(O(),B("span",F$,"PT ("+Y(t.getUserInitialLastName(t.getServiceProviderId(t.student,"ptId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"scId")?(O(),B("span",N$,"SC ("+Y(t.getUserInitialLastName(t.getServiceProviderId(t.student,"scId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"trId")?(O(),B("span",O$,"TR ("+Y(t.getUserInitialLastName(t.getServiceProviderId(t.student,"trId")))+")",1)):_e("",!0)],64))])])):_e("",!0)],64)):(O(),B(Fe,{key:1},[Ce("  ")],64))]))}},L$={key:1,class:"pill-list"},B$=["innerHTML"],U$={key:2},Tb={__name:"AccommodationsCell",props:{student:{type:Object,required:!0},fieldName:{type:String,required:!0},flagType:{type:String,required:!0},flagText:{type:String,required:!0},flagClass:{type:String,required:!0},getFlagValue:{type:Function,required:!0},formatListFromText:{type:Function,required:!0}},setup(t){return(e,r)=>(O(),B("td",{class:Qe(["instruction-cell",{"with-flag":t.getFlagValue(t.student,t.flagType)}])},[t.getFlagValue(t.student,t.flagType)?(O(),B("div",{key:0,class:Qe(["flag-overlay",t.flagClass])},Y(t.flagText),3)):_e("",!0),X(it)(t.student,t.fieldName)?(O(),B("div",L$,[d("div",{innerHTML:t.formatListFromText(X(it)(t.student,t.fieldName))},null,8,B$)])):(O(),B("div",U$,""))],2))}},$$={class:"student-name"},V$={class:"std-info-subheading"},H$={key:0,class:"schedule-list"},j$={class:"period-assignment"},G$={class:"primary-line"},W$={class:"period-label"},z$={class:"primary-teacher"},K$={key:0,class:"coteaching-info"},q$=["title"],X$={key:1,class:"no-schedule"},Y$={key:0,class:"flag-overlay flag-separate-setting"},Q$={key:1,class:"bullet-list"},J$=["innerHTML"],Z$={key:2},eV={class:"student-name"},tV=["title"],rV={class:"std-info-subheading"},nV={class:"student-dates print"},sV={key:0,class:"direct-assignment-badge"},Wf={__name:"StudentTable",props:{students:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})},currentUser:{type:Object,default:null},studentData:{type:Object,default:null},testingView:{type:Boolean,default:!1},aideSchedule:{type:Object,default:()=>({})}},emits:["edit","email","teacher-feedback"],setup(t,{emit:e}){const r=t,{appSettings:n,getUserName:s,getUserInitialLastName:i,formatDate:a,getMeetingUrgencyClass:o,getReviewUrgencyClass:l,getReevalUrgencyClass:c,getCaseManagerId:u,getFlagValue:f,getDocumentUrl:h,getSchedule:p,getClassServices:v,getOtherServices:g,hasServiceProviders:y,getServiceProviderId:b,getProviderFieldName:E,isDirectAssignment:x,formatListFromText:I,getPeriodLabel:D}=bU(r),P=w=>w&&typeof w=="object"&&w.coTeaching&&w.teacherId;return Vt(()=>r.student,w=>{var S,m,T,_,A,k,U;w&&Object.keys(w).length>0&&(form.schedule=((m=(S=w.app)==null?void 0:S.schedule)==null?void 0:m.periods)||w.schedule||((_=(T=w.aeries)==null?void 0:T.schedule)==null?void 0:_.periods)||{},console.log("StudentForm DEBUG - form.schedule:",form.schedule),console.log("StudentForm DEBUG - aeries.schedule:",(A=r.student.aeries)==null?void 0:A.schedule),console.log("StudentForm DEBUG - app.schedule.periods:",(U=(k=r.student.app)==null?void 0:k.schedule)==null?void 0:U.periods))},{immediate:!0,deep:!0}),(w,S)=>(O(),B("table",{class:Qe(["students-table",{"testing-view":t.testingView}])},[d("thead",null,[d("tr",null,[t.testingView?(O(),B(Fe,{key:0},[S[0]||(S[0]=d("th",{class:"print"},"Student Info",-1)),S[1]||(S[1]=d("th",{class:"print"},"Schedule",-1)),S[2]||(S[2]=d("th",{class:"print"},"Assessment Accommodations",-1))],64)):(O(),B(Fe,{key:1},[S[3]||(S[3]=d("th",{class:"print"},"Student Info",-1)),S[4]||(S[4]=d("th",{class:"print"},"Services",-1)),S[5]||(S[5]=d("th",{class:"print"},"Schedule",-1)),S[6]||(S[6]=d("th",{class:"print"},"Instruction Accommodations",-1)),S[7]||(S[7]=d("th",{class:"print"},"Assessment Accommodations",-1)),S[8]||(S[8]=d("th",{class:"print"},"Docs",-1)),S[9]||(S[9]=d("th",{class:"print"},"Actions",-1))],64))])]),d("tbody",null,[(O(!0),B(Fe,null,He(t.students,m=>{var T;return O(),B("tr",{key:m.id},[t.testingView?(O(),B(Fe,{key:0},[d("td",null,[d("div",$$,[d("strong",null,Y(X(it)(m,"firstName"))+" "+Y(X(it)(m,"lastName")),1)]),d("div",V$,[d("div",null,"Grd: "+Y(X(it)(m,"grade"))+" | Prg: "+Y(X(it)(m,"plan")),1),d("div",null,"CM: "+Y(X(s)(X(u)(m))),1)])]),d("td",null,[X(p)(m)?(O(),B("div",H$,[d("ul",null,[(O(!0),B(Fe,null,He(X(p)(m),(_,A)=>(O(),B("li",{key:A,class:"schedule-period"},[d("div",j$,[d("div",G$,[d("span",W$,Y(X(D)?X(D)(A):A)+":",1),d("span",z$,Y(X(i)(_.teacherId||_)),1)]),P(_)?(O(),B("div",K$,[d("span",{class:"coteaching-indicator",title:`Co-teach ${_.coTeaching.subject}`},Y(X(i)(_.coTeaching.caseManagerId))+" (C"+Y(_.coTeaching.subject.charAt(0))+") ",9,q$)])):_e("",!0)])]))),128))])])):(O(),B("div",X$,""))]),d("td",{class:Qe(["instruction-cell",{"with-flag":X(f)(m,"flag2")}])},[X(f)(m,"flag2")?(O(),B("div",Y$,"Separate setting")):_e("",!0),X(it)(m,"assessment")?(O(),B("div",Q$,[d("div",{innerHTML:X(I)(X(it)(m,"assessment"))},null,8,J$)])):(O(),B("div",Z$,""))],2)],64)):(O(),B(Fe,{key:1},[d("td",null,[d("div",eV,[d("strong",null,Y(X(it)(m,"firstName"))+" "+Y(X(it)(m,"lastName")),1),d("span",{class:"data-source",title:`Data source: ${X(lu)(m,"firstName")}`},Y(X(lu)(m,"firstName")==="Override"?"":X(lu)(m,"firstName")==="App"?"":X(lu)(m,"firstName")==="Aeries"?"":X(lu)(m,"firstName")==="SEIS"?"":""),9,tV)]),d("div",rV,[d("div",null,"Grd: "+Y(X(it)(m,"grade"))+" | Prg: "+Y(X(it)(m,"plan")),1),d("div",null,"CM: "+Y(X(s)(X(u)(m))),1)]),d("div",nV,[d("span",{class:Qe(["badge badge-review plan-review",X(l)(m)])},"PR: "+Y(X(a)(X(it)(m,"reviewDate"))),3),d("span",{class:Qe(["badge badge-reeval reeval-due",X(c)(m)])},"RE: "+Y(X(a)(X(it)(m,"reevalDate"))),3),d("span",{class:Qe(["badge badge-meeting meeting-date",[X(o)(m),X(it)(m,"meetingDate")?"date-set":""]])},"  "+Y(X(a)(X(it)(m,"meetingDate"))||"Not set"),3)]),((T=t.currentUser)==null?void 0:T.role)==="paraeducator"&&X(x)(m.id)?(O(),B("div",sV,S[10]||(S[10]=[d("span",{class:"badge badge-direct"},"Direct Assignment",-1)]))):_e("",!0)]),Le(M$,{student:m,"app-settings":X(n),"get-class-services":X(v),"get-other-services":X(g),"has-service-providers":X(y),"get-service-provider-id":X(b),"get-provider-field-name":X(E),"get-user-initial-last-name":X(i)},null,8,["student","app-settings","get-class-services","get-other-services","has-service-providers","get-service-provider-id","get-provider-field-name","get-user-initial-last-name"]),Le(A$,{student:m,"get-schedule":X(p),"get-user-initial-last-name":X(i),"get-period-label":X(D)},null,8,["student","get-schedule","get-user-initial-last-name","get-period-label"]),Le(Tb,{student:m,"field-name":"instruction","flag-type":"flag1","flag-text":"Preferential Seating","flag-class":"flag-preferential-seating","get-flag-value":X(f),"format-list-from-text":X(I)},null,8,["student","get-flag-value","format-list-from-text"]),Le(Tb,{student:m,"field-name":"assessment","flag-type":"flag2","flag-text":"Separate Setting","flag-class":"flag-separate-setting","get-flag-value":X(f),"format-list-from-text":X(I)},null,8,["student","get-flag-value","format-list-from-text"]),Le(c$,{student:m,"get-document-url":X(h)},null,8,["student","get-document-url"]),Le(m$,{student:m,"current-user":t.currentUser,"student-data":t.studentData,"get-user-name":X(s),"format-date":X(a),onEdit:_=>w.$emit("edit",m.id),onEmail:_=>w.$emit("email",m.id),onTeacherFeedback:_=>w.$emit("teacher-feedback",m.id)},null,8,["student","current-user","student-data","get-user-name","format-date","onEdit","onEmail","onTeacherFeedback"])],64))])}),128))])],2))}};function aV(t,e){const{appSettings:r,loadAppSettings:n,loading:s,error:i}=qs(),a=Fs(),o=se(!1);jt(async()=>{try{console.log("useStudentForm: Starting to load app settings..."),await n(),console.log("useStudentForm: App settings loaded successfully:",r.value)}catch(_){console.error("useStudentForm: Error loading app settings:",_)}});const l=be(()=>{var A;const _=((A=r.value)==null?void 0:A.numPeriods)||7;return Array.from({length:_},(k,U)=>U+1)}),c=be(()=>{var _;return(_=r.value)!=null&&_.grades&&r.value.grades.length>0?(console.log("useStudentForm: Using app settings grades:",r.value.grades),r.value.grades):(console.log("useStudentForm: Using fallback grades: [7, 8]"),["7","8"])}),u=be(()=>{var _;if((_=r.value)!=null&&_.classServices&&r.value.classServices.length>0){const A=r.value.classServices.filter(k=>k.enabledSubcategories&&k.enabledSubcategories.length>0);return console.log("useStudentForm: Available class services:",A.length,"services"),A}return console.log("useStudentForm: No class services available"),[]}),f=be(()=>{var _;return(_=r.value)!=null&&_.serviceProviders&&r.value.serviceProviders.length>0?(console.log("useStudentForm: Using app settings service providers:",r.value.serviceProviders.length,"providers"),r.value.serviceProviders):(console.log("useStudentForm: No service providers configured in app settings"),[])}),h=be(()=>{var _;return(_=r.value)!=null&&_.customServiceProviders?r.value.customServiceProviders:[]}),p=be(()=>{let _=t.users.userRoles?t.users.userRoles:{teachers:t.users.teachers||[],caseManagers:t.users.caseManagers||[],speech:t.users.speech||[],ot:t.users.ot||[],mh:t.users.mh||[]};return _.teachers&&(_={..._,teachers:_.teachers.map(A=>({...A,id:String(A.id)}))}),_}),v=_=>{var A,k,U,L,R,F,N,M,z,G,H,j,K,ne,he,le,fe,te,Z,xe,Q,q,J,pe,ge,ee,ie,ve,we,De,Te,ze,ke,Ve,Ae,Ge,Ke,Ee,ye,Se,Oe,We,ot,gt,Et,Ut;return{ssid:it(_,"ssid")||_.id||"",firstName:it(_,"firstName")||"",lastName:it(_,"lastName")||"",grade:it(_,"grade")||"7",plan:it(_,"plan")||"IEP",reviewDate:it(_,"reviewDate")||"",reevalDate:it(_,"reevalDate")||"",meetingDate:it(_,"meetingDate")||"",caseManagerId:it(_,"caseManagerId")||_.caseManagerId||_.casemanager_id||"",schedule:((k=(A=_.app)==null?void 0:A.schedule)==null?void 0:k.periods)||((L=(U=_.aeries)==null?void 0:U.schedule)==null?void 0:L.periods)||_.schedule||{},services:((F=(R=_.app)==null?void 0:R.schedule)==null?void 0:F.classServices)||_.services||[],speechId:((M=(N=_.app)==null?void 0:N.providers)==null?void 0:M.speechId)||_.speechId||_.speech_id||"",otId:((G=(z=_.app)==null?void 0:z.providers)==null?void 0:G.otId)||_.otId||_.ot_id||"",mhId:((j=(H=_.app)==null?void 0:H.providers)==null?void 0:j.mhId)||_.mhId||_.mh_id||"",ptId:((ne=(K=_.app)==null?void 0:K.providers)==null?void 0:ne.ptId)||_.ptId||_.pt_id||"",scId:((le=(he=_.app)==null?void 0:he.providers)==null?void 0:le.scId)||_.scId||_.sc_id||"",trId:((te=(fe=_.app)==null?void 0:fe.providers)==null?void 0:te.trId)||_.trId||_.tr_id||"",audId:((xe=(Z=_.app)==null?void 0:Z.providers)==null?void 0:xe.audId)||_.audId||_.aud_id||"",viId:((q=(Q=_.app)==null?void 0:Q.providers)==null?void 0:q.viId)||_.viId||_.vi_id||"",atId:((pe=(J=_.app)==null?void 0:J.providers)==null?void 0:pe.atId)||_.atId||_.at_id||"",dhhId:((ee=(ge=_.app)==null?void 0:ge.providers)==null?void 0:ee.dhhId)||_.dhhId||_.dhh_id||"",omId:((ve=(ie=_.app)==null?void 0:ie.providers)==null?void 0:ve.omId)||_.omId||_.om_id||"",bisId:((De=(we=_.app)==null?void 0:we.providers)==null?void 0:De.bisId)||_.bisId||_.bis_id||"",hnId:((ze=(Te=_.app)==null?void 0:Te.providers)==null?void 0:ze.hnId)||_.hnId||_.hn_id||"",swId:((Ve=(ke=_.app)==null?void 0:ke.providers)==null?void 0:Ve.swId)||_.swId||_.sw_id||"",instruction:it(_,"instruction")||"",assessment:it(_,"assessment")||"",flag1:((Ge=(Ae=_.app)==null?void 0:Ae.flags)==null?void 0:Ge.flag1)||_.flag1||!1,flag2:((Ee=(Ke=_.app)==null?void 0:Ke.flags)==null?void 0:Ee.flag2)||_.flag2||!1,ataglancePdfUrl:((Se=(ye=_.app)==null?void 0:ye.documents)==null?void 0:Se.ataglancePdfUrl)||_.ataglancePdfUrl||_.ataglance_pdf_url||"",bipPdfUrl:((We=(Oe=_.app)==null?void 0:Oe.documents)==null?void 0:We.bipPdfUrl)||_.bipPdfUrl||_.bip_pdf_url||"",ataglanceFileName:((gt=(ot=_.app)==null?void 0:ot.documents)==null?void 0:gt.ataglanceFileName)||_.ataglanceFileName||"",bipFileName:((Ut=(Et=_.app)==null?void 0:Et.documents)==null?void 0:Ut.bipFileName)||_.bipFileName||"",bipFile:null,ataglanceFile:null,removeBipFile:!1,removeAtaglanceFile:!1}},g=Rs(v(t.student||{})),y=_=>{const A=[];return _&&typeof _=="object"&&Object.entries(_).forEach(([k,U])=>{if(U&&typeof U=="object"&&U.coTeaching){const L=U.coTeaching.subject;L&&A.push(`Co-teach: ${L}`)}}),A},b=()=>{const _=y(g.schedule),A=g.services.filter(k=>!k.startsWith("Co-teach:"));g.services=[...A,..._]};Vt(()=>g.schedule,()=>{b()},{deep:!0}),Vt(()=>t.student,(_,A)=>{if(_&&Object.keys(_).length>0){const k=!A||Object.keys(A).length===0,U=_.id!==(A==null?void 0:A.id);if(k||U){console.log(" useStudentForm DEBUG - Student data changed, updating form:",_.id),console.log(" useStudentForm DEBUG - Student data:",{firstName:it(_,"firstName"),lastName:it(_,"lastName"),plan:it(_,"plan"),caseManagerId:it(_,"caseManagerId"),rawStudent:_});const L=v(_);Object.assign(g,L),b(),console.log(" useStudentForm DEBUG - Form updated:",{plan:g.plan,caseManagerId:g.caseManagerId,firstName:g.firstName,lastName:g.lastName})}}},{immediate:!0,deep:!0}),Vt(()=>r.value,_=>{console.log("useStudentForm: App settings watcher triggered:",_),_!=null&&_.grades&&_.grades.length>0&&(_.grades.includes(g.grade)||(g.grade=_.grades[0]||"7"))},{immediate:!0,deep:!0});const E=(_,A)=>{const k=_.target.files[0]||null;if(k){const U=Hc(k,{allowedTypes:["pdf"],maxSize:10485760,fieldName:A==="bipFile"?"BIP Document":"At-A-Glance Document"});if(!U.isValid){alert(U.error),_.target.value="";return}const L=qr(k.name);if(!L.isSafe){alert(`File name contains potentially dangerous content: ${L.threats.join(", ")}`),_.target.value="";return}}g[A]=k},x=_=>{_.preventDefault(),_.stopPropagation(),g.removeBipFile=!0,g.bipFile=null},I=_=>{_.preventDefault(),_.stopPropagation(),g.removeAtaglanceFile=!0,g.ataglanceFile=null},D={SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"},P=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}],w=_=>{var k;if((k=r.value)!=null&&k.serviceProviders&&Array.isArray(r.value.serviceProviders)){const U=(r.value.serviceProvidersDetails||P).find(L=>L.abbreviation===_);if(U)return U.name+" ("+_+")"}const A=P.find(U=>U.abbreviation===_);return A?A.name+" ("+_+")":_},S=_=>{const k={SLP:"speech",OT:"ot",MH:"mh",PT:"pt",SC:"sc",TR:"tr",AUD:"aud",VI:"vi",AT:"at",DHH:"dhh","O&M":"om",BIS:"bis",HN:"hn",SW:"sw"}[_]||_.toLowerCase();return p.value[k]||[]},m=()=>{const _=lI(g),A={app:{studentData:{firstName:_.firstName,lastName:_.lastName,grade:_.grade,plan:_.plan,caseManagerId:_.caseManagerId}}},k=oI(A,{isNew:t.mode==="new"});if(!k.isValid)return alert(`Please fix the following errors:

${k.errors.join(`
`)}`),!1;const U=["firstName","lastName","instruction","assessment"];for(const L of U)if(g[L]){const R=qr(g[L]);if(!R.isSafe)return alert(`Security threat detected in ${L}: ${R.threats.join(", ")}`),!1}return Object.assign(g,_),!0};return{form:g,isSaving:o,appSettings:r,appSettingsLoading:s,appSettingsError:i,periods:l,gradeOptions:c,availableClassServices:u,serviceProviders:f,customServiceProviders:h,userRoles:p,onFileChange:E,removeBipFile:x,removeAtaglanceFile:I,providerFieldMap:D,getProviderLabel:w,getProviderUsers:S,handleSubmit:async()=>{var _,A,k,U,L;try{if(o.value){console.log("Form submission already in progress, ignoring duplicate");return}if(console.log(" Form submitted:",{plan:g.plan,caseManagerId:g.caseManagerId,firstName:g.firstName,lastName:g.lastName,mode:t.mode,studentId:(_=t.student)==null?void 0:_.id}),o.value=!0,console.log(" AUTH DEBUG - Current user:",{uid:(A=St.currentUser)==null?void 0:A.uid,email:(k=St.currentUser)==null?void 0:k.email,claims:await((U=St.currentUser)==null?void 0:U.getIdTokenResult())}),!m()){o.value=!1;return}const R=g.services.filter(j=>j&&j.includes(":")),F={};console.log(" FORM SCHEDULE DEBUG - Complete form.schedule:",JSON.stringify(g.schedule,null,2)),console.log(" FORM SCHEDULE DEBUG - periods.value:",l.value),l.value.forEach(j=>{if(console.log(` FORM SCHEDULE DEBUG - Period ${j} exists:`,!!g.schedule[j],"Value:",g.schedule[j]),g.schedule[j]){const K=g.schedule[j];console.log(` SCHEDULE DEBUG - Period ${j}:`,{type:typeof K,data:K,hasCoTeaching:!!(K&&K.coTeaching),hasCaseManagerId:!!(K&&K.coTeaching&&K.coTeaching.caseManagerId)}),typeof K=="string"?F[j]=K:typeof K=="object"&&K!==null&&(K.coTeaching&&K.coTeaching.caseManagerId?(console.log(` SCHEDULE DEBUG - Period ${j} has co-teaching, preserving structure`),F[j]={teacherId:K.teacherId,coTeaching:{caseManagerId:K.coTeaching.caseManagerId,subject:K.coTeaching.subject||""}}):(console.log(` SCHEDULE DEBUG - Period ${j} converting to simple format`),F[j]=K.teacherId||String(K)||K))}}),console.log(" Schedule Composition Debug:"),console.log("Form schedule before:",JSON.stringify(g.schedule,null,2)),console.log("Composed schedule after:",JSON.stringify(F,null,2)),console.log("Composed data:",{classServices:R,schedule:F});let N=g.bipPdfUrl||null,M=g.ataglancePdfUrl||null;if(console.log(" Form submission - PDF URLs:",{bipPdfUrl:N,ataglancePdfUrl:M,formBipPdfUrl:g.bipPdfUrl,formAtaglancePdfUrl:g.ataglancePdfUrl,bipFileName:g.bipFileName,ataglanceFileName:g.ataglanceFileName,bipFile:g.bipFile,ataglanceFile:g.ataglanceFile}),g.removeBipFile&&(console.log("Removing BIP file..."),N)){try{const j=se(wc,`students/${t.student.id||"temp"}/${N}`);await kv(j),await deleteDoc(Ze(qe,"pdfMetadata",N)),console.log("Secure BIP file deleted:",N)}catch(j){console.warn("Error deleting secure BIP file:",j)}N=null}if(g.removeAtaglanceFile&&(console.log("Removing At-A-Glance file..."),M)){try{const j=se(wc,`students/${t.student.id||"temp"}/${M}`);await kv(j),await deleteDoc(Ze(qe,"pdfMetadata",M)),console.log("Secure At-A-Glance file deleted:",M)}catch(j){console.warn("Error deleting secure At-A-Glance file:",j)}M=null}const z={studentData:{firstName:g.firstName,lastName:g.lastName,grade:g.grade,plan:g.plan,caseManagerId:g.caseManagerId},dates:{reviewDate:g.reviewDate,reevalDate:g.reevalDate,meetingDate:g.meetingDate},schedule:{periods:F,classServices:R},providers:{speechId:g.speechId,otId:g.otId,mhId:g.mhId,ptId:g.ptId,scId:g.scId,trId:g.trId,audId:g.audId,viId:g.viId,atId:g.atId,dhhId:g.dhhId,omId:g.omId,bisId:g.bisId,hnId:g.hnId,swId:g.swId},accommodations:{instruction:g.instruction,assessment:g.assessment},flags:{flag1:g.flag1,flag2:g.flag2},documents:{ataglancePdfUrl:M,bipPdfUrl:N,bipFileName:g.bipFileName||null,ataglanceFileName:g.ataglanceFileName||null}};console.log(" Documents being saved:",{ataglancePdfUrl:M,bipPdfUrl:N,bipFileName:g.bipFileName||null,ataglanceFileName:g.ataglanceFileName||null}),console.log("Saving payload:",z);const G={app:z,updatedAt:wn(),updatedBy:((L=a.currentUser)==null?void 0:L.uid)||null};console.log("Saving payload:",G);let H=null;if(t.mode==="edit"&&t.student.id)console.log("Updating existing student:",t.student.id),await Ht(Ze(qe,"students",t.student.id),G,{merge:!0}),H=t.student.id,console.log("Student updated successfully"),await tn.logStudentAccess(t.student.id,"edit",{fields:Object.keys(z.studentData||{}),hasDocuments:!!(M||N),formMode:"edit"});else{if(console.log("Adding new student"),!g.ssid||g.ssid.trim()===""){alert("SSID is required for new students");return}const j=g.ssid.trim();G.app.studentData.ssid=j;const K=Ze(_t(qe,"students"));G.createdAt=wn(),await Ht(K,G),H=K.id,G.id=H,console.log("Student added successfully with ID:",H,"SSID:",j),await tn.logStudentAccess(H,"create",{ssid:j,fields:Object.keys(z.studentData||{}),hasDocuments:!!(M||N),formMode:"create"})}e("saved",G),e("close")}catch(R){console.error("Error saving student:",R),console.error("Error details:",{code:R.code,message:R.message,stack:R.stack}),alert(`Error saving student: ${R.message||R}. Please try again.`)}finally{o.value=!1}},validateForm:m}}const iV={class:"form-col"},oV={class:"inner-grid-3"},lV={key:0,class:"ssid-field"},cV=["value"],uV=["value"],dV={__name:"StudentBasicInfo",props:{form:{type:Object,required:!0},mode:{type:String,default:"new"},gradeOptions:{type:Array,required:!0},userRoles:{type:Object,required:!0}},setup(t){return(e,r)=>(O(),B("fieldset",iV,[r[21]||(r[21]=d("legend",null,"Student Info",-1)),d("div",oV,[t.mode==="new"?(O(),B("label",lV,[r[9]||(r[9]=d("span",{class:"field-label"},"SSID (State Student ID) *",-1)),Be(d("input",{"onUpdate:modelValue":r[0]||(r[0]=n=>t.form.ssid=n),type:"text",required:"",placeholder:"Enter student SSID",class:"ssid-input"},null,512),[[ht,t.form.ssid]]),r[10]||(r[10]=d("div",{class:"field-help"},[d("strong",null,"Required:"),Ce(" This can be found in your Student Information System (SIS) such as Aeries, or in SEIS. The SSID is used to link student data across different systems. ")],-1))])):_e("",!0),d("label",null,[r[11]||(r[11]=Ce(" First Name: ")),Be(d("input",{"onUpdate:modelValue":r[1]||(r[1]=n=>t.form.firstName=n),type:"text",required:""},null,512),[[ht,t.form.firstName]])]),d("label",null,[r[12]||(r[12]=Ce(" Last Name: ")),Be(d("input",{"onUpdate:modelValue":r[2]||(r[2]=n=>t.form.lastName=n),type:"text",required:""},null,512),[[ht,t.form.lastName]])]),d("label",null,[r[13]||(r[13]=Ce(" Grade: ")),Be(d("select",{"onUpdate:modelValue":r[3]||(r[3]=n=>t.form.grade=n)},[(O(!0),B(Fe,null,He(t.gradeOptions,n=>(O(),B("option",{key:n,value:n},Y(n),9,cV))),128))],512),[[cr,t.form.grade]])]),d("label",null,[r[15]||(r[15]=Ce(" Plan Type: ")),Be(d("select",{"onUpdate:modelValue":r[4]||(r[4]=n=>t.form.plan=n)},r[14]||(r[14]=[d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),512),[[cr,t.form.plan]])]),d("label",null,[r[16]||(r[16]=Ce(" Review Date: ")),Be(d("input",{"onUpdate:modelValue":r[5]||(r[5]=n=>t.form.reviewDate=n),type:"date"},null,512),[[ht,t.form.reviewDate]])]),d("label",null,[r[17]||(r[17]=Ce(" Reevaluation Date: ")),Be(d("input",{"onUpdate:modelValue":r[6]||(r[6]=n=>t.form.reevalDate=n),type:"date"},null,512),[[ht,t.form.reevalDate]])]),d("label",null,[r[18]||(r[18]=Ce(" Meeting Date: ")),Be(d("input",{"onUpdate:modelValue":r[7]||(r[7]=n=>t.form.meetingDate=n),type:"date"},null,512),[[ht,t.form.meetingDate]])]),d("label",null,[r[20]||(r[20]=Ce(" Case Manager: ")),Be(d("select",{"onUpdate:modelValue":r[8]||(r[8]=n=>t.form.caseManagerId=n)},[r[19]||(r[19]=d("option",{value:""},"-- Select Case Manager --",-1)),(O(!0),B(Fe,null,He(t.userRoles.caseManagers,n=>(O(),B("option",{key:n.id,value:n.id},Y(n.name||n.email||n.id),9,uV))),128))],512),[[cr,t.form.caseManagerId]])])])]))}},fV=xt(dV,[["__scopeId","data-v-5eadce29"]]),hV={class:"form-col"},pV={class:"periods-container"},mV={class:"period-main"},gV={class:"period-label"},vV=["value","onChange"],yV=["value"],xV=["disabled","onClick"],EV={key:0,class:"coteaching-config"},_V={class:"coteaching-info"},bV={class:"classroom-teacher"},SV={class:"case-manager-name"},AV={class:"config-row"},TV=["value","onChange"],wV=["value"],CV={class:"config-row"},IV=["value","onChange"],kV=["value"],DV={__name:"StudentSchedule",props:{form:{type:Object,required:!0},periods:{type:Array,required:!0},userRoles:{type:Object,required:!0},appSettings:{type:Object,default:()=>({})}},setup(t){const e=t,{getLabel:r}=xo(),n=be(()=>(e.userRoles.caseManagers||[]).filter(b=>b.id&&(b.role==="case_manager"||b.role==="admin_504"||b.role==="administrator_504_CM"||b.role==="sped_chair"||b.roles&&b.roles.includes("case_manager")))),s=be(()=>{var y;if((y=e.appSettings)!=null&&y.classServices){const b=e.appSettings.classServices.find(E=>E.name==="Co-teach"&&E.enabledSubcategories);if(b)return b.enabledSubcategories.sort()}return["English","Math","History","Science"]}),i=y=>{const b=e.form.schedule[y];return typeof b=="string"?b:typeof b=="object"&&b!==null&&b.teacherId||""},a=(y,b)=>{if(h("SET_TEACHER_START",{period:y,teacherId:b,isCoTeachingActive:c(y),currentValue:e.form.schedule[y]}),c(y)){const E=u(y),x=f(y);e.form.schedule[y]={teacherId:b,coTeaching:{caseManagerId:E,subject:x}},h("SET_TEACHER_COTEACHING",{period:y,newValue:e.form.schedule[y]})}else e.form.schedule[y]=b,h("SET_TEACHER_SIMPLE",{period:y,newValue:e.form.schedule[y]})},o=y=>{if(!y)return"Unknown";const b=(e.userRoles.teachers||[]).find(E=>E.id===y);return b&&(b.name||b.email)||y},l=y=>{if(!y)return"Select Case Manager";const b=n.value.find(E=>E.id===y);return b&&(b.name||b.email)||y},c=y=>{var E;const b=e.form.schedule[y];return typeof b=="object"&&b!==null?!!((E=b.coTeaching)!=null&&E.caseManagerId):!1},u=y=>{var E;const b=e.form.schedule[y];return typeof b=="object"&&b!==null&&((E=b.coTeaching)==null?void 0:E.caseManagerId)||""},f=y=>{var E;const b=e.form.schedule[y];return typeof b=="object"&&b!==null&&((E=b.coTeaching)==null?void 0:E.subject)||""},h=(y,b)=>{const E=new Date().toISOString();console.log(` [${E}] Schedule Process: ${y}`,b)},p=(y,b)=>{h("UPDATE_CM_START",{period:y,caseManagerId:b,currentValue:e.form.schedule[y]});const E=i(y),x=f(y);E?(e.form.schedule[y]={teacherId:E,coTeaching:{caseManagerId:b,subject:x}},h("UPDATE_CM_COMPLETE",{period:y,newValue:e.form.schedule[y]}),console.log(" CO-TEACHING DEBUG - Case Manager Updated:",{period:y,periodType:typeof y,caseManagerId:b,teacherId:E,subject:x,finalValue:e.form.schedule[y],entireSchedule:JSON.stringify(e.form.schedule,null,2)})):h("UPDATE_CM_BLOCKED",{reason:"No teacher ID",period:y})},v=(y,b)=>{h("UPDATE_SUBJECT_START",{period:y,subject:b,currentValue:e.form.schedule[y]});const E=i(y),x=u(y);E?(e.form.schedule[y]={teacherId:E,coTeaching:{caseManagerId:x,subject:b}},h("UPDATE_SUBJECT_COMPLETE",{period:y,newValue:e.form.schedule[y]}),console.log(" CO-TEACHING DEBUG - Subject Updated:",{period:y,periodType:typeof y,subject:b,teacherId:E,caseManagerId:x,finalValue:e.form.schedule[y],entireSchedule:JSON.stringify(e.form.schedule,null,2)})):h("UPDATE_SUBJECT_BLOCKED",{reason:"No teacher ID",period:y})},g=y=>{var x;h("TOGGLE_START",{period:y,currentValue:e.form.schedule[y],formVersion:e.formVersion});const b=i(y);if(!b){h("TOGGLE_BLOCKED",{reason:"No teacher selected",period:y});return}const E=c(y);if(h("TOGGLE_STATE",{period:y,isActive:E,teacherId:b,beforeValue:e.form.schedule[y]}),E)e.form.schedule[y]=b;else{const I={teacherId:b,coTeaching:{caseManagerId:((x=n.value[0])==null?void 0:x.id)||"",subject:s.value[0]||""}};e.form.schedule[y]=I,setTimeout(()=>{var D;console.log(" CO-TEACHING PERSISTENCE CHECK - 100ms later:",{period:y,stillExists:!!e.form.schedule[y],currentValue:e.form.schedule[y],isObject:typeof e.form.schedule[y]=="object",hasCoTeaching:!!((D=e.form.schedule[y])!=null&&D.coTeaching)})},100),setTimeout(()=>{var D;console.log(" CO-TEACHING PERSISTENCE CHECK - 1000ms later:",{period:y,stillExists:!!e.form.schedule[y],currentValue:e.form.schedule[y],isObject:typeof e.form.schedule[y]=="object",hasCoTeaching:!!((D=e.form.schedule[y])!=null&&D.coTeaching)})},1e3)}h("TOGGLE_COMPLETE",{period:y,afterValue:e.form.schedule[y],formVersion:e.formVersion}),console.log(" CO-TEACHING DEBUG - Toggle Complete:",{period:y,periodType:typeof y,isActive:!E,finalValue:e.form.schedule[y],entireSchedule:JSON.stringify(e.form.schedule,null,2),availableCaseManagers:n.value.length,availableSubjects:s.value.length})};return Vt(()=>e.form.schedule,(y,b)=>{console.log(" SCHEDULE WATCHER - Schedule changed:",{timestamp:new Date().toISOString(),newSchedule:JSON.stringify(y,null,2),oldSchedule:JSON.stringify(b,null,2),periodsWithObjects:Object.keys(y).filter(E=>typeof y[E]=="object"),periodsWithCoTeaching:Object.keys(y).filter(E=>{var x;return(x=y[E])==null?void 0:x.coTeaching})})},{deep:!0}),(y,b)=>(O(),B("fieldset",hV,[b[7]||(b[7]=d("legend",null,"Schedule",-1)),d("div",pV,[(O(!0),B(Fe,null,He(t.periods,E=>(O(),B("div",{key:E,class:"period-row"},[d("div",mV,[d("label",gV,Y(X(r)(E))+":",1),d("select",{value:i(E),onChange:x=>a(E,x.target.value),class:"teacher-select"},[b[0]||(b[0]=d("option",{value:""},"--",-1)),(O(!0),B(Fe,null,He(t.userRoles.teachers,x=>(O(),B("option",{key:x.id,value:x.id},Y(x.name||x.email||x.id),9,yV))),128))],40,vV),d("button",{type:"button",class:Qe(["coteaching-toggle",{active:c(E)}]),disabled:!i(E),onClick:x=>g(E),title:"Co-Teaching"}," C ",10,xV)]),c(E)?(O(),B("div",EV,[d("div",_V,[b[1]||(b[1]=d("span",{class:"coteaching-label"},"Co-Teaching:",-1)),d("span",bV,Y(o(i(E))),1),b[2]||(b[2]=d("span",{class:"plus-sign"},"+",-1)),d("span",SV,Y(l(u(E))),1)]),d("div",AV,[b[4]||(b[4]=d("label",{class:"config-label"},"Subject:",-1)),d("select",{value:f(E),onChange:x=>v(E,x.target.value),class:"subject-select",required:""},[b[3]||(b[3]=d("option",{value:""},"-- Select Subject --",-1)),(O(!0),B(Fe,null,He(s.value,x=>(O(),B("option",{key:x,value:x},Y(x),9,wV))),128))],40,TV)]),d("div",CV,[b[6]||(b[6]=d("label",{class:"config-label"},"Case Manager:",-1)),d("select",{value:u(E),onChange:x=>p(E,x.target.value),class:"cm-select",required:""},[b[5]||(b[5]=d("option",{value:""},"-- Select Case Manager --",-1)),(O(!0),B(Fe,null,He(n.value,x=>(O(),B("option",{key:x.id,value:x.id},Y(x.name||x.email||x.id),9,kV))),128))],40,IV)])])):_e("",!0)]))),128))])]))}},PV=xt(DV,[["__scopeId","data-v-4aeb2d99"]]),RV={class:"checkbox-inline-group"},FV=["value","checked","onChange"],wb={__name:"ServiceCheckboxGroup",props:["label","items","modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const r=t,n=e;function s(i){const a=r.label+": "+i,o=r.modelValue?[...r.modelValue]:[],l=o.indexOf(a);l===-1?o.push(a):o.splice(l,1),n("update:modelValue",o)}return(i,a)=>(O(),B("fieldset",null,[d("legend",null,Y(t.label),1),d("div",RV,[(O(!0),B(Fe,null,He(t.items,o=>(O(),B("label",{key:o},[d("input",{type:"checkbox",value:t.label+": "+o,checked:t.modelValue&&t.modelValue.includes(t.label+": "+o),onChange:l=>s(o)},null,40,FV),Ce(" "+Y(o),1)]))),128))])]))}},NV={class:"form-col"},OV={class:"inner-grid-3"},MV={key:0,class:"loading-message"},LV={key:1,class:"error-message"},BV={style:{display:"none"}},UV={key:3,class:"no-services-message"},$V={__name:"StudentClassServices",props:{form:{type:Object,required:!0},availableClassServices:{type:Array,required:!0},appSettingsLoading:{type:Boolean,default:!1},appSettingsError:{type:String,default:null}},setup(t){const e=t,r=be(()=>e.availableClassServices.filter(s=>s.name!=="Co-teach")),n=be(()=>e.availableClassServices.filter(s=>s.name==="Co-teach"));return(s,i)=>(O(),B("fieldset",NV,[i[5]||(i[5]=d("legend",null,"Services: classes",-1)),d("div",OV,[t.appSettingsLoading?(O(),B("div",MV,i[2]||(i[2]=[d("span",{class:"loading-spinner"},"",-1),Ce(" Loading app settings... ")]))):t.appSettingsError?(O(),B("div",LV,[i[3]||(i[3]=d("span",{class:"error-icon"},"",-1)),Ce(" Error loading app settings: "+Y(t.appSettingsError),1)])):t.availableClassServices.length>0?(O(),B(Fe,{key:2},[(O(!0),B(Fe,null,He(r.value,a=>(O(),tr(wb,{key:a.name,label:a.name,items:a.enabledSubcategories,modelValue:t.form.services,"onUpdate:modelValue":i[0]||(i[0]=o=>t.form.services=o)},null,8,["label","items","modelValue"]))),128)),d("div",BV,[(O(!0),B(Fe,null,He(n.value,a=>(O(),tr(wb,{key:a.name,label:a.name,items:a.enabledSubcategories,modelValue:t.form.services,"onUpdate:modelValue":i[1]||(i[1]=o=>t.form.services=o)},null,8,["label","items","modelValue"]))),128))])],64)):(O(),B("div",UV,i[4]||(i[4]=[d("span",{class:"info-icon"},"",-1),Ce(" No class services configured. "),d("a",{href:"/admin",class:"settings-link"},"Configure in App Settings",-1)])))])]))}},VV=xt($V,[["__scopeId","data-v-d750acb2"]]),HV=["id","value"],jV=["value"],Cb={__name:"ServiceSelect",props:["id","label","list","modelValue"],emits:["update:modelValue"],setup(t){return(e,r)=>(O(),B("label",null,[Ce(Y(t.label)+": ",1),d("select",{id:t.id,value:t.modelValue,onChange:r[0]||(r[0]=n=>e.$emit("update:modelValue",n.target.value))},[r[1]||(r[1]=d("option",{value:""},"--",-1)),(O(!0),B(Fe,null,He(t.list,n=>(O(),B("option",{key:n.id,value:n.id},Y(n.name),9,jV))),128))],40,HV)]))}},GV={class:"inner-grid-3"},WV={key:1,class:"no-services-message"},zV={__name:"StudentProviders",props:{form:{type:Object,required:!0},serviceProviders:{type:Array,required:!0},customServiceProviders:{type:Array,required:!0},providerFieldMap:{type:Object,required:!0},getProviderLabel:{type:Function,required:!0},getProviderUsers:{type:Function,required:!0}},setup(t){return(e,r)=>(O(),B("fieldset",null,[r[1]||(r[1]=d("legend",null,"Services: providers",-1)),d("div",GV,[t.serviceProviders.length>0?(O(),B(Fe,{key:0},[(O(!0),B(Fe,null,He(t.serviceProviders,n=>(O(),tr(Cb,{key:n,id:n,label:t.getProviderLabel(n),list:t.getProviderUsers(n),modelValue:t.form[t.providerFieldMap[n]||`${n.toLowerCase()}Id`],"onUpdate:modelValue":s=>t.form[t.providerFieldMap[n]||`${n.toLowerCase()}Id`]=s},null,8,["id","label","list","modelValue","onUpdate:modelValue"]))),128)),(O(!0),B(Fe,null,He(t.customServiceProviders,n=>(O(),tr(Cb,{key:n,id:n,label:n,list:[],modelValue:t.form[`${n.toLowerCase()}Id`],"onUpdate:modelValue":s=>t.form[`${n.toLowerCase()}Id`]=s},null,8,["id","label","modelValue","onUpdate:modelValue"]))),128))],64)):(O(),B("div",WV,r[0]||(r[0]=[d("span",{class:"info-icon"},"",-1),Ce(" No service providers configured. "),d("a",{href:"/admin",class:"settings-link"},"Configure in App Settings",-1)])))])]))}},KV=xt(zV,[["__scopeId","data-v-faa02238"]]),qV={class:"form-col"},XV={class:"document-section"},YV={key:0,class:"current-file"},QV={key:1,class:"removed-file"},JV={key:2,class:"upload-status loading-pulse"},ZV={key:3,class:"error-message"},eH={class:"document-section"},tH={key:0,class:"current-file"},rH={key:1,class:"removed-file"},nH={key:2,class:"upload-status loading-pulse"},sH={__name:"StudentDocuments",props:{form:{type:Object,required:!0},student:{type:Object,default:()=>({})},mode:{type:String,default:"new"},onFileChange:{type:Function,required:!0},removeBipFile:{type:Function,required:!0},removeAtaglanceFile:{type:Function,required:!0}},emits:["loading-change"],setup(t,{emit:e}){const r=t,n=e,{uploadPdf:s,downloadPdf:i,isUploading:a,error:o}=Jy(),l=se(null),c=be(()=>a.value||l.value!==null);Vt(c,p=>{n("loading-change",p)},{immediate:!0});const u=be(()=>{var v,g,y,b;const p=((v=r.student)==null?void 0:v.id)||((g=r.form)==null?void 0:g.id);return console.log(" StudentDocuments - studentId computed:",{studentId:(y=r.student)==null?void 0:y.id,formId:(b=r.form)==null?void 0:b.id,finalId:p}),p}),f=async(p,v)=>{const g=p.target.files[0]||null;if(g){const y=Hc(g,{allowedTypes:["pdf"],maxSize:10485760,fieldName:v==="bipFile"?"BIP Document":"At-A-Glance Document"});if(!y.isValid){alert(y.error),p.target.value="";return}const b=qr(g.name);if(!b.isSafe){alert(`File name contains potentially dangerous content: ${b.threats.join(", ")}`),p.target.value="";return}try{if(l.value=v==="bipFile"?"bip":"ataglance",!u.value)throw new Error("Student ID is required for secure file upload");const E=v==="bipFile"?r.form.bipPdfUrl:r.form.ataglancePdfUrl;if(E){console.log(` Cleaning up old ${v} file:`,E);try{const{ref:I,deleteObject:D}=await la(async()=>{const{ref:_,deleteObject:A}=await Promise.resolve().then(()=>VM);return{ref:_,deleteObject:A}},void 0),{doc:P,deleteDoc:w}=await la(async()=>{const{doc:_,deleteDoc:A}=await Promise.resolve().then(()=>T9);return{doc:_,deleteDoc:A}},void 0),{storage:S,db:m}=await la(async()=>{const{storage:_,db:A}=await Promise.resolve().then(()=>$4);return{storage:_,db:A}},void 0),T=I(S,`students/${u.value}/${E}`);await D(T),await w(P(m,"pdfMetadata",E)),console.log(` Old ${v} file cleaned up:`,E)}catch(I){console.warn(`Failed to clean up old ${v} file:`,I.message)}}const x=await s(g,u.value);v==="bipFile"?(Object.assign(r.form,{bipPdfUrl:x,bipFileName:g.name}),console.log(" BIP file updated in form:",{bipPdfUrl:r.form.bipPdfUrl,bipFileName:r.form.bipFileName})):(Object.assign(r.form,{ataglancePdfUrl:x,ataglanceFileName:g.name}),console.log(" At-A-Glance file updated in form:",{ataglancePdfUrl:r.form.ataglancePdfUrl,ataglanceFileName:r.form.ataglanceFileName})),console.log(` Secure PDF uploaded: ${x}`),console.log(" Current form state:",{bipPdfUrl:r.form.bipPdfUrl,bipFileName:r.form.bipFileName,ataglancePdfUrl:r.form.ataglancePdfUrl,ataglanceFileName:r.form.ataglanceFileName})}catch(E){console.error("Secure PDF upload failed:",E),alert(`Failed to upload PDF: ${E.message}`)}finally{l.value=null,p.target.value=""}}r.onFileChange(p,v)},h=async p=>{try{const v=p==="bip"?r.form.bipPdfUrl:r.form.ataglancePdfUrl,g=p==="bip"?r.form.bipFileName:r.form.ataglanceFileName;if(!v||!u.value)throw new Error("File not found or student ID missing");await i(v,u.value,g)}catch(v){console.error("Secure PDF download failed:",v),alert(`Failed to download PDF: ${v.message}`)}};return(p,v)=>(O(),B("fieldset",qV,[v[20]||(v[20]=d("legend",null,"Documents",-1)),d("div",XV,[d("label",null,[v[13]||(v[13]=Ce(" BIP: ")),d("input",{type:"file",accept:"application/pdf",onChange:v[0]||(v[0]=g=>f(g,"bipFile"))},null,32),t.form.bipPdfUrl&&!t.form.removeBipFile?(O(),B("span",YV,[v[9]||(v[9]=Ce(" Current: ")),d("a",{href:"#",onClick:v[1]||(v[1]=dn(g=>h("bip"),["prevent"])),target:"_blank"},"View BIP"),d("button",{type:"button",onClick:v[2]||(v[2]=(...g)=>t.removeBipFile&&t.removeBipFile(...g)),class:"btn-remove"},[Le(X(B2),{size:16}),v[8]||(v[8]=Ce(" Remove "))])])):_e("",!0),t.form.removeBipFile?(O(),B("span",QV,[v[11]||(v[11]=Ce(" BIP file will be removed ")),d("button",{type:"button",onClick:v[3]||(v[3]=g=>t.form.removeBipFile=!1),class:"btn-undo"},[Le(X(Lv),{size:16}),v[10]||(v[10]=Ce(" Undo "))])])):_e("",!0),X(a)&&l.value==="bip"?(O(),B("div",JV,[Le(X(yh),{size:16,class:"loading-spinner"}),v[12]||(v[12]=d("strong",null,"Loading... Uploading BIP document...",-1))])):_e("",!0),X(o)?(O(),B("div",ZV,Y(X(o)),1)):_e("",!0)])]),d("div",eH,[d("label",null,[v[19]||(v[19]=Ce(" At-A-Glance PDF: ")),d("input",{type:"file",accept:"application/pdf",onChange:v[4]||(v[4]=g=>f(g,"ataglanceFile"))},null,32),t.form.ataglancePdfUrl&&!t.form.removeAtaglanceFile?(O(),B("span",tH,[v[15]||(v[15]=Ce(" Current: ")),d("a",{href:"#",onClick:v[5]||(v[5]=dn(g=>h("ataglance"),["prevent"])),target:"_blank"},"View At-A-Glance"),d("button",{type:"button",onClick:v[6]||(v[6]=(...g)=>t.removeAtaglanceFile&&t.removeAtaglanceFile(...g)),class:"btn-remove"},[Le(X(B2),{size:16}),v[14]||(v[14]=Ce(" Remove "))])])):_e("",!0),t.form.removeAtaglanceFile?(O(),B("span",rH,[v[17]||(v[17]=Ce(" At-A-Glance file will be removed ")),d("button",{type:"button",onClick:v[7]||(v[7]=g=>t.form.removeAtaglanceFile=!1),class:"btn-undo"},[Le(X(Lv),{size:16}),v[16]||(v[16]=Ce(" Undo "))])])):_e("",!0),X(a)&&l.value==="ataglance"?(O(),B("div",nH,[Le(X(yh),{size:16,class:"loading-spinner"}),v[18]||(v[18]=d("strong",null,"Loading... Uploading At-A-Glance document...",-1))])):_e("",!0)])])]))}},aH=xt(sH,[["__scopeId","data-v-32b54ce6"]]),iH={class:"form-col"},oH={class:"inner-grid-2"},lH={__name:"StudentAccommodations",props:{form:{type:Object,required:!0}},setup(t){return(e,r)=>(O(),B("fieldset",iH,[r[4]||(r[4]=d("legend",null,"Accommodations",-1)),d("div",oH,[d("label",null,[r[2]||(r[2]=Ce(" Instruction: ")),Be(d("textarea",{"onUpdate:modelValue":r[0]||(r[0]=n=>t.form.instruction=n),placeholder:"Enter instructional accommodations..."},null,512),[[ht,t.form.instruction]])]),d("label",null,[r[3]||(r[3]=Ce(" Assessment: ")),Be(d("textarea",{"onUpdate:modelValue":r[1]||(r[1]=n=>t.form.assessment=n),placeholder:"Enter assessment accommodations..."},null,512),[[ht,t.form.assessment]])])])]))}},cH=xt(lH,[["__scopeId","data-v-4ce4f379"]]),uH={class:"flags-container"},dH={class:"checkbox-label"},fH={class:"checkbox-label"},hH={__name:"StudentFlags",props:{form:{type:Object,required:!0}},setup(t){return(e,r)=>(O(),B("fieldset",null,[r[4]||(r[4]=d("legend",null,"Flags",-1)),d("div",uH,[d("label",dH,[Be(d("input",{type:"checkbox","onUpdate:modelValue":r[0]||(r[0]=n=>t.form.flag1=n)},null,512),[[wt,t.form.flag1]]),r[2]||(r[2]=Ce(" Preferential seating "))]),d("label",fH,[Be(d("input",{type:"checkbox","onUpdate:modelValue":r[1]||(r[1]=n=>t.form.flag2=n)},null,512),[[wt,t.form.flag2]]),r[3]||(r[3]=Ce(" Separate setting "))])])]))}},pH=xt(hH,[["__scopeId","data-v-e7295a7a"]]),mH={class:"dialog-backdrop"},gH={class:"dialog"},vH=["disabled"],yH={__name:"StudentForm",props:{student:{type:Object,default:()=>({})},users:{type:Object,required:!0},mode:{type:String,default:"new"}},emits:["close","saved"],setup(t,{emit:e}){const r=t,n=e,{form:s,isSaving:i,appSettings:a,appSettingsLoading:o,appSettingsError:l,periods:c,gradeOptions:u,availableClassServices:f,serviceProviders:h,customServiceProviders:p,userRoles:v,onFileChange:g,removeBipFile:y,removeAtaglanceFile:b,providerFieldMap:E,getProviderLabel:x,getProviderUsers:I,handleSubmit:D}=aV(r,n),P=se(!1),w=be(()=>i.value||P.value),S=be(()=>P.value?"Loading files...":i.value?"Saving...":r.mode==="edit"?"Save":"Add Student"),m=T=>{P.value=T};return(T,_)=>(O(),B("div",mH,[d("div",gH,[d("header",null,[d("h2",null,Y(t.mode==="edit"?"Edit Student":"Add Student"),1),d("button",{onClick:_[0]||(_[0]=A=>T.$emit("close")),class:"close-btn"},"")]),d("form",{onSubmit:_[2]||(_[2]=dn((...A)=>X(D)&&X(D)(...A),["prevent"])),id:"student-form"},[Le(fV,{form:X(s),mode:t.mode,"grade-options":X(u),"user-roles":X(v)},null,8,["form","mode","grade-options","user-roles"]),Le(PV,{form:X(s),periods:X(c),"user-roles":X(v),"app-settings":X(a)},null,8,["form","periods","user-roles","app-settings"]),Le(VV,{form:X(s),"available-class-services":X(f),"app-settings-loading":X(o),"app-settings-error":X(l)},null,8,["form","available-class-services","app-settings-loading","app-settings-error"]),Le(KV,{form:X(s),"service-providers":X(h),"custom-service-providers":X(p),"provider-field-map":X(E),"get-provider-label":X(x),"get-provider-users":X(I)},null,8,["form","service-providers","custom-service-providers","provider-field-map","get-provider-label","get-provider-users"]),Le(aH,{form:X(s),student:t.student,mode:t.mode,"on-file-change":X(g),"remove-bip-file":X(y),"remove-ataglance-file":X(b),onLoadingChange:m},null,8,["form","student","mode","on-file-change","remove-bip-file","remove-ataglance-file"]),Le(cH,{form:X(s)},null,8,["form"]),Le(pH,{form:X(s)},null,8,["form"]),d("footer",null,[d("button",{type:"button",onClick:_[1]||(_[1]=A=>T.$emit("close")),class:"btn btn-secondary"}," Cancel "),d("button",{type:"submit",class:"btn btn-primary",disabled:w.value},Y(S.value),9,vH)])],32)])]))}},Zy=xt(yH,[["__scopeId","data-v-7363b0d2"]]),xH={key:0},EH={key:1,class:"loading-dialog"},_H={__name:"StudentEditDialog",props:{studentId:{type:String,required:!0},users:{type:Object,required:!0}},emits:["close","saved"],setup(t,{emit:e}){const r=t,n=e,{students:s,fetchStudents:i}=Ii(),a=be(()=>{const l=s.value.find(c=>c.id===r.studentId);return console.log("StudentEditDialog - studentId:",r.studentId),console.log("StudentEditDialog - all students:",s.value),console.log("StudentEditDialog - found student:",l),l||{}});jt(async()=>{s.value.length===0&&(console.log("StudentEditDialog - fetching students..."),await i())});function o(l){console.log("StudentEditDialog - student saved:",l),n("saved",l)}return(l,c)=>a.value&&Object.keys(a.value).length>0?(O(),B("div",xH,[Le(Zy,{student:a.value,users:t.users,mode:"edit",onClose:c[0]||(c[0]=u=>l.$emit("close")),onSaved:o},null,8,["student","users"])])):(O(),B("div",EH,c[1]||(c[1]=[d("div",{class:"dialog"},[d("header",null,[d("h2",null,"Loading Student Data...")]),d("div",{class:"content"},[d("p",null,"Please wait while we load the student information.")])],-1)])))}},bH=xt(_H,[["__scopeId","data-v-0410ea60"]]),SH={class:"dialog-backdrop"},AH={class:"dialog"},TH={class:"button-group"},wH={key:0,class:"members-list"},CH={key:0,class:"email"},IH=["value"],kH={class:"docs-option"},DH={key:0,class:"no-docs"},PH=["disabled"],RH=["disabled"],FH={__name:"StudentsEmailDialog",props:{student:{type:Object,required:!0},userMap:{type:Object,required:!0}},emits:["close"],setup(t){const e=t,{student:r,userMap:n}=e,s=se(""),i=se([]),a=se(!1),o=be(()=>{var b,E;if((E=(b=r.app)==null?void 0:b.schedule)!=null&&E.periods){const x=[];return Object.values(r.app.schedule.periods).forEach(I=>{var P;const D=typeof I=="string"?I:I==null?void 0:I.teacherId;D&&x.push(D),(P=I==null?void 0:I.coTeaching)!=null&&P.caseManagerId&&x.push(I.coTeaching.caseManagerId)}),x}const y=r.schedule||{};return Object.values(y).filter(Boolean)}),l=be(()=>[...new Set(o.value)]),c=be(()=>{var b;const y=[];(b=r.app)!=null&&b.providers&&Object.entries(r.app.providers).forEach(([E,x])=>{x&&!["caseManagerId"].includes(E)&&y.push(x)});for(const E in r)E.endsWith("_id")&&!["casemanager_id","caseManagerId"].includes(E)&&r[E]&&y.push(r[E]);return[...new Set(y)].filter(E=>!l.value.includes(E))}),u=be(()=>l.value.map(y=>({id:y,...n[y]||{}})).filter(y=>y&&y.email)),f=be(()=>c.value.map(y=>({id:y,...n[y]||{}})).filter(y=>y&&y.email)),h=be(()=>[...u.value,...f.value]),p=be(()=>{var y,b,E,x;return!!((b=(y=r.app)==null?void 0:y.documents)!=null&&b.ataglancePdfUrl||(x=(E=r.app)==null?void 0:E.documents)!=null&&x.bipPdfUrl||r.ataglancePdfUrl||r.ataglance_pdf_url||r.bipPdfUrl||r.bip_pdf_url)}),v=be(()=>s.value?s.value==="Individual"?i.value.length>0:!0:!1);function g(){var m,T,_,A,k,U,L,R,F,N,M;let y=[];s.value==="Teachers"?y=u.value:s.value==="TeachersAndService"?y=[...u.value,...f.value]:s.value==="Individual"&&(y=h.value.filter(z=>i.value.includes(z.id)));const b=y.map(z=>z.email).filter(Boolean).join(",");if(!b){alert("No email addresses found for the selected recipients.");return}console.log(" Student data for email:",{student:r,firstName:r.firstName,first_name:r.first_name,lastName:r.lastName,last_name:r.last_name,appStudentData:(m=r.app)==null?void 0:m.studentData});const E=r.firstName||r.first_name||((_=(T=r.app)==null?void 0:T.studentData)==null?void 0:_.firstName)||((A=r.app)==null?void 0:A.firstName)||"",x=r.lastName||r.last_name||((U=(k=r.app)==null?void 0:k.studentData)==null?void 0:U.lastName)||((L=r.app)==null?void 0:L.lastName)||"";console.log(" Extracted names:",{firstName:E,lastName:x});const I=`${E} ${x}`.trim()||"Student",D=(((E==null?void 0:E[0])||"")+((x==null?void 0:x[0])||"")).toUpperCase()||"ST";console.log(" Final values:",{fullName:I,initials:D});const P=`${D} - Student Update`;let w="";if(a.value){w+=`Hi team!

${I}'s updated documents are available in the CaseManage app.

`;const z=((F=(R=r.app)==null?void 0:R.documents)==null?void 0:F.ataglancePdfUrl)||r.ataglancePdfUrl||r.ataglance_pdf_url,G=((M=(N=r.app)==null?void 0:N.documents)==null?void 0:M.bipPdfUrl)||r.bipPdfUrl||r.bip_pdf_url;z||G?(w+=`Available documents:
`,z&&(w+=` At-A-Glance
`),G&&(w+=` BIP (Behavior Intervention Plan)
`),w+=`
To access the documents:
`,w+=`Log into the CaseManage app: ${window.location.origin}
`,w+=`Navigate to the student's record to view their documents.

`,w+=`The documents require authentication to view for security purposes.
`):(w+=`No documents are currently available for ${I}.

`,w+=`If documents are added, you can access them by logging into:
`,w+=`${window.location.origin}
`)}else w="See attached.";console.log(" Email composition:",{subject:P,body:w});const S=`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(b)}&su=${encodeURIComponent(P)}&body=${encodeURIComponent(w)}`;window.open(S,"_blank","noopener")}return(y,b)=>(O(),B("div",SH,[d("div",AH,[d("header",null,[d("h2",null,"Email about "+Y(X(r).firstName||X(r).first_name)+" "+Y(X(r).lastName||X(r).last_name),1),d("button",{onClick:b[0]||(b[0]=E=>y.$emit("close")),title:"Close"},"")]),d("main",null,[d("form",{onSubmit:b[6]||(b[6]=dn(()=>{},["prevent"]))},[d("div",TH,[d("button",{type:"button",class:Qe(["option-button",{active:s.value==="Teachers"}]),onClick:b[1]||(b[1]=E=>s.value="Teachers")}," Teachers ",2),d("button",{type:"button",class:Qe(["option-button",{active:s.value==="TeachersAndService"}]),onClick:b[2]||(b[2]=E=>s.value="TeachersAndService")}," Teachers and service providers ",2),d("button",{type:"button",class:Qe(["option-button",{active:s.value==="Individual"}]),onClick:b[3]||(b[3]=E=>s.value="Individual")}," Individual member of the IEP team ",2)]),s.value==="Individual"?(O(),B("div",wH,[b[8]||(b[8]=d("div",null,"Select members:",-1)),(O(!0),B(Fe,null,He(h.value,E=>(O(),B("div",{key:E.id},[d("label",null,[d("span",null,[Ce(Y(E.name||E.displayName||E.email||E.id)+" ",1),E.email?(O(),B("span",CH,"("+Y(E.email)+")",1)):_e("",!0)]),Be(d("input",{type:"checkbox",value:E.id,"onUpdate:modelValue":b[4]||(b[4]=x=>i.value=x)},null,8,IH),[[wt,i.value]])])]))),128))])):_e("",!0),d("div",kH,[d("label",null,[d("span",null,[b[9]||(b[9]=Ce(" Include documents ")),p.value?_e("",!0):(O(),B("span",DH,"(No docs available)"))]),Be(d("input",{type:"checkbox","onUpdate:modelValue":b[5]||(b[5]=E=>a.value=E),disabled:!p.value},null,8,PH),[[wt,a.value]])])])],32)]),d("footer",null,[d("button",{onClick:b[7]||(b[7]=E=>y.$emit("close"))},"Cancel"),d("button",{disabled:!v.value,onClick:g},"Send",8,RH)])])]))}},NH=xt(FH,[["__scopeId","data-v-0e59eb1d"]]),OH={class:"dialog-backdrop"},MH={class:"dialog"},LH={class:"field-groups"},BH={class:"field-group"},UH={class:"field-group"},$H={class:"field-group"},VH={class:"field-group"},HH={class:"field-group"},jH={class:"field-group"},GH=["disabled"],WH={__name:"ExportDialog",props:{students:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})}},emits:["close"],setup(t,{emit:e}){const r=t,n=e,s=Fs(),i=Wy(),a=se({studentData:{firstName:!0,lastName:!0,grade:!0,plan:!0,caseManagerId:!0},dates:{reviewDate:!0,reevalDate:!0,meetingDate:!0},providers:{all:!0},accommodations:{instruction:!0,assessment:!0},schedule:{periods:!0,classServices:!0},documents:{ataglancePdfUrl:!0,bipPdfUrl:!0}}),o=["speechId","otId","mhId","ptId","scId","trId","audId","viId","atId","dhhId","omId","bisId","hnId","swId"],l=be(()=>Object.values(a.value).some(y=>Object.values(y).some(b=>b)));function c(y){if(!y||!r.userMap[y])return"";const b=r.userMap[y];return b.name||b.email||""}function u(y){const b=i.userPermissions||[];return Array.isArray(b)&&b.includes(y)}function f(){Object.keys(a.value).forEach(y=>{Object.keys(a.value[y]).forEach(b=>{a.value[y][b]=!0})})}function h(){Object.keys(a.value).forEach(y=>{Object.keys(a.value[y]).forEach(b=>{a.value[y][b]=!1})})}function p(y){var I,D,P,w,S,m,T,_,A,k,U,L,R,F,N,M,z,G,H,j,K,ne,he,le,fe,te,Z,xe,Q,q,J,pe;const b=s.currentUser;if((b==null?void 0:b.role)==="admin"||(b==null?void 0:b.role)==="administrator"||(b==null?void 0:b.role)==="staff_view"||(b==null?void 0:b.role)==="sped_chair"||(b==null?void 0:b.role)==="administrator_504_CM"||(b==null?void 0:b.role)==="admin_504")return v(y);const x={};return a.value.studentData.firstName&&(x.firstName=(D=(I=y.app)==null?void 0:I.studentData)==null?void 0:D.firstName),a.value.studentData.lastName&&(x.lastName=(w=(P=y.app)==null?void 0:P.studentData)==null?void 0:w.lastName),a.value.studentData.grade&&(x.grade=(m=(S=y.app)==null?void 0:S.studentData)==null?void 0:m.grade),a.value.studentData.plan&&(x.plan=(_=(T=y.app)==null?void 0:T.studentData)==null?void 0:_.plan),a.value.studentData.caseManagerId&&(x.caseManagerId=(k=(A=y.app)==null?void 0:A.studentData)==null?void 0:k.caseManagerId),u("view_student_dates")&&(a.value.dates.reviewDate&&(x.reviewDate=(L=(U=y.app)==null?void 0:U.dates)==null?void 0:L.reviewDate),a.value.dates.reevalDate&&(x.reevalDate=(F=(R=y.app)==null?void 0:R.dates)==null?void 0:F.reevalDate),a.value.dates.meetingDate&&(x.meetingDate=(M=(N=y.app)==null?void 0:N.dates)==null?void 0:M.meetingDate)),(u("view_service_providers")||((G=(z=y.app)==null?void 0:z.studentData)==null?void 0:G.caseManagerId)===(b==null?void 0:b.uid)||o.some(ge=>{var ee,ie;return((ie=(ee=y.app)==null?void 0:ee.providers)==null?void 0:ie[ge])===(b==null?void 0:b.uid)}))&&a.value.providers.all&&o.forEach(ge=>{var ee,ie;x[ge]=(ie=(ee=y.app)==null?void 0:ee.providers)==null?void 0:ie[ge]}),u("view_accommodations")&&(a.value.accommodations.instruction&&(x.instruction=(j=(H=y.app)==null?void 0:H.accommodations)==null?void 0:j.instruction),a.value.accommodations.assessment&&(x.assessment=(ne=(K=y.app)==null?void 0:K.accommodations)==null?void 0:ne.assessment)),(u("view_schedule")||Object.values(((le=(he=y.app)==null?void 0:he.schedule)==null?void 0:le.periods)||{}).includes(b==null?void 0:b.uid))&&(a.value.schedule.periods&&(x.schedule=(te=(fe=y.app)==null?void 0:fe.schedule)==null?void 0:te.periods),a.value.schedule.classServices&&(x.classServices=(xe=(Z=y.app)==null?void 0:Z.schedule)==null?void 0:xe.classServices)),u("view_documents")&&(a.value.documents.ataglancePdfUrl&&(x.ataglancePdfUrl=(q=(Q=y.app)==null?void 0:Q.documents)==null?void 0:q.ataglancePdfUrl),a.value.documents.bipPdfUrl&&(x.bipPdfUrl=(pe=(J=y.app)==null?void 0:J.documents)==null?void 0:pe.bipPdfUrl)),x}function v(y){var E,x,I,D,P,w,S,m,T,_,A,k,U,L,R,F,N,M,z,G,H,j,K,ne,he,le,fe,te;const b={};return a.value.studentData.firstName&&(b.firstName=(x=(E=y.app)==null?void 0:E.studentData)==null?void 0:x.firstName),a.value.studentData.lastName&&(b.lastName=(D=(I=y.app)==null?void 0:I.studentData)==null?void 0:D.lastName),a.value.studentData.grade&&(b.grade=(w=(P=y.app)==null?void 0:P.studentData)==null?void 0:w.grade),a.value.studentData.plan&&(b.plan=(m=(S=y.app)==null?void 0:S.studentData)==null?void 0:m.plan),a.value.studentData.caseManagerId&&(b.caseManagerId=(_=(T=y.app)==null?void 0:T.studentData)==null?void 0:_.caseManagerId),a.value.dates.reviewDate&&(b.reviewDate=(k=(A=y.app)==null?void 0:A.dates)==null?void 0:k.reviewDate),a.value.dates.reevalDate&&(b.reevalDate=(L=(U=y.app)==null?void 0:U.dates)==null?void 0:L.reevalDate),a.value.dates.meetingDate&&(b.meetingDate=(F=(R=y.app)==null?void 0:R.dates)==null?void 0:F.meetingDate),a.value.providers.all&&o.forEach(Z=>{var xe,Q;b[Z]=(Q=(xe=y.app)==null?void 0:xe.providers)==null?void 0:Q[Z]}),a.value.accommodations.instruction&&(b.instruction=(M=(N=y.app)==null?void 0:N.accommodations)==null?void 0:M.instruction),a.value.accommodations.assessment&&(b.assessment=(G=(z=y.app)==null?void 0:z.accommodations)==null?void 0:G.assessment),a.value.schedule.periods&&(b.schedule=(j=(H=y.app)==null?void 0:H.schedule)==null?void 0:j.periods),a.value.schedule.classServices&&(b.classServices=(ne=(K=y.app)==null?void 0:K.schedule)==null?void 0:ne.classServices),a.value.documents.ataglancePdfUrl&&(b.ataglancePdfUrl=(le=(he=y.app)==null?void 0:he.documents)==null?void 0:le.ataglancePdfUrl),a.value.documents.bipPdfUrl&&(b.bipPdfUrl=(te=(fe=y.app)==null?void 0:fe.documents)==null?void 0:te.bipPdfUrl),b}function g(){const y=r.students.map(S=>p(S)),b=[],E=[],x={firstName:"First Name",lastName:"Last Name",grade:"Grade",plan:"Plan Type",caseManagerId:"Case Manager",reviewDate:"Plan Review",reevalDate:"Reevaluation",meetingDate:"Meeting Date",speechId:"Speech",otId:"OT",mhId:"Mental Health",ptId:"PT",scId:"SC",trId:"TR",audId:"Audiology",viId:"Vision",atId:"AT",dhhId:"DHH",omId:"O&M",bisId:"BIS",hnId:"HN",swId:"SW",instruction:"Instructional Accommodation",assessment:"Assessment Accommodations",schedule:"Schedule",classServices:"Class Services",ataglancePdfUrl:"At-A-Glance",bipPdfUrl:"BIP"};Object.entries(a.value).forEach(([S,m])=>{Object.entries(m).forEach(([T,_])=>{_&&(T==="all"?o.forEach(A=>{b.push(x[A])}):b.push(x[T]))})}),y.forEach(S=>{const m=[];Object.entries(a.value).forEach(([T,_])=>{Object.entries(_).forEach(([A,k])=>{if(k)if(A==="all")o.forEach(U=>{const L=S[U]||"";m.push(L?c(L):"")});else{let U=S[A]||"";A.endsWith("Id")?U=U?c(U):"":A==="classServices"?U=Array.isArray(S.classServices)?S.classServices.join(", "):"":A==="schedule"&&(U=S.schedule?Object.entries(S.schedule).map(([L,R])=>`${L}: ${c(R)}`).join("; "):""),m.push(U)}})}),E.push(m)});const I=[b.join(","),...E.map(S=>S.map(m=>`"${String(m).replace(/"/g,'""')}"`).join(","))].join(`
`),D=new Blob([I],{type:"text/csv"}),P=window.URL.createObjectURL(D),w=document.createElement("a");w.href=P,w.download="students-export.csv",w.click(),window.URL.revokeObjectURL(P),n("close")}return(y,b)=>(O(),B("div",OH,[d("div",MH,[d("header",null,[b[17]||(b[17]=d("h2",null,"Export Students",-1)),d("button",{onClick:b[0]||(b[0]=E=>y.$emit("close")),class:"close-btn"},"")]),d("main",null,[d("p",null,"Export "+Y(t.students.length)+" students",1),d("div",LH,[d("div",BH,[b[23]||(b[23]=d("h4",null,"Student Info",-1)),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[1]||(b[1]=E=>a.value.studentData.firstName=E)},null,512),[[wt,a.value.studentData.firstName]]),b[18]||(b[18]=Ce(" First Name "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[2]||(b[2]=E=>a.value.studentData.lastName=E)},null,512),[[wt,a.value.studentData.lastName]]),b[19]||(b[19]=Ce(" Last Name "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[3]||(b[3]=E=>a.value.studentData.grade=E)},null,512),[[wt,a.value.studentData.grade]]),b[20]||(b[20]=Ce(" Grade "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[4]||(b[4]=E=>a.value.studentData.plan=E)},null,512),[[wt,a.value.studentData.plan]]),b[21]||(b[21]=Ce(" Plan Type "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[5]||(b[5]=E=>a.value.studentData.caseManagerId=E)},null,512),[[wt,a.value.studentData.caseManagerId]]),b[22]||(b[22]=Ce(" Case Manager "))])]),d("div",UH,[b[27]||(b[27]=d("h4",null,"Important Dates",-1)),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[6]||(b[6]=E=>a.value.dates.reviewDate=E)},null,512),[[wt,a.value.dates.reviewDate]]),b[24]||(b[24]=Ce(" Plan Review "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[7]||(b[7]=E=>a.value.dates.reevalDate=E)},null,512),[[wt,a.value.dates.reevalDate]]),b[25]||(b[25]=Ce(" Reevaluation "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[8]||(b[8]=E=>a.value.dates.meetingDate=E)},null,512),[[wt,a.value.dates.meetingDate]]),b[26]||(b[26]=Ce(" Meeting Date "))])]),d("div",$H,[b[29]||(b[29]=d("h4",null,"Related Services",-1)),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[9]||(b[9]=E=>a.value.providers.all=E)},null,512),[[wt,a.value.providers.all]]),b[28]||(b[28]=Ce(" All Service Providers "))])]),d("div",VH,[b[32]||(b[32]=d("h4",null,"Accommodations",-1)),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[10]||(b[10]=E=>a.value.accommodations.instruction=E)},null,512),[[wt,a.value.accommodations.instruction]]),b[30]||(b[30]=Ce(" Instructional "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[11]||(b[11]=E=>a.value.accommodations.assessment=E)},null,512),[[wt,a.value.accommodations.assessment]]),b[31]||(b[31]=Ce(" Assessment "))])]),d("div",HH,[b[35]||(b[35]=d("h4",null,"Schedule & Services",-1)),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[12]||(b[12]=E=>a.value.schedule.periods=E)},null,512),[[wt,a.value.schedule.periods]]),b[33]||(b[33]=Ce(" Class Schedule "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[13]||(b[13]=E=>a.value.schedule.classServices=E)},null,512),[[wt,a.value.schedule.classServices]]),b[34]||(b[34]=Ce(" Class Services "))])]),d("div",jH,[b[38]||(b[38]=d("h4",null,"Documents",-1)),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[14]||(b[14]=E=>a.value.documents.ataglancePdfUrl=E)},null,512),[[wt,a.value.documents.ataglancePdfUrl]]),b[36]||(b[36]=Ce(" At-A-Glance "))]),d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":b[15]||(b[15]=E=>a.value.documents.bipPdfUrl=E)},null,512),[[wt,a.value.documents.bipPdfUrl]]),b[37]||(b[37]=Ce(" BIP "))])])]),d("div",{class:"quick-select"},[d("button",{onClick:f},"Select All"),d("button",{onClick:h},"Deselect All")])]),d("footer",null,[d("button",{onClick:b[16]||(b[16]=E=>y.$emit("close")),class:"btn-secondary"},"Cancel"),d("button",{onClick:g,class:"btn-primary",disabled:!l.value},"Export",8,GH)])])]))}},zH=xt(WH,[["__scopeId","data-v-08e1f384"]]),KH={class:"modal-body"},qH={class:"student-info"},XH={class:"case-manager-info"},YH={class:"form-group"},QH={key:0,class:"no-forms-message"},JH={key:1,class:"form-selection"},ZH=["id","value"],ej=["for"],tj={class:"form-title"},rj={class:"form-details"},nj={key:0,class:"form-description"},sj={class:"form-date"},aj={key:0,class:"form-group"},ij={class:"teacher-selection-header"},oj={class:"teacher-actions"},lj=["title"],cj={class:"teacher-selection"},uj={key:0,class:"no-teachers-message"},dj={key:1,class:"teacher-checkboxes"},fj=["id","value"],hj=["for"],pj={class:"teacher-email"},mj={key:0,class:"selected-emails-preview"},gj={class:"email-preview"},vj={key:1,class:"form-group"},yj={class:"duplication-options"},xj={class:"option-item"},Ej={key:2,class:"form-group"},_j={class:"send-history"},bj={class:"history-info"},Sj={class:"history-date"},Aj={class:"history-teachers"},Tj={key:0,class:"history-success"},wj={key:1,class:"history-failed"},Cj={key:0,class:"history-links"},Ij=["href"],kj=["href"],Dj={key:0,class:"resource-links"},Pj={class:"resource-section"},Rj={class:"resource-note"},Fj={class:"success-details"},Nj={key:0,class:"student-info"},Oj={class:"form-link"},Mj=["href"],Lj={class:"modal-footer"},Bj=["disabled"],Uj={key:0},$j={key:1},Vj={__name:"TeacherFeedbackDialog",props:{student:{type:Object,required:!0},currentUser:{type:Object,required:!0}},emits:["close","form-sent"],setup(t,{emit:e}){const r=t,n=e,{activeForms:s}=qy(),{userList:i,fetchUsers:a}=_a(),o=se(!1),l=se(""),c=se(""),u=se(null),f=se(!1),h=se("Copy teacher emails to clipboard"),p=se(""),v=se([]),g=be(()=>s.value||[]),y=be(()=>{var _;return p.value&&((_=g.value)==null?void 0:_.find(A=>A.id===p.value))||null}),b=be(()=>{if(!p.value||!r.student)return[];try{return JSON.parse(localStorage.getItem("casemanage_sent_forms")||"[]").filter(A=>A&&A.studentId===r.student.id&&A.formId===p.value).sort((A,k)=>new Date(k.sentAt)-new Date(A.sentAt))||[]}catch(_){return console.warn("Error parsing send history:",_),[]}}),E=be(()=>{var A,k,U;if(!r.student||!i.value)return[];const _=new Set;if((k=(A=r.student.app)==null?void 0:A.schedule)!=null&&k.periods)Object.values(r.student.app.schedule.periods).forEach(L=>{var F;const R=typeof L=="string"?L:L==null?void 0:L.teacherId;R&&_.add(R),(F=L==null?void 0:L.coTeaching)!=null&&F.caseManagerId&&_.add(L.coTeaching.caseManagerId)});else{const L=r.student.schedule||{};Object.values(L).forEach(R=>{R&&_.add(R)})}return(U=r.student.aeries)!=null&&U.schedule&&Object.values(r.student.aeries.schedule).forEach(L=>{L!=null&&L.teacherId&&_.add(L.teacherId)}),Array.from(_).map(L=>(i.value||[]).find(R=>R&&R.id===L)).filter(Boolean).filter(L=>L&&L.role==="teacher")}),x=be(()=>p.value&&(v.value||[]).length>0),I=_=>_?(_.seconds?new Date(_.seconds*1e3):new Date(_)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",D=_=>_?(_.seconds?new Date(_.seconds*1e3):new Date(_)).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):"",P=()=>{v.value=[...E.value]},w=async()=>{const _=v.value.map(A=>A.email).join(", ");try{await navigator.clipboard.writeText(_),h.value=" Copied!",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}catch(A){console.error("Failed to copy emails:",A);const k=document.createElement("textarea");k.value=_,document.body.appendChild(k),k.select();try{document.execCommand("copy"),h.value=" Copied!",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}catch{h.value=" Copy failed",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}document.body.removeChild(k)}},S=async()=>{var _,A,k,U;if(x.value)try{o.value=!0,l.value="",u.value=null;const L=y.value,R=v.value.map(he=>he.email),F=v.value.map(he=>he.name||he.email).join(", "),N=r.student.firstName||r.student.first_name||((A=(_=r.student.app)==null?void 0:_.studentData)==null?void 0:A.firstName)||"",M=r.student.lastName||r.student.last_name||((U=(k=r.student.app)==null?void 0:k.studentData)==null?void 0:U.lastName)||"",z=`${N} ${M}`.trim(),G=(((N==null?void 0:N[0])||"")+((M==null?void 0:M[0])||"")).toUpperCase()||"ST";let H=L.formUrl;H.includes("/edit")&&(H=H.replace("/edit","/copy"));const j=new URLSearchParams;G&&G!=="ST"&&j.append("title",`${G} - ${L.title}`),z&&j.append("student",z),R.length>0&&j.append("responders",R.join(", "));const K=H.includes("?")?"&":"?",ne=j.toString()?`${H}${K}${j.toString()}`:H;window.open(ne,"_blank","noopener"),l.value=`Form opened for ${F}. Student: ${G} - ${z}`,c.value="success",u.value={message:`Form opened successfully for ${G} - ${z}`,sent:R.length,failed:0,formUrl:ne,studentInitials:G,studentName:z},m(L,v.value,ne)}catch(L){console.error("Error opening form:",L),l.value="Failed to open form. Please try again.",c.value="error"}finally{o.value=!1}},m=(_,A,k=null)=>{const U=JSON.parse(localStorage.getItem("casemanage_sent_forms")||"[]"),L={id:`${_.id}_${r.student.id}_${Date.now()}`,formId:_.id,formTitle:_.title,formUrl:k||_.formUrl,sheetUrl:null,studentId:r.student.id,studentName:`${r.student.firstName} ${r.student.lastName}`,caseManagerId:r.currentUser.uid,caseManagerName:r.currentUser.name||r.currentUser.email,teachers:A.map(F=>({id:F.id,name:F.name,email:F.email})),sentAt:new Date().toISOString(),method:"gmail"},R=U.findIndex(F=>F.id===L.id);R!==-1?U[R]=L:U.push(L),localStorage.setItem("casemanage_sent_forms",JSON.stringify(U))},T=()=>{n("close")};return jt(()=>{p.value="",v.value=[],l.value="",a()}),Vt(E,_=>{_&&_.length>0&&v.value.length===0&&(v.value=[..._])},{immediate:!0}),(_,A)=>{var k,U,L,R;return O(),B("div",{class:"modal-overlay",onClick:T},[d("div",{class:"modal-content",onClick:A[3]||(A[3]=dn(()=>{},["stop"]))},[d("div",{class:"modal-header"},[A[4]||(A[4]=d("h3",null,"Send Teacher Feedback Form",-1)),d("button",{onClick:T,class:"close-btn"},"")]),d("div",KH,[d("div",qH,[d("h4",null,Y(t.student.firstName)+" "+Y(t.student.lastName)+" (Grade "+Y(t.student.grade)+")",1),d("p",XH,"Case Manager: "+Y(((k=t.currentUser)==null?void 0:k.name)||((U=t.currentUser)==null?void 0:U.email)),1)]),d("div",YH,[A[6]||(A[6]=d("label",null,"Select Feedback Form to Send:",-1)),g.value.length===0?(O(),B("div",QH,A[5]||(A[5]=[d("p",null,"No feedback forms available. Forms must be created in the Admin Panel first.",-1),d("p",null,[d("em",null,"Contact your administrator to create feedback forms.")],-1)]))):(O(),B("div",JH,[(O(!0),B(Fe,null,He(g.value,F=>(O(),B("div",{key:F.id,class:"form-option"},[Be(d("input",{type:"radio",id:F.id,value:F.id,"onUpdate:modelValue":A[0]||(A[0]=N=>p.value=N)},null,8,ZH),[[ma,p.value]]),d("label",{for:F.id,class:"form-option-label"},[d("div",tj,Y(F.title),1),d("div",rj,[F.description?(O(),B("span",nj,Y(F.description),1)):_e("",!0),d("span",sj,"Created: "+Y(I(F.createdAt)),1)])],8,ej)]))),128))]))]),p.value?(O(),B("div",aj,[d("div",ij,[A[7]||(A[7]=d("label",null,"Select Teachers to Send Form To:",-1)),d("div",oj,[E.value.length>0?(O(),B("button",{key:0,onClick:P,type:"button",class:"btn-select-all"}," Select All ")):_e("",!0),v.value.length>0?(O(),B("button",{key:1,onClick:w,type:"button",class:"btn-copy-emails",title:h.value},"  Copy Emails ",8,lj)):_e("",!0)])]),d("div",cj,[E.value.length===0?(O(),B("div",uj,A[8]||(A[8]=[d("p",null,"No teachers found for this student's schedule.",-1)]))):(O(),B("div",dj,[(O(!0),B(Fe,null,He(E.value,F=>(O(),B("div",{key:F.id,class:"checkbox-item"},[Be(d("input",{type:"checkbox",id:`teacher-${F.id}`,value:F,"onUpdate:modelValue":A[1]||(A[1]=N=>v.value=N)},null,8,fj),[[wt,v.value]]),d("label",{for:`teacher-${F.id}`},[Ce(Y(F.name||F.email)+" ",1),d("span",pj,"("+Y(F.email)+")",1)],8,hj)]))),128))]))]),v.value.length>0?(O(),B("div",mj,[A[9]||(A[9]=d("p",null,[d("strong",null,"Selected teacher emails:")],-1)),d("div",gj,Y(v.value.map(F=>F.email).join(", ")),1)])):_e("",!0)])):_e("",!0),p.value&&v.value.length>0&&((L=y.value)!=null&&L.sheetTemplateUrl)?(O(),B("div",vj,[A[11]||(A[11]=d("label",null,"Response Collection:",-1)),d("div",yj,[d("div",xj,[Be(d("input",{type:"checkbox",id:"duplicate-sheet","onUpdate:modelValue":A[2]||(A[2]=F=>f.value=F)},null,512),[[wt,f.value]]),A[10]||(A[10]=d("label",{for:"duplicate-sheet"},[d("strong",null,"Duplicate custom sheet"),d("span",{class:"option-description"},"Create a copy of the response template sheet in your Google Drive")],-1))])])])):_e("",!0),p.value&&b.value.length>0?(O(),B("div",Ej,[A[12]||(A[12]=d("label",null,"Previous Sends for this Student:",-1)),d("div",_j,[(O(!0),B(Fe,null,He(b.value,F=>(O(),B("div",{key:F.id,class:"history-item"},[d("div",bj,[d("span",Sj,Y(D(F.sentAt)),1),d("span",Aj,Y((F.teacherEmails||[]).length)+" teacher"+Y((F.teacherEmails||[]).length===1?"":"s"),1),F.successful>0?(O(),B("span",Tj," "+Y(F.successful)+" sent",1)):_e("",!0),F.failed>0?(O(),B("span",wj," "+Y(F.failed)+" failed",1)):_e("",!0)]),F.formUrl||F.sheetUrl?(O(),B("div",Cj,[F.formUrl?(O(),B("a",{key:0,href:F.formUrl,target:"_blank",class:"history-link"}," Form",8,Ij)):_e("",!0),F.sheetUrl?(O(),B("a",{key:1,href:F.sheetUrl,target:"_blank",class:"history-link"}," Sheet",8,kj)):_e("",!0)])):_e("",!0)]))),128))])])):_e("",!0),l.value?(O(),B("div",{key:3,class:Qe(`status-message ${c.value}`)},[Ce(Y(l.value)+" ",1),c.value==="success"&&u.value?(O(),B("div",Dj,[d("div",Pj,[A[16]||(A[16]=d("h5",null," Form Opened Successfully!",-1)),d("p",Rj,[d("strong",null,Y(u.value.message),1)]),d("div",Fj,[d("p",null,[A[13]||(A[13]=Ce("  Form opened for ")),d("strong",null,Y(u.value.sent),1),Ce(" teacher"+Y(u.value.sent===1?"":"s"),1)]),u.value.studentInitials?(O(),B("p",Nj,[A[14]||(A[14]=Ce("  Student: ")),d("strong",null,Y(u.value.studentInitials),1),Ce(" - "+Y(u.value.studentName),1)])):_e("",!0),d("p",Oj,[A[15]||(A[15]=Ce("  Form Link: ")),d("a",{href:u.value.formUrl,target:"_blank"},Y((R=y.value)==null?void 0:R.title),9,Mj)])])])])):_e("",!0)],2)):_e("",!0)]),d("div",Lj,[d("button",{onClick:T,class:"secondary-btn"},"Cancel"),d("button",{onClick:S,class:"primary-btn",disabled:!x.value||o.value},[o.value?(O(),B("span",Uj,"Creating Form...")):(O(),B("span",$j," Create New Form"))],8,Bj)])])])}}},Hj=xt(Vj,[["__scopeId","data-v-f8c1ccfe"]]),jj={class:"students-view"},Gj={class:"page-header"},Wj={class:"header-left"},zj={class:"search-container"},Kj={class:"header-controls"},qj={class:"filter-group sort-group"},Xj={key:0,class:"filter-group"},Yj={class:"radio-group"},Qj=["title"],Jj=["value"],Zj={class:"filter-group"},eG={class:"radio-group"},tG=["checked"],rG=["checked","disabled"],nG={key:0,class:"disabled-icon"},sG=["checked"],aG={key:0,class:"selected-radio-display"},iG={key:1,class:"filters-panel"},oG={class:"filters-content"},lG={class:"filter-group"},cG=["value"],uG={class:"filter-group"},dG=["value"],fG={class:"filter-group"},hG=["value"],pG={class:"filter-group"},mG={class:"content"},gG={class:"print-user-name"},vG={key:0},yG={key:1,class:"view-container"},xG={key:0,class:"group-section"},EG={class:"group-header"},_G={key:2,class:"view-section"},bG={__name:"StudentsView",setup(t){const e=Fs(),r=z7(),n=q7(r),s=nU(r,n),i=iU(r),{students:a,userMapObj:o,caseManagers:l,teacherList:c,userRoles:u,aideAssignment:f,paraeducators:h,currentUser:p,isAdmin:v,showProviderView:g,getStudentById:y}=r,{showFilters:b,currentFilters:E,toggleFilters:x,applyFilters:I,debouncedApplyFilters:D}=n,{visibleStudents:P,canEditAllStudents:w,canEditOwnStudents:S,canViewAllStudents:m,canAccessTesting:T,canAccessTestingPartial:_,canAccessFilters:A,isClassViewDisabled:k,setViewMode:U,providerViewOptions:L}=s,R=aU(r,n,be(()=>s.visibleStudents.value)),{currentViewMode:F,studentsByClass:N,directAssignmentStudents:M,testingViewStudents:z}=R,{editingStudentId:G,emailingStudentId:H,showExport:j,showAddStudent:K,showFeedbackDialog:ne,feedbackStudentId:he,editStudent:le,emailStudent:fe,handleTeacherFeedback:te,handleFormSent:Z,handleStudentAdded:xe,handleStudentSaved:Q,handleNavAction:q}=i,J=ge=>{var ie;const ee=(ie=p.value)==null?void 0:ie.role;switch(ge){case"all_iep":return"CM+SP";case"case_manager":return"Case Manager";case"service_provider":return"Service Provider";case"teacher":return"Service Provider";case"all":return ee==="sped_chair"?"All students (with IEPs)":"All students";default:return"All students"}};be(()=>{var ee;return L!=null&&L.value?L.value:((ee=p.value)==null?void 0:ee.role)==="case_manager"?[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}]});const pe=be(()=>{var ee;const ge=[];if(E.providerView&&((ee=L==null?void 0:L.value)!=null&&ee.length)){const ie=J(E.providerView);ie&&ge.push(ie)}if(E.viewMode){let ie="";switch(E.viewMode){case"list":ie="List view";break;case"class":ie="Class-period view";break;case"testing":ie="Separate Setting For Testing";break}ie&&ge.push(ie)}return ge.length>0?ge.join(" | "):""});return(ge,ee)=>{var ie,ve,we,De,Te,ze,ke,Ve;return O(),B("div",jj,[Le(_U,{"current-user":X(p),"is-admin":X(v),onAction:X(q)},null,8,["current-user","is-admin","onAction"]),d("div",Gj,[d("div",Wj,[ee[23]||(ee[23]=d("h1",null,"Student Management",-1)),d("div",zj,[Be(d("input",{type:"text","onUpdate:modelValue":ee[0]||(ee[0]=Ae=>X(E).search=Ae),onInput:ee[1]||(ee[1]=(...Ae)=>X(D)&&X(D)(...Ae)),placeholder:"Search students...",class:"search-input"},null,544),[[ht,X(E).search]])])]),d("div",Kj,[d("div",qj,[Le(X(UB),{size:16,class:"sort-icon"}),Be(d("select",{"onUpdate:modelValue":ee[2]||(ee[2]=Ae=>X(E).sortBy=Ae),onChange:ee[3]||(ee[3]=Ae=>X(I)()),class:"sort-select"},ee[24]||(ee[24]=[In('<option value="firstName" data-v-ea3d4ede>First Names</option><option value="lastName" data-v-ea3d4ede>Last Name</option><option value="grade" data-v-ea3d4ede>Grade</option><option value="reviewDate" data-v-ea3d4ede>Plan Review Date</option><option value="reevalDate" data-v-ea3d4ede>Re-evaluation Date</option><option value="meetingDate" data-v-ea3d4ede>Meeting Date</option>',6)]),544),[[cr,X(E).sortBy]])]),X(L)&&X(L).length?(O(),B("div",Xj,[d("div",Yj,[(O(!0),B(Fe,null,He(X(L),Ae=>(O(),B("label",{key:Ae.value,class:Qe(["radio-btn icon-btn",{active:X(E).providerView===Ae.value}]),title:J(Ae.value)},[Be(d("input",{type:"radio","onUpdate:modelValue":ee[4]||(ee[4]=Ge=>X(E).providerView=Ge),value:Ae.value,onChange:ee[5]||(ee[5]=(...Ge)=>X(I)&&X(I)(...Ge))},null,40,Jj),[[ma,X(E).providerView]]),Ae.value==="all_iep"?(O(),tr(X(jl),{key:0,size:16})):Ae.value==="case_manager"?(O(),tr(X($v),{key:1,size:16})):Ae.value==="service_provider"||Ae.value==="teacher"?(O(),tr(X(s7),{key:2,size:16})):Ae.value==="all"?(O(),tr(X(qB),{key:3,size:16})):_e("",!0)],10,Qj))),128))])])):_e("",!0),d("div",Zj,[d("div",eG,[d("label",{class:Qe(["radio-btn icon-btn",{active:X(E).viewMode==="list"}]),title:"List view"},[d("input",{type:"radio",value:"list",checked:X(E).viewMode==="list",onChange:ee[6]||(ee[6]=Ae=>X(U)("list"))},null,40,tG),Le(X(ZB),{size:16})],2),d("label",{class:Qe(["radio-btn icon-btn",{active:X(E).viewMode==="class",disabled:X(k)}]),title:"Class-period view"},[d("input",{type:"radio",value:"class",checked:X(E).viewMode==="class",onChange:ee[7]||(ee[7]=Ae=>X(U)("class")),disabled:X(k)},null,40,rG),Le(X(WB),{size:16,class:Qe({strikethrough:X(k)})},null,8,["class"]),X(k)?(O(),B("span",nG,"")):_e("",!0)],2),X(T)?(O(),B("label",{key:0,class:Qe(["radio-btn icon-btn",{active:X(E).viewMode==="testing"}]),title:"Separate Setting For Testing"},[d("input",{type:"radio",value:"testing",checked:X(E).viewMode==="testing",onChange:ee[8]||(ee[8]=Ae=>X(U)("testing"))},null,40,sG),Le(X(Ov),{size:16})],2)):_e("",!0)])]),X(A)?(O(),B("button",{key:1,onClick:ee[9]||(ee[9]=(...Ae)=>X(x)&&X(x)(...Ae)),class:Qe(["radio-btn icon-btn filter-toggle-btn",{active:X(b)}]),title:"Toggle filters"},[Le(X(KB),{size:16})],2)):_e("",!0)])]),pe.value?(O(),B("div",aG,Y(pe.value),1)):_e("",!0),X(b)?(O(),B("div",iG,[d("div",oG,[d("div",lG,[ee[26]||(ee[26]=d("label",null,"Case Manager",-1)),Be(d("select",{"onUpdate:modelValue":ee[10]||(ee[10]=Ae=>X(E).cm=Ae),onChange:ee[11]||(ee[11]=Ae=>X(I)()),class:"filter-select"},[ee[25]||(ee[25]=d("option",{value:"all"},"All Case Managers",-1)),(O(!0),B(Fe,null,He(X(l),Ae=>(O(),B("option",{key:Ae.id,value:Ae.id},Y(Ae.name||Ae.email||Ae.id),9,cG))),128))],544),[[cr,X(E).cm]])]),d("div",uG,[ee[28]||(ee[28]=d("label",null,"Teacher",-1)),Be(d("select",{"onUpdate:modelValue":ee[12]||(ee[12]=Ae=>X(E).teacher=Ae),onChange:ee[13]||(ee[13]=Ae=>X(I)()),class:"filter-select"},[ee[27]||(ee[27]=d("option",{value:"all"},"All Teachers",-1)),(O(!0),B(Fe,null,He(X(c),Ae=>(O(),B("option",{key:Ae.id,value:Ae.id},Y(Ae.name||Ae.email||Ae.id),9,dG))),128))],544),[[cr,X(E).teacher]])]),d("div",fG,[ee[30]||(ee[30]=d("label",null,"Paraeducator",-1)),Be(d("select",{"onUpdate:modelValue":ee[14]||(ee[14]=Ae=>X(E).paraeducator=Ae),onChange:ee[15]||(ee[15]=Ae=>X(I)()),class:"filter-select"},[ee[29]||(ee[29]=d("option",{value:"all"},"All Paraeducators",-1)),(O(!0),B(Fe,null,He(X(h),Ae=>(O(),B("option",{key:Ae.id,value:Ae.id},Y(Ae.name||Ae.email||Ae.id),9,hG))),128))],544),[[cr,X(E).paraeducator]])]),d("div",pG,[ee[32]||(ee[32]=d("label",null,"Plan Type",-1)),Be(d("select",{"onUpdate:modelValue":ee[16]||(ee[16]=Ae=>X(E).plan=Ae),onChange:ee[17]||(ee[17]=Ae=>X(I)()),class:"filter-select"},ee[31]||(ee[31]=[d("option",{value:"all"},"All Plans",-1),d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),544),[[cr,X(E).plan]])])])])):_e("",!0),d("div",mG,[d("div",gG,Y(((ie=X(e).currentUser)==null?void 0:ie.name)||((ve=X(e).currentUser)==null?void 0:ve.email)||((we=X(e).currentUser)==null?void 0:we.displayName)||((De=X(p))==null?void 0:De.name)||((Te=X(p))==null?void 0:Te.email)||"System User"),1),X(F)==="list"?(O(),B("div",vG,[Le(Wf,{students:X(P),"user-map":X(o),"current-user":X(p),"student-data":X(r),"can-edit-all":X(w),"can-edit-own":X(S),"can-view-all":X(m),"can-access-testing":X(T),"can-access-testing-partial":X(_),"aide-schedule":((ze=X(p))==null?void 0:ze.role)==="paraeducator"?X(f):{},onEdit:X(le),onEmail:X(fe),onTeacherFeedback:X(te)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):X(F)==="class"?(O(),B("div",yG,[X(M).length>0?(O(),B("div",xG,[ee[33]||(ee[33]=d("h3",{class:"group-header direct-assignment-header"},"Direct Assignment",-1)),Le(Wf,{students:X(M),"user-map":X(o),"current-user":X(p),"student-data":X(r),"can-edit-all":X(w),"can-edit-own":X(S),"can-view-all":X(m),"can-access-testing":X(T),"can-access-testing-partial":X(_),"aide-schedule":((ke=X(p))==null?void 0:ke.role)==="paraeducator"?X(f):{},onEdit:X(le),onEmail:X(fe),onTeacherFeedback:X(te)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):_e("",!0),(O(!0),B(Fe,null,He(X(N),(Ae,Ge)=>{var Ke;return O(),B("div",{key:Ge,class:"group-section"},[d("h3",EG,"Period "+Y(Ge),1),Le(Wf,{students:Ae,"user-map":X(o),"current-user":X(p),"student-data":X(r),"can-edit-all":X(w),"can-edit-own":X(S),"can-view-all":X(m),"can-access-testing":X(T),"can-access-testing-partial":X(_),"aide-schedule":((Ke=X(p))==null?void 0:Ke.role)==="paraeducator"?X(f):{},onEdit:X(le),onEmail:X(fe),onTeacherFeedback:X(te)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])}),128))])):X(F)==="testing"?(O(),B("div",_G,[Le(Wf,{students:X(z),"user-map":X(o),"current-user":X(p),"student-data":X(r),"can-edit-all":X(w),"can-edit-own":X(S),"can-view-all":X(m),"can-access-testing":X(T),"can-access-testing-partial":X(_),"testing-view":!0,"aide-schedule":((Ve=X(p))==null?void 0:Ve.role)==="paraeducator"?X(f):{},onEdit:X(le),onEmail:X(fe),onTeacherFeedback:X(te)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):_e("",!0)]),X(G)?(O(),tr(bH,{key:2,"student-id":X(G),users:{userRoles:X(u)},onClose:ee[18]||(ee[18]=Ae=>G.value=null),onSaved:X(Q)},null,8,["student-id","users","onSaved"])):_e("",!0),X(H)?(O(),tr(NH,{key:3,student:X(y)(X(H)),"user-map":X(o),onClose:ee[19]||(ee[19]=Ae=>H.value=null)},null,8,["student","user-map"])):_e("",!0),X(j)?(O(),tr(zH,{key:4,students:X(a),"user-map":X(o),onClose:ee[20]||(ee[20]=Ae=>j.value=!1)},null,8,["students","user-map"])):_e("",!0),X(K)?(O(),tr(Zy,{key:5,users:{userRoles:X(u)},onClose:ee[21]||(ee[21]=Ae=>K.value=!1),onSaved:X(xe)},null,8,["users","onSaved"])):_e("",!0),X(ne)?(O(),tr(Hj,{key:6,student:X(y)(X(he)),"current-user":X(p),"user-map":X(o),onClose:ee[22]||(ee[22]=Ae=>ne.value=!1),onFormSent:X(Z)},null,8,["student","current-user","user-map","onFormSent"])):_e("",!0)])}}},SG=xt(bG,[["__scopeId","data-v-ea3d4ede"]]),AG={class:"login-container"},TG={__name:"LoginView",setup(t){const e=Ci(),r=async()=>{try{const{user:n}=await q1(St,U4),s=Ze(qe,"users",n.uid);(await nr(s)).exists()||await Ht(s,{name:n.displayName||"",email:n.email,role:"admin"}),e.push({name:"Home"})}catch(n){console.error("Login failed:",n),alert("Login failed: "+n.message)}};return(n,s)=>(O(),B("div",AG,[s[0]||(s[0]=d("h1",null,"Case Manager Portal",-1)),s[1]||(s[1]=d("p",null,"Please sign in with your Google account:",-1)),d("button",{onClick:r,class:"primary-btn"}," Sign in with Google ")]))}},wG=xt(TG,[["__scopeId","data-v-d9b5a53b"]]),CG={name:"TabBar",props:{tabs:{type:Array,required:!0,default:()=>[]},activeTab:{type:String,required:!0}},emits:["tab-change"],methods:{getStatusIcon(t){switch(t){case"not-active":return"";case"not-working":return"";default:return""}},getStatusTooltip(t){switch(t){case"not-active":return" = Not active";case"not-working":return" = Not working";default:return""}}}},IG={class:"admin-tab-bar"},kG=["onClick","title"];function DG(t,e,r,n,s,i){return O(),B("div",IG,[(O(!0),B(Fe,null,He(r.tabs,a=>(O(),B("button",{key:a.key,class:Qe({active:r.activeTab===a.key}),onClick:o=>t.$emit("tab-change",a.key),title:i.getStatusTooltip(a.status)},[Ce(Y(a.label)+" ",1),a.status?(O(),B("span",{key:0,class:Qe(["status-indicator",a.status])},Y(i.getStatusIcon(a.status)),3)):_e("",!0)],10,kG))),128))])}const PG=xt(CG,[["render",DG],["__scopeId","data-v-5be36c07"]]),RG={name:"UserAddForm",setup(){const t=Da(B4,"addUserWithRole"),e=yo(),r=Rs({name:"",email:"",role:"",provider:"",aeriesId:""}),n=se(null),s=se(""),i=se(!1),a=se(null),o=uc,{appSettings:l,loadAppSettings:c}=qs(),u=be(()=>{if(l&&l.value&&l.value.serviceProviders){const x=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}];return l.value.serviceProviders.map(I=>x.find(D=>D.abbreviation===I)||{name:I,abbreviation:I})}return[]}),f=(x,I=!1)=>{s.value=x,i.value=I,setTimeout(()=>{s.value="",i.value=!1},5e3)},h=async(x,I,D,P,w)=>{try{const S={name:x,email:I,role:D,provider:P,aeriesId:w,createdAt:new Date,status:"active"},m=await f4(_t(e,"users"),S);return await tn.logUserManagement(m.id,"create",{userData:{name:x,email:I,role:D,provider:P,aeriesId:w},method:"firestore_direct"}),{success:!0,userId:m.id}}catch(S){throw await tn.logUserManagement("unknown","create_failed",{error:S.message,attemptedData:{name:x,email:I,role:D,provider:P,aeriesId:w},method:"firestore_direct"}),S}},p=async(x,I,D,P,w)=>{var S,m;try{try{return await t({name:x,email:I,role:D,provider:P,aeriesId:w}),await tn.logUserManagement("cloud_function_user","create",{userData:{name:x,email:I,role:D,provider:P,aeriesId:w},method:"cloud_function"}),{success:!0,method:"cloud-function"}}catch(T){return T.code==="functions/already-exists"||(S=T.message)!=null&&S.includes("409")||(m=T.message)!=null&&m.includes("already exists")?(console.log(`User ${I} already exists in Firebase Auth, skipping...`),await tn.logUserManagement("existing_user","create_skipped",{userData:{name:x,email:I,role:D,provider:P,aeriesId:w},reason:"user_already_exists",method:"cloud_function"}),{success:!0,method:"already-exists",message:"User already exists"}):(await h(x,I,D,P,w),{success:!0,method:"firestore"})}}catch(T){return await tn.logUserManagement("unknown","create_failed",{error:T.message,attemptedData:{name:x,email:I,role:D,provider:P,aeriesId:w},method:"addUserToFirestore"}),{success:!1,error:T.message}}},v=async()=>{if(!Is("addUser",5,6e4).allowed){f("Too many requests. Please wait before adding another user.",!0);return}const I=M7(r),D=O7(I);if(!D.isValid){f(`Please fix the following errors:
${D.errors.join(`
`)}`,!0);return}const P=["name","email","aeriesId"];for(const S of P)if(I[S]){const m=qr(I[S]);if(!m.isSafe){f(`Security threat detected in ${S}: ${m.threats.join(", ")}`,!0);return}}Object.assign(r,I);const w=await p(r.name,r.email,r.role,r.provider,r.aeriesId);w.success?(f(`User ${r.name} added successfully!`),r.name="",r.email="",r.role="",r.provider="",r.aeriesId=""):f(`Error adding user: ${w.error}`,!0)},g=x=>{const I=x.target.files[0];if(I){const D=Hc(I,{allowedTypes:["csv","excel"],maxSize:5242880,fieldName:"User Import File"});if(!D.isValid){f(D.error,!0),x.target.value="";return}const P=qr(I.name);if(!P.isSafe){f(`File name contains potentially dangerous content: ${P.threats.join(", ")}`,!0),x.target.value="";return}n.value=I}},y=async()=>{if(!n.value){f("Please select a file first",!0);return}const x=n.value.name.toLowerCase();if(!(x.endsWith(".csv")||x.endsWith(".xls")||x.endsWith(".xlsx"))){f("Unsupported file type. Please upload a .csv, .xls, or .xlsx file.",!0);return}f("Processing file...");try{x.endsWith(".csv")?await b(n.value):await E(n.value)}catch(I){f(`Error processing file: ${I.message}`,!0),console.error("Bulk upload error:",I)}},b=async x=>new Promise((I,D)=>{const P=new FileReader;P.onload=async w=>{try{const m=w.target.result.trim().split(/\r?\n/);if(m.length===0){D(new Error("The CSV file is empty."));return}const T=N=>{const M=[];let z="",G=!1;for(let H=0;H<N.length;H++){const j=N[H];j==='"'?G=!G:j===","&&!G?(M.push(z.trim()),z=""):z+=j}return M.push(z.trim()),M};let _=0;const A={name:0,email:1,role:2,provider:3,aeriesId:4},k=T(m[0]);k.map(N=>N.toLowerCase()).some(N=>N.includes("name")||N.includes("email")||N.includes("role"))&&(k.forEach((N,M)=>{const z=N.trim().toLowerCase();(z==="name"||z==="displayname")&&(A.name=M),z==="email"&&(A.email=M),z==="role"&&(A.role=M),(z==="provider"||z==="providertype")&&(A.provider=M),(z==="aeriesid"||z==="aeries_id"||z==="teacherid")&&(A.aeriesId=M)}),_=1);let L=0;const R=[];for(let N=_;N<m.length;N++){const M=m[N].trim();if(!M)continue;const z=T(M),G=(z[A.name]||"").trim(),H=(z[A.email]||"").trim(),j=(z[A.role]||"").trim(),K=(z[A.provider]||"").trim(),ne=(z[A.aeriesId]||"").trim(),he=G.replace(/^"|"$/g,""),le=H.replace(/^"|"$/g,""),fe=j.replace(/^"|"$/g,""),te=K.replace(/^"|"$/g,""),Z=ne.replace(/^"|"$/g,"");if(!he||!le||!fe){R.push(`Line ${N+1}: Missing name, email, or role.`);continue}if(!O2(fe)){R.push(`Line ${N+1}: Invalid role "${fe}".`);continue}const xe=await p(he,le,fe,te,Z);xe.success?(L++,xe.method==="already-exists"&&console.log(`Line ${N+1}: User ${le} already exists, skipped`)):R.push(`Line ${N+1}: ${xe.error}`)}let F=`${L} users added successfully.`;R.length>0&&(F+=`
${R.length} errors:
`+R.join(`
`)),f(F,R.length>0),n.value=null,a.value&&(a.value.value=""),I()}catch(S){D(new Error(`Error processing CSV file: ${S.message}`))}},P.onerror=()=>D(new Error("Failed to read the CSV file.")),P.readAsText(x)}),E=async x=>new Promise((I,D)=>{const P=new FileReader;P.onload=async w=>{try{if(typeof XLSX>"u"){D(new Error("Excel upload requires SheetJS (XLSX) library. Please include it in your page."));return}const S=new Uint8Array(w.target.result),m=XLSX.read(S,{type:"array"}),T=m.SheetNames[0],_=m.Sheets[T],A=XLSX.utils.sheet_to_json(_,{defval:""});if(A.length===0){D(new Error("The Excel file is empty or unrecognized."));return}let k=0;const U=[];for(let R=0;R<A.length;R++){const F=A[R];let N="",M="",z="",G="",H="";for(const ne in F){const he=ne.toLowerCase(),le=(""+F[ne]).trim();(he==="name"||he==="displayname")&&!N?N=le:he==="email"&&!M?M=le:he==="role"&&!z?z=le:(he==="provider"||he==="providertype")&&!G?G=le:(he==="aeriesid"||he==="aeries_id"||he==="teacherid")&&!H&&(H=le)}const j=Object.values(F).map(ne=>(""+ne).trim());if(!N&&j[0]&&(N=j[0]),!M&&j[1]&&(M=j[1]),!z&&j[2]&&(z=j[2]),!G&&j[3]&&(G=j[3]),!H&&j[4]&&(H=j[4]),!N||!M||!z){U.push(`Row ${R+1}: Missing name, email, or role.`);continue}if(!O2(z)){U.push(`Row ${R+1}: Invalid role "${z}".`);continue}const K=await p(N,M,z,G,H);K.success?(k++,K.method==="already-exists"&&console.log(`Row ${R+1}: User ${M} already exists, skipped`)):U.push(`Row ${R+1}: ${K.error}`)}let L=`${k} users added successfully.`;U.length>0&&(L+=`
${U.length} errors:
`+U.join(`
`)),f(L,U.length>0),n.value=null,a.value&&(a.value.value=""),I()}catch(S){D(new Error(`Error processing Excel file: ${S.message}`))}},P.onerror=()=>D(new Error("Failed to read the Excel file.")),P.readAsArrayBuffer(x)});return jt(async()=>{await c()}),{singleUser:r,validRoles:o,providerOptions:u,addSingleUser:v,selectedFile:n,statusMessage:s,isError:i,bulkFileInput:a,handleFileSelect:g,uploadBulkUsers:y,appSettings:l}}},FG={class:"add-user-wrapper"},NG={class:"add-single"},OG=["value"],MG={key:0},LG=["value"],BG={class:"add-bulk"},UG=["disabled"];function $G(t,e,r,n,s,i){return O(),B("div",FG,[d("div",NG,[e[16]||(e[16]=d("h3",null,"Add Single User",-1)),d("form",{onSubmit:e[5]||(e[5]=dn((...a)=>n.addSingleUser&&n.addSingleUser(...a),["prevent"])),class:"form-grid"},[d("div",null,[d("label",null,[e[8]||(e[8]=Ce(" Name: ")),Be(d("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>n.singleUser.name=a),required:"",autocomplete:"off","data-lpignore":"true"},null,512),[[ht,n.singleUser.name]])])]),d("div",null,[d("label",null,[e[9]||(e[9]=Ce(" Email: ")),Be(d("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>n.singleUser.email=a),required:"",autocomplete:"off","data-lpignore":"true"},null,512),[[ht,n.singleUser.email]])])]),d("div",null,[d("label",null,[e[11]||(e[11]=Ce(" Role: ")),Be(d("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>n.singleUser.role=a),required:""},[e[10]||(e[10]=d("option",{value:"",disabled:""},"Select role...",-1)),(O(!0),B(Fe,null,He(n.validRoles,a=>(O(),B("option",{key:a,value:a},Y(a),9,OG))),128))],512),[[cr,n.singleUser.role]])])]),n.providerOptions.length>0?(O(),B("div",MG,[d("label",null,[e[13]||(e[13]=Ce(" Provider Type: ")),Be(d("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>n.singleUser.provider=a)},[e[12]||(e[12]=d("option",{value:""},"None",-1)),(O(!0),B(Fe,null,He(n.providerOptions,a=>(O(),B("option",{key:a.abbreviation,value:a.abbreviation},Y(a.name)+" ("+Y(a.abbreviation)+") ",9,LG))),128))],512),[[cr,n.singleUser.provider]])])])):_e("",!0),d("div",null,[d("label",null,[e[14]||(e[14]=Ce(" Aeries ID: ")),Be(d("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=a=>n.singleUser.aeriesId=a),placeholder:"Optional Aeries Teacher ID"},null,512),[[ht,n.singleUser.aeriesId]])])]),e[15]||(e[15]=d("button",{type:"submit"},"Add User",-1))],32)]),d("div",BG,[e[17]||(e[17]=d("h3",null,"Bulk Upload Users",-1)),d("div",null,[d("input",{type:"file",ref:"bulkFileInput",accept:".csv, .xls, .xlsx",onChange:e[6]||(e[6]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[7]||(e[7]=(...a)=>n.uploadBulkUsers&&n.uploadBulkUsers(...a)),disabled:!n.selectedFile}," Upload Users ",8,UG)]),e[18]||(e[18]=In(`<h4 data-v-9f1e8c9c>Example Formatting</h4><div data-v-9f1e8c9c>File needs to be in .csv, .xls, .xlsx format, like an Excel spreadsheet.</div><div class="example-format" data-v-9f1e8c9c><p data-v-9f1e8c9c><strong data-v-9f1e8c9c>CSV Format:</strong></p><pre data-v-9f1e8c9c>Name,Email,Role,Provider,AeriesID
&quot;John Smith&quot;,&quot;john.smith@school.org&quot;,&quot;teacher&quot;,&quot;&quot;,&quot;123456&quot;
&quot;Jane Doe&quot;,&quot;jane.doe@school.org&quot;,&quot;service_provider&quot;,&quot;SLP&quot;,&quot;789012&quot;
&quot;Bob Johnson&quot;,&quot;bob.johnson@school.org&quot;,&quot;case_manager&quot;,&quot;&quot;,&quot;&quot;</pre><p data-v-9f1e8c9c><strong data-v-9f1e8c9c>Supported Roles:</strong> admin, teacher, case_manager, sped_chair, service_provider</p><p data-v-9f1e8c9c><strong data-v-9f1e8c9c>Provider Types:</strong> SLP, OT, PT, SC, MH, TR, AUD, VI, AT, DHH, O&amp;M, BIS, HN, SW</p><p data-v-9f1e8c9c><strong data-v-9f1e8c9c>Aeries ID:</strong> Optional 6-digit teacher ID from Aeries system</p></div>`,3))]),n.statusMessage?(O(),B("div",{key:0,class:Qe(["status-msg",{error:n.isError}])},Y(n.statusMessage),3)):_e("",!0)])}const VG=xt(RG,[["render",$G],["__scopeId","data-v-9f1e8c9c"]]),Rl=se(null);function sf(){const t=new Promise(e=>{const r=ip(St,async n=>{if(n)try{const s=Ze(qe,"users",n.uid),i=await nr(s);i.exists()?Rl.value={uid:n.uid,email:n.email,displayName:n.displayName,...i.data()}:(console.warn(`User ${n.uid} exists in Auth but not in users collection`),Rl.value={uid:n.uid,email:n.email,displayName:n.displayName,role:null})}catch(s){console.error("Error fetching user document:",s),Rl.value={uid:n.uid,email:n.email,displayName:n.displayName,role:null}}else Rl.value=null;e(Rl.value),r()})});return{currentUser:Rl,waitForAuthInit:t}}const Ya=se({}),zf=se(!1),cg=se(!1);function gI(){const{currentUser:t}=sf(),e=async()=>{if(zf.value||cg.value)return Ya.value;zf.value=!0;try{const a=Ze(qe,"app_settings","admin_panel_permissions"),o=await nr(a);return o.exists()?Ya.value=o.data():Ya.value={},cg.value=!0,Ya.value}catch(a){return console.error("Error loading admin panel permissions:",a),Ya.value={},Ya.value}finally{zf.value=!1}},r=be(()=>a=>{var l,c;if(!((l=t.value)!=null&&l.role)||!Ya.value[a])return!1;const o=t.value.role;return o==="admin"?!0:((c=Ya.value[a])==null?void 0:c[o])===!0}),n=be(()=>r.value("delete-all-users")),s=be(()=>r.value("delete-all-students"));return{permissions:Ya,isLoading:zf,hasPermission:r,canDeleteAllUsers:n,canDeleteAllStudents:s,loadPermissions:e,initializeIfNeeded:async()=>{cg.value||await e()}}}const uu=20,HG={name:"UserTable",setup(){const t=yo(),e=se([]),r=se(1),n=se("name"),s=se(""),i=se(null),a=se(""),o=se(!1),l=se(!1),c=se([]),u=se(null),f=uc,h=qs(),p=h.appSettings,v=h.loadAppSettings,{canDeleteAllUsers:g,initializeIfNeeded:y}=gI();let b=null;const E=()=>{b&&clearTimeout(b),b=setTimeout(()=>{P()},300)},x=be(()=>{var F;return Array.isArray((F=p.value)==null?void 0:F.serviceProviders)&&p.value.serviceProviders.length>0}),I=be(()=>{var F;return((F=p.value)==null?void 0:F.serviceProviders)||[]}),D=(F,N=!1)=>{a.value=F,o.value=N,F&&setTimeout(()=>{a.value="",o.value=!1},5e3)},P=()=>{r.value=1,w()},w=async(F="first")=>{const N=_t(t,"users");let M;if(s.value&&n.value==="name"){const H=(await Gt(or(N,hn("name"),ia(1e3)))).docs.map(j=>({id:j.id,...j.data()})).filter(j=>(j.name||"").toLowerCase().includes(s.value.toLowerCase()));i.value=null,e.value=H,l.value=!1;return}s.value&&n.value==="email"?M=or(N,hn("email"),Ur("email",">=",s.value),Ur("email","<=",s.value+""),ia(uu)):s.value?M=or(N,hn("name"),Ur("name",">=",s.value),Ur("name","<=",s.value+""),ia(uu)):M=or(N,hn("name"),ia(uu)),F==="next"&&c.value.length&&(M=or(N,hn(n.value),hh(c.value[c.value.length-1]),ia(uu)));const z=await Gt(M);c.value=z.docs,i.value=null,e.value=c.value.map(G=>({id:G.id,...G.data()})),l.value=z.size===uu},S=F=>{i.value||(i.value=F,u.value={...e.value.find(N=>N.id===F)})},m=()=>{i.value=null,u.value=null,w()},T=(F,N,M)=>{u.value&&u.value.id===F&&(u.value[N]=M)},_=async F=>{var N,M;if(!(!u.value||u.value.id!==F))try{const z=e.value.find(H=>H.id===F),G={};u.value.name!==void 0&&(G.name=((N=u.value.name)==null?void 0:N.trim())||null),u.value.title!==void 0&&(G.title=((M=u.value.title)==null?void 0:M.trim())||null),u.value.role!==void 0&&(G.role=u.value.role),u.value.provider!==void 0&&(G.provider=u.value.provider||null),await Rp(Ze(t,"users",F),G),await tn.logUserManagement(F,"update",{originalData:{name:z==null?void 0:z.name,title:z==null?void 0:z.title,role:z==null?void 0:z.role,provider:z==null?void 0:z.provider},updatedData:G,changedFields:Object.keys(G)}),D(" User updated."),i.value=null,u.value=null,w()}catch(z){console.error("Error updating user:",z),D(` Error updating user: ${z.message}`,!0),await tn.logUserManagement(F,"update_failed",{error:z.message,attemptedData:updateData})}},A=async F=>{if(confirm("Are you sure you want to delete this user?"))try{const N=e.value.find(M=>M.id===F);await po(Ze(t,"users",F)),await tn.logUserManagement(F,"delete",{deletedUser:{name:N==null?void 0:N.name,email:N==null?void 0:N.email,role:N==null?void 0:N.role,provider:N==null?void 0:N.provider}}),D(" User deleted."),i.value=null,u.value=null,w()}catch(N){console.error("Error deleting user:",N),D(` Error deleting user: ${N.message}`,!0),await tn.logUserManagement(F,"delete_failed",{error:N.message})}},k=async()=>{if(prompt("Type DELETE ALL USERS to confirm:")==="DELETE ALL USERS")try{const N=await Gt(_t(t,"users"));await Promise.all(N.docs.map(M=>po(Ze(t,"users",M.id)))),D(" All users deleted."),r.value=1,w()}catch(N){console.error("Error deleting all users:",N),D(` Error deleting all users: ${N.message}`,!0)}},U=()=>{r.value++,w("next")},L=()=>{r.value>1&&(r.value--,w())},R=F=>{var H;if(!F)return"";const M=(((H=p.value)==null?void 0:H.customServiceProviders)||[]).find(j=>j.abbreviation===F);if(M)return`${M.name} (${M.abbreviation})`;const G=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}].find(j=>j.abbreviation===F);return G?`${G.name} (${G.abbreviation})`:F};return jt(async()=>{await v(),await y(),w()}),Va(()=>{b&&clearTimeout(b)}),{users:e,currentPage:r,searchType:n,searchTerm:s,activeRowId:i,statusMessage:a,isError:o,hasNextPage:l,validRoles:f,handleSearch:P,debouncedHandleSearch:E,startEdit:S,cancelEdit:m,updateUserField:T,saveUser:_,deleteUser:A,deleteAllUsers:k,loadNextPage:U,loadPreviousPage:L,getProviderLabel:R,appSettings:p,editingUser:u,providersLoaded:x,serviceProviders:I,canDeleteAllUsers:g}}},jG={class:"admin-form-row"},GG={class:"search-type-radios"},WG={class:"user-admin-table striped"},zG={key:0},KG=["data-userid"],qG=["value","disabled","onInput"],XG=["value","disabled","onInput"],YG=["disabled","value","onChange"],QG=["value"],JG={key:0},ZG={key:0},eW={key:1},tW=["value","onChange"],rW=["value"],nW={key:1},sW={class:"admin-action-btns"},aW=["onClick"],iW=["onClick"],oW=["onClick"],lW={class:"admin-pagination"},cW=["disabled"],uW=["disabled"];function dW(t,e,r,n,s,i){const a=fr("Edit"),o=fr("Save"),l=fr("X"),c=fr("Trash2");return O(),B("div",null,[e[16]||(e[16]=d("h2",null,"Edit Users",-1)),d("div",jG,[Be(d("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=u=>n.searchTerm=u),placeholder:"Search by name or email",class:"admin-search-input",onInput:e[1]||(e[1]=(...u)=>n.debouncedHandleSearch&&n.debouncedHandleSearch(...u))},null,544),[[ht,n.searchTerm]]),d("div",GG,[d("label",null,[Be(d("input",{type:"radio","onUpdate:modelValue":e[2]||(e[2]=u=>n.searchType=u),value:"name",onChange:e[3]||(e[3]=(...u)=>n.handleSearch&&n.handleSearch(...u))},null,544),[[ma,n.searchType]]),e[10]||(e[10]=Ce(" Name "))]),d("label",null,[Be(d("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=u=>n.searchType=u),value:"email",onChange:e[5]||(e[5]=(...u)=>n.handleSearch&&n.handleSearch(...u))},null,544),[[ma,n.searchType]]),e[11]||(e[11]=Ce(" Email "))])]),n.canDeleteAllUsers?(O(),B("button",{key:0,onClick:e[6]||(e[6]=(...u)=>n.deleteAllUsers&&n.deleteAllUsers(...u)),class:"delete-all-btn"}," Delete All Users ")):_e("",!0)]),n.statusMessage?(O(),B("div",{key:0,class:Qe(["admin-status-msg",{error:n.isError}])},Y(n.statusMessage),3)):_e("",!0),d("div",null,[d("table",WG,[e[15]||(e[15]=d("thead",null,[d("tr",null,[d("th",null,"Name"),d("th",null,"Title"),d("th",null,"Email"),d("th",null,"Role"),d("th",null,"Provider Type"),d("th",{style:{"text-align":"center"}},"Actions")])],-1)),d("tbody",null,[n.users.length===0?(O(),B("tr",zG,e[12]||(e[12]=[d("td",{colspan:"5"},"No users found.",-1)]))):_e("",!0),(O(!0),B(Fe,null,He(n.users,u=>(O(),B("tr",{key:u.id,class:Qe({"active-row":n.activeRowId===u.id}),"data-userid":u.id},[d("td",null,[d("input",{type:"text",value:u.name||"",class:"editable-input",disabled:n.activeRowId!==u.id,onInput:f=>n.updateUserField(u.id,"name",f.target.value)},null,40,qG)]),d("td",null,[d("input",{type:"text",value:u.title||"",class:"editable-input",disabled:n.activeRowId!==u.id,onInput:f=>n.updateUserField(u.id,"title",f.target.value)},null,40,XG)]),d("td",null,Y(u.email),1),d("td",null,[d("select",{class:"editable-select",disabled:n.activeRowId!==u.id,value:n.activeRowId===u.id?n.editingUser.role:u.role,onChange:f=>n.updateUserField(u.id,"role",f.target.value)},[(O(!0),B(Fe,null,He(n.validRoles,f=>(O(),B("option",{key:f,value:f},Y(f.replace(/_/g," ")),9,QG))),128))],40,YG)]),n.providersLoaded?(O(),B("td",JG,[n.activeRowId!==u.id?(O(),B("span",ZG,Y(n.getProviderLabel(u.provider)||""),1)):(O(),B("span",eW,[d("select",{value:n.editingUser.provider||"",onChange:f=>n.updateUserField(u.id,"provider",f.target.value)},[e[13]||(e[13]=d("option",{value:""},"None",-1)),(O(!0),B(Fe,null,He(n.serviceProviders,f=>(O(),B("option",{key:f,value:f},Y(n.getProviderLabel(f)),9,rW))),128))],40,tW)]))])):(O(),B("td",nW,e[14]||(e[14]=[d("span",null,"Loading...",-1)]))),d("td",sW,[n.activeRowId!==u.id?(O(),B("button",{key:0,onClick:f=>n.startEdit(u.id),class:"admin-action-btn edit",title:"Edit"},[Le(a,{size:16})],8,aW)):(O(),B(Fe,{key:1},[d("button",{onClick:f=>n.saveUser(u.id),class:"admin-action-btn save",title:"Save"},[Le(o,{size:16})],8,iW),d("button",{onClick:e[7]||(e[7]=(...f)=>n.cancelEdit&&n.cancelEdit(...f)),class:"admin-action-btn cancel",title:"Cancel"},[Le(l,{size:16})]),d("button",{onClick:f=>n.deleteUser(u.id),class:"admin-action-btn delete red",title:"Delete User"},[Le(c,{size:16})],8,oW)],64))])],10,KG))),128))])])]),d("div",lW,[d("button",{onClick:e[8]||(e[8]=(...u)=>n.loadPreviousPage&&n.loadPreviousPage(...u)),disabled:n.currentPage===1,class:"admin-btn"}," Previous ",8,cW),d("span",null,"Page "+Y(n.currentPage),1),d("button",{onClick:e[9]||(e[9]=(...u)=>n.loadNextPage&&n.loadNextPage(...u)),disabled:!n.hasNextPage,class:"admin-btn"}," Next ",8,uW)])])}const fW=xt(HG,[["render",dW],["__scopeId","data-v-5a6d438d"]]),hW={class:"admin-students"},pW={class:"admin-form-row"},mW={class:"student-admin-table striped"},gW={key:0},vW=["data-id"],yW={style:{display:"none"}},xW=["value","disabled","onInput"],EW=["value","disabled","onInput"],_W=["value","disabled","onInput"],bW=["value","disabled","onChange"],SW=["value","disabled","onChange"],AW=["value"],TW=["title"],wW={class:"admin-action-btns"},CW=["onClick"],IW=["onClick"],kW=["onClick"],DW={class:"admin-pagination"},PW=["disabled"],RW=["disabled"],ug=50,FW={__name:"AdminStudents",setup(t){const e=yo(),{students:r,fetchStudents:n,deleteStudent:s}=Ii(),{caseManagers:i,fetchUsers:a}=_a(),{canDeleteAllStudents:o,initializeIfNeeded:l}=gI(),c=se(""),u=se([]),f=se(1),h=se(null),p=se({}),v=se(""),g=se(!1);let y=null;const b=()=>{y&&clearTimeout(y),y=setTimeout(()=>{D()},300)},E=be(()=>{const F=(f.value-1)*ug,N=F+ug;return u.value.slice(F,N)}),x=be(()=>Math.ceil(u.value.length/ug)),I=(F,N=!1)=>{v.value=F,g.value=N,setTimeout(()=>{v.value="",g.value=!1},5e3)},D=()=>{if(!Is("studentSearch",20,6e4).allowed){I("Too many search requests. Please wait before searching again.",!0);return}const N=mn(c.value,100),M=qr(N);if(!M.isSafe){I(`Security threat detected in search: ${M.threats.join(", ")}`,!0),c.value=N;return}N!==c.value&&(c.value=N);const z=N.toLowerCase();z?u.value=r.value.filter(G=>{const H=it(G,"firstName")||"",j=it(G,"lastName")||"";return`${H} ${j}`.toLowerCase().includes(z)}):u.value=r.value,f.value=1},P=F=>{var M;if(console.log(" ADMIN EDIT DEBUG - Starting edit:",{studentId:F,activeEditId:h.value,studentExists:!!r.value.find(z=>z.id===F)}),h.value)return;const N=r.value.find(z=>z.id===F);N?(console.log(" ADMIN EDIT DEBUG - Student found:",{id:N.id,hasApp:!!N.app,appStudentData:(M=N.app)==null?void 0:M.studentData,keys:Object.keys(N)}),h.value=F,p.value=JSON.parse(JSON.stringify(N)),console.log(" ADMIN EDIT DEBUG - Edit state set:",{activeEditId:h.value,editingStudentId:p.value.id})):console.error(" ADMIN EDIT DEBUG - Student not found!")},w=()=>{h.value=null,p.value={}},S=(F,N,M)=>{if(p.value.id===F){console.log(" ADMIN UPDATE DEBUG - Updating field:",{studentId:F,field:N,value:M,currentValue:it(p.value,N)});let z=M;if(N==="caseManagerId")z=M;else if(typeof M=="string"){z=mn(M,N==="grade"?10:100);const G=qr(z);if(!G.isSafe){I(`Security threat detected in ${N}: ${G.threats.join(", ")}`,!0);return}const H=Ad(z,N,0,N==="grade"?10:100);if(!H.isValid){I(H.error,!0);return}}["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(N)?(p.value.app||(p.value.app={}),p.value.app.studentData||(p.value.app.studentData={}),p.value.app.studentData[N]=z):p.value[N]=z,console.log(" ADMIN UPDATE DEBUG - Updated field:",{field:N,newValue:z,updatedPath:["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(N)?`app.studentData.${N}`:N})}},m=async F=>{var N,M,z,G,H;try{console.log(" ADMIN SAVE DEBUG - Starting saveStudent:",{studentId:F,editingStudentId:p.value.id,editingStudentKeys:Object.keys(p.value),hasStudentInList:!!r.value.find(q=>q.id===F)});const{currentUser:j}=sf();if(console.log(" PERMISSION DEBUG:",{currentUser:j.value,userRole:(N=j.value)==null?void 0:N.role,userEmail:(M=j.value)==null?void 0:M.email,userId:(z=j.value)==null?void 0:z.uid}),!Is("saveStudent",10,6e4).allowed){I("Too many save requests. Please wait before saving again.",!0);return}const ne={},he=r.value.find(q=>q.id===F),le=["firstName","lastName","grade","plan","ssid","caseManagerId"];let fe={},te=!1;if(le.forEach(q=>{const J=it(p.value,q),pe=it(he,q);J!==pe&&(fe[q]=J,te=!0,console.log(` CHANGE DETECTED - ${q}: "${pe}"  "${J}"`))}),te&&(ne.app={studentData:{...(G=he.app)==null?void 0:G.studentData,...fe}}),Object.keys(p.value).forEach(q=>{q!=="id"&&q!=="app"&&p.value[q]!==he[q]&&(ne[q]=p.value[q])}),console.log(" ADMIN SAVE DEBUG - Updates prepared:",ne),Object.keys(ne).length===0){w();return}const Z=lI(ne),xe=oI(Z,{isNew:!1});if(!xe.isValid){I(`Validation failed: ${xe.errors.join(", ")}`,!0);return}Z.updatedAt=wn(),Z.updatedBy=((H=j.value)==null?void 0:H.uid)||null,Object.assign(p.value,Z),console.log(" ADMIN SAVE DEBUG - Calling setDoc with merge:",{studentId:F,sanitizedUpdates:Z}),await Ht(Ze(e,"students",F),Z,{merge:!0}),console.log(" ADMIN SAVE DEBUG - updateStudent completed successfully");const Q=r.value.findIndex(q=>q.id===F);if(Q!==-1){const q={...r.value[Q]};Object.keys(Z).forEach(J=>{J==="app.studentData"?(q.app||(q.app={}),q.app.studentData={...q.app.studentData,...Z[J]}):q[J]=Z[J]}),r.value[Q]=q}console.log(" ADMIN SAVE DEBUG - Local state updated"),I(" Student updated.")}catch(j){console.error(" ADMIN SAVE DEBUG - Save failed:",j),I(" Update failed.",!0),console.error("Update error:",j)}finally{w()}},T=async F=>{if(!Is("deleteStudent",5,3e5).allowed){I("Too many delete requests. Please wait before deleting again.",!0);return}if(confirm("Are you sure you want to delete this student? This action cannot be undone."))try{await s(F),I(" Student deleted.");const M=r.value.findIndex(z=>z.id===F);M!==-1&&r.value.splice(M,1),D()}catch(M){I(" Delete failed.",!0),console.error("Delete error:",M)}},_=async()=>{if(!Is("deleteAllStudents",1,36e5).allowed){I("Delete all operation rate limited. Please wait before trying again.",!0);return}const N=`Are you sure you want to delete ALL ${r.value.length} students? 

This action cannot be undone and will permanently remove all student data.

Type "DELETE ALL STUDENTS" to confirm:`;if(prompt(N)!=="DELETE ALL STUDENTS"){I("Delete all operation cancelled.",!1);return}try{I("Deleting all students...");const z=Fy(e);let G=0;for(const H of r.value)z.delete(Ze(e,"students",H.id)),G++,G>=500&&(await z.commit(),G=0);G>0&&await z.commit(),r.value=[],u.value=[],I(" All students deleted.")}catch(z){I(" Failed to delete all students.",!0),console.error("Delete all error:",z)}},A=F=>{if(!F)return"N/A";try{if(F&&typeof F.toDate=="function")return F.toDate().toLocaleDateString();const N=new Date(F);return isNaN(N.getTime())?"Invalid Date":N.toLocaleDateString()}catch{return"Invalid Date"}},k=F=>{var N;return((N=F.app)==null?void 0:N.staffIds)&&Array.isArray(F.app.staffIds)&&F.app.staffIds.length>0},U=F=>k(F)?`Staff ID Array present (${F.app.staffIds.length} staff members)`:"Staff ID Array missing or empty",L=()=>{f.value<x.value&&f.value++},R=()=>{f.value>1&&f.value--};return jt(async()=>{try{await Promise.all([n(),a(),l()]),u.value=r.value,console.log(" ADMIN DEBUG - Case managers loaded:",i.value.length)}catch(F){I("Failed to load data.",!0),console.error("Load data error:",F)}}),Va(()=>{y&&clearTimeout(y)}),(F,N)=>(O(),B("div",hW,[N[5]||(N[5]=d("h2",null,"Edit Students",-1)),d("div",pW,[Be(d("input",{type:"text","onUpdate:modelValue":N[0]||(N[0]=M=>c.value=M),onInput:b,placeholder:"Search by name",class:"admin-search-input"},null,544),[[ht,c.value]]),X(o)?(O(),B("button",{key:0,onClick:_,class:"delete-all-btn"}," Delete All Students ")):_e("",!0)]),v.value?(O(),B("div",{key:0,class:Qe(["admin-status-msg",{error:g.value}])},Y(v.value),3)):_e("",!0),d("table",mW,[N[4]||(N[4]=d("thead",null,[d("tr",null,[d("th",null,"SSID"),d("th",{style:{display:"none"}},"Student ID"),d("th",null,"First Name"),d("th",null,"Last Name"),d("th",null,"Grade"),d("th",null,"Plan"),d("th",null,"Case Manager"),d("th",{title:"Staff ID Array present"},"staffIdArr"),d("th",null,"Date Added"),d("th",{style:{"text-align":"center"}},"Actions")])],-1)),d("tbody",null,[E.value.length?_e("",!0):(O(),B("tr",gW,N[1]||(N[1]=[d("td",{colspan:"10"},"No students found.",-1)]))),(O(!0),B(Fe,null,He(E.value,M=>(O(),B("tr",{key:M.id,class:Qe({"active-row":h.value===M.id}),"data-id":M.id},[d("td",null,Y(X(it)(M,"ssid")||M.id),1),d("td",yW,Y(M.id),1),d("td",null,[d("input",{class:"editable-input","data-field":"firstName",value:X(it)(M,"firstName")||"",disabled:h.value!==M.id,onInput:z=>S(M.id,"firstName",z.target.value)},null,40,xW)]),d("td",null,[d("input",{class:"editable-input","data-field":"lastName",value:X(it)(M,"lastName")||"",disabled:h.value!==M.id,onInput:z=>S(M.id,"lastName",z.target.value)},null,40,EW)]),d("td",null,[d("input",{class:"editable-input","data-field":"grade",value:X(it)(M,"grade")||"",disabled:h.value!==M.id,onInput:z=>S(M.id,"grade",z.target.value)},null,40,_W)]),d("td",null,[d("select",{class:"editable-select","data-field":"plan",value:X(it)(M,"plan")||"",disabled:h.value!==M.id,onChange:z=>S(M.id,"plan",z.target.value)},N[2]||(N[2]=[d("option",{value:""},"Select Plan",-1),d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),40,bW)]),d("td",null,[d("select",{class:"editable-select","data-field":"caseManagerId",value:X(it)(M,"caseManagerId")||"",disabled:h.value!==M.id,onChange:z=>S(M.id,"caseManagerId",z.target.value)},[N[3]||(N[3]=d("option",{value:""},"-- Select Case Manager --",-1)),(O(!0),B(Fe,null,He(X(i),z=>(O(),B("option",{key:z.id,value:z.id},Y(z.name||z.email||z.id),9,AW))),128))],40,SW)]),d("td",{class:"staff-id-status",title:U(M)},[d("span",{class:Qe(["status-icon",k(M)?"present":"missing"])},Y(k(M)?"":""),3)],8,TW),d("td",null,Y(A(M.created_at)),1),d("td",wW,[h.value===M.id?(O(),B(Fe,{key:0},[d("button",{onClick:z=>m(M.id),class:"admin-action-btn save",title:"Save"},"",8,CW),d("button",{onClick:w,class:"admin-action-btn cancel",title:"Cancel"},""),d("button",{onClick:z=>T(M.id),class:"admin-action-btn delete red",title:"Delete Student"},"",8,IW)],64)):(O(),B("button",{key:1,onClick:z=>P(M.id),class:"admin-action-btn edit",title:"Edit"},"",8,kW))])],10,vW))),128))])]),d("div",DW,[d("button",{onClick:R,disabled:f.value===1,class:"admin-btn"}," Prev ",8,PW),d("span",null,"Page "+Y(f.value)+" of "+Y(x.value),1),d("button",{onClick:L,disabled:f.value===x.value,class:"admin-btn"}," Next ",8,RW)])]))}},NW=xt(FW,[["__scopeId","data-v-ad9a4e56"]]),OW={class:"bulk-importer"},MW={key:0,class:"step-container"},LW={class:"file-upload-section"},BW={class:"file-input-wrapper"},UW={for:"csv-file",class:"file-label"},$W={class:"file-text"},VW={key:0,class:"error-message"},HW={key:1,class:"file-info"},jW={key:0},GW={class:"step-actions"},WW=["disabled"],zW={key:1,class:"step-container"},KW={class:"field-mapping-section"},qW={class:"mapping-grid"},XW={class:"csv-column"},YW={class:"app-field"},QW=["onUpdate:modelValue"],JW={class:"sample-data"},ZW={key:0,class:"validation-errors"},ez={class:"step-actions"},tz=["disabled"],rz={key:2,class:"step-container"},nz={class:"preview-section"},sz={class:"preview-stats"},az={class:"stat-item"},iz={class:"stat-value"},oz={class:"stat-item"},lz={class:"stat-value valid"},cz={class:"stat-item"},uz={class:"stat-value invalid"},dz={class:"preview-table-container"},fz={class:"preview-table"},hz={key:0,class:"error-list"},pz={key:1,class:"no-errors"},mz={class:"import-options"},gz={class:"options-grid"},vz={class:"option-item"},yz={class:"option-item"},xz={class:"option-item"},Ez={class:"step-actions"},_z=["disabled"],bz={key:3,class:"step-container"},Sz={class:"results-section"},Az={class:"results-stats"},Tz={class:"stat-item success"},wz={class:"stat-value"},Cz={class:"stat-item error"},Iz={class:"stat-value"},kz={class:"stat-item"},Dz={class:"stat-value"},Pz={key:0,class:"import-errors"},Rz={class:"results-actions"},Fz={key:4,class:"loading-overlay"},Nz={class:"loading-content"},Oz={class:"progress-bar"},Mz={__name:"StudentBulkImporter",emits:["close","imported"],setup(t,{emit:e}){const r=e,{users:n,fetchUsers:s}=_a(),i=se(1),a=se(""),o=se(""),l=se([]),c=se([]),u=se({}),f=se(""),h=se([]),p=se([]),v=se("valid-only"),g=se(!1),y=se(!1),b=se(0),E=se({successful:0,failed:0,errors:[],processingTime:0}),x=se(null),I=be(()=>{const te=["app.studentData.firstName","app.studentData.lastName","app.studentData.grade"],Z=Object.values(u.value).filter(Q=>Q),xe=Z.includes("app.studentData.ssid");return te.every(Q=>Z.includes(Q))&&xe}),D=be(()=>p.value.filter(te=>te.errors.length===0)),P=be(()=>p.value.filter(te=>te.errors.length>0));jt(async()=>{console.log(" StudentBulkImporter component mounted!");try{await s(),console.log(" Users loaded successfully:",Object.keys(n.value).length,"users"),console.log("First few users:",Object.values(n.value).slice(0,3).map(te=>({id:te.id,name:te.name,role:te.role})))}catch(te){console.error(" Failed to load users:",te)}});const w=async te=>{const Z=te.target.files[0];if(Z){if(!Z.name.toLowerCase().endsWith(".csv")&&Z.type!=="text/csv"){f.value="File must be a CSV file (.csv extension)";return}if(Z.size>10*1024*1024){f.value="File must be smaller than 10MB";return}f.value="",a.value=Z.name,o.value=z(Z.size);try{const xe=await Z.text();S(xe)}catch(xe){f.value="Failed to read CSV file: "+xe.message}}},S=te=>{try{const Z=te.trim().split(`
`);if(Z.length<2)throw new Error("CSV must have at least a header row and one data row");const xe=Z[0].split(",").map(q=>q.trim().replace(/"/g,""));c.value=xe;const Q=[];for(let q=1;q<Z.length;q++){const J={};let pe="",ge=!1,ee=0;for(let ie=0;ie<Z[q].length;ie++){const ve=Z[q][ie];ve==='"'?ge=!ge:ve===","&&!ge?(J[xe[ee]]=pe.trim().replace(/^"|"$/g,""),pe="",ee++):pe+=ve}ee<xe.length&&(J[xe[ee]]=pe.trim().replace(/^"|"$/g,"")),Q.push(J)}l.value=Q,console.log("Parsed CSV data:",Q.length,"records")}catch(Z){f.value="Failed to parse CSV: "+Z.message}},m=()=>{const te={SSID:"app.studentData.ssid",FirstName:"app.studentData.firstName",LastName:"app.studentData.lastName",Grade:"app.studentData.grade",Plan:"app.studentData.plan",CaseManagerId:"app.studentData.caseManagerId",ReviewDate:"app.dates.reviewDate",ReevalDate:"app.dates.reevalDate",MeetingDate:"app.dates.meetingDate",Period1Teacher:"app.schedule.periods.1",Period2Teacher:"app.schedule.periods.2",Period3Teacher:"app.schedule.periods.3",Period4Teacher:"app.schedule.periods.4",Period5Teacher:"app.schedule.periods.5",Period6Teacher:"app.schedule.periods.6",PeriodSHTeacher:"app.schedule.periods.SH",ClassServices:"app.schedule.classServices",SpeechProvider:"app.providers.speechId",OTProvider:"app.providers.otId",PTProvider:"app.providers.ptId",ATProvider:"app.providers.atId",Audiologist:"app.providers.audId",BISProvider:"app.providers.bisId",DHHProvider:"app.providers.dhhId",HNProvider:"app.providers.hnId",MHProvider:"app.providers.mhId",OMProvider:"app.providers.omId",SCProvider:"app.providers.scId",SWProvider:"app.providers.swId",TRProvider:"app.providers.trId",VIProvider:"app.providers.viId",Flag1:"app.flags.flag1",Flag2:"app.flags.flag2",BIPPdfUrl:"app.documents.bipPdfUrl",AtAGlancePdfUrl:"app.documents.ataglancePdfUrl",Assessment:"app.accommodations.assessment",Instruction:"app.accommodations.instruction"};c.value.forEach(Z=>{te[Z]&&(u.value[Z]=te[Z])})},T=()=>{u.value={}},_=te=>{const Z=l.value[0];if(!Z)return"";const xe=Z[te];return xe?te==="ClassServices"&&xe.includes(",")?`"${xe}"`:xe:""},A=()=>{h.value=[];const te=["app.studentData.firstName","app.studentData.lastName","app.studentData.grade"],Z=Object.values(u.value).filter(q=>q),xe=Z.includes("app.studentData.ssid");te.forEach(q=>{if(!Z.includes(q)){const J=q.split(".").pop();h.value.push(`Required field "${J}" is not mapped`)}}),xe||h.value.push("SSID (State Student ID) must be mapped to app.studentData.ssid");const Q=Z.filter((q,J)=>Z.indexOf(q)!==J);Q.length>0&&h.value.push(`Duplicate field mappings: ${Q.join(", ")}`)},k=()=>{p.value=l.value.map(te=>{const Z=U(te),xe=R(Z);return console.log("Row mapping:",{original:te,mapped:Z,errors:xe}),{data:Z,errors:xe}})},U=te=>{const Z={app:{studentData:{},dates:{},providers:{},accommodations:{},flags:{},schedule:{periods:{},classServices:[]},documents:{}}};return Object.entries(u.value).forEach(([xe,Q])=>{if(!Q||!te[xe])return;let q=te[xe].trim();if(!q)return;if(Q==="app.schedule.classServices"){q.startsWith('"')&&q.endsWith('"')&&(q=q.slice(1,-1)),Z.app.schedule.classServices=q.split(",").map(ge=>ge.trim()).filter(Boolean);return}if(Q.startsWith("app.schedule.periods.")){const ge=Q.split(".").pop(),ee=q.trim();if(ee){const ie=K(ee);console.log(`Mapping Period ${ge} teacher:`,ee,"",ie),Z.app.schedule.periods[ge]=ie}return}if(Q.startsWith("app.providers.")){const ge=Q.split(".").pop(),ee=q.trim();if(ee){const ie=ne(ee);console.log(`Mapping ${ge} provider:`,ee,"",ie),Z.app.providers[ge]=ie}return}if(Q==="app.accommodations.assessment"||Q==="app.accommodations.instruction"){const ge=Q.split(".").pop();Z.app.accommodations[ge]=q;return}if(Q.startsWith("app.flags.")){const ge=Q.split(".").pop();Z.app.flags[ge]=["true","1","yes","y"].includes(q.toLowerCase());return}if(Q.includes("Date")){const[ge,ee,ie]=Q.split(".");Z[ge][ee]||(Z[ge][ee]={}),Z[ge][ee][ie]=N(q);return}const J=Q.split(".");let pe=Z;for(let ge=0;ge<J.length-1;ge++){const ee=J[ge];pe[ee]||(pe[ee]={}),pe=pe[ee]}pe[J[J.length-1]]=q}),Z},L=te=>{const Z=Object.values(n.value).find(xe=>xe.id===te||xe.name===te||xe.email===te||xe.aeriesId===te);return console.log("Mapping case manager:",te,"to Firebase ID:",Z==null?void 0:Z.id),Z?Z.id:te},R=te=>{var Q,q,J,pe,ge,ee,ie,ve,we,De,Te,ze,ke,Ve,Ae,Ge,Ke,Ee;const Z=[],xe=te.ssid||((q=(Q=te.app)==null?void 0:Q.studentData)==null?void 0:q.ssid);return xe||Z.push("SSID is required (either top-level or in app.studentData)"),(pe=(J=te.app)==null?void 0:J.studentData)!=null&&pe.firstName||Z.push("First name is required"),(ee=(ge=te.app)==null?void 0:ge.studentData)!=null&&ee.lastName||Z.push("Last name is required"),(ve=(ie=te.app)==null?void 0:ie.studentData)!=null&&ve.grade||Z.push("Grade is required"),xe&&!/^\d{9,10}$/.test(xe)&&Z.push("SSID must be 9-10 digits"),(De=(we=te.app)==null?void 0:we.studentData)!=null&&De.grade&&!["K","1","2","3","4","5","6","7","8","9","10","11","12"].includes(te.app.studentData.grade)&&Z.push("Grade must be K-12"),(ze=(Te=te.app)==null?void 0:Te.studentData)!=null&&ze.plan&&!["IEP","504"].includes(te.app.studentData.plan)&&Z.push("Plan must be IEP or 504"),(Ve=(ke=te.app)==null?void 0:ke.dates)!=null&&Ve.reviewDate&&!F(te.app.dates.reviewDate)&&Z.push("Invalid review date format (use YYYY-MM-DD)"),(Ge=(Ae=te.app)==null?void 0:Ae.dates)!=null&&Ge.reevalDate&&!F(te.app.dates.reevalDate)&&Z.push("Invalid reevaluation date format (use YYYY-MM-DD)"),(Ee=(Ke=te.app)==null?void 0:Ke.dates)!=null&&Ee.meetingDate&&!F(te.app.dates.meetingDate)&&Z.push("Invalid meeting date format (use YYYY-MM-DD)"),Z},F=te=>{if(!te)return!0;const Z=new Date(te);return!isNaN(Z.getTime())&&te.match(/^\d{4}-\d{2}-\d{2}$/)},N=te=>{if(!te)return"";try{const Z=new Date(te);return isNaN(Z.getTime())?"":Z.toISOString().split("T")[0]}catch{return""}},M=te=>{var Q,q,J,pe;const Z=((q=(Q=te.app)==null?void 0:Q.studentData)==null?void 0:q.firstName)||"",xe=((pe=(J=te.app)==null?void 0:J.studentData)==null?void 0:pe.lastName)||"";return`${Z} ${xe}`.trim()||"Missing Name"},z=te=>{if(te===0)return"0 Bytes";const Z=1024,xe=["Bytes","KB","MB","GB"],Q=Math.floor(Math.log(te)/Math.log(Z));return parseFloat((te/Math.pow(Z,Q)).toFixed(2))+" "+xe[Q]},G=()=>{if(i.value===2){if(A(),h.value.length>0)return;k()}i.value++},H=()=>{i.value--},j=async()=>{y.value=!0,b.value=0;const te=Date.now(),Z=v.value==="valid-only"?D.value:p.value;let xe=0,Q=0;const q=[];try{for(let J=0;J<Z.length;J++){const pe=Z[J];try{await le(pe.data),xe++}catch(ge){Q++,q.push(`Row ${J+1}: ${ge.message}`)}b.value=Math.round((J+1)/Z.length*100)}E.value={successful:xe,failed:Q,errors:q,processingTime:Date.now()-te},i.value=4,r("imported",{successful:xe,failed:Q})}catch(J){console.error("Import failed:",J),q.push("Import process failed: "+J.message),E.value={successful:xe,failed:Q,errors:q,processingTime:Date.now()-te},i.value=4}finally{y.value=!1}},K=te=>{if(!te)return"";console.log(" Mapping teacher ID:",te),console.log(" Available users:",Object.values(n.value).map(Q=>({name:Q.name,aeriesId:Q.aeriesId,id:Q.id})));const Z=Object.values(n.value).find(Q=>{const q=String(Q.aeriesId)===String(te);return q&&console.log(" Found exact Aeries ID match:",{teacherId:te,user:{name:Q.name,aeriesId:Q.aeriesId,id:Q.id}}),q});if(Z)return console.log(" Using Aeries ID match:",te,"",Z.id,"(",Z.name,")"),Z.id;const xe=Object.values(n.value).find(Q=>Q.id===te);return xe?(console.log(" Using Firebase ID match:",te,"",xe.id,"(",xe.name,")"),xe.id):(console.warn(" No user found for teacher ID:",te),te)},ne=te=>{if(!te)return"";console.log(" Mapping provider ID:",te),console.log(" Available users:",Object.values(n.value).map(Q=>({name:Q.name,aeriesId:Q.aeriesId,id:Q.id})));const Z=Object.values(n.value).find(Q=>{const q=String(Q.aeriesId)===String(te);return q&&console.log(" Found exact Aeries ID match:",{providerId:te,user:{name:Q.name,aeriesId:Q.aeriesId,id:Q.id}}),q});if(Z)return console.log(" Using Aeries ID match:",te,"",Z.id,"(",Z.name,")"),Z.id;const xe=Object.values(n.value).find(Q=>Q.id===te);return xe?(console.log(" Using Firebase ID match:",te,"",xe.id,"(",xe.name,")"),xe.id):(console.warn(" No user found for provider ID:",te),te)},he=te=>{try{return te.app&&te.app.studentData&&te.app.studentData.ssid&&te.app.studentData.firstName&&te.app.studentData.lastName&&te.app.studentData.grade&&te.app.schedule&&Array.isArray(te.app.schedule.classServices)}catch{return!1}},le=async te=>{try{const Z=te.app.studentData.ssid,xe=_t(qe,"students"),Q=or(xe,Ur("app.studentData.ssid","==",Z)),q=await Gt(Q);if(!q.empty&&!g.value)throw new Error(`Student with SSID ${Z} already exists`);const J={createdAt:wn(),updatedAt:wn(),app:{studentData:{firstName:te.app.studentData.firstName||"",lastName:te.app.studentData.lastName||"",grade:te.app.studentData.grade||"",plan:te.app.studentData.plan||"",caseManagerId:L(te.app.studentData.caseManagerId)||"",ssid:Z},dates:{reviewDate:te.app.dates.reviewDate||"",reevalDate:te.app.dates.reevalDate||"",meetingDate:te.app.dates.meetingDate||""},schedule:{periods:te.app.schedule.periods||{1:"",2:"",3:"",4:"",5:"",6:"",SH:""},classServices:Array.isArray(te.app.schedule.classServices)?te.app.schedule.classServices:[]},providers:te.app.providers||{speechId:"",otId:"",ptId:"",atId:"",audId:"",bisId:"",dhhId:"",hnId:"",mhId:"",omId:"",scId:"",swId:"",trId:"",viId:""},accommodations:{assessment:te.app.accommodations.assessment||"",instruction:te.app.accommodations.instruction||""},flags:{flag1:!!te.app.flags.flag1,flag2:!!te.app.flags.flag2},documents:{bipPdfUrl:te.app.documents.bipPdfUrl||null,ataglancePdfUrl:te.app.documents.ataglancePdfUrl||null}}};if(console.log("Saving student data:",{ssid:J.app.studentData.ssid,schedule:J.app.schedule.periods,providers:J.app.providers}),!he(J))throw new Error("Invalid student data structure");if(!q.empty&&g.value){const pe=q.docs[0];await Ht(Ze(qe,"students",pe.id),J,{merge:!0})}else{const pe=Ze(_t(qe,"students"));await Ht(pe,J)}}catch(Z){throw console.error("Error importing student:",Z),Z}},fe=()=>{i.value=1,a.value="",o.value="",l.value=[],c.value=[],u.value={},f.value="",h.value=[],p.value=[],E.value={successful:0,failed:0,errors:[],processingTime:0},x.value&&(x.value.value="")};return(te,Z)=>(O(),B("div",OW,[Z[30]||(Z[30]=d("div",{style:{background:"#e8f5e8",border:"2px solid #4caf50",padding:"10px","margin-bottom":"20px","border-radius":"4px","text-align":"center"}},[d("strong",null," StudentBulkImporter Component Loaded Successfully")],-1)),Z[31]||(Z[31]=d("div",{class:"importer-header"},[d("h2",null,"Add Students - Bulk Import"),d("p",{class:"description"}," Import multiple students from a CSV file. The system will map CSV fields to the app's database structure and allow you to preview and validate the data before importing. ")],-1)),i.value===1?(O(),B("div",MW,[Z[8]||(Z[8]=d("div",{class:"step-header"},[d("h3",null,"Step 1: Upload CSV File"),d("p",null,"Select a CSV file containing student data. The first row should contain column headers.")],-1)),d("div",LW,[d("div",BW,[d("input",{type:"file",ref_key:"fileInput",ref:x,onChange:w,accept:".csv",class:"file-input",id:"csv-file"},null,544),d("label",UW,[Z[4]||(Z[4]=d("span",{class:"file-icon"},"",-1)),d("span",$W,Y(a.value||"Choose CSV File"),1)])]),f.value?(O(),B("div",VW,Y(f.value),1)):_e("",!0),a.value?(O(),B("div",HW,[d("p",null,[Z[5]||(Z[5]=d("strong",null,"File:",-1)),Ce(" "+Y(a.value),1)]),d("p",null,[Z[6]||(Z[6]=d("strong",null,"Size:",-1)),Ce(" "+Y(o.value),1)]),l.value.length>0?(O(),B("p",jW,[Z[7]||(Z[7]=d("strong",null,"Records:",-1)),Ce(" "+Y(l.value.length),1)])):_e("",!0)])):_e("",!0)]),Z[9]||(Z[9]=In('<div class="sample-format" data-v-494a4282><h4 data-v-494a4282>Expected CSV Format:</h4><div class="format-example" data-v-494a4282><code data-v-494a4282> SSID,FirstName,LastName,Grade,Plan,CaseManagerId,ReviewDate,ReevalDate,MeetingDate,Period1Teacher,Period2Teacher,Period3Teacher,Period4Teacher,Period5Teacher,Period6Teacher,SHTeacher,ClassServices,SpeechProvider,OTProvider,PTProvider,ATProvider,Audiologist,BISProvider,DHHProvider,HNProvider,MHProvider,OMProvider,SCProvider,SWProvider,TRProvider,VIProvider,Flag1,Flag2,BIPPdfUrl,AtAGlancePdfUrl,Assessment,Instruction<br data-v-494a4282> 123456789,John,Doe,9,IEP,user003,2025-07-15,2025-12-15,2025-07-10,user007,user008,user009,user010,user011,user012,user013,&quot;SDC: English,RSP: Math&quot;,user020,user021,user022,user023,user024,user025,user026,user027,user028,user029,user030,user031,user032,user033,true,false,https://example.com/bip.pdf,https://example.com/ataglance.pdf,&quot;Allow for test re-takes if the score is below average...&quot;,Divide larger projects or assignments into manageable parts... </code></div><p class="format-note" data-v-494a4282><strong data-v-494a4282>Required fields:</strong> SSID, FirstName, LastName, Grade<br data-v-494a4282><strong data-v-494a4282>App Structure:</strong> All fields map to the app data structure in your database<br data-v-494a4282><strong data-v-494a4282>Schedule fields:</strong> Period1Teacher through Period6Teacher and SHTeacher (Firebase user IDs like user001, user002, etc.)<br data-v-494a4282><strong data-v-494a4282>Provider fields:</strong> All service provider fields (Firebase user IDs like user020, user021, etc.)<br data-v-494a4282><strong data-v-494a4282>Class Services:</strong> Comma-separated list (e.g., &quot;SDC: English,RSP: Math,Co-teach: Science&quot;)<br data-v-494a4282><strong data-v-494a4282>Dates:</strong> Use YYYY-MM-DD format (e.g., 2025-07-15)<br data-v-494a4282><strong data-v-494a4282>Flags:</strong> Use true/false or 1/0<br data-v-494a4282><strong data-v-494a4282>Accommodations:</strong> Text fields for assessment and instruction<br data-v-494a4282><strong data-v-494a4282>Note:</strong> Teacher and provider IDs will be automatically mapped from names, emails, or Aeries IDs if user lookup is available </p></div>',1)),d("div",GW,[d("button",{onClick:G,disabled:!l.value.length,class:"btn btn-primary"}," Next: Map Fields ",8,WW)])])):_e("",!0),i.value===2?(O(),B("div",zW,[Z[15]||(Z[15]=d("div",{class:"step-header"},[d("h3",null,"Step 2: Map CSV Fields"),d("p",null,"Map your CSV columns to the app's database fields. Required fields are marked with *")],-1)),d("div",KW,[d("div",qW,[Z[12]||(Z[12]=In('<div class="mapping-header" data-v-494a4282><div class="csv-column" data-v-494a4282>CSV Column</div><div class="arrow" data-v-494a4282></div><div class="app-field" data-v-494a4282>App Database Field</div><div class="sample-data" data-v-494a4282>Sample Data</div></div>',1)),(O(!0),B(Fe,null,He(c.value,(xe,Q)=>(O(),B("div",{key:Q,class:"mapping-row"},[d("div",XW,[d("strong",null,Y(xe),1)]),Z[11]||(Z[11]=d("div",{class:"arrow"},"",-1)),d("div",YW,[Be(d("select",{"onUpdate:modelValue":q=>u.value[xe]=q,class:"field-select"},Z[10]||(Z[10]=[In('<option value="" data-v-494a4282>-- Skip this field --</option><optgroup label="Required Fields" data-v-494a4282><option value="app.studentData.ssid" data-v-494a4282>SSID (State Student ID) *</option><option value="app.studentData.firstName" data-v-494a4282>First Name *</option><option value="app.studentData.lastName" data-v-494a4282>Last Name *</option><option value="app.studentData.grade" data-v-494a4282>Grade *</option></optgroup><optgroup label="Student Information" data-v-494a4282><option value="app.studentData.plan" data-v-494a4282>Plan Type (IEP/504/RTI/None)</option><option value="app.studentData.caseManagerId" data-v-494a4282>Case Manager ID</option></optgroup><optgroup label="Important Dates" data-v-494a4282><option value="app.dates.reviewDate" data-v-494a4282>Review Date</option><option value="app.dates.reevalDate" data-v-494a4282>Reevaluation Date</option><option value="app.dates.meetingDate" data-v-494a4282>Meeting Date</option></optgroup><optgroup label="Class Schedule" data-v-494a4282><option value="app.schedule.periods.1" data-v-494a4282>Period 1 Teacher ID</option><option value="app.schedule.periods.2" data-v-494a4282>Period 2 Teacher ID</option><option value="app.schedule.periods.3" data-v-494a4282>Period 3 Teacher ID</option><option value="app.schedule.periods.4" data-v-494a4282>Period 4 Teacher ID</option><option value="app.schedule.periods.5" data-v-494a4282>Period 5 Teacher ID</option><option value="app.schedule.periods.6" data-v-494a4282>Period 6 Teacher ID</option><option value="app.schedule.periods.SH" data-v-494a4282>Study Hall Teacher ID</option><option value="app.schedule.classServices" data-v-494a4282>Class Services (Comma-separated)</option></optgroup><optgroup label="Service Providers" data-v-494a4282><option value="app.providers.speechId" data-v-494a4282>Speech Provider ID</option><option value="app.providers.otId" data-v-494a4282>OT Provider ID</option><option value="app.providers.ptId" data-v-494a4282>PT Provider ID</option><option value="app.providers.atId" data-v-494a4282>AT Provider ID</option><option value="app.providers.audId" data-v-494a4282>Audiologist ID</option><option value="app.providers.bisId" data-v-494a4282>BIS Provider ID</option><option value="app.providers.dhhId" data-v-494a4282>DHH Provider ID</option><option value="app.providers.hnId" data-v-494a4282>HN Provider ID</option><option value="app.providers.mhId" data-v-494a4282>MH Provider ID</option><option value="app.providers.omId" data-v-494a4282>OM Provider ID</option><option value="app.providers.scId" data-v-494a4282>SC Provider ID</option><option value="app.providers.swId" data-v-494a4282>SW Provider ID</option><option value="app.providers.trId" data-v-494a4282>TR Provider ID</option><option value="app.providers.viId" data-v-494a4282>VI Provider ID</option></optgroup><optgroup label="Flags" data-v-494a4282><option value="app.flags.flag1" data-v-494a4282>Flag 1 (Boolean)</option><option value="app.flags.flag2" data-v-494a4282>Flag 2 (Boolean)</option></optgroup><optgroup label="Documents" data-v-494a4282><option value="app.documents.bipPdfUrl" data-v-494a4282>BIP PDF URL</option><option value="app.documents.ataglancePdfUrl" data-v-494a4282>At-A-Glance PDF URL</option></optgroup><optgroup label="Accommodations" data-v-494a4282><option value="app.accommodations.assessment" data-v-494a4282>Assessment Accommodations</option><option value="app.accommodations.instruction" data-v-494a4282>Instructional Accommodations</option></optgroup>',9)]),8,QW),[[cr,u.value[xe]]])]),d("div",JW,[d("code",null,Y(_(xe)),1)])]))),128))]),d("div",{class:"auto-mapping-section"},[Z[13]||(Z[13]=d("h4",null,"Quick Mapping Options:",-1)),d("div",{class:"quick-actions"},[d("button",{onClick:m,class:"btn btn-secondary"}," Auto-map Common Fields "),d("button",{onClick:T,class:"btn btn-secondary"}," Clear All Mappings ")])]),h.value.length>0?(O(),B("div",ZW,[Z[14]||(Z[14]=d("h4",null,"Mapping Issues:",-1)),d("ul",null,[(O(!0),B(Fe,null,He(h.value,xe=>(O(),B("li",{key:xe,class:"error-item"},Y(xe),1))),128))])])):_e("",!0)]),d("div",ez,[d("button",{onClick:H,class:"btn btn-secondary"}," Back "),d("button",{onClick:G,disabled:!I.value,class:"btn btn-primary"}," Next: Preview Data ",8,tz)])])):_e("",!0),i.value===3?(O(),B("div",rz,[Z[23]||(Z[23]=d("div",{class:"step-header"},[d("h3",null,"Step 3: Preview and Validate"),d("p",null,"Review the mapped data before importing. Check for any validation errors.")],-1)),d("div",nz,[d("div",sz,[d("div",az,[Z[16]||(Z[16]=d("span",{class:"stat-label"},"Total Records:",-1)),d("span",iz,Y(l.value.length),1)]),d("div",oz,[Z[17]||(Z[17]=d("span",{class:"stat-label"},"Valid Records:",-1)),d("span",lz,Y(D.value.length),1)]),d("div",cz,[Z[18]||(Z[18]=d("span",{class:"stat-label"},"Invalid Records:",-1)),d("span",uz,Y(P.value.length),1)])]),d("div",dz,[d("table",fz,[Z[19]||(Z[19]=d("thead",null,[d("tr",null,[d("th",null,"Status"),d("th",null,"SSID"),d("th",null,"Name"),d("th",null,"Grade"),d("th",null,"Plan"),d("th",null,"Case Manager"),d("th",null,"Issues")])],-1)),d("tbody",null,[(O(!0),B(Fe,null,He(p.value,(xe,Q)=>{var q,J,pe,ge,ee,ie,ve,we;return O(),B("tr",{key:Q,class:Qe({"invalid-row":xe.errors.length>0})},[d("td",null,[d("span",{class:Qe(["status-badge",xe.errors.length>0?"error":"valid"])},Y(xe.errors.length>0?"Error":"Valid"),3)]),d("td",null,Y(xe.data.ssid||((J=(q=xe.data.app)==null?void 0:q.studentData)==null?void 0:J.ssid)||"Missing"),1),d("td",null,Y(M(xe.data)),1),d("td",null,Y(((ge=(pe=xe.data.app)==null?void 0:pe.studentData)==null?void 0:ge.grade)||"Missing"),1),d("td",null,Y(((ie=(ee=xe.data.app)==null?void 0:ee.studentData)==null?void 0:ie.plan)||"Not set"),1),d("td",null,Y(((we=(ve=xe.data.app)==null?void 0:ve.studentData)==null?void 0:we.caseManagerId)||"Not set"),1),d("td",null,[xe.errors.length>0?(O(),B("ul",hz,[(O(!0),B(Fe,null,He(xe.errors,De=>(O(),B("li",{key:De,class:"error-item"},Y(De),1))),128))])):(O(),B("span",pz,"No issues"))])],2)}),128))])])]),d("div",mz,[Z[22]||(Z[22]=d("h4",null,"Import Options:",-1)),d("div",gz,[d("label",vz,[Be(d("input",{type:"radio","onUpdate:modelValue":Z[0]||(Z[0]=xe=>v.value=xe),value:"valid-only"},null,512),[[ma,v.value]]),d("span",null,"Import only valid records ("+Y(D.value.length)+" records)",1)]),d("label",yz,[Be(d("input",{type:"radio","onUpdate:modelValue":Z[1]||(Z[1]=xe=>v.value=xe),value:"all"},null,512),[[ma,v.value]]),Z[20]||(Z[20]=d("span",null,"Import all records (may cause errors for invalid data)",-1))]),d("label",xz,[Be(d("input",{type:"checkbox","onUpdate:modelValue":Z[2]||(Z[2]=xe=>g.value=xe)},null,512),[[wt,g.value]]),Z[21]||(Z[21]=d("span",null,"Update existing students if SSID already exists",-1))])])])]),d("div",Ez,[d("button",{onClick:H,class:"btn btn-secondary"}," Back "),d("button",{onClick:j,disabled:y.value||v.value==="valid-only"&&D.value.length===0,class:"btn btn-primary"},Y(y.value?"Importing...":`Import ${v.value==="valid-only"?D.value.length:l.value.length} Students`),9,_z)])])):_e("",!0),i.value===4?(O(),B("div",bz,[Z[28]||(Z[28]=d("div",{class:"step-header"},[d("h3",null,"Step 4: Import Complete"),d("p",null,"Your bulk import has been completed. Review the results below.")],-1)),d("div",Sz,[d("div",Az,[d("div",Tz,[Z[24]||(Z[24]=d("span",{class:"stat-label"},"Successfully Imported:",-1)),d("span",wz,Y(E.value.successful),1)]),d("div",Cz,[Z[25]||(Z[25]=d("span",{class:"stat-label"},"Failed to Import:",-1)),d("span",Iz,Y(E.value.failed),1)]),d("div",kz,[Z[26]||(Z[26]=d("span",{class:"stat-label"},"Total Processing Time:",-1)),d("span",Dz,Y(E.value.processingTime)+"ms",1)])]),E.value.errors.length>0?(O(),B("div",Pz,[Z[27]||(Z[27]=d("h4",null,"Import Errors:",-1)),d("ul",null,[(O(!0),B(Fe,null,He(E.value.errors,xe=>(O(),B("li",{key:xe,class:"error-item"},Y(xe),1))),128))])])):_e("",!0),d("div",Rz,[d("button",{onClick:fe,class:"btn btn-secondary"}," Import More Students "),d("button",{onClick:Z[3]||(Z[3]=xe=>te.$emit("close")),class:"btn btn-primary"}," Close ")])])])):_e("",!0),y.value?(O(),B("div",Fz,[d("div",Nz,[Z[29]||(Z[29]=d("div",{class:"loading-spinner"},null,-1)),d("p",null,"Importing students... "+Y(b.value)+"%",1),d("div",Oz,[d("div",{class:"progress-fill",style:Nr({width:b.value+"%"})},null,4)])])])):_e("",!0)]))}},Lz=xt(Mz,[["__scopeId","data-v-494a4282"]]),Bz={class:"permissions-overview"},Uz={class:"roles-summary"},$z={class:"role-icon"},Vz={class:"role-info"},Hz={class:"role-stats"},jz={class:"stat"},Gz={class:"stat-number"},Wz={class:"stat"},zz={class:"stat-number"},Kz={class:"stat"},qz={class:"stat-number"},Xz={class:"permissions-matrix"},Yz={class:"matrix-table-container"},Qz={class:"matrix-table"},Jz=["data-role"],Zz={class:"permission-info"},eK={class:"permission-name"},tK={class:"permission-description"},rK={class:"permission-firebase"},nK={class:"admin-panel-access"},sK={class:"access-grid"},aK={class:"access-header"},iK={class:"access-icon"},oK={class:"role-name"},lK={key:0,class:"access-details"},cK={class:"access-level"},uK={class:"access-description"},dK={key:1,class:"no-access"},fK={__name:"PermissionsOverview",setup(t){const e=Z4,r=be(()=>uc.slice().sort((l,c)=>{var h,p;const u=((h=e[l])==null?void 0:h.length)||0;return(((p=e[c])==null?void 0:p.length)||0)-u})),n={admin:o7,school_admin:sI,staff_view:f7,staff_edit:Uv,admin_504:rI,sped_chair:T0,case_manager:aI,teacher:$v,paraeducator:jB,service_provider:nI},s=be(()=>r.value.map(l=>{const c=e[l]||[],u=c.some(g=>g.includes("admin_panel"));let f="No Access",h="No admin panel access";c.includes("admin_panel_full")?(f="Full Access",h="All admin panel features including permissions management"):c.includes("admin_panel_school")?(f="School Access",h="School operations, users, aides, and students"):c.includes("admin_panel_limited")?(f="Limited Access",h="Student management, aide management, and 504-related functions"):c.includes("admin_panel_sped")&&(f="SPED Access",h="SPED program management and aide oversight");let p="Viewer";c.includes(at.EDIT_STUDENT_ALL)?l==="admin"||l==="school_admin"?p="Admin":l==="staff_edit"?p="Editor":(l==="sped_chair"||l==="admin_504")&&(p="Admin/CM"):c.includes(at.EDIT_STUDENT_CM)&&(l==="admin_504"?p="Admin/CM":p="CM");const v=l==="admin_504"?"504 Coordinator":l==="sped_chair"?"SPED Chair":l==="school_admin"?"School Administrator":l==="staff_view"?"Staff Viewer":l==="staff_edit"?"Staff Editor":l==="case_manager"?"Case Manager":l==="service_provider"?"Service Provider":l.charAt(0).toUpperCase()+l.slice(1);return{key:l,name:v,icon:n[l]||$v,description:dB[l]||`${v} role`,adminAccess:u,adminLevel:f,adminDescription:h,studentAccessLevel:p,permissions:c}})),i=be(()=>[{key:at.VIEW_USERS,name:"View Users",description:"Can view user accounts and basic information",firebaseRule:"All authenticated users"},{key:at.EDIT_USER,name:"Edit Users",description:"Can modify user accounts and profiles",firebaseRule:"Admin, School Admin, 504 Coordinator, SPED Chair"},{key:at.DELETE_USER,name:"Delete Users",description:"Can remove user accounts",firebaseRule:"Admin, School Admin, 504 Coordinator, SPED Chair"},{key:at.MANAGE_TEACHER_FEEDBACK,name:"Manage Teacher Feedback",description:"Can create and manage teacher feedback forms",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager"},{key:at.MANAGE_IMPORTS,name:"Manage Data Imports",description:"Can import data from SEIS, Aeries, and other sources",firebaseRule:"Admin, School Admin"},{key:at.MANAGE_BACKUPS,name:"Manage Backups",description:"Can create, restore, and manage database backups",firebaseRule:"Admin, School Admin"},{key:at.VIEW_STUDENTS,name:"View Students",description:"Can view student records (role-filtered)",firebaseRule:"All authenticated users"},{key:at.EDIT_STUDENT_CM,name:"Edit Own Caseload",description:"Can modify students on own caseload",firebaseRule:"Case Manager, Service Provider"},{key:at.EDIT_STUDENT_ALL,name:"Edit All Students",description:"Can modify any student record",firebaseRule:"Admin, School Admin, Staff Edit, 504 Coordinator, SPED Chair"},{key:at.ACCESS_ADMIN_PANEL,name:"Admin Panel Access",description:"Can access administrative functions",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator"},{key:at.MANAGE_AIDES,name:"Aide Management",description:"Can manage aide assignments and schedules",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator"},{key:at.MANAGE_SYSTEM_SETTINGS,name:"System Settings",description:"Can modify system-level configuration",firebaseRule:"Admin only"}].sort((c,u)=>{const f=uc.filter(p=>{var v;return(v=e[p])==null?void 0:v.includes(c.key)}).length;return uc.filter(p=>{var v;return(v=e[p])==null?void 0:v.includes(u.key)}).length-f})),a=(l,c)=>{var u;return((u=e[l])==null?void 0:u.includes(c))||!1},o=l=>({admin:"Admin",school_admin:"School Admin",staff_view:"Staff View",staff_edit:"Staff Edit",admin_504:"504 Coord",sped_chair:"SPED Chair",case_manager:"Case Mgr",teacher:"Teacher",service_provider:"Service",paraeducator:"Para"})[l]||l;return(l,c)=>(O(),B("div",Bz,[c[7]||(c[7]=d("div",{class:"overview-header"},[d("h2",null," Permissions Overview"),d("p",{class:"overview-description"}," This a summary of the role-based permissions These permissions are hard-coded for consistency and security. ")],-1)),d("div",Uz,[(O(!0),B(Fe,null,He(s.value,u=>(O(),B("div",{class:"summary-card",key:u.key},[d("div",{class:Qe(["role-header",u.key])},[d("div",$z,[(O(),tr(A1(u.icon),{class:"w-6 h-6"}))]),d("div",Vz,[d("h3",null,Y(u.name),1),d("p",null,Y(u.description),1)])],2),d("div",Hz,[d("div",jz,[d("span",Gz,Y(u.permissions.length),1),c[0]||(c[0]=d("span",{class:"stat-label"},"Permissions",-1))]),d("div",Wz,[d("span",zz,Y(u.adminAccess?"Yes":"No"),1),c[1]||(c[1]=d("span",{class:"stat-label"},"Admin Panel",-1))]),d("div",Kz,[d("span",qz,Y(u.studentAccessLevel),1),c[2]||(c[2]=d("span",{class:"stat-label"},"Student Access",-1))])])]))),128))]),d("div",Xz,[c[4]||(c[4]=d("h3",null," Detailed Permissions Matrix",-1)),c[5]||(c[5]=d("div",{class:"matrix-note"},[d("strong",null,"Note:"),Ce(" These permissions are synchronized with Firebase security rules and cannot be modified. They ensure consistent security across your application. ")],-1)),d("div",Yz,[d("table",Qz,[d("thead",null,[d("tr",null,[c[3]||(c[3]=d("th",{class:"permission-column"},"Permission",-1)),(O(!0),B(Fe,null,He(r.value,u=>(O(),B("th",{key:u,class:Qe(`role-header ${u}`),"data-role":o(u)},null,10,Jz))),128))])]),d("tbody",null,[(O(!0),B(Fe,null,He(i.value,u=>(O(),B("tr",{key:u.key,class:"permission-row"},[d("td",Zz,[d("div",eK,Y(u.name),1),d("div",tK,Y(u.description),1),d("div",rK,Y(u.firebaseRule),1)]),(O(!0),B(Fe,null,He(r.value,f=>(O(),B("td",{key:f,class:"permission-cell"},[d("span",{class:Qe(["permission-indicator",{granted:a(f,u.key)}])},Y(a(f,u.key)?"":""),3)]))),128))]))),128))])])])]),d("div",nK,[c[6]||(c[6]=d("h3",null," Admin Panel Access",-1)),d("div",sK,[(O(!0),B(Fe,null,He(s.value,u=>(O(),B("div",{key:u.key,class:Qe(["access-card",{"has-access":u.adminAccess}])},[d("div",aK,[d("span",iK,Y(u.adminAccess?"":""),1),d("span",oK,Y(u.name),1)]),u.adminAccess?(O(),B("div",lK,[d("div",cK,Y(u.adminLevel),1),d("div",uK,Y(u.adminDescription),1)])):(O(),B("div",dK," No admin panel access "))],2))),128))])]),c[8]||(c[8]=In('<div class="firebase-rules" data-v-88586d63><h3 data-v-88586d63> Firebase Security Rules Summary</h3><div class="rules-grid" data-v-88586d63><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Users Collection</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin, 504 Coordinator, SPED Chair</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, 504 Coordinator, SPED Chair</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Students Collection</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users (role-filtered)</li><li data-v-88586d63><strong data-v-88586d63>Write (All):</strong> Admin, School Admin, Staff Edit, 504 Coordinator, SPED Chair</li><li data-v-88586d63><strong data-v-88586d63>Write (Own Caseload):</strong> Case Manager, Service Provider</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, SPED Chair, 504 Coordinator</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> App Settings</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Audit Logs</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> Admin, School Admin</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> All authenticated users (own actions)</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Feedback Forms</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, SPED Chair, 504 Coordinator</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63> Backups</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read/Write:</strong> Admin, School Admin</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin</li></ul></div></div></div>',1))]))}},hK=xt(fK,[["__scopeId","data-v-88586d63"]]),pK={class:"admin-permissions"},mK={__name:"AdminPermissions",setup(t){return(e,r)=>(O(),B("div",pK,[Le(hK)]))}},gK=xt(mK,[["__scopeId","data-v-699444ca"]]);var vI={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((r,n)=>{t.exports=n()})($t,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},s,i=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(S){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var T=D(m);T.chunkSize=parseInt(T.chunkSize),m.step||m.chunk||(T.chunkSize=null),this._handle=new g(T),(this._handle.streamer=this)._config=T}).call(this,S),this.parseChunk=function(m,T){var _=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<_){let k=this._config.newline;k||(A=this._config.quoteChar||'"',k=this._handle.guessLineEndings(m,A)),m=[...m.split(k).slice(_)].join(k)}this.isFirstChunk&&w(this._config.beforeFirstChunk)&&(A=this._config.beforeFirstChunk(m))!==void 0&&(m=A),this.isFirstChunk=!1,this._halted=!1;var _=this._partialLine+m,A=(this._partialLine="",this._handle.parse(_,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(m=A.meta.cursor,_=(this._finished||(this._partialLine=_.substring(m-this._baseIndex),this._baseIndex=m),A&&A.data&&(this._rowCount+=A.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)n.postMessage({results:A,workerId:c.WORKER_ID,finished:_});else if(w(this._config.chunk)&&!T){if(this._config.chunk(A,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=A=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(A.data),this._completeResults.errors=this._completeResults.errors.concat(A.errors),this._completeResults.meta=A.meta),this._completed||!_||!w(this._config.complete)||A&&A.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),_||A&&A.meta.paused||this._nextChunk(),A}this._halted=!0},this._sendError=function(m){w(this._config.error)?this._config.error(m):a&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:m,finished:!1})}}function f(S){var m;(S=S||{}).chunkSize||(S.chunkSize=c.RemoteChunkSize),u.call(this,S),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(T){this._input=T,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),i||(m.onload=P(this._chunkLoaded,this),m.onerror=P(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var T,_=this._config.downloadRequestHeaders;for(T in _)m.setRequestHeader(T,_[T])}var A;this._config.chunkSize&&(A=this._start+this._config.chunkSize-1,m.setRequestHeader("Range","bytes="+this._start+"-"+A));try{m.send(this._config.downloadRequestBody)}catch(k){this._chunkError(k.message)}i&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize||m.responseText.length,this._finished=!this._config.chunkSize||this._start>=(T=>(T=T.getResponseHeader("Content-Range"))!==null?parseInt(T.substring(T.lastIndexOf("/")+1)):-1)(m),this.parseChunk(m.responseText)))},this._chunkError=function(T){T=m.statusText||T,this._sendError(new Error(T))}}function h(S){(S=S||{}).chunkSize||(S.chunkSize=c.LocalChunkSize),u.call(this,S);var m,T,_=typeof FileReader<"u";this.stream=function(A){this._input=A,T=A.slice||A.webkitSlice||A.mozSlice,_?((m=new FileReader).onload=P(this._chunkLoaded,this),m.onerror=P(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var A=this._input,k=(this._config.chunkSize&&(k=Math.min(this._start+this._config.chunkSize,this._input.size),A=T.call(A,this._start,k)),m.readAsText(A,this._config.encoding));_||this._chunkLoaded({target:{result:k}})},this._chunkLoaded=function(A){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(A.target.result)},this._chunkError=function(){this._sendError(m.error)}}function p(S){var m;u.call(this,S=S||{}),this.stream=function(T){return m=T,this._nextChunk()},this._nextChunk=function(){var T,_;if(!this._finished)return T=this._config.chunkSize,m=T?(_=m.substring(0,T),m.substring(T)):(_=m,""),this._finished=!m,this.parseChunk(_)}}function v(S){u.call(this,S=S||{});var m=[],T=!0,_=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(A){this._input=A,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){_&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):T=!0},this._streamData=P(function(A){try{m.push(typeof A=="string"?A:A.toString(this._config.encoding)),T&&(T=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(k){this._streamError(k)}},this),this._streamError=P(function(A){this._streamCleanUp(),this._sendError(A)},this),this._streamEnd=P(function(){this._streamCleanUp(),_=!0,this._streamData("")},this),this._streamCleanUp=P(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function g(S){var m,T,_,A,k=Math.pow(2,53),U=-k,L=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,R=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,F=this,N=0,M=0,z=!1,G=!1,H=[],j={data:[],errors:[],meta:{}};function K(fe){return S.skipEmptyLines==="greedy"?fe.join("").trim()==="":fe.length===1&&fe[0].length===0}function ne(){if(j&&_&&(le("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),_=!1),S.skipEmptyLines&&(j.data=j.data.filter(function(Q){return!K(Q)})),he()){let Q=function(q,J){w(S.transformHeader)&&(q=S.transformHeader(q,J)),H.push(q)};var xe=Q;if(j)if(Array.isArray(j.data[0])){for(var fe=0;he()&&fe<j.data.length;fe++)j.data[fe].forEach(Q);j.data.splice(0,1)}else j.data.forEach(Q)}function te(Q,q){for(var J=S.header?{}:[],pe=0;pe<Q.length;pe++){var ge=pe,ee=Q[pe],ee=((ie,ve)=>(we=>(S.dynamicTypingFunction&&S.dynamicTyping[we]===void 0&&(S.dynamicTyping[we]=S.dynamicTypingFunction(we)),(S.dynamicTyping[we]||S.dynamicTyping)===!0))(ie)?ve==="true"||ve==="TRUE"||ve!=="false"&&ve!=="FALSE"&&((we=>{if(L.test(we)&&(we=parseFloat(we),U<we&&we<k))return 1})(ve)?parseFloat(ve):R.test(ve)?new Date(ve):ve===""?null:ve):ve)(ge=S.header?pe>=H.length?"__parsed_extra":H[pe]:ge,ee=S.transform?S.transform(ee,ge):ee);ge==="__parsed_extra"?(J[ge]=J[ge]||[],J[ge].push(ee)):J[ge]=ee}return S.header&&(pe>H.length?le("FieldMismatch","TooManyFields","Too many fields: expected "+H.length+" fields but parsed "+pe,M+q):pe<H.length&&le("FieldMismatch","TooFewFields","Too few fields: expected "+H.length+" fields but parsed "+pe,M+q)),J}var Z;j&&(S.header||S.dynamicTyping||S.transform)&&(Z=1,!j.data.length||Array.isArray(j.data[0])?(j.data=j.data.map(te),Z=j.data.length):j.data=te(j.data,0),S.header&&j.meta&&(j.meta.fields=H),M+=Z)}function he(){return S.header&&H.length===0}function le(fe,te,Z,xe){fe={type:fe,code:te,message:Z},xe!==void 0&&(fe.row=xe),j.errors.push(fe)}w(S.step)&&(A=S.step,S.step=function(fe){j=fe,he()?ne():(ne(),j.data.length!==0&&(N+=fe.data.length,S.preview&&N>S.preview?T.abort():(j.data=j.data[0],A(j,F))))}),this.parse=function(fe,te,Z){var xe=S.quoteChar||'"',xe=(S.newline||(S.newline=this.guessLineEndings(fe,xe)),_=!1,S.delimiter?w(S.delimiter)&&(S.delimiter=S.delimiter(fe),j.meta.delimiter=S.delimiter):((xe=((Q,q,J,pe,ge)=>{var ee,ie,ve,we;ge=ge||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var De=0;De<ge.length;De++){for(var Te,ze=ge[De],ke=0,Ve=0,Ae=0,Ge=(ve=void 0,new b({comments:pe,delimiter:ze,newline:q,preview:10}).parse(Q)),Ke=0;Ke<Ge.data.length;Ke++)J&&K(Ge.data[Ke])?Ae++:(Te=Ge.data[Ke].length,Ve+=Te,ve===void 0?ve=Te:0<Te&&(ke+=Math.abs(Te-ve),ve=Te));0<Ge.data.length&&(Ve/=Ge.data.length-Ae),(ie===void 0||ke<=ie)&&(we===void 0||we<Ve)&&1.99<Ve&&(ie=ke,ee=ze,we=Ve)}return{successful:!!(S.delimiter=ee),bestDelimiter:ee}})(fe,S.newline,S.skipEmptyLines,S.comments,S.delimitersToGuess)).successful?S.delimiter=xe.bestDelimiter:(_=!0,S.delimiter=c.DefaultDelimiter),j.meta.delimiter=S.delimiter),D(S));return S.preview&&S.header&&xe.preview++,m=fe,T=new b(xe),j=T.parse(m,te,Z),ne(),z?{meta:{paused:!0}}:j||{meta:{paused:!1}}},this.paused=function(){return z},this.pause=function(){z=!0,T.abort(),m=w(S.chunk)?"":m.substring(T.getCharIndex())},this.resume=function(){F.streamer._halted?(z=!1,F.streamer.parseChunk(m,!0)):setTimeout(F.resume,3)},this.aborted=function(){return G},this.abort=function(){G=!0,T.abort(),j.meta.aborted=!0,w(S.complete)&&S.complete(j),m=""},this.guessLineEndings=function(Q,xe){Q=Q.substring(0,1048576);var xe=new RegExp(y(xe)+"([^]*?)"+y(xe),"gm"),Z=(Q=Q.replace(xe,"")).split("\r"),xe=Q.split(`
`),Q=1<xe.length&&xe[0].length<Z[0].length;if(Z.length===1||Q)return`
`;for(var q=0,J=0;J<Z.length;J++)Z[J][0]===`
`&&q++;return q>=Z.length/2?`\r
`:"\r"}}function y(S){return S.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(S){var m=(S=S||{}).delimiter,T=S.newline,_=S.comments,A=S.step,k=S.preview,U=S.fastMode,L=null,R=!1,F=S.quoteChar==null?'"':S.quoteChar,N=F;if(S.escapeChar!==void 0&&(N=S.escapeChar),(typeof m!="string"||-1<c.BAD_DELIMITERS.indexOf(m))&&(m=","),_===m)throw new Error("Comment character same as delimiter");_===!0?_="#":(typeof _!="string"||-1<c.BAD_DELIMITERS.indexOf(_))&&(_=!1),T!==`
`&&T!=="\r"&&T!==`\r
`&&(T=`
`);var M=0,z=!1;this.parse=function(G,H,j){if(typeof G!="string")throw new Error("Input must be a string");var K=G.length,ne=m.length,he=T.length,le=_.length,fe=w(A),te=[],Z=[],xe=[],Q=M=0;if(!G)return ke();if(U||U!==!1&&G.indexOf(F)===-1){for(var q=G.split(T),J=0;J<q.length;J++){if(xe=q[J],M+=xe.length,J!==q.length-1)M+=T.length;else if(j)return ke();if(!_||xe.substring(0,le)!==_){if(fe){if(te=[],we(xe.split(m)),Ve(),z)return ke()}else we(xe.split(m));if(k&&k<=J)return te=te.slice(0,k),ke(!0)}}return ke()}for(var pe=G.indexOf(m,M),ge=G.indexOf(T,M),ee=new RegExp(y(N)+y(F),"g"),ie=G.indexOf(F,M);;)if(G[M]===F)for(ie=M,M++;;){if((ie=G.indexOf(F,ie+1))===-1)return j||Z.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:te.length,index:M}),Te();if(ie===K-1)return Te(G.substring(M,ie).replace(ee,F));if(F===N&&G[ie+1]===N)ie++;else if(F===N||ie===0||G[ie-1]!==N){pe!==-1&&pe<ie+1&&(pe=G.indexOf(m,ie+1));var ve=De((ge=ge!==-1&&ge<ie+1?G.indexOf(T,ie+1):ge)===-1?pe:Math.min(pe,ge));if(G.substr(ie+1+ve,ne)===m){xe.push(G.substring(M,ie).replace(ee,F)),G[M=ie+1+ve+ne]!==F&&(ie=G.indexOf(F,M)),pe=G.indexOf(m,M),ge=G.indexOf(T,M);break}if(ve=De(ge),G.substring(ie+1+ve,ie+1+ve+he)===T){if(xe.push(G.substring(M,ie).replace(ee,F)),ze(ie+1+ve+he),pe=G.indexOf(m,M),ie=G.indexOf(F,M),fe&&(Ve(),z))return ke();if(k&&te.length>=k)return ke(!0);break}Z.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:te.length,index:M}),ie++}}else if(_&&xe.length===0&&G.substring(M,M+le)===_){if(ge===-1)return ke();M=ge+he,ge=G.indexOf(T,M),pe=G.indexOf(m,M)}else if(pe!==-1&&(pe<ge||ge===-1))xe.push(G.substring(M,pe)),M=pe+ne,pe=G.indexOf(m,M);else{if(ge===-1)break;if(xe.push(G.substring(M,ge)),ze(ge+he),fe&&(Ve(),z))return ke();if(k&&te.length>=k)return ke(!0)}return Te();function we(Ae){te.push(Ae),Q=M}function De(Ae){var Ge=0;return Ge=Ae!==-1&&(Ae=G.substring(ie+1,Ae))&&Ae.trim()===""?Ae.length:Ge}function Te(Ae){return j||(Ae===void 0&&(Ae=G.substring(M)),xe.push(Ae),M=K,we(xe),fe&&Ve()),ke()}function ze(Ae){M=Ae,we(xe),xe=[],ge=G.indexOf(T,M)}function ke(Ae){if(S.header&&!H&&te.length&&!R){var Ge=te[0],Ke=Object.create(null),Ee=new Set(Ge);let ye=!1;for(let Se=0;Se<Ge.length;Se++){let Oe=Ge[Se];if(Ke[Oe=w(S.transformHeader)?S.transformHeader(Oe,Se):Oe]){let We,ot=Ke[Oe];for(;We=Oe+"_"+ot,ot++,Ee.has(We););Ee.add(We),Ge[Se]=We,Ke[Oe]++,ye=!0,(L=L===null?{}:L)[We]=Oe}else Ke[Oe]=1,Ge[Se]=Oe;Ee.add(Oe)}ye&&console.warn("Duplicate headers found and renamed."),R=!0}return{data:te,errors:Z,meta:{delimiter:m,linebreak:T,aborted:z,truncated:!!Ae,cursor:Q+(H||0),renamedHeaders:L}}}function Ve(){A(ke()),te=[],Z=[]}},this.abort=function(){z=!0},this.getCharIndex=function(){return M}}function E(S){var m=S.data,T=o[m.workerId],_=!1;if(m.error)T.userError(m.error,m.file);else if(m.results&&m.results.data){var A={abort:function(){_=!0,x(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:I,resume:I};if(w(T.userStep)){for(var k=0;k<m.results.data.length&&(T.userStep({data:m.results.data[k],errors:m.results.errors,meta:m.results.meta},A),!_);k++);delete m.results}else w(T.userChunk)&&(T.userChunk(m.results,A,m.file),delete m.results)}m.finished&&!_&&x(m.workerId,m.results)}function x(S,m){var T=o[S];w(T.userComplete)&&T.userComplete(m),T.terminate(),delete o[S]}function I(){throw new Error("Not implemented.")}function D(S){if(typeof S!="object"||S===null)return S;var m,T=Array.isArray(S)?[]:{};for(m in S)T[m]=D(S[m]);return T}function P(S,m){return function(){S.apply(m,arguments)}}function w(S){return typeof S=="function"}return c.parse=function(S,m){var T=(m=m||{}).dynamicTyping||!1;if(w(T)&&(m.dynamicTypingFunction=T,T={}),m.dynamicTyping=T,m.transform=!!w(m.transform)&&m.transform,!m.worker||!c.WORKERS_SUPPORTED)return T=null,c.NODE_STREAM_INPUT,typeof S=="string"?(S=(_=>_.charCodeAt(0)!==65279?_:_.slice(1))(S),T=new(m.download?f:p)(m)):S.readable===!0&&w(S.read)&&w(S.on)?T=new v(m):(n.File&&S instanceof File||S instanceof Object)&&(T=new h(m)),T.stream(S);(T=(()=>{var _;return!!c.WORKERS_SUPPORTED&&(_=(()=>{var A=n.URL||n.webkitURL||null,k=r.toString();return c.BLOB_URL||(c.BLOB_URL=A.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",k,")();"],{type:"text/javascript"})))})(),(_=new n.Worker(_)).onmessage=E,_.id=l++,o[_.id]=_)})()).userStep=m.step,T.userChunk=m.chunk,T.userComplete=m.complete,T.userError=m.error,m.step=w(m.step),m.chunk=w(m.chunk),m.complete=w(m.complete),m.error=w(m.error),delete m.worker,T.postMessage({input:S,config:m,workerId:T.id})},c.unparse=function(S,m){var T=!1,_=!0,A=",",k=`\r
`,U='"',L=U+U,R=!1,F=null,N=!1,M=((()=>{if(typeof m=="object"){if(typeof m.delimiter!="string"||c.BAD_DELIMITERS.filter(function(H){return m.delimiter.indexOf(H)!==-1}).length||(A=m.delimiter),typeof m.quotes!="boolean"&&typeof m.quotes!="function"&&!Array.isArray(m.quotes)||(T=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(R=m.skipEmptyLines),typeof m.newline=="string"&&(k=m.newline),typeof m.quoteChar=="string"&&(U=m.quoteChar),typeof m.header=="boolean"&&(_=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");F=m.columns}m.escapeChar!==void 0&&(L=m.escapeChar+U),m.escapeFormulae instanceof RegExp?N=m.escapeFormulae:typeof m.escapeFormulae=="boolean"&&m.escapeFormulae&&(N=/^[=+\-@\t\r].*$/)}})(),new RegExp(y(U),"g"));if(typeof S=="string"&&(S=JSON.parse(S)),Array.isArray(S)){if(!S.length||Array.isArray(S[0]))return z(null,S,R);if(typeof S[0]=="object")return z(F||Object.keys(S[0]),S,R)}else if(typeof S=="object")return typeof S.data=="string"&&(S.data=JSON.parse(S.data)),Array.isArray(S.data)&&(S.fields||(S.fields=S.meta&&S.meta.fields||F),S.fields||(S.fields=Array.isArray(S.data[0])?S.fields:typeof S.data[0]=="object"?Object.keys(S.data[0]):[]),Array.isArray(S.data[0])||typeof S.data[0]=="object"||(S.data=[S.data])),z(S.fields||[],S.data||[],R);throw new Error("Unable to serialize unrecognized input");function z(H,j,K){var ne="",he=(typeof H=="string"&&(H=JSON.parse(H)),typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(H)&&0<H.length),le=!Array.isArray(j[0]);if(he&&_){for(var fe=0;fe<H.length;fe++)0<fe&&(ne+=A),ne+=G(H[fe],fe);0<j.length&&(ne+=k)}for(var te=0;te<j.length;te++){var Z=(he?H:j[te]).length,xe=!1,Q=he?Object.keys(j[te]).length===0:j[te].length===0;if(K&&!he&&(xe=K==="greedy"?j[te].join("").trim()==="":j[te].length===1&&j[te][0].length===0),K==="greedy"&&he){for(var q=[],J=0;J<Z;J++){var pe=le?H[J]:J;q.push(j[te][pe])}xe=q.join("").trim()===""}if(!xe){for(var ge=0;ge<Z;ge++){0<ge&&!Q&&(ne+=A);var ee=he&&le?H[ge]:ge;ne+=G(j[te][ee],ge)}te<j.length-1&&(!K||0<Z&&!Q)&&(ne+=k)}}return ne}function G(H,j){var K,ne;return H==null?"":H.constructor===Date?JSON.stringify(H).slice(1,25):(ne=!1,N&&typeof H=="string"&&N.test(H)&&(H="'"+H,ne=!0),K=H.toString().replace(M,L),(ne=ne||T===!0||typeof T=="function"&&T(H,j)||Array.isArray(T)&&T[j]||((he,le)=>{for(var fe=0;fe<le.length;fe++)if(-1<he.indexOf(le[fe]))return!0;return!1})(K,c.BAD_DELIMITERS)||-1<K.indexOf(A)||K.charAt(0)===" "||K.charAt(K.length-1)===" ")?U+K+U:K)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=b,c.ParserHandle=g,c.NetworkStreamer=f,c.FileStreamer=h,c.StringStreamer=p,c.ReadableStreamStreamer=v,n.jQuery&&((s=n.jQuery).fn.parse=function(S){var m=S.config||{},T=[];return this.each(function(k){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var U=0;U<this.files.length;U++)T.push({file:this.files[U],inputElem:this,instanceConfig:s.extend({},m)})}),_(),this;function _(){if(T.length===0)w(S.complete)&&S.complete();else{var k,U,L,R,F=T[0];if(w(S.before)){var N=S.before(F.file,F.inputElem);if(typeof N=="object"){if(N.action==="abort")return k="AbortError",U=F.file,L=F.inputElem,R=N.reason,void(w(S.error)&&S.error({name:k},U,L,R));if(N.action==="skip")return void A();typeof N.config=="object"&&(F.instanceConfig=s.extend(F.instanceConfig,N.config))}else if(N==="skip")return void A()}var M=F.instanceConfig.complete;F.instanceConfig.complete=function(z){w(M)&&M(z,F.file,F.inputElem),A()},c.parse(F.file,F.instanceConfig)}}function A(){T.splice(0,1),_()}}),a&&(n.onmessage=function(S){S=S.data,c.WORKER_ID===void 0&&S&&(c.WORKER_ID=S.workerId),typeof S.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(S.input,S.config),finished:!0}):(n.File&&S.input instanceof File||S.input instanceof Object)&&(S=c.parse(S.input,S.config))&&n.postMessage({workerId:c.WORKER_ID,results:S,finished:!0})}),(f.prototype=Object.create(u.prototype)).constructor=f,(h.prototype=Object.create(u.prototype)).constructor=h,(p.prototype=Object.create(p.prototype)).constructor=p,(v.prototype=Object.create(u.prototype)).constructor=v,c})})(vI);var vK=vI.exports;const yI=fI(vK),Lo=yo();function xI(t){return t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(e,r)=>r.toUpperCase()).replace(/^[A-Z]/,e=>e.toLowerCase())}async function yK(t,e){if(!t)return null;const r=Object.values(e).find(n=>{var s;return n.aeriesId===t||n.aeriesId===parseInt(t)||((s=n.aeriesId)==null?void 0:s.toString())===(t==null?void 0:t.toString())});return r?r.id:(console.warn(`No Firebase user found for Aeries teacher ID: ${t}`),null)}function Vv(t){return{sourcedId:"stateId",SSID:"stateId",StateStudentID:"stateId",StudentNumber:"localId",givenName:"firstName",FirstName:"firstName",familyName:"lastName",LastName:"lastName",middleName:"middleName",MiddleName:"middleName",email:"email",Email:"email",phone:"phone",Phone:"phone",dateOfBirth:"birthDate",DOB:"birthDate",sex:"gender",Gender:"gender",grade:"grade",Grade:"grade",Address:"address",City:"city",State:"state",ZipCode:"zipCode",ParentName:"parentName",ParentPhone:"parentPhone",ParentEmail:"parentEmail",AttendanceRate:"attendanceRate",attendanceRate:"attendanceRate",Period1TeacherId:"schedule.periods.1",period1TeacherId:"schedule.periods.1",Period2TeacherId:"schedule.periods.2",period2TeacherId:"schedule.periods.2",Period3TeacherId:"schedule.periods.3",period3TeacherId:"schedule.periods.3",Period4TeacherId:"schedule.periods.4",period4TeacherId:"schedule.periods.4",Period5TeacherId:"schedule.periods.5",period5TeacherId:"schedule.periods.5",Period6TeacherId:"schedule.periods.6",period6TeacherId:"schedule.periods.6",Period7TeacherId:"schedule.periods.7",period7TeacherId:"schedule.periods.7",SHTeacherId:"schedule.periods.SH",shTeacherId:"schedule.periods.SH"}[t]||xI(t)}function Hv(t){return{SSID:"ssid",FirstName:"firstName",LastName:"lastName",MiddleName:"middleName",Grade:"grade",DOB:"dob",Gender:"gender",Ethnicity:"ethnicity",School:"school",Address:"address",City:"city",State:"state",ZipCode:"zipCode",Phone:"phone",ParentName:"parentName",ParentPhone:"parentPhone",ParentEmail:"parentEmail",ELL:"ell",504:"504",IEP:"iep",CaseManager:"caseManager",Disability:"disability",ServiceMinutes:"serviceMinutes",Goals:"goals",Notes:"notes",Plan:"plan",ReviewDate:"reviewDate",ReevalDate:"reevalDate",MeetingDate:"meetingDate",SpeechProvider:"speechProvider",MHProvider:"mhProvider",OTProvider:"otProvider",ProgramAccommodations:"programAccommodations",Accommodations:"programAccommodations",IEP_Services:"iepServices"}[t]||xI(t)}async function xK(t){return new Promise((e,r)=>{yI.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{const s=n.data;if(!s||!s.length)return r(new Error("No data rows found in the CSV."));const i=Object.keys(s[0]).map(o=>o.trim().toLowerCase());if(!(i.includes("sourcedid")||i.includes("ssid")||i.includes("statestudentid")))return r(new Error("Missing required 'sourcedId' or 'SSID' column."));e(s)},error:n=>r(new Error("Failed to parse CSV: "+n.message))})})}async function EK(t,e){var a;let r=0;const n=_t(Lo,"users"),s=await Gt(n),i={};s.forEach(o=>{i[o.id]={id:o.id,...o.data()}}),console.log(`Loaded ${Object.keys(i).length} users for teacher ID mapping`);for(const o of t){const l=(a=o.sourcedId||o.SSID||o.ssid||o.StateStudentID||o.stateStudentId)==null?void 0:a.trim();if(!l){console.warn("Skipping row with missing SSID:",o);continue}const c={firstName:"",lastName:"",grade:"",birthDate:"",gender:"",address:"",city:"",state:"",zipCode:"",phone:"",email:"",parentName:"",parentPhone:"",parentEmail:"",attendanceRate:"",schedule:{periods:{}}};for(const u of e){const f=Vv(u),h=o[u],p=h!=null&&typeof h=="string"?h.trim():h!=null?String(h):null;if(f.startsWith("schedule.periods.")){const v=f.split(".")[2];if(p){const g=await yK(p,i);g?(c.schedule.periods[v]=g,console.log(`Mapped Aeries teacher ID ${p} to Firebase user ID ${g} for period ${v}`)):console.warn(`Could not map Aeries teacher ID ${p} for period ${v}`)}}else c[f]=p}c.lastAeriesImport=new Date().toISOString(),console.log("Final aeriesData.schedule structure:",JSON.stringify(c.schedule,null,2));try{const u=_t(Lo,"students"),f=or(u,Ur("app.studentData.ssid","==",l)),h=await Gt(f);if(h.empty){const p=Ze(_t(Lo,"students")),v={app:{studentData:{ssid:l}},aeries:c,createdAt:wn()};await Ht(p,v),console.log(`Created new student ${p.id} with Aeries data for SSID ${l}`)}else{const p=h.docs[0];await Ht(Ze(Lo,"students",p.id),{aeries:c},{merge:!0}),console.log(`Updated existing student ${p.id} with Aeries data for SSID ${l}`)}r++}catch(u){console.error(`Failed to import Aeries data for SSID ${l}:`,u)}}return r}async function _K(t){return new Promise((e,r)=>{yI.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{const s=n.data;if(!s||!s.length)return r(new Error("No data rows found in the CSV."));if(!Object.keys(s[0]).some(a=>a.trim().toLowerCase()==="ssid"))return r(new Error("Missing required 'SSID' column."));e(s)},error:n=>r(new Error("Failed to parse CSV: "+n.message))})})}async function bK(t,e){var n,s,i,a;let r=0;for(const o of t){const l=((n=o.SSID)==null?void 0:n.trim())||((s=o.ssid)==null?void 0:s.trim());if(!l){console.warn("Skipping row with missing SSID:",o);continue}const c={};for(const u of e){const f=Hv(u);u==="IEP_Services"||u==="iep_services"?c[f]=((i=o[u])==null?void 0:i.split(";").map(h=>h.trim()))||[]:u==="ProgramAccommodations"||u==="Accommodations"?c[f]=((a=o[u])==null?void 0:a.split(";").map(h=>h.trim()))||[]:c[f]=o[u]}c.lastSeisImport=new Date().toISOString();try{const u=_t(Lo,"students"),f=or(u,Ur("app.studentData.ssid","==",l)),h=await Gt(f);if(h.empty){const p=Ze(_t(Lo,"students")),v={app:{studentData:{ssid:l}},seis:c,createdAt:wn()};await Ht(p,v),console.log(`Created new student ${p.id} with SEIS data for SSID ${l}`)}else{const p=h.docs[0];await Ht(Ze(Lo,"students",p.id),{seis:c},{merge:!0}),console.log(`Updated existing student ${p.id} with SEIS data for SSID ${l}`)}r++}catch(u){console.error(`Failed to import SEIS data for SSID ${l}:`,u)}}return r}const SK={name:"SeisImport",setup(){const t=se(null),e=se(null),r=se([]),n=se([]),s=se([]),i=se([]),a=se(""),o=se(!1),l=be(()=>r.value.length>0&&s.value.length>0),c=(p,v=!1)=>{a.value=p,o.value=v,setTimeout(()=>{a.value="",o.value=!1},5e3)};return{fileInput:t,selectedFile:e,parsedData:r,fieldOptions:n,selectedFields:s,previewData:i,statusMessage:a,isError:o,canImport:l,handleFileSelect:p=>{const v=p.target.files[0];if(v){const g=Hc(v,{allowedTypes:["csv"],maxSize:10485760,fieldName:"SEIS Import File"});if(!g.isValid){c(g.error,!0),p.target.value="";return}const y=qr(v.name);if(!y.isSafe){c(`File name contains potentially dangerous content: ${y.threats.join(", ")}`,!0),p.target.value="";return}e.value=v}},previewFile:async()=>{const p=e.value;if(!p){c(" Please select a CSV file.",!0);return}if(!Is("seisPreview",5,3e5).allowed){c("Too many preview requests. Please wait before previewing again.",!0);return}c("Parsing file..."),i.value=[],n.value=[],s.value=[];try{const y=(await _K(p)).map(E=>{const x={};return Object.entries(E).forEach(([I,D])=>{const P=mn(I,{trim:!0,maxLength:100,removeDangerous:!0});let w=D;if(typeof D=="string"){w=mn(D,{trim:!0,maxLength:500,removeDangerous:!0});const S=qr(w);S.isSafe||(console.warn(`Security threat detected in SEIS data: ${S.threats.join(", ")}`),w="")}x[P]=w}),x});r.value=y,c(` Loaded ${r.value.length} rows.`);const b=Object.keys(r.value[0]||{}).filter(E=>E.length>0);n.value=b,s.value=[...b],i.value=r.value.slice(0,5)}catch(g){c(` Error: ${g.message}`,!0),console.error("SEIS Parse Error:",g)}},importData:async()=>{if(!l.value){c(" Cannot import: No data or fields selected.",!0);return}if(!Is("seisImport",2,6e5).allowed){c("Too many import requests. Please wait before importing again.",!0);return}if(confirm(`Import ${r.value.length} SEIS records? This will update existing students with matching SSIDs.`)){c("Importing data...");try{const v=r.value.map(y=>{const b={};return s.value.forEach(E=>{y[E]!==void 0&&(b[E]=y[E])}),b}),g=v.filter(y=>Object.values(y).some(E=>E&&typeof E=="string"&&E.trim().length>0));if(g.length===0){c(" No valid records found to import.",!0);return}if(g.length!==v.length){const y=v.length-g.length;c(` Skipping ${y} invalid records. Importing ${g.length} valid records.`)}await bK(g,s.value),c(` Successfully imported ${g.length} SEIS records.`),e.value=null,r.value=[],n.value=[],s.value=[],i.value=[],t.value&&(t.value.value="")}catch(v){c(` Import failed: ${v.message}`,!0),console.error("SEIS Import Error:",v)}}}}}},AK={class:"seis-import"},TK=["disabled"],wK={key:0,id:"seis-field-options"},CK=["value"],IK={key:1,id:"seis-preview-container",style:{"margin-top":"1rem"}},kK={border:"1",cellpadding:"4"},DK=["disabled"];function PK(t,e,r,n,s,i){return O(),B("div",AK,[e[5]||(e[5]=d("h3",null,"Upload SEIS CSV",-1)),d("input",{type:"file",ref:"fileInput",accept:".csv",onChange:e[0]||(e[0]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[1]||(e[1]=(...a)=>n.previewFile&&n.previewFile(...a)),disabled:!n.selectedFile},"Preview",8,TK),n.fieldOptions.length>0?(O(),B("div",wK,[e[4]||(e[4]=d("h4",null,"Select fields to import:",-1)),(O(!0),B(Fe,null,He(n.fieldOptions,a=>(O(),B("label",{key:a},[Be(d("input",{type:"checkbox",value:a,"onUpdate:modelValue":e[2]||(e[2]=o=>n.selectedFields=o),checked:""},null,8,CK),[[wt,n.selectedFields]]),Ce(" "+Y(a),1)]))),128))])):_e("",!0),n.previewData.length>0?(O(),B("div",IK,[d("table",kK,[d("thead",null,[d("tr",null,[(O(!0),B(Fe,null,He(n.fieldOptions,a=>(O(),B("th",{key:a},Y(a),1))),128))])]),d("tbody",null,[(O(!0),B(Fe,null,He(n.previewData,(a,o)=>(O(),B("tr",{key:o},[(O(!0),B(Fe,null,He(n.fieldOptions,l=>(O(),B("td",{key:l},Y(a[l]||""),1))),128))]))),128))])]),d("p",null,"Showing first "+Y(n.previewData.length)+" of "+Y(n.parsedData.length)+" rows.",1)])):_e("",!0),d("button",{onClick:e[3]||(e[3]=(...a)=>n.importData&&n.importData(...a)),disabled:!n.canImport},"Import to Firestore",8,DK),d("p",{class:Qe(["status-msg",{error:n.isError}])},Y(n.statusMessage),3)])}const RK=xt(SK,[["render",PK],["__scopeId","data-v-b942d3b4"]]),FK={name:"AeriesImport",setup(){const t=se(null),e=se(null),r=se([]),n=se([]),s=se([]),i=se([]),a=se(""),o=se(!1),l=be(()=>r.value.length>0&&s.value.length>0),c=(p,v=!1)=>{a.value=p,o.value=v,setTimeout(()=>{a.value="",o.value=!1},5e3)};return{fileInput:t,selectedFile:e,parsedData:r,fieldOptions:n,selectedFields:s,previewData:i,statusMessage:a,isError:o,canImport:l,handleFileSelect:p=>{const v=p.target.files[0];if(v){const g=Hc(v,{allowedTypes:["csv"],maxSize:10485760,fieldName:"Aeries Import File"});if(!g.isValid){c(g.error,!0),p.target.value="";return}const y=qr(v.name);if(!y.isSafe){c(`File name contains potentially dangerous content: ${y.threats.join(", ")}`,!0),p.target.value="";return}e.value=v}},previewFile:async()=>{const p=e.value;if(!p){c(" Please select a CSV file.",!0);return}if(!Is("aeriesPreview",5,3e5).allowed){c("Too many preview requests. Please wait before previewing again.",!0);return}c("Parsing file..."),i.value=[],n.value=[],s.value=[];try{const y=(await xK(p)).map(E=>{const x={};return Object.entries(E).forEach(([I,D])=>{const P=mn(I,{trim:!0,maxLength:100,removeDangerous:!0});let w=D;if(typeof D=="string"){w=mn(D,{trim:!0,maxLength:500,removeDangerous:!0});const S=qr(w);S.isSafe||(console.warn(`Security threat detected in Aeries data: ${S.threats.join(", ")}`),w="")}x[P]=w}),x});r.value=y,c(` Loaded ${r.value.length} rows.`);const b=Object.keys(r.value[0]||{}).filter(E=>E.length>0);n.value=b,s.value=[...b],i.value=r.value.slice(0,5)}catch(g){c(` Error: ${g.message}`,!0),console.error("Aeries Parse Error:",g)}},importData:async()=>{if(!l.value){c(" Cannot import: No data or fields selected.",!0);return}if(!Is("aeriesImport",2,6e5).allowed){c("Too many import requests. Please wait before importing again.",!0);return}if(confirm(`Import ${r.value.length} Aeries records? This will update existing students with matching SSIDs.`)){c("Importing data...");try{const v=r.value.map(y=>{const b={};return s.value.forEach(E=>{y[E]!==void 0&&(b[E]=y[E])}),b}),g=v.filter(y=>Object.values(y).some(E=>E&&typeof E=="string"&&E.trim().length>0));if(g.length===0){c(" No valid records found to import.",!0);return}if(g.length!==v.length){const y=v.length-g.length;c(` Skipping ${y} invalid records. Importing ${g.length} valid records.`)}await EK(g,s.value),c(` Successfully imported ${g.length} Aeries records.`),e.value=null,r.value=[],n.value=[],s.value=[],i.value=[],t.value&&(t.value.value="")}catch(v){c(` Import failed: ${v.message}`,!0),console.error("Aeries Import Error:",v)}}}}}},NK={class:"aeries-import"},OK=["disabled"],MK={key:0,id:"aeries-field-options"},LK=["value"],BK={key:1,id:"aeries-preview-container",style:{"margin-top":"1rem"}},UK={border:"1",cellpadding:"4"},$K=["disabled"];function VK(t,e,r,n,s,i){return O(),B("div",NK,[e[5]||(e[5]=d("h3",null,"Upload Aeries CSV",-1)),d("input",{type:"file",ref:"fileInput",accept:".csv",onChange:e[0]||(e[0]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[1]||(e[1]=(...a)=>n.previewFile&&n.previewFile(...a)),disabled:!n.selectedFile},"Preview",8,OK),n.fieldOptions.length>0?(O(),B("div",MK,[e[4]||(e[4]=d("h4",null,"Select fields to import:",-1)),(O(!0),B(Fe,null,He(n.fieldOptions,a=>(O(),B("label",{key:a},[Be(d("input",{type:"checkbox",value:a,"onUpdate:modelValue":e[2]||(e[2]=o=>n.selectedFields=o),checked:""},null,8,LK),[[wt,n.selectedFields]]),Ce(" "+Y(a),1)]))),128))])):_e("",!0),n.previewData.length>0?(O(),B("div",BK,[d("table",UK,[d("thead",null,[d("tr",null,[(O(!0),B(Fe,null,He(n.fieldOptions,a=>(O(),B("th",{key:a},Y(a),1))),128))])]),d("tbody",null,[(O(!0),B(Fe,null,He(n.previewData,(a,o)=>(O(),B("tr",{key:o},[(O(!0),B(Fe,null,He(n.fieldOptions,l=>(O(),B("td",{key:l},Y(a[l]||""),1))),128))]))),128))])]),d("p",null,"Showing first "+Y(n.previewData.length)+" of "+Y(n.parsedData.length)+" rows.",1)])):_e("",!0),d("button",{onClick:e[3]||(e[3]=(...a)=>n.importData&&n.importData(...a)),disabled:!n.canImport},"Import to Firestore",8,$K),d("p",{class:Qe(["status-msg",{error:n.isError}])},Y(n.statusMessage),3)])}const HK=xt(FK,[["render",VK],["__scopeId","data-v-b40a9547"]]);function jK(){const t=cc(jd()),e=se(!1),r=se(!1),n=se(""),s=se(""),i=se(!1),a=Rs({baseUrl:"encrypted",clientId:"encrypted",clientSecret:"encrypted",selectedSchoolId:"school123",selectedClassIds:["class1","class2"],selectedApiTypes:{oneroster:!0,nativeAeries:!0},selectedEndpoints:["/schools","/students","/api/special-education/students"]}),o=se([{path:"/orgs",name:"Organizations",description:"District information"},{path:"/schools",name:"Schools",description:"School sites"},{path:"/academicSessions",name:"Academic Sessions",description:"Terms/semesters"},{path:"/grades",name:"Grades",description:"Grade levels"},{path:"/courses",name:"Courses",description:"Course catalog"},{path:"/classes",name:"Classes",description:"Sections (MST table)"},{path:"/teachers",name:"Teachers",description:"Teacher roster"},{path:"/students",name:"Students",description:"Student roster"},{path:"/enrollments",name:"Enrollments",description:"Student-to-class links"},{path:"/api/special-education/students",name:"SPED Students",description:"Students with IEP/504 plans"},{path:"/api/special-education/ieps",name:"IEP Records",description:"IEP documents and data"},{path:"/api/special-education/504-plans",name:"504 Plans",description:"504 plan records"},{path:"/api/special-education/accommodations",name:"Accommodations",description:"Student accommodations"},{path:"/api/special-education/services",name:"Services",description:"Related services"},{path:"/api/special-education/case-managers",name:"Case Managers",description:"Case manager assignments"},{path:"/api/students/special-education",name:"SPED Students Alt",description:"Alternative SPED endpoint"},{path:"/api/iep/students",name:"IEP Students",description:"IEP student data"},{path:"/api/504/students",name:"504 Students",description:"504 student data"}]),l=(_,A=!1)=>{s.value=_,i.value=A,setTimeout(()=>{s.value="",i.value=!1},5e3)},c=()=>{a.baseUrl="https://demo.aeries.net/aeries",a.clientId="1279e5c6b747b6d62b7c76db3a205d40eb7458e678a90493d537d5af6b953550",a.clientSecret="68019dbf8d8ba82980dd148eecc3977ac0d7f1f040d444225874c88eb80b9c1a",l("Demo credentials loaded. Click Connect to test.")},u=async()=>{if(!a.baseUrl||!a.clientId||!a.clientSecret)return l("Please fill in all connection fields.",!0),!1;r.value=!0,l("Connecting to Aeries API...");try{const k=(await Da(t,"getAeriesToken")({baseUrl:a.baseUrl,clientId:a.clientId,clientSecret:a.clientSecret})).data;if(k.success&&k.access_token)return n.value=k.access_token,e.value=!0,l(" Successfully connected to Aeries API!"),!0;throw new Error("No access token received")}catch(_){const A=_.message||"Connection failed";return l(` Connection failed: ${A}`,!0),console.error("Aeries API Connection Error:",_),!1}finally{r.value=!1}},f=()=>{e.value=!1,n.value="",l("Disconnected from Aeries API.")},h=async _=>{if(!e.value||!n.value)return l("Not connected to Aeries API.",!0),null;try{const U=(await Da(t,"testAeriesEndpoint")({baseUrl:a.baseUrl,endpoint:_,accessToken:n.value})).data;if(U.success)return l(` Successfully fetched data from ${_}`),{data:U.data,responseTime:U.responseTime};throw new Error(U.error||"API call failed")}catch(A){const k=A.message||"API call failed";return l(` API call failed: ${k}`,!0),console.error("Aeries API Test Error:",A),{error:k}}},p=async _=>{if(!e.value||!n.value)return l("Not connected to Aeries API.",!0),null;try{const U=(await Da(t,"testCustomAeriesEndpoint")({baseUrl:a.baseUrl,endpoint:_,accessToken:n.value})).data;return U.success?(l(` Successfully fetched data from ${_}`),{data:U.data,responseTime:U.responseTime}):{error:U.error||"API call failed"}}catch(A){const k=A.message||"API call failed";return l(` API call failed: ${k}`,!0),console.error("Custom Aeries API Test Error:",A),{error:k}}},v=async()=>await h("/students"),g=async()=>await h("/teachers"),y=async()=>{const _=["/api/special-education/students","/api/students/special-education","/api/iep/students","/api/504/students"];for(const A of _){const k=await p(A);if(k&&!k.error)return k}return{error:"No special education endpoints found"}},b=async()=>await p("/api/special-education/ieps"),E=async()=>await p("/api/special-education/504-plans"),x=async()=>await p("/api/special-education/accommodations"),I=async()=>await p("/api/special-education/services"),D=async()=>await p("/api/special-education/case-managers"),P=async()=>{const _={},A=o.value.filter(k=>k.path.includes("special-education")||k.path.includes("iep")||k.path.includes("504"));for(const k of A)_[k.path]=await p(k.path);return _},w=async()=>{var A;const _=await h("/students");if(_&&!_.error&&_.data){const k=((A=_.data.students)==null?void 0:A[0])||_.data[0],U=k&&(k.specialEducation||k.iep||k.plan504||k.disabilities||k.accommodations);return{success:!0,hasSpecialEdFields:U,sampleStudent:k,message:U?"OneRoster includes special education data!":"OneRoster does not include special education data"}}return _},S=async()=>{const _=["?filter=specialEducation=true","?filter=iep=true","?filter=plan504=true","?filter=disabilities=*","?filter=accommodations=*"],A={};for(const k of _)A[k]=await h(`/students${k}`);return A};async function m({baseUrl:_,accessToken:A}){const k=cc(),R=await Da(k,"testAeriesEndpoint")({baseUrl:_,endpoint:"/schools",accessToken:A});return R.data.data.orgs||R.data.data.schools||R.data.data||[]}async function T({baseUrl:_,accessToken:A,schoolId:k}){const U=cc(),L=Da(U,"testAeriesEndpoint"),R=`/classes?filter=school.sourcedId='${k}'`,F=await L({baseUrl:_,endpoint:R,accessToken:A});return F.data.data.classes||F.data.data||[]}return{isConnected:e,isConnecting:r,accessToken:n,connectionStatus:s,isError:i,connectionConfig:a,availableEndpoints:o,showStatus:l,loadDemoCredentials:c,connect:u,disconnect:f,testEndpoint:h,testCustomEndpoint:p,fetchStudents:v,fetchTeachers:g,fetchSpecialEducationStudents:y,fetchIEPRecords:b,fetch504Plans:E,fetchAccommodations:x,fetchServices:I,fetchCaseManagers:D,testAllSpecialEducationEndpoints:P,testOneRosterForSpecialEd:w,testStudentsWithSpecialEd:S,fetchSchools:m,fetchClasses:T}}const dg=(t,e)=>{let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t.charCodeAt(n)^e.charCodeAt(n%e.length));return btoa(r)},fg=(t,e)=>{const r=atob(t);let n="";for(let s=0;s<r.length;s++)n+=String.fromCharCode(r.charCodeAt(s)^e.charCodeAt(s%e.length));return n};function GK(){const t=yo(),e=Qo(),r=se(!1),n=se(null),s=()=>{const c=e.currentUser;if(!c)throw new Error("User not authenticated");return c.uid+"_aeries_config_key"};return{isLoading:r,error:n,saveAeriesConfig:async c=>{if(!e.currentUser)throw new Error("User must be authenticated to save configuration");r.value=!0,n.value=null;try{const u=e.currentUser,f=s(),h={baseUrl:dg(c.baseUrl,f),clientId:dg(c.clientId,f),clientSecret:dg(c.clientSecret,f),selectedSchoolId:c.selectedSchoolId||"",selectedClassIds:c.selectedClassIds||[],manualClassInput:c.manualClassInput||"",savedAt:new Date().toISOString(),userId:u.uid},p=Ze(t,"users",u.uid,"aeries_config","current");return await Ht(p,h),{success:!0,message:"Configuration saved securely"}}catch(u){throw n.value=u.message,console.error("Failed to save Aeries configuration:",u),u}finally{r.value=!1}},loadAeriesConfig:async()=>{if(!e.currentUser)throw new Error("User must be authenticated to load configuration");r.value=!0,n.value=null;try{const c=e.currentUser,u=s(),f=Ze(t,"users",c.uid,"aeries_config","current"),h=await nr(f);if(!h.exists())return null;const p=h.data();if(p.userId!==c.uid)throw new Error("Configuration security check failed");return{baseUrl:fg(p.baseUrl,u),clientId:fg(p.clientId,u),clientSecret:fg(p.clientSecret,u),selectedSchoolId:p.selectedSchoolId||"",selectedClassIds:p.selectedClassIds||[],manualClassInput:p.manualClassInput||"",savedAt:p.savedAt}}catch(c){throw n.value=c.message,console.error("Failed to load Aeries configuration:",c),c}finally{r.value=!1}},deleteAeriesConfig:async()=>{if(!e.currentUser)throw new Error("User must be authenticated to delete configuration");r.value=!0,n.value=null;try{const c=e.currentUser,u=Ze(t,"users",c.uid,"aeries_config","current");return await po(u),{success:!0,message:"Configuration deleted securely"}}catch(c){throw n.value=c.message,console.error("Failed to delete Aeries configuration:",c),c}finally{r.value=!1}},hasSavedConfig:async()=>{if(!e.currentUser)return!1;try{const c=e.currentUser,u=Ze(t,"users",c.uid,"aeries_config","current");return(await nr(u)).exists()}catch(c){return console.error("Failed to check for saved configuration:",c),!1}}}}const WK={name:"AeriesAPIConnector",setup(){const{isConnected:t,isConnecting:e,accessToken:r,connectionStatus:n,isError:s,connectionConfig:i,availableEndpoints:a,showStatus:o,loadDemoCredentials:l,connect:c,disconnect:u,testEndpoint:f,testAllSpecialEducationEndpoints:h,testOneRosterForSpecialEd:p,testStudentsWithSpecialEd:v,fetchSchools:g,fetchClasses:y}=jK(),{isLoading:b,error:E,saveAeriesConfig:x,loadAeriesConfig:I,deleteAeriesConfig:D,hasSavedConfig:P}=GK(),w=se(!1),S=se(null),m=se(""),T=se(null),_=se([]),A=se(""),k=se([]),U=se([]),L=se(!1),R=se(""),F=se(""),N=se(!1),M=se({oneroster:!1,nativeAeries:!1}),z=se([]),G=se([{path:"/orgs",name:"Organizations",description:"District information"},{path:"/schools",name:"Schools",description:"School sites"},{path:"/academicSessions",name:"Academic Sessions",description:"Terms/semesters"},{path:"/grades",name:"Grades",description:"Grade levels"},{path:"/courses",name:"Courses",description:"Course catalog"},{path:"/classes",name:"Classes",description:"Sections (MST table)"},{path:"/teachers",name:"Teachers",description:"Teacher roster"},{path:"/students",name:"Students",description:"Student roster"},{path:"/enrollments",name:"Enrollments",description:"Student-to-class links"}]),H=se([{path:"/api/special-education/students",name:"SPED Students",description:"Students with IEP/504 plans"},{path:"/api/special-education/ieps",name:"IEP Records",description:"IEP documents and data"},{path:"/api/special-education/504-plans",name:"504 Plans",description:"504 plan records"},{path:"/api/special-education/accommodations",name:"Accommodations",description:"Student accommodations"},{path:"/api/special-education/services",name:"Services",description:"Related services"},{path:"/api/special-education/case-managers",name:"Case Managers",description:"Case manager assignments"},{path:"/api/students/special-education",name:"SPED Students Alt",description:"Alternative SPED endpoint"},{path:"/api/iep/students",name:"IEP Students",description:"IEP student data"},{path:"/api/504/students",name:"504 Students",description:"504 student data"}]),j=be(()=>i.baseUrl&&i.clientId&&i.clientSecret),K=async()=>{if(await c())try{w.value=!0;const ie=await g({baseUrl:i.baseUrl,accessToken:r.value});_.value=ie||[],A.value=""}catch(ie){console.error("Failed to fetch schools:",ie),o("Failed to fetch schools",!0),_.value=[]}finally{w.value=!1}},ne=async ee=>{w.value=!0,m.value=ee,S.value=null,T.value=null;const ie=await f(ee);ie&&!ie.error?(S.value=ie.data,T.value=ie.responseTime):ie&&ie.error&&(S.value={error:ie.error}),w.value=!1},he=async()=>{w.value=!0,await h(),w.value=!1},le=async()=>{w.value=!0,m.value="/students (SPED check)",S.value=null,T.value=null;const ee=await p();ee&&!ee.error?(S.value=ee,o(ee.message)):ee&&ee.error&&(S.value={error:ee.error},o(` OneRoster test failed: ${ee.error}`,!0)),w.value=!1},fe=async()=>{w.value=!0,m.value="/students (SPED filters)",S.value=null,T.value=null;const ee=await v();ee&&(S.value=ee,o("OneRoster SPED filter tests completed")),w.value=!1};Vt(A,async ee=>{if(!ee){k.value=[],U.value=[];return}L.value=!1,R.value="",w.value=!0;try{k.value=await y({baseUrl:i.baseUrl,accessToken:r.value,schoolId:ee}),U.value=[]}catch{L.value=!0,k.value=[],U.value=[]}finally{w.value=!1}});const te=be(()=>t.value&&_.value.length>0),Z=be(()=>te.value&&A.value),xe=be(()=>M.value.oneroster||M.value.nativeAeries),Q=()=>{const ee=[];M.value.oneroster&&ee.push(...G.value),M.value.nativeAeries&&ee.push(...H.value),a.value=ee},q=(ee,ie=!1)=>{F.value=ee,N.value=ie,setTimeout(()=>{F.value="",N.value=!1},5e3)},J=async()=>{try{const ee={baseUrl:i.baseUrl,clientId:i.clientId,clientSecret:i.clientSecret,selectedSchoolId:A.value,selectedClassIds:U.value,manualClassInput:R.value,selectedApiTypes:M.value,selectedEndpoints:z.value};await x(ee),q(" Configuration saved securely to Firebase!")}catch(ee){console.error("Failed to save configuration:",ee),q(` Failed to save configuration: ${ee.message}`,!0)}},pe=async()=>{try{const ee=await I();if(!ee){q(" No saved configuration found",!0);return}i.baseUrl=ee.baseUrl||"",i.clientId=ee.clientId||"",i.clientSecret=ee.clientSecret||"",A.value=ee.selectedSchoolId||"",U.value=ee.selectedClassIds||[],R.value=ee.manualClassInput||"",ee.selectedApiTypes&&(M.value=ee.selectedApiTypes),ee.selectedEndpoints&&(z.value=ee.selectedEndpoints),Q();const ie=ee.savedAt?new Date(ee.savedAt).toLocaleString():"Unknown";q(` Configuration loaded securely (saved: ${ie})`)}catch(ee){console.error("Failed to load configuration:",ee),q(` Failed to load configuration: ${ee.message}`,!0)}},ge=async()=>{if(confirm("Are you sure you want to permanently delete the saved configuration? This action cannot be undone."))try{await D(),q(" Configuration permanently deleted from Firebase!")}catch(ee){console.error("Failed to clear configuration:",ee),q(` Failed to clear configuration: ${ee.message}`,!0)}};return jt(async()=>{try{if(await P()){const ie=await I();ie&&(i.baseUrl=ie.baseUrl||"",i.clientId=ie.clientId||"",i.clientSecret=ie.clientSecret||"",ie.selectedApiTypes&&(M.value=ie.selectedApiTypes),ie.selectedEndpoints&&(z.value=ie.selectedEndpoints),Q(),q(" Configuration auto-loaded securely from Firebase"))}}catch(ee){console.error("Failed to auto-load configuration:",ee)}}),{connectionConfig:i,isConnected:t,isConnecting:e,isLoading:w,connectionStatus:n,isError:s,apiResults:S,currentEndpoint:m,responseTime:T,availableEndpoints:a,canConnect:j,loadDemoCredentials:l,connect:K,disconnect:u,testEndpoint:ne,handleTestSpecialEd:he,handleTestOneRosterSpecialEd:le,handleTestStudentsWithSpecialEd:fe,schools:_,selectedSchoolId:A,classes:k,selectedClassIds:U,classesFetchError:L,manualClassInput:R,canShowSchoolDropdown:te,canShowClasses:Z,configStatus:F,configError:N,storageLoading:b,storageError:E,saveConfiguration:J,loadConfiguration:pe,clearConfiguration:ge,selectedApiTypes:M,selectedEndpoints:z,onerosterEndpoints:G,nativeAeriesEndpoints:H,hasSelectedApiTypes:xe,updateAvailableEndpoints:Q}}},zK={class:"aeries-api-connector"},KK={class:"connection-form"},qK={class:"form-group"},XK=["disabled"],YK={class:"form-group"},QK=["disabled"],JK={class:"form-group"},ZK=["disabled"],eq={class:"button-group"},tq=["disabled"],rq=["disabled"],nq={class:"api-type-selection"},sq={class:"api-type-options"},aq={class:"api-type-option"},iq={class:"checkbox-label"},oq={class:"api-type-option"},lq={class:"checkbox-label"},cq={key:0,class:"endpoint-selection"},uq={class:"endpoint-categories"},dq={key:0,class:"endpoint-category"},fq={class:"endpoint-checkboxes"},hq=["value"],pq={class:"endpoint-name"},mq={class:"endpoint-path-small"},gq={key:1,class:"endpoint-category"},vq={class:"endpoint-checkboxes"},yq=["value"],xq={class:"endpoint-name"},Eq={class:"endpoint-path-small"},_q={class:"config-management"},bq={class:"config-buttons"},Sq=["disabled"],Aq=["disabled"],Tq=["disabled"],wq={key:1,class:"api-testing"},Cq={class:"special-ed-section"},Iq={class:"quick-test-buttons"},kq=["disabled"],Dq=["disabled"],Pq=["disabled"],Rq=["disabled"],Fq=["disabled"],Nq=["disabled"],Oq={class:"endpoint-grid"},Mq={class:"endpoint-path"},Lq={class:"endpoint-description"},Bq=["onClick","disabled"],Uq={key:0,class:"api-results"},$q={class:"results-header"},Vq={class:"endpoint-tested"},Hq={key:0,class:"response-time"},jq={class:"results-content"},Gq={key:2,class:"form-group"},Wq=["value"],zq={key:3,class:"form-group"},Kq={key:0},qq=["value"],Xq={key:1};function Yq(t,e,r,n,s,i){return O(),B("div",zK,[e[48]||(e[48]=In('<h3 data-v-0f37c4fc>Aeries API Connection</h3><div class="api-info-section" data-v-0f37c4fc><h4 data-v-0f37c4fc>Getting Students with IEP/504 Plans</h4><div class="info-grid" data-v-0f37c4fc><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc> OneRoster API (Limited)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> All students, basic info</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Cannot filter:</strong> Students with IEP/504 plans</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> You&#39;d get ALL students, not just SPED</p></div><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc> Custom Aeries API (Recommended)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> Only students with IEP/504 plans</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Includes:</strong> Accommodations, services, case managers</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> Perfect for your use case</p></div><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc> CSV Import (Fallback)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> Filtered data from Aeries export</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Process:</strong> Export SPED students  Import CSV</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> Works but requires manual steps</p></div></div><div class="testing-note" data-v-0f37c4fc><p data-v-0f37c4fc><strong data-v-0f37c4fc>Test the buttons below to see what your Aeries instance supports!</strong></p></div></div>',2)),d("div",KK,[d("div",qK,[e[24]||(e[24]=d("label",{for:"baseUrl"},"Base URL:",-1)),Be(d("input",{id:"baseUrl","onUpdate:modelValue":e[0]||(e[0]=a=>n.connectionConfig.baseUrl=a),type:"url",placeholder:"https://demo.aeries.net/aeries",disabled:n.isConnected},null,8,XK),[[ht,n.connectionConfig.baseUrl]])]),d("div",YK,[e[25]||(e[25]=d("label",{for:"clientId"},"Client ID:",-1)),Be(d("input",{id:"clientId","onUpdate:modelValue":e[1]||(e[1]=a=>n.connectionConfig.clientId=a),type:"text",placeholder:"Enter your Client ID",disabled:n.isConnected},null,8,QK),[[ht,n.connectionConfig.clientId]])]),d("div",JK,[e[26]||(e[26]=d("label",{for:"clientSecret"},"Client Secret:",-1)),Be(d("input",{id:"clientSecret","onUpdate:modelValue":e[2]||(e[2]=a=>n.connectionConfig.clientSecret=a),type:"password",placeholder:"Enter your Client Secret",disabled:n.isConnected},null,8,ZK),[[ht,n.connectionConfig.clientSecret]])]),d("div",eq,[d("button",{onClick:e[3]||(e[3]=(...a)=>n.connect&&n.connect(...a)),disabled:!n.canConnect||n.isConnecting,class:"btn-primary"},Y(n.isConnecting?"Connecting...":"Connect"),9,tq),n.isConnected?(O(),B("button",{key:0,onClick:e[4]||(e[4]=(...a)=>n.disconnect&&n.disconnect(...a)),class:"btn-secondary"}," Disconnect ")):_e("",!0),d("button",{onClick:e[5]||(e[5]=(...a)=>n.loadDemoCredentials&&n.loadDemoCredentials(...a)),disabled:n.isConnected,class:"btn-demo"}," Load Demo Credentials ",8,rq)]),d("div",nq,[e[37]||(e[37]=d("h4",null,"Select API Types",-1)),e[38]||(e[38]=d("p",{class:"api-type-description"},"Choose which Aeries API types you want to use. This determines which endpoints will be available for testing and data import.",-1)),d("div",sq,[d("div",aq,[d("label",iq,[Be(d("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>n.selectedApiTypes.oneroster=a),onChange:e[7]||(e[7]=(...a)=>n.updateAvailableEndpoints&&n.updateAvailableEndpoints(...a))},null,544),[[wt,n.selectedApiTypes.oneroster]]),e[27]||(e[27]=d("span",{class:"checkmark"},null,-1)),e[28]||(e[28]=d("strong",null,"OneRoster API",-1))]),e[29]||(e[29]=d("p",{class:"api-type-desc"},"Standard OneRoster endpoints for basic student, teacher, and class data",-1))]),d("div",oq,[d("label",lq,[Be(d("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=a=>n.selectedApiTypes.nativeAeries=a),onChange:e[9]||(e[9]=(...a)=>n.updateAvailableEndpoints&&n.updateAvailableEndpoints(...a))},null,544),[[wt,n.selectedApiTypes.nativeAeries]]),e[30]||(e[30]=d("span",{class:"checkmark"},null,-1)),e[31]||(e[31]=d("strong",null,"Native Aeries v5 API",-1))]),e[32]||(e[32]=d("p",{class:"api-type-desc"},"Aeries-specific endpoints for special education, IEP, and 504 plan data",-1))])]),n.hasSelectedApiTypes?(O(),B("div",cq,[e[35]||(e[35]=d("h5",null,"Select Endpoints to Use",-1)),e[36]||(e[36]=d("p",{class:"endpoint-description"},"Check the endpoints you want to enable for data import and testing.",-1)),d("div",uq,[n.selectedApiTypes.oneroster?(O(),B("div",dq,[e[33]||(e[33]=d("h6",null,"OneRoster Endpoints",-1)),d("div",fq,[(O(!0),B(Fe,null,He(n.onerosterEndpoints,a=>(O(),B("label",{key:a.path,class:"endpoint-checkbox"},[Be(d("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=o=>n.selectedEndpoints=o),value:a.path},null,8,hq),[[wt,n.selectedEndpoints]]),d("span",pq,Y(a.name),1),d("span",mq,Y(a.path),1)]))),128))])])):_e("",!0),n.selectedApiTypes.nativeAeries?(O(),B("div",gq,[e[34]||(e[34]=d("h6",null,"Native Aeries v5 Endpoints",-1)),d("div",vq,[(O(!0),B(Fe,null,He(n.nativeAeriesEndpoints,a=>(O(),B("label",{key:a.path,class:"endpoint-checkbox"},[Be(d("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=o=>n.selectedEndpoints=o),value:a.path},null,8,yq),[[wt,n.selectedEndpoints]]),d("span",xq,Y(a.name),1),d("span",Eq,Y(a.path),1)]))),128))])])):_e("",!0)])])):_e("",!0)]),d("div",_q,[e[39]||(e[39]=d("h4",null,"Save/Load Configuration",-1)),e[40]||(e[40]=d("div",{class:"security-note"},[d("p",null,[d("strong",null," Security:"),Ce(" Your API credentials are encrypted and stored securely in Firebase. Only you can access your saved configuration.")])],-1)),d("div",bq,[d("button",{onClick:e[12]||(e[12]=(...a)=>n.saveConfiguration&&n.saveConfiguration(...a)),disabled:!n.canConnect||n.storageLoading,class:"btn-save"},Y(n.storageLoading?" Saving...":" Save Configuration"),9,Sq),d("button",{onClick:e[13]||(e[13]=(...a)=>n.loadConfiguration&&n.loadConfiguration(...a)),disabled:n.storageLoading,class:"btn-load"},Y(n.storageLoading?" Loading...":" Load Saved Configuration"),9,Aq),d("button",{onClick:e[14]||(e[14]=(...a)=>n.clearConfiguration&&n.clearConfiguration(...a)),disabled:n.storageLoading,class:"btn-clear"},Y(n.storageLoading?" Deleting...":" Clear Saved Configuration"),9,Tq)]),n.configStatus?(O(),B("div",{key:0,class:Qe(["config-status",{error:n.configError}])},Y(n.configStatus),3)):_e("",!0)])]),n.connectionStatus?(O(),B("div",{key:0,class:Qe(["status-message",{error:n.isError}])},Y(n.connectionStatus),3)):_e("",!0),n.isConnected?(O(),B("div",wq,[e[43]||(e[43]=d("h4",null,"Test API Endpoints",-1)),d("div",Cq,[e[41]||(e[41]=d("h5",null,"Special Education Data (IEP/504)",-1)),d("div",Iq,[d("button",{onClick:e[15]||(e[15]=(...a)=>n.handleTestSpecialEd&&n.handleTestSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-special"},Y(n.isLoading?"Testing...":"Test All SPED Endpoints"),9,kq),d("button",{onClick:e[16]||(e[16]=(...a)=>n.handleTestOneRosterSpecialEd&&n.handleTestOneRosterSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-oneroster"}," Test OneRoster for SPED Data ",8,Dq),d("button",{onClick:e[17]||(e[17]=(...a)=>n.handleTestStudentsWithSpecialEd&&n.handleTestStudentsWithSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-oneroster"}," Test OneRoster SPED Filters ",8,Pq),d("button",{onClick:e[18]||(e[18]=a=>t.handleTestEndpoint("/api/special-education/students")),disabled:n.isLoading,class:"btn-test-special"}," SPED Students ",8,Rq),d("button",{onClick:e[19]||(e[19]=a=>t.handleTestEndpoint("/api/special-education/ieps")),disabled:n.isLoading,class:"btn-test-special"}," IEP Records ",8,Fq),d("button",{onClick:e[20]||(e[20]=a=>t.handleTestEndpoint("/api/special-education/504-plans")),disabled:n.isLoading,class:"btn-test-special"}," 504 Plans ",8,Nq)])]),d("div",Oq,[(O(!0),B(Fe,null,He(n.availableEndpoints,a=>(O(),B("div",{key:a.path,class:"endpoint-card"},[d("h5",null,Y(a.name),1),d("p",Mq,Y(a.path),1),d("p",Lq,Y(a.description),1),d("button",{onClick:o=>n.testEndpoint(a.path),disabled:n.isLoading,class:"btn-test"},Y(n.isLoading&&n.currentEndpoint===a.path?"Testing...":"Test"),9,Bq)]))),128))]),n.apiResults?(O(),B("div",Uq,[e[42]||(e[42]=d("h4",null,"API Response",-1)),d("div",$q,[d("span",Vq,"Endpoint: "+Y(n.currentEndpoint),1),n.responseTime?(O(),B("span",Hq,"Response time: "+Y(n.responseTime)+"ms",1)):_e("",!0)]),d("div",jq,[d("pre",null,Y(JSON.stringify(n.apiResults,null,2)),1)])])):_e("",!0)])):_e("",!0),n.canShowSchoolDropdown?(O(),B("div",Gq,[e[45]||(e[45]=d("label",null,"School",-1)),Be(d("select",{"onUpdate:modelValue":e[21]||(e[21]=a=>n.selectedSchoolId=a)},[e[44]||(e[44]=d("option",{value:"",disabled:""},"Select a school",-1)),(O(!0),B(Fe,null,He(n.schools,a=>(O(),B("option",{key:a.sourcedId||a.id||a.schoolId,value:a.sourcedId||a.id||a.schoolId},Y(a.name||a.title||a.schoolName),9,Wq))),128))],512),[[cr,n.selectedSchoolId]])])):_e("",!0),n.canShowClasses?(O(),B("div",zq,[e[47]||(e[47]=d("label",null,"Case Manager Classes",-1)),n.classesFetchError?(O(),B("div",Xq,[e[46]||(e[46]=d("p",{class:"error"},"Could not fetch classes. Enter class names manually (comma separated):",-1)),Be(d("input",{"onUpdate:modelValue":e[23]||(e[23]=a=>n.manualClassInput=a),type:"text",placeholder:"Class1, Class2, ..."},null,512),[[ht,n.manualClassInput]])])):(O(),B("div",Kq,[Be(d("select",{"onUpdate:modelValue":e[22]||(e[22]=a=>n.selectedClassIds=a),multiple:""},[(O(!0),B(Fe,null,He(n.classes,a=>(O(),B("option",{key:a.sourcedId||a.id||a.classId,value:a.sourcedId||a.id||a.classId},Y(a.title||a.name||a.className),9,qq))),128))],512),[[cr,n.selectedClassIds]])]))])):_e("",!0)])}const Qq=xt(WK,[["render",Yq],["__scopeId","data-v-0f37c4fc"]]),Jq={key:0,class:"app-settings-panel"},Zq={class:"settings-section"},eX={class:"grades-checkboxes"},tX=["checked"],rX=["value"],nX={class:"settings-section"},sX={key:0,class:"class-service-fieldset"},aX={class:"checkbox-inline-group"},iX=["value"],oX={key:1,class:"class-service-fieldset"},lX={class:"checkbox-inline-group"},cX=["value"],uX={key:2,class:"class-service-fieldset"},dX={class:"checkbox-inline-group"},fX=["value"],hX={key:3,class:"class-service-fieldset"},pX={class:"checkbox-inline-group"},mX={key:4,class:"class-service-fieldset"},gX={class:"checkbox-inline-group"},vX=["onClick"],yX={class:"checkbox-inline-group"},xX=["onClick"],EX=["onClick"],_X={class:"add-class-service"},bX={class:"custom-chips"},SX=["onClick"],AX={class:"settings-section"},TX={class:"service-providers-defaults"},wX=["value"],CX={class:"service-providers-custom"},IX={class:"custom-provider-inputs"},kX={class:"custom-chips"},DX=["onClick"],PX={class:"settings-section"},RX={class:"periods-controls"},FX={class:"period-number-control"},NX={key:0,class:"period-labels"},OX={class:"period-labels-grid"},MX=["onUpdate:modelValue","placeholder"],LX={key:1,class:"period-preview"},BX={class:"settings-section"},UX={class:"admin-action-btns"},$X=["disabled"],VX=["disabled"],HX=["disabled"],jX={key:1,class:"not-admin"},GX={__name:"AppSettings",setup(t){const{currentUser:e}=sf(),r=be(()=>{var T;return((T=e.value)==null?void 0:T.role)||null}),n=be(()=>["admin","school_admin","admin_504","sped_chair"].includes(r.value)),s=[{value:"K",label:"K"},...Array.from({length:12},(T,_)=>({value:(_+1).toString(),label:(_+1).toString()}))],i=["English","Math","History","Science"],a=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}],{loadAppSettings:o,saveAppSettings:l}=qs(),c=se(!1),u=se(!1),f=se(""),h=se(!1),p=se(""),v=se(""),g=se({grades:["7","8"],classServices:[{name:"SDC",enabledSubcategories:[...i]},{name:"Co-teach",enabledSubcategories:[...i]}],serviceProviders:["SLP","OT","MH"],serviceProvidersDetails:a,customServiceProviders:[],numPeriods:7,periodLabels:["Per1","Per2","Per3","Per4","Per5","Per6","Per7"]}),y=()=>{const T=V2(g.value.numPeriods,{min:1,max:15,decimals:0});if(T===null)return P("Invalid number of periods. Must be between 1 and 15.",!0),!1;g.value.numPeriods=T;for(let _=0;_<g.value.numPeriods;_++){g.value.periodLabels[_]||(g.value.periodLabels[_]=`Per${_+1}`);const A=mn(g.value.periodLabels[_],{trim:!0,maxLength:3,removeDangerous:!0}),k=qr(A);if(!k.isSafe)return P(`Security threat detected in period ${_+1} label: ${k.threats.join(", ")}`,!0),!1;const U=Ad(A,{max:3,fieldName:`Period ${_+1} label`});if(!U.isValid)return P(U.error,!0),!1;g.value.periodLabels[_]=A}if(g.value.customServiceProviders)for(let _=0;_<g.value.customServiceProviders.length;_++){const A=g.value.customServiceProviders[_];if(A.name){const k=mn(A.name,{trim:!0,maxLength:100,removeDangerous:!0}),U=qr(k);if(!U.isSafe)return P(`Security threat detected in custom provider ${_+1}: ${U.threats.join(", ")}`,!0),!1;A.name=k}if(A.abbreviation){const k=mn(A.abbreviation,{trim:!0,maxLength:10,removeDangerous:!0}),U=qr(k);if(!U.isSafe)return P(`Security threat detected in custom provider abbreviation ${_+1}: ${U.threats.join(", ")}`,!0),!1;A.abbreviation=k}}return!0},b=be(()=>a),E=be(()=>s.every(T=>g.value.grades.includes(T.value))),x=T=>{T.target.checked?g.value.grades=s.map(_=>_.value):g.value.grades=[]},I=()=>{if(!p.value.trim()||!v.value.trim()){P("Both name and abbreviation are required for custom service providers",!0);return}if(g.value.customServiceProviders.some(_=>_.abbreviation.toLowerCase()===v.value.toLowerCase())){P("A service provider with this abbreviation already exists",!0);return}g.value.customServiceProviders.push({name:p.value.trim(),abbreviation:v.value.trim()}),p.value="",v.value="",P("Custom service provider added successfully")},D=T=>{g.value.customServiceProviders.splice(T,1)};Vt(()=>g.value.numPeriods,T=>{const _=V2(T,{min:1,max:15,decimals:0});if(_!==null&&_!==T&&(g.value.numPeriods=_),g.value.periodLabels.length<g.value.numPeriods)for(let A=g.value.periodLabels.length;A<g.value.numPeriods;A++)g.value.periodLabels.push(`Per${A+1}`)}),Vt(()=>g.value.periodLabels,T=>{T.forEach((_,A)=>{_&&_.length>3&&(g.value.periodLabels[A]=_.substring(0,3))})},{deep:!0});const P=(T,_=!1)=>{f.value=T,h.value=_,setTimeout(()=>{f.value="",h.value=!1},5e3)},w=async(T=!1)=>{c.value=!0;try{const _=await o();if(_){if(g.value={...g.value,..._},!g.value.periodLabels||g.value.periodLabels.length<g.value.numPeriods){g.value.periodLabels=[];for(let A=0;A<g.value.numPeriods;A++)g.value.periodLabels[A]=g.value.periodLabels[A]||`Per${A+1}`}T&&P("Settings loaded successfully")}}catch(_){P("Error loading settings",!0),console.error("Load settings error:",_)}finally{c.value=!1}},S=async()=>{if(!Is("saveAppSettings",10,6e4).allowed){P("Too many save requests. Please wait before saving again.",!0);return}if(y()){u.value=!0;try{await l(g.value),P("Settings saved successfully")}catch(_){P("Error saving settings",!0),console.error("Save settings error:",_)}finally{u.value=!1}}},m=()=>{confirm("Are you sure you want to reset all settings to defaults? This cannot be undone.")&&(g.value={grades:["7","8"],classServices:[{name:"SDC",enabledSubcategories:[...i]},{name:"Co-teach",enabledSubcategories:[...i]}],serviceProviders:["SLP","OT","MH"],serviceProvidersDetails:a,customServiceProviders:[],numPeriods:7,periodLabels:["Per1","Per2","Per3","Per4","Per5","Per6","Per7"]},P("Settings reset to defaults"))};return jt(()=>{w()}),(T,_)=>n.value?(O(),B("div",Jq,[_[33]||(_[33]=d("h2",null,"App Settings",-1)),d("form",{onSubmit:dn(S,["prevent"])},[d("section",Zq,[d("fieldset",null,[_[17]||(_[17]=d("legend",null,"Grades",-1)),d("div",eX,[d("label",null,[d("input",{type:"checkbox",checked:E.value,onChange:x},null,40,tX),_[16]||(_[16]=d("span",null,"Select All",-1))]),(O(),B(Fe,null,He(s,A=>d("label",{key:A.value},[Be(d("input",{type:"checkbox","onUpdate:modelValue":_[0]||(_[0]=k=>g.value.grades=k),value:A.value},null,8,rX),[[wt,g.value.grades]]),d("span",null,Y(A.label),1)])),64))])])]),d("section",nX,[_[26]||(_[26]=d("h3",null,"Class Services",-1)),g.value.classServices[0]&&g.value.classServices[0].enabledSubcategories?(O(),B("div",sX,[d("fieldset",null,[_[18]||(_[18]=d("legend",null,"SDC",-1)),d("div",aX,[(O(),B(Fe,null,He(i,A=>d("label",{key:A},[Be(d("input",{type:"checkbox","onUpdate:modelValue":_[1]||(_[1]=k=>g.value.classServices[0].enabledSubcategories=k),value:A},null,8,iX),[[wt,g.value.classServices[0].enabledSubcategories]]),Ce(" "+Y(A),1)])),64))])])])):_e("",!0),g.value.classServices[1]&&g.value.classServices[1].enabledSubcategories?(O(),B("div",oX,[d("fieldset",null,[_[19]||(_[19]=d("legend",null,"Co-teach",-1)),d("div",lX,[(O(),B(Fe,null,He(i,A=>d("label",{key:A},[Be(d("input",{type:"checkbox","onUpdate:modelValue":_[2]||(_[2]=k=>g.value.classServices[1].enabledSubcategories=k),value:A},null,8,cX),[[wt,g.value.classServices[1].enabledSubcategories]]),Ce(" "+Y(A),1)])),64))])])])):_e("",!0),g.value.classServices[2]&&g.value.classServices[2].enabledSubcategories?(O(),B("div",uX,[d("fieldset",null,[_[20]||(_[20]=d("legend",null,"RSP",-1)),d("div",dX,[(O(),B(Fe,null,He(i,A=>d("label",{key:A},[Be(d("input",{type:"checkbox","onUpdate:modelValue":_[3]||(_[3]=k=>g.value.classServices[2].enabledSubcategories=k),value:A},null,8,fX),[[wt,g.value.classServices[2].enabledSubcategories]]),Ce(" "+Y(A),1)])),64))])])])):_e("",!0),g.value.classServices[3]&&g.value.classServices[3].enabledSubcategories?(O(),B("div",hX,[d("fieldset",null,[_[22]||(_[22]=d("legend",null,"Directed Studies",-1)),d("div",pX,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":_[4]||(_[4]=A=>g.value.classServices[3].enabledSubcategories=A),value:"Directed Studies"},null,512),[[wt,g.value.classServices[3].enabledSubcategories]]),_[21]||(_[21]=Ce(" Directed Studies "))])])])])):_e("",!0),g.value.classServices[4]&&g.value.classServices[4].enabledSubcategories?(O(),B("div",mX,[d("fieldset",null,[_[24]||(_[24]=d("legend",null,"FA",-1)),d("div",gX,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":_[5]||(_[5]=A=>g.value.classServices[4].enabledSubcategories=A),value:"FA"},null,512),[[wt,g.value.classServices[4].enabledSubcategories]]),_[23]||(_[23]=Ce(" FA "))])])])])):_e("",!0),(O(!0),B(Fe,null,He(g.value.classServices.slice(5),(A,k)=>(O(),B("div",{key:A.name,class:"class-service-fieldset"},[d("fieldset",null,[d("legend",null,[Ce(Y(A.name)+" ",1),d("button",{type:"button",onClick:U=>T.removeClassService(k+5),title:"Remove Service"},"",8,vX)]),d("div",yX,[(O(!0),B(Fe,null,He(A.subcategories,(U,L)=>(O(),B("label",{key:U},[_[25]||(_[25]=d("input",{type:"checkbox",checked:!0,disabled:""},null,-1)),Ce(" "+Y(U)+" ",1),d("button",{type:"button",onClick:R=>T.removeSubcategory(k+5,L),title:"Remove Subcategory"},"",8,xX)]))),128)),d("button",{type:"button",onClick:U=>T.addSubcategory(k+5)},"+ Add Subcategory",8,EX)])])]))),128)),d("div",_X,[Be(d("input",{type:"text","onUpdate:modelValue":_[6]||(_[6]=A=>T.newServiceName=A),placeholder:"New Service Name",maxlength:"18"},null,512),[[ht,T.newServiceName]]),Be(d("input",{type:"text","onUpdate:modelValue":_[7]||(_[7]=A=>T.newServiceSubcat=A),placeholder:"Add Subcategory",maxlength:"18",onKeyup:_[8]||(_[8]=MT((...A)=>T.addNewServiceSubcat&&T.addNewServiceSubcat(...A),["enter"]))},null,544),[[ht,T.newServiceSubcat]]),d("button",{type:"button",onClick:_[9]||(_[9]=(...A)=>T.addNewServiceSubcat&&T.addNewServiceSubcat(...A))},"+ Add Subcategory"),d("div",bX,[(O(!0),B(Fe,null,He(T.newServiceSubcats,(A,k)=>(O(),B("span",{key:A,class:"chip"},[Ce(Y(A)+" ",1),d("button",{type:"button",onClick:U=>T.removeNewServiceSubcat(k)},"",8,SX)]))),128))]),d("button",{type:"button",onClick:_[10]||(_[10]=(...A)=>T.addClassService&&T.addClassService(...A))},"+ Add Class Service")])]),d("section",AX,[d("fieldset",null,[_[28]||(_[28]=d("legend",null,"Service Providers",-1)),d("div",TX,[(O(!0),B(Fe,null,He(b.value,A=>(O(),B("label",{key:A.abbreviation},[Be(d("input",{type:"checkbox","onUpdate:modelValue":_[11]||(_[11]=k=>g.value.serviceProviders=k),value:A.abbreviation},null,8,wX),[[wt,g.value.serviceProviders]]),d("span",null,Y(A.name)+" ("+Y(A.abbreviation)+")",1)]))),128))]),d("div",CX,[_[27]||(_[27]=d("label",null,"Add Custom Service Provider:",-1)),d("div",IX,[Be(d("input",{type:"text","onUpdate:modelValue":_[12]||(_[12]=A=>p.value=A),placeholder:"Full Name",maxlength:"100"},null,512),[[ht,p.value]]),Be(d("input",{type:"text","onUpdate:modelValue":_[13]||(_[13]=A=>v.value=A),placeholder:"Abbreviation",maxlength:"10"},null,512),[[ht,v.value]]),d("button",{type:"button",onClick:I},"Add")]),d("div",kX,[(O(!0),B(Fe,null,He(g.value.customServiceProviders,(A,k)=>(O(),B("span",{key:k,class:"chip"},[Ce(Y(A.name)+" ("+Y(A.abbreviation)+") ",1),d("button",{type:"button",onClick:U=>D(k)},"",8,DX)]))),128))])])])]),d("section",PX,[d("fieldset",null,[_[32]||(_[32]=d("legend",null,"Periods",-1)),d("div",RX,[d("div",FX,[d("label",null,[_[29]||(_[29]=Ce(" Number of Periods (max 15): ")),Be(d("input",{type:"number","onUpdate:modelValue":_[14]||(_[14]=A=>g.value.numPeriods=A),min:"1",max:"15",class:"period-number-input"},null,512),[[ht,g.value.numPeriods]])])]),g.value.numPeriods>0?(O(),B("div",NX,[_[30]||(_[30]=d("h4",null,"Period Labels (3 chars max each):",-1)),d("div",OX,[(O(!0),B(Fe,null,He(g.value.numPeriods,A=>(O(),B("div",{key:A,class:"period-label-item"},[d("label",null,[Ce(" Period "+Y(A)+": ",1),Be(d("input",{type:"text","onUpdate:modelValue":k=>g.value.periodLabels[A-1]=k,maxlength:"3",placeholder:`Per${A}`,class:"period-label-input"},null,8,MX),[[ht,g.value.periodLabels[A-1]]])])]))),128))])])):_e("",!0),g.value.numPeriods>0?(O(),B("div",LX,[_[31]||(_[31]=d("strong",null,"Preview:",-1)),(O(!0),B(Fe,null,He(g.value.numPeriods,A=>(O(),B("span",{key:A,class:"period-preview-item"},Y(g.value.periodLabels[A-1]||`Per${A}`),1))),128))])):_e("",!0)])])]),d("section",BX,[d("div",UX,[d("button",{type:"submit",disabled:u.value||c.value,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}}," Save Settings",8,$X),d("button",{type:"button",onClick:_[15]||(_[15]=()=>w(!0)),disabled:c.value,class:"admin-action-btn info",style:{"min-width":"100px","max-width":"100px"}}," Load",8,VX),d("button",{type:"button",onClick:m,disabled:c.value,class:"admin-action-btn warning",style:{"min-width":"100px","max-width":"100px"}}," Reset",8,HX)]),f.value?(O(),B("div",{key:0,class:Qe(["status-message",{error:h.value,success:!h.value}])},Y(f.value),3)):_e("",!0)])],32)])):(O(),B("div",jX,_[34]||(_[34]=[d("h2",null,"App Settings",-1),d("p",null,"Access denied. You must be an admin to view this page.",-1)])))}},WX=xt(GX,[["__scopeId","data-v-a0957efc"]]),zX={class:"admin-aide-assignment"},KX={class:"header"},qX={class:"header-actions"},XX=["disabled"],YX={key:0},QX={key:1},JX={class:"content"},ZX={key:0,class:"error-message"},eY={key:1,class:"error-message"},tY={key:2,class:"loading"},rY={key:3,class:"schedule-container"},nY={class:"aide-schedule-table"},sY={class:"aide-name"},aY=["value","onChange"],iY=["value"],oY={class:"assignment-buttons"},lY=["onClick"],cY=["onClick"],uY={class:"direct-assignment-cell"},dY=["value","onChange"],fY=["value"],hY={class:"assignment-buttons"},pY=["onClick"],mY=["onClick"],gY={__name:"AdminAideAssignment",setup(t){const e=Ci(),{userList:r,fetchUsers:n}=_a(),{students:s,fetchStudents:i}=Ii(),a=Fs(),{aideAssignment:o,loadAideAssignments:l,saveAllAideAssignments:c}=Ky(),{appSettings:u,loadAppSettings:f}=qs(),h=se(!0),p=se(!1),v=be(()=>{var R;const L=(R=a.currentUser)==null?void 0:R.role;return["admin","school_admin","admin_504","sped_chair"].includes(L)}),g=be(()=>{var L;return((L=r.value)==null?void 0:L.filter(R=>R.role==="paraeducator"))||[]}),y=be(()=>{var L;return((L=r.value)==null?void 0:L.filter(R=>R.role==="teacher"))||[]}),b=be(()=>{var R;const L=((R=u.value)==null?void 0:R.numPeriods)||7;return Array.from({length:L},(F,N)=>N+1)});function E(L){return L.id}function x(L){return L.id}function I(L,R){if(!o.value[L])return[""];o.value[L].classAssignment||(o.value[L].classAssignment={});let F=o.value[L].classAssignment[R];return Array.isArray(F)?F.length?F:[""]:typeof F=="string"&&F!==""?[F]:[""]}function D(L){if(!o.value[L])return[""];let R=o.value[L].directAssignment;return Array.isArray(R)?R.length?R:[""]:typeof R=="string"&&R!==""?[R]:[""]}function P(L,R,F,N){o.value[L]||(o.value[L]={classAssignment:{},directAssignment:[]}),o.value[L].classAssignment||(o.value[L].classAssignment={});let M=I(L,R);for(M[F]=N;M.length>1&&M[M.length-1]==="";)M.pop();o.value[L].classAssignment[R]=[...M]}function w(L,R,F){o.value[L]||(o.value[L]={classAssignment:{},directAssignment:[]});let N=D(L);for(N[R]=F;N.length>1&&N[N.length-1]==="";)N.pop();o.value[L].directAssignment=[...N]}function S(L,R){o.value[L]||(o.value[L]={classAssignment:{},directAssignment:[]}),o.value[L].classAssignment||(o.value[L].classAssignment={});let F=I(L,R);F.push(""),o.value[L].classAssignment[R]=[...F]}function m(L,R,F){if(!o.value[L]||!o.value[L].classAssignment)return;let N=I(L,R);N.length<=1||(N.splice(F,1),o.value[L].classAssignment[R]=[...N])}function T(L){o.value[L]||(o.value[L]={classAssignment:{},directAssignment:[]});let R=D(L);R.push(""),o.value[L].directAssignment=[...R]}function _(L,R){if(!o.value[L])return;let F=D(L);F.length<=1||(F.splice(R,1),o.value[L].directAssignment=[...F])}async function A(){try{h.value=!0,await Promise.all([n(),i(),l(),f()]),h.value=!1}catch(L){console.error("Error loading data:",L),h.value=!1}}async function k(){try{p.value=!0,await c(),p.value=!1}catch(L){console.error("Error saving aide assignments:",L),p.value=!1}}function U(){e.push("/admin")}return jt(A),(L,R)=>(O(),B("div",zX,[d("div",KX,[R[3]||(R[3]=d("h1",null,"Aide Assignment Management",-1)),d("div",qX,[d("button",{onClick:k,class:"btn btn-primary",disabled:p.value},[p.value?(O(),B("span",YX,"")):(O(),B("span",QX,"")),Ce(" "+Y(p.value?"Saving...":"Save Assignments"),1)],8,XX),d("button",{onClick:U,class:"btn btn-secondary"},R[2]||(R[2]=[d("span",null,"",-1),Ce(" Back ")]))])]),d("div",JX,[X(a).currentUser?v.value?h.value?(O(),B("div",tY," Loading aide assignments... ")):(O(),B("div",rY,[d("table",nY,[d("thead",null,[d("tr",null,[R[8]||(R[8]=d("th",null,"Aide Name",-1)),(O(!0),B(Fe,null,He(b.value,F=>(O(),B("th",{key:F,class:"period-header"}," Period "+Y(F),1))),128)),R[9]||(R[9]=d("th",null,"Direct Assignment",-1))])]),d("tbody",null,[(O(!0),B(Fe,null,He(g.value,F=>(O(),B("tr",{key:F.id,class:"aide-row"},[d("td",sY,Y(F.name||F.email),1),(O(!0),B(Fe,null,He(b.value,N=>(O(),B("td",{key:N,class:"period-cell"},[(O(!0),B(Fe,null,He(I(E(F),N),(M,z)=>(O(),B("div",{key:"t-"+z,class:"assignment-row"},[d("select",{value:M,onChange:G=>P(E(F),N,z,G.target.value),class:"teacher-select"},[R[10]||(R[10]=d("option",{value:""},"No Assignment",-1)),(O(!0),B(Fe,null,He(y.value,G=>(O(),B("option",{key:x(G),value:x(G)},Y(G.name||G.email),9,iY))),128))],40,aY),d("div",oY,[I(E(F),N).length>1?(O(),B("button",{key:0,onClick:G=>m(E(F),N,z),class:"btn btn-small btn-danger assignment-remove",title:"Remove assignment",type:"button"},"",8,lY)):_e("",!0),z===I(E(F),N).length-1?(O(),B("button",{key:1,onClick:G=>S(E(F),N),class:"btn btn-small btn-secondary assignment-add",title:"Add assignment",type:"button"},"+",8,cY)):_e("",!0)])]))),128))]))),128)),d("td",uY,[(O(!0),B(Fe,null,He(D(E(F)),(N,M)=>(O(),B("div",{key:"d-"+M,class:"assignment-row"},[d("select",{value:N,onChange:z=>w(E(F),M,z.target.value),class:"student-select"},[R[11]||(R[11]=d("option",{value:""},"No Assignment",-1)),(O(!0),B(Fe,null,He(X(s),z=>(O(),B("option",{key:z.id,value:z.id},Y(X(it)(z,"firstName"))+" "+Y(X(it)(z,"lastName")),9,fY))),128))],40,dY),d("div",hY,[D(E(F)).length>1?(O(),B("button",{key:0,onClick:z=>_(E(F),M),class:"btn btn-small btn-danger assignment-remove",title:"Remove assignment",type:"button"},"",8,pY)):_e("",!0),M===D(E(F)).length-1?(O(),B("button",{key:1,onClick:z=>T(E(F)),class:"btn btn-small btn-secondary assignment-add",title:"Add assignment",type:"button"},"+",8,mY)):_e("",!0)])]))),128))])]))),128))])])])):(O(),B("div",eY,[R[6]||(R[6]=d("h2",null,"Access Denied",-1)),R[7]||(R[7]=d("p",null,"You do not have permission to access this page.",-1)),d("button",{onClick:R[1]||(R[1]=F=>X(e).push("/")),class:"btn btn-primary"},"Go Home")])):(O(),B("div",ZX,[R[4]||(R[4]=d("h2",null,"Authentication Required",-1)),R[5]||(R[5]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:R[0]||(R[0]=F=>X(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])]))}},EI=xt(gY,[["__scopeId","data-v-bd60dfde"]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var _I=1252,vY=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ex={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tx=function(t){vY.indexOf(t)!=-1&&(_I=ex[0]=t)};function yY(){tx(1252)}var ca=function(t){tx(t)};function bI(){ca(1200),yY()}function Ib(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function xY(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function SI(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Eu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?xY(t.slice(2)):e==254&&r==255?SI(t.slice(2)):e==65279?t.slice(1):t},Kf=function(e){return String.fromCharCode(e)},kb=function(e){return String.fromCharCode(e)},Td,Ji="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Db(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),i=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Ji.charAt(i)+Ji.charAt(a)+Ji.charAt(o)+Ji.charAt(l);return e}function Ps(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)i=Ji.indexOf(t.charAt(c++)),a=Ji.indexOf(t.charAt(c++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=Ji.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ji.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var Jt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),gl=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function mo(t){return Jt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Pb(t){return Jt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var oa=function(e){return Jt?gl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function vl(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function rx(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return rx(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Xi=Jt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:gl(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function EY(t){for(var e=[],r=0,n=t.length+250,s=mo(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=mo(65535),n=65530)}return e.push(s.slice(0,r)),Xi(e)}var ds=/\u0000/g,_u=/[\u0001-\u0006]/g;function dc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ua(t,e){var r=""+t;return r.length>=e?r:Vr("0",e-r.length)+r}function nx(t,e){var r=""+t;return r.length>=e?r:Vr(" ",e-r.length)+r}function Eh(t,e){var r=""+t;return r.length>=e?r:r+Vr(" ",e-r.length)}function _Y(t,e){var r=""+Math.round(t);return r.length>=e?r:Vr("0",e-r.length)+r}function bY(t,e){var r=""+t;return r.length>=e?r:Vr("0",e-r.length)+r}var Rb=Math.pow(2,32);function Fl(t,e){if(t>Rb||t<-Rb)return _Y(t,e);var r=Math.round(t);return bY(r,e)}function _h(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Fb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],hg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SY(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Bt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Nb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},AY={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function bh(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(s);c<e&&(f=Math.floor(s),o=f*a+i,u=f*c+l,!(s-f<5e-8));)s=1/(s-f),i=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=i):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function Bo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=DY(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var AI=new Date(1899,11,31,0,0,0),TY=AI.getTime(),wY=new Date(1900,2,1,0,0,0);function TI(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=wY&&(r+=24*60*60*1e3),(r-(TY+(t.getTimezoneOffset()-AI.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function sx(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function CY(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function IY(t){var e=t<0?12:11,r=sx(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function kY(t){var e=sx(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function wd(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=IY(t):e===10?r=t.toFixed(10).substr(0,12):r=kY(t),sx(CY(r.toUpperCase()))}function sl(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):wd(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ws(14,TI(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function DY(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function PY(t,e,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return hg[r.m-1][1];case 5:return hg[r.m-1][0];default:return hg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Fb[r.q][0];default:return Fb[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ua(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=ua(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?ua(l,c):"";return u}function Zi(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var wI=/%/g;function RY(t,e,r){var n=e.replace(wI,""),s=e.length-n.length;return fi(t,n,r*Math.pow(10,2*s))+Vr("%",s)}function FY(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return fi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function CI(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+CI(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var II=/# (\?+)( ?)\/( ?)(\d+)/;function NY(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Vr(" ",t[1].length+1+t[4].length):nx(a,t[1].length)+t[2]+"/"+t[3]+ua(o,t[4].length))}function OY(t,e,r){return r+(e===0?"":""+e)+Vr(" ",t[1].length+2+t[4].length)}var kI=/^#*0*\.([0#]+)/,DI=/\).*[0#]/,PI=/\(###\) ###\\?-####/;function as(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Ob(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Mb(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function MY(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function LY(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Bs(t,e,r){if(t.charCodeAt(0)===40&&!e.match(DI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Bs("n",n,r):"("+Bs("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return FY(t,e,r);if(e.indexOf("%")!==-1)return RY(t,e,r);if(e.indexOf("E")!==-1)return CI(e,r);if(e.charCodeAt(0)===36)return"$"+Bs(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Fl(l,e.length);if(e.match(/^[#?]+$/))return s=Fl(r,0),s==="0"&&(s=""),s.length>e.length?s:as(e.substr(0,e.length-s.length))+s;if(i=e.match(II))return NY(i,l,c);if(e.match(/^#+0+$/))return c+Fl(l,e.length-e.indexOf("0"));if(i=e.match(kI))return s=Ob(r,i[1].length).replace(/^([^\.]+)$/,"$1."+as(i[1])).replace(/\.$/,"."+as(i[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+Vr("0",as(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+Ob(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Zi(Fl(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Bs(t,e,-r):Zi(""+(Math.floor(r)+MY(r,i[1].length)))+"."+ua(Mb(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return Bs(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=dc(Bs(t,e.replace(/[\\-]/g,""),r)),a=0,dc(dc(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<s.length?s.charAt(a++):v==="0"?"0":""}));if(e.match(PI))return s=Bs(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=bh(l,Math.pow(10,a)-1,!1),s=""+c,u=fi("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Eh(o[2],a),u.length<i[4].length&&(u=as(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=bh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?nx(o[1],a)+i[2]+"/"+i[3]+Eh(o[2],a):Vr(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Fl(r,0),e.length<=s.length?s:as(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,h=e.length-s.length-f;return as(e.substr(0,f)+s+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=Mb(r,i[1].length),r<0?"-"+Bs(t,e,-r):Zi(LY(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ua(0,3-v.length):"")+v})+"."+ua(a,i[1].length);switch(e){case"###,##0.00":return Bs(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Zi(Fl(l,0));return p!=="0"?c+p:"";case"###,###.00":return Bs(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Bs(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function BY(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return fi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function UY(t,e,r){var n=e.replace(wI,""),s=e.length-n.length;return fi(t,n,r*Math.pow(10,2*s))+Vr("%",s)}function RI(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+RI(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function wa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(DI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?wa("n",n,r):"("+wa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return BY(t,e,r);if(e.indexOf("%")!==-1)return UY(t,e,r);if(e.indexOf("E")!==-1)return RI(e,r);if(e.charCodeAt(0)===36)return"$"+wa(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+ua(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:as(e.substr(0,e.length-s.length))+s;if(i=e.match(II))return OY(i,l,c);if(e.match(/^#+0+$/))return c+ua(l,e.length-e.indexOf("0"));if(i=e.match(kI))return s=(""+r).replace(/^([^\.]+)$/,"$1."+as(i[1])).replace(/\.$/,"."+as(i[1])),s=s.replace(/\.(\d*)$/,function(v,g){return"."+g+Vr("0",as(i[1]).length-g.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Zi(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+wa(t,e,-r):Zi(""+r)+"."+Vr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return wa(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=dc(wa(t,e.replace(/[\\-]/g,""),r)),a=0,dc(dc(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<s.length?s.charAt(a++):v==="0"?"0":""}));if(e.match(PI))return s=wa(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=bh(l,Math.pow(10,a)-1,!1),s=""+c,u=fi("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=Eh(o[2],a),u.length<i[4].length&&(u=as(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=bh(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?nx(o[1],a)+i[2]+"/"+i[3]+Eh(o[2],a):Vr(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:as(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,h=e.length-s.length-f;return as(e.substr(0,f)+s+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+wa(t,e,-r):Zi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ua(0,3-v.length):"")+v})+"."+ua(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Zi(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return wa(t,e.slice(0,e.lastIndexOf(".")),r)+as(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function fi(t,e,r){return(r|0)===r?wa(t,e,r):Bs(t,e,r)}function $Y(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var FI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function jc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":_h(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(FI))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function VY(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",c,u,f,h="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!_h(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(f=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=t.charAt(++a),v=p==="("||p===")"?p:"t";s[s.length]={t:v,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=Bo(e,r,t.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=Bo(e,r),c==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(c==null&&(c=Bo(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",h="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",a+=5,h="h"):t.substr(a,5).toUpperCase()==="/"?(c!=null&&(g.v=c.H>=12?"":""),g.t="T",a+=5,h="h"):(g.t="t",++a),c==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(FI)){if(c==null&&(c=Bo(e,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",jc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var y=0,b=0,E;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=h,l="h",y<1&&(y=1);break;case"s":(E=s[a].v.match(/\.0+$/))&&(b=Math.max(b,E[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[a].v.match(/[Hh]/)&&(y=1),y<2&&s[a].v.match(/[Mm]/)&&(y=2),y<3&&s[a].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",I;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=PY(s[a].t.charCodeAt(0),s[a].v,c,b),s[a].t="t";break;case"n":case"?":for(I=a+1;s[I]!=null&&((o=s[I].t)==="?"||o==="D"||(o===" "||o==="t")&&s[I+1]!=null&&(s[I+1].t==="?"||s[I+1].t==="t"&&s[I+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[I].v==="/"||s[I].v===" "&&s[I+1]!=null&&s[I+1].t=="?"));)s[a].v+=s[I].v,s[I]={v:"",t:";"},++I;x+=s[a].v,a=I-1;break;case"G":s[a].t="t",s[a].v=sl(e,r);break}var D="",P,w;if(x.length>0){x.charCodeAt(0)==40?(P=e<0&&x.charCodeAt(0)===45?-e:e,w=fi("n",x,P)):(P=e<0&&n>1?-e:e,w=fi("n",x,P),P<0&&s[0]&&s[0].t=="t"&&(w=w.substr(1),s[0].v="-"+s[0].v)),I=w.length-1;var S=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){S=a;break}var m=s.length;if(S===s.length&&w.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(I>=s[a].v.length-1?(I-=s[a].v.length,s[a].v=w.substr(I+1,s[a].v.length)):I<0?s[a].v="":(s[a].v=w.substr(0,I+1),I=-1),s[a].t="t",m=a);I>=0&&m<s.length&&(s[m].v=w.substr(0,I+1)+s[m].v)}else if(S!==s.length&&w.indexOf("E")===-1){for(I=w.indexOf(".")-1,a=S;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===S?s[a].v.indexOf(".")-1:s[a].v.length-1,D=s[a].v.substr(u+1);u>=0;--u)I>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(D=w.charAt(I--)+D);s[a].v=D,s[a].t="t",m=a}for(I>=0&&m<s.length&&(s[m].v=w.substr(0,I+1)+s[m].v),I=w.indexOf(".")+1,a=S;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==S)){for(u=s[a].v.indexOf(".")>-1&&a===S?s[a].v.indexOf(".")+1:0,D=s[a].v.substr(0,u);u<s[a].v.length;++u)I<w.length&&(D+=w.charAt(I++));s[a].v=D,s[a].t="t",m=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(P=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=fi(s[a].t,s[a].v,P),s[a].t="t");var T="";for(a=0;a!==s.length;++a)s[a]!=null&&(T+=s[a].v);return T}var Lb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Bb(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function HY(t,e){var r=$Y(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Lb),o=r[1].match(Lb);return Bb(e,a)?[n,r[0]]:Bb(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Ws(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Bt)[t],n==null&&(n=r.table&&r.table[Nb[t]]||Bt[Nb[t]]),n==null&&(n=AY[t]||"General");break}if(_h(n,0))return sl(e,r);e instanceof Date&&(e=TI(e,r.date1904));var s=HY(n,e);if(_h(s[1]))return sl(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return VY(s[1],e,r,s[0])}function Wo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Bt[r]==null){e<0&&(e=r);continue}if(Bt[r]==t){e=r;break}}e<0&&(e=391)}return Bt[e]=t,e}function NI(){Bt=SY()}var jY={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},OI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function GY(t){var e=typeof t=="number"?Bt[t]:t;return e=e.replace(OI,"(\\d+)"),new RegExp("^"+e+"$")}function WY(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(OI)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var zY=function(){var t={};t.version="1.2.0";function e(){for(var w=0,S=new Array(256),m=0;m!=256;++m)w=m,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,w=w&1?-306674912^w>>>1:w>>>1,S[m]=w;return typeof Int32Array<"u"?new Int32Array(S):S}var r=e();function n(w){var S=0,m=0,T=0,_=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(T=0;T!=256;++T)_[T]=w[T];for(T=0;T!=256;++T)for(m=w[T],S=256+T;S<4096;S+=256)m=_[S]=m>>>8^w[m&255];var A=[];for(T=1;T!=16;++T)A[T-1]=typeof Int32Array<"u"?_.subarray(T*256,T*256+256):_.slice(T*256,T*256+256);return A}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],u=s[5],f=s[6],h=s[7],p=s[8],v=s[9],g=s[10],y=s[11],b=s[12],E=s[13],x=s[14];function I(w,S){for(var m=S^-1,T=0,_=w.length;T<_;)m=m>>>8^r[(m^w.charCodeAt(T++))&255];return~m}function D(w,S){for(var m=S^-1,T=w.length-15,_=0;_<T;)m=x[w[_++]^m&255]^E[w[_++]^m>>8&255]^b[w[_++]^m>>16&255]^y[w[_++]^m>>>24]^g[w[_++]]^v[w[_++]]^p[w[_++]]^h[w[_++]]^f[w[_++]]^u[w[_++]]^c[w[_++]]^l[w[_++]]^o[w[_++]]^a[w[_++]]^i[w[_++]]^r[w[_++]];for(T+=15;_<T;)m=m>>>8^r[(m^w[_++])&255];return~m}function P(w,S){for(var m=S^-1,T=0,_=w.length,A=0,k=0;T<_;)A=w.charCodeAt(T++),A<128?m=m>>>8^r[(m^A)&255]:A<2048?(m=m>>>8^r[(m^(192|A>>6&31))&255],m=m>>>8^r[(m^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,k=w.charCodeAt(T++)&1023,m=m>>>8^r[(m^(240|A>>8&7))&255],m=m>>>8^r[(m^(128|A>>2&63))&255],m=m>>>8^r[(m^(128|k>>6&15|(A&3)<<4))&255],m=m>>>8^r[(m^(128|k&63))&255]):(m=m>>>8^r[(m^(224|A>>12&15))&255],m=m>>>8^r[(m^(128|A>>6&63))&255],m=m>>>8^r[(m^(128|A&63))&255]);return~m}return t.table=r,t.bstr=I,t.buf=D,t.str=P,t}(),rr=function(){var e={};e.version="1.2.1";function r(re,ue){for(var oe=re.split("/"),ce=ue.split("/"),de=0,me=0,Pe=Math.min(oe.length,ce.length);de<Pe;++de){if(me=oe[de].length-ce[de].length)return me;if(oe[de]!=ce[de])return oe[de]<ce[de]?-1:1}return oe.length-ce.length}function n(re){if(re.charAt(re.length-1)=="/")return re.slice(0,-1).indexOf("/")===-1?re:n(re.slice(0,-1));var ue=re.lastIndexOf("/");return ue===-1?re:re.slice(0,ue+1)}function s(re){if(re.charAt(re.length-1)=="/")return s(re.slice(0,-1));var ue=re.lastIndexOf("/");return ue===-1?re:re.slice(ue+1)}function i(re,ue){typeof ue=="string"&&(ue=new Date(ue));var oe=ue.getHours();oe=oe<<6|ue.getMinutes(),oe=oe<<5|ue.getSeconds()>>>1,re.write_shift(2,oe);var ce=ue.getFullYear()-1980;ce=ce<<4|ue.getMonth()+1,ce=ce<<5|ue.getDate(),re.write_shift(2,ce)}function a(re){var ue=re.read_shift(2)&65535,oe=re.read_shift(2)&65535,ce=new Date,de=oe&31;oe>>>=5;var me=oe&15;oe>>>=4,ce.setMilliseconds(0),ce.setFullYear(oe+1980),ce.setMonth(me-1),ce.setDate(de);var Pe=ue&31;ue>>>=5;var $e=ue&63;return ue>>>=6,ce.setHours(ue),ce.setMinutes($e),ce.setSeconds(Pe<<1),ce}function o(re){An(re,0);for(var ue={},oe=0;re.l<=re.length-4;){var ce=re.read_shift(2),de=re.read_shift(2),me=re.l+de,Pe={};switch(ce){case 21589:oe=re.read_shift(1),oe&1&&(Pe.mtime=re.read_shift(4)),de>5&&(oe&2&&(Pe.atime=re.read_shift(4)),oe&4&&(Pe.ctime=re.read_shift(4))),Pe.mtime&&(Pe.mt=new Date(Pe.mtime*1e3));break}re.l=me,ue[ce]=Pe}return ue}var l;function c(){return l||(l={})}function u(re,ue){if(re[0]==80&&re[1]==75)return mt(re,ue);if((re[0]|32)==109&&(re[1]|32)==105)return bo(re,ue);if(re.length<512)throw new Error("CFB file size "+re.length+" < 512");var oe=3,ce=512,de=0,me=0,Pe=0,$e=0,Re=0,Ne=[],Me=re.slice(0,512);An(Me,0);var Ye=f(Me);switch(oe=Ye[0],oe){case 3:ce=512;break;case 4:ce=4096;break;case 0:if(Ye[1]==0)return mt(re,ue);default:throw new Error("Major Version: Expected 3 or 4 saw "+oe)}ce!==512&&(Me=re.slice(0,ce),An(Me,28));var et=re.slice(0,ce);h(Me,oe);var lt=Me.read_shift(4,"i");if(oe===3&&lt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+lt);Me.l+=4,Pe=Me.read_shift(4,"i"),Me.l+=4,Me.chk("00100000","Mini Stream Cutoff Size: "),$e=Me.read_shift(4,"i"),de=Me.read_shift(4,"i"),Re=Me.read_shift(4,"i"),me=Me.read_shift(4,"i");for(var Je=-1,st=0;st<109&&(Je=Me.read_shift(4,"i"),!(Je<0));++st)Ne[st]=Je;var It=p(re,ce);y(Re,me,It,ce,Ne);var vr=E(It,Pe,Ne,ce);vr[Pe].name="!Directory",de>0&&$e!==k&&(vr[$e].name="!MiniFAT"),vr[Ne[0]].name="!FAT",vr.fat_addrs=Ne,vr.ssz=ce;var pr={},Ir=[],Wa=[],Ao=[];x(Pe,vr,It,Ir,de,pr,Wa,$e),v(Wa,Ao,Ir),Ir.shift();var Ri={FileIndex:Wa,FullPaths:Ao};return ue&&ue.raw&&(Ri.raw={header:et,sectors:It}),Ri}function f(re){if(re[re.l]==80&&re[re.l+1]==75)return[0,0];re.chk(U,"Header Signature: "),re.l+=16;var ue=re.read_shift(2,"u");return[re.read_shift(2,"u"),ue]}function h(re,ue){var oe=9;switch(re.l+=2,oe=re.read_shift(2)){case 9:if(ue!=3)throw new Error("Sector Shift: Expected 9 saw "+oe);break;case 12:if(ue!=4)throw new Error("Sector Shift: Expected 12 saw "+oe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+oe)}re.chk("0600","Mini Sector Shift: "),re.chk("000000000000","Reserved: ")}function p(re,ue){for(var oe=Math.ceil(re.length/ue)-1,ce=[],de=1;de<oe;++de)ce[de-1]=re.slice(de*ue,(de+1)*ue);return ce[oe-1]=re.slice(oe*ue),ce}function v(re,ue,oe){for(var ce=0,de=0,me=0,Pe=0,$e=0,Re=oe.length,Ne=[],Me=[];ce<Re;++ce)Ne[ce]=Me[ce]=ce,ue[ce]=oe[ce];for(;$e<Me.length;++$e)ce=Me[$e],de=re[ce].L,me=re[ce].R,Pe=re[ce].C,Ne[ce]===ce&&(de!==-1&&Ne[de]!==de&&(Ne[ce]=Ne[de]),me!==-1&&Ne[me]!==me&&(Ne[ce]=Ne[me])),Pe!==-1&&(Ne[Pe]=ce),de!==-1&&ce!=Ne[ce]&&(Ne[de]=Ne[ce],Me.lastIndexOf(de)<$e&&Me.push(de)),me!==-1&&ce!=Ne[ce]&&(Ne[me]=Ne[ce],Me.lastIndexOf(me)<$e&&Me.push(me));for(ce=1;ce<Re;++ce)Ne[ce]===ce&&(me!==-1&&Ne[me]!==me?Ne[ce]=Ne[me]:de!==-1&&Ne[de]!==de&&(Ne[ce]=Ne[de]));for(ce=1;ce<Re;++ce)if(re[ce].type!==0){if($e=ce,$e!=Ne[$e])do $e=Ne[$e],ue[ce]=ue[$e]+"/"+ue[ce];while($e!==0&&Ne[$e]!==-1&&$e!=Ne[$e]);Ne[ce]=-1}for(ue[0]+="/",ce=1;ce<Re;++ce)re[ce].type!==2&&(ue[ce]+="/")}function g(re,ue,oe){for(var ce=re.start,de=re.size,me=[],Pe=ce;oe&&de>0&&Pe>=0;)me.push(ue.slice(Pe*A,Pe*A+A)),de-=A,Pe=No(oe,Pe*4);return me.length===0?an(0):Xi(me).slice(0,re.size)}function y(re,ue,oe,ce,de){var me=k;if(re===k){if(ue!==0)throw new Error("DIFAT chain shorter than expected")}else if(re!==-1){var Pe=oe[re],$e=(ce>>>2)-1;if(!Pe)return;for(var Re=0;Re<$e&&(me=No(Pe,Re*4))!==k;++Re)de.push(me);y(No(Pe,ce-4),ue-1,oe,ce,de)}}function b(re,ue,oe,ce,de){var me=[],Pe=[];de||(de=[]);var $e=ce-1,Re=0,Ne=0;for(Re=ue;Re>=0;){de[Re]=!0,me[me.length]=Re,Pe.push(re[Re]);var Me=oe[Math.floor(Re*4/ce)];if(Ne=Re*4&$e,ce<4+Ne)throw new Error("FAT boundary crossed: "+Re+" 4 "+ce);if(!re[Me])break;Re=No(re[Me],Ne)}return{nodes:me,data:qb([Pe])}}function E(re,ue,oe,ce){var de=re.length,me=[],Pe=[],$e=[],Re=[],Ne=ce-1,Me=0,Ye=0,et=0,lt=0;for(Me=0;Me<de;++Me)if($e=[],et=Me+ue,et>=de&&(et-=de),!Pe[et]){Re=[];var Je=[];for(Ye=et;Ye>=0;){Je[Ye]=!0,Pe[Ye]=!0,$e[$e.length]=Ye,Re.push(re[Ye]);var st=oe[Math.floor(Ye*4/ce)];if(lt=Ye*4&Ne,ce<4+lt)throw new Error("FAT boundary crossed: "+Ye+" 4 "+ce);if(!re[st]||(Ye=No(re[st],lt),Je[Ye]))break}me[et]={nodes:$e,data:qb([Re])}}return me}function x(re,ue,oe,ce,de,me,Pe,$e){for(var Re=0,Ne=ce.length?2:0,Me=ue[re].data,Ye=0,et=0,lt;Ye<Me.length;Ye+=128){var Je=Me.slice(Ye,Ye+128);An(Je,64),et=Je.read_shift(2),lt=cx(Je,0,et-Ne),ce.push(lt);var st={name:lt,type:Je.read_shift(1),color:Je.read_shift(1),L:Je.read_shift(4,"i"),R:Je.read_shift(4,"i"),C:Je.read_shift(4,"i"),clsid:Je.read_shift(16),state:Je.read_shift(4,"i"),start:0,size:0},It=Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2);It!==0&&(st.ct=I(Je,Je.l-8));var vr=Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2);vr!==0&&(st.mt=I(Je,Je.l-8)),st.start=Je.read_shift(4,"i"),st.size=Je.read_shift(4,"i"),st.size<0&&st.start<0&&(st.size=st.type=0,st.start=k,st.name=""),st.type===5?(Re=st.start,de>0&&Re!==k&&(ue[Re].name="!StreamData")):st.size>=4096?(st.storage="fat",ue[st.start]===void 0&&(ue[st.start]=b(oe,st.start,ue.fat_addrs,ue.ssz)),ue[st.start].name=st.name,st.content=ue[st.start].data.slice(0,st.size)):(st.storage="minifat",st.size<0?st.size=0:Re!==k&&st.start!==k&&ue[Re]&&(st.content=g(st,ue[Re].data,(ue[$e]||{}).data))),st.content&&An(st.content,0),me[lt]=st,Pe.push(st)}}function I(re,ue){return new Date((Ts(re,ue+4)/1e7*Math.pow(2,32)+Ts(re,ue)/1e7-11644473600)*1e3)}function D(re,ue){return c(),u(l.readFileSync(re),ue)}function P(re,ue){var oe=ue&&ue.type;switch(oe||Jt&&Buffer.isBuffer(re)&&(oe="buffer"),oe||"base64"){case"file":return D(re,ue);case"base64":return u(oa(Ps(re)),ue);case"binary":return u(oa(re),ue)}return u(re,ue)}function w(re,ue){var oe=ue||{},ce=oe.root||"Root Entry";if(re.FullPaths||(re.FullPaths=[]),re.FileIndex||(re.FileIndex=[]),re.FullPaths.length!==re.FileIndex.length)throw new Error("inconsistent CFB structure");re.FullPaths.length===0&&(re.FullPaths[0]=ce+"/",re.FileIndex[0]={name:ce,type:5}),oe.CLSID&&(re.FileIndex[0].clsid=oe.CLSID),S(re)}function S(re){var ue="Sh33tJ5";if(!rr.find(re,"/"+ue)){var oe=an(4);oe[0]=55,oe[1]=oe[3]=50,oe[2]=54,re.FileIndex.push({name:ue,type:2,content:oe,size:4,L:69,R:69,C:69}),re.FullPaths.push(re.FullPaths[0]+ue),m(re)}}function m(re,ue){w(re);for(var oe=!1,ce=!1,de=re.FullPaths.length-1;de>=0;--de){var me=re.FileIndex[de];switch(me.type){case 0:ce?oe=!0:(re.FileIndex.pop(),re.FullPaths.pop());break;case 1:case 2:case 5:ce=!0,isNaN(me.R*me.L*me.C)&&(oe=!0),me.R>-1&&me.L>-1&&me.R==me.L&&(oe=!0);break;default:oe=!0;break}}if(!(!oe&&!ue)){var Pe=new Date(1987,1,19),$e=0,Re=Object.create?Object.create(null):{},Ne=[];for(de=0;de<re.FullPaths.length;++de)Re[re.FullPaths[de]]=!0,re.FileIndex[de].type!==0&&Ne.push([re.FullPaths[de],re.FileIndex[de]]);for(de=0;de<Ne.length;++de){var Me=n(Ne[de][0]);ce=Re[Me],ce||(Ne.push([Me,{name:s(Me).replace("/",""),type:1,clsid:R,ct:Pe,mt:Pe,content:null}]),Re[Me]=!0)}for(Ne.sort(function(lt,Je){return r(lt[0],Je[0])}),re.FullPaths=[],re.FileIndex=[],de=0;de<Ne.length;++de)re.FullPaths[de]=Ne[de][0],re.FileIndex[de]=Ne[de][1];for(de=0;de<Ne.length;++de){var Ye=re.FileIndex[de],et=re.FullPaths[de];if(Ye.name=s(et).replace("/",""),Ye.L=Ye.R=Ye.C=-(Ye.color=1),Ye.size=Ye.content?Ye.content.length:0,Ye.start=0,Ye.clsid=Ye.clsid||R,de===0)Ye.C=Ne.length>1?1:-1,Ye.size=0,Ye.type=5;else if(et.slice(-1)=="/"){for($e=de+1;$e<Ne.length&&n(re.FullPaths[$e])!=et;++$e);for(Ye.C=$e>=Ne.length?-1:$e,$e=de+1;$e<Ne.length&&n(re.FullPaths[$e])!=n(et);++$e);Ye.R=$e>=Ne.length?-1:$e,Ye.type=1}else n(re.FullPaths[de+1]||"")==n(et)&&(Ye.R=de+1),Ye.type=2}}}function T(re,ue){var oe=ue||{};if(oe.fileType=="mad")return nn(re,oe);switch(m(re),oe.fileType){case"zip":return Mt(re,oe)}var ce=function(lt){for(var Je=0,st=0,It=0;It<lt.FileIndex.length;++It){var vr=lt.FileIndex[It];if(vr.content){var pr=vr.content.length;pr>0&&(pr<4096?Je+=pr+63>>6:st+=pr+511>>9)}}for(var Ir=lt.FullPaths.length+3>>2,Wa=Je+7>>3,Ao=Je+127>>7,Ri=Wa+st+Ir+Ao,ba=Ri+127>>7,Al=ba<=109?0:Math.ceil((ba-109)/127);Ri+ba+Al+127>>7>ba;)Al=++ba<=109?0:Math.ceil((ba-109)/127);var _s=[1,Al,ba,Ao,Ir,st,Je,0];return lt.FileIndex[0].size=Je<<6,_s[7]=(lt.FileIndex[0].start=_s[0]+_s[1]+_s[2]+_s[3]+_s[4]+_s[5])+(_s[6]+7>>3),_s}(re),de=an(ce[7]<<9),me=0,Pe=0;{for(me=0;me<8;++me)de.write_shift(1,L[me]);for(me=0;me<8;++me)de.write_shift(2,0);for(de.write_shift(2,62),de.write_shift(2,3),de.write_shift(2,65534),de.write_shift(2,9),de.write_shift(2,6),me=0;me<3;++me)de.write_shift(2,0);for(de.write_shift(4,0),de.write_shift(4,ce[2]),de.write_shift(4,ce[0]+ce[1]+ce[2]+ce[3]-1),de.write_shift(4,0),de.write_shift(4,4096),de.write_shift(4,ce[3]?ce[0]+ce[1]+ce[2]-1:k),de.write_shift(4,ce[3]),de.write_shift(-4,ce[1]?ce[0]-1:k),de.write_shift(4,ce[1]),me=0;me<109;++me)de.write_shift(-4,me<ce[2]?ce[1]+me:-1)}if(ce[1])for(Pe=0;Pe<ce[1];++Pe){for(;me<236+Pe*127;++me)de.write_shift(-4,me<ce[2]?ce[1]+me:-1);de.write_shift(-4,Pe===ce[1]-1?k:Pe+1)}var $e=function(lt){for(Pe+=lt;me<Pe-1;++me)de.write_shift(-4,me+1);lt&&(++me,de.write_shift(-4,k))};for(Pe=me=0,Pe+=ce[1];me<Pe;++me)de.write_shift(-4,F.DIFSECT);for(Pe+=ce[2];me<Pe;++me)de.write_shift(-4,F.FATSECT);$e(ce[3]),$e(ce[4]);for(var Re=0,Ne=0,Me=re.FileIndex[0];Re<re.FileIndex.length;++Re)Me=re.FileIndex[Re],Me.content&&(Ne=Me.content.length,!(Ne<4096)&&(Me.start=Pe,$e(Ne+511>>9)));for($e(ce[6]+7>>3);de.l&511;)de.write_shift(-4,F.ENDOFCHAIN);for(Pe=me=0,Re=0;Re<re.FileIndex.length;++Re)Me=re.FileIndex[Re],Me.content&&(Ne=Me.content.length,!(!Ne||Ne>=4096)&&(Me.start=Pe,$e(Ne+63>>6)));for(;de.l&511;)de.write_shift(-4,F.ENDOFCHAIN);for(me=0;me<ce[4]<<2;++me){var Ye=re.FullPaths[me];if(!Ye||Ye.length===0){for(Re=0;Re<17;++Re)de.write_shift(4,0);for(Re=0;Re<3;++Re)de.write_shift(4,-1);for(Re=0;Re<12;++Re)de.write_shift(4,0);continue}Me=re.FileIndex[me],me===0&&(Me.start=Me.size?Me.start-1:k);var et=me===0&&oe.root||Me.name;if(Ne=2*(et.length+1),de.write_shift(64,et,"utf16le"),de.write_shift(2,Ne),de.write_shift(1,Me.type),de.write_shift(1,Me.color),de.write_shift(-4,Me.L),de.write_shift(-4,Me.R),de.write_shift(-4,Me.C),Me.clsid)de.write_shift(16,Me.clsid,"hex");else for(Re=0;Re<4;++Re)de.write_shift(4,0);de.write_shift(4,Me.state||0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,0),de.write_shift(4,Me.start),de.write_shift(4,Me.size),de.write_shift(4,0)}for(me=1;me<re.FileIndex.length;++me)if(Me=re.FileIndex[me],Me.size>=4096)if(de.l=Me.start+1<<9,Jt&&Buffer.isBuffer(Me.content))Me.content.copy(de,de.l,0,Me.size),de.l+=Me.size+511&-512;else{for(Re=0;Re<Me.size;++Re)de.write_shift(1,Me.content[Re]);for(;Re&511;++Re)de.write_shift(1,0)}for(me=1;me<re.FileIndex.length;++me)if(Me=re.FileIndex[me],Me.size>0&&Me.size<4096)if(Jt&&Buffer.isBuffer(Me.content))Me.content.copy(de,de.l,0,Me.size),de.l+=Me.size+63&-64;else{for(Re=0;Re<Me.size;++Re)de.write_shift(1,Me.content[Re]);for(;Re&63;++Re)de.write_shift(1,0)}if(Jt)de.l=de.length;else for(;de.l<de.length;)de.write_shift(1,0);return de}function _(re,ue){var oe=re.FullPaths.map(function(Re){return Re.toUpperCase()}),ce=oe.map(function(Re){var Ne=Re.split("/");return Ne[Ne.length-(Re.slice(-1)=="/"?2:1)]}),de=!1;ue.charCodeAt(0)===47?(de=!0,ue=oe[0].slice(0,-1)+ue):de=ue.indexOf("/")!==-1;var me=ue.toUpperCase(),Pe=de===!0?oe.indexOf(me):ce.indexOf(me);if(Pe!==-1)return re.FileIndex[Pe];var $e=!me.match(_u);for(me=me.replace(ds,""),$e&&(me=me.replace(_u,"!")),Pe=0;Pe<oe.length;++Pe)if(($e?oe[Pe].replace(_u,"!"):oe[Pe]).replace(ds,"")==me||($e?ce[Pe].replace(_u,"!"):ce[Pe]).replace(ds,"")==me)return re.FileIndex[Pe];return null}var A=64,k=-2,U="d0cf11e0a1b11ae1",L=[208,207,17,224,161,177,26,225],R="00000000000000000000000000000000",F={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:k,FREESECT:-1,HEADER_SIGNATURE:U,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:R,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function N(re,ue,oe){c();var ce=T(re,oe);l.writeFileSync(ue,ce)}function M(re){for(var ue=new Array(re.length),oe=0;oe<re.length;++oe)ue[oe]=String.fromCharCode(re[oe]);return ue.join("")}function z(re,ue){var oe=T(re,ue);switch(ue&&ue.type||"buffer"){case"file":return c(),l.writeFileSync(ue.filename,oe),oe;case"binary":return typeof oe=="string"?oe:M(oe);case"base64":return Db(typeof oe=="string"?oe:M(oe));case"buffer":if(Jt)return Buffer.isBuffer(oe)?oe:gl(oe);case"array":return typeof oe=="string"?oa(oe):oe}return oe}var G;function H(re){try{var ue=re.InflateRaw,oe=new ue;if(oe._processChunk(new Uint8Array([3,0]),oe._finishFlushFlag),oe.bytesRead)G=re;else throw new Error("zlib does not expose bytesRead")}catch(ce){console.error("cannot use native zlib: "+(ce.message||ce))}}function j(re,ue){if(!G)return pt(re,ue);var oe=G.InflateRaw,ce=new oe,de=ce._processChunk(re.slice(re.l),ce._finishFlushFlag);return re.l+=ce.bytesRead,de}function K(re){return G?G.deflateRawSync(re):ye(re)}var ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],he=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(re){var ue=(re<<1|re<<11)&139536|(re<<5|re<<15)&558144;return(ue>>16|ue>>8|ue)&255}for(var te=typeof Uint8Array<"u",Z=te?new Uint8Array(256):[],xe=0;xe<256;++xe)Z[xe]=fe(xe);function Q(re,ue){var oe=Z[re&255];return ue<=8?oe>>>8-ue:(oe=oe<<8|Z[re>>8&255],ue<=16?oe>>>16-ue:(oe=oe<<8|Z[re>>16&255],oe>>>24-ue))}function q(re,ue){var oe=ue&7,ce=ue>>>3;return(re[ce]|(oe<=6?0:re[ce+1]<<8))>>>oe&3}function J(re,ue){var oe=ue&7,ce=ue>>>3;return(re[ce]|(oe<=5?0:re[ce+1]<<8))>>>oe&7}function pe(re,ue){var oe=ue&7,ce=ue>>>3;return(re[ce]|(oe<=4?0:re[ce+1]<<8))>>>oe&15}function ge(re,ue){var oe=ue&7,ce=ue>>>3;return(re[ce]|(oe<=3?0:re[ce+1]<<8))>>>oe&31}function ee(re,ue){var oe=ue&7,ce=ue>>>3;return(re[ce]|(oe<=1?0:re[ce+1]<<8))>>>oe&127}function ie(re,ue,oe){var ce=ue&7,de=ue>>>3,me=(1<<oe)-1,Pe=re[de]>>>ce;return oe<8-ce||(Pe|=re[de+1]<<8-ce,oe<16-ce)||(Pe|=re[de+2]<<16-ce,oe<24-ce)||(Pe|=re[de+3]<<24-ce),Pe&me}function ve(re,ue,oe){var ce=ue&7,de=ue>>>3;return ce<=5?re[de]|=(oe&7)<<ce:(re[de]|=oe<<ce&255,re[de+1]=(oe&7)>>8-ce),ue+3}function we(re,ue,oe){var ce=ue&7,de=ue>>>3;return oe=(oe&1)<<ce,re[de]|=oe,ue+1}function De(re,ue,oe){var ce=ue&7,de=ue>>>3;return oe<<=ce,re[de]|=oe&255,oe>>>=8,re[de+1]=oe,ue+8}function Te(re,ue,oe){var ce=ue&7,de=ue>>>3;return oe<<=ce,re[de]|=oe&255,oe>>>=8,re[de+1]=oe&255,re[de+2]=oe>>>8,ue+16}function ze(re,ue){var oe=re.length,ce=2*oe>ue?2*oe:ue+5,de=0;if(oe>=ue)return re;if(Jt){var me=Pb(ce);if(re.copy)re.copy(me);else for(;de<re.length;++de)me[de]=re[de];return me}else if(te){var Pe=new Uint8Array(ce);if(Pe.set)Pe.set(re);else for(;de<oe;++de)Pe[de]=re[de];return Pe}return re.length=ce,re}function ke(re){for(var ue=new Array(re),oe=0;oe<re;++oe)ue[oe]=0;return ue}function Ve(re,ue,oe){var ce=1,de=0,me=0,Pe=0,$e=0,Re=re.length,Ne=te?new Uint16Array(32):ke(32);for(me=0;me<32;++me)Ne[me]=0;for(me=Re;me<oe;++me)re[me]=0;Re=re.length;var Me=te?new Uint16Array(Re):ke(Re);for(me=0;me<Re;++me)Ne[de=re[me]]++,ce<de&&(ce=de),Me[me]=0;for(Ne[0]=0,me=1;me<=ce;++me)Ne[me+16]=$e=$e+Ne[me-1]<<1;for(me=0;me<Re;++me)$e=re[me],$e!=0&&(Me[me]=Ne[$e+16]++);var Ye=0;for(me=0;me<Re;++me)if(Ye=re[me],Ye!=0)for($e=Q(Me[me],ce)>>ce-Ye,Pe=(1<<ce+4-Ye)-1;Pe>=0;--Pe)ue[$e|Pe<<Ye]=Ye&15|me<<4;return ce}var Ae=te?new Uint16Array(512):ke(512),Ge=te?new Uint16Array(32):ke(32);if(!te){for(var Ke=0;Ke<512;++Ke)Ae[Ke]=0;for(Ke=0;Ke<32;++Ke)Ge[Ke]=0}(function(){for(var re=[],ue=0;ue<32;ue++)re.push(5);Ve(re,Ge,32);var oe=[];for(ue=0;ue<=143;ue++)oe.push(8);for(;ue<=255;ue++)oe.push(9);for(;ue<=279;ue++)oe.push(7);for(;ue<=287;ue++)oe.push(8);Ve(oe,Ae,288)})();var Ee=function(){for(var ue=te?new Uint8Array(32768):[],oe=0,ce=0;oe<le.length-1;++oe)for(;ce<le[oe+1];++ce)ue[ce]=oe;for(;ce<32768;++ce)ue[ce]=29;var de=te?new Uint8Array(259):[];for(oe=0,ce=0;oe<he.length-1;++oe)for(;ce<he[oe+1];++ce)de[ce]=oe;function me($e,Re){for(var Ne=0;Ne<$e.length;){var Me=Math.min(65535,$e.length-Ne),Ye=Ne+Me==$e.length;for(Re.write_shift(1,+Ye),Re.write_shift(2,Me),Re.write_shift(2,~Me&65535);Me-- >0;)Re[Re.l++]=$e[Ne++]}return Re.l}function Pe($e,Re){for(var Ne=0,Me=0,Ye=te?new Uint16Array(32768):[];Me<$e.length;){var et=Math.min(65535,$e.length-Me);if(et<10){for(Ne=ve(Re,Ne,+(Me+et==$e.length)),Ne&7&&(Ne+=8-(Ne&7)),Re.l=Ne/8|0,Re.write_shift(2,et),Re.write_shift(2,~et&65535);et-- >0;)Re[Re.l++]=$e[Me++];Ne=Re.l*8;continue}Ne=ve(Re,Ne,+(Me+et==$e.length)+2);for(var lt=0;et-- >0;){var Je=$e[Me];lt=(lt<<5^Je)&32767;var st=-1,It=0;if((st=Ye[lt])&&(st|=Me&-32768,st>Me&&(st-=32768),st<Me))for(;$e[st+It]==$e[Me+It]&&It<250;)++It;if(It>2){Je=de[It],Je<=22?Ne=De(Re,Ne,Z[Je+1]>>1)-1:(De(Re,Ne,3),Ne+=5,De(Re,Ne,Z[Je-23]>>5),Ne+=3);var vr=Je<8?0:Je-4>>2;vr>0&&(Te(Re,Ne,It-he[Je]),Ne+=vr),Je=ue[Me-st],Ne=De(Re,Ne,Z[Je]>>3),Ne-=3;var pr=Je<4?0:Je-2>>1;pr>0&&(Te(Re,Ne,Me-st-le[Je]),Ne+=pr);for(var Ir=0;Ir<It;++Ir)Ye[lt]=Me&32767,lt=(lt<<5^$e[Me])&32767,++Me;et-=It-1}else Je<=143?Je=Je+48:Ne=we(Re,Ne,1),Ne=De(Re,Ne,Z[Je]),Ye[lt]=Me&32767,++Me}Ne=De(Re,Ne,0)-1}return Re.l=(Ne+7)/8|0,Re.l}return function(Re,Ne){return Re.length<8?me(Re,Ne):Pe(Re,Ne)}}();function ye(re){var ue=an(50+Math.floor(re.length*1.1)),oe=Ee(re,ue);return ue.slice(0,oe)}var Se=te?new Uint16Array(32768):ke(32768),Oe=te?new Uint16Array(32768):ke(32768),We=te?new Uint16Array(128):ke(128),ot=1,gt=1;function Et(re,ue){var oe=ge(re,ue)+257;ue+=5;var ce=ge(re,ue)+1;ue+=5;var de=pe(re,ue)+4;ue+=4;for(var me=0,Pe=te?new Uint8Array(19):ke(19),$e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Re=1,Ne=te?new Uint8Array(8):ke(8),Me=te?new Uint8Array(8):ke(8),Ye=Pe.length,et=0;et<de;++et)Pe[ne[et]]=me=J(re,ue),Re<me&&(Re=me),Ne[me]++,ue+=3;var lt=0;for(Ne[0]=0,et=1;et<=Re;++et)Me[et]=lt=lt+Ne[et-1]<<1;for(et=0;et<Ye;++et)(lt=Pe[et])!=0&&($e[et]=Me[lt]++);var Je=0;for(et=0;et<Ye;++et)if(Je=Pe[et],Je!=0){lt=Z[$e[et]]>>8-Je;for(var st=(1<<7-Je)-1;st>=0;--st)We[lt|st<<Je]=Je&7|et<<3}var It=[];for(Re=1;It.length<oe+ce;)switch(lt=We[ee(re,ue)],ue+=lt&7,lt>>>=3){case 16:for(me=3+q(re,ue),ue+=2,lt=It[It.length-1];me-- >0;)It.push(lt);break;case 17:for(me=3+J(re,ue),ue+=3;me-- >0;)It.push(0);break;case 18:for(me=11+ee(re,ue),ue+=7;me-- >0;)It.push(0);break;default:It.push(lt),Re<lt&&(Re=lt);break}var vr=It.slice(0,oe),pr=It.slice(oe);for(et=oe;et<286;++et)vr[et]=0;for(et=ce;et<30;++et)pr[et]=0;return ot=Ve(vr,Se,286),gt=Ve(pr,Oe,30),ue}function Ut(re,ue){if(re[0]==3&&!(re[1]&3))return[mo(ue),2];for(var oe=0,ce=0,de=Pb(ue||1<<18),me=0,Pe=de.length>>>0,$e=0,Re=0;!(ce&1);){if(ce=J(re,oe),oe+=3,ce>>>1)ce>>1==1?($e=9,Re=5):(oe=Et(re,oe),$e=ot,Re=gt);else{oe&7&&(oe+=8-(oe&7));var Ne=re[oe>>>3]|re[(oe>>>3)+1]<<8;if(oe+=32,Ne>0)for(!ue&&Pe<me+Ne&&(de=ze(de,me+Ne),Pe=de.length);Ne-- >0;)de[me++]=re[oe>>>3],oe+=8;continue}for(;;){!ue&&Pe<me+32767&&(de=ze(de,me+32767),Pe=de.length);var Me=ie(re,oe,$e),Ye=ce>>>1==1?Ae[Me]:Se[Me];if(oe+=Ye&15,Ye>>>=4,!(Ye>>>8&255))de[me++]=Ye;else{if(Ye==256)break;Ye-=257;var et=Ye<8?0:Ye-4>>2;et>5&&(et=0);var lt=me+he[Ye];et>0&&(lt+=ie(re,oe,et),oe+=et),Me=ie(re,oe,Re),Ye=ce>>>1==1?Ge[Me]:Oe[Me],oe+=Ye&15,Ye>>>=4;var Je=Ye<4?0:Ye-2>>1,st=le[Ye];for(Je>0&&(st+=ie(re,oe,Je),oe+=Je),!ue&&Pe<lt&&(de=ze(de,lt+100),Pe=de.length);me<lt;)de[me]=de[me-st],++me}}}return ue?[de,oe+7>>>3]:[de.slice(0,me),oe+7>>>3]}function pt(re,ue){var oe=re.slice(re.l||0),ce=Ut(oe,ue);return re.l+=ce[1],ce[0]}function ct(re,ue){if(re)typeof console<"u"&&console.error(ue);else throw new Error(ue)}function mt(re,ue){var oe=re;An(oe,0);var ce=[],de=[],me={FileIndex:ce,FullPaths:de};w(me,{root:ue.root});for(var Pe=oe.length-4;(oe[Pe]!=80||oe[Pe+1]!=75||oe[Pe+2]!=5||oe[Pe+3]!=6)&&Pe>=0;)--Pe;oe.l=Pe+4,oe.l+=4;var $e=oe.read_shift(2);oe.l+=6;var Re=oe.read_shift(4);for(oe.l=Re,Pe=0;Pe<$e;++Pe){oe.l+=20;var Ne=oe.read_shift(4),Me=oe.read_shift(4),Ye=oe.read_shift(2),et=oe.read_shift(2),lt=oe.read_shift(2);oe.l+=8;var Je=oe.read_shift(4),st=o(oe.slice(oe.l+Ye,oe.l+Ye+et));oe.l+=Ye+et+lt;var It=oe.l;oe.l=Je+4,Pt(oe,Ne,Me,me,st),oe.l=It}return me}function Pt(re,ue,oe,ce,de){re.l+=2;var me=re.read_shift(2),Pe=re.read_shift(2),$e=a(re);if(me&8257)throw new Error("Unsupported ZIP encryption");for(var Re=re.read_shift(4),Ne=re.read_shift(4),Me=re.read_shift(4),Ye=re.read_shift(2),et=re.read_shift(2),lt="",Je=0;Je<Ye;++Je)lt+=String.fromCharCode(re[re.l++]);if(et){var st=o(re.slice(re.l,re.l+et));(st[21589]||{}).mt&&($e=st[21589].mt),((de||{})[21589]||{}).mt&&($e=de[21589].mt)}re.l+=et;var It=re.slice(re.l,re.l+Ne);switch(Pe){case 8:It=j(re,Me);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Pe)}var vr=!1;me&8&&(Re=re.read_shift(4),Re==134695760&&(Re=re.read_shift(4),vr=!0),Ne=re.read_shift(4),Me=re.read_shift(4)),Ne!=ue&&ct(vr,"Bad compressed size: "+ue+" != "+Ne),Me!=oe&&ct(vr,"Bad uncompressed size: "+oe+" != "+Me),Rr(ce,lt,It,{unsafe:!0,mt:$e})}function Mt(re,ue){var oe=ue||{},ce=[],de=[],me=an(1),Pe=oe.compression?8:0,$e=0,Re=0,Ne=0,Me=0,Ye=0,et=re.FullPaths[0],lt=et,Je=re.FileIndex[0],st=[],It=0;for(Re=1;Re<re.FullPaths.length;++Re)if(lt=re.FullPaths[Re].slice(et.length),Je=re.FileIndex[Re],!(!Je.size||!Je.content||lt=="Sh33tJ5")){var vr=Me,pr=an(lt.length);for(Ne=0;Ne<lt.length;++Ne)pr.write_shift(1,lt.charCodeAt(Ne)&127);pr=pr.slice(0,pr.l),st[Ye]=zY.buf(Je.content,0);var Ir=Je.content;Pe==8&&(Ir=K(Ir)),me=an(30),me.write_shift(4,67324752),me.write_shift(2,20),me.write_shift(2,$e),me.write_shift(2,Pe),Je.mt?i(me,Je.mt):me.write_shift(4,0),me.write_shift(-4,st[Ye]),me.write_shift(4,Ir.length),me.write_shift(4,Je.content.length),me.write_shift(2,pr.length),me.write_shift(2,0),Me+=me.length,ce.push(me),Me+=pr.length,ce.push(pr),Me+=Ir.length,ce.push(Ir),me=an(46),me.write_shift(4,33639248),me.write_shift(2,0),me.write_shift(2,20),me.write_shift(2,$e),me.write_shift(2,Pe),me.write_shift(4,0),me.write_shift(-4,st[Ye]),me.write_shift(4,Ir.length),me.write_shift(4,Je.content.length),me.write_shift(2,pr.length),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(4,0),me.write_shift(4,vr),It+=me.l,de.push(me),It+=pr.length,de.push(pr),++Ye}return me=an(22),me.write_shift(4,101010256),me.write_shift(2,0),me.write_shift(2,0),me.write_shift(2,Ye),me.write_shift(2,Ye),me.write_shift(4,It),me.write_shift(4,Me),me.write_shift(2,0),Xi([Xi(ce),Xi(de),me])}var Tr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ts(re,ue){if(re.ctype)return re.ctype;var oe=re.name||"",ce=oe.match(/\.([^\.]+)$/);return ce&&Tr[ce[1]]||ue&&(ce=(oe=ue).match(/[\.\\]([^\.\\])+$/),ce&&Tr[ce[1]])?Tr[ce[1]]:"application/octet-stream"}function Pi(re){for(var ue=Db(re),oe=[],ce=0;ce<ue.length;ce+=76)oe.push(ue.slice(ce,ce+76));return oe.join(`\r
`)+`\r
`}function hs(re){var ue=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ne){var Me=Ne.charCodeAt(0).toString(16).toUpperCase();return"="+(Me.length==1?"0"+Me:Me)});ue=ue.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ue.charAt(0)==`
`&&(ue="=0D"+ue.slice(1)),ue=ue.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var oe=[],ce=ue.split(`\r
`),de=0;de<ce.length;++de){var me=ce[de];if(me.length==0){oe.push("");continue}for(var Pe=0;Pe<me.length;){var $e=76,Re=me.slice(Pe,Pe+$e);Re.charAt($e-1)=="="?$e--:Re.charAt($e-2)=="="?$e-=2:Re.charAt($e-3)=="="&&($e-=3),Re=me.slice(Pe,Pe+$e),Pe+=$e,Pe<me.length&&(Re+="="),oe.push(Re)}}return oe.join(`\r
`)}function bl(re){for(var ue=[],oe=0;oe<re.length;++oe){for(var ce=re[oe];oe<=re.length&&ce.charAt(ce.length-1)=="=";)ce=ce.slice(0,ce.length-1)+re[++oe];ue.push(ce)}for(var de=0;de<ue.length;++de)ue[de]=ue[de].replace(/[=][0-9A-Fa-f]{2}/g,function(me){return String.fromCharCode(parseInt(me.slice(1),16))});return oa(ue.join(`\r
`))}function Ga(re,ue,oe){for(var ce="",de="",me="",Pe,$e=0;$e<10;++$e){var Re=ue[$e];if(!Re||Re.match(/^\s*$/))break;var Ne=Re.match(/^(.*?):\s*([^\s].*)$/);if(Ne)switch(Ne[1].toLowerCase()){case"content-location":ce=Ne[2].trim();break;case"content-type":me=Ne[2].trim();break;case"content-transfer-encoding":de=Ne[2].trim();break}}switch(++$e,de.toLowerCase()){case"base64":Pe=oa(Ps(ue.slice($e).join("")));break;case"quoted-printable":Pe=bl(ue.slice($e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+de)}var Me=Rr(re,ce.slice(oe.length),Pe,{unsafe:!0});me&&(Me.ctype=me)}function bo(re,ue){if(M(re.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var oe=ue&&ue.root||"",ce=(Jt&&Buffer.isBuffer(re)?re.toString("binary"):M(re)).split(`\r
`),de=0,me="";for(de=0;de<ce.length;++de)if(me=ce[de],!!/^Content-Location:/i.test(me)&&(me=me.slice(me.indexOf("file")),oe||(oe=me.slice(0,me.lastIndexOf("/")+1)),me.slice(0,oe.length)!=oe))for(;oe.length>0&&(oe=oe.slice(0,oe.length-1),oe=oe.slice(0,oe.lastIndexOf("/")+1),me.slice(0,oe.length)!=oe););var Pe=(ce[1]||"").match(/boundary="(.*?)"/);if(!Pe)throw new Error("MAD cannot find boundary");var $e="--"+(Pe[1]||""),Re=[],Ne=[],Me={FileIndex:Re,FullPaths:Ne};w(Me);var Ye,et=0;for(de=0;de<ce.length;++de){var lt=ce[de];lt!==$e&&lt!==$e+"--"||(et++&&Ga(Me,ce.slice(Ye,de),oe),Ye=de)}return Me}function nn(re,ue){var oe=ue||{},ce=oe.boundary||"SheetJS";ce="------="+ce;for(var de=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ce.slice(2)+'"',"","",""],me=re.FullPaths[0],Pe=me,$e=re.FileIndex[0],Re=1;Re<re.FullPaths.length;++Re)if(Pe=re.FullPaths[Re].slice(me.length),$e=re.FileIndex[Re],!(!$e.size||!$e.content||Pe=="Sh33tJ5")){Pe=Pe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(It){return"_x"+It.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(It){return"_u"+It.charCodeAt(0).toString(16)+"_"});for(var Ne=$e.content,Me=Jt&&Buffer.isBuffer(Ne)?Ne.toString("binary"):M(Ne),Ye=0,et=Math.min(1024,Me.length),lt=0,Je=0;Je<=et;++Je)(lt=Me.charCodeAt(Je))>=32&&lt<128&&++Ye;var st=Ye>=et*4/5;de.push(ce),de.push("Content-Location: "+(oe.root||"file:///C:/SheetJS/")+Pe),de.push("Content-Transfer-Encoding: "+(st?"quoted-printable":"base64")),de.push("Content-Type: "+ts($e,Pe)),de.push(""),de.push(st?hs(Me):Pi(Me))}return de.push(ce+`--\r
`),de.join(`\r
`)}function So(re){var ue={};return w(ue,re),ue}function Rr(re,ue,oe,ce){var de=ce&&ce.unsafe;de||w(re);var me=!de&&rr.find(re,ue);if(!me){var Pe=re.FullPaths[0];ue.slice(0,Pe.length)==Pe?Pe=ue:(Pe.slice(-1)!="/"&&(Pe+="/"),Pe=(Pe+ue).replace("//","/")),me={name:s(ue),type:2},re.FileIndex.push(me),re.FullPaths.push(Pe),de||rr.utils.cfb_gc(re)}return me.content=oe,me.size=oe?oe.length:0,ce&&(ce.CLSID&&(me.clsid=ce.CLSID),ce.mt&&(me.mt=ce.mt),ce.ct&&(me.ct=ce.ct)),me}function Fn(re,ue){w(re);var oe=rr.find(re,ue);if(oe){for(var ce=0;ce<re.FileIndex.length;++ce)if(re.FileIndex[ce]==oe)return re.FileIndex.splice(ce,1),re.FullPaths.splice(ce,1),!0}return!1}function Sl(re,ue,oe){w(re);var ce=rr.find(re,ue);if(ce){for(var de=0;de<re.FileIndex.length;++de)if(re.FileIndex[de]==ce)return re.FileIndex[de].name=s(oe),re.FullPaths[de]=oe,!0}return!1}function zc(re){m(re,!0)}return e.find=_,e.read=P,e.parse=u,e.write=z,e.writeFile=N,e.utils={cfb_new:So,cfb_add:Rr,cfb_del:Fn,cfb_mov:Sl,cfb_gc:zc,ReadShift:Wu,CheckField:nk,prep_blob:An,bconcat:Xi,use_zlib:H,_deflateRaw:ye,_inflateRaw:pt,consts:F},e}();function KY(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ua(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function ax(t){for(var e=[],r=Ua(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Sh=new Date(1899,11,30,0,0,0);function fs(t,e){var r=t.getTime(),n=Sh.getTime()+(t.getTimezoneOffset()-Sh.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var MI=new Date,qY=Sh.getTime()+(MI.getTimezoneOffset()-Sh.getTimezoneOffset())*6e4,Ub=MI.getTimezoneOffset();function Bp(t){var e=new Date;return e.setTime(t*24*60*60*1e3+qY),e.getTimezoneOffset()!==Ub&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Ub)*6e4),e}function XY(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var $b=new Date("2017-02-19T19:06:09.000Z"),LI=isNaN($b.getFullYear())?new Date("2/19/17"):$b,YY=LI.getFullYear()==2017;function vn(t,e){var r=new Date(t);if(YY)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(LI.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function al(t,e){if(Jt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Su(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Su(SI(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Su(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Su(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function Pn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Pn(t[r]));return e}function Vr(t,e){for(var r="";r.length<e;)r+=t;return r}function ha(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var QY=["january","february","march","april","may","june","july","august","september","october","november","december"];function kc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&QY.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var JY=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function BI(t){return t?t.content&&t.type?al(t.content,!0):t.data?Eu(t.data):t.asNodeBuffer&&Jt?Eu(t.asNodeBuffer().toString("binary")):t.asBinary?Eu(t.asBinary()):t._data&&t._data.getContent?Eu(al(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function UI(t){if(!t)return null;if(t.data)return Ib(t.data);if(t.asNodeBuffer&&Jt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Ib(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function ZY(t){return t&&t.name.slice(-4)===".bin"?UI(t):BI(t)}function Us(t,e){for(var r=t.FullPaths||Ua(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function ix(t,e){var r=Us(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Jr(t,e,r){if(!r)return ZY(ix(t,e));if(!e)return null;try{return Jr(t,e)}catch{return null}}function ws(t,e,r){if(!r)return BI(ix(t,e));if(!e)return null;try{return ws(t,e)}catch{return null}}function eQ(t,e,r){return UI(ix(t,e))}function Vb(t){for(var e=t.FullPaths||Ua(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function tQ(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Jt?n=gl(r):n=EY(r),rr.utils.cfb_add(t,e,n)}rr.utils.cfb_add(t,e,r)}else t.file(e,r)}function $I(t,e){switch(e.type){case"base64":return rr.read(t,{type:"base64"});case"binary":return rr.read(t,{type:"binary"});case"buffer":case"array":return rr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function bu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var VI=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,rQ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Hb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,nQ=/<[^>]*>/g,es=VI.match(Hb)?Hb:nQ,sQ=/<\w*:/,aQ=/<(\/?)\w+:/;function Ct(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(rQ),o=0,l="",c=0,u="",f="",h=1;if(a)for(c=0;c!=a.length;++c){for(f=a[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(s=f.charCodeAt(i+1))==34||s==39?1:0,l=f.slice(i+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ha(t){return t.replace(aQ,"<$1")}var HI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},iQ=ax(HI),ar=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return HI[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),oQ=/[&<>'"]/g,lQ=/[\u0000-\u001f]/g;function ox(t){var e=t+"";return e.replace(oQ,function(r){return iQ[r]}).replace(/\n/g,"<br/>").replace(lQ,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var jb=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Dr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function pg(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Gb(t){var e=mo(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function Wb(t){return gl(t,"binary").toString("utf8")}var qf="foo bar baz",Sr=Jt&&(Wb(qf)==pg(qf)&&Wb||Gb(qf)==pg(qf)&&Gb)||pg,Su=Jt?function(t){return gl(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Cd=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),jI=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),cQ=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),uQ=/<\/?(?:vt:)?variant>/g,dQ=/<(?:vt:)([^>]*)>([\s\S]*)</;function zb(t,e){var r=Ct(t),n=t.match(cQ(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(uQ,"").match(dQ);a&&s.push({v:Sr(a[2]),t:a[1]})}),s}var fQ=/(^\s|\s$|\n)/;function hQ(t){return Ua(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function pQ(t,e,r){return"<"+t+(r!=null?hQ(r):"")+(e!=null?(e.match(fQ)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function lx(t){if(Jt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Sr(vl(rx(t)));throw new Error("Bad input format: expected Buffer or string")}var Id=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,mQ={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},gQ=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function vQ(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function yQ(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var Kb=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},qb=Jt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:gl(e)})):Kb(t)}:Kb,Xb=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(ci(t,s)));return n.join("").replace(ds,"")},cx=Jt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ds,""):Xb(t,e,r)}:Xb,Yb=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},GI=Jt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Yb(t,e,r)}:Yb,Qb=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Gl(t,s)));return n.join("")},af=Jt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Qb(e,r,n)}:Qb,WI=function(t,e){var r=Ts(t,e);return r>0?af(t,e+4,e+4+r-1):""},zI=WI,KI=function(t,e){var r=Ts(t,e);return r>0?af(t,e+4,e+4+r-1):""},qI=KI,XI=function(t,e){var r=2*Ts(t,e);return r>0?af(t,e+4,e+4+r-1):""},YI=XI,QI=function(e,r){var n=Ts(e,r);return n>0?cx(e,r+4,r+4+n):""},JI=QI,ZI=function(t,e){var r=Ts(t,e);return r>0?af(t,e+4,e+4+r):""},ek=ZI,tk=function(t,e){return vQ(t,e)},Ah=tk,rk=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Jt&&(zI=function(e,r){if(!Buffer.isBuffer(e))return WI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},qI=function(e,r){if(!Buffer.isBuffer(e))return KI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},YI=function(e,r){if(!Buffer.isBuffer(e))return XI(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},JI=function(e,r){if(!Buffer.isBuffer(e))return QI(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},ek=function(e,r){if(!Buffer.isBuffer(e))return ZI(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Ah=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):tk(e,r)},rk=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Gl=function(t,e){return t[e]},ci=function(t,e){return t[e+1]*256+t[e]},xQ=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Ts=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},No=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},EQ=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Wu(t,e){var r="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,Jt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(ci(this,c)),c+=2;t*=2;break;case"utf8":r=af(this,this.l,this.l+t);break;case"utf16le":t*=2,r=cx(this,this.l,this.l+t);break;case"wstr":return Wu.call(this,t,"dbcs");case"lpstr-ansi":r=zI(this,this.l),t=4+Ts(this,this.l);break;case"lpstr-cp":r=qI(this,this.l),t=4+Ts(this,this.l);break;case"lpwstr":r=YI(this,this.l),t=4+2*Ts(this,this.l);break;case"lpp4":t=4+Ts(this,this.l),r=JI(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Ts(this,this.l),r=ek(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Gl(this,this.l+t++))!==0;)i.push(Kf(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=ci(this,this.l+t))!==0;)i.push(Kf(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Gl(this,c),this.l=c+1,o=Wu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Kf(ci(this,c))),c+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Gl(this,c),this.l=c+1,o=Wu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Kf(Gl(this,c))),c+=1}r=i.join("");break;default:switch(t){case 1:return n=Gl(this,this.l),this.l++,n;case 2:return n=(e==="i"?xQ:ci)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?No:EQ)(this,this.l),this.l+=4,n):(s=Ts(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=Ah(this,this.l):s=Ah([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=GI(this,this.l,t);break}}return this.l+=t,r}var _Q=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},bQ=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},SQ=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function AQ(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)SQ(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,_Q(this,e,this.l);break;case 8:if(n=8,r==="f"){yQ(this,e,this.l);break}case 16:break;case-4:n=4,bQ(this,e,this.l);break}return this.l+=n,this}function nk(t,e){var r=GI(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function An(t,e){t.l=e,t.read_shift=Wu,t.chk=nk,t.write_shift=AQ}function Zn(t,e){t.l+=e}function an(t){var e=mo(t);return An(e,0),e}function ki(t,e,r){if(t){var n,s,i;An(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Dh[o]||Dh[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var u=c.f&&c.f(t,i,r);if(t.l=l,e(u,c,o))return}}}function jv(){var t=[],e=Jt?256:2048,r=function(c){var u=an(c);return An(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},a=function(){return s(),Xi(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function zu(t,e,r){var n=Pn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Jb(t,e,r){var n=Pn(t);return n.s=zu(n.s,e.s,r),n.e=zu(n.e,e.s,r),n}function Ku(t,e){if(t.cRel&&t.c<0)for(t=Pn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Pn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Nt(t);return!t.cRel&&t.cRel!=null&&(r=CQ(r)),!t.rRel&&t.rRel!=null&&(r=TQ(r)),r}function mg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+cn(t.s.c)+":"+(t.e.cRel?"":"$")+cn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Rn(t.s.r)+":"+(t.e.rRel?"":"$")+Rn(t.e.r):Ku(t.s,e.biff)+":"+Ku(t.e,e.biff)}function ux(t){return parseInt(wQ(t),10)-1}function Rn(t){return""+(t+1)}function TQ(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function wQ(t){return t.replace(/\$(\d+)$/,"$1")}function dx(t){for(var e=IQ(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function cn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function CQ(t){return t.replace(/^([A-Z])/,"$$$1")}function IQ(t){return t.replace(/^\$([A-Z])/,"$1")}function kQ(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function cs(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Nt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Gc(t){var e=t.indexOf(":");return e==-1?{s:cs(t),e:cs(t)}:{s:cs(t.slice(0,e)),e:cs(t.slice(e+1))}}function sr(t,e){return typeof e>"u"||typeof e=="number"?sr(t.s,t.e):(typeof t!="string"&&(t=Nt(t)),typeof e!="string"&&(e=Nt(e)),t==e?t:t+":"+e)}function jr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function Zb(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ws(t.z,r?fs(e):e)}catch{}try{return t.w=Ws((t.XF||{}).numFmtId||(r?14:0),r?fs(e):e)}catch{return""+e}}function Ti(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?El[t.v]||t.v:e==null?Zb(t,t.v):Zb(t,e))}function _o(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function sk(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?cs(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=jr(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[f].length;++h)if(!(typeof e[f][h]>"u")){var p={v:e[f][h]},v=a+f,g=o+h;if(c.s.r>v&&(c.s.r=v),c.s.c>g&&(c.s.c=g),c.e.r<v&&(c.e.r=v),c.e.c<g&&(c.e.c=g),e[f][h]&&typeof e[f][h]=="object"&&!Array.isArray(e[f][h])&&!(e[f][h]instanceof Date))p=e[f][h];else if(Array.isArray(p.v)&&(p.f=e[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Bt[14],n.cellDates?(p.t="d",p.w=Ws(p.z,fs(p.v))):(p.t="n",p.v=fs(p.v),p.w=Ws(p.z,p.v))):p.t="s";if(s)i[v]||(i[v]=[]),i[v][g]&&i[v][g].z&&(p.z=i[v][g].z),i[v][g]=p;else{var y=Nt({c:g,r:v});i[y]&&i[y].z&&(p.z=i[y].z),i[y]=p}}}return c.s.c<1e7&&(i["!ref"]=sr(c)),i}function Wc(t,e){return sk(null,t,e)}function DQ(t){return t.read_shift(4,"i")}function Qn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function PQ(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function fx(t,e){var r=t.l,n=t.read_shift(1),s=Qn(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(PQ(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var RQ=fx;function Xs(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function yl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var FQ=Qn;function hx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var NQ=Qn,Gv=hx;function px(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?Ah([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):No(e,0)>>2;return r?s/100:s}function ak(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var xl=ak;function Wn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function OQ(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=zo[s];c&&(e.rgb=Dd(c));break;case 2:e.rgb=Dd([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function MQ(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function ik(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function LQ(t){return ik(t,1)}function BQ(t){return ik(t,2)}var mx=2,vs=3,Xf=11,eS=12,Th=19,Yf=64,UQ=65,$Q=71,VQ=4108,HQ=4126,pn=80,ok=81,jQ=[pn,ok],GQ={1:{n:"CodePage",t:mx},2:{n:"Category",t:pn},3:{n:"PresentationFormat",t:pn},4:{n:"ByteCount",t:vs},5:{n:"LineCount",t:vs},6:{n:"ParagraphCount",t:vs},7:{n:"SlideCount",t:vs},8:{n:"NoteCount",t:vs},9:{n:"HiddenCount",t:vs},10:{n:"MultimediaClipCount",t:vs},11:{n:"ScaleCrop",t:Xf},12:{n:"HeadingPairs",t:VQ},13:{n:"TitlesOfParts",t:HQ},14:{n:"Manager",t:pn},15:{n:"Company",t:pn},16:{n:"LinksUpToDate",t:Xf},17:{n:"CharacterCount",t:vs},19:{n:"SharedDoc",t:Xf},22:{n:"HyperlinksChanged",t:Xf},23:{n:"AppVersion",t:vs,p:"version"},24:{n:"DigSig",t:UQ},26:{n:"ContentType",t:pn},27:{n:"ContentStatus",t:pn},28:{n:"Language",t:pn},29:{n:"Version",t:pn},255:{},2147483648:{n:"Locale",t:Th},2147483651:{n:"Behavior",t:Th},1919054434:{}},WQ={1:{n:"CodePage",t:mx},2:{n:"Title",t:pn},3:{n:"Subject",t:pn},4:{n:"Author",t:pn},5:{n:"Keywords",t:pn},6:{n:"Comments",t:pn},7:{n:"Template",t:pn},8:{n:"LastAuthor",t:pn},9:{n:"RevNumber",t:pn},10:{n:"EditTime",t:Yf},11:{n:"LastPrinted",t:Yf},12:{n:"CreatedDate",t:Yf},13:{n:"ModifiedDate",t:Yf},14:{n:"PageCount",t:vs},15:{n:"WordCount",t:vs},16:{n:"CharCount",t:vs},17:{n:"Thumbnail",t:$Q},18:{n:"Application",t:pn},19:{n:"DocSecurity",t:vs},255:{},2147483648:{n:"Locale",t:Th},2147483651:{n:"Behavior",t:Th},1919054434:{}},tS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zQ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function KQ(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var qQ=KQ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zo=Pn(qQ),El={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},rS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function XQ(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function YQ(t){var e=XQ();if(!t||!t.match)return e;var r={};if((t.match(es)||[]).forEach(function(n){var s=Ct(n);switch(s[0].replace(sQ,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[rS[s.ContentType]]!==void 0&&e[rS[s.ContentType]].push(s.PartName);break}}),e.xmlns!==mQ.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var ql={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Wv(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function qu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(es)||[]).forEach(function(s){var i=Ct(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:bu(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var QQ="application/vnd.oasis.opendocument.spreadsheet";function JQ(t,e){for(var r=lx(t),n,s;n=Id.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ct(n[0],!1),s.path=="/"&&s.type!==QQ)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Xu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],ZQ=function(){for(var t=new Array(Xu.length),e=0;e<Xu.length;++e){var r=Xu[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function ck(t){var e={};t=Sr(t);for(var r=0;r<Xu.length;++r){var n=Xu[r],s=t.match(ZQ[r]);s!=null&&s.length>0&&(e[n[1]]=ar(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=vn(e[n[1]]))}return e}var eJ=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function uk(t,e,r,n){var s=[];if(typeof t=="string")s=zb(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(u){return{v:u}}));var a=typeof e=="string"?zb(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function tJ(t,e,r){var n={};return e||(e={}),t=Sr(t),eJ.forEach(function(s){var i=(t.match(Cd(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=ar(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&uk(n.HeadingPairs,n.TitlesOfParts,e,r),e}var rJ=/<[^>]+>[^<]*/g;function nJ(t,e){var r={},n="",s=t.match(rJ);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=Ct(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ar(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ar(u);break;case"bool":r[n]=Dr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=vn(u);break;case"cy":case"error":r[n]=ar(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var sJ={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},gg;function aJ(t,e,r){gg||(gg=ax(sJ)),e=gg[e]||e,t[e]=r}function gx(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function dk(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function fk(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function hk(t,e,r){return e===31?fk(t):dk(t,e,r)}function zv(t,e,r){return hk(t,e,r===!1?0:4)}function iJ(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return hk(t,e,0)}function oJ(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ds,""),t.l-s&2&&(t.l+=2)}return r}function lJ(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ds,"");return r}function cJ(t){var e=t.l,r=wh(t,ok);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=wh(t,vs);return[r,n]}function uJ(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(cJ(t));return r}function nS(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(ds,"").replace(_u,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function pk(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function dJ(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function wh(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==eS&&n!==e&&jQ.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===eS?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return dk(t,n,4).replace(ds,"");case 31:return fk(t);case 64:return gx(t);case 65:return pk(t);case 71:return dJ(t);case 80:return zv(t,n,!i.raw).replace(ds,"");case 81:return iJ(t,n).replace(ds,"");case 4108:return uJ(t);case 4126:case 4127:return n==4127?oJ(t):lJ(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function sS(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=s;++a){var u=t.read_shift(4),f=t.read_shift(4);i[a]=[u,f+r]}i.sort(function(E,x){return E[1]-x[1]});var h={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var p=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(p=!1,t.l=i[a][1]),p)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[i[a][0]];if(h[v.n]=wh(t,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ca(o=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(i[a][0]===1){if(o=h.CodePage=wh(t,mx),ca(o),l!==-1){var g=t.l;t.l=i[l][1],c=nS(t,o),t.l=g}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}c=nS(t,o)}else{var y=c[i[a][0]],b;switch(t[t.l]){case 65:t.l+=4,b=pk(t);break;case 30:t.l+=4,b=zv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,b=zv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,b=t.read_shift(4,"i");break;case 19:t.l+=4,b=t.read_shift(4);break;case 5:t.l+=4,b=t.read_shift(8,"f");break;case 11:t.l+=4,b=Wr(t,4);break;case 64:t.l+=4,b=vn(gx(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[y]=b}}return t.l=r+n,h}function aS(t,e,r){var n=t.content;if(!n)return{};An(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==rr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var f=sS(n,e),h={SystemIdentifier:c};for(var p in f)h[p]=f[p];if(h.FMTID=i,s===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=sS(n,null)}catch{}for(p in v)h[p]=v[p];return h.FMTID=[i,a],h}function Ui(t,e){return t.read_shift(e),null}function fJ(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Wr(t,e){return t.read_shift(e)===1}function Zr(t){return t.read_shift(2,"u")}function mk(t,e){return fJ(t,e,Zr)}function hJ(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function of(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function pJ(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function il(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function lf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):il(t,n,r)}function _l(t,e,r){if(r.biff>5)return lf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function mJ(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function gJ(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ds,"");return n&&(t.l+=24),s}function vJ(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(ds,"");return r+a}function yJ(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return gJ(t);case"0303000000000000c000000000000046":return vJ(t);default:throw new Error("Unsupported Moniker "+r)}}function Qf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ds,""):"";return r}function xJ(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,c="",u,f;s&16&&(i=Qf(t,r-t.l)),s&128&&(a=Qf(t,r-t.l)),(s&257)===257&&(o=Qf(t,r-t.l)),(s&257)===1&&(l=yJ(t,r-t.l)),s&8&&(c=Qf(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(f=gx(t)),t.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return u&&(p.guid=u),f&&(p.time=f),i&&(p.Tooltip=i),p}function gk(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function vk(t,e){var r=gk(t);return r[3]=0,r}function ja(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function EJ(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function _J(t,e,r){return e===0?"":_l(t,e,r)}function bJ(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function yk(t){var e=t.read_shift(2),r=px(t);return[e,r]}function SJ(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=of(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Up(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function xk(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var AJ=xk;function Ek(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function TJ(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function wJ(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Ln(t){t.l+=2,t.l+=t.read_shift(2)}var CJ={0:Ln,4:Ln,5:Ln,6:Ln,7:wJ,8:Ln,9:Ln,10:Ln,11:Ln,12:Ln,13:TJ,14:Ln,15:Ln,16:Ln,17:Ln,18:Ln,19:Ln,20:Ln,21:Ek};function IJ(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(CJ[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Jf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function kJ(t,e){return e===0||t.read_shift(2),1200}function DJ(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=_l(t,0,r);return t.read_shift(e+n-t.l),s}function PJ(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function RJ(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=of(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function FJ(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(pJ(t));return i.Count=n,i.Unique=s,i}function NJ(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function OJ(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function MJ(t){var e=EJ(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function LJ(t){return t.read_shift(2),t.read_shift(4)}function iS(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function BJ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function UJ(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function $J(){}function VJ(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=of(t,0,r),n}function HJ(t){var e=ja(t);return e.isst=t.read_shift(4),e}function jJ(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=ja(t);r.biff==2&&t.l++;var i=lf(t,n-t.l,r);return s.val=i,s}function GJ(t,e,r){var n=t.read_shift(2),s=_l(t,0,r);return[n,s]}var WJ=_l;function oS(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function zJ(t){var e=t.read_shift(2),r=t.read_shift(2),n=yk(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function KJ(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(yk(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function qJ(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function XJ(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=zQ[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function YJ(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=XJ(t,e,n.fStyle,r),n}function QJ(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function lS(t,e,r){var n=ja(t);(r.biff==2||e==9)&&++t.l;var s=hJ(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function JJ(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ja(t),s=Wn(t);return n.val=s,n}var cS=_J;function ZJ(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=il(t,i),o=[];n>t.l;)o.push(lf(t));return[i,s,a,o]}function uS(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=SJ(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var eZ=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function dS(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=il(t,a,r);s&32&&(c=eZ[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var f=n==t.l||o===0||!(u>0)?[]:Ore(t,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function _k(t,e,r){if(r.biff<8)return tZ(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(bJ(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function tZ(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=of(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function rZ(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=il(t,n,r),a=il(t,s,r);return[i,a]}function nZ(t,e,r){var n=xk(t);t.l++;var s=t.read_shift(1);return e-=8,[Mre(t,e,r),s,n]}function fS(t,e,r){var n=AJ(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Fre(t,e,r)]}function sZ(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function aZ(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=_l(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function iZ(t,e,r){return aZ(t,e,r)}function oZ(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Up(t));return r}function lZ(t,e,r){if(r&&r.biff<8)return uZ(t,e,r);var n=Ek(t),s=IJ(t,e-22,n[1]);return{cmo:n,ft:s}}var cZ={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function uZ(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((cZ[n]||Zn)(t,e,r)),{cmo:[s,n,i],ft:a}}function dZ(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=mJ(t,6,r);var o=t.read_shift(2);t.read_shift(2),Zr(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],f=il(t,t.lens[c+1]-t.lens[c]-1);if(s+=f,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function fZ(t,e){var r=Up(t);t.l+=16;var n=xJ(t,e-24);return[r,n]}function hZ(t,e){t.read_shift(2);var r=Up(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ds,""),[r,n]}function pZ(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=tS[r]||r,r=t.read_shift(2),e[1]=tS[r]||r,e}function mZ(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(vk(t));return r}function gZ(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(vk(t));return r}function vZ(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function bk(t,e,r){if(!r.cellStyles)return Zn(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function yZ(t,e){var r={};return e<32||(t.l+=16,r.header=Wn(t),r.footer=Wn(t),t.l+=2),r}function xZ(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var EZ=ja,_Z=mk,bZ=lf;function SZ(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function AZ(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ja(t);++t.l;var s=_l(t,e-7,r);return n.t="str",n.val=s,n}function TZ(t){var e=ja(t);++t.l;var r=Wn(t);return e.t="n",e.val=r,e}function wZ(t){var e=ja(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function CZ(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function IZ(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function kZ(t,e,r){var n=t.l+e,s=ja(t),i=t.read_shift(2),a=il(t,i,r);return t.l=n,s.t="str",s.val=a,s}var DZ=[2,3,48,49,131,139,140,245],hS=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=ax({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=mo(1);switch(l.type){case"base64":u=oa(Ps(o));break;case"binary":u=oa(o);break;case"buffer":case"array":u=o;break}An(u,0);var f=u.read_shift(1),h=!!(f&136),p=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=u.read_shift(2)),u.l+=3,f!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=u.read_shift(2));var b=u.read_shift(2),E=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(E=t[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var x=[],I={},D=Math.min(u.length,f==2?521:y-10-(p?264:0)),P=v?32:11;u.l<D&&u[u.l]!=13;)switch(I={},I.name=Td.utils.decode(E,u.slice(u.l,u.l+P)).replace(/[\u0000\r\n].*$/g,""),u.l+=P,I.type=String.fromCharCode(u.read_shift(1)),f!=2&&!v&&(I.offset=u.read_shift(4)),I.len=u.read_shift(1),f==2&&(I.offset=u.read_shift(2)),I.dec=u.read_shift(1),I.name.length&&x.push(I),f!=2&&(u.l+=v?13:14),I.type){case"B":(!p||I.len!=8)&&l.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+I.name+":"+I.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+I.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var w=0,S=0;for(c[0]=[],S=0;S!=x.length;++S)c[0][S]=x[S].name;for(;g-- >0;){if(u[u.l]===42){u.l+=b;continue}for(++u.l,c[++w]=[],S=0,S=0;S!=x.length;++S){var m=u.slice(u.l,u.l+x[S].len);u.l+=x[S].len,An(m,0);var T=Td.utils.decode(E,m);switch(x[S].type){case"C":T.trim().length&&(c[w][S]=T.replace(/\s+$/,""));break;case"D":T.length===8?c[w][S]=new Date(+T.slice(0,4),+T.slice(4,6)-1,+T.slice(6,8)):c[w][S]=T;break;case"F":c[w][S]=parseFloat(T.trim());break;case"+":case"I":c[w][S]=v?m.read_shift(-4,"i")^2147483648:m.read_shift(4,"i");break;case"L":switch(T.trim().toUpperCase()){case"Y":case"T":c[w][S]=!0;break;case"N":case"F":c[w][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+T+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[w][S]="##MEMO##"+(v?parseInt(T.trim(),10):m.read_shift(4));break;case"N":T=T.replace(/\u0000/g,"").trim(),T&&T!="."&&(c[w][S]=+T||0);break;case"@":c[w][S]=new Date(m.read_shift(-8,"f")-621356832e5);break;case"T":c[w][S]=new Date((m.read_shift(4)-2440588)*864e5+m.read_shift(4));break;case"Y":c[w][S]=m.read_shift(4,"i")/1e4+m.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[w][S]=-m.read_shift(-8,"f");break;case"B":if(p&&x[S].len==8){c[w][S]=m.read_shift(8,"f");break}case"G":case"P":m.l+=x[S].len;break;case"0":if(x[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[S].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Wc(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function s(o,l){try{return _o(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&ca(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=jv(),f=Jv(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),v=o["!cols"]||[],g=0,y=0,b=0,E=1;for(g=0;g<h.length;++g){if(((v[g]||{}).DBF||{}).name){h[g]=v[g].DBF.name,++b;continue}if(h[g]!=null){if(++b,typeof h[g]=="number"&&(h[g]=h[g].toString(10)),typeof h[g]!="string")throw new Error("DBF Invalid column name "+h[g]+" |"+typeof h[g]+"|");if(h.indexOf(h[g])!==g){for(y=0;y<1024;++y)if(h.indexOf(h[g]+"_"+y)==-1){h[g]+="_"+y;break}}}}var x=jr(o["!ref"]),I=[],D=[],P=[];for(g=0;g<=x.e.c-x.s.c;++g){var w="",S="",m=0,T=[];for(y=0;y<p.length;++y)p[y][g]!=null&&T.push(p[y][g]);if(T.length==0||h[g]==null){I[g]="?";continue}for(y=0;y<T.length;++y){switch(typeof T[y]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=T[y]instanceof Date?"D":"C";break;default:S="C"}m=Math.max(m,String(T[y]).length),w=w&&w!=S?"C":S}m>250&&(m=250),S=((v[g]||{}).DBF||{}).type,S=="C"&&v[g].DBF.len>m&&(m=v[g].DBF.len),w=="B"&&S=="N"&&(w="N",P[g]=v[g].DBF.dec,m=v[g].DBF.len),D[g]=w=="C"||S=="N"?m:i[w]||0,E+=D[g],I[g]=w}var _=u.next(32);for(_.write_shift(4,318902576),_.write_shift(4,p.length),_.write_shift(2,296+32*b),_.write_shift(2,E),g=0;g<4;++g)_.write_shift(4,0);for(_.write_shift(4,0|(+e[_I]||3)<<8),g=0,y=0;g<h.length;++g)if(h[g]!=null){var A=u.next(32),k=(h[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,k,"sbcs"),A.write_shift(1,I[g]=="?"?"C":I[g],"sbcs"),A.write_shift(4,y),A.write_shift(1,D[g]||i[I[g]]||0),A.write_shift(1,P[g]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),y+=D[g]||i[I[g]]||0}var U=u.next(264);for(U.write_shift(4,13),g=0;g<65;++g)U.write_shift(4,0);for(g=0;g<p.length;++g){var L=u.next(E);for(L.write_shift(1,0),y=0;y<h.length;++y)if(h[y]!=null)switch(I[y]){case"L":L.write_shift(1,p[g][y]==null?63:p[g][y]?84:70);break;case"B":L.write_shift(8,p[g][y]||0,"f");break;case"N":var R="0";for(typeof p[g][y]=="number"&&(R=p[g][y].toFixed(P[y]||0)),b=0;b<D[y]-R.length;++b)L.write_shift(1,32);L.write_shift(1,R,"sbcs");break;case"D":p[g][y]?(L.write_shift(4,("0000"+p[g][y].getFullYear()).slice(-4),"sbcs"),L.write_shift(2,("00"+(p[g][y].getMonth()+1)).slice(-2),"sbcs"),L.write_shift(2,("00"+p[g][y].getDate()).slice(-2),"sbcs")):L.write_shift(8,"00000000","sbcs");break;case"C":var F=String(p[g][y]!=null?p[g][y]:"").slice(0,D[y]);for(L.write_shift(1,F,"sbcs"),b=0;b<D[y]-F.length;++b)L.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),PZ=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ua(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var v=t[p];return typeof v=="number"?kb(v):v},n=function(h,p,v){var g=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?h:kb(g)};t["|"]=254;function s(h,p){switch(p.type){case"base64":return i(Ps(h),p);case"binary":return i(h,p);case"buffer":return i(Jt&&Buffer.isBuffer(h)?h.toString("binary"):vl(h),p);case"array":return i(al(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var v=h.split(/[\n\r]+/),g=-1,y=-1,b=0,E=0,x=[],I=[],D=null,P={},w=[],S=[],m=[],T=0,_;for(+p.codepage>=0&&ca(+p.codepage);b!==v.length;++b){T=0;var A=v[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),k=A.replace(/;;/g,"\0").split(";").map(function(ne){return ne.replace(/\u0000/g,";")}),U=k[0],L;if(A.length>0)switch(U){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":k[1].charAt(0)=="P"&&I.push(A.slice(3).replace(/;;/g,";"));break;case"C":var R=!1,F=!1,N=!1,M=!1,z=-1,G=-1;for(E=1;E<k.length;++E)switch(k[E].charAt(0)){case"A":break;case"X":y=parseInt(k[E].slice(1))-1,F=!0;break;case"Y":for(g=parseInt(k[E].slice(1))-1,F||(y=0),_=x.length;_<=g;++_)x[_]=[];break;case"K":L=k[E].slice(1),L.charAt(0)==='"'?L=L.slice(1,L.length-1):L==="TRUE"?L=!0:L==="FALSE"?L=!1:isNaN(ha(L))?isNaN(kc(L).getDate())||(L=vn(L)):(L=ha(L),D!==null&&jc(D)&&(L=Bp(L))),R=!0;break;case"E":M=!0;var H=fc(k[E].slice(1),{r:g,c:y});x[g][y]=[x[g][y],H];break;case"S":N=!0,x[g][y]=[x[g][y],"S5S"];break;case"G":break;case"R":z=parseInt(k[E].slice(1))-1;break;case"C":G=parseInt(k[E].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}if(R&&(x[g][y]&&x[g][y].length==2?x[g][y][0]=L:x[g][y]=L,D=null),N){if(M)throw new Error("SYLK shared formula cannot have own formula");var j=z>-1&&x[z][G];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");x[g][y][1]=Rk(j[1],{r:g-z,c:y-G})}break;case"F":var K=0;for(E=1;E<k.length;++E)switch(k[E].charAt(0)){case"X":y=parseInt(k[E].slice(1))-1,++K;break;case"Y":for(g=parseInt(k[E].slice(1))-1,_=x.length;_<=g;++_)x[_]=[];break;case"M":T=parseInt(k[E].slice(1))/20;break;case"F":break;case"G":break;case"P":D=I[parseInt(k[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(m=k[E].slice(1).split(" "),_=parseInt(m[0],10);_<=parseInt(m[1],10);++_)T=parseInt(m[2],10),S[_-1]=T===0?{hidden:!0}:{wch:T},Dc(S[_-1]);break;case"C":y=parseInt(k[E].slice(1))-1,S[y]||(S[y]={});break;case"R":g=parseInt(k[E].slice(1))-1,w[g]||(w[g]={}),T>0?(w[g].hpt=T,w[g].hpx=Pd(T)):T===0&&(w[g].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}K<1&&(D=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}}return w.length>0&&(P["!rows"]=w),S.length>0&&(P["!cols"]=S),p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),[x,P]}function a(h,p){var v=s(h,p),g=v[0],y=v[1],b=Wc(g,p);return Ua(y).forEach(function(E){b[E]=y[E]}),b}function o(h,p){return _o(a(h,p),p)}function l(h,p,v,g){var y="C;Y"+(v+1)+";X"+(g+1)+";K";switch(h.t){case"n":y+=h.v||0,h.f&&!h.F&&(y+=";E"+vte(h.f,{r:v,c:g}));break;case"b":y+=h.v?"TRUE":"FALSE";break;case"e":y+=h.w||h.v;break;case"d":y+='"'+(h.w||h.v)+'"';break;case"s":y+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(h,p){p.forEach(function(v,g){var y="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=Ih(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=kh(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&h.push(y)})}function u(h,p){p.forEach(function(v,g){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*kk(v.hpx)+";"),y.length>2&&h.push(y+"R"+(g+1))})}function f(h,p){var v=["ID;PWXL;N;E"],g=[],y=jr(h["!ref"]),b,E=Array.isArray(h),x=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&c(v,h["!cols"]),h["!rows"]&&u(v,h["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var I=y.s.r;I<=y.e.r;++I)for(var D=y.s.c;D<=y.e.c;++D){var P=Nt({r:I,c:D});b=E?(h[I]||[])[D]:h[P],!(!b||b.v==null&&(!b.f||b.F))&&g.push(l(b,h,I,D))}return v.join(x)+x+g.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),RZ=function(){function t(i,a){switch(a.type){case"base64":return e(Ps(i),a);case"binary":return e(i,a);case"buffer":return e(Jt&&Buffer.isBuffer(i)?i.toString("binary"):vl(i),a);case"array":return e(al(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),p=h[0],v=h[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+p){case-1:if(g==="BOT"){f[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[l][c]=!0:g==="FALSE"?f[l][c]=!1:isNaN(ha(v))?isNaN(kc(v).getDate())?f[l][c]=v:f[l][c]=vn(v):f[l][c]=ha(v),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(i,a){return Wc(t(i,a),a)}function n(i,a){return _o(r(i,a),a)}var s=function(){var i=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=jr(l["!ref"]),f,h=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var g=Nt({r:p,c:v});if(f=h?(l[p]||[])[v]:l[g],!f){a(c,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,y,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ws(f.z||Bt[14],fs(vn(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var b=`\r
`,E=c.join(b);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),FZ=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),v=-1,g=-1,y=0,b=[];y!==p.length;++y){var E=p[y].trim().split(":");if(E[0]==="cell"){var x=cs(E[1]);if(b.length<=x.r)for(v=b.length;v<=x.r;++v)b[v]||(b[v]=[]);switch(v=x.r,g=x.c,E[2]){case"t":b[v][g]=t(E[3]);break;case"v":b[v][g]=+E[3];break;case"vtf":var I=E[E.length-1];case"vtc":switch(E[3]){case"nl":b[v][g]=!!+E[4];break;default:b[v][g]=+E[4];break}E[2]=="vtf"&&(b[v][g]=[b[v][g],I])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(f,h){return Wc(r(f,h),h)}function s(f,h){return _o(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],v,g="",y=Gc(f["!ref"]),b=Array.isArray(f),E=y.s.r;E<=y.e.r;++E)for(var x=y.s.c;x<=y.e.c;++x)if(g=Nt({r:E,c:x}),v=b?(f[E]||[])[x]:f[g],!(!v||v.v==null||v.t==="z")){switch(p=["cell",g,"t"],v.t){case"s":case"str":p.push(e(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=e(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var I=fs(vn(v.v));p[2]="vtc",p[3]="nd",p[4]=""+I,p[5]=v.w||Ws(v.z||Bt[14],I);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,a,o,a,c(f),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),kd=function(){function t(u,f,h,p,v){v.raw?f[h][p]=u:u===""||(u==="TRUE"?f[h][p]=!0:u==="FALSE"?f[h][p]=!1:isNaN(ha(u))?isNaN(kc(u).getDate())?f[h][p]=u:f[h][p]=vn(u):f[h][p]=ha(u))}function e(u,f){var h=f||{},p=[];if(!u||u.length===0)return p;for(var v=u.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var y=10,b=0,E=0;E<=g;++E)b=v[E].indexOf(" "),b==-1?b=v[E].length:b++,y=Math.max(y,b);for(E=0;E<=g;++E){p[E]=[];var x=0;for(t(v[E].slice(0,y).trim(),p,E,x,h),x=1;x<=(v[E].length-y)/10+1;++x)t(v[E].slice(y+(x-1)*10,y+x*10).trim(),p,E,x,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,p=0,v=0;p<u.length;++p)(v=u.charCodeAt(p))==34?h=!h:!h&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&v.push([f[p],p]);if(!v.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&v.push([f[p],p])}return v.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[v.pop()[1]]||44}function i(u,f){var h=f||{},p="",v=h.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):h&&h.FS?p=h.FS:p=s(u.slice(0,1024));var y=0,b=0,E=0,x=0,I=0,D=p.charCodeAt(0),P=!1,w=0,S=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var m=h.dateNF!=null?GY(h.dateNF):null;function T(){var _=u.slice(x,I),A={};if(_.charAt(0)=='"'&&_.charAt(_.length-1)=='"'&&(_=_.slice(1,-1).replace(/""/g,'"')),_.length===0)A.t="z";else if(h.raw)A.t="s",A.v=_;else if(_.trim().length===0)A.t="s",A.v=_;else if(_.charCodeAt(0)==61)_.charCodeAt(1)==34&&_.charCodeAt(_.length-1)==34?(A.t="s",A.v=_.slice(2,-1).replace(/""/g,'"')):xte(_)?(A.t="n",A.f=_.slice(1)):(A.t="s",A.v=_);else if(_=="TRUE")A.t="b",A.v=!0;else if(_=="FALSE")A.t="b",A.v=!1;else if(!isNaN(E=ha(_)))A.t="n",h.cellText!==!1&&(A.w=_),A.v=E;else if(!isNaN(kc(_).getDate())||m&&_.match(m)){A.z=h.dateNF||Bt[14];var k=0;m&&_.match(m)&&(_=WY(_,h.dateNF,_.match(m)||[]),k=1),h.cellDates?(A.t="d",A.v=vn(_,k)):(A.t="n",A.v=fs(vn(_,k))),h.cellText!==!1&&(A.w=Ws(A.z,A.v instanceof Date?fs(A.v):A.v)),h.cellNF||delete A.z}else A.t="s",A.v=_;if(A.t=="z"||(h.dense?(v[y]||(v[y]=[]),v[y][b]=A):v[Nt({c:b,r:y})]=A),x=I+1,S=u.charCodeAt(x),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),w==D)++b;else if(b=0,++y,h.sheetRows&&h.sheetRows<=y)return!0}e:for(;I<u.length;++I)switch(w=u.charCodeAt(I)){case 34:S===34&&(P=!P);break;case D:case 10:case 13:if(!P&&T())break e;break}return I-x>0&&T(),v["!ref"]=sr(g),v}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):Wc(e(u,f),f)}function o(u,f){var h="",p=f.type=="string"?[0,0,0,0]:Ax(u,f);switch(f.type){case"base64":h=Ps(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Td<"u"||(h=Jt&&Buffer.isBuffer(u)?u.toString("binary"):vl(u));break;case"array":h=al(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Sr(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Sr(h):f.type=="binary"&&typeof Td<"u",h.slice(0,19)=="socialcalc:version:"?FZ.to_sheet(f.type=="string"?h:Sr(h),f):a(h,f)}function l(u,f){return _o(o(u,f),f)}function c(u){for(var f=[],h=jr(u["!ref"]),p,v=Array.isArray(u),g=h.s.r;g<=h.e.r;++g){for(var y=[],b=h.s.c;b<=h.e.c;++b){var E=Nt({r:g,c:b});if(p=v?(u[g]||[])[b]:u[E],!p||p.v==null){y.push("          ");continue}for(var x=(p.w||(Ti(p),p.w)||"").slice(0,10);x.length<10;)x+=" ";y.push(x+(b===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function NZ(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=PZ.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return kd.to_workbook(t,e)}}var Yu=function(){function t(H,j,K){if(H){An(H,H.l||0);for(var ne=K.Enum||z;H.l<H.length;){var he=H.read_shift(2),le=ne[he]||ne[65535],fe=H.read_shift(2),te=H.l+fe,Z=le.f&&le.f(H,fe,K);if(H.l=te,j(Z,le,he))return}}}function e(H,j){switch(j.type){case"base64":return r(oa(Ps(H)),j);case"binary":return r(oa(H),j);case"buffer":case"array":return r(H,j)}throw"Unsupported type "+j.type}function r(H,j){if(!H)return H;var K=j||{},ne=K.dense?[]:{},he="Sheet1",le="",fe=0,te={},Z=[],xe=[],Q={s:{r:0,c:0},e:{r:0,c:0}},q=K.sheetRows||0;if(H[2]==0&&(H[3]==8||H[3]==9)&&H.length>=16&&H[14]==5&&H[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(H[2]==2)K.Enum=z,t(H,function(ee,ie,ve){switch(ve){case 0:K.vers=ee,ee>=4096&&(K.qpro=!0);break;case 6:Q=ee;break;case 204:ee&&(le=ee);break;case 222:le=ee;break;case 15:case 51:K.qpro||(ee[1].v=ee[1].v.slice(1));case 13:case 14:case 16:ve==14&&(ee[2]&112)==112&&(ee[2]&15)>1&&(ee[2]&15)<15&&(ee[1].z=K.dateNF||Bt[14],K.cellDates&&(ee[1].t="d",ee[1].v=Bp(ee[1].v))),K.qpro&&ee[3]>fe&&(ne["!ref"]=sr(Q),te[he]=ne,Z.push(he),ne=K.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},fe=ee[3],he=le||"Sheet"+(fe+1),le="");var we=K.dense?(ne[ee[0].r]||[])[ee[0].c]:ne[Nt(ee[0])];if(we){we.t=ee[1].t,we.v=ee[1].v,ee[1].z!=null&&(we.z=ee[1].z),ee[1].f!=null&&(we.f=ee[1].f);break}K.dense?(ne[ee[0].r]||(ne[ee[0].r]=[]),ne[ee[0].r][ee[0].c]=ee[1]):ne[Nt(ee[0])]=ee[1];break}},K);else if(H[2]==26||H[2]==14)K.Enum=G,H[2]==14&&(K.qpro=!0,H.l=0),t(H,function(ee,ie,ve){switch(ve){case 204:he=ee;break;case 22:ee[1].v=ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ee[3]>fe&&(ne["!ref"]=sr(Q),te[he]=ne,Z.push(he),ne=K.dense?[]:{},Q={s:{r:0,c:0},e:{r:0,c:0}},fe=ee[3],he="Sheet"+(fe+1)),q>0&&ee[0].r>=q)break;K.dense?(ne[ee[0].r]||(ne[ee[0].r]=[]),ne[ee[0].r][ee[0].c]=ee[1]):ne[Nt(ee[0])]=ee[1],Q.e.c<ee[0].c&&(Q.e.c=ee[0].c),Q.e.r<ee[0].r&&(Q.e.r=ee[0].r);break;case 27:ee[14e3]&&(xe[ee[14e3][0]]=ee[14e3][1]);break;case 1537:xe[ee[0]]=ee[1],ee[0]==fe&&(he=ee[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+H[2]);if(ne["!ref"]=sr(Q),te[le||he]=ne,Z.push(le||he),!xe.length)return{SheetNames:Z,Sheets:te};for(var J={},pe=[],ge=0;ge<xe.length;++ge)te[Z[ge]]?(pe.push(xe[ge]||Z[ge]),J[xe[ge]]=te[xe[ge]]||te[Z[ge]]):(pe.push(xe[ge]),J[xe[ge]]={"!ref":"A1"});return{SheetNames:pe,Sheets:J}}function n(H,j){var K=j||{};if(+K.codepage>=0&&ca(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var ne=jv(),he=jr(H["!ref"]),le=Array.isArray(H),fe=[];ea(ne,0,i(1030)),ea(ne,6,l(he));for(var te=Math.min(he.e.r,8191),Z=he.s.r;Z<=te;++Z)for(var xe=Rn(Z),Q=he.s.c;Q<=he.e.c;++Q){Z===he.s.r&&(fe[Q]=cn(Q));var q=fe[Q]+xe,J=le?(H[Z]||[])[Q]:H[q];if(!(!J||J.t=="z"))if(J.t=="n")(J.v|0)==J.v&&J.v>=-32768&&J.v<=32767?ea(ne,13,p(Z,Q,J.v)):ea(ne,14,g(Z,Q,J.v));else{var pe=Ti(J);ea(ne,15,f(Z,Q,pe.slice(0,239)))}}return ea(ne,1),ne.end()}function s(H,j){var K=j||{};if(+K.codepage>=0&&ca(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var ne=jv();ea(ne,0,a(H));for(var he=0,le=0;he<H.SheetNames.length;++he)(H.Sheets[H.SheetNames[he]]||{})["!ref"]&&ea(ne,27,M(H.SheetNames[he],le++));var fe=0;for(he=0;he<H.SheetNames.length;++he){var te=H.Sheets[H.SheetNames[he]];if(!(!te||!te["!ref"])){for(var Z=jr(te["!ref"]),xe=Array.isArray(te),Q=[],q=Math.min(Z.e.r,8191),J=Z.s.r;J<=q;++J)for(var pe=Rn(J),ge=Z.s.c;ge<=Z.e.c;++ge){J===Z.s.r&&(Q[ge]=cn(ge));var ee=Q[ge]+pe,ie=xe?(te[J]||[])[ge]:te[ee];if(!(!ie||ie.t=="z"))if(ie.t=="n")ea(ne,23,T(J,ge,fe,ie.v));else{var ve=Ti(ie);ea(ne,22,w(J,ge,fe,ve.slice(0,239)))}}++fe}}return ea(ne,1),ne.end()}function i(H){var j=an(2);return j.write_shift(2,H),j}function a(H){var j=an(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var K=0,ne=0,he=0,le=0;le<H.SheetNames.length;++le){var fe=H.SheetNames[le],te=H.Sheets[fe];if(!(!te||!te["!ref"])){++he;var Z=Gc(te["!ref"]);K<Z.e.r&&(K=Z.e.r),ne<Z.e.c&&(ne=Z.e.c)}}return K>8191&&(K=8191),j.write_shift(2,K),j.write_shift(1,he),j.write_shift(1,ne),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function o(H,j,K){var ne={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&K.qpro?(ne.s.c=H.read_shift(1),H.l++,ne.s.r=H.read_shift(2),ne.e.c=H.read_shift(1),H.l++,ne.e.r=H.read_shift(2),ne):(ne.s.c=H.read_shift(2),ne.s.r=H.read_shift(2),j==12&&K.qpro&&(H.l+=2),ne.e.c=H.read_shift(2),ne.e.r=H.read_shift(2),j==12&&K.qpro&&(H.l+=2),ne.s.c==65535&&(ne.s.c=ne.e.c=ne.s.r=ne.e.r=0),ne)}function l(H){var j=an(8);return j.write_shift(2,H.s.c),j.write_shift(2,H.s.r),j.write_shift(2,H.e.c),j.write_shift(2,H.e.r),j}function c(H,j,K){var ne=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(ne[0].c=H.read_shift(1),ne[3]=H.read_shift(1),ne[0].r=H.read_shift(2),H.l+=2):(ne[2]=H.read_shift(1),ne[0].c=H.read_shift(2),ne[0].r=H.read_shift(2)),ne}function u(H,j,K){var ne=H.l+j,he=c(H,j,K);if(he[1].t="s",K.vers==20768){H.l++;var le=H.read_shift(1);return he[1].v=H.read_shift(le,"utf8"),he}return K.qpro&&H.l++,he[1].v=H.read_shift(ne-H.l,"cstr"),he}function f(H,j,K){var ne=an(7+K.length);ne.write_shift(1,255),ne.write_shift(2,j),ne.write_shift(2,H),ne.write_shift(1,39);for(var he=0;he<ne.length;++he){var le=K.charCodeAt(he);ne.write_shift(1,le>=128?95:le)}return ne.write_shift(1,0),ne}function h(H,j,K){var ne=c(H,j,K);return ne[1].v=H.read_shift(2,"i"),ne}function p(H,j,K){var ne=an(7);return ne.write_shift(1,255),ne.write_shift(2,j),ne.write_shift(2,H),ne.write_shift(2,K,"i"),ne}function v(H,j,K){var ne=c(H,j,K);return ne[1].v=H.read_shift(8,"f"),ne}function g(H,j,K){var ne=an(13);return ne.write_shift(1,255),ne.write_shift(2,j),ne.write_shift(2,H),ne.write_shift(8,K,"f"),ne}function y(H,j,K){var ne=H.l+j,he=c(H,j,K);if(he[1].v=H.read_shift(8,"f"),K.qpro)H.l=ne;else{var le=H.read_shift(2);I(H.slice(H.l,H.l+le),he),H.l+=le}return he}function b(H,j,K){var ne=j&32768;return j&=-32769,j=(ne?H:0)+(j>=8192?j-16384:j),(ne?"":"$")+(K?cn(j):Rn(j))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function I(H,j){An(H,0);for(var K=[],ne=0,he="",le="",fe="",te="";H.l<H.length;){var Z=H[H.l++];switch(Z){case 0:K.push(H.read_shift(8,"f"));break;case 1:le=b(j[0].c,H.read_shift(2),!0),he=b(j[0].r,H.read_shift(2),!1),K.push(le+he);break;case 2:{var xe=b(j[0].c,H.read_shift(2),!0),Q=b(j[0].r,H.read_shift(2),!1);le=b(j[0].c,H.read_shift(2),!0),he=b(j[0].r,H.read_shift(2),!1),K.push(xe+Q+":"+le+he)}break;case 3:if(H.l<H.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(H.read_shift(2));break;case 6:{for(var q="";Z=H[H.l++];)q+=String.fromCharCode(Z);K.push('"'+q.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:te=K.pop(),fe=K.pop(),K.push(["AND","OR"][Z-20]+"("+fe+","+te+")");break;default:if(Z<32&&x[Z])te=K.pop(),fe=K.pop(),K.push(fe+x[Z]+te);else if(E[Z]){if(ne=E[Z][1],ne==69&&(ne=H[H.l++]),ne>K.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+K.join("|")+"|");return}var J=K.slice(-ne);K.length-=ne,K.push(E[Z][0]+"("+J.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}K.length==1?j[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function D(H){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=H.read_shift(2),j[3]=H[H.l++],j[0].c=H[H.l++],j}function P(H,j){var K=D(H);return K[1].t="s",K[1].v=H.read_shift(j-4,"cstr"),K}function w(H,j,K,ne){var he=an(6+ne.length);he.write_shift(2,H),he.write_shift(1,K),he.write_shift(1,j),he.write_shift(1,39);for(var le=0;le<ne.length;++le){var fe=ne.charCodeAt(le);he.write_shift(1,fe>=128?95:fe)}return he.write_shift(1,0),he}function S(H,j){var K=D(H);K[1].v=H.read_shift(2);var ne=K[1].v>>1;if(K[1].v&1)switch(ne&7){case 0:ne=(ne>>3)*5e3;break;case 1:ne=(ne>>3)*500;break;case 2:ne=(ne>>3)/20;break;case 3:ne=(ne>>3)/200;break;case 4:ne=(ne>>3)/2e3;break;case 5:ne=(ne>>3)/2e4;break;case 6:ne=(ne>>3)/16;break;case 7:ne=(ne>>3)/64;break}return K[1].v=ne,K}function m(H,j){var K=D(H),ne=H.read_shift(4),he=H.read_shift(4),le=H.read_shift(2);if(le==65535)return ne===0&&he===3221225472?(K[1].t="e",K[1].v=15):ne===0&&he===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var fe=le&32768;return le=(le&32767)-16446,K[1].v=(1-fe*2)*(he*Math.pow(2,le+32)+ne*Math.pow(2,le)),K}function T(H,j,K,ne){var he=an(14);if(he.write_shift(2,H),he.write_shift(1,K),he.write_shift(1,j),ne==0)return he.write_shift(4,0),he.write_shift(4,0),he.write_shift(2,65535),he;var le=0,fe=0,te=0,Z=0;return ne<0&&(le=1,ne=-ne),fe=Math.log2(ne)|0,ne/=Math.pow(2,fe-31),Z=ne>>>0,Z&2147483648||(ne/=2,++fe,Z=ne>>>0),ne-=Z,Z|=2147483648,Z>>>=0,ne*=Math.pow(2,32),te=ne>>>0,he.write_shift(4,te),he.write_shift(4,Z),fe+=16383+(le?32768:0),he.write_shift(2,fe),he}function _(H,j){var K=m(H);return H.l+=j-14,K}function A(H,j){var K=D(H),ne=H.read_shift(4);return K[1].v=ne>>6,K}function k(H,j){var K=D(H),ne=H.read_shift(8,"f");return K[1].v=ne,K}function U(H,j){var K=k(H);return H.l+=j-10,K}function L(H,j){return H[H.l+j-1]==0?H.read_shift(j,"cstr"):""}function R(H,j){var K=H[H.l++];K>j-1&&(K=j-1);for(var ne="";ne.length<K;)ne+=String.fromCharCode(H[H.l++]);return ne}function F(H,j,K){if(!(!K.qpro||j<21)){var ne=H.read_shift(1);H.l+=17,H.l+=1,H.l+=2;var he=H.read_shift(j-21,"cstr");return[ne,he]}}function N(H,j){for(var K={},ne=H.l+j;H.l<ne;){var he=H.read_shift(2);if(he==14e3){for(K[he]=[0,""],K[he][0]=H.read_shift(2);H[H.l];)K[he][1]+=String.fromCharCode(H[H.l]),H.l++;H.l++}}return K}function M(H,j){var K=an(5+H.length);K.write_shift(2,14e3),K.write_shift(2,j);for(var ne=0;ne<H.length;++ne){var he=H.charCodeAt(ne);K[K.l++]=he>127?95:he}return K[K.l++]=0,K}var z={0:{n:"BOF",f:Zr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:L},222:{n:"SHEETNAMELP",f:R},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:m},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:_},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:N},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:k},40:{n:"FORMULA28",f:U},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:L},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:F},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function OZ(t){var e={},r=t.match(es),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=Ct(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=ex[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var MZ=function(){var t=Cd("t"),e=Cd("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:ar(a[1])},l=i.match(e);return l&&(o.s=OZ(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),LZ=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),BZ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UZ=/<(?:\w+:)?r>/,$Z=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function vx(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ar(Sr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Sr(t),r&&(n.h=ox(n.t))):t.match(UZ)&&(n.r=Sr(t),n.t=ar(Sr((t.replace($Z,"").match(BZ)||[]).join("").replace(es,""))),r&&(n.h=LZ(MZ(n.r)))),n):{t:""}}var VZ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,HZ=/<(?:\w+:)?(?:si|sstItem)>/g,jZ=/<\/(?:\w+:)?(?:si|sstItem)>/;function GZ(t,e){var r=[],n="";if(!t)return r;var s=t.match(VZ);if(s){n=s[2].replace(HZ,"").split(jZ);for(var i=0;i!=n.length;++i){var a=vx(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=Ct(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function WZ(t){return[t.read_shift(4),t.read_shift(4)]}function zZ(t,e){var r=[],n=!1;return ki(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Sk(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function hi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function KZ(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=hi(t,4),e.U=hi(t,4),e.W=hi(t,4),e}function qZ(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function XZ(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(qZ(t));return e}function YZ(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function QZ(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=hi(t,4),e.U=hi(t,4),e.W=hi(t,4),e}function JZ(t){var e=QZ(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Ak(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Tk(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function ZZ(t){var e=hi(t);switch(e.Minor){case 2:return[e.Minor,eee(t)];case 3:return[e.Minor,tee()];case 4:return[e.Minor,ree(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function eee(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Ak(t,r),s=Tk(t,t.length-t.l);return{t:"Std",h:n,v:s}}function tee(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ree(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(es,function(i){var a=Ct(i);switch(Ha(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function nee(t,e){var r={},n=r.EncryptionVersionInfo=hi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=Ak(t,s),e-=s,r.EncryptionVerifier=Tk(t,e),r}function see(t){var e={},r=e.EncryptionVersionInfo=hi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function aee(t){var e=0,r,n=Sk(t),s=n.length+1,i,a,o,l,c;for(r=mo(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var wk=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=Sk(a),l=i(o),c=o.length,u=mo(16),f=0;f!=16;++f)u[f]=0;var h,p,v;for((c&1)===1&&(h=l>>8,u[c]=s(t[0],h),--c,h=l&255,p=o[o.length-1],u[c]=s(p,h));c>0;)--c,h=l>>8,u[c]=s(o[c],h),--c,h=l&255,u[c]=s(o[c],h);for(c=15,v=15-o.length;v>0;)h=l>>8,u[c]=s(t[v],h),--c,--v,h=l&255,u[c]=s(o[c],h),--c,--v;return u}}(),iee=function(t,e,r,n,s){s||(s=e),n||(n=wk(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},oee=function(t){var e=0,r=wk(t);return function(n){var s=iee("",n,e,r);return e=s[1],s[0]}};function lee(t,e,r,n){var s={key:Zr(t),verificationBytes:Zr(t)};return r.password&&(s.verifier=aee(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=oee(r.password)),s}function cee(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=see(t):n.Data=nee(t,e),n}function uee(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?cee(t,e-2,n):lee(t,r.biff>=8?e:e-2,r,n),n}var dee=function(){function t(s,i){switch(i.type){case"base64":return e(Ps(s),i);case"binary":return e(s,i);case"buffer":return e(Jt&&Buffer.isBuffer(s)?s.toString("binary"):vl(s),i);case"array":return e(al(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,v,g=-1;v=h.exec(u);){switch(v[0]){case"\\cell":var y=u.slice(p,h.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(o)?o[f][g]=b:o[Nt({r:f,c:g})]=b}break}p=h.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=sr(c),o}function r(s,i){return _o(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=jr(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Nt({r:c,c:u});o=l?(s[c]||[])[u]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ti(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function fee(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Dd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function hee(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,c=s+i;switch(l=a/(c>1?2-c:c),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function pee(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function Ch(t,e){if(e===0)return t;var r=hee(fee(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Dd(pee(r))}var Ck=6,mee=15,gee=1,ls=Ck;function Ih(t){return Math.floor((t+Math.round(128/ls)/256)*ls)}function kh(t){return Math.floor((t-5)/ls*100+.5)/100}function Kv(t){return Math.round((t*ls+5)/ls*256)/256}function vg(t){return Kv(kh(Ih(t)))}function yx(t){var e=Math.abs(t-vg(t)),r=ls;if(e>.005)for(ls=gee;ls<mee;++ls)Math.abs(t-vg(t))<=e&&(e=Math.abs(t-vg(t)),r=ls);ls=r}function Dc(t){t.width?(t.wpx=Ih(t.width),t.wch=kh(t.wpx),t.MDW=ls):t.wpx?(t.wch=kh(t.wpx),t.width=Kv(t.wch),t.MDW=ls):typeof t.wch=="number"&&(t.width=Kv(t.wch),t.wpx=Ih(t.width),t.MDW=ls),t.customWidth&&delete t.customWidth}var vee=96,Ik=vee;function kk(t){return t*96/Ik}function Pd(t){return t*Ik/96}var yee={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function xee(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(es)||[]).forEach(function(a){var o=Ct(a);switch(Ha(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Dr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Dr(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function Eee(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(es)||[]).forEach(function(a){var o=Ct(a);switch(Ha(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function _ee(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(es)||[]).forEach(function(a){var o=Ct(a);switch(Ha(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Sr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Dr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Dr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Dr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Dr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Dr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Dr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Dr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=ex[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Dr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=zo[s.color.index];s.color.index==81&&(l=zo[1]),l||(l=zo[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Ch(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function bee(t,e,r){e.NumberFmt=[];for(var n=Ua(Bt),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Bt[n[s]];var i=t[0].match(es);if(i)for(s=0;s<i.length;++s){var a=Ct(i[s]);switch(Ha(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ar(Sr(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Wo(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var Zf=["numFmtId","fillId","fontId","borderId","xfId"],e0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function See(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(es)||[]).forEach(function(i){var a=Ct(i),o=0;switch(Ha(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Zf.length;++o)n[Zf[o]]&&(n[Zf[o]]=parseInt(n[Zf[o]],10));for(o=0;o<e0.length;++o)n[e0[o]]&&(n[e0[o]]=Dr(n[e0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Dr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var Aee=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(e))&&bee(f,u,c),(f=o.match(s))&&_ee(f,u,l,c),(f=o.match(n))&&Eee(f,u,l,c),(f=o.match(i))&&xee(f,u,l,c),(f=o.match(r))&&See(f,u,c),u}}();function Tee(t,e){var r=t.read_shift(2),n=Qn(t);return[r,n]}function wee(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=MQ(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=OQ(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Qn(t),n}var Cee=Zn;function Iee(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var kee=Zn;function Dee(t,e,r){var n={};n.NumberFmt=[];for(var s in Bt)n.NumberFmt[s]=Bt[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return ki(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Wo(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=Ch(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(u),a=!0;break;case 38:i.pop(),a=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var Pee=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Ree(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(es)||[]).forEach(function(s){var i=Ct(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[Pee.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Fee(){}function Nee(){}var Oee=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Mee=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Lee=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Bee(t,e,r){e.themeElements={};var n;[["clrScheme",Oee,Ree],["fontScheme",Mee,Fee],["fmtScheme",Lee,Nee]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var Uee=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Dk(t,e){(!t||t.length===0)&&(t=$ee());var r,n={};if(!(r=t.match(Uee)))throw new Error("themeElements not found in theme");return Bee(r[0],n,e),n.raw=t,n}function $ee(t,e){var r=[VI];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Vee(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=$I(i,{type:"array"})}catch{return}var o=ws(a,"theme/theme/theme1.xml",!0);if(o)return Dk(o,r)}}function Hee(t){return t.read_shift(4)}function jee(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=Gee(t,4);break;case 2:e.xclrValue=gk(t);break;case 3:e.xclrValue=Hee(t);break;case 4:t.l+=4;break}return t.l+=8,e}function Gee(t,e){return Zn(t,e)}function Wee(t,e){return Zn(t,e)}function zee(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=jee(t);break;case 6:n[1]=Wee(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Kee(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(zee(t,r-t.l));return{ixfe:n,ext:i}}function qee(t,e){e.forEach(function(r){switch(r[0]){}})}function Xee(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Qn(t)}}function Yee(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Qee(t){return t.l+=4,t.read_shift(4)!=0}function Jee(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return ki(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!c.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function Zee(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(es,function(o){var l=Ct(o);switch(Ha(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function ete(t){var e=[];if(!t)return e;var r=1;return(t.match(es)||[]).forEach(function(n){var s=Ct(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function tte(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Nt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function rte(t,e,r){var n=[];return ki(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function nte(t,e,r,n){if(!t)return t;var s=n||{},i=!1;ki(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function ste(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function pS(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=cs(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=jr(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=sr(l);c!==t["!ref"]&&(t["!ref"]=c)}i.c||(i.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function ate(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ct(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=cs(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&vx(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function ite(t,e){var r=[],n=!1,s={},i=0;return t.replace(es,function(o,l){var c=Ct(o);switch(Ha(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function ote(t,e){var r=[],n=!1;return t.replace(es,function(i){var a=Ct(i);switch(Ha(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function lte(t){var e={};e.iauthor=t.read_shift(4);var r=xl(t);return e.rfx=r.s,e.ref=Nt(r.s),t.l+=16,e}var cte=Qn;function ute(t,e){var r=[],n=[],s={},i=!1;return ki(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var dte="application/vnd.ms-office.vbaProject";function fte(t){var e=rr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");rr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),rr.write(e)}function hte(){return{"!type":"dialog"}}function pte(){return{"!type":"dialog"}}function mte(){return{"!type":"macro"}}function gte(){return{"!type":"macro"}}var fc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,s+(o?"":"$")+cn(u)+(l?"":"$")+Rn(c)}return function(s,i){return e=i,s.replace(t,r)}}(),Pk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,vte=function(){return function(e,r){return e.replace(Pk,function(n,s,i,a,o,l){var c=dx(a)-(i?0:r.c),u=ux(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":i?c+1:"["+c+"]";return s+"R"+f+"C"+h})}}();function Rk(t,e){return t.replace(Pk,function(r,n,s,i,a,o){return n+(s=="$"?s+i:cn(dx(i)+e.c))+(a=="$"?a+o:Rn(ux(o)+e.r))})}function yte(t,e,r){var n=Gc(e),s=n.s,i=cs(r),a={r:i.r-s.r,c:i.c-s.c};return Rk(t,a)}function xte(t){return t.length!=1}function mS(t){return t.replace(/_xlfn\./g,"")}function Xr(t){t.l+=1}function go(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Fk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Nk(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=go(t),o=go(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function Nk(t){var e=go(t),r=go(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function Ete(t,e,r){if(r.biff<8)return Nk(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=go(t),a=go(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Ok(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return _te(t);var n=t.read_shift(r&&r.biff==12?4:2),s=go(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function _te(t){var e=go(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function bte(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Ste(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Ate(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function Ate(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Tte(t,e,r){var n=(t[t.l++]&96)>>5,s=Fk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function wte(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=Fk(t,i,r);return[n,s,a]}function Cte(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Ite(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function kte(t,e,r){var n=(t[t.l++]&96)>>5,s=Ete(t,e-1,r);return[n,s]}function Dte(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function gS(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function Pte(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function Rte(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Fte(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Nte(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Ote(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Mk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Mte(t){return t.read_shift(2),Mk(t)}function Lte(t){return t.read_shift(2),Mk(t)}function Bte(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Ok(t,0,r);return[n,s]}function Ute(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Ste(t,0,r);return[n,s]}function $te(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=Ok(t,0,r);return[n,s,i]}function Vte(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[Hre[s],Uk[s],n]}function Hte(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:jte(t);return[s,(i[0]===0?Uk:Vre)[i[1]]]}function jte(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function Gte(t,e,r){t.l+=r&&r.biff==2?3:4}function Wte(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function zte(t){return t.l++,El[t.read_shift(1)]}function Kte(t){return t.l++,t.read_shift(2)}function qte(t){return t.l++,t.read_shift(1)!==0}function Xte(t){return t.l++,Wn(t)}function Yte(t,e,r){return t.l++,of(t,e-1,r)}function Qte(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Wr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=El[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Wn(t);break;case 2:r[1]=_l(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Jte(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?xl:Up)(t));return s}function Zte(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=Qte(t,r.biff);return a}function ere(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function tre(t,e,r){if(r.biff==5)return rre(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function rre(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function nre(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function sre(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function are(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function ire(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var ore=Zn,lre=Zn,cre=Zn;function cf(t,e,r){return t.l+=2,[bte(t)]}function xx(t){return t.l+=6,[]}var ure=cf,dre=xx,fre=xx,hre=cf;function Lk(t){return t.l+=2,[Zr(t),t.read_shift(2)&1]}var pre=cf,mre=Lk,gre=xx,vre=cf,yre=cf,xre=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Ere(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=xre[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function _re(t){return t.l+=2,[t.read_shift(4)]}function bre(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Sre(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Are(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Tre(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function wre(t){return t.l+=4,[0,0]}var vS={1:{n:"PtgExp",f:Wte},2:{n:"PtgTbl",f:cre},3:{n:"PtgAdd",f:Xr},4:{n:"PtgSub",f:Xr},5:{n:"PtgMul",f:Xr},6:{n:"PtgDiv",f:Xr},7:{n:"PtgPower",f:Xr},8:{n:"PtgConcat",f:Xr},9:{n:"PtgLt",f:Xr},10:{n:"PtgLe",f:Xr},11:{n:"PtgEq",f:Xr},12:{n:"PtgGe",f:Xr},13:{n:"PtgGt",f:Xr},14:{n:"PtgNe",f:Xr},15:{n:"PtgIsect",f:Xr},16:{n:"PtgUnion",f:Xr},17:{n:"PtgRange",f:Xr},18:{n:"PtgUplus",f:Xr},19:{n:"PtgUminus",f:Xr},20:{n:"PtgPercent",f:Xr},21:{n:"PtgParen",f:Xr},22:{n:"PtgMissArg",f:Xr},23:{n:"PtgStr",f:Yte},26:{n:"PtgSheet",f:bre},27:{n:"PtgEndSheet",f:Sre},28:{n:"PtgErr",f:zte},29:{n:"PtgBool",f:qte},30:{n:"PtgInt",f:Kte},31:{n:"PtgNum",f:Xte},32:{n:"PtgArray",f:Dte},33:{n:"PtgFunc",f:Vte},34:{n:"PtgFuncVar",f:Hte},35:{n:"PtgName",f:ere},36:{n:"PtgRef",f:Bte},37:{n:"PtgArea",f:Tte},38:{n:"PtgMemArea",f:nre},39:{n:"PtgMemErr",f:ore},40:{n:"PtgMemNoMem",f:lre},41:{n:"PtgMemFunc",f:sre},42:{n:"PtgRefErr",f:are},43:{n:"PtgAreaErr",f:Cte},44:{n:"PtgRefN",f:Ute},45:{n:"PtgAreaN",f:kte},46:{n:"PtgMemAreaN",f:Are},47:{n:"PtgMemNoMemN",f:Tre},57:{n:"PtgNameX",f:tre},58:{n:"PtgRef3d",f:$te},59:{n:"PtgArea3d",f:wte},60:{n:"PtgRefErr3d",f:ire},61:{n:"PtgAreaErr3d",f:Ite},255:{}},Cre={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ire={1:{n:"PtgElfLel",f:Lk},2:{n:"PtgElfRw",f:vre},3:{n:"PtgElfCol",f:ure},6:{n:"PtgElfRwV",f:yre},7:{n:"PtgElfColV",f:hre},10:{n:"PtgElfRadical",f:pre},11:{n:"PtgElfRadicalS",f:gre},13:{n:"PtgElfColS",f:dre},15:{n:"PtgElfColSV",f:fre},16:{n:"PtgElfRadicalLel",f:mre},25:{n:"PtgList",f:Ere},29:{n:"PtgSxName",f:_re},255:{}},kre={0:{n:"PtgAttrNoop",f:wre},1:{n:"PtgAttrSemi",f:Ote},2:{n:"PtgAttrIf",f:Fte},4:{n:"PtgAttrChoose",f:Pte},8:{n:"PtgAttrGoto",f:Rte},16:{n:"PtgAttrSum",f:Gte},32:{n:"PtgAttrBaxcel",f:gS},33:{n:"PtgAttrBaxcel",f:gS},64:{n:"PtgAttrSpace",f:Mte},65:{n:"PtgAttrSpaceSemi",f:Lte},128:{n:"PtgAttrIfError",f:Nte},255:{}};function uf(t,e,r,n){if(n.biff<8)return Zn(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=Zte(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=Jte(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(Zn(t,e)),i}function df(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=vS[i]||vS[Cre[i]],(i===24||i===25)&&(s=(i===24?Ire:kre)[t[t.l+1]]),!s||!s.f?Zn(t,e):a.push([s.n,s.f(t,e,r)]);return a}function Dre(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var Pre={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Rre(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Bk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function yS(t,e,r){var n=Bk(t,e,r);return n=="#REF"?n:Rre(n,r)}function Hn(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,f=0,h=0,p,v="";if(!t[0]||!t[0][0])return"";for(var g=-1,y="",b=0,E=t[0].length;b<E;++b){var x=t[0][b];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(t[0][g][1][0]){case 0:y=Vr(" ",t[0][g][1][1]);break;case 1:y=Vr("\r",t[0][g][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}c=c+y,g=-1}o.push(c+Pre[x[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=zu(x[1][1],a,s),o.push(Ku(u,i));break;case"PtgRefN":u=r?zu(x[1][1],r,s):x[1][1],o.push(Ku(u,i));break;case"PtgRef3d":f=x[1][1],u=zu(x[1][2],a,s),v=yS(n,f,s),o.push(v+"!"+Ku(u,i));break;case"PtgFunc":case"PtgFuncVar":var I=x[1][0],D=x[1][1];I||(I=0),I&=127;var P=I==0?[]:o.slice(-I);o.length-=I,D==="User"&&(D=P.shift()),o.push(D+"("+P.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":p=Jb(x[1][1],r?{s:r}:a,s),o.push(mg(p,s));break;case"PtgArea":p=Jb(x[1][1],a,s),o.push(mg(p,s));break;case"PtgArea3d":f=x[1][1],p=x[1][2],v=yS(n,f,s),o.push(v+"!"+mg(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var w=(n.names||[])[h-1]||(n[0]||[])[h],S=w?w.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var m=x[1][1];h=x[1][2];var T;if(s.biff<=5)m<0&&(m=-m),n[m]&&(T=n[m][h]);else{var _="";if(((n[m]||[])[0]||[])[0]==14849||(((n[m]||[])[0]||[])[0]==1025?n[m][h]&&n[m][h].itab>0&&(_=n.SheetNames[n[m][h].itab-1]+"!"):_=n.SheetNames[h-1]+"!"),n[m]&&n[m][h])_+=n[m][h].Name;else if(n[0]&&n[0][h])_+=n[0][h].Name;else{var A=(Bk(n,m,s)||"").split(";;");A[h-1]?_=A[h-1]:_+="SH33TJSERRX"}o.push(_);break}T||(T={Name:"SH33TJSERRY"}),o.push(T.Name);break;case"PtgParen":var k="(",U=")";if(g>=0){switch(y="",t[0][g][1][0]){case 2:k=Vr(" ",t[0][g][1][1])+k;break;case 3:k=Vr("\r",t[0][g][1][1])+k;break;case 4:U=Vr(" ",t[0][g][1][1])+U;break;case 5:U=Vr("\r",t[0][g][1][1])+U;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}o.push(k+o.pop()+U);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:x[1][1],r:x[1][0]};var L={c:r.c,r:r.r};if(n.sharedf[Nt(u)]){var R=n.sharedf[Nt(u)];o.push(Hn(R,a,L,n,s))}else{var F=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Hn(c[1],a,L,n,s)),F=!0;break}F||o.push(x[1])}break;case"PtgArray":o.push("{"+Dre(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var N=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&N.indexOf(t[0][b][0])==-1){x=t[0][g];var M=!0;switch(x[1][0]){case 4:M=!1;case 0:y=Vr(" ",x[1][1]);break;case 5:M=!1;case 1:y=Vr("\r",x[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((M?y:"")+o.pop()+(M?"":y)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Fre(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Zn(t,e-2)];var o=df(t,a,r);return e!==a+s&&(i=uf(t,e-a-s,o,r)),t.l=n,[o,i]}function Nre(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],Zn(t,e-2)];var o=df(t,a,r);return e!==a+s&&(i=uf(t,e-a-s,o,r)),t.l=n,[o,i]}function Ore(t,e,r,n){var s=t.l+e,i=df(t,n,r),a;return s!==t.l&&(a=uf(t,s-t.l,i,r)),[i,a]}function Mre(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=df(t,i,r);return i==65535?[[],Zn(t,e-2)]:(e!==i+2&&(s=uf(t,n-i-2,a,r)),[a,s])}function Lre(t){var e;if(ci(t,t.l+6)!==65535)return[Wn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function yg(t,e,r){var n=t.l+e,s=ja(t);r.biff==2&&++t.l;var i=Lre(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=Nre(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function $p(t,e,r){var n=t.read_shift(4),s=df(t,n,r),i=t.read_shift(4),a=i>0?uf(t,i,s,r):null;return[s,a]}var Bre=$p,Vp=$p,Ure=$p,$re=$p,Vre={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Uk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hre={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xS(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function xg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Qu={},hc={};function Ju(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function $k(t,e,r,n,s,i){try{n.cellNF&&(t.z=Bt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=vn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Bt[e]==null&&Wo(jY[e]||"General",e),t.t==="e")t.w=t.w||El[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=wd(t.v);else if(t.t==="d"){var a=fs(t.v);(a|0)===a?t.w=a.toString(10):t.w=wd(a)}else{if(t.v===void 0)return"";t.w=sl(t.v,hc)}else t.t==="d"?t.w=Ws(e,fs(t.v),hc):t.w=Ws(e,t.v,hc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Ch(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Ch(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function jre(t,e){var r=jr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=sr(r))}var Gre=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Wre=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zre=/<(?:\w:)?hyperlink [^>]*>/mg,Kre=/"(\w*:\w*)"/,qre=/<(?:\w:)?col\b[^>]*[\/]?>/g,Xre=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Yre=/<(?:\w:)?pageMargins[^>]*\/>/g,Vk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Qre=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Jre=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Zre(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=t.match(Wre);f?(c=t.slice(0,f.index),u=t.slice(f.index+f[0].length)):c=u=t;var h=c.match(Vk);h?Ex(h[0],o,s,r):(h=c.match(Qre))&&ene(h[0],h[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=c.slice(p,p+50).match(Kre);v&&jre(o,v[1])}var g=c.match(Jre);g&&g[1]&&ine(g[1],s);var y=[];if(e.cellStyles){var b=c.match(qre);b&&nne(y,b)}f&&one(f[1],o,e,l,i,a);var E=u.match(Xre);E&&(o["!autofilter"]=sne(E[0]));var x=[],I=u.match(Gre);if(I)for(p=0;p!=I.length;++p)x[p]=jr(I[p].slice(I[p].indexOf('"')+1));var D=u.match(zre);D&&tne(o,D,n);var P=u.match(Yre);if(P&&(o["!margins"]=rne(Ct(P[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=sr(l)),e.sheetRows>0&&o["!ref"]){var w=jr(o["!ref"]);e.sheetRows<=+w.e.r&&(w.e.r=e.sheetRows-1,w.e.r>l.e.r&&(w.e.r=l.e.r),w.e.r<w.s.r&&(w.s.r=w.e.r),w.e.c>l.e.c&&(w.e.c=l.e.c),w.e.c<w.s.c&&(w.s.c=w.e.c),o["!fullref"]=o["!ref"],o["!ref"]=sr(w))}return y.length>0&&(o["!cols"]=y),x.length>0&&(o["!merges"]=x),o}function Ex(t,e,r,n){var s=Ct(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=ar(Sr(s.codeName)))}function ene(t,e,r,n,s){Ex(t.slice(0,t.indexOf(">")),r,n,s)}function tne(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=Ct(Sr(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+ar(i.location))):(i.Target="#"+ar(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=jr(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Nt({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=i):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=i)}}}function rne(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function nne(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=Ct(e[n],!0);s.hidden&&(s.hidden=Dr(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,yx(s.width)),Dc(s);i<=a;)t[i++]=Pn(s)}}function sne(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var ane=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function ine(t,e){e.Views||(e.Views=[{}]),(t.match(ane)||[]).forEach(function(r,n){var s=Ct(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Dr(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var one=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Cd("v"),a=Cd("f");return function(l,c,u,f,h,p){for(var v=0,g="",y=[],b=[],E=0,x=0,I=0,D="",P,w,S=0,m=0,T,_,A=0,k=0,U=Array.isArray(p.CellXf),L,R=[],F=[],N=Array.isArray(c),M=[],z={},G=!1,H=!!u.sheetStubs,j=l.split(e),K=0,ne=j.length;K!=ne;++K){g=j[K].trim();var he=g.length;if(he!==0){var le=0;e:for(v=0;v<he;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(u&&u.cellStyles){if(w=Ct(g.slice(le,v),!0),S=w.r!=null?parseInt(w.r,10):S+1,m=-1,u.sheetRows&&u.sheetRows<S)continue;z={},G=!1,w.ht&&(G=!0,z.hpt=parseFloat(w.ht),z.hpx=Pd(z.hpt)),w.hidden=="1"&&(G=!0,z.hidden=!0),w.outlineLevel!=null&&(G=!0,z.level=+w.outlineLevel),G&&(M[S-1]=z)}break;case"<":le=v;break}if(le>=v)break;if(w=Ct(g.slice(le,v),!0),S=w.r!=null?parseInt(w.r,10):S+1,m=-1,!(u.sheetRows&&u.sheetRows<S)){f.s.r>S-1&&(f.s.r=S-1),f.e.r<S-1&&(f.e.r=S-1),u&&u.cellStyles&&(z={},G=!1,w.ht&&(G=!0,z.hpt=parseFloat(w.ht),z.hpx=Pd(z.hpt)),w.hidden=="1"&&(G=!0,z.hidden=!0),w.outlineLevel!=null&&(G=!0,z.level=+w.outlineLevel),G&&(M[S-1]=z)),y=g.slice(v).split(t);for(var fe=0;fe!=y.length&&y[fe].trim().charAt(0)=="<";++fe);for(y=y.slice(fe),v=0;v!=y.length;++v)if(g=y[v].trim(),g.length!==0){if(b=g.match(r),E=v,x=0,I=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,b!=null&&b.length===2){for(E=0,D=b[1],x=0;x!=D.length&&!((I=D.charCodeAt(x)-64)<1||I>26);++x)E=26*E+I;--E,m=E}else++m;for(x=0;x!=g.length&&g.charCodeAt(x)!==62;++x);if(++x,w=Ct(g.slice(0,x),!0),w.r||(w.r=Nt({r:S-1,c:m})),D=g.slice(x),P={t:""},(b=D.match(i))!=null&&b[1]!==""&&(P.v=ar(b[1])),u.cellFormula){if((b=D.match(a))!=null&&b[1]!==""){if(P.f=ar(Sr(b[1])).replace(/\r\n/g,`
`),u.xlfn||(P.f=mS(P.f)),b[0].indexOf('t="array"')>-1)P.F=(D.match(s)||[])[1],P.F.indexOf(":")>-1&&R.push([jr(P.F),P.F]);else if(b[0].indexOf('t="shared"')>-1){_=Ct(b[0]);var te=ar(Sr(b[1]));u.xlfn||(te=mS(te)),F[parseInt(_.si,10)]=[_,te,w.r]}}else(b=D.match(/<f[^>]*\/>/))&&(_=Ct(b[0]),F[_.si]&&(P.f=yte(F[_.si][1],F[_.si][2],w.r)));var Z=cs(w.r);for(x=0;x<R.length;++x)Z.r>=R[x][0].s.r&&Z.r<=R[x][0].e.r&&Z.c>=R[x][0].s.c&&Z.c<=R[x][0].e.c&&(P.F=R[x][1])}if(w.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(H)P.t="z";else continue;else P.t=w.t||"n";switch(f.s.c>m&&(f.s.c=m),f.e.c<m&&(f.e.c=m),P.t){case"n":if(P.v==""||P.v==null){if(!H)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!H)continue;P.t="z"}else T=Qu[parseInt(P.v,10)],P.v=T.t,P.r=T.r,u.cellHTML&&(P.h=T.h);break;case"str":P.t="s",P.v=P.v!=null?Sr(P.v):"",u.cellHTML&&(P.h=ox(P.v));break;case"inlineStr":b=D.match(n),P.t="s",b!=null&&(T=vx(b[1]))?(P.v=T.t,u.cellHTML&&(P.h=T.h)):P.v="";break;case"b":P.v=Dr(P.v);break;case"d":u.cellDates?P.v=vn(P.v,1):(P.v=fs(vn(P.v,1)),P.t="n");break;case"e":(!u||u.cellText!==!1)&&(P.w=P.v),P.v=lk[P.v];break}if(A=k=0,L=null,U&&w.s!==void 0&&(L=p.CellXf[w.s],L!=null&&(L.numFmtId!=null&&(A=L.numFmtId),u.cellStyles&&L.fillId!=null&&(k=L.fillId))),$k(P,A,k,u,h,p),u.cellDates&&U&&P.t=="n"&&jc(Bt[A])&&(P.t="d",P.v=Bp(P.v)),w.cm&&u.xlmeta){var xe=(u.xlmeta.Cell||[])[+w.cm-1];xe&&xe.type=="XLDAPR"&&(P.D=!0)}if(N){var Q=cs(w.r);c[Q.r]||(c[Q.r]=[]),c[Q.r][Q.c]=P}else c[w.r]=P}}}}M.length>0&&(c["!rows"]=M)}}();function lne(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var cne=xl;function une(){}function dne(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=FQ(t),r}function fne(t){var e=Xs(t);return[e]}function hne(t){var e=yl(t);return[e]}function pne(t){var e=Xs(t),r=t.read_shift(1);return[e,r,"b"]}function mne(t){var e=yl(t),r=t.read_shift(1);return[e,r,"b"]}function gne(t){var e=Xs(t),r=t.read_shift(1);return[e,r,"e"]}function vne(t){var e=yl(t),r=t.read_shift(1);return[e,r,"e"]}function yne(t){var e=Xs(t),r=t.read_shift(4);return[e,r,"s"]}function xne(t){var e=yl(t),r=t.read_shift(4);return[e,r,"s"]}function Ene(t){var e=Xs(t),r=Wn(t);return[e,r,"n"]}function Hk(t){var e=yl(t),r=Wn(t);return[e,r,"n"]}function _ne(t){var e=Xs(t),r=px(t);return[e,r,"n"]}function bne(t){var e=yl(t),r=px(t);return[e,r,"n"]}function Sne(t){var e=Xs(t),r=fx(t);return[e,r,"is"]}function Ane(t){var e=Xs(t),r=Qn(t);return[e,r,"str"]}function Tne(t){var e=yl(t),r=Qn(t);return[e,r,"str"]}function wne(t,e,r){var n=t.l+e,s=Xs(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=Vp(t,n-t.l,r);a[3]=Hn(o,null,s,r.supbooks,r)}else t.l=n;return a}function Cne(t,e,r){var n=t.l+e,s=Xs(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=Vp(t,n-t.l,r);a[3]=Hn(o,null,s,r.supbooks,r)}else t.l=n;return a}function Ine(t,e,r){var n=t.l+e,s=Xs(t);s.r=r["!row"];var i=Wn(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=Vp(t,n-t.l,r);a[3]=Hn(o,null,s,r.supbooks,r)}else t.l=n;return a}function kne(t,e,r){var n=t.l+e,s=Xs(t);s.r=r["!row"];var i=Qn(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=Vp(t,n-t.l,r);a[3]=Hn(o,null,s,r.supbooks,r)}else t.l=n;return a}var Dne=xl;function Pne(t,e){var r=t.l+e,n=xl(t),s=hx(t),i=Qn(t),a=Qn(t),o=Qn(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function Rne(){}function Fne(t,e,r){var n=t.l+e,s=ak(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=Bre(t,n-t.l,r);a[1]=o}else t.l=n;return a}function Nne(t,e,r){var n=t.l+e,s=xl(t),i=[s];if(r.cellFormula){var a=$re(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var One=["left","right","top","bottom","header","footer"];function Mne(t){var e={};return One.forEach(function(r){e[r]=Wn(t)}),e}function Lne(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Bne(){}function Une(){}function $ne(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,v,g,y,b,E,x,I,D,P=[];o.biff=12,o["!row"]=0;var w=0,S=!1,m=[],T={},_=o.supbooks||s.supbooks||[[]];if(_.sharedf=T,_.arrayf=m,_.SheetNames=s.SheetNames||s.Sheets.map(function(N){return N.name}),!o.supbooks&&(o.supbooks=_,s.Names))for(var A=0;A<s.Names.length;++A)_[0][A+1]=s.Names[A];var k=[],U=[],L=!1;Dh[16]={n:"BrtShortReal",f:Hk};var R;if(ki(t,function(M,z,G){if(!h)switch(G){case 148:c=M;break;case 0:p=M,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),I=Rn(y=p.r),o["!row"]=p.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=Pd(M.hpt)),U[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:M[2]},M[2]){case"n":v.v=M[1];break;case"s":x=Qu[M[1]],v.v=x.t,v.r=x.r;break;case"b":v.v=!!M[1];break;case"e":v.v=M[1],o.cellText!==!1&&(v.w=El[v.v]);break;case"str":v.t="s",v.v=M[1];break;case"is":v.t="s",v.v=M[1].t;break}if((g=a.CellXf[M[0].iStyleRef])&&$k(v,g.numFmtId,null,o,i,a),b=M[0].c==-1?b+1:M[0].c,o.dense?(l[y]||(l[y]=[]),l[y][b]=v):l[cn(b)+I]=v,o.cellFormula){for(S=!1,w=0;w<m.length;++w){var H=m[w];p.r>=H[0].s.r&&p.r<=H[0].e.r&&b>=H[0].s.c&&b<=H[0].e.c&&(v.F=sr(H[0]),S=!0)}!S&&M.length>3&&(v.f=M[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>b&&(u.s.c=b),u.e.r<p.r&&(u.e.r=p.r),u.e.c<b&&(u.e.c=b),o.cellDates&&g&&v.t=="n"&&jc(Bt[g.numFmtId])){var j=Bo(v.v);j&&(v.t="d",v.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}R&&(R.type=="XLDAPR"&&(v.D=!0),R=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;v={t:"z",v:void 0},b=M[0].c==-1?b+1:M[0].c,o.dense?(l[y]||(l[y]=[]),l[y][b]=v):l[cn(b)+I]=v,u.s.r>p.r&&(u.s.r=p.r),u.s.c>b&&(u.s.c=b),u.e.r<p.r&&(u.e.r=p.r),u.e.c<b&&(u.e.c=b),R&&(R.type=="XLDAPR"&&(v.D=!0),R=void 0);break;case 176:P.push(M);break;case 49:R=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var K=n["!id"][M.relId];for(K?(M.Target=K.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=K):M.relId==""&&(M.Target="#"+M.loc),y=M.rfx.s.r;y<=M.rfx.e.r;++y)for(b=M.rfx.s.c;b<=M.rfx.e.c;++b)o.dense?(l[y]||(l[y]=[]),l[y][b]||(l[y][b]={t:"z",v:void 0}),l[y][b].l=M):(E=Nt({c:b,r:y}),l[E]||(l[E]={t:"z",v:void 0}),l[E].l=M);break;case 426:if(!o.cellFormula)break;m.push(M),D=o.dense?l[y][b]:l[cn(b)+I],D.f=Hn(M[1],u,{r:p.r,c:b},_,o),D.F=sr(M[0]);break;case 427:if(!o.cellFormula)break;T[Nt(M[0].s)]=M[1],D=o.dense?l[y][b]:l[cn(b)+I],D.f=Hn(M[1],u,{r:p.r,c:b},_,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)k[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},L||(L=!0,yx(M.w/256)),Dc(k[M.e+1]);break;case 161:l["!autofilter"]={ref:sr(M)};break;case 476:l["!margins"]=M;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),M.name&&(s.Sheets[r].CodeName=M.name),(M.above||M.left)&&(l["!outline"]={above:M.above,left:M.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),M.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!z.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=sr(c||u)),o.sheetRows&&l["!ref"]){var F=jr(l["!ref"]);o.sheetRows<=+F.e.r&&(F.e.r=o.sheetRows-1,F.e.r>u.e.r&&(F.e.r=u.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>u.e.c&&(F.e.c=u.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),l["!fullref"]=l["!ref"],l["!ref"]=sr(F))}return P.length>0&&(l["!merges"]=P),k.length>0&&(l["!cols"]=k),U.length>0&&(l["!rows"]=U),l}function Vne(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=ar((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function Hne(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=Vne(f);u.s.r=u.s.c=0,u.e.c=o,c=cn(o),h[0].forEach(function(p,v){a[c+Rn(v)]={t:"n",v:p,z:h[1]},l=v}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=sr(u)),a}function jne(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(Vk);return o&&Ex(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function Gne(t,e){t.l+=10;var r=Qn(t);return{name:r}}function Wne(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return ki(t,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var jk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],zne=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Kne=[],qne=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ES(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Dr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function _S(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Dr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Gk(t){_S(t.WBProps,jk),_S(t.CalcPr,qne),ES(t.WBView,zne),ES(t.Sheets,Kne),hc.date1904=Dr(t.WBProps.date1904)}var Xne="][*?/\\".split("");function Yne(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Xne.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Qne=/<\w+:workbook/;function Jne(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(es,function(l,c){var u=Ct(l);switch(Ha(u[0])){case"<?xml":break;case"<workbook":l.match(Qne)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":jk.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Dr(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Sr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ar(Sr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Sr(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Dr(u.hidden||"0")&&(i.Hidden=!0),a=c+l.length;break;case"</definedName>":i.Ref=ar(Sr(t.slice(a,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),gQ.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Gk(r),r}function Zne(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Gv(t),r.name=Qn(t),r}function ese(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Qn(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function tse(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function rse(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=NQ(t),a=Ure(t,0,r),o=hx(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function nse(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],Dh[16]={n:"BrtFRTArchID$",f:tse},ki(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Hn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),Gk(r),r.Names=i,r.supbooks=a,r}function sse(t,e,r){return e.slice(-4)===".bin"?nse(t,r):Jne(t,r)}function ase(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?$ne(t,n,r,s,i,a,o):Zre(t,n,r,s,i,a,o)}function ise(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Wne(t,n,r,s,i):jne(t,n,r,s,i)}function ose(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?mte():gte()}function lse(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?hte():pte()}function cse(t,e,r,n){return e.slice(-4)===".bin"?Dee(t,r,n):Aee(t,r,n)}function use(t,e,r){return Dk(t,r)}function dse(t,e,r){return e.slice(-4)===".bin"?zZ(t,r):GZ(t,r)}function fse(t,e,r){return e.slice(-4)===".bin"?ute(t,r):ate(t,r)}function hse(t,e,r){return e.slice(-4)===".bin"?rte(t):ete(t)}function pse(t,e,r,n){return r.slice(-4)===".bin"?nte(t,e,r,n):void 0}function mse(t,e,r){return e.slice(-4)===".bin"?Jee(t,e,r):Zee(t,e,r)}var Wk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zs(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(Wk),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(zk),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function gse(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Wk),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(zk),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var Zu;function vse(t,e){var r=Zu[t]||ar(t);return r==="General"?sl(e):Ws(r,e)}function yse(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Dr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=vn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ar(e)]=s}function xse(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||El[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=wd(t.v):t.w=sl(t.v):t.w=vse(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=Zu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&jc(n)){var s=Bo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function Ese(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=yee[n.Pattern]||n.Pattern)}t[e.ID]=e}function _se(t,e,r,n,s,i,a,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var p=[],v=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&p.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Dr(t);break;case"String":n.t="s",n.r=jb(ar(t)),n.v=t.indexOf("<")>-1?ar(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(vn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ar(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=lk[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=jb(e||t));break}if(xse(n,u,c),c.cellFormula!==!1)if(n.Formula){var g=ar(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=fc(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=fc("RC:RC",s):n.ArrayRange&&(n.F=fc(n.ArrayRange,s),l.push([jr(n.F),n.F]))}else for(v=0;v<l.length;++v)s.r>=l[v][0].s.r&&s.r<=l[v][0].e.r&&s.c>=l[v][0].s.c&&s.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(p.forEach(function(y){!h.patternType&&y.patternType&&(h.patternType=y.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function bse(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Eg(t,e){var r=e||{};NI();var n=Eu(lx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Sr(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=Pn(r);return a.type="string",kd.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ie){s.indexOf("<"+ie)>=0&&(i=!0)}),i)return Pse(n,r);Zu={"General Number":"General","General Date":Bt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Bt[15],"Short Date":Bt[14],"Long Time":Bt[19],"Medium Time":Bt[18],"Short Time":Bt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Bt[2],Standard:Bt[4],Percent:Bt[10],Scientific:Bt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=r.dense?[]:{},p="",v={},g={},y=Zs('<Data ss:Type="String">'),b=0,E=0,x=0,I={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},P={},w="",S=0,m=[],T={},_={},A=0,k=[],U=[],L={},R=[],F,N=!1,M=[],z=[],G={},H=0,j=0,K={Sheets:[],WBProps:{date1904:!1}},ne={};Id.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var he="";o=Id.exec(n);)switch(o[3]=(he=o[3]).toLowerCase()){case"data":if(he=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?_se(n.slice(b,o.index),w,y,l[l.length-1][0]=="comment"?L:v,{c:E,r:x},D,R[E],g,M,r):(w="",y=Zs(o[0]),b=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(U.length>0&&(v.c=U),(!r.sheetRows||r.sheetRows>x)&&v.v!==void 0&&(r.dense?(h[x]||(h[x]=[]),h[x][E]=v):h[cn(E)+Rn(x)]=v),v.HRef&&(v.l={Target:ar(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(H=E+(parseInt(v.MergeAcross,10)|0),j=x+(parseInt(v.MergeDown,10)|0),m.push({s:{c:E,r:x},e:{c:H,r:j}})),!r.sheetStubs)v.MergeAcross?E=H+1:++E;else if(v.MergeAcross||v.MergeDown){for(var le=E;le<=H;++le)for(var fe=x;fe<=j;++fe)(le>E||fe>x)&&(r.dense?(h[fe]||(h[fe]=[]),h[fe][le]={t:"z"}):h[cn(le)+Rn(fe)]={t:"z"});E=H+1}else++E;else v=gse(o[0]),v.Index&&(E=+v.Index-1),E<I.s.c&&(I.s.c=E),E>I.e.c&&(I.e.c=E),o[0].slice(-2)==="/>"&&++E,U=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<I.s.r&&(I.s.r=x),x>I.e.r&&(I.e.r=x),o[0].slice(-2)==="/>"&&(g=Zs(o[0]),g.Index&&(x=+g.Index-1)),E=0,++x):(g=Zs(o[0]),g.Index&&(x=+g.Index-1),G={},(g.AutoFitHeight=="0"||g.Height)&&(G.hpx=parseInt(g.Height,10),G.hpt=kk(G.hpx),z[x]=G),g.Hidden=="1"&&(G.hidden=!0,z[x]=G));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(p),I.s.r<=I.e.r&&I.s.c<=I.e.c&&(h["!ref"]=sr(I),r.sheetRows&&r.sheetRows<=I.e.r&&(h["!fullref"]=h["!ref"],I.e.r=r.sheetRows-1,h["!ref"]=sr(I))),m.length&&(h["!merges"]=m),R.length>0&&(h["!cols"]=R),z.length>0&&(h["!rows"]=z),u[p]=h}else I={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=E=0,l.push([o[3],!1]),c=Zs(o[0]),p=ar(c.Name),h=r.dense?[]:{},m=[],M=[],z=[],ne={name:p,Hidden:0},K.Sheets.push(ne);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),R=[],N=!1}break;case"style":o[1]==="/"?Ese(D,P,r):P=Zs(o[0]);break;case"numberformat":P.nf=ar(Zs(o[0]).Format||"General"),Zu[P.nf]&&(P.nf=Zu[P.nf]);for(var te=0;te!=392&&Bt[te]!=P.nf;++te);if(te==392){for(te=57;te!=392;++te)if(Bt[te]==null){Wo(P.nf,te);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(F=Zs(o[0]),F.Hidden&&(F.hidden=!0,delete F.Hidden),F.Width&&(F.wpx=parseInt(F.Width,10)),!N&&F.wpx>10){N=!0,ls=Ck;for(var Z=0;Z<R.length;++Z)R[Z]&&Dc(R[Z])}N&&Dc(F),R[F.Index-1||R.length]=F;for(var xe=0;xe<+F.Span;++xe)R[R.length]=Pn(F);break;case"namedrange":if(o[1]==="/")break;K.Names||(K.Names=[]);var Q=Ct(o[0]),q={Name:Q.Name,Ref:fc(Q.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(q.Sheet=K.Sheets.length-1),K.Names.push(q);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?w+=n.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=Zs(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?aJ(T,he,n.slice(A,o.index)):A=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));bse(L),U.push(L)}else l.push([o[3],!1]),c=Zs(o[0]),L={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var J=Zs(o[0]);h["!autofilter"]={ref:fc(J.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return CS(n,r);var pe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:pe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:pe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:pe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:pe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(A,o.index)){case"SheetHidden":ne.Hidden=1;break;case"SheetVeryHidden":ne.Hidden=2;break}else A=o.index+o[0].length;break;case"header":h["!margins"]||Ju(h["!margins"]={},"xlml"),isNaN(+Ct(o[0]).Margin)||(h["!margins"].header=+Ct(o[0]).Margin);break;case"footer":h["!margins"]||Ju(h["!margins"]={},"xlml"),isNaN(+Ct(o[0]).Margin)||(h["!margins"].footer=+Ct(o[0]).Margin);break;case"pagemargins":var ge=Ct(o[0]);h["!margins"]||Ju(h["!margins"]={},"xlml"),isNaN(+ge.Top)||(h["!margins"].top=+ge.Top),isNaN(+ge.Left)||(h["!margins"].left=+ge.Left),isNaN(+ge.Right)||(h["!margins"].right=+ge.Right),isNaN(+ge.Bottom)||(h["!margins"].bottom=+ge.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:pe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:pe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:pe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:pe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:pe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:pe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:pe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:pe=!1}break;case"smarttags":break;default:pe=!1;break}if(pe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?yse(_,he,k,n.slice(A,o.index)):(k=o,A=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ee={};return!r.bookSheets&&!r.bookProps&&(ee.Sheets=u),ee.SheetNames=f,ee.Workbook=K,ee.SSF=Pn(Bt),ee.Props=T,ee.Custprops=_,ee}function qv(t,e){switch(Sx(e=e||{}),e.type||"base64"){case"base64":return Eg(Ps(t),e);case"binary":case"buffer":case"file":return Eg(t,e);case"array":return Eg(vl(t),e)}}function Sse(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=LQ(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=BQ(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Ase=[60,1084,2066,2165,2175];function Tse(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=ci(r,r.l),c=Xv[l],u=0;c!=null&&Ase.indexOf(l)>-1;)i=ci(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),a.push(o),r.l+=4+i,c=Xv[l=ci(r,r.l)];var f=Xi(a);An(f,0);var h=0;f.lens=[];for(var p=0;p<a.length;++p)f.lens.push(h),h+=a[p].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,s)}function Aa(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Bt[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||El[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=wd(t.v):t.w=sl(t.v):t.w=Ws(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&jc(Bt[n]||String(n))){var s=Bo(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function t0(t,e,r){return{v:t,ixfe:e,t:r}}function wse(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],c="",u={},f,h="",p,v,g,y,b={},E=[],x,I,D=[],P=[],w={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},m=function(ye){return ye<8?zo[ye]:ye<64&&P[ye-8]||zo[ye]},T=function(ye,Se,Oe){var We=Se.XF.data;if(!(!We||!We.patternType||!Oe||!Oe.cellStyles)){Se.s={},Se.s.patternType=We.patternType;var ot;(ot=Dd(m(We.icvFore)))&&(Se.s.fgColor={rgb:ot}),(ot=Dd(m(We.icvBack)))&&(Se.s.bgColor={rgb:ot})}},_=function(ye,Se,Oe){if(!(G>1)&&!(Oe.sheetRows&&ye.r>=Oe.sheetRows)){if(Oe.cellStyles&&Se.XF&&Se.XF.data&&T(ye,Se,Oe),delete Se.ixfe,delete Se.XF,f=ye,h=Nt(ye),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ye.r<a.s.r&&(a.s.r=ye.r),ye.c<a.s.c&&(a.s.c=ye.c),ye.r+1>a.e.r&&(a.e.r=ye.r+1),ye.c+1>a.e.c&&(a.e.c=ye.c+1),Oe.cellFormula&&Se.f){for(var We=0;We<E.length;++We)if(!(E[We][0].s.c>ye.c||E[We][0].s.r>ye.r)&&!(E[We][0].e.c<ye.c||E[We][0].e.r<ye.r)){Se.F=sr(E[We][0]),(E[We][0].s.c!=ye.c||E[We][0].s.r!=ye.r)&&delete Se.f,Se.f&&(Se.f=""+Hn(E[We][1],a,ye,M,A));break}}Oe.dense?(s[ye.r]||(s[ye.r]=[]),s[ye.r][ye.c]=Se):s[h]=Se}},A={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(A.password=e.password);var k,U=[],L=[],R=[],F=[],N=!1,M=[];M.SheetNames=A.snames,M.sharedf=A.sharedf,M.arrayf=A.arrayf,M.names=[],M.XTI=[];var z=0,G=0,H=0,j=[],K=[],ne;A.codepage=1200,ca(1200);for(var he=!1;t.l<t.length-1;){var le=t.l,fe=t.read_shift(2);if(fe===0&&z===10)break;var te=t.l===t.length?0:t.read_shift(2),Z=Xv[fe];if(Z&&Z.f){if(e.bookSheets&&z===133&&fe!==133)break;if(z=fe,Z.r===2||Z.r==12){var xe=t.read_shift(2);if(te-=2,!A.enc&&xe!==fe&&((xe&255)<<8|xe>>8)!==fe)throw new Error("rt mismatch: "+xe+"!="+fe);Z.r==12&&(t.l+=10,te-=10)}var Q={};if(fe===10?Q=Z.f(t,te,A):Q=Tse(fe,Z,t,te,A),G==0&&[9,521,1033,2057].indexOf(z)===-1)continue;switch(fe){case 34:r.opts.Date1904=w.WBProps.date1904=Q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(t.l=0),A.enc=Q,!e.password)throw new Error("File is password-protected");if(Q.valid==null)throw new Error("Encryption scheme unsupported");if(!Q.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=Q;break;case 66:var q=Number(Q);switch(q){case 21010:q=1200;break;case 32768:q=1e4;break;case 32769:q=1252;break}ca(A.codepage=q),he=!0;break;case 317:A.rrtabid=Q;break;case 25:A.winlocked=Q;break;case 439:r.opts.RefreshAll=Q;break;case 12:r.opts.CalcCount=Q;break;case 16:r.opts.CalcDelta=Q;break;case 17:r.opts.CalcIter=Q;break;case 13:r.opts.CalcMode=Q;break;case 14:r.opts.CalcPrecision=Q;break;case 95:r.opts.CalcSaveRecalc=Q;break;case 15:A.CalcRefMode=Q;break;case 2211:r.opts.FullCalc=Q;break;case 129:Q.fDialog&&(s["!type"]="dialog"),Q.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Q.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:D.push(Q);break;case 430:M.push([Q]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(Q);break;case 24:case 536:ne={Name:Q.Name,Ref:Hn(Q.rgce,a,null,M,A)},Q.itab>0&&(ne.Sheet=Q.itab-1),M.names.push(ne),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(Q),Q.Name=="_xlnm._FilterDatabase"&&Q.itab>0&&Q.rgce&&Q.rgce[0]&&Q.rgce[0][0]&&Q.rgce[0][0][0]=="PtgArea3d"&&(K[Q.itab-1]={ref:sr(Q.rgce[0][0][1][2])});break;case 22:A.ExternCount=Q;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(Q),M.XTI=M.XTI.concat(Q);break;case 2196:if(A.biff<8)break;ne!=null&&(ne.Comment=Q[1]);break;case 18:s["!protect"]=Q;break;case 19:Q!==0&&A.WTF&&console.error("Password verifier: "+Q);break;case 133:i[Q.pos]=Q,A.snames.push(Q.name);break;case 10:{if(--G)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=sr(a),e.sheetRows&&e.sheetRows<=a.e.r){var J=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=sr(a),a.e.r=J}a.e.r++,a.e.c++}U.length>0&&(s["!merges"]=U),L.length>0&&(s["!objects"]=L),R.length>0&&(s["!cols"]=R),F.length>0&&(s["!rows"]=F),w.Sheets.push(S)}c===""?u=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[fe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Q.BIFFVer]||8),A.biffguess=Q.BIFFVer==0,Q.BIFFVer==0&&Q.dt==4096&&(A.biff=5,he=!0,ca(A.codepage=28591)),A.biff==8&&Q.BIFFVer==0&&Q.dt==16&&(A.biff=2),G++)break;if(s=e.dense?[]:{},A.biff<8&&!he&&(he=!0,ca(A.codepage=e.codepage||1252)),A.biff<5||Q.BIFFVer==0&&Q.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var pe={pos:t.l-te,name:c};i[pe.pos]=pe,A.snames.push(c)}else c=(i[le]||{name:""}).name;Q.dt==32&&(s["!type"]="chart"),Q.dt==64&&(s["!type"]="macro"),U=[],L=[],A.arrayf=E=[],R=[],F=[],N=!1,S={Hidden:(i[le]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[Q.r]||[])[Q.c]:s[Nt({c:Q.c,r:Q.r})])&&++Q.c,x={ixfe:Q.ixfe,XF:D[Q.ixfe]||{},v:Q.val,t:"n"},H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_({c:Q.c,r:Q.r},x,e);break;case 5:case 517:x={ixfe:Q.ixfe,XF:D[Q.ixfe],v:Q.val,t:Q.t},H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_({c:Q.c,r:Q.r},x,e);break;case 638:x={ixfe:Q.ixfe,XF:D[Q.ixfe],v:Q.rknum,t:"n"},H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_({c:Q.c,r:Q.r},x,e);break;case 189:for(var ge=Q.c;ge<=Q.C;++ge){var ee=Q.rkrec[ge-Q.c][0];x={ixfe:ee,XF:D[ee],v:Q.rkrec[ge-Q.c][1],t:"n"},H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_({c:ge,r:Q.r},x,e)}break;case 6:case 518:case 1030:{if(Q.val=="String"){o=Q;break}if(x=t0(Q.val,Q.cell.ixfe,Q.tt),x.XF=D[x.ixfe],e.cellFormula){var ie=Q.formula;if(ie&&ie[0]&&ie[0][0]&&ie[0][0][0]=="PtgExp"){var ve=ie[0][0][1][0],we=ie[0][0][1][1],De=Nt({r:ve,c:we});b[De]?x.f=""+Hn(Q.formula,a,Q.cell,M,A):x.F=((e.dense?(s[ve]||[])[we]:s[De])||{}).F}else x.f=""+Hn(Q.formula,a,Q.cell,M,A)}H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_(Q.cell,x,e),o=Q}break;case 7:case 519:if(o)o.val=Q,x=t0(Q,o.cell.ixfe,"s"),x.XF=D[x.ixfe],e.cellFormula&&(x.f=""+Hn(o.formula,a,o.cell,M,A)),H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_(o.cell,x,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(Q);var Te=Nt(Q[0].s);if(p=e.dense?(s[Q[0].s.r]||[])[Q[0].s.c]:s[Te],e.cellFormula&&p){if(!o||!Te||!p)break;p.f=""+Hn(Q[1],a,Q[0],M,A),p.F=sr(Q[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!o)break;b[Nt(o.cell)]=Q[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Nt(o.cell)],(p||{}).f=""+Hn(Q[0],a,f,M,A)}}break;case 253:x=t0(l[Q.isst].t,Q.ixfe,"s"),l[Q.isst].h&&(x.h=l[Q.isst].h),x.XF=D[x.ixfe],H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_({c:Q.c,r:Q.r},x,e);break;case 513:e.sheetStubs&&(x={ixfe:Q.ixfe,XF:D[Q.ixfe],t:"z"},H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_({c:Q.c,r:Q.r},x,e));break;case 190:if(e.sheetStubs)for(var ze=Q.c;ze<=Q.C;++ze){var ke=Q.ixfe[ze-Q.c];x={ixfe:ke,XF:D[ke],t:"z"},H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_({c:ze,r:Q.r},x,e)}break;case 214:case 516:case 4:x=t0(Q.val,Q.ixfe,"s"),x.XF=D[x.ixfe],H>0&&(x.z=j[x.ixfe>>8&63]),Aa(x,e,r.opts.Date1904),_({c:Q.c,r:Q.r},x,e);break;case 0:case 512:G===1&&(a=Q);break;case 252:l=Q;break;case 1054:if(A.biff==4){j[H++]=Q[1];for(var Ve=0;Ve<H+163&&Bt[Ve]!=Q[1];++Ve);Ve>=163&&Wo(Q[1],H+163)}else Wo(Q[1],Q[0]);break;case 30:{j[H++]=Q;for(var Ae=0;Ae<H+163&&Bt[Ae]!=Q;++Ae);Ae>=163&&Wo(Q,H+163)}break;case 229:U=U.concat(Q);break;case 93:L[Q.cmo[0]]=A.lastobj=Q;break;case 438:A.lastobj.TxO=Q;break;case 127:A.lastobj.ImData=Q;break;case 440:for(y=Q[0].s.r;y<=Q[0].e.r;++y)for(g=Q[0].s.c;g<=Q[0].e.c;++g)p=e.dense?(s[y]||[])[g]:s[Nt({c:g,r:y})],p&&(p.l=Q[1]);break;case 2048:for(y=Q[0].s.r;y<=Q[0].e.r;++y)for(g=Q[0].s.c;g<=Q[0].e.c;++g)p=e.dense?(s[y]||[])[g]:s[Nt({c:g,r:y})],p&&p.l&&(p.l.Tooltip=Q[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;p=e.dense?(s[Q[0].r]||[])[Q[0].c]:s[Nt(Q[0])];var Ge=L[Q[2]];p||(e.dense?(s[Q[0].r]||(s[Q[0].r]=[]),p=s[Q[0].r][Q[0].c]={t:"z"}):p=s[Nt(Q[0])]={t:"z"},a.e.r=Math.max(a.e.r,Q[0].r),a.s.r=Math.min(a.s.r,Q[0].r),a.e.c=Math.max(a.e.c,Q[0].c),a.s.c=Math.min(a.s.c,Q[0].c)),p.c||(p.c=[]),v={a:Q[1],t:Ge.TxO.t},p.c.push(v)}break;case 2173:qee(D[Q.ixfe],Q.ext);break;case 125:{if(!A.cellStyles)break;for(;Q.e>=Q.s;)R[Q.e--]={width:Q.w/256,level:Q.level||0,hidden:!!(Q.flags&1)},N||(N=!0,yx(Q.w/256)),Dc(R[Q.e+1])}break;case 520:{var Ke={};Q.level!=null&&(F[Q.r]=Ke,Ke.level=Q.level),Q.hidden&&(F[Q.r]=Ke,Ke.hidden=!0),Q.hpt&&(F[Q.r]=Ke,Ke.hpt=Q.hpt,Ke.hpx=Pd(Q.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Ju(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[fe]]=Q;break;case 161:s["!margins"]||Ju(s["!margins"]={}),s["!margins"].header=Q.header,s["!margins"].footer=Q.footer;break;case 574:Q.RTL&&(w.Views[0].RTL=!0);break;case 146:P=Q;break;case 2198:k=Q;break;case 140:I=Q;break;case 442:c?S.CodeName=Q||S.name:w.WBProps.CodeName=Q||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+fe.toString(16)),t.l+=te}return r.SheetNames=Ua(i).sort(function(Ee,ye){return Number(Ee)-Number(ye)}).map(function(Ee){return i[Ee].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&K.forEach(function(Ee,ye){r.Sheets[r.SheetNames[ye]]["!autofilter"]=Ee}),r.Strings=l,r.SSF=Pn(Bt),A.enc&&(r.Encryption=A.enc),k&&(r.Themes=k),r.Metadata={},I!==void 0&&(r.Metadata.Country=I),M.names.length>0&&(w.Names=M.names),r.Workbook=w,r}var bS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Cse(t,e,r){var n=rr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=aS(n,GQ,bS.DSI);for(var i in s)e[i]=s[i]}catch(c){if(r.WTF)throw c}var a=rr.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=aS(a,WQ,bS.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(uk(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Kk(t,e){e||(e={}),Sx(e),bI(),e.codepage&&tx(e.codepage);var r,n;if(t.FullPaths){if(rr.find(t,"/encryption"))throw new Error("File is password-protected");r=rr.find(t,"!CompObj"),n=rr.find(t,"/Workbook")||rr.find(t,"/Book")}else{switch(e.type){case"base64":t=oa(Ps(t));break;case"binary":t=oa(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}An(t,0),n={content:t}}var s,i;if(r&&Sse(r),e.bookProps&&!e.bookSheets)s={};else{var a=Jt?"buffer":"array";if(n&&n.content)s=wse(n.content,e);else if((i=rr.find(t,"PerfectOffice_MAIN"))&&i.content)s=Yu.to_workbook(i.content,(e.type=a,e));else if((i=rr.find(t,"NativeContent_MAIN"))&&i.content)s=Yu.to_workbook(i.content,(e.type=a,e));else throw(i=rr.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&rr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=fte(t))}var o={};return t.FullPaths&&Cse(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var Dh={0:{f:lne},1:{f:fne},2:{f:_ne},3:{f:gne},4:{f:pne},5:{f:Ene},6:{f:Ane},7:{f:yne},8:{f:kne},9:{f:Ine},10:{f:wne},11:{f:Cne},12:{f:hne},13:{f:bne},14:{f:vne},15:{f:mne},16:{f:Hk},17:{f:Tne},18:{f:xne},19:{f:fx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:rse},40:{},42:{},43:{f:wee},44:{f:Tee},45:{f:Cee},46:{f:kee},47:{f:Iee},48:{},49:{f:DQ},50:{},51:{f:Yee},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:bk},62:{f:Sne},63:{f:tte},64:{f:Bne},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Lne},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:dne},148:{f:cne,p:16},151:{f:Rne},152:{},153:{f:ese},154:{},155:{},156:{f:Zne},157:{},158:{},159:{T:1,f:WZ},160:{T:-1},161:{T:1,f:xl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Dne},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Xee},336:{T:-1},337:{f:Qee,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Gv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_k},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Fne},427:{f:Nne},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Mne},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:une},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Pne},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Gv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cte},633:{T:1},634:{T:-1},635:{T:1,f:lte},636:{T:-1},637:{f:RQ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Gne},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Une},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Xv={6:{f:yg},10:{f:Ui},12:{f:Zr},13:{f:Zr},14:{f:Wr},15:{f:Wr},16:{f:Wn},17:{f:Wr},18:{f:Wr},19:{f:Zr},20:{f:cS},21:{f:cS},23:{f:_k},24:{f:dS},25:{f:Wr},26:{},27:{},28:{f:iZ},29:{},34:{f:Wr},35:{f:uS},38:{f:Wn},39:{f:Wn},40:{f:Wn},41:{f:Wn},42:{f:Wr},43:{f:Wr},47:{f:uee},49:{f:VJ},51:{f:Zr},60:{},61:{f:BJ},64:{f:Wr},65:{f:$J},66:{f:Zr},77:{},80:{},81:{},82:{},85:{f:Zr},89:{},90:{},91:{},92:{f:DJ},93:{f:lZ},94:{},95:{f:Wr},96:{},97:{},99:{f:Wr},125:{f:bk},128:{f:QJ},129:{f:PJ},130:{f:Zr},131:{f:Wr},132:{f:Wr},133:{f:RJ},134:{},140:{f:pZ},141:{f:Zr},144:{},146:{f:gZ},151:{},152:{},153:{},154:{},155:{},156:{f:Zr},157:{},158:{},160:{f:_Z},161:{f:yZ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KJ},190:{f:qJ},193:{f:Ui},197:{},198:{},199:{},200:{},201:{},202:{f:Wr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zr},220:{},221:{f:Wr},222:{},224:{f:YJ},225:{f:kJ},226:{f:Ui},227:{},229:{f:oZ},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:FJ},253:{f:HJ},255:{f:NJ},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:mk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Wr},353:{f:Ui},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:ZJ},431:{f:Wr},432:{},433:{},434:{},437:{},438:{f:dZ},439:{f:Wr},440:{f:fZ},441:{},442:{f:lf},443:{},444:{f:Zr},445:{},446:{},448:{f:Ui},449:{f:LJ,r:2},450:{f:Ui},512:{f:oS},513:{f:EZ},515:{f:JJ},516:{f:jJ},517:{f:lS},519:{f:bZ},520:{f:OJ},523:{},545:{f:fS},549:{f:iS},566:{},574:{f:UJ},638:{f:zJ},659:{},1048:{},1054:{f:GJ},1084:{},1212:{f:nZ},2048:{f:hZ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Jf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ui},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vZ,r:12},2173:{f:Kee,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Wr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:rZ,r:12},2197:{},2198:{f:Vee,r:12},2199:{},2200:{},2201:{},2202:{f:sZ,r:12},2203:{f:Ui},2204:{},2205:{},2206:{},2207:{},2211:{f:MJ},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:xZ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mZ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:oS},1:{},2:{f:wZ},3:{f:TZ},4:{f:AZ},5:{f:lS},7:{f:CZ},8:{},9:{f:Jf},11:{},22:{f:Zr},30:{f:WJ},31:{},32:{},33:{f:fS},36:{},37:{f:iS},50:{f:IZ},62:{},52:{},67:{},68:{f:Zr},69:{},86:{},126:{},127:{f:SZ},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:kZ},223:{},234:{},354:{},421:{},518:{f:yg},521:{f:Jf},536:{f:dS},547:{f:uS},561:{},579:{},1030:{f:yg},1033:{f:Jf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ea(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&rk(r)&&t.push(r)}}function SS(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=JY(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<l.length;++a){var g=l[a].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var b=g.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var E=b[o].trim();if(E.match(/<t[dh]/i)){for(var x=E,I=0;x.charAt(0)=="<"&&(I=x.indexOf(">"))>-1;)x=x.slice(I+1);for(var D=0;D<v.length;++D){var P=v[D];P.s.c==u&&P.s.r<c&&c<=P.e.r&&(u=P.e.c+1,D=-1)}var w=Ct(E.slice(0,E.indexOf(">")));h=w.colspan?+w.colspan:1,((f=+w.rowspan)>1||h>1)&&v.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var S=w.t||w["data-t"]||"";if(!x.length){u+=h;continue}if(x=jI(x),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!x.length){u+=h;continue}var m={t:"s",v:x};r.raw||!x.trim().length||S=="s"||(x==="TRUE"?m={t:"b",v:!0}:x==="FALSE"?m={t:"b",v:!1}:isNaN(ha(x))?isNaN(kc(x).getDate())||(m={t:"d",v:vn(x)},r.cellDates||(m={t:"n",v:fs(m.v)}),m.z=r.dateNF||Bt[14]):m={t:"n",v:ha(x)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=m):n[Nt({r:c,c:u})]=m,u+=h}}}}return n["!ref"]=sr(p),v.length&&(n["!merges"]=v),n}function Ise(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Nt({r,c:a}),f=n.dense?(t[r]||[])[a]:t[u],h=f&&f.v!=null&&(f.h||ox(f.w||(Ti(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,i.push(pQ("td",h,p))}}var v="<tr>";return v+i.join("")+"</tr>"}var kse='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Dse="</body></html>";function Pse(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return _o(SS(r[0],e),e);var n=Tx();return r.forEach(function(s,i){wx(n,SS(s,e),"Sheet"+(i+1))}),n}function Rse(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Fse(t,e){var r=e||{},n=r.header!=null?r.header:kse,s=r.footer!=null?r.footer:Dse,i=[n],a=Gc(t["!ref"]);r.dense=Array.isArray(t),i.push(Rse(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(Ise(t,a,o,r));return i.push("</table>"+s),i.join("")}function qk(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?cs(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var u=Gc(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var f=[],h=0,p=t["!rows"]||(t["!rows"]=[]),v=0,g=0,y=0,b=0,E=0,x=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&g<l;++v){var I=o[v];if(AS(I)){if(n.display)continue;p[g]={hidden:!0}}var D=I.children;for(y=b=0;y<D.length;++y){var P=D[y];if(!(n.display&&AS(P))){var w=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):jI(P.innerHTML),S=P.getAttribute("data-z")||P.getAttribute("z");for(h=0;h<f.length;++h){var m=f[h];m.s.c==b+i&&m.s.r<g+s&&g+s<=m.e.r&&(b=m.e.c+1-i,h=-1)}x=+P.getAttribute("colspan")||1,((E=+P.getAttribute("rowspan")||1)>1||x>1)&&f.push({s:{r:g+s,c:b+i},e:{r:g+s+(E||1)-1,c:b+i+(x||1)-1}});var T={t:"s",v:w},_=P.getAttribute("data-t")||P.getAttribute("t")||"";w!=null&&(w.length==0?T.t=_||"z":n.raw||w.trim().length==0||_=="s"||(w==="TRUE"?T={t:"b",v:!0}:w==="FALSE"?T={t:"b",v:!1}:isNaN(ha(w))?isNaN(kc(w).getDate())||(T={t:"d",v:vn(w)},n.cellDates||(T={t:"n",v:fs(T.v)}),T.z=n.dateNF||Bt[14]):T={t:"n",v:ha(w)})),T.z===void 0&&S!=null&&(T.z=S);var A="",k=P.getElementsByTagName("A");if(k&&k.length)for(var U=0;U<k.length&&!(k[U].hasAttribute("href")&&(A=k[U].getAttribute("href"),A.charAt(0)!="#"));++U);A&&A.charAt(0)!="#"&&(T.l={Target:A}),n.dense?(t[g+s]||(t[g+s]=[]),t[g+s][b+i]=T):t[Nt({c:b+i,r:g+s})]=T,c.e.c<b+i&&(c.e.c=b+i),b+=x}}++g}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,g-1+s),t["!ref"]=sr(c),g>=l&&(t["!fullref"]=sr((c.e.r=o.length-v+g-1+s,c))),t}function Xk(t,e){var r=e||{},n=r.dense?[]:{};return qk(n,t,e)}function Nse(t,e){return _o(Xk(t,e),e)}function AS(t){var e="",r=Ose(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Ose(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Mse(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ar(e.replace(/<[^>]*>/g,""));return[r]}var TS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Yk(t,e){var r=e||{},n=lx(t),s=[],i,a,o={name:""},l="",c=0,u,f,h={},p=[],v=r.dense?[]:{},g,y,b={value:""},E="",x=0,I=[],D=-1,P=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,m={},T=[],_={},A=0,k=0,U=[],L=1,R=1,F=[],N={Names:[]},M={},z=["",""],G=[],H={},j="",K=0,ne=!1,he=!1,le=0;for(Id.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Id.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?v["!ref"]=sr(w):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(v["!fullref"]=v["!ref"],w.e.r=r.sheetRows-1,v["!ref"]=sr(w)),T.length&&(v["!merges"]=T),U.length&&(v["!rows"]=U),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),h[u.name]=v,he=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Ct(g[0],!1),D=P=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,v=r.dense?[]:{},T=[],U=[],he=!0);break;case"table-row-group":g[1]==="/"?--S:++S;break;case"table-row":case"":if(g[1]==="/"){D+=L,L=1;break}if(f=Ct(g[0],!1),f.?D=f.-1:D==-1&&(D=0),L=+f["number-rows-repeated"]||1,L<10)for(le=0;le<L;++le)S>0&&(U[D+le]={level:S});P=-1;break;case"covered-table-cell":g[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(v[D]||(v[D]=[]),v[D][P]={t:"z"}):v[Nt({r:D,c:P})]={t:"z"}),E="",I=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++P,b=Ct(g[0],!1),R=parseInt(b["number-columns-repeated"]||"1",10),y={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(y.f=xS(ar(b.formula))),(b.||b["value-type"])=="string"&&(y.t="s",y.v=ar(b["string-value"]||""),r.dense?(v[D]||(v[D]=[]),v[D][P]=y):v[Nt({r:D,c:P})]=y),P+=R-1;else if(g[1]!=="/"){++P,E="",x=0,I=[],R=1;var fe=L?D+L-1:D;if(P>w.e.c&&(w.e.c=P),P<w.s.c&&(w.s.c=P),D<w.s.r&&(w.s.r=D),fe>w.e.r&&(w.e.r=fe),b=Ct(g[0],!1),G=[],H={},y={t:b.||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=ar(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(A=parseInt(b["number-matrix-rows-spanned"],10)||0,k=parseInt(b["number-matrix-columns-spanned"],10)||0,_={s:{r:D,c:P},e:{r:D+A-1,c:P+k-1}},y.F=sr(_),F.push([_,y.F])),b.formula)y.f=xS(b.formula);else for(le=0;le<F.length;++le)D>=F[le][0].s.r&&D<=F[le][0].e.r&&P>=F[le][0].s.c&&P<=F[le][0].e.c&&(y.F=F[le][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(A=parseInt(b["number-rows-spanned"],10)||0,k=parseInt(b["number-columns-spanned"],10)||0,_={s:{r:D,c:P},e:{r:D+A-1,c:P+k-1}},T.push(_)),b["number-columns-repeated"]&&(R=parseInt(b["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Dr(b["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(b.value);break;case"percentage":y.t="n",y.v=parseFloat(b.value);break;case"currency":y.t="n",y.v=parseFloat(b.value);break;case"date":y.t="d",y.v=vn(b["date-value"]),r.cellDates||(y.t="n",y.v=fs(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=XY(b["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Bp(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(b.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",b["string-value"]!=null&&(E=ar(b["string-value"]),I=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(ne=!1,y.t==="s"&&(y.v=E||"",I.length&&(y.R=I),ne=x==0),M.Target&&(y.l=M),G.length>0&&(y.c=G,G=[]),E&&r.cellText!==!1&&(y.w=E),ne&&(y.t="z",delete y.v),(!ne||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var te=0;te<L;++te){if(R=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(v[D+te]||(v[D+te]=[]),v[D+te][P]=te==0?y:Pn(y);--R>0;)v[D+te][P+R]=Pn(y);else for(v[Nt({r:D+te,c:P})]=y;--R>0;)v[Nt({r:D+te,c:P+R})]=Pn(y);w.e.c<=P&&(w.e.c=P)}R=parseInt(b["number-columns-repeated"]||"1",10),P+=R-1,R=0,y={},E="",I=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i;H.t=E,I.length&&(H.R=I),H.a=j,G.push(H)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);j="",K=0,E="",x=0,I=[];break;case"creator":g[1]==="/"?j=n.slice(K,g.index):K=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);E="",x=0,I=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(m[o.name]=l,(i=s.pop())[0]!==g[3])throw"Bad state: "+i}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=Ct(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Ct(g[0],!1),l+=TS[g[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=Ct(g[0],!1),l+=TS[g[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,g.index);break}else c=g.index+g[0].length;break;case"named-range":a=Ct(g[0],!1),z=xg(a["cell-range-address"]);var Z={Name:a.name,Ref:z[0]+"!"+z[1]};he&&(Z.Sheet=p.length),N.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!b||!b["string-value"])){var xe=Mse(n.slice(x,g.index));E=(E.length>0?E+`
`:"")+xe[0]}else Ct(g[0],!1),x=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{z=xg(Ct(g[0])["target-range-address"]),h[z[0]]["!autofilter"]={ref:z[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(M=Ct(g[0],!1),!M.href)break;M.Target=ar(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(z=xg(M.Target.slice(1)),M.Target="#"+z[0]+"!"+z[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var Q={Sheets:h,SheetNames:p,Workbook:N};return r.bookSheets&&delete Q.Sheets,Q}function wS(t,e){e=e||{},Us(t,"META-INF/manifest.xml")&&JQ(Jr(t,"META-INF/manifest.xml"),e);var r=ws(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Yk(Sr(r),e);return Us(t,"meta.xml")&&(n.Props=ck(Jr(t,"meta.xml"))),n}function CS(t,e){return Yk(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _x(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Yv(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Sr(vl(t))}function Qv(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function IS(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function Lse(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Rd(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function un(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Xn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Rd(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Rd(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function bx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function Bse(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Rd(t,n),i=Xn(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:un(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Xn(o.data),c=un(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=un(i[3][0].data)>>>0>0),r.push(a)}return r}function Use(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Rd(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Qv(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Qv(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function $se(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(Use(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Qv(e)}function Vse(t,e,r,n){var s=_x(t),i=s.getUint32(4,!0),a=(n>1?12:8)+IS(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=IS(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(c=s.getFloat64(a,!0),a+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:e[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function Hse(t,e,r){var n=_x(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=Lse(t,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:e[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return f}function jse(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Vse(t,e,r,t[0]);case 5:return Hse(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ao(t){var e=Xn(t);return Rd(e[1][0].data)}function kS(t,e){var r=Xn(e.data),n=un(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Xn(a.data),l=un(o[1][0].data)>>>0;switch(n){case 1:i[l]=Yv(o[3][0].data);break;case 8:{var c=t[ao(o[9][0].data)][0],u=Xn(c.data),f=t[ao(u[1][0].data)][0],h=un(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Xn(f.data);i[l]=p[3].map(function(v){return Yv(v.data)}).join("")}break}}),i}function Gse(t,e){var r,n,s,i,a,o,l,c,u,f,h,p,v,g,y=Xn(t),b=un(y[1][0].data)>>>0,E=un(y[2][0].data)>>>0,x=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&un(y[8][0].data)>0||!1,I,D;if((i=(s=y[7])==null?void 0:s[0])!=null&&i.data&&e!=0)I=(o=(a=y[7])==null?void 0:a[0])==null?void 0:o.data,D=(c=(l=y[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=y[4])==null?void 0:u[0])!=null&&f.data&&e!=1)I=(p=(h=y[4])==null?void 0:h[0])==null?void 0:p.data,D=(g=(v=y[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var P=x?4:1,w=_x(I),S=[],m=0;m<I.length/2;++m){var T=w.getUint16(m*2,!0);T<65535&&S.push([m,T])}if(S.length!=E)throw"Expected ".concat(E," cells, found ").concat(S.length);var _=[];for(m=0;m<S.length-1;++m)_[S[m][0]]=D.subarray(S[m][1]*P,S[m+1][1]*P);return S.length>=1&&(_[S[S.length-1][0]]=D.subarray(S[S.length-1][1]*P)),{R:b,cells:_}}function Wse(t,e){var r,n=Xn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?un(n[7][0].data)>>>0>0?1:0:-1,i=bx(n[5],function(a){return Gse(a,s)});return{nrows:un(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function zse(t,e,r){var n,s=Xn(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(un(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(un(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=sr(i);var a=Xn(s[4][0].data),o=kS(t,t[ao(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?kS(t,t[ao(a[17][0].data)][0]):[],c=Xn(a[3][0].data),u=0;c[1].forEach(function(f){var h=Xn(f.data),p=t[ao(h[2][0].data)][0],v=un(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=Wse(t,p);g.data.forEach(function(y,b){y.forEach(function(E,x){var I=Nt({r:u+b,c:x}),D=jse(E,o,l);D&&(r[I]=D)})}),u+=g.nrows})}function Kse(t,e){var r=Xn(e.data),n={"!ref":"A1"},s=t[ao(r[2][0].data)],i=un(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return zse(t,s[0],n),n}function qse(t,e){var r,n=Xn(e.data),s={name:(r=n[1])!=null&&r[0]?Yv(n[1][0].data):"",sheets:[]},i=bx(n[2],ao);return i.forEach(function(a){t[a].forEach(function(o){var l=un(o.meta[1][0].data);l==6e3&&s.sheets.push(Kse(t,o))})}),s}function Xse(t,e){var r=Tx(),n=Xn(e.data),s=bx(n[1],ao);if(s.forEach(function(i){t[i].forEach(function(a){var o=un(a.meta[1][0].data);if(o==2){var l=qse(t,a);l.sheets.forEach(function(c,u){wx(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function _g(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=$se(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=Bse(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&un(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(c){var u=un(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Xse(i,o)}function Yse(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Sx(t){Yse([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Qse(t){return ql.WS.indexOf(t)>-1?"sheet":t==ql.CS?"chart":t==ql.DS?"dialog":t==ql.MS?"macro":t&&t.length?t:"sheet"}function Jse(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Qse(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Zse(t,e,r,n,s,i,a,o,l,c,u,f){try{i[n]=qu(ws(t,r,!0),e);var h=Jr(t,e),p;switch(o){case"sheet":p=ase(h,e,s,l,i[n],c,u,f);break;case"chart":if(p=ise(h,e,s,l,i[n],c,u,f),!p||!p["!drawel"])break;var v=bu(p["!drawel"].Target,e),g=Wv(v),y=ste(ws(t,v,!0),qu(ws(t,g,!0),v)),b=bu(y,v),E=Wv(b);p=Hne(ws(t,b,!0),b,l,qu(ws(t,E,!0),b),c,p);break;case"macro":p=ose(h,e,s,l,i[n],c,u,f);break;case"dialog":p=lse(h,e,s,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var x=[];i&&i[n]&&Ua(i[n]).forEach(function(I){var D="";if(i[n][I].Type==ql.CMNT){D=bu(i[n][I].Target,e);var P=fse(Jr(t,D,!0),D,l);if(!P||!P.length)return;pS(p,P,!1)}i[n][I].Type==ql.TCMNT&&(D=bu(i[n][I].Target,e),x=x.concat(ite(Jr(t,D,!0),l)))}),x&&x.length&&pS(p,x,!0,l.people||[])}catch(I){if(l.WTF)throw I}}function Ms(t){return t.charAt(0)=="/"?t.slice(1):t}function eae(t,e){if(NI(),e=e||{},Sx(e),Us(t,"META-INF/manifest.xml")||Us(t,"objectdata.xml"))return wS(t,e);if(Us(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof _g<"u"){if(t.FileIndex)return _g(t);var r=rr.utils.cfb_new();return Vb(t).forEach(function(U){tQ(r,U,eQ(t,U))}),_g(r)}throw new Error("Unsupported NUMBERS file")}if(!Us(t,"[Content_Types].xml"))throw Us(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Us(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Vb(t),s=YQ(ws(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Jr(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Jr(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(Qu=[],s.sst)try{Qu=dse(Jr(t,Ms(s.sst)),s.sst,e)}catch(U){if(e.WTF)throw U}e.cellStyles&&s.themes.length&&(l=use(ws(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=cse(Jr(t,Ms(s.style)),s.style,l,e))}s.links.map(function(U){try{var L=qu(ws(t,Wv(Ms(U))),U);return pse(Jr(t,Ms(U)),L,U,e)}catch{}});var u=sse(Jr(t,Ms(s.workbooks[0])),s.workbooks[0],e),f={},h="";s.coreprops.length&&(h=Jr(t,Ms(s.coreprops[0]),!0),h&&(f=ck(h)),s.extprops.length!==0&&(h=Jr(t,Ms(s.extprops[0]),!0),h&&tJ(h,f,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(h=ws(t,Ms(s.custprops[0]),!0),h&&(p=nJ(h,e)));var v={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(L){return L.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),e.bookProps&&(v.Props=f,v.Custprops=p),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var g={};e.bookDeps&&s.calcchain&&(g=hse(Jr(t,Ms(s.calcchain)),s.calcchain));var y=0,b={},E,x;{var I=u.Sheets;f.Worksheets=I.length,f.SheetNames=[];for(var D=0;D!=I.length;++D)f.SheetNames[D]=I[D].name}var P=i?"bin":"xml",w=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,w+1)+"_rels/"+s.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");Us(t,S)||(S="xl/_rels/workbook."+P+".rels");var m=qu(ws(t,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=mse(Jr(t,Ms(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=ote(Jr(t,Ms(s.people[0])),e)),m&&(m=Jse(m,u.Sheets));var T=Jr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var _="sheet";if(m&&m[y]?(E="xl/"+m[y][1].replace(/[\/]?xl\//,""),Us(t,E)||(E=m[y][1]),Us(t,E)||(E=S.replace(/_rels\/.*$/,"")+m[y][1]),_=m[y][2]):(E="xl/worksheets/sheet"+(y+1-T)+"."+P,E=E.replace(/sheet0\./,"sheet.")),x=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(y!=e.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var A=!1,k=0;k!=e.sheets.length;++k)typeof e.sheets[k]=="number"&&e.sheets[k]==y&&(A=1),typeof e.sheets[k]=="string"&&e.sheets[k].toLowerCase()==f.SheetNames[y].toLowerCase()&&(A=1);if(!A)continue e}}Zse(t,E,x,f.SheetNames[y],y,b,a,_,e,u,l,c)}return v={Directory:s,Workbook:u,Props:f,Custprops:p,Deps:g,Sheets:a,SheetNames:f.SheetNames,Strings:Qu,Styles:c,Themes:l,SSF:Pn(Bt)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(U,L){U=U.replace(/^Root Entry[\/]/,""),v.keys.push(U),v.files[U]=t.FileIndex[L]}))),e&&e.bookVBA&&(s.vba.length>0?v.vbaraw=Jr(t,Ms(s.vba[0]),!0):s.defaults&&s.defaults.bin===dte&&(v.vbaraw=Jr(t,"xl/vbaProject.bin",!0))),v}function tae(t,e){var r=e||{},n="Workbook",s=rr.find(t,n);try{if(n="/!DataSpaces/Version",s=rr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(KZ(s.content),n="/!DataSpaces/DataSpaceMap",s=rr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=XZ(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=rr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=YZ(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=rr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);JZ(s.content)}catch{}if(n="/EncryptionInfo",s=rr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=ZZ(s.content);if(n="/EncryptedPackage",s=rr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Ax(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ps(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function rae(t,e){return rr.find(t,"EncryptedPackage")?tae(t,e):Kk(t,e)}function nae(t,e){var r,n=t,s=e||{};return s.type||(s.type=Jt&&Buffer.isBuffer(t)?"buffer":"base64"),r=$I(n,s),eae(r,s)}function Qk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return qv(t.slice(r),e);default:break e}return kd.to_workbook(t,e)}function sae(t,e){var r="",n=Ax(t,e);switch(e.type){case"base64":r=Ps(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=al(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Sr(r)),e.type="binary",Qk(r,e)}function aae(t,e){var r=t;return e.type=="base64"&&(r=Ps(r)),r=Td.utils.decode(1200,r.slice(2),"str"),e.type="binary",Qk(r,e)}function iae(t){return t.match(/[^\x00-\x7F]/)?Su(t):t}function bg(t,e,r,n){return n?(r.type="string",kd.to_workbook(t,r)):kd.to_workbook(e,r)}function Ph(t,e){bI();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Ph(new Uint8Array(t),(r=Pn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),hc={},r.dateNF&&(hc.dateNF=r.dateNF),r.type||(r.type=Jt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Jt?"buffer":"binary",n=KY(t),typeof Uint8Array<"u"&&!Jt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=iae(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Pn(r),r.type="array",Ph(rx(n),r)}switch((s=Ax(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return rae(rr.read(n,r),r);break;case 9:if(s[1]<=8)return Kk(n,r);break;case 60:return qv(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return NZ(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return RZ.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?nae(n,r):bg(t,n,r,i);case 239:return s[3]===60?qv(n,r):bg(t,n,r,i);case 255:if(s[1]===254)return aae(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Yu.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Yu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return hS.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return dee.to_workbook(n,r);break;case 10:case 13:case 32:return sae(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DZ.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?hS.to_workbook(n,r):bg(t,n,r,i)}function oae(t,e,r,n,s,i,a,o){var l=Rn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var v=a?t[r][p]:t[n[p]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;i[p]!=null&&(h[i[p]]=c);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(i[p]!=null){if(g==null)if(v.t=="e"&&g===null)h[i[p]]=null;else if(c!==void 0)h[i[p]]=c;else if(u&&g===null)h[i[p]]=null;else continue;else h[i[p]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?g:Ti(v,g,o);g!=null&&(f=!1)}}return{row:h,isempty:f}}function Jv(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=jr(u);break;case"number":l=jr(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var f=Rn(l.s.r),h=[],p=[],v=0,g=0,y=Array.isArray(t),b=l.s.r,E=0,x={};y&&!t[b]&&(t[b]=[]);var I=c.skipHidden&&t["!cols"]||[],D=c.skipHidden&&t["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(I[E]||{}).hidden)switch(h[E]=cn(E),r=y?t[b][E]:t[h[E]+f],n){case 1:i[E]=E-l.s.c;break;case 2:i[E]=h[E];break;case 3:i[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ti(r,null,c),g=x[a]||0,!g)x[a]=1;else{do o=a+"_"+g++;while(x[o]);x[a]=g,x[o]=1}i[E]=o}for(b=l.s.r+s;b<=l.e.r;++b)if(!(D[b]||{}).hidden){var P=oae(t,l,b,h,n,i,y,c);(P.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[v++]=P.row)}return p.length=v,p}var DS=/"/g;function lae(t,e,r,n,s,i,a,o){for(var l=!0,c=[],u="",f=Rn(r),h=e.s.c;h<=e.e.c;++h)if(n[h]){var p=o.dense?(t[r]||[])[h]:t[n[h]+f];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:Ti(p,null,o));for(var v=0,g=0;v!==u.length;++v)if((g=u.charCodeAt(v))===s||g===i||g===34||o.forceQuotes){u='"'+u.replace(DS,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(DS,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function Jk(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=jr(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(t);for(var h=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(h[v]||{}).hidden||(f[v]=cn(v));for(var g=0,y=s.s.r;y<=s.e.r;++y)(p[y]||{}).hidden||(u=lae(t,s,y,f,a,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function cae(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Jk(t,e);return r}function uae(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=jr(t["!ref"]),i="",a=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=cn(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=Rn(u),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function Zk(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?cs(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var f=jr(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+e.length-1+s)}else a==-1&&(a=0,u.e.r=e.length-1+s);var h=n.header||[],p=0;e.forEach(function(g,y){Ua(g).forEach(function(b){(p=h.indexOf(b))==-1&&(h[p=h.length]=b);var E=g[b],x="z",I="",D=Nt({c:o+p,r:a+y+s});c=Fd(i,D),E&&typeof E=="object"&&!(E instanceof Date)?i[D]=E:(typeof E=="number"?x="n":typeof E=="boolean"?x="b":typeof E=="string"?x="s":E instanceof Date?(x="d",n.cellDates||(x="n",E=fs(E)),I=n.dateNF||Bt[14]):E===null&&n.nullError&&(x="e",E=0),c?(c.t=x,c.v=E,delete c.w,delete c.R,I&&(c.z=I)):i[D]=c={t:x,v:E},I&&(c.z=I))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var v=Rn(a);if(s)for(p=0;p<h.length;++p)i[cn(p+o)+v]={t:"s",v:h[p]};return i["!ref"]=sr(u),i}function dae(t,e){return Zk(null,t,e)}function Fd(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=cs(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Fd(t,Nt(e)):Fd(t,Nt({r:e,c:r||0}))}function fae(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Tx(){return{SheetNames:[],Sheets:{}}}function wx(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(Yne(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function hae(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=fae(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function pae(t,e){return t.z=e,t}function eD(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function mae(t,e,r){return eD(t,"#"+e,r)}function gae(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function vae(t,e,r,n){for(var s=typeof e!="string"?e:jr(e),i=typeof e=="string"?e:sr(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=Fd(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var yae={encode_col:cn,encode_row:Rn,encode_cell:Nt,encode_range:sr,decode_col:dx,decode_row:ux,split_cell:kQ,decode_cell:cs,decode_range:Gc,format_cell:Ti,sheet_add_aoa:sk,sheet_add_json:Zk,sheet_add_dom:qk,aoa_to_sheet:Wc,json_to_sheet:dae,table_to_sheet:Xk,table_to_book:Nse,sheet_to_csv:Jk,sheet_to_txt:cae,sheet_to_json:Jv,sheet_to_html:Fse,sheet_to_formulae:uae,sheet_to_row_object_array:Jv,sheet_get_cell:Fd,book_new:Tx,book_append_sheet:wx,book_set_sheet_visibility:hae,cell_set_number_format:pae,cell_set_hyperlink:eD,cell_set_internal_link:mae,cell_add_comment:gae,sheet_set_array_formula:vae,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const xae={class:"admin-time-table"},Eae={class:"header"},_ae={class:"admin-action-btns"},bae=["disabled"],Sae={class:"import-section"},Aae={key:0,class:"import-preview"},Tae={class:"import-options"},wae={class:"import-option-group"},Cae=["disabled"],Iae=["value"],kae={class:"import-option-group"},Dae=["disabled"],Pae={class:"import-actions"},Rae=["disabled"],Fae={class:"content"},Nae={key:0,class:"loading"},Oae={key:1,class:"time-tables-container"},Mae={key:0,class:"empty-state"},Lae={key:1,class:"time-tables-list"},Bae={class:"time-table-header"},Uae={class:"time-table-info"},$ae={class:"time-table-days"},Vae={class:"admin-action-btns"},Hae=["onClick"],jae=["onClick"],Gae={class:"time-table-schedule"},Wae={class:"schedule-item-info"},zae={class:"item-name"},Kae={class:"item-time"},qae={class:"schedule-item-type"},Xae={class:"dialog-header"},Yae={class:"dialog-content"},Qae={class:"form-group"},Jae={class:"form-group"},Zae={class:"days-checkboxes"},eie=["value"],tie={class:"form-group"},rie={class:"schedule-items"},nie={class:"item-row"},sie=["onUpdate:modelValue"],aie=["onUpdate:modelValue"],iie=["onUpdate:modelValue"],oie=["onUpdate:modelValue"],lie=["onClick"],cie={__name:"AdminTimeTable",setup(t){const{saveAppSettings:e}=qs(),r=se(!0),n=se(!1),s=se([]),i=se(!1),a=se(-1),o=se({name:"",days:[],schedule:[]}),l=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}],c=se(null),u=se([]),f=se([]),h=se("overwrite"),p=se(""),v=se(""),g=be(()=>h.value==="overwrite"?p.value!=="":v.value.trim()!==""),y=()=>{const F=mn(o.value.name,{trim:!0,maxLength:100,removeDangerous:!0}),N=qr(F);if(!N.isSafe)return alert(`Security threat detected in time table name: ${N.threats.join(", ")}`),!1;if(o.value.name=F,!o.value.name.trim())return alert("Please enter a time table name"),!1;if(o.value.days.length===0)return alert("Please select at least one day"),!1;if(o.value.schedule.length===0)return alert("Please add at least one schedule item"),!1;for(let M=0;M<o.value.schedule.length;M++){const z=o.value.schedule[M],G=mn(z.name,{trim:!0,maxLength:50,removeDangerous:!0}),H=qr(G);if(!H.isSafe)return alert(`Security threat detected in schedule item ${M+1}: ${H.threats.join(", ")}`),!1;if(z.name=G,!z.name.trim())return alert(`Please enter a name for schedule item ${M+1}`),!1;if(!z.startTime||!z.endTime)return alert(`Please enter start and end times for ${z.name}`),!1;if(z.startTime>=z.endTime)return alert(`${z.name}: Start time must be before end time`),!1}return!0},b=F=>{const N=mn(F,{trim:!0,maxLength:100,removeDangerous:!0}),M=qr(N);return M.isSafe?N:(alert(`Security threat detected in import name: ${M.threats.join(", ")}`),null)};async function E(){try{console.log("Loading time tables..."),r.value=!0;const F=await nr(Ze(qe,"app_settings","global"));if(F.exists()){const N=F.data();s.value=N.timeTables||[],console.log("Loaded time tables:",s.value)}else s.value=[],console.log("No time tables found, starting with empty array");r.value=!1}catch(F){console.error("Error loading time tables:",F),r.value=!1}}function x(){a.value=-1,o.value={name:"",days:[],schedule:[]},i.value=!0}function I(F){a.value=F,o.value=JSON.parse(JSON.stringify(s.value[F])),i.value=!0}function D(F){confirm("Are you sure you want to delete this time table?")&&s.value.splice(F,1)}function P(){o.value.schedule.push({name:"",type:"period",startTime:"",endTime:""})}function w(F){o.value.schedule.splice(F,1)}function S(){if(!y())return;if(!Is("saveTimeTable",10,6e4).allowed){alert("Too many save requests. Please wait before saving again.");return}a.value===-1?s.value.push(JSON.parse(JSON.stringify(o.value))):s.value[a.value]=JSON.parse(JSON.stringify(o.value)),m()}function m(){i.value=!1,a.value=-1,o.value={name:"",days:[],schedule:[]}}async function T(){try{if(!Is("saveAllTimeTables",5,3e5).allowed){alert("Too many save all requests. Please wait before saving again.");return}n.value=!0,console.log("Saving time tables:",s.value);const N=await nr(Ze(qe,"app_settings","global")),z={...N.exists()?N.data():{},timeTables:s.value};await e(z),n.value=!1,console.log("Time tables saved successfully")}catch(F){console.error("Error saving time tables:",F),n.value=!1}}function _(F){return F.length===0?"No days selected":F.length===7?"Every day":F.length===5&&F.includes("monday")&&F.includes("friday")?"Weekdays":F.map(N=>{const M=l.find(z=>z.value===N);return M?M.label:N}).join(", ")}function A(F){if(!F)return"";const[N,M]=F.split(":"),z=parseInt(N),G=z>=12?"PM":"AM";return`${z===0?12:z>12?z-12:z}:${M} ${G}`}function k(){c.value&&c.value.click()}function U(F){const N=F.target.files[0];if(!N)return;const M=Hc(N,{allowedTypes:["csv","excel"],maxSize:5*1024*1024,fieldName:"Time Table Import File"});if(!M.isValid){alert(M.error),F.target.value="";return}const z=qr(N.name);if(!z.isSafe){alert(`File name contains potentially dangerous content: ${z.threats.join(", ")}`),F.target.value="";return}const G=new FileReader;G.onload=H=>{try{let j=H.target.result,K;N.name.endsWith(".csv")?K=Ph(j,{type:"binary"}):K=Ph(j,{type:"binary"});const ne=K.SheetNames[0],he=K.Sheets[ne],fe=yae.sheet_to_json(he,{defval:""}).map(te=>{const Z={};return Object.entries(te).forEach(([xe,Q])=>{const q=mn(xe,{trim:!0,maxLength:50,removeDangerous:!0}),J=mn(String(Q),{trim:!0,maxLength:100,removeDangerous:!0});Z[q]=J}),Z});u.value=fe,f.value=fe.length?Object.keys(fe[0]):[]}catch(j){alert("Error parsing file. Please check the file format and try again."),console.error("File parsing error:",j)}},G.readAsBinaryString(N)}function L(){try{if(!Is("importTimeTable",3,3e5).allowed){alert("Too many import requests. Please wait before importing again.");return}const N=u.value.map(M=>{const z=M.name||M.Name||M.period||M.Period||M.item||M.Item||"Unknown",G=M.startTime||M["Start Time"]||M.start||M.Start||"08:00",H=M.endTime||M["End Time"]||M.end||M.End||"08:55",j=mn(z,{trim:!0,maxLength:50,removeDangerous:!0}),K=qr(j);if(!K.isSafe)return console.warn(`Security threat detected in imported item: ${K.threats.join(", ")}`),null;let ne="period";const he=M.type||M.Type||"",le=j.toLowerCase();return he.toLowerCase().includes("lunch")||le.includes("lunch")?ne="lunch":he.toLowerCase().includes("break")||le.includes("break")?ne="break":(he.toLowerCase().includes("other")||le.includes("other"))&&(ne="other"),{name:j,type:ne,startTime:G,endTime:H}}).filter(M=>M&&M.name&&M.name!=="Unknown");if(N.length===0){alert("No valid schedule items found in the imported data. Please check your file format.");return}if(h.value==="overwrite"){if(p.value===""){alert("Please select a time table to overwrite");return}const M=parseInt(p.value);s.value[M]={...s.value[M],schedule:N}}else{const M=b(v.value);if(!M)return;const z={name:M,days:["monday","tuesday","wednesday","thursday","friday"],schedule:N};s.value.push(z)}u.value=[],f.value=[],h.value="overwrite",p.value="",v.value="",alert("Time table imported successfully!")}catch(F){console.error("Error importing time table:",F),alert("Error importing time table. Please check your file format and try again.")}}function R(){u.value=[],f.value=[],h.value="overwrite",p.value="",v.value=""}return jt(E),(F,N)=>(O(),B("div",xae,[d("div",Eae,[N[7]||(N[7]=d("h1",null,"Time Table Management",-1)),d("div",_ae,[d("button",{onClick:T,class:"admin-action-btn primary",disabled:n.value,style:{"min-width":"160px","max-width":"160px"}},Y(n.value?"Saving...":"Save Time Tables"),9,bae),d("button",{onClick:x,class:"admin-action-btn secondary",style:{"min-width":"140px","max-width":"140px"}}," Add Time Table ")])]),d("div",Sae,[d("button",{onClick:k,class:"admin-action-btn info",style:{"min-width":"150px","max-width":"150px"}},"Import CSV/XLSX"),d("input",{ref_key:"fileInput",ref:c,type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},onChange:U},null,544),N[8]||(N[8]=d("div",{class:"import-note"}," You can export from Google Sheets or Excel as CSV, or upload your Excel file directly. ",-1))]),u.value.length?(O(),B("div",Aae,[N[13]||(N[13]=d("h3",null,"Preview Imported Time Table",-1)),d("table",null,[d("thead",null,[d("tr",null,[(O(!0),B(Fe,null,He(f.value,M=>(O(),B("th",{key:M},Y(M),1))),128))])]),d("tbody",null,[(O(!0),B(Fe,null,He(u.value,(M,z)=>(O(),B("tr",{key:z},[(O(!0),B(Fe,null,He(f.value,G=>(O(),B("td",{key:G},Y(M[G]),1))),128))]))),128))])]),d("div",Tae,[N[12]||(N[12]=d("h4",null,"Import Options",-1)),d("div",wae,[d("label",null,[Be(d("input",{type:"radio","onUpdate:modelValue":N[0]||(N[0]=M=>h.value=M),value:"overwrite"},null,512),[[ma,h.value]]),N[9]||(N[9]=Ce(" Overwrite existing time table: "))]),Be(d("select",{"onUpdate:modelValue":N[1]||(N[1]=M=>p.value=M),disabled:h.value!=="overwrite",class:"form-select"},[N[10]||(N[10]=d("option",{value:""},"Select a time table...",-1)),(O(!0),B(Fe,null,He(s.value,(M,z)=>(O(),B("option",{key:z,value:z},Y(M.name),9,Iae))),128))],8,Cae),[[cr,p.value]])]),d("div",kae,[d("label",null,[Be(d("input",{type:"radio","onUpdate:modelValue":N[2]||(N[2]=M=>h.value=M),value:"create"},null,512),[[ma,h.value]]),N[11]||(N[11]=Ce(" Create new time table: "))]),Be(d("input",{"onUpdate:modelValue":N[3]||(N[3]=M=>v.value=M),type:"text",placeholder:"Enter time table name...",disabled:h.value!=="create",class:"form-input"},null,8,Dae),[[ht,v.value]])])]),d("div",Pae,[d("button",{onClick:L,class:"btn btn-primary",disabled:!g.value},Y(h.value==="overwrite"?"Overwrite Time Table":"Create New Time Table"),9,Rae),d("button",{onClick:R,class:"btn btn-secondary"},"Cancel")])])):_e("",!0),d("div",Fae,[r.value?(O(),B("div",Nae," Loading time tables... ")):(O(),B("div",Oae,[s.value.length===0?(O(),B("div",Mae,[N[14]||(N[14]=d("h3",null,"No Time Tables Created",-1)),N[15]||(N[15]=d("p",null,"Create your first time table to get started.",-1)),d("button",{onClick:x,class:"btn btn-primary"},"Create Time Table")])):(O(),B("div",Lae,[(O(!0),B(Fe,null,He(s.value,(M,z)=>(O(),B("div",{key:z,class:"time-table-card"},[d("div",Bae,[d("div",Uae,[d("h3",null,Y(M.name),1),d("p",$ae,Y(_(M.days)),1)]),d("div",Vae,[d("button",{onClick:G=>I(z),class:"admin-action-btn edit"}," Edit ",8,Hae),d("button",{onClick:G=>D(z),class:"admin-action-btn delete"}," Delete ",8,jae)])]),d("div",Gae,[(O(!0),B(Fe,null,He(M.schedule,(G,H)=>(O(),B("div",{key:H,class:"schedule-item"},[d("div",Wae,[d("span",zae,Y(G.name),1),d("span",Kae,Y(A(G.startTime))+" - "+Y(A(G.endTime)),1)]),d("div",qae,[d("span",{class:Qe(["type-badge",G.type])},Y(G.type),3)])]))),128))])]))),128))]))]))]),i.value?(O(),B("div",{key:1,class:"edit-dialog-overlay",onClick:m},[d("div",{class:"edit-dialog",onClick:N[6]||(N[6]=dn(()=>{},["stop"]))},[d("div",Xae,[d("h2",null,Y(a.value===-1?"Create Time Table":"Edit Time Table"),1),d("button",{onClick:m,class:"btn-close"},"")]),d("div",Yae,[d("div",Qae,[N[16]||(N[16]=d("label",{for:"timeTableName"},"Time Table Name",-1)),Be(d("input",{id:"timeTableName","onUpdate:modelValue":N[4]||(N[4]=M=>o.value.name=M),type:"text",placeholder:"e.g., Regular Schedule, Rally Day, Minimum Day",class:"form-input"},null,512),[[ht,o.value.name]])]),d("div",Jae,[N[17]||(N[17]=d("label",null,"Days This Schedule Applies",-1)),d("div",Zae,[(O(),B(Fe,null,He(l,M=>d("label",{key:M.value,class:"day-checkbox"},[Be(d("input",{type:"checkbox",value:M.value,"onUpdate:modelValue":N[5]||(N[5]=z=>o.value.days=z)},null,8,eie),[[wt,o.value.days]]),Ce(" "+Y(M.label),1)])),64))])]),d("div",tie,[N[20]||(N[20]=d("label",null,"Schedule Items",-1)),d("div",rie,[(O(!0),B(Fe,null,He(o.value.schedule,(M,z)=>(O(),B("div",{key:z,class:"schedule-item-edit"},[d("div",nie,[Be(d("input",{"onUpdate:modelValue":G=>M.name=G,type:"text",placeholder:"Period 1, Lunch, Break, etc.",class:"form-input item-name-input"},null,8,sie),[[ht,M.name]]),Be(d("select",{"onUpdate:modelValue":G=>M.type=G,class:"form-select item-type-select"},N[18]||(N[18]=[d("option",{value:"period"},"Period",-1),d("option",{value:"break"},"Break",-1),d("option",{value:"lunch"},"Lunch",-1),d("option",{value:"other"},"Other",-1)]),8,aie),[[cr,M.type]]),Be(d("input",{"onUpdate:modelValue":G=>M.startTime=G,type:"time",class:"form-input time-input"},null,8,iie),[[ht,M.startTime]]),N[19]||(N[19]=d("span",{class:"time-separator"},"to",-1)),Be(d("input",{"onUpdate:modelValue":G=>M.endTime=G,type:"time",class:"form-input time-input"},null,8,oie),[[ht,M.endTime]]),d("button",{onClick:G=>w(z),class:"admin-action-btn delete"}," Delete ",8,lie)])]))),128)),d("button",{onClick:P,class:"admin-action-btn secondary",style:{"min-width":"150px","max-width":"150px"}}," Add Schedule Item ")])])]),d("div",{class:"admin-action-btns"},[d("button",{onClick:m,class:"admin-action-btn cancel",style:{"min-width":"100px","max-width":"100px"}},"Cancel"),d("button",{onClick:S,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},"Save Time Table")])])])):_e("",!0)]))}},tD=xt(cie,[["__scopeId","data-v-428c8e72"]]);function uie(){const t=se({}),e=se(!1);async function r(){e.value=!0;try{const f=await Gt(_t(qe,"aideSchedules")),h={};f.forEach(p=>{h[p.id]=p.data()}),t.value=h}catch(f){console.error("Error loading aide schedules:",f),t.value={}}finally{e.value=!1}}async function n(f){e.value=!0;try{const h=await nr(Ze(qe,"aideSchedules",f));h.exists()?t.value[f]=h.data():t.value[f]={schedule:{},directAssignment:[]}}catch(h){console.error("Error loading aide schedule:",h),t.value[f]={schedule:{},directAssignment:[]}}finally{e.value=!1}}async function s(f,h,p=!0){try{const v=JSON.parse(JSON.stringify(h));p?await Ht(Ze(qe,"aideSchedules",f),v,{merge:!0}):await Ht(Ze(qe,"aideSchedules",f),v),t.value[f]=v}catch(v){throw console.error("Error saving aide schedule:",v),v}}async function i(){try{const f=Object.entries(t.value);for(const[h,p]of f){const v=JSON.parse(JSON.stringify(p));await Ht(Ze(qe,"aideSchedules",h),v,{merge:!0})}}catch(f){throw console.error("Error saving all aide schedules:",f),f}}function a(f,h){const p=[];return Object.entries(t.value).forEach(([v,g])=>{g.schedule&&g.schedule[h]&&(Array.isArray(g.schedule[h])?g.schedule[h]:[g.schedule[h]]).includes(f)&&p.push(v)}),p}function o(f){var p;const h=(p=t.value[f])==null?void 0:p.directAssignment;return Array.isArray(h)?h.length>0?h[0]:null:h||null}function l(f){return Object.keys(t.value).find(p=>{var g;const v=(g=t.value[p])==null?void 0:g.directAssignment;return Array.isArray(v)?v.includes(f):v===f})||null}function c(f,h,p){const v=[],g=t.value[f];return g&&((Array.isArray(g.directAssignment)?g.directAssignment:g.directAssignment?[g.directAssignment]:[]).forEach(b=>{if(b){const E=h.find(x=>x.id===b);E&&v.push({...E,assignmentType:"direct"})}}),Object.entries(g.schedule||{}).forEach(([b,E])=>{E&&(Array.isArray(E)?E:[E]).forEach(I=>{I&&h.forEach(D=>{if(D.schedule&&D.schedule[b]===I){const P=v.findIndex(w=>w.id===D.id);P===-1?v.push({...D,assignmentType:"class",period:b,teacherId:I}):(v[P].assignmentType="both",v[P].period=b,v[P].teacherId=I)}})})})),v}function u(f,h,p,v){if(!f||!h||!p||!v)return!1;const g=p.find(I=>I.id===h);if(!g)return!1;const y=t.value[f];if(!y)return!1;if((Array.isArray(y.directAssignment)?y.directAssignment:y.directAssignment?[y.directAssignment]:[]).includes(h))return!0;if(!g.schedule)return!1;const E=y.schedule||{};return Object.entries(g.schedule).some(([I,D])=>{const P=E[I];return P?(Array.isArray(P)?P:[P]).includes(D):!1})}return{aideSchedule:be(()=>t.value),loading:be(()=>e.value),loadAideSchedules:r,loadAideSchedule:n,saveAideSchedule:s,saveAllAideSchedules:i,getAidesForTeacher:a,getDirectStudentForAide:o,getAideForStudent:l,getStudentsForAide:c,shouldAideSeeStudent:u}}var die={exports:{}};const fie=Xy(cR);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function PS(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function $a(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?PS(Object(r),!0).forEach(function(n){hie(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):PS(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function k0(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?k0=function(e){return typeof e}:k0=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k0(t)}function hie(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zs(){return zs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},zs.apply(this,arguments)}function pie(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function mie(t,e){if(t==null)return{};var r=pie(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function gie(t){return vie(t)||yie(t)||xie(t)||Eie()}function vie(t){if(Array.isArray(t))return Zv(t)}function yie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xie(t,e){if(t){if(typeof t=="string")return Zv(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zv(t,e)}}function Zv(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Eie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var _ie="1.14.0";function pi(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Di=pi(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),ff=pi(/Edge/i),RS=pi(/firefox/i),ed=pi(/safari/i)&&!pi(/chrome/i)&&!pi(/android/i),rD=pi(/iP(ad|od|hone)/i),bie=pi(/chrome/i)&&pi(/android/i),nD={capture:!1,passive:!1};function Kt(t,e,r){t.addEventListener(e,r,!Di&&nD)}function zt(t,e,r){t.removeEventListener(e,r,!Di&&nD)}function Rh(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function Sie(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function na(t,e,r,n){if(t){r=r||document;do{if(e!=null&&(e[0]===">"?t.parentNode===r&&Rh(t,e):Rh(t,e))||n&&t===r)return t;if(t===r)break}while(t=Sie(t))}return null}var FS=/\s+/g;function Fr(t,e,r){if(t&&e)if(t.classList)t.classList[r?"add":"remove"](e);else{var n=(" "+t.className+" ").replace(FS," ").replace(" "+e+" "," ");t.className=(n+(r?" "+e:"")).replace(FS," ")}}function ft(t,e,r){var n=t&&t.style;if(n){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(r=t.currentStyle),e===void 0?r:r[e];!(e in n)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),n[e]=r+(typeof r=="string"?"":"px")}}function Ko(t,e){var r="";if(typeof t=="string")r=t;else do{var n=ft(t,"transform");n&&n!=="none"&&(r=n+" "+r)}while(!e&&(t=t.parentNode));var s=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return s&&new s(r)}function sD(t,e,r){if(t){var n=t.getElementsByTagName(e),s=0,i=n.length;if(r)for(;s<i;s++)r(n[s],s);return n}return[]}function Oa(){var t=document.scrollingElement;return t||document.documentElement}function Pr(t,e,r,n,s){if(!(!t.getBoundingClientRect&&t!==window)){var i,a,o,l,c,u,f;if(t!==window&&t.parentNode&&t!==Oa()?(i=t.getBoundingClientRect(),a=i.top,o=i.left,l=i.bottom,c=i.right,u=i.height,f=i.width):(a=0,o=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,f=window.innerWidth),(e||r)&&t!==window&&(s=s||t.parentNode,!Di))do if(s&&s.getBoundingClientRect&&(ft(s,"transform")!=="none"||r&&ft(s,"position")!=="static")){var h=s.getBoundingClientRect();a-=h.top+parseInt(ft(s,"border-top-width")),o-=h.left+parseInt(ft(s,"border-left-width")),l=a+i.height,c=o+i.width;break}while(s=s.parentNode);if(n&&t!==window){var p=Ko(s||t),v=p&&p.a,g=p&&p.d;p&&(a/=g,o/=v,f/=v,u/=g,l=a+u,c=o+f)}return{top:a,left:o,bottom:l,right:c,width:f,height:u}}}function NS(t,e,r){for(var n=eo(t,!0),s=Pr(t)[e];n;){var i=Pr(n)[r],a=void 0;if(a=s>=i,!a)return n;if(n===Oa())break;n=eo(n,!1)}return!1}function Pc(t,e,r,n){for(var s=0,i=0,a=t.children;i<a.length;){if(a[i].style.display!=="none"&&a[i]!==Tt.ghost&&(n||a[i]!==Tt.dragged)&&na(a[i],r.draggable,t,!1)){if(s===e)return a[i];s++}i++}return null}function Cx(t,e){for(var r=t.lastElementChild;r&&(r===Tt.ghost||ft(r,"display")==="none"||e&&!Rh(r,e));)r=r.previousElementSibling;return r||null}function $r(t,e){var r=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==Tt.clone&&(!e||Rh(t,e))&&r++;return r}function OS(t){var e=0,r=0,n=Oa();if(t)do{var s=Ko(t),i=s.a,a=s.d;e+=t.scrollLeft*i,r+=t.scrollTop*a}while(t!==n&&(t=t.parentNode));return[e,r]}function Aie(t,e){for(var r in t)if(t.hasOwnProperty(r)){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===t[r][n])return Number(r)}return-1}function eo(t,e){if(!t||!t.getBoundingClientRect)return Oa();var r=t,n=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var s=ft(r);if(r.clientWidth<r.scrollWidth&&(s.overflowX=="auto"||s.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(s.overflowY=="auto"||s.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return Oa();if(n||e)return r;n=!0}}while(r=r.parentNode);return Oa()}function Tie(t,e){if(t&&e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function Sg(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var td;function aD(t,e){return function(){if(!td){var r=arguments,n=this;r.length===1?t.call(n,r[0]):t.apply(n,r),td=setTimeout(function(){td=void 0},e)}}}function wie(){clearTimeout(td),td=void 0}function iD(t,e,r){t.scrollLeft+=e,t.scrollTop+=r}function Ix(t){var e=window.Polymer,r=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):r?r(t).clone(!0)[0]:t.cloneNode(!0)}function MS(t,e){ft(t,"position","absolute"),ft(t,"top",e.top),ft(t,"left",e.left),ft(t,"width",e.width),ft(t,"height",e.height)}function Ag(t){ft(t,"position",""),ft(t,"top",""),ft(t,"left",""),ft(t,"width",""),ft(t,"height","")}var zn="Sortable"+new Date().getTime();function Cie(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(s){if(!(ft(s,"display")==="none"||s===Tt.ghost)){t.push({target:s,rect:Pr(s)});var i=$a({},t[t.length-1].rect);if(s.thisAnimationDuration){var a=Ko(s,!0);a&&(i.top-=a.f,i.left-=a.e)}s.fromRect=i}})}},addAnimationState:function(n){t.push(n)},removeAnimationState:function(n){t.splice(Aie(t,{target:n}),1)},animateAll:function(n){var s=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var i=!1,a=0;t.forEach(function(o){var l=0,c=o.target,u=c.fromRect,f=Pr(c),h=c.prevFromRect,p=c.prevToRect,v=o.rect,g=Ko(c,!0);g&&(f.top-=g.f,f.left-=g.e),c.toRect=f,c.thisAnimationDuration&&Sg(h,f)&&!Sg(u,f)&&(v.top-f.top)/(v.left-f.left)===(u.top-f.top)/(u.left-f.left)&&(l=kie(v,h,p,s.options)),Sg(f,u)||(c.prevFromRect=u,c.prevToRect=f,l||(l=s.options.animation),s.animate(c,v,f,l)),l&&(i=!0,a=Math.max(a,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),i?e=setTimeout(function(){typeof n=="function"&&n()},a):typeof n=="function"&&n(),t=[]},animate:function(n,s,i,a){if(a){ft(n,"transition",""),ft(n,"transform","");var o=Ko(this.el),l=o&&o.a,c=o&&o.d,u=(s.left-i.left)/(l||1),f=(s.top-i.top)/(c||1);n.animatingX=!!u,n.animatingY=!!f,ft(n,"transform","translate3d("+u+"px,"+f+"px,0)"),this.forRepaintDummy=Iie(n),ft(n,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),ft(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){ft(n,"transition",""),ft(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},a)}}}}function Iie(t){return t.offsetWidth}function kie(t,e,r,n){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))*n.animation}var Nl=[],Tg={initializeByDefault:!0},hf={mount:function(e){for(var r in Tg)Tg.hasOwnProperty(r)&&!(r in e)&&(e[r]=Tg[r]);Nl.forEach(function(n){if(n.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Nl.push(e)},pluginEvent:function(e,r,n){var s=this;this.eventCanceled=!1,n.cancel=function(){s.eventCanceled=!0};var i=e+"Global";Nl.forEach(function(a){r[a.pluginName]&&(r[a.pluginName][i]&&r[a.pluginName][i]($a({sortable:r},n)),r.options[a.pluginName]&&r[a.pluginName][e]&&r[a.pluginName][e]($a({sortable:r},n)))})},initializePlugins:function(e,r,n,s){Nl.forEach(function(o){var l=o.pluginName;if(!(!e.options[l]&&!o.initializeByDefault)){var c=new o(e,r,e.options);c.sortable=e,c.options=e.options,e[l]=c,zs(n,c.defaults)}});for(var i in e.options)if(e.options.hasOwnProperty(i)){var a=this.modifyOption(e,i,e.options[i]);typeof a<"u"&&(e.options[i]=a)}},getEventProperties:function(e,r){var n={};return Nl.forEach(function(s){typeof s.eventProperties=="function"&&zs(n,s.eventProperties.call(r[s.pluginName],e))}),n},modifyOption:function(e,r,n){var s;return Nl.forEach(function(i){e[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[r]=="function"&&(s=i.optionListeners[r].call(e[i.pluginName],n))}),s}};function Au(t){var e=t.sortable,r=t.rootEl,n=t.name,s=t.targetEl,i=t.cloneEl,a=t.toEl,o=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,f=t.newDraggableIndex,h=t.originalEvent,p=t.putSortable,v=t.extraEventProperties;if(e=e||r&&r[zn],!!e){var g,y=e.options,b="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!Di&&!ff?g=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(g=document.createEvent("Event"),g.initEvent(n,!0,!0)),g.to=a||r,g.from=o||r,g.item=s||r,g.clone=i,g.oldIndex=l,g.newIndex=c,g.oldDraggableIndex=u,g.newDraggableIndex=f,g.originalEvent=h,g.pullMode=p?p.lastPutMode:void 0;var E=$a($a({},v),hf.getEventProperties(n,e));for(var x in E)g[x]=E[x];r&&r.dispatchEvent(g),y[b]&&y[b].call(e,g)}}var Die=["evt"],ps=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=n.evt,i=mie(n,Die);hf.pluginEvent.bind(Tt)(e,r,$a({dragEl:rt,parentEl:Lr,ghostEl:Lt,rootEl:kr,nextEl:Fo,lastDownEl:D0,cloneEl:Br,cloneHidden:Yi,dragStarted:Tu,putSortable:bn,activeSortable:Tt.active,originalEvent:s,oldIndex:Xl,oldDraggableIndex:rd,newIndex:As,newDraggableIndex:Ki,hideGhostForTarget:uD,unhideGhostForTarget:dD,cloneNowHidden:function(){Yi=!0},cloneNowShown:function(){Yi=!1},dispatchSortableEvent:function(o){ss({sortable:r,name:o,originalEvent:s})}},i))};function ss(t){Au($a({putSortable:bn,cloneEl:Br,targetEl:rt,rootEl:kr,oldIndex:Xl,oldDraggableIndex:rd,newIndex:As,newDraggableIndex:Ki},t))}var rt,Lr,Lt,kr,Fo,D0,Br,Yi,Xl,As,rd,Ki,r0,bn,Wl=!1,Fh=!1,Nh=[],ko,ta,wg,Cg,LS,BS,Tu,Ol,nd,sd=!1,n0=!1,P0,Bn,Ig=[],e1=!1,Oh=[],Hp=typeof document<"u",s0=rD,US=ff||Di?"cssFloat":"float",Pie=Hp&&!bie&&!rD&&"draggable"in document.createElement("div"),oD=function(){if(Hp){if(Di)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),lD=function(e,r){var n=ft(e),s=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=Pc(e,0,r),a=Pc(e,1,r),o=i&&ft(i),l=a&&ft(a),c=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Pr(i).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Pr(a).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&o.float&&o.float!=="none"){var f=o.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return i&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||c>=s&&n[US]==="none"||a&&n[US]==="none"&&c+u>s)?"vertical":"horizontal"},Rie=function(e,r,n){var s=n?e.left:e.top,i=n?e.right:e.bottom,a=n?e.width:e.height,o=n?r.left:r.top,l=n?r.right:r.bottom,c=n?r.width:r.height;return s===o||i===l||s+a/2===o+c/2},Fie=function(e,r){var n;return Nh.some(function(s){var i=s[zn].options.emptyInsertThreshold;if(!(!i||Cx(s))){var a=Pr(s),o=e>=a.left-i&&e<=a.right+i,l=r>=a.top-i&&r<=a.bottom+i;if(o&&l)return n=s}}),n},cD=function(e){function r(i,a){return function(o,l,c,u){var f=o.options.group.name&&l.options.group.name&&o.options.group.name===l.options.group.name;if(i==null&&(a||f))return!0;if(i==null||i===!1)return!1;if(a&&i==="clone")return i;if(typeof i=="function")return r(i(o,l,c,u),a)(o,l,c,u);var h=(a?o:l).options.group.name;return i===!0||typeof i=="string"&&i===h||i.join&&i.indexOf(h)>-1}}var n={},s=e.group;(!s||k0(s)!="object")&&(s={name:s}),n.name=s.name,n.checkPull=r(s.pull,!0),n.checkPut=r(s.put),n.revertClone=s.revertClone,e.group=n},uD=function(){!oD&&Lt&&ft(Lt,"display","none")},dD=function(){!oD&&Lt&&ft(Lt,"display","")};Hp&&document.addEventListener("click",function(t){if(Fh)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Fh=!1,!1},!0);var Do=function(e){if(rt){e=e.touches?e.touches[0]:e;var r=Fie(e.clientX,e.clientY);if(r){var n={};for(var s in e)e.hasOwnProperty(s)&&(n[s]=e[s]);n.target=n.rootEl=r,n.preventDefault=void 0,n.stopPropagation=void 0,r[zn]._onDragOver(n)}}},Nie=function(e){rt&&rt.parentNode[zn]._isOutsideThisEl(e.target)};function Tt(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=zs({},e),t[zn]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return lD(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:Tt.supportPointer!==!1&&"PointerEvent"in window&&!ed,emptyInsertThreshold:5};hf.initializePlugins(this,t,r);for(var n in r)!(n in e)&&(e[n]=r[n]);cD(e);for(var s in this)s.charAt(0)==="_"&&typeof this[s]=="function"&&(this[s]=this[s].bind(this));this.nativeDraggable=e.forceFallback?!1:Pie,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Kt(t,"pointerdown",this._onTapStart):(Kt(t,"mousedown",this._onTapStart),Kt(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(Kt(t,"dragover",this),Kt(t,"dragenter",this)),Nh.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),zs(this,Cie())}Tt.prototype={constructor:Tt,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Ol=null)},_getDirection:function(e,r){return typeof this.options.direction=="function"?this.options.direction.call(this,e,r,rt):this.options.direction},_onTapStart:function(e){if(e.cancelable){var r=this,n=this.el,s=this.options,i=s.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(o||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=s.filter;if(Hie(n),!rt&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||s.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&ed&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=na(l,s.draggable,n,!1),!(l&&l.animated)&&D0!==l)){if(Xl=$r(l),rd=$r(l,s.draggable),typeof u=="function"){if(u.call(this,e,l,this)){ss({sortable:r,rootEl:c,name:"filter",targetEl:l,toEl:n,fromEl:n}),ps("filter",r,{evt:e}),i&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(f){if(f=na(c,f.trim(),n,!1),f)return ss({sortable:r,rootEl:f,name:"filter",targetEl:l,fromEl:n,toEl:n}),ps("filter",r,{evt:e}),!0}),u)){i&&e.cancelable&&e.preventDefault();return}s.handle&&!na(c,s.handle,n,!1)||this._prepareDragStart(e,o,l)}}},_prepareDragStart:function(e,r,n){var s=this,i=s.el,a=s.options,o=i.ownerDocument,l;if(n&&!rt&&n.parentNode===i){var c=Pr(n);if(kr=i,rt=n,Lr=rt.parentNode,Fo=rt.nextSibling,D0=n,r0=a.group,Tt.dragged=rt,ko={target:rt,clientX:(r||e).clientX,clientY:(r||e).clientY},LS=ko.clientX-c.left,BS=ko.clientY-c.top,this._lastX=(r||e).clientX,this._lastY=(r||e).clientY,rt.style["will-change"]="all",l=function(){if(ps("delayEnded",s,{evt:e}),Tt.eventCanceled){s._onDrop();return}s._disableDelayedDragEvents(),!RS&&s.nativeDraggable&&(rt.draggable=!0),s._triggerDragStart(e,r),ss({sortable:s,name:"choose",originalEvent:e}),Fr(rt,a.chosenClass,!0)},a.ignore.split(",").forEach(function(u){sD(rt,u.trim(),kg)}),Kt(o,"dragover",Do),Kt(o,"mousemove",Do),Kt(o,"touchmove",Do),Kt(o,"mouseup",s._onDrop),Kt(o,"touchend",s._onDrop),Kt(o,"touchcancel",s._onDrop),RS&&this.nativeDraggable&&(this.options.touchStartThreshold=4,rt.draggable=!0),ps("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(ff||Di))){if(Tt.eventCanceled){this._onDrop();return}Kt(o,"mouseup",s._disableDelayedDrag),Kt(o,"touchend",s._disableDelayedDrag),Kt(o,"touchcancel",s._disableDelayedDrag),Kt(o,"mousemove",s._delayedDragTouchMoveHandler),Kt(o,"touchmove",s._delayedDragTouchMoveHandler),a.supportPointer&&Kt(o,"pointermove",s._delayedDragTouchMoveHandler),s._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var r=e.touches?e.touches[0]:e;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){rt&&kg(rt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;zt(e,"mouseup",this._disableDelayedDrag),zt(e,"touchend",this._disableDelayedDrag),zt(e,"touchcancel",this._disableDelayedDrag),zt(e,"mousemove",this._delayedDragTouchMoveHandler),zt(e,"touchmove",this._delayedDragTouchMoveHandler),zt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,r){r=r||e.pointerType=="touch"&&e,!this.nativeDraggable||r?this.options.supportPointer?Kt(document,"pointermove",this._onTouchMove):r?Kt(document,"touchmove",this._onTouchMove):Kt(document,"mousemove",this._onTouchMove):(Kt(rt,"dragend",this),Kt(kr,"dragstart",this._onDragStart));try{document.selection?R0(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,r){if(Wl=!1,kr&&rt){ps("dragStarted",this,{evt:r}),this.nativeDraggable&&Kt(document,"dragover",Nie);var n=this.options;!e&&Fr(rt,n.dragClass,!1),Fr(rt,n.ghostClass,!0),Tt.active=this,e&&this._appendGhost(),ss({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(ta){this._lastX=ta.clientX,this._lastY=ta.clientY,uD();for(var e=document.elementFromPoint(ta.clientX,ta.clientY),r=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ta.clientX,ta.clientY),e!==r);)r=e;if(rt.parentNode[zn]._isOutsideThisEl(e),r)do{if(r[zn]){var n=void 0;if(n=r[zn]._onDragOver({clientX:ta.clientX,clientY:ta.clientY,target:e,rootEl:r}),n&&!this.options.dragoverBubble)break}e=r}while(r=r.parentNode);dD()}},_onTouchMove:function(e){if(ko){var r=this.options,n=r.fallbackTolerance,s=r.fallbackOffset,i=e.touches?e.touches[0]:e,a=Lt&&Ko(Lt,!0),o=Lt&&a&&a.a,l=Lt&&a&&a.d,c=s0&&Bn&&OS(Bn),u=(i.clientX-ko.clientX+s.x)/(o||1)+(c?c[0]-Ig[0]:0)/(o||1),f=(i.clientY-ko.clientY+s.y)/(l||1)+(c?c[1]-Ig[1]:0)/(l||1);if(!Tt.active&&!Wl){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Lt){a?(a.e+=u-(wg||0),a.f+=f-(Cg||0)):a={a:1,b:0,c:0,d:1,e:u,f};var h="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");ft(Lt,"webkitTransform",h),ft(Lt,"mozTransform",h),ft(Lt,"msTransform",h),ft(Lt,"transform",h),wg=u,Cg=f,ta=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Lt){var e=this.options.fallbackOnBody?document.body:kr,r=Pr(rt,!0,s0,!0,e),n=this.options;if(s0){for(Bn=e;ft(Bn,"position")==="static"&&ft(Bn,"transform")==="none"&&Bn!==document;)Bn=Bn.parentNode;Bn!==document.body&&Bn!==document.documentElement?(Bn===document&&(Bn=Oa()),r.top+=Bn.scrollTop,r.left+=Bn.scrollLeft):Bn=Oa(),Ig=OS(Bn)}Lt=rt.cloneNode(!0),Fr(Lt,n.ghostClass,!1),Fr(Lt,n.fallbackClass,!0),Fr(Lt,n.dragClass,!0),ft(Lt,"transition",""),ft(Lt,"transform",""),ft(Lt,"box-sizing","border-box"),ft(Lt,"margin",0),ft(Lt,"top",r.top),ft(Lt,"left",r.left),ft(Lt,"width",r.width),ft(Lt,"height",r.height),ft(Lt,"opacity","0.8"),ft(Lt,"position",s0?"absolute":"fixed"),ft(Lt,"zIndex","100000"),ft(Lt,"pointerEvents","none"),Tt.ghost=Lt,e.appendChild(Lt),ft(Lt,"transform-origin",LS/parseInt(Lt.style.width)*100+"% "+BS/parseInt(Lt.style.height)*100+"%")}},_onDragStart:function(e,r){var n=this,s=e.dataTransfer,i=n.options;if(ps("dragStart",this,{evt:e}),Tt.eventCanceled){this._onDrop();return}ps("setupClone",this),Tt.eventCanceled||(Br=Ix(rt),Br.draggable=!1,Br.style["will-change"]="",this._hideClone(),Fr(Br,this.options.chosenClass,!1),Tt.clone=Br),n.cloneId=R0(function(){ps("clone",n),!Tt.eventCanceled&&(n.options.removeCloneOnHide||kr.insertBefore(Br,rt),n._hideClone(),ss({sortable:n,name:"clone"}))}),!r&&Fr(rt,i.dragClass,!0),r?(Fh=!0,n._loopId=setInterval(n._emulateDragOver,50)):(zt(document,"mouseup",n._onDrop),zt(document,"touchend",n._onDrop),zt(document,"touchcancel",n._onDrop),s&&(s.effectAllowed="move",i.setData&&i.setData.call(n,s,rt)),Kt(document,"drop",n),ft(rt,"transform","translateZ(0)")),Wl=!0,n._dragStartId=R0(n._dragStarted.bind(n,r,e)),Kt(document,"selectstart",n),Tu=!0,ed&&ft(document.body,"user-select","none")},_onDragOver:function(e){var r=this.el,n=e.target,s,i,a,o=this.options,l=o.group,c=Tt.active,u=r0===l,f=o.sort,h=bn||c,p,v=this,g=!1;if(e1)return;function y(N,M){ps(N,v,$a({evt:e,isOwner:u,axis:p?"vertical":"horizontal",revert:a,dragRect:s,targetRect:i,canSort:f,fromSortable:h,target:n,completed:E,onMove:function(G,H){return a0(kr,r,rt,s,G,Pr(G),e,H)},changed:x},M))}function b(){y("dragOverAnimationCapture"),v.captureAnimationState(),v!==h&&h.captureAnimationState()}function E(N){return y("dragOverCompleted",{insertion:N}),N&&(u?c._hideClone():c._showClone(v),v!==h&&(Fr(rt,bn?bn.options.ghostClass:c.options.ghostClass,!1),Fr(rt,o.ghostClass,!0)),bn!==v&&v!==Tt.active?bn=v:v===Tt.active&&bn&&(bn=null),h===v&&(v._ignoreWhileAnimating=n),v.animateAll(function(){y("dragOverAnimationComplete"),v._ignoreWhileAnimating=null}),v!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(n===rt&&!rt.animated||n===r&&!n.animated)&&(Ol=null),!o.dragoverBubble&&!e.rootEl&&n!==document&&(rt.parentNode[zn]._isOutsideThisEl(e.target),!N&&Do(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),g=!0}function x(){As=$r(rt),Ki=$r(rt,o.draggable),ss({sortable:v,name:"change",toEl:r,newIndex:As,newDraggableIndex:Ki,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),n=na(n,o.draggable,r,!0),y("dragOver"),Tt.eventCanceled)return g;if(rt.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||v._ignoreWhileAnimating===n)return E(!1);if(Fh=!1,c&&!o.disabled&&(u?f||(a=Lr!==kr):bn===this||(this.lastPutMode=r0.checkPull(this,c,rt,e))&&l.checkPut(this,c,rt,e))){if(p=this._getDirection(e,n)==="vertical",s=Pr(rt),y("dragOverValid"),Tt.eventCanceled)return g;if(a)return Lr=kr,b(),this._hideClone(),y("revert"),Tt.eventCanceled||(Fo?kr.insertBefore(rt,Fo):kr.appendChild(rt)),E(!0);var I=Cx(r,o.draggable);if(!I||Bie(e,p,this)&&!I.animated){if(I===rt)return E(!1);if(I&&r===e.target&&(n=I),n&&(i=Pr(n)),a0(kr,r,rt,s,n,i,e,!!n)!==!1)return b(),r.appendChild(rt),Lr=r,x(),E(!0)}else if(I&&Lie(e,p,this)){var D=Pc(r,0,o,!0);if(D===rt)return E(!1);if(n=D,i=Pr(n),a0(kr,r,rt,s,n,i,e,!1)!==!1)return b(),r.insertBefore(rt,D),Lr=r,x(),E(!0)}else if(n.parentNode===r){i=Pr(n);var P=0,w,S=rt.parentNode!==r,m=!Rie(rt.animated&&rt.toRect||s,n.animated&&n.toRect||i,p),T=p?"top":"left",_=NS(n,"top","top")||NS(rt,"top","top"),A=_?_.scrollTop:void 0;Ol!==n&&(w=i[T],sd=!1,n0=!m&&o.invertSwap||S),P=Uie(e,n,i,p,m?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,n0,Ol===n);var k;if(P!==0){var U=$r(rt);do U-=P,k=Lr.children[U];while(k&&(ft(k,"display")==="none"||k===Lt))}if(P===0||k===n)return E(!1);Ol=n,nd=P;var L=n.nextElementSibling,R=!1;R=P===1;var F=a0(kr,r,rt,s,n,i,e,R);if(F!==!1)return(F===1||F===-1)&&(R=F===1),e1=!0,setTimeout(Mie,30),b(),R&&!L?r.appendChild(rt):n.parentNode.insertBefore(rt,R?L:n),_&&iD(_,0,A-_.scrollTop),Lr=rt.parentNode,w!==void 0&&!n0&&(P0=Math.abs(w-Pr(n)[T])),x(),E(!0)}if(r.contains(rt))return E(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){zt(document,"mousemove",this._onTouchMove),zt(document,"touchmove",this._onTouchMove),zt(document,"pointermove",this._onTouchMove),zt(document,"dragover",Do),zt(document,"mousemove",Do),zt(document,"touchmove",Do)},_offUpEvents:function(){var e=this.el.ownerDocument;zt(e,"mouseup",this._onDrop),zt(e,"touchend",this._onDrop),zt(e,"pointerup",this._onDrop),zt(e,"touchcancel",this._onDrop),zt(document,"selectstart",this)},_onDrop:function(e){var r=this.el,n=this.options;if(As=$r(rt),Ki=$r(rt,n.draggable),ps("drop",this,{evt:e}),Lr=rt&&rt.parentNode,As=$r(rt),Ki=$r(rt,n.draggable),Tt.eventCanceled){this._nulling();return}Wl=!1,n0=!1,sd=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),t1(this.cloneId),t1(this._dragStartId),this.nativeDraggable&&(zt(document,"drop",this),zt(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),ed&&ft(document.body,"user-select",""),ft(rt,"transform",""),e&&(Tu&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Lt&&Lt.parentNode&&Lt.parentNode.removeChild(Lt),(kr===Lr||bn&&bn.lastPutMode!=="clone")&&Br&&Br.parentNode&&Br.parentNode.removeChild(Br),rt&&(this.nativeDraggable&&zt(rt,"dragend",this),kg(rt),rt.style["will-change"]="",Tu&&!Wl&&Fr(rt,bn?bn.options.ghostClass:this.options.ghostClass,!1),Fr(rt,this.options.chosenClass,!1),ss({sortable:this,name:"unchoose",toEl:Lr,newIndex:null,newDraggableIndex:null,originalEvent:e}),kr!==Lr?(As>=0&&(ss({rootEl:Lr,name:"add",toEl:Lr,fromEl:kr,originalEvent:e}),ss({sortable:this,name:"remove",toEl:Lr,originalEvent:e}),ss({rootEl:Lr,name:"sort",toEl:Lr,fromEl:kr,originalEvent:e}),ss({sortable:this,name:"sort",toEl:Lr,originalEvent:e})),bn&&bn.save()):As!==Xl&&As>=0&&(ss({sortable:this,name:"update",toEl:Lr,originalEvent:e}),ss({sortable:this,name:"sort",toEl:Lr,originalEvent:e})),Tt.active&&((As==null||As===-1)&&(As=Xl,Ki=rd),ss({sortable:this,name:"end",toEl:Lr,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){ps("nulling",this),kr=rt=Lr=Lt=Fo=Br=D0=Yi=ko=ta=Tu=As=Ki=Xl=rd=Ol=nd=bn=r0=Tt.dragged=Tt.ghost=Tt.clone=Tt.active=null,Oh.forEach(function(e){e.checked=!0}),Oh.length=wg=Cg=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":rt&&(this._onDragOver(e),Oie(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],r,n=this.el.children,s=0,i=n.length,a=this.options;s<i;s++)r=n[s],na(r,a.draggable,this.el,!1)&&e.push(r.getAttribute(a.dataIdAttr)||Vie(r));return e},sort:function(e,r){var n={},s=this.el;this.toArray().forEach(function(i,a){var o=s.children[a];na(o,this.options.draggable,s,!1)&&(n[i]=o)},this),r&&this.captureAnimationState(),e.forEach(function(i){n[i]&&(s.removeChild(n[i]),s.appendChild(n[i]))}),r&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,r){return na(e,r||this.options.draggable,this.el,!1)},option:function(e,r){var n=this.options;if(r===void 0)return n[e];var s=hf.modifyOption(this,e,r);typeof s<"u"?n[e]=s:n[e]=r,e==="group"&&cD(n)},destroy:function(){ps("destroy",this);var e=this.el;e[zn]=null,zt(e,"mousedown",this._onTapStart),zt(e,"touchstart",this._onTapStart),zt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(zt(e,"dragover",this),zt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Nh.splice(Nh.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Yi){if(ps("hideClone",this),Tt.eventCanceled)return;ft(Br,"display","none"),this.options.removeCloneOnHide&&Br.parentNode&&Br.parentNode.removeChild(Br),Yi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Yi){if(ps("showClone",this),Tt.eventCanceled)return;rt.parentNode==kr&&!this.options.group.revertClone?kr.insertBefore(Br,rt):Fo?kr.insertBefore(Br,Fo):kr.appendChild(Br),this.options.group.revertClone&&this.animate(rt,Br),ft(Br,"display",""),Yi=!1}}};function Oie(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function a0(t,e,r,n,s,i,a,o){var l,c=t[zn],u=c.options.onMove,f;return window.CustomEvent&&!Di&&!ff?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=r,l.draggedRect=n,l.related=s||e,l.relatedRect=i||Pr(e),l.willInsertAfter=o,l.originalEvent=a,t.dispatchEvent(l),u&&(f=u.call(c,l,a)),f}function kg(t){t.draggable=!1}function Mie(){e1=!1}function Lie(t,e,r){var n=Pr(Pc(r.el,0,r.options,!0)),s=10;return e?t.clientX<n.left-s||t.clientY<n.top&&t.clientX<n.right:t.clientY<n.top-s||t.clientY<n.bottom&&t.clientX<n.left}function Bie(t,e,r){var n=Pr(Cx(r.el,r.options.draggable)),s=10;return e?t.clientX>n.right+s||t.clientX<=n.right&&t.clientY>n.bottom&&t.clientX>=n.left:t.clientX>n.right&&t.clientY>n.top||t.clientX<=n.right&&t.clientY>n.bottom+s}function Uie(t,e,r,n,s,i,a,o){var l=n?t.clientY:t.clientX,c=n?r.height:r.width,u=n?r.top:r.left,f=n?r.bottom:r.right,h=!1;if(!a){if(o&&P0<c*s){if(!sd&&(nd===1?l>u+c*i/2:l<f-c*i/2)&&(sd=!0),sd)h=!0;else if(nd===1?l<u+P0:l>f-P0)return-nd}else if(l>u+c*(1-s)/2&&l<f-c*(1-s)/2)return $ie(e)}return h=h||a,h&&(l<u+c*i/2||l>f-c*i/2)?l>u+c/2?1:-1:0}function $ie(t){return $r(rt)<$r(t)?1:-1}function Vie(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,r=e.length,n=0;r--;)n+=e.charCodeAt(r);return n.toString(36)}function Hie(t){Oh.length=0;for(var e=t.getElementsByTagName("input"),r=e.length;r--;){var n=e[r];n.checked&&Oh.push(n)}}function R0(t){return setTimeout(t,0)}function t1(t){return clearTimeout(t)}Hp&&Kt(document,"touchmove",function(t){(Tt.active||Wl)&&t.cancelable&&t.preventDefault()});Tt.utils={on:Kt,off:zt,css:ft,find:sD,is:function(e,r){return!!na(e,r,e,!1)},extend:Tie,throttle:aD,closest:na,toggleClass:Fr,clone:Ix,index:$r,nextTick:R0,cancelNextTick:t1,detectDirection:lD,getChild:Pc};Tt.get=function(t){return t[zn]};Tt.mount=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e[0].constructor===Array&&(e=e[0]),e.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(Tt.utils=$a($a({},Tt.utils),n.utils)),hf.mount(n)})};Tt.create=function(t,e){return new Tt(t,e)};Tt.version=_ie;var Qr=[],wu,r1,n1=!1,Dg,Pg,Mh,Cu;function jie(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(r){var n=r.originalEvent;this.sortable.nativeDraggable?Kt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Kt(document,"pointermove",this._handleFallbackAutoScroll):n.touches?Kt(document,"touchmove",this._handleFallbackAutoScroll):Kt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var n=r.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?zt(document,"dragover",this._handleAutoScroll):(zt(document,"pointermove",this._handleFallbackAutoScroll),zt(document,"touchmove",this._handleFallbackAutoScroll),zt(document,"mousemove",this._handleFallbackAutoScroll)),$S(),F0(),wie()},nulling:function(){Mh=r1=wu=n1=Cu=Dg=Pg=null,Qr.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,n){var s=this,i=(r.touches?r.touches[0]:r).clientX,a=(r.touches?r.touches[0]:r).clientY,o=document.elementFromPoint(i,a);if(Mh=r,n||this.options.forceAutoScrollFallback||ff||Di||ed){Rg(r,this.options,o,n);var l=eo(o,!0);n1&&(!Cu||i!==Dg||a!==Pg)&&(Cu&&$S(),Cu=setInterval(function(){var c=eo(document.elementFromPoint(i,a),!0);c!==l&&(l=c,F0()),Rg(r,s.options,c,n)},10),Dg=i,Pg=a)}else{if(!this.options.bubbleScroll||eo(o,!0)===Oa()){F0();return}Rg(r,this.options,eo(o,!1),!1)}}},zs(t,{pluginName:"scroll",initializeByDefault:!0})}function F0(){Qr.forEach(function(t){clearInterval(t.pid)}),Qr=[]}function $S(){clearInterval(Cu)}var Rg=aD(function(t,e,r,n){if(e.scroll){var s=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,l=Oa(),c=!1,u;r1!==r&&(r1=r,F0(),wu=e.scroll,u=e.scrollFn,wu===!0&&(wu=eo(r,!0)));var f=0,h=wu;do{var p=h,v=Pr(p),g=v.top,y=v.bottom,b=v.left,E=v.right,x=v.width,I=v.height,D=void 0,P=void 0,w=p.scrollWidth,S=p.scrollHeight,m=ft(p),T=p.scrollLeft,_=p.scrollTop;p===l?(D=x<w&&(m.overflowX==="auto"||m.overflowX==="scroll"||m.overflowX==="visible"),P=I<S&&(m.overflowY==="auto"||m.overflowY==="scroll"||m.overflowY==="visible")):(D=x<w&&(m.overflowX==="auto"||m.overflowX==="scroll"),P=I<S&&(m.overflowY==="auto"||m.overflowY==="scroll"));var A=D&&(Math.abs(E-s)<=a&&T+x<w)-(Math.abs(b-s)<=a&&!!T),k=P&&(Math.abs(y-i)<=a&&_+I<S)-(Math.abs(g-i)<=a&&!!_);if(!Qr[f])for(var U=0;U<=f;U++)Qr[U]||(Qr[U]={});(Qr[f].vx!=A||Qr[f].vy!=k||Qr[f].el!==p)&&(Qr[f].el=p,Qr[f].vx=A,Qr[f].vy=k,clearInterval(Qr[f].pid),(A!=0||k!=0)&&(c=!0,Qr[f].pid=setInterval((function(){n&&this.layer===0&&Tt.active._onTouchMove(Mh);var L=Qr[this.layer].vy?Qr[this.layer].vy*o:0,R=Qr[this.layer].vx?Qr[this.layer].vx*o:0;typeof u=="function"&&u.call(Tt.dragged.parentNode[zn],R,L,t,Mh,Qr[this.layer].el)!=="continue"||iD(Qr[this.layer].el,R,L)}).bind({layer:f}),24))),f++}while(e.bubbleScroll&&h!==l&&(h=eo(h,!1)));n1=c}},30),fD=function(e){var r=e.originalEvent,n=e.putSortable,s=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(r){var c=n||i;o();var u=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,f=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(f)&&(a("spill"),this.onSpill({dragEl:s,putSortable:n}))}};function kx(){}kx.prototype={startIndex:null,dragStart:function(e){var r=e.oldDraggableIndex;this.startIndex=r},onSpill:function(e){var r=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var s=Pc(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(r,s):this.sortable.el.appendChild(r),this.sortable.animateAll(),n&&n.animateAll()},drop:fD};zs(kx,{pluginName:"revertOnSpill"});function Dx(){}Dx.prototype={onSpill:function(e){var r=e.dragEl,n=e.putSortable,s=n||this.sortable;s.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),s.animateAll()},drop:fD};zs(Dx,{pluginName:"removeOnSpill"});var Ls;function Gie(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(r){var n=r.dragEl;Ls=n},dragOverValid:function(r){var n=r.completed,s=r.target,i=r.onMove,a=r.activeSortable,o=r.changed,l=r.cancel;if(a.options.swap){var c=this.sortable.el,u=this.options;if(s&&s!==c){var f=Ls;i(s)!==!1?(Fr(s,u.swapClass,!0),Ls=s):Ls=null,f&&f!==Ls&&Fr(f,u.swapClass,!1)}o(),n(!0),l()}},drop:function(r){var n=r.activeSortable,s=r.putSortable,i=r.dragEl,a=s||this.sortable,o=this.options;Ls&&Fr(Ls,o.swapClass,!1),Ls&&(o.swap||s&&s.options.swap)&&i!==Ls&&(a.captureAnimationState(),a!==n&&n.captureAnimationState(),Wie(i,Ls),a.animateAll(),a!==n&&n.animateAll())},nulling:function(){Ls=null}},zs(t,{pluginName:"swap",eventProperties:function(){return{swapItem:Ls}}})}function Wie(t,e){var r=t.parentNode,n=e.parentNode,s,i;!r||!n||r.isEqualNode(e)||n.isEqualNode(t)||(s=$r(t),i=$r(e),r.isEqualNode(n)&&s<i&&i++,r.insertBefore(e,r.children[s]),n.insertBefore(t,n.children[i]))}var Rt=[],Ss=[],du,ra,fu=!1,ms=!1,Ml=!1,Er,hu,i0;function zie(){function t(e){for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));e.options.supportPointer?Kt(document,"pointerup",this._deselectMultiDrag):(Kt(document,"mouseup",this._deselectMultiDrag),Kt(document,"touchend",this._deselectMultiDrag)),Kt(document,"keydown",this._checkKeyDown),Kt(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(s,i){var a="";Rt.length&&ra===e?Rt.forEach(function(o,l){a+=(l?", ":"")+o.textContent}):a=i.textContent,s.setData("Text",a)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(r){var n=r.dragEl;Er=n},delayEnded:function(){this.isMultiDrag=~Rt.indexOf(Er)},setupClone:function(r){var n=r.sortable,s=r.cancel;if(this.isMultiDrag){for(var i=0;i<Rt.length;i++)Ss.push(Ix(Rt[i])),Ss[i].sortableIndex=Rt[i].sortableIndex,Ss[i].draggable=!1,Ss[i].style["will-change"]="",Fr(Ss[i],this.options.selectedClass,!1),Rt[i]===Er&&Fr(Ss[i],this.options.chosenClass,!1);n._hideClone(),s()}},clone:function(r){var n=r.sortable,s=r.rootEl,i=r.dispatchSortableEvent,a=r.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Rt.length&&ra===n&&(VS(!0,s),i("clone"),a()))},showClone:function(r){var n=r.cloneNowShown,s=r.rootEl,i=r.cancel;this.isMultiDrag&&(VS(!1,s),Ss.forEach(function(a){ft(a,"display","")}),n(),i0=!1,i())},hideClone:function(r){var n=this;r.sortable;var s=r.cloneNowHidden,i=r.cancel;this.isMultiDrag&&(Ss.forEach(function(a){ft(a,"display","none"),n.options.removeCloneOnHide&&a.parentNode&&a.parentNode.removeChild(a)}),s(),i0=!0,i())},dragStartGlobal:function(r){r.sortable,!this.isMultiDrag&&ra&&ra.multiDrag._deselectMultiDrag(),Rt.forEach(function(n){n.sortableIndex=$r(n)}),Rt=Rt.sort(function(n,s){return n.sortableIndex-s.sortableIndex}),Ml=!0},dragStarted:function(r){var n=this,s=r.sortable;if(this.isMultiDrag){if(this.options.sort&&(s.captureAnimationState(),this.options.animation)){Rt.forEach(function(a){a!==Er&&ft(a,"position","absolute")});var i=Pr(Er,!1,!0,!0);Rt.forEach(function(a){a!==Er&&MS(a,i)}),ms=!0,fu=!0}s.animateAll(function(){ms=!1,fu=!1,n.options.animation&&Rt.forEach(function(a){Ag(a)}),n.options.sort&&o0()})}},dragOver:function(r){var n=r.target,s=r.completed,i=r.cancel;ms&&~Rt.indexOf(n)&&(s(!1),i())},revert:function(r){var n=r.fromSortable,s=r.rootEl,i=r.sortable,a=r.dragRect;Rt.length>1&&(Rt.forEach(function(o){i.addAnimationState({target:o,rect:ms?Pr(o):a}),Ag(o),o.fromRect=a,n.removeAnimationState(o)}),ms=!1,Kie(!this.options.removeCloneOnHide,s))},dragOverCompleted:function(r){var n=r.sortable,s=r.isOwner,i=r.insertion,a=r.activeSortable,o=r.parentEl,l=r.putSortable,c=this.options;if(i){if(s&&a._hideClone(),fu=!1,c.animation&&Rt.length>1&&(ms||!s&&!a.options.sort&&!l)){var u=Pr(Er,!1,!0,!0);Rt.forEach(function(h){h!==Er&&(MS(h,u),o.appendChild(h))}),ms=!0}if(!s)if(ms||o0(),Rt.length>1){var f=i0;a._showClone(n),a.options.animation&&!i0&&f&&Ss.forEach(function(h){a.addAnimationState({target:h,rect:hu}),h.fromRect=hu,h.thisAnimationDuration=null})}else a._showClone(n)}},dragOverAnimationCapture:function(r){var n=r.dragRect,s=r.isOwner,i=r.activeSortable;if(Rt.forEach(function(o){o.thisAnimationDuration=null}),i.options.animation&&!s&&i.multiDrag.isMultiDrag){hu=zs({},n);var a=Ko(Er,!0);hu.top-=a.f,hu.left-=a.e}},dragOverAnimationComplete:function(){ms&&(ms=!1,o0())},drop:function(r){var n=r.originalEvent,s=r.rootEl,i=r.parentEl,a=r.sortable,o=r.dispatchSortableEvent,l=r.oldIndex,c=r.putSortable,u=c||this.sortable;if(n){var f=this.options,h=i.children;if(!Ml)if(f.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Fr(Er,f.selectedClass,!~Rt.indexOf(Er)),~Rt.indexOf(Er))Rt.splice(Rt.indexOf(Er),1),du=null,Au({sortable:a,rootEl:s,name:"deselect",targetEl:Er});else{if(Rt.push(Er),Au({sortable:a,rootEl:s,name:"select",targetEl:Er}),n.shiftKey&&du&&a.el.contains(du)){var p=$r(du),v=$r(Er);if(~p&&~v&&p!==v){var g,y;for(v>p?(y=p,g=v):(y=v,g=p+1);y<g;y++)~Rt.indexOf(h[y])||(Fr(h[y],f.selectedClass,!0),Rt.push(h[y]),Au({sortable:a,rootEl:s,name:"select",targetEl:h[y]}))}}else du=Er;ra=u}if(Ml&&this.isMultiDrag){if(ms=!1,(i[zn].options.sort||i!==s)&&Rt.length>1){var b=Pr(Er),E=$r(Er,":not(."+this.options.selectedClass+")");if(!fu&&f.animation&&(Er.thisAnimationDuration=null),u.captureAnimationState(),!fu&&(f.animation&&(Er.fromRect=b,Rt.forEach(function(I){if(I.thisAnimationDuration=null,I!==Er){var D=ms?Pr(I):b;I.fromRect=D,u.addAnimationState({target:I,rect:D})}})),o0(),Rt.forEach(function(I){h[E]?i.insertBefore(I,h[E]):i.appendChild(I),E++}),l===$r(Er))){var x=!1;Rt.forEach(function(I){if(I.sortableIndex!==$r(I)){x=!0;return}}),x&&o("update")}Rt.forEach(function(I){Ag(I)}),u.animateAll()}ra=u}(s===i||c&&c.lastPutMode!=="clone")&&Ss.forEach(function(I){I.parentNode&&I.parentNode.removeChild(I)})}},nullingGlobal:function(){this.isMultiDrag=Ml=!1,Ss.length=0},destroyGlobal:function(){this._deselectMultiDrag(),zt(document,"pointerup",this._deselectMultiDrag),zt(document,"mouseup",this._deselectMultiDrag),zt(document,"touchend",this._deselectMultiDrag),zt(document,"keydown",this._checkKeyDown),zt(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(r){if(!(typeof Ml<"u"&&Ml)&&ra===this.sortable&&!(r&&na(r.target,this.options.draggable,this.sortable.el,!1))&&!(r&&r.button!==0))for(;Rt.length;){var n=Rt[0];Fr(n,this.options.selectedClass,!1),Rt.shift(),Au({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:n})}},_checkKeyDown:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},zs(t,{pluginName:"multiDrag",utils:{select:function(r){var n=r.parentNode[zn];!n||!n.options.multiDrag||~Rt.indexOf(r)||(ra&&ra!==n&&(ra.multiDrag._deselectMultiDrag(),ra=n),Fr(r,n.options.selectedClass,!0),Rt.push(r))},deselect:function(r){var n=r.parentNode[zn],s=Rt.indexOf(r);!n||!n.options.multiDrag||!~s||(Fr(r,n.options.selectedClass,!1),Rt.splice(s,1))}},eventProperties:function(){var r=this,n=[],s=[];return Rt.forEach(function(i){n.push({multiDragElement:i,index:i.sortableIndex});var a;ms&&i!==Er?a=-1:ms?a=$r(i,":not(."+r.options.selectedClass+")"):a=$r(i),s.push({multiDragElement:i,index:a})}),{items:gie(Rt),clones:[].concat(Ss),oldIndicies:n,newIndicies:s}},optionListeners:{multiDragKey:function(r){return r=r.toLowerCase(),r==="ctrl"?r="Control":r.length>1&&(r=r.charAt(0).toUpperCase()+r.substr(1)),r}}})}function Kie(t,e){Rt.forEach(function(r,n){var s=e.children[r.sortableIndex+(t?Number(n):0)];s?e.insertBefore(r,s):e.appendChild(r)})}function VS(t,e){Ss.forEach(function(r,n){var s=e.children[r.sortableIndex+(t?Number(n):0)];s?e.insertBefore(r,s):e.appendChild(r)})}function o0(){Rt.forEach(function(t){t!==Er&&t.parentNode&&t.parentNode.removeChild(t)})}Tt.mount(new jie);Tt.mount(Dx,kx);const qie=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:zie,Sortable:Tt,Swap:Gie,default:Tt},Symbol.toStringTag,{value:"Module"})),Xie=Xy(qie);(function(t,e){(function(n,s){t.exports=s(fie,Xie)})(typeof self<"u"?self:$t,function(r,n){return function(s){var i={};function a(o){if(i[o])return i[o].exports;var l=i[o]={i:o,l:!1,exports:{}};return s[o].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=s,a.c=i,a.d=function(o,l,c){a.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,l){if(l&1&&(o=a(o)),l&8||l&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),l&2&&typeof o!="string")for(var u in o)a.d(c,u,(function(f){return o[f]}).bind(null,u));return c},a.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(l,"a",l),l},a.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},a.p="",a(a.s="fb15")}({"00ee":function(s,i,a){var o=a("b622"),l=o("toStringTag"),c={};c[l]="z",s.exports=String(c)==="[object z]"},"0366":function(s,i,a){var o=a("1c0b");s.exports=function(l,c,u){if(o(l),c===void 0)return l;switch(u){case 0:return function(){return l.call(c)};case 1:return function(f){return l.call(c,f)};case 2:return function(f,h){return l.call(c,f,h)};case 3:return function(f,h,p){return l.call(c,f,h,p)}}return function(){return l.apply(c,arguments)}}},"057f":function(s,i,a){var o=a("fc6a"),l=a("241c").f,c={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(h){try{return l(h)}catch{return u.slice()}};s.exports.f=function(p){return u&&c.call(p)=="[object Window]"?f(p):l(o(p))}},"06cf":function(s,i,a){var o=a("83ab"),l=a("d1e7"),c=a("5c6c"),u=a("fc6a"),f=a("c04e"),h=a("5135"),p=a("0cfb"),v=Object.getOwnPropertyDescriptor;i.f=o?v:function(y,b){if(y=u(y),b=f(b,!0),p)try{return v(y,b)}catch{}if(h(y,b))return c(!l.f.call(y,b),y[b])}},"0cfb":function(s,i,a){var o=a("83ab"),l=a("d039"),c=a("cc12");s.exports=!o&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(s,i,a){var o=a("23e7"),l=a("d58f").left,c=a("a640"),u=a("ae40"),f=c("reduce"),h=u("reduce",{1:0});o({target:"Array",proto:!0,forced:!f||!h},{reduce:function(v){return l(this,v,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(s,i,a){var o=a("c6b6"),l=a("9263");s.exports=function(c,u){var f=c.exec;if(typeof f=="function"){var h=f.call(c,u);if(typeof h!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return h}if(o(c)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(c,u)}},"159b":function(s,i,a){var o=a("da84"),l=a("fdbc"),c=a("17c2"),u=a("9112");for(var f in l){var h=o[f],p=h&&h.prototype;if(p&&p.forEach!==c)try{u(p,"forEach",c)}catch{p.forEach=c}}},"17c2":function(s,i,a){var o=a("b727").forEach,l=a("a640"),c=a("ae40"),u=l("forEach"),f=c("forEach");s.exports=!u||!f?function(p){return o(this,p,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(s,i,a){var o=a("d066");s.exports=o("document","documentElement")},"1c0b":function(s,i){s.exports=function(a){if(typeof a!="function")throw TypeError(String(a)+" is not a function");return a}},"1c7e":function(s,i,a){var o=a("b622"),l=o("iterator"),c=!1;try{var u=0,f={next:function(){return{done:!!u++}},return:function(){c=!0}};f[l]=function(){return this},Array.from(f,function(){throw 2})}catch{}s.exports=function(h,p){if(!p&&!c)return!1;var v=!1;try{var g={};g[l]=function(){return{next:function(){return{done:v=!0}}}},h(g)}catch{}return v}},"1d80":function(s,i){s.exports=function(a){if(a==null)throw TypeError("Can't call method on "+a);return a}},"1dde":function(s,i,a){var o=a("d039"),l=a("b622"),c=a("2d00"),u=l("species");s.exports=function(f){return c>=51||!o(function(){var h=[],p=h.constructor={};return p[u]=function(){return{foo:1}},h[f](Boolean).foo!==1})}},"23cb":function(s,i,a){var o=a("a691"),l=Math.max,c=Math.min;s.exports=function(u,f){var h=o(u);return h<0?l(h+f,0):c(h,f)}},"23e7":function(s,i,a){var o=a("da84"),l=a("06cf").f,c=a("9112"),u=a("6eeb"),f=a("ce4e"),h=a("e893"),p=a("94ca");s.exports=function(v,g){var y=v.target,b=v.global,E=v.stat,x,I,D,P,w,S;if(b?I=o:E?I=o[y]||f(y,{}):I=(o[y]||{}).prototype,I)for(D in g){if(w=g[D],v.noTargetGet?(S=l(I,D),P=S&&S.value):P=I[D],x=p(b?D:y+(E?".":"#")+D,v.forced),!x&&P!==void 0){if(typeof w==typeof P)continue;h(w,P)}(v.sham||P&&P.sham)&&c(w,"sham",!0),u(I,D,w,v)}}},"241c":function(s,i,a){var o=a("ca84"),l=a("7839"),c=l.concat("length","prototype");i.f=Object.getOwnPropertyNames||function(f){return o(f,c)}},"25f0":function(s,i,a){var o=a("6eeb"),l=a("825a"),c=a("d039"),u=a("ad6d"),f="toString",h=RegExp.prototype,p=h[f],v=c(function(){return p.call({source:"a",flags:"b"})!="/a/b"}),g=p.name!=f;(v||g)&&o(RegExp.prototype,f,function(){var b=l(this),E=String(b.source),x=b.flags,I=String(x===void 0&&b instanceof RegExp&&!("flags"in h)?u.call(b):x);return"/"+E+"/"+I},{unsafe:!0})},"2ca0":function(s,i,a){var o=a("23e7"),l=a("06cf").f,c=a("50c4"),u=a("5a34"),f=a("1d80"),h=a("ab13"),p=a("c430"),v="".startsWith,g=Math.min,y=h("startsWith"),b=!p&&!y&&!!function(){var E=l(String.prototype,"startsWith");return E&&!E.writable}();o({target:"String",proto:!0,forced:!b&&!y},{startsWith:function(x){var I=String(f(this));u(x);var D=c(g(arguments.length>1?arguments[1]:void 0,I.length)),P=String(x);return v?v.call(I,P,D):I.slice(D,D+P.length)===P}})},"2d00":function(s,i,a){var o=a("da84"),l=a("342f"),c=o.process,u=c&&c.versions,f=u&&u.v8,h,p;f?(h=f.split("."),p=h[0]+h[1]):l&&(h=l.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=l.match(/Chrome\/(\d+)/),h&&(p=h[1]))),s.exports=p&&+p},"342f":function(s,i,a){var o=a("d066");s.exports=o("navigator","userAgent")||""},"35a1":function(s,i,a){var o=a("f5df"),l=a("3f8c"),c=a("b622"),u=c("iterator");s.exports=function(f){if(f!=null)return f[u]||f["@@iterator"]||l[o(f)]}},"37e8":function(s,i,a){var o=a("83ab"),l=a("9bf2"),c=a("825a"),u=a("df75");s.exports=o?Object.defineProperties:function(h,p){c(h);for(var v=u(p),g=v.length,y=0,b;g>y;)l.f(h,b=v[y++],p[b]);return h}},"3bbe":function(s,i,a){var o=a("861d");s.exports=function(l){if(!o(l)&&l!==null)throw TypeError("Can't set "+String(l)+" as a prototype");return l}},"3ca3":function(s,i,a){var o=a("6547").charAt,l=a("69f3"),c=a("7dd0"),u="String Iterator",f=l.set,h=l.getterFor(u);c(String,"String",function(p){f(this,{type:u,string:String(p),index:0})},function(){var v=h(this),g=v.string,y=v.index,b;return y>=g.length?{value:void 0,done:!0}:(b=o(g,y),v.index+=b.length,{value:b,done:!1})})},"3f8c":function(s,i){s.exports={}},4160:function(s,i,a){var o=a("23e7"),l=a("17c2");o({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},"428f":function(s,i,a){var o=a("da84");s.exports=o},"44ad":function(s,i,a){var o=a("d039"),l=a("c6b6"),c="".split;s.exports=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(u){return l(u)=="String"?c.call(u,""):Object(u)}:Object},"44d2":function(s,i,a){var o=a("b622"),l=a("7c73"),c=a("9bf2"),u=o("unscopables"),f=Array.prototype;f[u]==null&&c.f(f,u,{configurable:!0,value:l(null)}),s.exports=function(h){f[u][h]=!0}},"44e7":function(s,i,a){var o=a("861d"),l=a("c6b6"),c=a("b622"),u=c("match");s.exports=function(f){var h;return o(f)&&((h=f[u])!==void 0?!!h:l(f)=="RegExp")}},4930:function(s,i,a){var o=a("d039");s.exports=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())})},"4d64":function(s,i,a){var o=a("fc6a"),l=a("50c4"),c=a("23cb"),u=function(f){return function(h,p,v){var g=o(h),y=l(g.length),b=c(v,y),E;if(f&&p!=p){for(;y>b;)if(E=g[b++],E!=E)return!0}else for(;y>b;b++)if((f||b in g)&&g[b]===p)return f||b||0;return!f&&-1}};s.exports={includes:u(!0),indexOf:u(!1)}},"4de4":function(s,i,a){var o=a("23e7"),l=a("b727").filter,c=a("1dde"),u=a("ae40"),f=c("filter"),h=u("filter");o({target:"Array",proto:!0,forced:!f||!h},{filter:function(v){return l(this,v,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(s,i,a){var o=a("0366"),l=a("7b0b"),c=a("9bdd"),u=a("e95a"),f=a("50c4"),h=a("8418"),p=a("35a1");s.exports=function(g){var y=l(g),b=typeof this=="function"?this:Array,E=arguments.length,x=E>1?arguments[1]:void 0,I=x!==void 0,D=p(y),P=0,w,S,m,T,_,A;if(I&&(x=o(x,E>2?arguments[2]:void 0,2)),D!=null&&!(b==Array&&u(D)))for(T=D.call(y),_=T.next,S=new b;!(m=_.call(T)).done;P++)A=I?c(T,x,[m.value,P],!0):m.value,h(S,P,A);else for(w=f(y.length),S=new b(w);w>P;P++)A=I?x(y[P],P):y[P],h(S,P,A);return S.length=P,S}},"4fad":function(s,i,a){var o=a("23e7"),l=a("6f53").entries;o({target:"Object",stat:!0},{entries:function(u){return l(u)}})},"50c4":function(s,i,a){var o=a("a691"),l=Math.min;s.exports=function(c){return c>0?l(o(c),9007199254740991):0}},5135:function(s,i){var a={}.hasOwnProperty;s.exports=function(o,l){return a.call(o,l)}},5319:function(s,i,a){var o=a("d784"),l=a("825a"),c=a("7b0b"),u=a("50c4"),f=a("a691"),h=a("1d80"),p=a("8aa5"),v=a("14c3"),g=Math.max,y=Math.min,b=Math.floor,E=/\$([$&'`]|\d\d?|<[^>]*>)/g,x=/\$([$&'`]|\d\d?)/g,I=function(D){return D===void 0?D:String(D)};o("replace",2,function(D,P,w,S){var m=S.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,T=S.REPLACE_KEEPS_$0,_=m?"$":"$0";return[function(U,L){var R=h(this),F=U==null?void 0:U[D];return F!==void 0?F.call(U,R,L):P.call(String(R),U,L)},function(k,U){if(!m&&T||typeof U=="string"&&U.indexOf(_)===-1){var L=w(P,k,this,U);if(L.done)return L.value}var R=l(k),F=String(this),N=typeof U=="function";N||(U=String(U));var M=R.global;if(M){var z=R.unicode;R.lastIndex=0}for(var G=[];;){var H=v(R,F);if(H===null||(G.push(H),!M))break;var j=String(H[0]);j===""&&(R.lastIndex=p(F,u(R.lastIndex),z))}for(var K="",ne=0,he=0;he<G.length;he++){H=G[he];for(var le=String(H[0]),fe=g(y(f(H.index),F.length),0),te=[],Z=1;Z<H.length;Z++)te.push(I(H[Z]));var xe=H.groups;if(N){var Q=[le].concat(te,fe,F);xe!==void 0&&Q.push(xe);var q=String(U.apply(void 0,Q))}else q=A(le,F,fe,te,xe,U);fe>=ne&&(K+=F.slice(ne,fe)+q,ne=fe+le.length)}return K+F.slice(ne)}];function A(k,U,L,R,F,N){var M=L+k.length,z=R.length,G=x;return F!==void 0&&(F=c(F),G=E),P.call(N,G,function(H,j){var K;switch(j.charAt(0)){case"$":return"$";case"&":return k;case"`":return U.slice(0,L);case"'":return U.slice(M);case"<":K=F[j.slice(1,-1)];break;default:var ne=+j;if(ne===0)return H;if(ne>z){var he=b(ne/10);return he===0?H:he<=z?R[he-1]===void 0?j.charAt(1):R[he-1]+j.charAt(1):H}K=R[ne-1]}return K===void 0?"":K})}})},5692:function(s,i,a){var o=a("c430"),l=a("c6cd");(s.exports=function(c,u){return l[c]||(l[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.6.5",mode:o?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(s,i,a){var o=a("d066"),l=a("241c"),c=a("7418"),u=a("825a");s.exports=o("Reflect","ownKeys")||function(h){var p=l.f(u(h)),v=c.f;return v?p.concat(v(h)):p}},"5a34":function(s,i,a){var o=a("44e7");s.exports=function(l){if(o(l))throw TypeError("The method doesn't accept regular expressions");return l}},"5c6c":function(s,i){s.exports=function(a,o){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:o}}},"5db7":function(s,i,a){var o=a("23e7"),l=a("a2bf"),c=a("7b0b"),u=a("50c4"),f=a("1c0b"),h=a("65f0");o({target:"Array",proto:!0},{flatMap:function(v){var g=c(this),y=u(g.length),b;return f(v),b=h(g,0),b.length=l(b,g,g,y,0,1,v,arguments.length>1?arguments[1]:void 0),b}})},6547:function(s,i,a){var o=a("a691"),l=a("1d80"),c=function(u){return function(f,h){var p=String(l(f)),v=o(h),g=p.length,y,b;return v<0||v>=g?u?"":void 0:(y=p.charCodeAt(v),y<55296||y>56319||v+1===g||(b=p.charCodeAt(v+1))<56320||b>57343?u?p.charAt(v):y:u?p.slice(v,v+2):(y-55296<<10)+(b-56320)+65536)}};s.exports={codeAt:c(!1),charAt:c(!0)}},"65f0":function(s,i,a){var o=a("861d"),l=a("e8b5"),c=a("b622"),u=c("species");s.exports=function(f,h){var p;return l(f)&&(p=f.constructor,typeof p=="function"&&(p===Array||l(p.prototype))?p=void 0:o(p)&&(p=p[u],p===null&&(p=void 0))),new(p===void 0?Array:p)(h===0?0:h)}},"69f3":function(s,i,a){var o=a("7f9a"),l=a("da84"),c=a("861d"),u=a("9112"),f=a("5135"),h=a("f772"),p=a("d012"),v=l.WeakMap,g,y,b,E=function(m){return b(m)?y(m):g(m,{})},x=function(m){return function(T){var _;if(!c(T)||(_=y(T)).type!==m)throw TypeError("Incompatible receiver, "+m+" required");return _}};if(o){var I=new v,D=I.get,P=I.has,w=I.set;g=function(m,T){return w.call(I,m,T),T},y=function(m){return D.call(I,m)||{}},b=function(m){return P.call(I,m)}}else{var S=h("state");p[S]=!0,g=function(m,T){return u(m,S,T),T},y=function(m){return f(m,S)?m[S]:{}},b=function(m){return f(m,S)}}s.exports={set:g,get:y,has:b,enforce:E,getterFor:x}},"6eeb":function(s,i,a){var o=a("da84"),l=a("9112"),c=a("5135"),u=a("ce4e"),f=a("8925"),h=a("69f3"),p=h.get,v=h.enforce,g=String(String).split("String");(s.exports=function(y,b,E,x){var I=x?!!x.unsafe:!1,D=x?!!x.enumerable:!1,P=x?!!x.noTargetGet:!1;if(typeof E=="function"&&(typeof b=="string"&&!c(E,"name")&&l(E,"name",b),v(E).source=g.join(typeof b=="string"?b:"")),y===o){D?y[b]=E:u(b,E);return}else I?!P&&y[b]&&(D=!0):delete y[b];D?y[b]=E:l(y,b,E)})(Function.prototype,"toString",function(){return typeof this=="function"&&p(this).source||f(this)})},"6f53":function(s,i,a){var o=a("83ab"),l=a("df75"),c=a("fc6a"),u=a("d1e7").f,f=function(h){return function(p){for(var v=c(p),g=l(v),y=g.length,b=0,E=[],x;y>b;)x=g[b++],(!o||u.call(v,x))&&E.push(h?[x,v[x]]:v[x]);return E}};s.exports={entries:f(!0),values:f(!1)}},"73d9":function(s,i,a){var o=a("44d2");o("flatMap")},7418:function(s,i){i.f=Object.getOwnPropertySymbols},"746f":function(s,i,a){var o=a("428f"),l=a("5135"),c=a("e538"),u=a("9bf2").f;s.exports=function(f){var h=o.Symbol||(o.Symbol={});l(h,f)||u(h,f,{value:c.f(f)})}},7839:function(s,i){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(s,i,a){var o=a("1d80");s.exports=function(l){return Object(o(l))}},"7c73":function(s,i,a){var o=a("825a"),l=a("37e8"),c=a("7839"),u=a("d012"),f=a("1be4"),h=a("cc12"),p=a("f772"),v=">",g="<",y="prototype",b="script",E=p("IE_PROTO"),x=function(){},I=function(m){return g+b+v+m+g+"/"+b+v},D=function(m){m.write(I("")),m.close();var T=m.parentWindow.Object;return m=null,T},P=function(){var m=h("iframe"),T="java"+b+":",_;return m.style.display="none",f.appendChild(m),m.src=String(T),_=m.contentWindow.document,_.open(),_.write(I("document.F=Object")),_.close(),_.F},w,S=function(){try{w=document.domain&&new ActiveXObject("htmlfile")}catch{}S=w?D(w):P();for(var m=c.length;m--;)delete S[y][c[m]];return S()};u[E]=!0,s.exports=Object.create||function(T,_){var A;return T!==null?(x[y]=o(T),A=new x,x[y]=null,A[E]=T):A=S(),_===void 0?A:l(A,_)}},"7dd0":function(s,i,a){var o=a("23e7"),l=a("9ed3"),c=a("e163"),u=a("d2bb"),f=a("d44e"),h=a("9112"),p=a("6eeb"),v=a("b622"),g=a("c430"),y=a("3f8c"),b=a("ae93"),E=b.IteratorPrototype,x=b.BUGGY_SAFARI_ITERATORS,I=v("iterator"),D="keys",P="values",w="entries",S=function(){return this};s.exports=function(m,T,_,A,k,U,L){l(_,T,A);var R=function(he){if(he===k&&G)return G;if(!x&&he in M)return M[he];switch(he){case D:return function(){return new _(this,he)};case P:return function(){return new _(this,he)};case w:return function(){return new _(this,he)}}return function(){return new _(this)}},F=T+" Iterator",N=!1,M=m.prototype,z=M[I]||M["@@iterator"]||k&&M[k],G=!x&&z||R(k),H=T=="Array"&&M.entries||z,j,K,ne;if(H&&(j=c(H.call(new m)),E!==Object.prototype&&j.next&&(!g&&c(j)!==E&&(u?u(j,E):typeof j[I]!="function"&&h(j,I,S)),f(j,F,!0,!0),g&&(y[F]=S))),k==P&&z&&z.name!==P&&(N=!0,G=function(){return z.call(this)}),(!g||L)&&M[I]!==G&&h(M,I,G),y[T]=G,k)if(K={values:R(P),keys:U?G:R(D),entries:R(w)},L)for(ne in K)(x||N||!(ne in M))&&p(M,ne,K[ne]);else o({target:T,proto:!0,forced:x||N},K);return K}},"7f9a":function(s,i,a){var o=a("da84"),l=a("8925"),c=o.WeakMap;s.exports=typeof c=="function"&&/native code/.test(l(c))},"825a":function(s,i,a){var o=a("861d");s.exports=function(l){if(!o(l))throw TypeError(String(l)+" is not an object");return l}},"83ab":function(s,i,a){var o=a("d039");s.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(s,i,a){var o=a("c04e"),l=a("9bf2"),c=a("5c6c");s.exports=function(u,f,h){var p=o(f);p in u?l.f(u,p,c(0,h)):u[p]=h}},"861d":function(s,i){s.exports=function(a){return typeof a=="object"?a!==null:typeof a=="function"}},8875:function(s,i,a){var o,l,c;(function(u,f){l=[],o=f,c=typeof o=="function"?o.apply(i,l):o,c!==void 0&&(s.exports=c)})(typeof self<"u"?self:this,function(){function u(){var f=Object.getOwnPropertyDescriptor(document,"currentScript");if(!f&&"currentScript"in document&&document.currentScript||f&&f.get!==u&&document.currentScript)return document.currentScript;try{throw new Error}catch(w){var h=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,p=/@([^@]*):(\d+):(\d+)\s*$/ig,v=h.exec(w.stack)||p.exec(w.stack),g=v&&v[1]||!1,y=v&&v[2]||!1,b=document.location.href.replace(document.location.hash,""),E,x,I,D=document.getElementsByTagName("script");g===b&&(E=document.documentElement.outerHTML,x=new RegExp("(?:[^\\n]+?\\n){0,"+(y-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),I=E.replace(x,"$1").trim());for(var P=0;P<D.length;P++)if(D[P].readyState==="interactive"||D[P].src===g||g===b&&D[P].innerHTML&&D[P].innerHTML.trim()===I)return D[P];return null}}return u})},8925:function(s,i,a){var o=a("c6cd"),l=Function.toString;typeof o.inspectSource!="function"&&(o.inspectSource=function(c){return l.call(c)}),s.exports=o.inspectSource},"8aa5":function(s,i,a){var o=a("6547").charAt;s.exports=function(l,c,u){return c+(u?o(l,c).length:1)}},"8bbf":function(s,i){s.exports=r},"90e3":function(s,i){var a=0,o=Math.random();s.exports=function(l){return"Symbol("+String(l===void 0?"":l)+")_"+(++a+o).toString(36)}},9112:function(s,i,a){var o=a("83ab"),l=a("9bf2"),c=a("5c6c");s.exports=o?function(u,f,h){return l.f(u,f,c(1,h))}:function(u,f,h){return u[f]=h,u}},9263:function(s,i,a){var o=a("ad6d"),l=a("9f7f"),c=RegExp.prototype.exec,u=String.prototype.replace,f=c,h=function(){var y=/a/,b=/b*/g;return c.call(y,"a"),c.call(b,"a"),y.lastIndex!==0||b.lastIndex!==0}(),p=l.UNSUPPORTED_Y||l.BROKEN_CARET,v=/()??/.exec("")[1]!==void 0,g=h||v||p;g&&(f=function(b){var E=this,x,I,D,P,w=p&&E.sticky,S=o.call(E),m=E.source,T=0,_=b;return w&&(S=S.replace("y",""),S.indexOf("g")===-1&&(S+="g"),_=String(b).slice(E.lastIndex),E.lastIndex>0&&(!E.multiline||E.multiline&&b[E.lastIndex-1]!==`
`)&&(m="(?: "+m+")",_=" "+_,T++),I=new RegExp("^(?:"+m+")",S)),v&&(I=new RegExp("^"+m+"$(?!\\s)",S)),h&&(x=E.lastIndex),D=c.call(w?I:E,_),w?D?(D.input=D.input.slice(T),D[0]=D[0].slice(T),D.index=E.lastIndex,E.lastIndex+=D[0].length):E.lastIndex=0:h&&D&&(E.lastIndex=E.global?D.index+D[0].length:x),v&&D&&D.length>1&&u.call(D[0],I,function(){for(P=1;P<arguments.length-2;P++)arguments[P]===void 0&&(D[P]=void 0)}),D}),s.exports=f},"94ca":function(s,i,a){var o=a("d039"),l=/#|\.prototype\./,c=function(v,g){var y=f[u(v)];return y==p?!0:y==h?!1:typeof g=="function"?o(g):!!g},u=c.normalize=function(v){return String(v).replace(l,".").toLowerCase()},f=c.data={},h=c.NATIVE="N",p=c.POLYFILL="P";s.exports=c},"99af":function(s,i,a){var o=a("23e7"),l=a("d039"),c=a("e8b5"),u=a("861d"),f=a("7b0b"),h=a("50c4"),p=a("8418"),v=a("65f0"),g=a("1dde"),y=a("b622"),b=a("2d00"),E=y("isConcatSpreadable"),x=9007199254740991,I="Maximum allowed index exceeded",D=b>=51||!l(function(){var m=[];return m[E]=!1,m.concat()[0]!==m}),P=g("concat"),w=function(m){if(!u(m))return!1;var T=m[E];return T!==void 0?!!T:c(m)},S=!D||!P;o({target:"Array",proto:!0,forced:S},{concat:function(T){var _=f(this),A=v(_,0),k=0,U,L,R,F,N;for(U=-1,R=arguments.length;U<R;U++)if(N=U===-1?_:arguments[U],w(N)){if(F=h(N.length),k+F>x)throw TypeError(I);for(L=0;L<F;L++,k++)L in N&&p(A,k,N[L])}else{if(k>=x)throw TypeError(I);p(A,k++,N)}return A.length=k,A}})},"9bdd":function(s,i,a){var o=a("825a");s.exports=function(l,c,u,f){try{return f?c(o(u)[0],u[1]):c(u)}catch(p){var h=l.return;throw h!==void 0&&o(h.call(l)),p}}},"9bf2":function(s,i,a){var o=a("83ab"),l=a("0cfb"),c=a("825a"),u=a("c04e"),f=Object.defineProperty;i.f=o?f:function(p,v,g){if(c(p),v=u(v,!0),c(g),l)try{return f(p,v,g)}catch{}if("get"in g||"set"in g)throw TypeError("Accessors not supported");return"value"in g&&(p[v]=g.value),p}},"9ed3":function(s,i,a){var o=a("ae93").IteratorPrototype,l=a("7c73"),c=a("5c6c"),u=a("d44e"),f=a("3f8c"),h=function(){return this};s.exports=function(p,v,g){var y=v+" Iterator";return p.prototype=l(o,{next:c(1,g)}),u(p,y,!1,!0),f[y]=h,p}},"9f7f":function(s,i,a){var o=a("d039");function l(c,u){return RegExp(c,u)}i.UNSUPPORTED_Y=o(function(){var c=l("a","y");return c.lastIndex=2,c.exec("abcd")!=null}),i.BROKEN_CARET=o(function(){var c=l("^r","gy");return c.lastIndex=2,c.exec("str")!=null})},a2bf:function(s,i,a){var o=a("e8b5"),l=a("50c4"),c=a("0366"),u=function(f,h,p,v,g,y,b,E){for(var x=g,I=0,D=b?c(b,E,3):!1,P;I<v;){if(I in p){if(P=D?D(p[I],I,h):p[I],y>0&&o(P))x=u(f,h,P,l(P.length),x,y-1)-1;else{if(x>=9007199254740991)throw TypeError("Exceed the acceptable array length");f[x]=P}x++}I++}return x};s.exports=u},a352:function(s,i){s.exports=n},a434:function(s,i,a){var o=a("23e7"),l=a("23cb"),c=a("a691"),u=a("50c4"),f=a("7b0b"),h=a("65f0"),p=a("8418"),v=a("1dde"),g=a("ae40"),y=v("splice"),b=g("splice",{ACCESSORS:!0,0:0,1:2}),E=Math.max,x=Math.min,I=9007199254740991,D="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!y||!b},{splice:function(w,S){var m=f(this),T=u(m.length),_=l(w,T),A=arguments.length,k,U,L,R,F,N;if(A===0?k=U=0:A===1?(k=0,U=T-_):(k=A-2,U=x(E(c(S),0),T-_)),T+k-U>I)throw TypeError(D);for(L=h(m,U),R=0;R<U;R++)F=_+R,F in m&&p(L,R,m[F]);if(L.length=U,k<U){for(R=_;R<T-U;R++)F=R+U,N=R+k,F in m?m[N]=m[F]:delete m[N];for(R=T;R>T-U+k;R--)delete m[R-1]}else if(k>U)for(R=T-U;R>_;R--)F=R+U-1,N=R+k-1,F in m?m[N]=m[F]:delete m[N];for(R=0;R<k;R++)m[R+_]=arguments[R+2];return m.length=T-U+k,L}})},a4d3:function(s,i,a){var o=a("23e7"),l=a("da84"),c=a("d066"),u=a("c430"),f=a("83ab"),h=a("4930"),p=a("fdbf"),v=a("d039"),g=a("5135"),y=a("e8b5"),b=a("861d"),E=a("825a"),x=a("7b0b"),I=a("fc6a"),D=a("c04e"),P=a("5c6c"),w=a("7c73"),S=a("df75"),m=a("241c"),T=a("057f"),_=a("7418"),A=a("06cf"),k=a("9bf2"),U=a("d1e7"),L=a("9112"),R=a("6eeb"),F=a("5692"),N=a("f772"),M=a("d012"),z=a("90e3"),G=a("b622"),H=a("e538"),j=a("746f"),K=a("d44e"),ne=a("69f3"),he=a("b727").forEach,le=N("hidden"),fe="Symbol",te="prototype",Z=G("toPrimitive"),xe=ne.set,Q=ne.getterFor(fe),q=Object[te],J=l.Symbol,pe=c("JSON","stringify"),ge=A.f,ee=k.f,ie=T.f,ve=U.f,we=F("symbols"),De=F("op-symbols"),Te=F("string-to-symbol-registry"),ze=F("symbol-to-string-registry"),ke=F("wks"),Ve=l.QObject,Ae=!Ve||!Ve[te]||!Ve[te].findChild,Ge=f&&v(function(){return w(ee({},"a",{get:function(){return ee(this,"a",{value:7}).a}})).a!=7})?function(pt,ct,mt){var Pt=ge(q,ct);Pt&&delete q[ct],ee(pt,ct,mt),Pt&&pt!==q&&ee(q,ct,Pt)}:ee,Ke=function(pt,ct){var mt=we[pt]=w(J[te]);return xe(mt,{type:fe,tag:pt,description:ct}),f||(mt.description=ct),mt},Ee=p?function(pt){return typeof pt=="symbol"}:function(pt){return Object(pt)instanceof J},ye=function(ct,mt,Pt){ct===q&&ye(De,mt,Pt),E(ct);var Mt=D(mt,!0);return E(Pt),g(we,Mt)?(Pt.enumerable?(g(ct,le)&&ct[le][Mt]&&(ct[le][Mt]=!1),Pt=w(Pt,{enumerable:P(0,!1)})):(g(ct,le)||ee(ct,le,P(1,{})),ct[le][Mt]=!0),Ge(ct,Mt,Pt)):ee(ct,Mt,Pt)},Se=function(ct,mt){E(ct);var Pt=I(mt),Mt=S(Pt).concat(Et(Pt));return he(Mt,function(Tr){(!f||We.call(Pt,Tr))&&ye(ct,Tr,Pt[Tr])}),ct},Oe=function(ct,mt){return mt===void 0?w(ct):Se(w(ct),mt)},We=function(ct){var mt=D(ct,!0),Pt=ve.call(this,mt);return this===q&&g(we,mt)&&!g(De,mt)?!1:Pt||!g(this,mt)||!g(we,mt)||g(this,le)&&this[le][mt]?Pt:!0},ot=function(ct,mt){var Pt=I(ct),Mt=D(mt,!0);if(!(Pt===q&&g(we,Mt)&&!g(De,Mt))){var Tr=ge(Pt,Mt);return Tr&&g(we,Mt)&&!(g(Pt,le)&&Pt[le][Mt])&&(Tr.enumerable=!0),Tr}},gt=function(ct){var mt=ie(I(ct)),Pt=[];return he(mt,function(Mt){!g(we,Mt)&&!g(M,Mt)&&Pt.push(Mt)}),Pt},Et=function(ct){var mt=ct===q,Pt=ie(mt?De:I(ct)),Mt=[];return he(Pt,function(Tr){g(we,Tr)&&(!mt||g(q,Tr))&&Mt.push(we[Tr])}),Mt};if(h||(J=function(){if(this instanceof J)throw TypeError("Symbol is not a constructor");var ct=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),mt=z(ct),Pt=function(Mt){this===q&&Pt.call(De,Mt),g(this,le)&&g(this[le],mt)&&(this[le][mt]=!1),Ge(this,mt,P(1,Mt))};return f&&Ae&&Ge(q,mt,{configurable:!0,set:Pt}),Ke(mt,ct)},R(J[te],"toString",function(){return Q(this).tag}),R(J,"withoutSetter",function(pt){return Ke(z(pt),pt)}),U.f=We,k.f=ye,A.f=ot,m.f=T.f=gt,_.f=Et,H.f=function(pt){return Ke(G(pt),pt)},f&&(ee(J[te],"description",{configurable:!0,get:function(){return Q(this).description}}),u||R(q,"propertyIsEnumerable",We,{unsafe:!0}))),o({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:J}),he(S(ke),function(pt){j(pt)}),o({target:fe,stat:!0,forced:!h},{for:function(pt){var ct=String(pt);if(g(Te,ct))return Te[ct];var mt=J(ct);return Te[ct]=mt,ze[mt]=ct,mt},keyFor:function(ct){if(!Ee(ct))throw TypeError(ct+" is not a symbol");if(g(ze,ct))return ze[ct]},useSetter:function(){Ae=!0},useSimple:function(){Ae=!1}}),o({target:"Object",stat:!0,forced:!h,sham:!f},{create:Oe,defineProperty:ye,defineProperties:Se,getOwnPropertyDescriptor:ot}),o({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:gt,getOwnPropertySymbols:Et}),o({target:"Object",stat:!0,forced:v(function(){_.f(1)})},{getOwnPropertySymbols:function(ct){return _.f(x(ct))}}),pe){var Ut=!h||v(function(){var pt=J();return pe([pt])!="[null]"||pe({a:pt})!="{}"||pe(Object(pt))!="{}"});o({target:"JSON",stat:!0,forced:Ut},{stringify:function(ct,mt,Pt){for(var Mt=[ct],Tr=1,ts;arguments.length>Tr;)Mt.push(arguments[Tr++]);if(ts=mt,!(!b(mt)&&ct===void 0||Ee(ct)))return y(mt)||(mt=function(Pi,hs){if(typeof ts=="function"&&(hs=ts.call(this,Pi,hs)),!Ee(hs))return hs}),Mt[1]=mt,pe.apply(null,Mt)}})}J[te][Z]||L(J[te],Z,J[te].valueOf),K(J,fe),M[le]=!0},a630:function(s,i,a){var o=a("23e7"),l=a("4df4"),c=a("1c7e"),u=!c(function(f){Array.from(f)});o({target:"Array",stat:!0,forced:u},{from:l})},a640:function(s,i,a){var o=a("d039");s.exports=function(l,c){var u=[][l];return!!u&&o(function(){u.call(null,c||function(){throw 1},1)})}},a691:function(s,i){var a=Math.ceil,o=Math.floor;s.exports=function(l){return isNaN(l=+l)?0:(l>0?o:a)(l)}},ab13:function(s,i,a){var o=a("b622"),l=o("match");s.exports=function(c){var u=/./;try{"/./"[c](u)}catch{try{return u[l]=!1,"/./"[c](u)}catch{}}return!1}},ac1f:function(s,i,a){var o=a("23e7"),l=a("9263");o({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},ad6d:function(s,i,a){var o=a("825a");s.exports=function(){var l=o(this),c="";return l.global&&(c+="g"),l.ignoreCase&&(c+="i"),l.multiline&&(c+="m"),l.dotAll&&(c+="s"),l.unicode&&(c+="u"),l.sticky&&(c+="y"),c}},ae40:function(s,i,a){var o=a("83ab"),l=a("d039"),c=a("5135"),u=Object.defineProperty,f={},h=function(p){throw p};s.exports=function(p,v){if(c(f,p))return f[p];v||(v={});var g=[][p],y=c(v,"ACCESSORS")?v.ACCESSORS:!1,b=c(v,0)?v[0]:h,E=c(v,1)?v[1]:void 0;return f[p]=!!g&&!l(function(){if(y&&!o)return!0;var x={length:-1};y?u(x,1,{enumerable:!0,get:h}):x[1]=1,g.call(x,b,E)})}},ae93:function(s,i,a){var o=a("e163"),l=a("9112"),c=a("5135"),u=a("b622"),f=a("c430"),h=u("iterator"),p=!1,v=function(){return this},g,y,b;[].keys&&(b=[].keys(),"next"in b?(y=o(o(b)),y!==Object.prototype&&(g=y)):p=!0),g==null&&(g={}),!f&&!c(g,h)&&l(g,h,v),s.exports={IteratorPrototype:g,BUGGY_SAFARI_ITERATORS:p}},b041:function(s,i,a){var o=a("00ee"),l=a("f5df");s.exports=o?{}.toString:function(){return"[object "+l(this)+"]"}},b0c0:function(s,i,a){var o=a("83ab"),l=a("9bf2").f,c=Function.prototype,u=c.toString,f=/^\s*function ([^ (]*)/,h="name";o&&!(h in c)&&l(c,h,{configurable:!0,get:function(){try{return u.call(this).match(f)[1]}catch{return""}}})},b622:function(s,i,a){var o=a("da84"),l=a("5692"),c=a("5135"),u=a("90e3"),f=a("4930"),h=a("fdbf"),p=l("wks"),v=o.Symbol,g=h?v:v&&v.withoutSetter||u;s.exports=function(y){return c(p,y)||(f&&c(v,y)?p[y]=v[y]:p[y]=g("Symbol."+y)),p[y]}},b64b:function(s,i,a){var o=a("23e7"),l=a("7b0b"),c=a("df75"),u=a("d039"),f=u(function(){c(1)});o({target:"Object",stat:!0,forced:f},{keys:function(p){return c(l(p))}})},b727:function(s,i,a){var o=a("0366"),l=a("44ad"),c=a("7b0b"),u=a("50c4"),f=a("65f0"),h=[].push,p=function(v){var g=v==1,y=v==2,b=v==3,E=v==4,x=v==6,I=v==5||x;return function(D,P,w,S){for(var m=c(D),T=l(m),_=o(P,w,3),A=u(T.length),k=0,U=S||f,L=g?U(D,A):y?U(D,0):void 0,R,F;A>k;k++)if((I||k in T)&&(R=T[k],F=_(R,k,m),v)){if(g)L[k]=F;else if(F)switch(v){case 3:return!0;case 5:return R;case 6:return k;case 2:h.call(L,R)}else if(E)return!1}return x?-1:b||E?E:L}};s.exports={forEach:p(0),map:p(1),filter:p(2),some:p(3),every:p(4),find:p(5),findIndex:p(6)}},c04e:function(s,i,a){var o=a("861d");s.exports=function(l,c){if(!o(l))return l;var u,f;if(c&&typeof(u=l.toString)=="function"&&!o(f=u.call(l))||typeof(u=l.valueOf)=="function"&&!o(f=u.call(l))||!c&&typeof(u=l.toString)=="function"&&!o(f=u.call(l)))return f;throw TypeError("Can't convert object to primitive value")}},c430:function(s,i){s.exports=!1},c6b6:function(s,i){var a={}.toString;s.exports=function(o){return a.call(o).slice(8,-1)}},c6cd:function(s,i,a){var o=a("da84"),l=a("ce4e"),c="__core-js_shared__",u=o[c]||l(c,{});s.exports=u},c740:function(s,i,a){var o=a("23e7"),l=a("b727").findIndex,c=a("44d2"),u=a("ae40"),f="findIndex",h=!0,p=u(f);f in[]&&Array(1)[f](function(){h=!1}),o({target:"Array",proto:!0,forced:h||!p},{findIndex:function(g){return l(this,g,arguments.length>1?arguments[1]:void 0)}}),c(f)},c8ba:function(s,i){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}s.exports=a},c975:function(s,i,a){var o=a("23e7"),l=a("4d64").indexOf,c=a("a640"),u=a("ae40"),f=[].indexOf,h=!!f&&1/[1].indexOf(1,-0)<0,p=c("indexOf"),v=u("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:h||!p||!v},{indexOf:function(y){return h?f.apply(this,arguments)||0:l(this,y,arguments.length>1?arguments[1]:void 0)}})},ca84:function(s,i,a){var o=a("5135"),l=a("fc6a"),c=a("4d64").indexOf,u=a("d012");s.exports=function(f,h){var p=l(f),v=0,g=[],y;for(y in p)!o(u,y)&&o(p,y)&&g.push(y);for(;h.length>v;)o(p,y=h[v++])&&(~c(g,y)||g.push(y));return g}},caad:function(s,i,a){var o=a("23e7"),l=a("4d64").includes,c=a("44d2"),u=a("ae40"),f=u("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!f},{includes:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}}),c("includes")},cc12:function(s,i,a){var o=a("da84"),l=a("861d"),c=o.document,u=l(c)&&l(c.createElement);s.exports=function(f){return u?c.createElement(f):{}}},ce4e:function(s,i,a){var o=a("da84"),l=a("9112");s.exports=function(c,u){try{l(o,c,u)}catch{o[c]=u}return u}},d012:function(s,i){s.exports={}},d039:function(s,i){s.exports=function(a){try{return!!a()}catch{return!0}}},d066:function(s,i,a){var o=a("428f"),l=a("da84"),c=function(u){return typeof u=="function"?u:void 0};s.exports=function(u,f){return arguments.length<2?c(o[u])||c(l[u]):o[u]&&o[u][f]||l[u]&&l[u][f]}},d1e7:function(s,i,a){var o={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c=l&&!o.call({1:2},1);i.f=c?function(f){var h=l(this,f);return!!h&&h.enumerable}:o},d28b:function(s,i,a){var o=a("746f");o("iterator")},d2bb:function(s,i,a){var o=a("825a"),l=a("3bbe");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c=!1,u={},f;try{f=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,f.call(u,[]),c=u instanceof Array}catch{}return function(p,v){return o(p),l(v),c?f.call(p,v):p.__proto__=v,p}}():void 0)},d3b7:function(s,i,a){var o=a("00ee"),l=a("6eeb"),c=a("b041");o||l(Object.prototype,"toString",c,{unsafe:!0})},d44e:function(s,i,a){var o=a("9bf2").f,l=a("5135"),c=a("b622"),u=c("toStringTag");s.exports=function(f,h,p){f&&!l(f=p?f:f.prototype,u)&&o(f,u,{configurable:!0,value:h})}},d58f:function(s,i,a){var o=a("1c0b"),l=a("7b0b"),c=a("44ad"),u=a("50c4"),f=function(h){return function(p,v,g,y){o(v);var b=l(p),E=c(b),x=u(b.length),I=h?x-1:0,D=h?-1:1;if(g<2)for(;;){if(I in E){y=E[I],I+=D;break}if(I+=D,h?I<0:x<=I)throw TypeError("Reduce of empty array with no initial value")}for(;h?I>=0:x>I;I+=D)I in E&&(y=v(y,E[I],I,b));return y}};s.exports={left:f(!1),right:f(!0)}},d784:function(s,i,a){a("ac1f");var o=a("6eeb"),l=a("d039"),c=a("b622"),u=a("9263"),f=a("9112"),h=c("species"),p=!l(function(){var E=/./;return E.exec=function(){var x=[];return x.groups={a:"7"},x},"".replace(E,"$<a>")!=="7"}),v=function(){return"a".replace(/./,"$0")==="$0"}(),g=c("replace"),y=function(){return/./[g]?/./[g]("a","$0")==="":!1}(),b=!l(function(){var E=/(?:)/,x=E.exec;E.exec=function(){return x.apply(this,arguments)};var I="ab".split(E);return I.length!==2||I[0]!=="a"||I[1]!=="b"});s.exports=function(E,x,I,D){var P=c(E),w=!l(function(){var k={};return k[P]=function(){return 7},""[E](k)!=7}),S=w&&!l(function(){var k=!1,U=/a/;return E==="split"&&(U={},U.constructor={},U.constructor[h]=function(){return U},U.flags="",U[P]=/./[P]),U.exec=function(){return k=!0,null},U[P](""),!k});if(!w||!S||E==="replace"&&!(p&&v&&!y)||E==="split"&&!b){var m=/./[P],T=I(P,""[E],function(k,U,L,R,F){return U.exec===u?w&&!F?{done:!0,value:m.call(U,L,R)}:{done:!0,value:k.call(L,U,R)}:{done:!1}},{REPLACE_KEEPS_$0:v,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:y}),_=T[0],A=T[1];o(String.prototype,E,_),o(RegExp.prototype,P,x==2?function(k,U){return A.call(k,this,U)}:function(k){return A.call(k,this)})}D&&f(RegExp.prototype[P],"sham",!0)}},d81d:function(s,i,a){var o=a("23e7"),l=a("b727").map,c=a("1dde"),u=a("ae40"),f=c("map"),h=u("map");o({target:"Array",proto:!0,forced:!f||!h},{map:function(v){return l(this,v,arguments.length>1?arguments[1]:void 0)}})},da84:function(s,i,a){(function(o){var l=function(c){return c&&c.Math==Math&&c};s.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof o=="object"&&o)||Function("return this")()}).call(this,a("c8ba"))},dbb4:function(s,i,a){var o=a("23e7"),l=a("83ab"),c=a("56ef"),u=a("fc6a"),f=a("06cf"),h=a("8418");o({target:"Object",stat:!0,sham:!l},{getOwnPropertyDescriptors:function(v){for(var g=u(v),y=f.f,b=c(g),E={},x=0,I,D;b.length>x;)D=y(g,I=b[x++]),D!==void 0&&h(E,I,D);return E}})},dbf1:function(s,i,a){(function(o){a.d(i,"a",function(){return c});function l(){return typeof window<"u"?window.console:o.console}var c=l()}).call(this,a("c8ba"))},ddb0:function(s,i,a){var o=a("da84"),l=a("fdbc"),c=a("e260"),u=a("9112"),f=a("b622"),h=f("iterator"),p=f("toStringTag"),v=c.values;for(var g in l){var y=o[g],b=y&&y.prototype;if(b){if(b[h]!==v)try{u(b,h,v)}catch{b[h]=v}if(b[p]||u(b,p,g),l[g]){for(var E in c)if(b[E]!==c[E])try{u(b,E,c[E])}catch{b[E]=c[E]}}}}},df75:function(s,i,a){var o=a("ca84"),l=a("7839");s.exports=Object.keys||function(u){return o(u,l)}},e01a:function(s,i,a){var o=a("23e7"),l=a("83ab"),c=a("da84"),u=a("5135"),f=a("861d"),h=a("9bf2").f,p=a("e893"),v=c.Symbol;if(l&&typeof v=="function"&&(!("description"in v.prototype)||v().description!==void 0)){var g={},y=function(){var P=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),w=this instanceof y?new v(P):P===void 0?v():v(P);return P===""&&(g[w]=!0),w};p(y,v);var b=y.prototype=v.prototype;b.constructor=y;var E=b.toString,x=String(v("test"))=="Symbol(test)",I=/^Symbol\((.*)\)[^)]+$/;h(b,"description",{configurable:!0,get:function(){var P=f(this)?this.valueOf():this,w=E.call(P);if(u(g,P))return"";var S=x?w.slice(7,-1):w.replace(I,"$1");return S===""?void 0:S}}),o({global:!0,forced:!0},{Symbol:y})}},e163:function(s,i,a){var o=a("5135"),l=a("7b0b"),c=a("f772"),u=a("e177"),f=c("IE_PROTO"),h=Object.prototype;s.exports=u?Object.getPrototypeOf:function(p){return p=l(p),o(p,f)?p[f]:typeof p.constructor=="function"&&p instanceof p.constructor?p.constructor.prototype:p instanceof Object?h:null}},e177:function(s,i,a){var o=a("d039");s.exports=!o(function(){function l(){}return l.prototype.constructor=null,Object.getPrototypeOf(new l)!==l.prototype})},e260:function(s,i,a){var o=a("fc6a"),l=a("44d2"),c=a("3f8c"),u=a("69f3"),f=a("7dd0"),h="Array Iterator",p=u.set,v=u.getterFor(h);s.exports=f(Array,"Array",function(g,y){p(this,{type:h,target:o(g),index:0,kind:y})},function(){var g=v(this),y=g.target,b=g.kind,E=g.index++;return!y||E>=y.length?(g.target=void 0,{value:void 0,done:!0}):b=="keys"?{value:E,done:!1}:b=="values"?{value:y[E],done:!1}:{value:[E,y[E]],done:!1}},"values"),c.Arguments=c.Array,l("keys"),l("values"),l("entries")},e439:function(s,i,a){var o=a("23e7"),l=a("d039"),c=a("fc6a"),u=a("06cf").f,f=a("83ab"),h=l(function(){u(1)}),p=!f||h;o({target:"Object",stat:!0,forced:p,sham:!f},{getOwnPropertyDescriptor:function(g,y){return u(c(g),y)}})},e538:function(s,i,a){var o=a("b622");i.f=o},e893:function(s,i,a){var o=a("5135"),l=a("56ef"),c=a("06cf"),u=a("9bf2");s.exports=function(f,h){for(var p=l(h),v=u.f,g=c.f,y=0;y<p.length;y++){var b=p[y];o(f,b)||v(f,b,g(h,b))}}},e8b5:function(s,i,a){var o=a("c6b6");s.exports=Array.isArray||function(c){return o(c)=="Array"}},e95a:function(s,i,a){var o=a("b622"),l=a("3f8c"),c=o("iterator"),u=Array.prototype;s.exports=function(f){return f!==void 0&&(l.Array===f||u[c]===f)}},f5df:function(s,i,a){var o=a("00ee"),l=a("c6b6"),c=a("b622"),u=c("toStringTag"),f=l(function(){return arguments}())=="Arguments",h=function(p,v){try{return p[v]}catch{}};s.exports=o?l:function(p){var v,g,y;return p===void 0?"Undefined":p===null?"Null":typeof(g=h(v=Object(p),u))=="string"?g:f?l(v):(y=l(v))=="Object"&&typeof v.callee=="function"?"Arguments":y}},f772:function(s,i,a){var o=a("5692"),l=a("90e3"),c=o("keys");s.exports=function(u){return c[u]||(c[u]=l(u))}},fb15:function(s,i,a){if(a.r(i),typeof window<"u"){var o=window.document.currentScript;{var l=a("8875");o=l(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:l})}var c=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);c&&(a.p=c[1])}a("99af"),a("4de4"),a("4160"),a("c975"),a("d81d"),a("a434"),a("159b"),a("a4d3"),a("e439"),a("dbb4"),a("b64b");function u(Ee,ye,Se){return ye in Ee?Object.defineProperty(Ee,ye,{value:Se,enumerable:!0,configurable:!0,writable:!0}):Ee[ye]=Se,Ee}function f(Ee,ye){var Se=Object.keys(Ee);if(Object.getOwnPropertySymbols){var Oe=Object.getOwnPropertySymbols(Ee);ye&&(Oe=Oe.filter(function(We){return Object.getOwnPropertyDescriptor(Ee,We).enumerable})),Se.push.apply(Se,Oe)}return Se}function h(Ee){for(var ye=1;ye<arguments.length;ye++){var Se=arguments[ye]!=null?arguments[ye]:{};ye%2?f(Object(Se),!0).forEach(function(Oe){u(Ee,Oe,Se[Oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ee,Object.getOwnPropertyDescriptors(Se)):f(Object(Se)).forEach(function(Oe){Object.defineProperty(Ee,Oe,Object.getOwnPropertyDescriptor(Se,Oe))})}return Ee}function p(Ee){if(Array.isArray(Ee))return Ee}a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function v(Ee,ye){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Ee)))){var Se=[],Oe=!0,We=!1,ot=void 0;try{for(var gt=Ee[Symbol.iterator](),Et;!(Oe=(Et=gt.next()).done)&&(Se.push(Et.value),!(ye&&Se.length===ye));Oe=!0);}catch(Ut){We=!0,ot=Ut}finally{try{!Oe&&gt.return!=null&&gt.return()}finally{if(We)throw ot}}return Se}}a("a630"),a("fb6a"),a("b0c0"),a("25f0");function g(Ee,ye){(ye==null||ye>Ee.length)&&(ye=Ee.length);for(var Se=0,Oe=new Array(ye);Se<ye;Se++)Oe[Se]=Ee[Se];return Oe}function y(Ee,ye){if(Ee){if(typeof Ee=="string")return g(Ee,ye);var Se=Object.prototype.toString.call(Ee).slice(8,-1);if(Se==="Object"&&Ee.constructor&&(Se=Ee.constructor.name),Se==="Map"||Se==="Set")return Array.from(Ee);if(Se==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Se))return g(Ee,ye)}}function b(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E(Ee,ye){return p(Ee)||v(Ee,ye)||y(Ee,ye)||b()}function x(Ee){if(Array.isArray(Ee))return g(Ee)}function I(Ee){if(typeof Symbol<"u"&&Symbol.iterator in Object(Ee))return Array.from(Ee)}function D(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function P(Ee){return x(Ee)||I(Ee)||y(Ee)||D()}var w=a("a352"),S=a.n(w);function m(Ee){Ee.parentElement!==null&&Ee.parentElement.removeChild(Ee)}function T(Ee,ye,Se){var Oe=Se===0?Ee.children[0]:Ee.children[Se-1].nextSibling;Ee.insertBefore(ye,Oe)}var _=a("dbf1");a("13d5"),a("4fad"),a("ac1f"),a("5319");function A(Ee){var ye=Object.create(null);return function(Oe){var We=ye[Oe];return We||(ye[Oe]=Ee(Oe))}}var k=/-(\w)/g,U=A(function(Ee){return Ee.replace(k,function(ye,Se){return Se.toUpperCase()})});a("5db7"),a("73d9");var L=["Start","Add","Remove","Update","End"],R=["Choose","Unchoose","Sort","Filter","Clone"],F=["Move"],N=[F,L,R].flatMap(function(Ee){return Ee}).map(function(Ee){return"on".concat(Ee)}),M={manage:F,manageAndEmit:L,emit:R};function z(Ee){return N.indexOf(Ee)!==-1}a("caad"),a("2ca0");var G=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function H(Ee){return G.includes(Ee)}function j(Ee){return["transition-group","TransitionGroup"].includes(Ee)}function K(Ee){return["id","class","role","style"].includes(Ee)||Ee.startsWith("data-")||Ee.startsWith("aria-")||Ee.startsWith("on")}function ne(Ee){return Ee.reduce(function(ye,Se){var Oe=E(Se,2),We=Oe[0],ot=Oe[1];return ye[We]=ot,ye},{})}function he(Ee){var ye=Ee.$attrs,Se=Ee.componentData,Oe=Se===void 0?{}:Se,We=ne(Object.entries(ye).filter(function(ot){var gt=E(ot,2),Et=gt[0];return gt[1],K(Et)}));return h(h({},We),Oe)}function le(Ee){var ye=Ee.$attrs,Se=Ee.callBackBuilder,Oe=ne(fe(ye));Object.entries(Se).forEach(function(ot){var gt=E(ot,2),Et=gt[0],Ut=gt[1];M[Et].forEach(function(pt){Oe["on".concat(pt)]=Ut(pt)})});var We="[data-draggable]".concat(Oe.draggable||"");return h(h({},Oe),{},{draggable:We})}function fe(Ee){return Object.entries(Ee).filter(function(ye){var Se=E(ye,2),Oe=Se[0];return Se[1],!K(Oe)}).map(function(ye){var Se=E(ye,2),Oe=Se[0],We=Se[1];return[U(Oe),We]}).filter(function(ye){var Se=E(ye,2),Oe=Se[0];return Se[1],!z(Oe)})}a("c740");function te(Ee,ye){if(!(Ee instanceof ye))throw new TypeError("Cannot call a class as a function")}function Z(Ee,ye){for(var Se=0;Se<ye.length;Se++){var Oe=ye[Se];Oe.enumerable=Oe.enumerable||!1,Oe.configurable=!0,"value"in Oe&&(Oe.writable=!0),Object.defineProperty(Ee,Oe.key,Oe)}}function xe(Ee,ye,Se){return ye&&Z(Ee.prototype,ye),Ee}var Q=function(ye){var Se=ye.el;return Se},q=function(ye,Se){return ye.__draggable_context=Se},J=function(ye){return ye.__draggable_context},pe=function(){function Ee(ye){var Se=ye.nodes,Oe=Se.header,We=Se.default,ot=Se.footer,gt=ye.root,Et=ye.realList;te(this,Ee),this.defaultNodes=We,this.children=[].concat(P(Oe),P(We),P(ot)),this.externalComponent=gt.externalComponent,this.rootTransition=gt.transition,this.tag=gt.tag,this.realList=Et}return xe(Ee,[{key:"render",value:function(Se,Oe){var We=this.tag,ot=this.children,gt=this._isRootComponent,Et=gt?{default:function(){return ot}}:ot;return Se(We,Oe,Et)}},{key:"updated",value:function(){var Se=this.defaultNodes,Oe=this.realList;Se.forEach(function(We,ot){q(Q(We),{element:Oe[ot],index:ot})})}},{key:"getUnderlyingVm",value:function(Se){return J(Se)}},{key:"getVmIndexFromDomIndex",value:function(Se,Oe){var We=this.defaultNodes,ot=We.length,gt=Oe.children,Et=gt.item(Se);if(Et===null)return ot;var Ut=J(Et);if(Ut)return Ut.index;if(ot===0)return 0;var pt=Q(We[0]),ct=P(gt).findIndex(function(mt){return mt===pt});return Se<ct?0:ot}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),Ee}(),ge=a("8bbf");function ee(Ee,ye){var Se=Ee[ye];return Se?Se():[]}function ie(Ee){var ye=Ee.$slots,Se=Ee.realList,Oe=Ee.getKey,We=Se||[],ot=["header","footer"].map(function(mt){return ee(ye,mt)}),gt=E(ot,2),Et=gt[0],Ut=gt[1],pt=ye.item;if(!pt)throw new Error("draggable element must have an item slot");var ct=We.flatMap(function(mt,Pt){return pt({element:mt,index:Pt}).map(function(Mt){return Mt.key=Oe(mt),Mt.props=h(h({},Mt.props||{}),{},{"data-draggable":!0}),Mt})});if(ct.length!==We.length)throw new Error("Item slot must have only one child");return{header:Et,footer:Ut,default:ct}}function ve(Ee){var ye=j(Ee),Se=!H(Ee)&&!ye;return{transition:ye,externalComponent:Se,tag:Se?Object(ge.resolveComponent)(Ee):ye?ge.TransitionGroup:Ee}}function we(Ee){var ye=Ee.$slots,Se=Ee.tag,Oe=Ee.realList,We=Ee.getKey,ot=ie({$slots:ye,realList:Oe,getKey:We}),gt=ve(Se);return new pe({nodes:ot,root:gt,realList:Oe})}function De(Ee,ye){var Se=this;Object(ge.nextTick)(function(){return Se.$emit(Ee.toLowerCase(),ye)})}function Te(Ee){var ye=this;return function(Se,Oe){if(ye.realList!==null)return ye["onDrag".concat(Ee)](Se,Oe)}}function ze(Ee){var ye=this,Se=Te.call(this,Ee);return function(Oe,We){Se.call(ye,Oe,We),De.call(ye,Ee,Oe)}}var ke=null,Ve={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(ye){return ye}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Ae=["update:modelValue","change"].concat(P([].concat(P(M.manageAndEmit),P(M.emit)).map(function(Ee){return Ee.toLowerCase()}))),Ge=Object(ge.defineComponent)({name:"draggable",inheritAttrs:!1,props:Ve,emits:Ae,data:function(){return{error:!1}},render:function(){try{this.error=!1;var ye=this.$slots,Se=this.$attrs,Oe=this.tag,We=this.componentData,ot=this.realList,gt=this.getKey,Et=we({$slots:ye,tag:Oe,realList:ot,getKey:gt});this.componentStructure=Et;var Ut=he({$attrs:Se,componentData:We});return Et.render(ge.h,Ut)}catch(pt){return this.error=!0,Object(ge.h)("pre",{style:{color:"red"}},pt.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&_.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var ye=this;if(!this.error){var Se=this.$attrs,Oe=this.$el,We=this.componentStructure;We.updated();var ot=le({$attrs:Se,callBackBuilder:{manageAndEmit:function(Ut){return ze.call(ye,Ut)},emit:function(Ut){return De.bind(ye,Ut)},manage:function(Ut){return Te.call(ye,Ut)}}}),gt=Oe.nodeType===1?Oe:Oe.parentElement;this._sortable=new S.a(gt,ot),this.targetDomElement=gt,gt.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var ye=this.list;return ye||this.modelValue},getKey:function(){var ye=this.itemKey;return typeof ye=="function"?ye:function(Se){return Se[ye]}}},watch:{$attrs:{handler:function(ye){var Se=this._sortable;Se&&fe(ye).forEach(function(Oe){var We=E(Oe,2),ot=We[0],gt=We[1];Se.option(ot,gt)})},deep:!0}},methods:{getUnderlyingVm:function(ye){return this.componentStructure.getUnderlyingVm(ye)||null},getUnderlyingPotencialDraggableComponent:function(ye){return ye.__draggable_component__},emitChanges:function(ye){var Se=this;Object(ge.nextTick)(function(){return Se.$emit("change",ye)})},alterList:function(ye){if(this.list){ye(this.list);return}var Se=P(this.modelValue);ye(Se),this.$emit("update:modelValue",Se)},spliceList:function(){var ye=arguments,Se=function(We){return We.splice.apply(We,P(ye))};this.alterList(Se)},updatePosition:function(ye,Se){var Oe=function(ot){return ot.splice(Se,0,ot.splice(ye,1)[0])};this.alterList(Oe)},getRelatedContextFromMoveEvent:function(ye){var Se=ye.to,Oe=ye.related,We=this.getUnderlyingPotencialDraggableComponent(Se);if(!We)return{component:We};var ot=We.realList,gt={list:ot,component:We};if(Se!==Oe&&ot){var Et=We.getUnderlyingVm(Oe)||{};return h(h({},Et),gt)}return gt},getVmIndexFromDomIndex:function(ye){return this.componentStructure.getVmIndexFromDomIndex(ye,this.targetDomElement)},onDragStart:function(ye){this.context=this.getUnderlyingVm(ye.item),ye.item._underlying_vm_=this.clone(this.context.element),ke=ye.item},onDragAdd:function(ye){var Se=ye.item._underlying_vm_;if(Se!==void 0){m(ye.item);var Oe=this.getVmIndexFromDomIndex(ye.newIndex);this.spliceList(Oe,0,Se);var We={element:Se,newIndex:Oe};this.emitChanges({added:We})}},onDragRemove:function(ye){if(T(this.$el,ye.item,ye.oldIndex),ye.pullMode==="clone"){m(ye.clone);return}var Se=this.context,Oe=Se.index,We=Se.element;this.spliceList(Oe,1);var ot={element:We,oldIndex:Oe};this.emitChanges({removed:ot})},onDragUpdate:function(ye){m(ye.item),T(ye.from,ye.item,ye.oldIndex);var Se=this.context.index,Oe=this.getVmIndexFromDomIndex(ye.newIndex);this.updatePosition(Se,Oe);var We={element:this.context.element,oldIndex:Se,newIndex:Oe};this.emitChanges({moved:We})},computeFutureIndex:function(ye,Se){if(!ye.element)return 0;var Oe=P(Se.to.children).filter(function(Et){return Et.style.display!=="none"}),We=Oe.indexOf(Se.related),ot=ye.component.getVmIndexFromDomIndex(We),gt=Oe.indexOf(ke)!==-1;return gt||!Se.willInsertAfter?ot:ot+1},onDragMove:function(ye,Se){var Oe=this.move,We=this.realList;if(!Oe||!We)return!0;var ot=this.getRelatedContextFromMoveEvent(ye),gt=this.computeFutureIndex(ot,ye),Et=h(h({},this.context),{},{futureIndex:gt}),Ut=h(h({},ye),{},{relatedContext:ot,draggedContext:Et});return Oe(Ut,Se)},onDragEnd:function(){ke=null}}}),Ke=Ge;i.default=Ke},fb6a:function(s,i,a){var o=a("23e7"),l=a("861d"),c=a("e8b5"),u=a("23cb"),f=a("50c4"),h=a("fc6a"),p=a("8418"),v=a("b622"),g=a("1dde"),y=a("ae40"),b=g("slice"),E=y("slice",{ACCESSORS:!0,0:0,1:2}),x=v("species"),I=[].slice,D=Math.max;o({target:"Array",proto:!0,forced:!b||!E},{slice:function(w,S){var m=h(this),T=f(m.length),_=u(w,T),A=u(S===void 0?T:S,T),k,U,L;if(c(m)&&(k=m.constructor,typeof k=="function"&&(k===Array||c(k.prototype))?k=void 0:l(k)&&(k=k[x],k===null&&(k=void 0)),k===Array||k===void 0))return I.call(m,_,A);for(U=new(k===void 0?Array:k)(D(A-_,0)),L=0;_<A;_++,L++)_ in m&&p(U,L,m[_]);return U.length=L,U}})},fc6a:function(s,i,a){var o=a("44ad"),l=a("1d80");s.exports=function(c){return o(l(c))}},fdbc:function(s,i){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(s,i,a){var o=a("4930");s.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(die);const Yie={class:"assignment-dialog-modal"},Qie={class:"form-row"},Jie={key:0,class:"form-row"},Zie=["value"],eoe={key:1,class:"form-row"},toe=["value"],roe={key:2,class:"form-row"},noe={class:"form-row"},soe={class:"form-row"},aoe={class:"form-row"},ioe={class:"dialog-actions"},ooe={__name:"AssignmentDialog",props:{teachers:Array,students:Array,assignment:Object},emits:["save","close"],setup(t,{emit:e}){const r=t,n=e,s=se("lunch"),i=se(""),a=se(""),o=se(""),l=se("12:00"),c=se("12:30"),u=se(""),f=se(""),h=se("");Vt(()=>r.assignment,g=>{g?(f.value=g.id||Date.now().toString(),h.value=g.blockId||f.value||`block-${Date.now()}`,s.value=g.type||"lunch",i.value=g.teacherId||"",a.value=g.studentId||"",o.value=g.type==="other"?g.label:"",l.value=g.start||"12:00",c.value=g.end||"12:30",u.value=g.note||""):(f.value=Date.now().toString(),h.value=`block-${f.value}`,s.value="lunch",i.value="",a.value="",o.value="",l.value="12:00",c.value="12:30",u.value="")},{immediate:!0});const p=be(()=>{if(s.value==="lunch")return"Lunch";if(s.value==="break")return"Break";if(s.value==="class"){const g=r.teachers.find(y=>y.id===i.value);return g?g.name||g.email||g.id:""}if(s.value==="student"){const g=r.students.find(y=>y.id===a.value);return g?`${g.firstName} ${g.lastName}`:""}return s.value==="other"?o.value:""});function v(){!l.value||!c.value||s.value==="class"&&!i.value||s.value==="student"&&!a.value||s.value==="other"&&!o.value||n("save",{id:f.value,blockId:h.value,type:s.value,label:p.value,start:l.value,end:c.value,note:u.value,teacherId:i.value,studentId:a.value})}return(g,y)=>(O(),B("div",{class:"assignment-dialog-overlay",onClick:y[8]||(y[8]=dn(b=>g.$emit("close"),["self"]))},[d("div",Yie,[y[20]||(y[20]=d("h2",null,"Add Assignment",-1)),d("form",{onSubmit:dn(v,["prevent"])},[d("div",Qie,[y[10]||(y[10]=d("label",null,"Type:",-1)),Be(d("select",{"onUpdate:modelValue":y[0]||(y[0]=b=>s.value=b)},y[9]||(y[9]=[In('<option value="lunch" data-v-f2af98a0>Lunch</option><option value="break" data-v-f2af98a0>Break</option><option value="class" data-v-f2af98a0>Class</option><option value="student" data-v-f2af98a0>Student</option><option value="other" data-v-f2af98a0>Other</option>',5)]),512),[[cr,s.value]])]),s.value==="class"?(O(),B("div",Jie,[y[12]||(y[12]=d("label",null,"Teacher:",-1)),Be(d("select",{"onUpdate:modelValue":y[1]||(y[1]=b=>i.value=b)},[y[11]||(y[11]=d("option",{value:""},"Select teacher...",-1)),(O(!0),B(Fe,null,He(t.teachers,b=>(O(),B("option",{key:b.id,value:b.id},Y(b.name||b.email||b.id),9,Zie))),128))],512),[[cr,i.value]])])):_e("",!0),s.value==="student"?(O(),B("div",eoe,[y[14]||(y[14]=d("label",null,"Student:",-1)),Be(d("select",{"onUpdate:modelValue":y[2]||(y[2]=b=>a.value=b)},[y[13]||(y[13]=d("option",{value:""},"Select student...",-1)),(O(!0),B(Fe,null,He(t.students,b=>(O(),B("option",{key:b.id,value:b.id},Y(b.firstName)+" "+Y(b.lastName),9,toe))),128))],512),[[cr,a.value]])])):_e("",!0),s.value==="other"?(O(),B("div",roe,[y[15]||(y[15]=d("label",null,"Label:",-1)),Be(d("input",{"onUpdate:modelValue":y[3]||(y[3]=b=>o.value=b),placeholder:"Custom label"},null,512),[[ht,o.value]])])):_e("",!0),d("div",noe,[y[16]||(y[16]=d("label",null,"Start Time:",-1)),Be(d("input",{"onUpdate:modelValue":y[4]||(y[4]=b=>l.value=b),type:"time",required:""},null,512),[[ht,l.value]])]),d("div",soe,[y[17]||(y[17]=d("label",null,"End Time:",-1)),Be(d("input",{"onUpdate:modelValue":y[5]||(y[5]=b=>c.value=b),type:"time",required:""},null,512),[[ht,c.value]])]),d("div",aoe,[y[18]||(y[18]=d("label",null,"Note:",-1)),Be(d("input",{"onUpdate:modelValue":y[6]||(y[6]=b=>u.value=b),placeholder:"Optional note"},null,512),[[ht,u.value]])]),d("div",ioe,[y[19]||(y[19]=d("button",{type:"submit",class:"btn btn-primary"},"Add",-1)),d("button",{type:"button",class:"btn btn-secondary",onClick:y[7]||(y[7]=b=>g.$emit("close"))},"Cancel")])],32)])]))}},loe=xt(ooe,[["__scopeId","data-v-f2af98a0"]]),coe={class:"vertical-time-grid-wrapper"},uoe={class:"grid-block-label-time"},doe=["title"],foe=["title"],hoe=["onDragstart","onDrag","onDragend"],poe={class:"assignment-content"},moe={class:"assignment-label-time"},goe={class:"assignment-time-label"},voe={class:"assignment-actions"},yoe=["onClick"],xoe=["onClick"],Eoe=["onMousedown"],HS=24,_oe={__name:"VerticalTimeGrid",props:{assignments:Array,teachers:Array,students:Array,getAssignmentBoxStyle:Function,onAssignmentDragStart:Function,onAssignmentDrag:Function,onAssignmentDragEnd:Function,onResizeStart:Function,blocks:Array},emits:["update:assignments","edit-assignment"],setup(t,{emit:e}){const r=t,n=e,s=se(null);se(!1);const i=se(r.assignments?r.assignments.map(R=>({...R})):[]);Vt(()=>r.assignments,R=>{i.value=R?R.map(F=>({...F})):[]},{immediate:!0});function a(R){const[F,N]=R.split(":").map(Number);return F*60+N}function o(R){const F=Math.floor(R/60),N=R%60;return`${F<10?"0":""}${F}:${N<10?"0":""}${N}`}const l=be(()=>!r.blocks||r.blocks.length===0?"08:00":r.blocks.reduce((R,F)=>F.startTime<R?F.startTime:R,r.blocks[0].startTime)),c=be(()=>!r.blocks||r.blocks.length===0?"16:00":r.blocks.reduce((R,F)=>F.endTime>R?F.endTime:R,r.blocks[0].endTime)),u=be(()=>a(l.value)),f=be(()=>a(c.value)),h=be(()=>f.value-u.value),p=be(()=>h.value*2.5+HS*2);be(()=>{if(!r.blocks)return[];const R=[];return r.blocks.forEach(F=>{R.includes(F.startTime)||R.push(F.startTime),R.includes(F.endTime)||R.push(F.endTime)}),R.sort((F,N)=>a(F)-a(N))});function v(R){return(a(R)-u.value)*2.5+HS-10}function g(R,F){if(!R||!F)return!1;const N=a(R.startTime),M=a(R.endTime),z=a(F.startTime),G=a(F.endTime);return N<G&&M>z}function y(R){const F=[];for(let M=0;M<R.length;M++){const z=R[M];let G=null;for(let H=0;H<F.length;H++)if(F[H].ids.some(j=>g(z,R.find(K=>K.id===j)))){G=F[H];break}G?(G.ids.push(z.id),G.blocks.push(z)):F.push({ids:[z.id],blocks:[z]})}let N=!0;for(;N;){N=!1;for(let M=0;M<F.length;M++){for(let z=M+1;z<F.length;z++)if(F[M].ids.some(G=>F[z].ids.some(H=>g(R.find(j=>j.id===G),R.find(j=>j.id===H))))){F[M].ids=Array.from(new Set([...F[M].ids,...F[z].ids])),F[M].blocks=Array.from(new Set([...F[M].blocks,...F[z].blocks])),F.splice(z,1),N=!0;break}if(N)break}}return F.map(M=>{const z=M.blocks.sort((j,K)=>j.startTime.localeCompare(K.startTime)||j.id.localeCompare(K.id)),G=z.reduce((j,K)=>K.startTime<j?K.startTime:j,z[0].startTime),H=z.reduce((j,K)=>K.endTime>j?K.endTime:j,z[0].endTime);return{ids:M.ids,startTime:G,endTime:H}})}be(()=>y(b.value));const b=be(()=>(r.blocks||[]).map((R,F)=>({...R,id:R.id||`block-${F}`})));function E(R){const F=[];for(let z=0;z<R.length;z++){const G=R[z];let H=null;for(let j=0;j<F.length;j++)if(F[j].some(K=>g(G,R.find(ne=>ne.id===K)))){H=F[j];break}H?H.push(G.id):F.push([G.id])}let N=!0;for(;N;){N=!1;for(let z=0;z<F.length;z++){for(let G=z+1;G<F.length;G++)if(F[z].some(H=>F[G].some(j=>g(R.find(K=>K.id===H),R.find(K=>K.id===j))))){F[z]=Array.from(new Set([...F[z],...F[G]])),F.splice(G,1),N=!0;break}if(N)break}}const M={};for(const z of F){const G=z.map(H=>R.find(j=>j.id===H)).sort((H,j)=>H.startTime.localeCompare(j.startTime)||H.id.localeCompare(j.id));G.forEach((H,j)=>{M[H.id]={groupSize:G.length,colIndex:j}})}return M}function x(R,F){const N=E(b.value)[R.id]||{groupSize:1,colIndex:0},M=v(R.startTime),z=(a(R.endTime)-a(R.startTime))*2.5,G=100/N.groupSize;return{position:"absolute",left:G*N.colIndex+"%",width:G+"%",top:M+"px",height:z+"px",zIndex:1,opacity:.38,boxSizing:"border-box",overflow:"hidden"}}function I(R,F){const N=i.value.filter((te,Z)=>{if(te.id===R.id)return!1;const xe=a(te.start),Q=a(te.end),q=a(R.start),J=a(R.end);return xe<J&&Q>q}),M=N.length+1,G=[R,...N].sort((te,Z)=>te.start.localeCompare(Z.start)||te.id.localeCompare(Z.id)).findIndex(te=>te.id===R.id),H=v(R.start),j=(a(R.end)-a(R.start))*2.5,K=Math.max(j,2.5),ne=73,he=27,le=ne/M;return{position:"absolute",left:he+le*G+"%",width:le+"%",top:H+"px",height:K+"px",zIndex:2,minWidth:"80px",boxSizing:"border-box",padding:"4px",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",cursor:"grab",transition:"top 0.2s, height 0.2s"}}const D=se(null),P=se(0),w=se(0),S=se(null);function m(R,F){D.value=F,P.value=R.clientY,w.value=a(F.start),S.value="move",F.isDragging=!0,R.target.classList.add("background-dragging-div");const M=document.createElement("div");M.className="drag-preview-div",M.style.width="160px",M.style.height="40px",M.style.background="transparent",M.style.border="2px solid #007bff",M.style.position="absolute",M.style.top="-9999px",M.style.left="-9999px",document.body.appendChild(M),R.dataTransfer.setDragImage(M,80,20),R.dataTransfer.effectAllowed="move",R.dataTransfer.setData("text/plain",F.id)}function T(R,F){if(!D.value||R.clientY===0)return;const N=R.clientY-P.value,M=Math.round(N/2.5);if(S.value==="move"){let z=w.value+M,G=z+(a(F.end)-a(F.start));z=Math.max(u.value,Math.min(z,f.value-1)),G=Math.max(z+1,Math.min(G,f.value)),F.start=o(z),F.end=o(G)}}function _(R,F){D.value=null,S.value=null,F.isDragging=!1,n("update:assignments",i.value)}function A(R,F){D.value=F,P.value=R.clientY,w.value=a(F.end),S.value="resize",window.addEventListener("mousemove",k),window.addEventListener("mouseup",U)}function k(R){if(!D.value)return;const F=R.clientY-P.value;let N=w.value+Math.round(F/2.5);const M=a(D.value.start);N=Math.max(M+1,Math.min(N,f.value)),D.value.end=o(N)}function U(R){D.value=null,S.value=null,window.removeEventListener("mousemove",k),window.removeEventListener("mouseup",U)}function L(R){const F=i.value.findIndex(N=>N.id===R);F!==-1&&(i.value.splice(F,1),n("update:assignments",i.value))}return(R,F)=>(O(),B("div",coe,[d("div",{class:"vertical-time-grid",ref_key:"timeGridRef",ref:s,style:Nr({position:"relative",height:p.value+"px"})},[(O(!0),B(Fe,null,He(b.value,(N,M)=>(O(),B("div",{key:N.id,class:Qe(["grid-block-bg",N.type==="period"?"blocktype-period":"blocktype-"+(N.type||"period")]),style:Nr(x(N))},[d("div",uoe,[d("span",{class:"grid-block-label",title:N.name||(N.type==="period"?N.label||N.periodName||N.periodNumber||"Period":N.type?N.type.charAt(0).toUpperCase()+N.type.slice(1):"")},Y(N.name||(N.type==="period"?N.label||N.periodName||N.periodNumber||"Period":N.type?N.type.charAt(0).toUpperCase()+N.type.slice(1):"")),9,doe),d("span",{class:"grid-block-time",title:N.startTime},Y(N.startTime),9,foe)])],6))),128)),(O(!0),B(Fe,null,He(i.value,(N,M)=>(O(),B("div",{key:N.id,class:Qe(["dialog-assignment-box",["type-"+(N.type||"other"),{dragging:N.isDragging}]]),style:Nr(I(N)),draggable:"true",onDragstart:z=>m(z,N),onDrag:z=>T(z,N),onDragend:z=>_(z,N)},[d("div",poe,[d("div",moe,[d("span",goe,Y(N.start)+""+Y(N.end)+" "+Y(N.label),1)])]),d("div",voe,[d("button",{class:"edit-btn",onClick:z=>R.$emit("edit-assignment",N)},"",8,yoe),d("button",{class:"delete-btn",onClick:z=>L(N.id)},"",8,xoe)]),d("div",{class:"resize-handle",onMousedown:dn(z=>A(z,N),["stop"]),title:"Drag to resize block"},null,40,Eoe)],46,hoe))),128))],4)]))}},boe=xt(_oe,[["__scopeId","data-v-8f5880e4"]]),Soe={class:"dialog-header"},Aoe={class:"dialog-header-actions"},Toe={class:"dialog-content"},woe={style:{display:"flex","align-items":"flex-start"}},Coe={class:"dialog-actions"},Ioe=["disabled"],koe={key:0},Doe={key:1},Poe={__name:"AideScheduleEditDialog",props:{aideName:String,timeTicks:Array,isTickInAnyBlock:Function,aideAssignments:Array,getAssignmentBoxStyle:Function,onAssignmentDragStart:Function,onAssignmentDrag:Function,onAssignmentDragEnd:Function,onResizeStart:Function,showAddAssignment:Boolean,addAssignment:Function,onImportAssignments:Function,onSave:Function,onClose:Function,saving:Boolean,blocks:Array,teachers:Array,students:Array},setup(t){const e=t,r=se([]),n=se(!1),s=se(null);jt(()=>{console.log("DEBUG: AideScheduleEditDialog mounted, blocks:",e.blocks)}),Vt(()=>e.blocks,f=>{console.log("DEBUG: props.blocks in AideScheduleEditDialog",f)});function i(){e.onSave(r.value)}function a(){r.value=e.aideAssignments?JSON.parse(JSON.stringify(e.aideAssignments)):[],n.value=!0}function o(f){r.value=e.aideAssignments?JSON.parse(JSON.stringify(e.aideAssignments)):[],s.value={...f},n.value=!0}function l(f){if(s.value){const h=r.value.findIndex(p=>p.id===f.id);h!==-1&&(r.value[h]={...f}),s.value=null}else r.value=[...r.value,f];n.value=!1}function c(){s.value=null,n.value=!1}function u(f){console.log("handleUpdateAssignments called with:",f),r.value=f}return(f,h)=>(O(),B("div",{class:"dialog-overlay",onClick:h[4]||(h[4]=(...p)=>t.onClose&&t.onClose(...p))},[d("div",{class:"edit-dialog",onClick:h[3]||(h[3]=dn(()=>{},["stop"]))},[d("div",Soe,[d("h2",null,"Edit Schedule: "+Y(t.aideName),1),d("div",Aoe,[d("button",{onClick:h[0]||(h[0]=(...p)=>t.onImportAssignments&&t.onImportAssignments(...p)),class:"btn btn-secondary btn-import-assignments"},"Import Aide Assignments"),d("button",{onClick:a,class:"btn btn-primary btn-add-assignment"},"Add Assignment"),d("button",{onClick:h[1]||(h[1]=(...p)=>t.onClose&&t.onClose(...p)),class:"btn btn-secondary close-btn"},"")])]),d("div",Toe,[d("div",woe,[Le(boe,{timeTicks:t.timeTicks,isTickInAnyBlock:t.isTickInAnyBlock,assignments:r.value,getAssignmentBoxStyle:t.getAssignmentBoxStyle,onAssignmentDragStart:t.onAssignmentDragStart,onAssignmentDrag:t.onAssignmentDrag,onAssignmentDragEnd:t.onAssignmentDragEnd,onResizeStart:t.onResizeStart,blocks:t.blocks,onEditAssignment:o,"onUpdate:assignments":u},null,8,["timeTicks","isTickInAnyBlock","assignments","getAssignmentBoxStyle","onAssignmentDragStart","onAssignmentDrag","onAssignmentDragEnd","onResizeStart","blocks"])]),n.value?(O(),tr(loe,{key:0,teachers:t.teachers,students:t.students,assignment:s.value,onSave:l,onClose:c},null,8,["teachers","students","assignment"])):_e("",!0)]),d("div",Coe,[d("button",{onClick:i,class:"btn btn-primary",disabled:t.saving},[t.saving?(O(),B("span",koe,"")):(O(),B("span",Doe,"")),Ce(" "+Y(t.saving?"Saving...":"Save Schedule"),1)],8,Ioe),d("button",{onClick:h[2]||(h[2]=(...p)=>t.onClose&&t.onClose(...p)),class:"btn btn-secondary"},"Cancel")])])]))}},Roe={class:"master-schedule"},Foe={key:0,class:"no-time-table"},Noe={class:"no-data-message"},Ooe={key:1,class:"schedule-graph-container"},Moe={class:"timeline-header"},Loe={class:"block-time"},Boe={class:"block-name"},Uoe={class:"block-time"},$oe={class:"aide-header"},Voe={class:"aide-name"},Hoe=["onClick"],joe={class:"time-line-container"},Goe={class:"time-blocks-background"},Woe={class:"assignment-bars"},zoe={class:"assignment-label"},Fg=30,Koe={__name:"AideScheduleMasterTable",props:{paraeducators:Array,blocks:Array,getAideTimeBlocks:Function,getAideName:Function,currentTimeTable:Object},emits:["editAideAssignment","gotoTimeTableConfig"],setup(t,{emit:e}){const r=t,n=se([]);function s(b){const E=r.getAideTimeBlocks(b).filter(x=>x.assignment).map(x=>({id:x.id,label:x.assignment,type:x.assignmentType,start:x.start||x.displayTime.split(" - ")[0],end:x.end||x.displayTime.split(" - ")[1]}));return i(E)}function i(b){if(b.length===0)return[];const E=[...b].sort((P,w)=>f(P.start)-f(w.start)),x=[];let I=[];for(const P of E)I.length===0?I=[P]:I.some(S=>f(P.start)<f(S.end)&&f(P.end)>f(S.start))?I.push(P):(x.push(I),I=[P]);I.length>0&&x.push(I);const D=[];for(const P of x)P.forEach((w,S)=>{w.overlapIndex=S,w.overlapCount=P.length,D.push(w)});return D}function a(b){if(!b.overlapCount||b.overlapCount<=1)return 10;const E=40;return(60-(b.overlapCount*E+(b.overlapCount-1)*2))/2+b.overlapIndex*(E+2)}function o(b){if(!r.blocks||r.blocks.length===0)return 0;const E=r.blocks[0],x=r.blocks[r.blocks.length-1],I=f(E.startTime),P=f(x.endTime)-I,S=(f(b)-I)/P*100;return Math.max(0,Math.min(95,S))}function l(b,E){if(!r.blocks||r.blocks.length===0)return 10;const x=r.blocks[0],I=r.blocks[r.blocks.length-1],D=f(x.startTime),w=f(I.endTime)-D,S=f(b),T=(f(E)-S)/w*100;return Math.max(5,Math.min(95,T))}function c(b){if(!r.blocks||r.blocks.length===0)return 0;const E=r.blocks[0],x=r.blocks[r.blocks.length-1],I=f(E.startTime),P=f(x.endTime)-I,S=(f(b)-I)/P*100;return Math.max(0,Math.min(95,S))}function u(b,E){if(!r.blocks||r.blocks.length===0)return 10;const x=r.blocks[0],I=r.blocks[r.blocks.length-1],D=f(x.startTime),w=f(I.endTime)-D,S=f(b),T=(f(E)-S)/w*100;return Math.max(5,Math.min(95,T))}function f(b){const[E,x]=b.split(":").map(Number);return E*60+x}function h(b){var x;const E=((x=b.name)==null?void 0:x.toLowerCase())||"";return E.includes("lunch")?"lunch":E.includes("break")||E.includes("recess")?"break":E.includes("period")||E.includes("class")?"period":"other"}function p(b){const E=[...b].sort((D,P)=>f(D.startTime)-f(P.startTime)),x=[];for(const D of E){let P=!1;for(let w=0;w<x.length;w++){const S=x[w];if(!S.some(T=>f(D.startTime)<f(T.endTime)&&f(D.endTime)>f(T.startTime))){S.push(D),D.overlapIndex=w,P=!0;break}}P||(D.overlapIndex=x.length,x.push([D]))}const I=x.length;return E.map(D=>({...D,overlapIndex:D.overlapIndex,overlapCount:I}))}const v=be(()=>p(r.blocks||[])),g=be(()=>Math.max(...v.value.map(b=>b.overlapCount||1),1)),y=be(()=>g.value*Fg);return Vt(()=>r.aideAssignments,b=>{n.value=b?JSON.parse(JSON.stringify(b)):[]},{immediate:!0}),(b,E)=>(O(),B("div",Roe,[E[4]||(E[4]=d("h2",null,"Master Schedule View",-1)),LA(b.$slots,"tab-bar",{},void 0,!0),!t.currentTimeTable||!t.currentTimeTable.schedule||t.currentTimeTable.schedule.length===0?(O(),B("div",Foe,[d("div",Noe,[E[1]||(E[1]=d("h3",null,"No Time Table Configured",-1)),E[2]||(E[2]=d("p",null,"You need to configure a time table first before you can create aide assignments.",-1)),d("button",{onClick:E[0]||(E[0]=x=>b.$emit("gotoTimeTableConfig")),class:"btn btn-primary"}," Go to Time Table Configuration ")])])):(O(),B("div",Ooe,[d("div",Moe,[E[3]||(E[3]=d("div",{class:"aide-name-header"},"Aide Name",-1)),d("div",{class:"timeline-container",style:Nr({height:y.value+"px"})},[d("div",{class:"time-blocks-header",style:Nr({height:y.value+"px"})},[(O(!0),B(Fe,null,He(v.value,x=>(O(),B("div",{key:x.id+"-"+x.overlapIndex,class:Qe(["time-block-header",h(x)]),style:Nr({left:o(x.startTime)+"%",width:l(x.startTime,x.endTime)+"%",top:x.overlapIndex*Fg+"px",height:Fg+"px",zIndex:10})},[d("div",Loe,Y(x.startTime),1),d("div",Boe,Y(x.name||x.type),1),d("div",Uoe,Y(x.endTime),1)],6))),128))],4)],4)]),(O(!0),B(Fe,null,He(t.paraeducators,x=>(O(),B("div",{key:x.id,class:"aide-row"},[d("div",$oe,[d("span",Voe,Y(t.getAideName(x.id)),1),d("button",{onClick:I=>b.$emit("editAideAssignment",x.id),class:"btn btn-small btn-primary edit-btn"}," Edit ",8,Hoe)]),d("div",joe,[d("div",Goe,[(O(!0),B(Fe,null,He(t.blocks,I=>(O(),B("div",{key:I.id,class:Qe(["time-block-bg",h(I)]),style:Nr({left:o(I.startTime)+"%",width:l(I.startTime,I.endTime)+"%"})},null,6))),128)),(O(!0),B(Fe,null,He(t.blocks.slice(0,-1),(I,D)=>(O(),B("div",{key:`bg-gap-${I.id}`,class:"time-block-bg-gap",style:Nr({left:o(I.endTime)-.5+"%",width:"1%"})},null,4))),128))]),d("div",Woe,[(O(!0),B(Fe,null,He(s(x.id),I=>(O(),B("div",{key:I.id,class:Qe(["master-assignment-bar",I.type]),style:Nr({left:c(I.start)+"%",width:u(I.start,I.end)+"%",top:a(I)+"px"})},[d("span",zoe,Y(I.label),1)],6))),128))])])]))),128))]))]))}},qoe=xt(Koe,[["__scopeId","data-v-40c5158e"]]);function l0(t){return(t==null?void 0:t.schedule)||[]}function Xoe(t){let e="23:59",r="00:00";for(const n of t)n.startTime&&n.startTime<e&&(e=n.startTime),n.endTime&&n.endTime>r&&(r=n.endTime);return{min:e,max:r}}function Yoe(t){return be(()=>{const{min:e,max:r}=Xoe(t.value||t),[n,s]=e.split(":").map(Number),[i,a]=r.split(":").map(Number);let o=[],l=n,c=s;for(;l<i||l===i&&c<=a;){const f=l<10?`0${l}`:`${l}`,h=c<10?`0${c}`:`${c}`;o.push({time:`${f}:${h}`}),c+=5,c>=60&&(c=0,l++)}const u=(t.value||t).map(f=>f.startTime);for(const f of u)o.find(h=>h.time===f)||o.push({time:f});return o=Array.from(new Set(o.map(f=>f.time))).sort().map(f=>({time:f})),o})}function Qoe(t,e){return e.some(r=>r.startTime<=t&&r.endTime>=t)}const Joe={class:"admin-aide-schedule-detailed"},Zoe={class:"header"},ele={class:"header-actions"},tle=["disabled"],rle={key:0},nle={key:1},sle={class:"content"},ale={key:0,class:"error-message"},ile={key:1,class:"error-message"},ole={key:2,class:"loading"},lle={key:3,class:"schedule-container"},cle={key:0,class:"time-table-tab-bar"},ule=["onClick"],hD={__name:"AdminAideSchedule",setup(t){const e=Ci(),r=Fs(),{userList:n,fetchUsers:s}=_a(),{students:i,fetchStudents:a}=Ii(),{appSettings:o,loadAppSettings:l,saveAppSettings:c}=qs(),{labels:u}=xo(),{aideSchedule:f,loadAideSchedules:h,saveAideSchedule:p}=uie(),{aideAssignment:v}=Ky(),g=se(!0),y=se(!1),b=se(null),E=se({}),x=se({}),I=se(null);se([]);const D=se({}),P=be(()=>E.value&&Array.isArray(E.value.timeTables)&&E.value.timeTables.length>0?E.value.timeTables.map((ie,ve)=>({id:ie.name?ie.name.toLowerCase().replace(/\s+/g,"-"):`tt-${ve}`,label:ie.name||`Time Table ${ve+1}`,...ie})):E.value&&E.value.schedule?[{id:"default",label:E.value.label||"Default Schedule",schedule:E.value.schedule}]:[]);jt(async()=>{console.log("Loaded timeTableData:",E.value),console.log("Computed allTimeTables:",P.value),P.value.length>0&&!I.value&&(I.value=P.value[0].id,console.log("Set selectedTimeTable:",I.value)),await l(),o.value.timeTables&&Array.isArray(o.value.timeTables)?(E.value={timeTables:o.value.timeTables},console.log("Set timeTableData to timeTables array:",E.value)):o.value.schedule&&(E.value={schedule:o.value.schedule},console.log("Set timeTableData to single schedule:",E.value))}),Vt(P,ie=>{console.log("allTimeTables changed:",ie)}),Vt(I,ie=>{console.log("selectedTimeTable changed:",ie)});const w=be(()=>{const ie=P.value.find(ve=>ve.id===I.value)||P.value[0];return console.log("currentTimeTable:",ie),ie}),S=be(()=>l0(w.value)),m=Yoe(S);function T(ie){return Qoe(ie,S.value)}const _=be(()=>{var ve;const ie=(ve=r.currentUser)==null?void 0:ve.role;return["admin","school_admin","admin_504","sped_chair"].includes(ie)}),A=be(()=>{var ie;return((ie=n.value)==null?void 0:ie.filter(ve=>ve.role==="paraeducator"))||[]}),k=be(()=>{var ie;return((ie=n.value)==null?void 0:ie.filter(ve=>ve.role==="teacher"))||[]});be(()=>u.value);function U(ie){if(!S.value)return[];console.log("DEBUG: getAideTimeBlocks called for aide:",ie),console.log("DEBUG: aideSchedule.value:",f.value),console.log("DEBUG: aideAssignment.value:",v.value);const we=(f.value[ie]||{}).schedule||{};console.log("DEBUG: aideScheduleData:",we);const De=Object.values(we).filter(Te=>Te.start&&Te.end&&Te.label).map(Te=>({id:Te.id||Te.blockId||`assignment-${Date.now()}`,assignment:Te.label,assignmentType:Te.type||"custom",displayTime:`${Te.start} - ${Te.end}`,start:Te.start,end:Te.end}));return console.log("DEBUG: individualAssignments:",De),De.length>0?De:(console.log("DEBUG: No individual assignments found, adding test data"),[{id:"test-1",assignment:"Test Class Assignment",assignmentType:"class",displayTime:"08:00 - 09:00",start:"08:00",end:"09:00"},{id:"test-2",assignment:"Test Student Assignment",assignmentType:"student",displayTime:"10:00 - 11:00",start:"10:00",end:"11:00"}])}function L(ie){const ve=A.value.find(we=>we.id===ie);return ve?ve.name||ve.email:"Unknown Aide"}function R(ie){b.value=ie,te.value=!0}function F(){b.value=null}async function N(){try{y.value=!0;const ve={...await l(),detailedAideSchedule:x.value};await c(ve),console.log("Detailed aide schedule saved successfully")}catch(ie){console.error("Error saving detailed aide schedule:",ie)}finally{y.value=!1}}function M(){e.push("/admin")}async function z(){try{g.value=!0,await Promise.all([s(),a(),l()]);const ie=await nr(Ze(qe,"app_settings","global"));if(ie.exists()){const ve=ie.data();x.value=ve.detailedAideSchedule||{}}g.value=!1}catch(ie){console.error("Error loading aide schedule data:",ie),g.value=!1}}jt(z);function G(ie,ve){return ie.assignments&&ie.assignments[ve]||""}function H(){var Te,ze;if(console.log("DEBUG: handleImportAssignments called"),console.log("DEBUG: editingAideId.value:",b.value),console.log("DEBUG: aideAssignment.value:",v.value),console.log("DEBUG: All aide IDs:",Object.keys(v.value)),console.log("DEBUG: All aide data:",Object.entries(v.value).map(([ke,Ve])=>({id:ke,keys:Object.keys(Ve)}))),!b.value||!v.value[b.value]){console.log("DEBUG: No aide data found"),alert("No aide assignment data found for this aide.");return}const ie=J.value.length;if(ie>0&&!confirm(`WARNING: This will remove ${ie} current assignments and replace them with imported assignments.

Do you want to continue?`))return;const ve=v.value[b.value];console.log("DEBUG: aideData:",ve),console.log("DEBUG: aideData.classAssignment:",ve.classAssignment),console.log("DEBUG: aideData.directAssignment:",ve.directAssignment),console.log("DEBUG: Object.keys(aideData):",Object.keys(ve)),console.log("DEBUG: aideData.schedule:",ve.schedule),console.log("DEBUG: typeof aideData.schedule:",typeof ve.schedule),console.log("DEBUG: Array.isArray(aideData.schedule):",Array.isArray(ve.schedule));let we=0;J.value=[];const De=l0(w.value);console.log("DEBUG: timeTableBlocks:",De),console.log("DEBUG: timeTableBlocks with period numbers:",De.map(ke=>({name:ke.name,periodNumber:ke.periodNumber,type:ke.type})));for(const ke of De){console.log("DEBUG: Processing block:",ke),console.log("DEBUG: Block periodNumber:",ke.periodNumber),console.log("DEBUG: Block name:",ke.name),console.log("DEBUG: Available classAssignment keys:",Object.keys(ve.classAssignment||{}));let Ve=ke.periodNumber;if(!Ve&&ke.name){const Ke=ke.name.match(/Period\s*(\d+)/i);Ke&&(Ve=Ke[1],console.log("DEBUG: Extracted periodNumber from name:",Ve))}let Ae="",Ge=[];if(Ve&&ve.classAssignment&&ve.classAssignment[Ve]){console.log("DEBUG: Found class assignment for periodNumber:",Ve);const Ke=Array.isArray(ve.classAssignment[Ve])?ve.classAssignment[Ve]:[ve.classAssignment[Ve]];Ge=Ke.filter(Boolean).map(Ee=>{const ye=k.value.find(Se=>Se.id===Ee);return ye?ye.name||ye.email:"Unknown Teacher"}),Ae=Ke.filter(Boolean).map(Ee=>`teacher:${Ee}`).join(","),console.log("DEBUG: Created assignment for periodNumber:",Ae)}if(!Ae&&ke.name&&ve.classAssignment){console.log("DEBUG: Trying to match by block name:",ke.name);const Ke=Object.keys(ve.classAssignment).find(Ee=>Ee.toLowerCase().trim()===ke.name.toLowerCase().trim());if(Ke){console.log("DEBUG: Found match by block name:",Ke);const Ee=Array.isArray(ve.classAssignment[Ke])?ve.classAssignment[Ke]:[ve.classAssignment[Ke]];Ge=Ee.filter(Boolean).map(ye=>{const Se=k.value.find(Oe=>Oe.id===ye);return Se?Se.name||Se.email:"Unknown Teacher"}),Ae=Ee.filter(Boolean).map(ye=>`teacher:${ye}`).join(","),console.log("DEBUG: Created assignment for block name:",Ae)}}if(Ae){const Ke=ke.startTime,Ee=j(ke.startTime,30),ye=Ae.split(",").map(Oe=>Oe.replace("teacher:","")).filter(Boolean),Se={id:`imported-class-${Date.now()}-${we}`,label:Ge.join(", "),start:Ke,end:Ee,type:"class",blockId:`imported-block-${we}`,teacherId:ye[0]||"",note:ye.length>1?`Multiple teachers: ${Ge.join(", ")}`:""};console.log("DEBUG: Adding new assignment:",Se),J.value.push(Se),we++}}if(console.log("DEBUG: Checking direct assignments..."),console.log("DEBUG: aideData.directAssignment:",ve.directAssignment),console.log("DEBUG: typeof aideData.directAssignment:",typeof ve.directAssignment),console.log("DEBUG: Array.isArray(aideData.directAssignment):",Array.isArray(ve.directAssignment)),ve.directAssignment){console.log("DEBUG: Found directAssignment:",ve.directAssignment);const ke=Array.isArray(ve.directAssignment)?ve.directAssignment:[ve.directAssignment];console.log("DEBUG: directStudentIds:",ke),console.log("DEBUG: students.value length:",(Te=i.value)==null?void 0:Te.length),console.log("DEBUG: students.value sample:",(ze=i.value)==null?void 0:ze.slice(0,3));for(const Ve of ke)if(console.log("DEBUG: Processing studentId:",Ve),Ve&&Ve!==""){const Ae=i.value.find(Ge=>Ge.id===Ve);if(console.log("DEBUG: Found student:",Ae),Ae){const Ge=`${it(Ae,"firstName")} ${it(Ae,"lastName")}`;console.log("DEBUG: Student name:",Ge);const Ke=l0(w.value).find(Ee=>Ee.type==="period");if(console.log("DEBUG: First period block:",Ke),Ke){const Ee=Ke.startTime,ye=j(Ke.startTime,30),Se={id:`imported-direct-${Date.now()}-${we}`,label:Ge,start:Ee,end:ye,type:"student",blockId:`imported-direct-block-${we}`,studentId:Ve};console.log("DEBUG: Adding direct assignment:",Se),J.value.push(Se),we++}}}}else console.log("DEBUG: No directAssignment found");if(console.log("DEBUG: Final importedCount:",we),console.log("DEBUG: Final localAideAssignments:",J.value),we>0){alert(`Successfully imported ${we} assignments with 30-minute time spans.

Types: Class assignments set to 'class', Direct assignments set to 'student'
Labels: Teacher names for class assignments, Student names for direct assignments
Duration: 30 minutes each`);const ke=b.value,Ve=f.value[ke]||{},Ae={};J.value.forEach(Ke=>{const Ee=Ke.blockId||Ke.id||`block-${Date.now()}-${Math.random().toString(36).slice(2)}`;Ae[Ee]={id:Ke.id,blockId:Ee,type:Ke.type,label:Ke.label,start:Ke.start,end:Ke.end,note:Ke.note,teacherId:Ke.teacherId,studentId:Ke.studentId}});const Ge={...Ve,schedule:Ae};p(ke,Ge).then(()=>{h().then(()=>{F(),cl(()=>{R(ke)})})})}else alert("No matching assignments found in the Aide Assignment data for this schedule.")}function j(ie,ve){const[we,De]=ie.split(":").map(Number),Te=we*60+De+ve,ze=Math.floor(Te/60),ke=Te%60;return`${ze.toString().padStart(2,"0")}:${ke.toString().padStart(2,"0")}`}Vt(()=>l0(w.value),ie=>{const ve={};for(const we of ie){const De=G(we,b.value);ve[we.id]=De?[{id:De,value:De}]:[]}D.value=ve},{immediate:!0});function K(ie,ve){Z.value=ve,xe.value=ie.clientY,Q.value=m.value.findIndex(we=>we.time===ve.start),q.value=0,ie.dataTransfer.effectAllowed="move",ie.dataTransfer.setData("text/plain",ve.id)}function ne(ie,ve){if(!Z.value||ie.clientY===0)return;const we=ie.clientY-xe.value;q.value=we,ve._dragOffset=we}function he(ie,ve){if(!Z.value)return;const we=24,De=m.value.length;let Te=Q.value+Math.round(q.value/we);Te=Math.max(0,Math.min(De-2,Te));const ze=m.value[Te].time,ke=m.value.findIndex(Ge=>Ge.time===ve.end)-Q.value;let Ve=Te+ke;Ve=Math.max(Te+1,Math.min(De-1,Ve));const Ae=m.value[Ve].time;ve.start=ze,ve.end=Ae,ve._dragOffset=0,Z.value=null,q.value=0}function le(ie){const ve=m.value.findIndex(Ae=>Ae.time===ie.start),we=m.value.findIndex(Ae=>Ae.time===ie.end),De=24;if(ve===-1||we===-1)return{display:"none"};const Te=ve*De+(ie._dragOffset||0),ze=Math.max((we-ve)*De,De);let ke,Ve;return ie.type==="class"?(ke="#e8f4fd",Ve="#4a90e2"):ie.type==="student"?(ke="#f0f8e8",Ve="#7cb342"):(ke="#f5f5f5",Ve="#9e9e9e"),{position:"absolute",left:"20px",top:`${Te}px`,height:`${ze}px`,width:"200px",minHeight:"24px",background:ke,borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",border:`2px solid ${Ve}`,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",cursor:"grab",zIndex:2,transition:Z.value===ie?"none":"top 0.2s"}}function fe(){const ie=S.value&&S.value.length>0?S.value[0].startTime:"08:00",ve=S.value&&S.value.length>0?S.value[0].endTime:"08:30";J.value.push({id:`custom:${Date.now()}`,label:"",start:ie,end:ve,blockId:`block-${Date.now()}`})}const te=se(!1);se(null);const Z=se(null),xe=se(0),Q=se(0),q=se(0),J=se([]);Vt(b,ie=>{if(!ie){J.value=[];return}const we=(f.value[ie]||{}).schedule||{};J.value=Object.entries(we).map(([De,Te])=>({id:De+"-"+(ie||""),label:Te.label||"",start:Te.start,end:Te.end,blockId:De,type:Te.type||"lunch",teacherId:Te.teacherId||"",studentId:Te.studentId||"",note:Te.note||""}))},{immediate:!0});async function pe(ie){if(b.value)try{y.value=!0;const ve=f.value[b.value]||{},we={};ie.forEach(Te=>{const ze=Te.blockId||Te.id||`block-${Date.now()}-${Math.random().toString(36).slice(2)}`;we[ze]={id:Te.id,blockId:ze,type:Te.type,label:Te.label,start:Te.start,end:Te.end,note:Te.note,teacherId:Te.teacherId,studentId:Te.studentId}});const De={...ve,schedule:we};await p(b.value,De),await h(),F(),alert("Schedule saved!")}catch(ve){alert("Failed to save schedule: "+ve.message)}finally{y.value=!1}}Vt(()=>S,ie=>{console.log("DEBUG: blocks",ie)},{immediate:!0}),Vt(b,ie=>{ie&&(console.log("DEBUG: Opening edit dialog for aide",ie),console.log("DEBUG: blocks passed to dialog",S.value))});function ge(ie,ve){console.log("Resize start:",ve)}function ee(){fe()}return(ie,ve)=>(O(),B("div",Joe,[d("div",Zoe,[ve[4]||(ve[4]=d("h1",null,"Aide Schedule Management",-1)),d("div",ele,[d("button",{onClick:N,class:"btn btn-primary",disabled:y.value},[y.value?(O(),B("span",rle,"")):(O(),B("span",nle,"")),Ce(" "+Y(y.value?"Saving...":"Save Schedule"),1)],8,tle),d("button",{onClick:M,class:"btn btn-secondary"},ve[3]||(ve[3]=[d("span",null,"",-1),Ce(" Back ")]))])]),d("div",sle,[X(r).currentUser?_.value?g.value?(O(),B("div",ole," Loading aide schedules... ")):(O(),B("div",lle,[Le(qoe,{paraeducators:A.value,blocks:S.value,getAideTimeBlocks:U,getAideName:L,currentTimeTable:w.value,onEditAideAssignment:R,onGotoTimeTableConfig:ve[2]||(ve[2]=()=>X(e).push("/admin?tab=time-table"))},{"tab-bar":Xh(()=>[P.value.length>1?(O(),B("div",cle,[(O(!0),B(Fe,null,He(P.value,we=>(O(),B("div",{key:we.id,class:Qe(["tab-btn",{active:I.value===we.id}]),onClick:De=>I.value=we.id},Y(we.label),11,ule))),128))])):_e("",!0)]),_:1},8,["paraeducators","blocks","currentTimeTable"]),b.value?(O(),tr(Poe,{key:0,aideName:L(b.value),timeTicks:X(m),isTickInAnyBlock:T,aideAssignments:J.value,getAssignmentBoxStyle:le,onAssignmentDragStart:K,onAssignmentDrag:ne,onAssignmentDragEnd:he,onResizeStart:ge,showAddAssignment:te.value,addAssignment:ee,onImportAssignments:H,onSave:pe,onClose:F,saving:y.value,blocks:S.value,teachers:k.value,students:X(i)},null,8,["aideName","timeTicks","aideAssignments","showAddAssignment","saving","blocks","teachers","students"])):_e("",!0)])):(O(),B("div",ile,[ve[7]||(ve[7]=d("h2",null,"Access Denied",-1)),ve[8]||(ve[8]=d("p",null,"You do not have permission to access this page.",-1)),d("button",{onClick:ve[1]||(ve[1]=we=>X(e).push("/")),class:"btn btn-primary"},"Go Home")])):(O(),B("div",ale,[ve[5]||(ve[5]=d("h2",null,"Authentication Required",-1)),ve[6]||(ve[6]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:ve[0]||(ve[0]=we=>X(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])]))}},dle={name:"AdminBackupRestore",setup(){const t=se([{id:"users",name:"Users"},{id:"students",name:"Students"},{id:"app_settings",name:"App Settings"},{id:"aideSchedules",name:"Aide Schedules"},{id:"aideAssignments",name:"Aide Assignments"},{id:"feedbackForms",name:"Teacher Feedback Forms"},{id:"config",name:"Configuration"},{id:"backups",name:"Backups Metadata"}]),e=se(["users","students","app_settings"]),r=se(""),n=se(!1),s=se(!1),i=se(null),a=se(null),o=se([]),l=se(""),c=se("info"),u=Rs({overwrite:!1,validate:!0}),f=se(null),h=async()=>{var D,P,w;try{console.log(" DEBUG: Current user role:",(D=currentUser.value)==null?void 0:D.role),console.log(" DEBUG: Current user:",currentUser.value);const S=_t(qe,"backups"),m=or(S,hn("createdAt","desc"),ia(20)),T=await Gt(m);o.value=T.docs.map(_=>({id:_.id,..._.data()})),console.log(" DEBUG: Successfully loaded",o.value.length,"backups")}catch(S){console.error(" DEBUG: Error loading backups:",S),console.error(" DEBUG: Error details:",{code:S.code,message:S.message,userRole:(P=currentUser.value)==null?void 0:P.role,userId:(w=currentUser.value)==null?void 0:w.uid}),I("Error loading backups","error")}},p=async()=>{if(e.value.length===0){I("Please select at least one collection","error");return}n.value=!0,I("Creating backup...","info");try{const D={metadata:{version:"1.0",createdAt:new Date().toISOString(),createdBy:"admin",description:r.value||"Manual backup"},collections:{}};for(const S of e.value)if(S==="app_settings"){const m=Ze(qe,"app_settings","global"),T=await nr(m);D.collections[S]=T.exists()?T.data():{}}else{const m=_t(qe,S),T=await Gt(m);D.collections[S]=T.docs.map(_=>({id:_.id,..._.data()}))}const P=`backup_${Date.now()}`,w=Ze(qe,"backups",P);await Ht(w,{name:r.value||`Backup ${new Date().toLocaleDateString()}`,createdAt:new Date().toISOString(),collections:e.value,size:JSON.stringify(D).length,data:D}),r.value="",await h(),I("Backup created successfully!","success")}catch(D){console.error("Error creating backup:",D),I("Error creating backup: "+D.message,"error")}finally{n.value=!1}},v=D=>{const P=D.target.files[0];if(!P)return;i.value=P,a.value=null;const w=new FileReader;w.onload=S=>{try{const m=JSON.parse(S.target.result);m.metadata&&m.collections?(a.value=m,I("Backup file loaded successfully","success")):I("Invalid backup file format","error")}catch{I("Error parsing JSON file","error")}},w.readAsText(P)},g=async()=>{if(!i.value||!a.value){I("Please select a valid backup file","error");return}if(u.overwrite){if(!confirm("This will overwrite existing data. This action cannot be undone. Continue?"))return}else if(!confirm("This will add new data without overwriting existing records. Continue?"))return;s.value=!0,I("Restoring backup...","info");try{for(const[D,P]of Object.entries(a.value.collections))if(D==="app_settings"||D==="appSettings"){const w=Ze(qe,"app_settings","global");await Ht(w,P,{merge:!u.overwrite})}else{const w=_t(qe,D);if(Array.isArray(P))for(const S of P){const m=Ze(w,S.id);u.overwrite?await Ht(m,S):await Ht(m,S,{merge:!0})}}I("Backup restored successfully!","success"),i.value=null,a.value=null,f.value&&(f.value.value="")}catch(D){console.error("Error restoring backup:",D),I("Error restoring backup: "+D.message,"error")}finally{s.value=!1}},y=D=>{const P=JSON.stringify(D.data,null,2),w=new Blob([P],{type:"application/json"}),S=URL.createObjectURL(w),m=document.createElement("a");m.href=S,m.download=`${D.name||"backup"}.json`,m.target="_blank",m.rel="noopener noreferrer",document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(S)},b=async D=>{if(confirm("Are you sure you want to delete this backup?"))try{await po(Ze(qe,"backups",D)),await h(),I("Backup deleted successfully","success")}catch(w){console.error("Error deleting backup:",w),I("Error deleting backup","error")}},E=D=>{if(D===0)return"0 Bytes";const P=1024,w=["Bytes","KB","MB","GB"],S=Math.floor(Math.log(D)/Math.log(P));return parseFloat((D/Math.pow(P,S)).toFixed(2))+" "+w[S]},x=D=>new Date(D).toLocaleString(),I=(D,P="info")=>{l.value=D,c.value=P,setTimeout(()=>{l.value=""},5e3)};return jt(()=>{h()}),{collections:t,selectedCollections:e,backupName:r,isBackingUp:n,isRestoring:s,selectedFile:i,backupData:a,backups:o,statusMessage:l,statusType:c,restoreOptions:u,fileInput:f,createBackup:p,handleFileSelect:v,restoreBackup:g,downloadBackup:y,deleteBackup:b,formatFileSize:E,formatDate:x}}},fle={class:"admin-backup-restore"},hle={class:"content"},ple={class:"section"},mle={class:"backup-options"},gle={class:"option-group"},vle={class:"checkbox-group"},yle=["value","disabled"],xle={class:"option-group"},Ele=["disabled"],_le=["disabled"],ble={key:0},Sle={key:1},Ale={class:"section"},Tle={class:"restore-options"},wle={class:"file-upload"},Cle=["disabled"],Ile={key:0,class:"file-info"},kle={key:0,class:"option-group"},Dle={class:"backup-info"},Ple={class:"collection-name"},Rle={class:"collection-count"},Fle={key:1,class:"option-group"},Nle={class:"checkbox-group"},Ole={class:"checkbox"},Mle=["disabled"],Lle={class:"checkbox"},Ble=["disabled"],Ule=["disabled"],$le={key:0},Vle={key:1},Hle={class:"section"},jle={key:0,class:"backup-list"},Gle={class:"backup-info"},Wle={class:"admin-action-btns"},zle=["onClick"],Kle=["onClick"],qle={key:1,class:"no-backups"};function Xle(t,e,r,n,s,i){return O(),B("div",fle,[e[17]||(e[17]=d("h1",null," Admin Tools",-1)),e[18]||(e[18]=d("div",{class:"header"},[d("h1",null,"Backup & Restore"),d("p",null,"Manage database backups and restore data from JSON files")],-1)),d("div",hle,[d("div",ple,[e[9]||(e[9]=d("h2",null,"Create Backup",-1)),d("div",mle,[d("div",gle,[e[7]||(e[7]=d("label",null,"Collections to backup:",-1)),d("div",vle,[(O(!0),B(Fe,null,He(n.collections,a=>(O(),B("label",{key:a.id,class:"checkbox"},[Be(d("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>n.selectedCollections=o),value:a.id,disabled:n.isBackingUp},null,8,yle),[[wt,n.selectedCollections]]),Ce(" "+Y(a.name),1)]))),128))])]),d("div",xle,[e[8]||(e[8]=d("label",null,"Backup name (optional):",-1)),Be(d("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>n.backupName=a),placeholder:"e.g., backup-2024-01-15",disabled:n.isBackingUp},null,8,Ele),[[ht,n.backupName]])]),d("button",{onClick:e[2]||(e[2]=(...a)=>n.createBackup&&n.createBackup(...a)),disabled:n.isBackingUp||n.selectedCollections.length===0,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},[n.isBackingUp?(O(),B("span",ble,"Creating Backup...")):(O(),B("span",Sle,"Create Backup"))],8,_le)])]),d("div",Ale,[e[15]||(e[15]=d("h2",null,"Restore from Backup",-1)),d("div",Tle,[d("div",wle,[e[10]||(e[10]=d("label",null,"Select JSON backup file:",-1)),d("input",{type:"file",onChange:e[3]||(e[3]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a)),accept:".json",disabled:n.isRestoring,ref:"fileInput"},null,40,Cle),n.selectedFile?(O(),B("p",Ile," Selected: "+Y(n.selectedFile.name)+" ("+Y(n.formatFileSize(n.selectedFile.size))+") ",1)):_e("",!0)]),n.backupData?(O(),B("div",kle,[e[11]||(e[11]=d("label",null,"Collections in backup:",-1)),d("div",Dle,[(O(!0),B(Fe,null,He(n.backupData.collections,(a,o)=>(O(),B("div",{key:o,class:"collection-info"},[d("span",Ple,Y(o)+":",1),d("span",Rle,Y(Array.isArray(a)?a.length:"1")+" items",1)]))),128))])])):_e("",!0),n.backupData?(O(),B("div",Fle,[e[14]||(e[14]=d("label",null,"Restore options:",-1)),d("div",Nle,[d("label",Ole,[Be(d("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=a=>n.restoreOptions.overwrite=a),disabled:n.isRestoring},null,8,Mle),[[wt,n.restoreOptions.overwrite]]),e[12]||(e[12]=Ce(" Overwrite existing data "))]),d("label",Lle,[Be(d("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=a=>n.restoreOptions.validate=a),disabled:n.isRestoring},null,8,Ble),[[wt,n.restoreOptions.validate]]),e[13]||(e[13]=Ce(" Validate data before restore "))])])])):_e("",!0),d("button",{onClick:e[6]||(e[6]=(...a)=>n.restoreBackup&&n.restoreBackup(...a)),disabled:n.isRestoring||!n.selectedFile||!n.backupData,class:"admin-action-btn warning",style:{"min-width":"140px","max-width":"140px"}},[n.isRestoring?(O(),B("span",$le,"Restoring...")):(O(),B("span",Vle,"Restore Backup"))],8,Ule)])]),d("div",Hle,[e[16]||(e[16]=d("h2",null,"Backup History",-1)),n.backups.length>0?(O(),B("div",jle,[(O(!0),B(Fe,null,He(n.backups,a=>(O(),B("div",{key:a.id,class:"backup-item"},[d("div",Gle,[d("h3",null,Y(a.name||"Unnamed Backup"),1),d("p",null,"Created: "+Y(n.formatDate(a.createdAt)),1),d("p",null,"Size: "+Y(n.formatFileSize(a.size)),1),d("p",null,"Collections: "+Y(a.collections.join(", ")),1)]),d("div",Wle,[d("button",{onClick:o=>n.downloadBackup(a),class:"admin-action-btn secondary"},"Download",8,zle),d("button",{onClick:o=>n.deleteBackup(a.id),class:"admin-action-btn delete"},"Delete",8,Kle)])]))),128))])):(O(),B("p",qle,"No backups found"))])]),n.statusMessage?(O(),B("div",{key:0,class:Qe(["status-message",n.statusType])},Y(n.statusMessage),3)):_e("",!0)])}const pD=xt(dle,[["render",Xle],["__scopeId","data-v-bc031c32"]]),Yle={class:"admin-audit-logs"},Qle={class:"log-controls"},Jle={class:"log-filters"},Zle=["disabled"],ece=["disabled"],tce={class:"logs-container"},rce={key:0,class:"loading-state"},nce={key:1,class:"logs-table"},sce={class:"timestamp"},ace={class:"log-type"},ice={class:"user-info"},oce={class:"user-email"},lce={class:"user-id"},cce={class:"action"},uce={class:"details"},dce={class:"details-preview"},fce={class:"actions"},hce=["onClick"],pce={key:2,class:"no-logs"},mce={key:1,class:"pagination"},gce=["disabled"],vce={class:"page-info"},yce=["disabled"],xce={class:"dialog-content"},Ece={class:"log-detail-section"},_ce={class:"detail-grid"},bce={class:"detail-item"},Sce={class:"detail-item"},Ace={class:"detail-item"},Tce={class:"detail-item"},wce={class:"detail-item"},Cce={class:"detail-item"},Ice={class:"detail-item"},kce={key:0,class:"log-detail-section"},Dce={class:"detail-grid"},Pce={key:0,class:"detail-item"},Rce={key:1,class:"detail-item"},Fce={key:2,class:"detail-item"},Nce={key:1,class:"log-detail-section"},Oce={class:"details-content"},Mce={key:2,class:"log-detail-section"},Lce={class:"detail-grid"},Bce={key:0,class:"detail-item"},Uce={key:1,class:"detail-item"},c0=25,$ce={__name:"AdminAuditLogs",setup(t){const e=yo(),r=se([]),n=se(!1),s=se(""),i=se(!1),a=se(null),o=se("7"),l=se(""),c=se(""),u=se(""),f=se(1),h=be(()=>{let _=r.value;if(l.value&&(_=_.filter(A=>A.type===l.value)),c.value&&(_=_.filter(A=>A.action===c.value)),u.value){const A=u.value.toLowerCase();_=_.filter(k=>k.userEmail&&k.userEmail.toLowerCase().includes(A)||k.action&&k.action.toLowerCase().includes(A)||k.details&&JSON.stringify(k.details).toLowerCase().includes(A)||k.studentId&&k.studentId.toLowerCase().includes(A))}return _}),p=be(()=>{const _=(f.value-1)*c0,A=_+c0;return h.value.slice(_,A)}),v=be(()=>Math.ceil(h.value.length/c0)),g=async()=>{n.value=!0,s.value="";try{const _=new Date;_.setDate(_.getDate()-parseInt(o.value));const A=or(_t(e,"auditLogs"),Ur("timestamp",">=",_),hn("timestamp","desc"),ia(500)),k=await Gt(A);r.value=k.docs.map(U=>({id:U.id,...U.data()})),f.value=1,S(`Loaded ${r.value.length} audit logs`,!1)}catch(_){console.error("Error loading audit logs:",_),S("Error loading audit logs: "+_.message,!0)}finally{n.value=!1}},y=async()=>{try{const _=b(h.value),A=new Blob([_],{type:"text/csv"}),k=window.URL.createObjectURL(A),U=document.createElement("a");U.href=k,U.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,U.click(),window.URL.revokeObjectURL(k),S("Audit logs exported successfully",!1)}catch(_){console.error("Error exporting logs:",_),S("Error exporting logs: "+_.message,!0)}},b=_=>{const k=[["Timestamp","Type","User Email","User ID","Action","Details","Student ID","Session ID","IP Address"].join(",")];return _.forEach(U=>{const L=[I(U.timestamp),U.type||"",U.userEmail||U.performedByEmail||"",U.userId||U.performedBy||"",U.action||"",JSON.stringify(U.details||"").replace(/"/g,'""'),U.studentId||U.targetUserId||"",U.sessionId||"",U.ipAddress||""];k.push(L.map(R=>`"${R}"`).join(","))}),k.join(`
`)},E=_=>{a.value=_},x=()=>{a.value=null},I=_=>{if(!_)return"N/A";let A;return _.toDate?A=_.toDate():_ instanceof Date?A=_:A=new Date(_),A.toLocaleString()},D=_=>({student_access:"Student Access",user_management:"User Management",system_access:"System Access",data_export:"Data Export",session_timeout:"Session Timeout"})[_]||_,P=_=>{if(_.details){const k=typeof _.details=="string"?_.details:JSON.stringify(_.details);return k.length>50?k.substring(0,50)+"...":k}const A=[];return _.studentId&&A.push(`Student: ${_.studentId}`),_.targetUserId&&A.push(`Target: ${_.targetUserId}`),_.exportType&&A.push(`Export: ${_.exportType}`),_.studentCount&&A.push(`Count: ${_.studentCount}`),A.join(", ")||"No additional details"},w=_=>{if(!_)return"No details available";if(typeof _=="string")try{const A=JSON.parse(_);return JSON.stringify(A,null,2)}catch{return _}return JSON.stringify(_,null,2)},S=(_,A=!1)=>{s.value=_,i.value=A,setTimeout(()=>{s.value="",i.value=!1},5e3)};let m=null;const T=()=>{m&&clearTimeout(m),m=setTimeout(()=>{f.value=1},300)};return jt(()=>{g()}),(_,A)=>(O(),B("div",Yle,[A[29]||(A[29]=d("div",{class:"logs-header"},[d("h2",null," System Audit Logs"),d("p",{class:"logs-description"}," View and search system audit logs for security monitoring and compliance. ")],-1)),d("div",Qle,[d("div",Jle,[Be(d("select",{"onUpdate:modelValue":A[0]||(A[0]=k=>o.value=k),onChange:g,class:"form-select"},A[7]||(A[7]=[d("option",{value:"1"},"Last 24 hours",-1),d("option",{value:"7"},"Last 7 days",-1),d("option",{value:"30"},"Last 30 days",-1),d("option",{value:"90"},"Last 90 days",-1)]),544),[[cr,o.value]]),Be(d("select",{"onUpdate:modelValue":A[1]||(A[1]=k=>l.value=k),onChange:g,class:"form-select"},A[8]||(A[8]=[In('<option value="" data-v-aacc574e>All Log Types</option><option value="student_access" data-v-aacc574e>Student Access</option><option value="user_management" data-v-aacc574e>User Management</option><option value="system_access" data-v-aacc574e>System Access</option><option value="data_export" data-v-aacc574e>Data Export</option><option value="session_timeout" data-v-aacc574e>Session Timeout</option>',6)]),544),[[cr,l.value]]),Be(d("select",{"onUpdate:modelValue":A[2]||(A[2]=k=>c.value=k),onChange:g,class:"form-select"},A[9]||(A[9]=[In('<option value="" data-v-aacc574e>All Actions</option><option value="login" data-v-aacc574e>Login</option><option value="logout" data-v-aacc574e>Logout</option><option value="create" data-v-aacc574e>Create</option><option value="edit" data-v-aacc574e>Edit</option><option value="delete" data-v-aacc574e>Delete</option><option value="view" data-v-aacc574e>View</option><option value="admin_panel_access" data-v-aacc574e>Admin Access</option>',8)]),544),[[cr,c.value]]),Be(d("input",{"onUpdate:modelValue":A[3]||(A[3]=k=>u.value=k),onInput:T,type:"text",placeholder:"Search logs...",class:"form-input"},null,544),[[ht,u.value]]),d("button",{onClick:g,class:"btn btn-secondary",disabled:n.value},"  "+Y(n.value?"Loading...":"Refresh"),9,Zle),d("button",{onClick:y,class:"btn btn-primary",disabled:n.value},"  Export Logs ",8,ece)])]),s.value?(O(),B("div",{key:0,class:Qe(["status-message",{error:i.value}])},Y(s.value),3)):_e("",!0),d("div",tce,[n.value?(O(),B("div",rce," Loading audit logs... ")):h.value.length>0?(O(),B("table",nce,[A[10]||(A[10]=d("thead",null,[d("tr",null,[d("th",null,"Timestamp"),d("th",null,"Type"),d("th",null,"User"),d("th",null,"Action"),d("th",null,"Details"),d("th",null,"Actions")])],-1)),d("tbody",null,[(O(!0),B(Fe,null,He(p.value,k=>(O(),B("tr",{key:k.id,class:"log-row"},[d("td",sce,Y(I(k.timestamp)),1),d("td",ace,[d("span",{class:Qe(["type-badge",k.type])},Y(D(k.type)),3)]),d("td",ice,[d("div",oce,Y(k.userEmail||"Unknown"),1),d("div",lce,Y(k.userId||k.performedBy||"N/A"),1)]),d("td",cce,Y(k.action||"N/A"),1),d("td",uce,[d("div",dce,Y(P(k)),1)]),d("td",fce,[d("button",{onClick:U=>E(k),class:"btn btn-sm btn-info",title:"View Details"},"  View ",8,hce)])]))),128))])])):(O(),B("div",pce,A[11]||(A[11]=[d("p",null,"No audit logs found for the selected criteria.",-1)])))]),h.value.length>c0?(O(),B("div",mce,[d("button",{onClick:A[4]||(A[4]=k=>f.value--),disabled:f.value===1,class:"btn btn-secondary"}," Previous ",8,gce),d("span",vce," Page "+Y(f.value)+" of "+Y(v.value)+" ("+Y(h.value.length)+" logs) ",1),d("button",{onClick:A[5]||(A[5]=k=>f.value++),disabled:f.value===v.value,class:"btn btn-secondary"}," Next ",8,yce)])):_e("",!0),a.value?(O(),B("div",{key:2,class:"log-dialog-overlay",onClick:x},[d("div",{class:"log-dialog",onClick:A[6]||(A[6]=dn(()=>{},["stop"]))},[d("div",{class:"dialog-header"},[A[12]||(A[12]=d("h3",null," Audit Log Details",-1)),d("button",{onClick:x,class:"close-btn"},"")]),d("div",xce,[d("div",Ece,[A[20]||(A[20]=d("h4",null,"Basic Information",-1)),d("div",_ce,[d("div",bce,[A[13]||(A[13]=d("label",null,"Timestamp:",-1)),d("span",null,Y(I(a.value.timestamp)),1)]),d("div",Sce,[A[14]||(A[14]=d("label",null,"Log Type:",-1)),d("span",{class:Qe(["type-badge",a.value.type])},Y(D(a.value.type)),3)]),d("div",Ace,[A[15]||(A[15]=d("label",null,"Action:",-1)),d("span",null,Y(a.value.action||"N/A"),1)]),d("div",Tce,[A[16]||(A[16]=d("label",null,"User Email:",-1)),d("span",null,Y(a.value.userEmail||a.value.performedByEmail||"Unknown"),1)]),d("div",wce,[A[17]||(A[17]=d("label",null,"User ID:",-1)),d("span",null,Y(a.value.userId||a.value.performedBy||"N/A"),1)]),d("div",Cce,[A[18]||(A[18]=d("label",null,"Session ID:",-1)),d("span",null,Y(a.value.sessionId||"N/A"),1)]),d("div",Ice,[A[19]||(A[19]=d("label",null,"IP Address:",-1)),d("span",null,Y(a.value.ipAddress||"N/A"),1)])])]),a.value.studentId||a.value.targetUserId?(O(),B("div",kce,[A[24]||(A[24]=d("h4",null,"Target Information",-1)),d("div",Dce,[a.value.studentId?(O(),B("div",Pce,[A[21]||(A[21]=d("label",null,"Student ID:",-1)),d("span",null,Y(a.value.studentId),1)])):_e("",!0),a.value.targetUserId?(O(),B("div",Rce,[A[22]||(A[22]=d("label",null,"Target User ID:",-1)),d("span",null,Y(a.value.targetUserId),1)])):_e("",!0),a.value.studentIds?(O(),B("div",Fce,[A[23]||(A[23]=d("label",null,"Student IDs:",-1)),d("span",null,Y(Array.isArray(a.value.studentIds)?a.value.studentIds.join(", "):a.value.studentIds),1)])):_e("",!0)])])):_e("",!0),a.value.details?(O(),B("div",Nce,[A[25]||(A[25]=d("h4",null,"Additional Details",-1)),d("div",Oce,[d("pre",null,Y(w(a.value.details)),1)])])):_e("",!0),a.value.exportType||a.value.studentCount?(O(),B("div",Mce,[A[28]||(A[28]=d("h4",null,"Export Information",-1)),d("div",Lce,[a.value.exportType?(O(),B("div",Bce,[A[26]||(A[26]=d("label",null,"Export Type:",-1)),d("span",null,Y(a.value.exportType),1)])):_e("",!0),a.value.studentCount?(O(),B("div",Uce,[A[27]||(A[27]=d("label",null,"Student Count:",-1)),d("span",null,Y(a.value.studentCount),1)])):_e("",!0)])])):_e("",!0)]),d("div",{class:"dialog-actions"},[d("button",{onClick:x,class:"btn btn-secondary"},"Close")])])])):_e("",!0)]))}},Vce=xt($ce,[["__scopeId","data-v-aacc574e"]]),Hce={class:"teacher-feedback-admin"},jce={key:0,class:"status-message loading"},Gce={key:1,class:"status-message success"},Wce={key:2,class:"status-message error"},zce={class:"quick-actions"},Kce=["disabled"],qce={class:"modal-body"},Xce={class:"form-group"},Yce={class:"form-group"},Qce={class:"form-group"},Jce={class:"form-group"},Zce={class:"modal-footer"},eue=["disabled"],tue={key:0},rue={key:1},nue={class:"setup-section"},sue={key:0,class:"loading-state"},aue={key:1,class:"status-card"},iue={class:"status-header"},oue={class:"status-indicator"},lue={key:0,class:"status-badge success"},cue={key:1,class:"status-badge info"},uue={class:"status-details"},due={key:0},fue={key:1},hue={key:0},pue={key:1,class:"info-note"},mue={key:0,class:"drive-actions"},gue=["href"],vue={key:2,class:"setup-options"},yue={class:"setup-card"},xue={class:"workspace-setup"},Eue={class:"form-group"},_ue=["disabled"],bue=["disabled"],Sue={key:0},Aue={key:1},Tue={class:"forms-list"},wue={key:0,class:"loading"},Cue={key:1,class:"empty-state"},Iue={key:2,class:"forms-grid"},kue={class:"form-header"},Due={class:"admin-action-btns"},Pue=["onClick"],Rue=["onClick"],Fue=["onClick"],Nue={class:"form-meta"},Oue={key:0},Mue=["href"],Lue={key:1},Bue=["href"],Uue={key:2,class:"sheet-status pending"},$ue={__name:"AdminTeacherFeedback",setup(t){const{isLoading:e,error:r,successMessage:n,formsLoading:s,activeForms:i,createFeedbackFormWithUserAuth:a,deleteFeedbackForm:o,clearMessages:l}=qy();_a();const c=Fs(),u=se(!1),f=se(""),h=se(""),p=se(""),v=se(""),g=se(null),y=se(!0),b=se(""),E=se("info"),x=se(""),I=se(!1),D=be(()=>f.value.trim()&&p.value.trim()),P=async()=>{if(D.value)try{l();const{GoogleAuthProvider:L,signInWithPopup:R,getAuth:F}=await la(async()=>{const{GoogleAuthProvider:K,signInWithPopup:ne,getAuth:he}=await Promise.resolve().then(()=>F5);return{GoogleAuthProvider:K,signInWithPopup:ne,getAuth:he}},void 0),N=F(),M=new L;M.addScope("https://www.googleapis.com/auth/drive.file"),M.addScope("https://www.googleapis.com/auth/spreadsheets");let z;try{z=await R(N,M)}catch(K){throw K.code==="auth/popup-closed-by-user"||K.message.includes("Cross-Origin-Opener-Policy")?new Error(" Authentication popup was blocked or closed. Please allow popups for this site and try again."):K}const H=L.credentialFromResult(z).accessToken;if(!H)throw new Error("Failed to get Google access token. Please try again.");console.log(" Got Google access token for feedback form creation");const j={title:f.value.trim(),description:h.value.trim(),formUrl:p.value.trim(),sheetTemplateUrl:v.value.trim(),createdBy:c.user.uid};await a(j,H),w()}catch(L){console.error("Error adding form:",L),L.code==="auth/popup-closed-by-user"?L.value=" Authentication cancelled. Please try again and allow Google Drive access.":L.code==="auth/popup-blocked"?L.value=" Popup blocked. Please allow popups for this site and try again.":L.message&&L.message.includes("Cross-Origin-Opener-Policy")?L.value=" Browser security policy blocked the authentication popup. Please try again or contact support.":L.value=L.message||"Failed to create feedback form"}},w=()=>{u.value=!1,f.value="",h.value="",p.value="",v.value="",l()},S=L=>{window.open(L.formUrl,"_blank","noopener,noreferrer")},m=async L=>{window.open(L.formUrl,"_blank","noopener,noreferrer")},T=async L=>{if(confirm(`Are you sure you want to delete "${L.title}"?`))try{await o(L.id)}catch(R){console.error("Error deleting form:",R)}},_=L=>L?(L.seconds?new Date(L.seconds*1e3):new Date(L)).toLocaleDateString():"N/A",A=async()=>{try{y.value=!0;const{getFunctions:L,httpsCallable:R}=await la(async()=>{const{getFunctions:z,httpsCallable:G}=await Promise.resolve().then(()=>A0);return{getFunctions:z,httpsCallable:G}},void 0),F=L(),M=await R(F,"getUserSchool")();M.data.success&&M.data.school?g.value=M.data.school:await k()}catch(L){console.error("Error loading school info:",L),b.value="Error loading Google Drive settings",E.value="error"}finally{y.value=!1}},k=async()=>{try{const{getFunctions:L,httpsCallable:R}=await la(async()=>{const{getFunctions:z,httpsCallable:G}=await Promise.resolve().then(()=>A0);return{getFunctions:z,httpsCallable:G}},void 0),F=L(),M=await R(F,"getOrCreateSchool")();M.data.success&&(g.value=M.data.school,M.data.school.isNew&&(b.value="Google Drive settings initialized! You can now create feedback forms.",E.value="success"))}catch(L){console.error("Error creating school:",L),b.value="Error initializing Google Drive settings: "+L.message,E.value="error"}},U=async()=>{if(x.value.trim()){I.value=!0,b.value="";try{const{getFunctions:L,httpsCallable:R}=await la(async()=>{const{getFunctions:z,httpsCallable:G}=await Promise.resolve().then(()=>A0);return{getFunctions:z,httpsCallable:G}},void 0),F=L(),M=await R(F,"createSharedDrive")({schoolId:g.value.schoolId,driveName:x.value.trim()});if(M.data.requiresManualCreation){const z=M.data.instructions,G=M.data.serviceAccountEmail;b.value=`Google Workspace setup requires manual configuration:

1. ${z.join(`
2. `)}

Service Account Email: ${G}`,E.value="info"}else M.data.success?(b.value="Google Workspace setup completed successfully!",E.value="success",await A(),x.value=""):(b.value="Error setting up Google Workspace: "+M.data.error,E.value="error")}catch(L){console.error("Error setting up workspace:",L),b.value="Error setting up Google Workspace: "+L.message,E.value="error"}finally{I.value=!1}}};return jt(async()=>{await A()}),(L,R)=>{var F;return O(),B("div",Hce,[R[35]||(R[35]=d("div",{class:"admin-header"},[d("h2",null,"Teacher Feedback Forms"),d("p",{class:"admin-description"}," Create and manage Google Forms for collecting teacher feedback on students. Each case manager will have their own response sheet automatically created when they first use the form. ")],-1)),X(e)?(O(),B("div",jce," Processing... ")):_e("",!0),X(n)?(O(),B("div",Gce,Y(X(n)),1)):_e("",!0),X(r)?(O(),B("div",Wce,Y(X(r)),1)):_e("",!0),d("div",zce,[d("button",{onClick:R[0]||(R[0]=N=>u.value=!0),class:"primary-btn",disabled:X(e)},R[7]||(R[7]=[d("span",null,"",-1),Ce(" Add Form ")]),8,Kce)]),u.value?(O(),B("div",{key:3,class:"modal-overlay",onClick:w},[d("div",{class:"modal-content",onClick:R[5]||(R[5]=dn(()=>{},["stop"]))},[d("div",{class:"modal-header"},[R[8]||(R[8]=d("h3",null,"Add Teacher Feedback Form",-1)),d("button",{onClick:w,class:"close-btn"},"")]),d("div",qce,[d("div",Xce,[R[9]||(R[9]=d("label",null,"Form Title:",-1)),Be(d("input",{type:"text","onUpdate:modelValue":R[1]||(R[1]=N=>f.value=N),placeholder:"Enter a descriptive title for this form",class:"form-input",required:""},null,512),[[ht,f.value]])]),d("div",Yce,[R[10]||(R[10]=d("label",null,"Form Description (optional):",-1)),Be(d("textarea",{"onUpdate:modelValue":R[2]||(R[2]=N=>h.value=N),placeholder:"Brief description of what this form is for",class:"form-textarea",rows:"3"},null,512),[[ht,h.value]])]),d("div",Qce,[R[11]||(R[11]=d("label",null,"Google Form URL:",-1)),Be(d("input",{type:"url","onUpdate:modelValue":R[3]||(R[3]=N=>p.value=N),placeholder:"https://docs.google.com/forms/d/your-form-id/viewform",class:"form-input",required:""},null,512),[[ht,p.value]]),R[12]||(R[12]=d("small",{class:"form-help"},"Paste the Google Form URL here (viewform link)",-1))]),d("div",Jce,[R[13]||(R[13]=d("label",null,"Google Sheet Template URL (optional):",-1)),Be(d("input",{type:"url","onUpdate:modelValue":R[4]||(R[4]=N=>v.value=N),placeholder:"https://docs.google.com/spreadsheets/d/your-sheet-id/edit",class:"form-input"},null,512),[[ht,v.value]]),R[14]||(R[14]=d("small",{class:"form-help"},"Optional: Provide a Google Sheet template that case managers can duplicate for collecting responses",-1))]),R[15]||(R[15]=d("div",{class:"form-info"},[d("h4",null," Setup Instructions:"),d("ol",null,[d("li",null,"Create your Google Form manually with the questions you want"),d("li",null,'Make sure to enable "Collect email addresses" in form settings'),d("li",null,"Copy the form's view URL and paste it above"),d("li",null,'Click "Add Form" - a Google Sheet will be automatically created for responses')]),d("p",{class:"info-note"},[d("strong",null," Automatic:"),Ce(" A Google Sheet will be created immediately when you add the form. Each case manager will get their own copy of this sheet when they use the form. ")])],-1))]),d("div",Zce,[d("button",{onClick:w,class:"secondary-btn"},"Cancel"),d("button",{onClick:P,class:"primary-btn",disabled:!D.value||X(e)},[X(e)?(O(),B("span",tue,"Adding Form...")):(O(),B("span",rue,"Add Form"))],8,eue)])])])):_e("",!0),d("div",nue,[R[25]||(R[25]=d("h3",null,"Google Drive Setup",-1)),R[26]||(R[26]=d("p",{class:"section-description"}," Configure how the system accesses Google Drive for creating feedback forms and response sheets. ",-1)),y.value?(O(),B("div",sue,R[16]||(R[16]=[d("p",null,"Loading Google Drive settings...",-1)]))):g.value?(O(),B("div",aue,[d("div",iue,[d("h4",null,Y(g.value.name||"Your School"),1),d("div",oue,[g.value.sharedDriveId?(O(),B("span",lue,"  Google Workspace Mode ")):(O(),B("span",cue,"  Personal Google Drive Mode "))])]),d("div",uue,[d("p",null,[R[17]||(R[17]=d("strong",null,"Current Mode:",-1)),g.value.sharedDriveId?(O(),B("span",due,"Google Workspace Shared Drive")):(O(),B("span",fue,"Personal Google Drive"))]),g.value.sharedDriveId?(O(),B("p",hue,[R[18]||(R[18]=d("strong",null,"Shared Drive:",-1)),Ce(" "+Y(g.value.sharedDriveName||"CaseManageVue Templates"),1)])):_e("",!0),g.value.sharedDriveId?_e("",!0):(O(),B("p",pue,R[19]||(R[19]=[d("strong",null,"Note:",-1),Ce(" Files will be created in your personal Google Drive when you create forms. ")])))]),g.value.sharedDriveId?(O(),B("div",mue,[d("a",{href:`https://drive.google.com/drive/folders/${g.value.sharedDriveId}`,target:"_blank",class:"secondary-btn"},"  Open Shared Drive ",8,gue)])):_e("",!0)])):_e("",!0),!y.value&&!((F=g.value)!=null&&F.sharedDriveId)?(O(),B("div",vue,[R[24]||(R[24]=d("div",{class:"setup-card"},[d("h4",null," Personal Google Drive (Recommended for Testing)"),d("p",{class:"setup-description"}," Use your personal Google account to create forms and sheets. Files will be created in your personal Drive. "),d("div",{class:"setup-note"},[d("strong",null," Ready to use:"),Ce(" No additional setup required. When you create forms, you'll be prompted to sign in with your Google account. ")])],-1)),d("div",yue,[R[22]||(R[22]=d("h4",null," Google Workspace (For Organizations)",-1)),R[23]||(R[23]=d("p",{class:"setup-description"}," Use a Google Workspace Shared Drive for organization-wide access and management. ",-1)),d("div",xue,[d("div",Eue,[R[20]||(R[20]=d("label",{for:"workspaceDriveName"},"Shared Drive Name:",-1)),Be(d("input",{id:"workspaceDriveName","onUpdate:modelValue":R[6]||(R[6]=N=>x.value=N),type:"text",class:"form-input",placeholder:"e.g., CaseManageVue - School Name",disabled:I.value},null,8,_ue),[[ht,x.value]])]),d("button",{onClick:U,class:"primary-btn",disabled:I.value||!x.value.trim()},[I.value?(O(),B("span",Sue," Setting up...")):(O(),B("span",Aue,"Setup Google Workspace"))],8,bue),R[21]||(R[21]=d("div",{class:"workspace-note"},[d("strong",null,"Note:"),Ce(" This requires Google Workspace admin permissions and manual configuration. ")],-1))])])])):_e("",!0),b.value?(O(),B("div",{key:3,class:Qe(["alert",E.value])},Y(b.value),3)):_e("",!0)]),d("div",Tue,[R[34]||(R[34]=d("h3",null,"Feedback Forms",-1)),X(s)?(O(),B("div",wue,"Loading forms...")):X(i).length===0?(O(),B("div",Cue,R[27]||(R[27]=[d("p",null,"No feedback forms added yet.",-1),d("p",null,'Click "Add Form" to get started.',-1)]))):(O(),B("div",Iue,[(O(!0),B(Fe,null,He(X(i),N=>(O(),B("div",{key:N.id,class:"form-card"},[d("div",kue,[d("h4",null,Y(N.title||"Untitled Form"),1),d("div",Due,[d("button",{onClick:M=>S(N),class:"admin-action-btn info",title:"View Form"},"  ",8,Pue),d("button",{onClick:M=>m(N),class:"admin-action-btn edit",title:"Edit Form"},"  ",8,Rue),d("button",{onClick:M=>T(N),class:"admin-action-btn delete",title:"Delete Form"},"  ",8,Fue)])]),d("div",Nue,[d("p",null,[R[28]||(R[28]=d("strong",null,"Created:",-1)),Ce(" "+Y(_(N.createdAt)),1)]),N.description?(O(),B("p",Oue,[R[29]||(R[29]=d("strong",null,"Description:",-1)),Ce(" "+Y(N.description),1)])):_e("",!0),d("p",null,[R[30]||(R[30]=d("strong",null,"Form URL:",-1)),R[31]||(R[31]=Ce()),d("a",{href:N.formUrl,target:"_blank",class:"form-link"},"Open Form",8,Mue)]),N.spreadsheetUrl?(O(),B("p",Lue,[R[32]||(R[32]=d("strong",null,"Response Sheet:",-1)),d("a",{href:N.spreadsheetUrl,target:"_blank",class:"form-link"},"View Responses",8,Bue),R[33]||(R[33]=d("span",{class:"sheet-status"}," Auto-created",-1))])):(O(),B("p",Uue," Sheet will be created when form is first used"))])]))),128))]))])])}}},Vue=xt($ue,[["__scopeId","data-v-31360789"]]);function Hue(t,e,r){const{getLabel:n}=xo(),s=be(()=>{var h;const f=((h=r.value)==null?void 0:h.numPeriods)||7;return Array.from({length:f},(p,v)=>({value:v.toString(),label:n(v+1),periodIndex:v}))}),i=be(()=>{const f=new Set;return console.log(" Finding teachers from students:",t.value.length),t.value.forEach(h=>{var p,v,g,y,b;(p=h.aeries)!=null&&p.schedule&&Object.values(h.aeries.schedule).forEach(E=>{E&&E.teacherId&&(console.log(" Found teacher ID in aeries.schedule:",E.teacherId),f.add(String(E.teacherId)))}),(g=(v=h.app)==null?void 0:v.schedule)!=null&&g.periods&&Object.values(h.app.schedule.periods).forEach(E=>{E&&(console.log(" Found teacher ID in app.schedule.periods:",E),f.add(String(E)))});for(let E=1;E<=7;E++){const x=`period${E}TeacherId`,I=h[x]||((y=h.aeries)==null?void 0:y[x])||((b=h.app)==null?void 0:b[x]);I&&(console.log(" Found teacher ID in",x,":",I),f.add(String(I)))}}),console.log(" Unique teacher IDs found:",Array.from(f)),console.log(" Users available:",e.value.length),Array.from(f).map(h=>{let p=e.value.find(v=>v.id===h);return!p&&/^\d+$/.test(h)&&(p=e.value.find(v=>v.aeriesId===h)),{id:h,name:p?p.name||`${p.firstName} ${p.lastName}`:`Teacher ${h}`,actualUserId:p?p.id:null}}).sort((h,p)=>h.name.localeCompare(p.name))}),a=(f,h=[])=>{let p=-1;if(/^\d+$/.test(f))p=parseInt(f)-1;else if(f==="SH")p=6;else if(f.startsWith("Per")){const v=f.replace("Per","");/^\d+$/.test(v)&&(p=parseInt(v)-1)}return h.includes(p.toString())};return{availablePeriods:s,availableTeachers:i,getStudentsForTeachers:(f,h=[])=>t.value.filter(p=>{var g,y,b,E,x,I,D;if(!(((y=(g=p.app)==null?void 0:g.flags)==null?void 0:y.flag1)||p.flag1||!1))return!1;if((b=p.aeries)!=null&&b.schedule){const P=Object.entries(p.aeries.schedule);for(let w=0;w<P.length;w++){const[S,m]=P[w];if(m&&m.teacherId&&f.includes(String(m.teacherId))&&!a(S,h))return!0}}if((x=(E=p.app)==null?void 0:E.schedule)!=null&&x.periods){const P=Object.entries(p.app.schedule.periods);for(let w=0;w<P.length;w++){const[S,m]=P[w];if(m&&f.includes(String(m))&&!a(S,h))return!0}}for(let P=0;P<7;P++){const w=`period${P+1}TeacherId`,S=p[w]||((I=p.aeries)==null?void 0:I[w])||((D=p.app)==null?void 0:D[w]);if(S&&f.includes(String(S))&&!h.includes(P.toString()))return!0}return!1}),getStudentTeacherPeriods:(f,h,p=[])=>{var g,y,b,E,x;const v=[];if((g=f.aeries)!=null&&g.schedule){const I=Object.entries(f.aeries.schedule);for(let D=0;D<I.length;D++){const[P,w]=I[D];if(w&&w.teacherId&&h.includes(String(w.teacherId))&&!a(P,p)){let S=e.value.find(T=>T.id===String(w.teacherId));!S&&/^\d+$/.test(w.teacherId)&&(S=e.value.find(T=>T.aeriesId===String(w.teacherId)));const m=n(D+1);v.push({period:m,teacherName:S?S.name||`${S.firstName} ${S.lastName}`:`Teacher ${w.teacherId}`})}}}if((b=(y=f.app)==null?void 0:y.schedule)!=null&&b.periods){const I=Object.entries(f.app.schedule.periods);for(let D=0;D<I.length;D++){const[P,w]=I[D];if(w&&h.includes(String(w))&&!a(P,p)){const S=e.value.find(T=>T.id===String(w)),m=n(parseInt(P));v.push({period:m,teacherName:S?S.name||`${S.firstName} ${S.lastName}`:`Teacher ${w}`})}}}for(let I=0;I<7;I++){const D=`period${I+1}TeacherId`,P=f[D]||((E=f.aeries)==null?void 0:E[D])||((x=f.app)==null?void 0:x[D]);if(P&&h.includes(String(P))&&!p.includes(I.toString())){let w=e.value.find(m=>m.id===String(P));!w&&/^\d+$/.test(P)&&(w=e.value.find(m=>m.aeriesId===String(P)));const S=n(I+1);v.push({period:S,teacherName:w?w.name||`${w.firstName} ${w.lastName}`:`Teacher ${P}`})}}return v},generateCSV:()=>{const f=["Student ID","First Name","Last Name","Grade","Case Manager","Assessment Accommodations","Services"],h=t.value.map(v=>{var D,P,w,S,m;const g=it(v,"firstName")||"",y=it(v,"lastName")||"",b=it(v,"grade")||"",E=v.caseManagerId||((P=(D=v.app)==null?void 0:D.studentData)==null?void 0:P.caseManagerId)||"",x=((S=(w=v.app)==null?void 0:w.accommodations)==null?void 0:S.assessment)||[],I=((m=v.app)==null?void 0:m.classServices)||[];return[v.id||"",g,y,b,E,Array.isArray(x)?x.join("; "):x,Array.isArray(I)?I.map(T=>T.name||T).join("; "):I]});return[f,...h].map(v=>v.map(g=>`"${String(g).replace(/"/g,'""')}"`).join(",")).join(`
`)},downloadCSV:(f,h)=>{const p=new Blob([f],{type:"text/csv;charset=utf-8;"}),v=document.createElement("a");v.href=URL.createObjectURL(p),v.download=h,v.click(),URL.revokeObjectURL(v.href)},isPeriodExcluded:a}}const Ng="casemanage_linked_sheet_id",u0="Student Data";function Px(){const t=se(!1),e=se(localStorage.getItem(Ng)||""),r=se(""),n=se(null),s=se("idle"),i=se(""),a=se(null),o=se("");let l=null;const c=()=>new Promise((w,S)=>{var T,_,A;if((_=(T=window.google)==null?void 0:T.accounts)!=null&&_.oauth2&&((A=window.gapi)!=null&&A.client)){w();return}const m=document.createElement("script");m.src="https://accounts.google.com/gsi/client",m.onload=()=>{a.value=window.google.accounts.oauth2.initTokenClient({client_id:"756483333257-kh1cv865e0buv0cv9g0v1h7ghq7s0e70.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/spreadsheets",callback:U=>{U.access_token?(o.value=U.access_token,t.value=!0,window.gapi.client.setToken({access_token:U.access_token}),l&&(l(U),l=null)):(console.error("Failed to get access token"),l&&(l(null),l=null))}});const k=document.createElement("script");k.src="https://apis.google.com/js/api.js",k.onload=()=>{window.gapi.load("client",async()=>{await window.gapi.client.init({apiKey:"AIzaSyDx1jbQT-FzgzjASFqVA2kbAHWJ_TeUzdY",discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"]}),w()})},document.head.appendChild(k)},m.onerror=()=>S(new Error("Failed to load Google Identity Services")),document.head.appendChild(m)}),u=async()=>{if(!a.value)throw new Error("Google auth not initialized");if(o.value)try{return await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:"1BxiMVs0XRA5nFMRigcZ_6g3D6P6dNTMhvBSm1x7kFNg"}),{access_token:o.value}}catch{console.log("Token expired, requesting new one"),o.value=""}return new Promise((w,S)=>{l=w;const m=setTimeout(()=>{l=null,S(new Error("Token request timed out"))},3e4),T=a.value.callback;a.value.callback=_=>{clearTimeout(m),a.value.callback=T,_.access_token?(o.value=_.access_token,t.value=!0,window.gapi.client.setToken({access_token:_.access_token}),l&&(l(_),l=null)):(console.error("Failed to get access token:",_),l&&(l(null),l=null))};try{a.value.requestAccessToken()}catch(_){clearTimeout(m),a.value.callback=T,S(_)}})},f=async(w,S=[])=>{var m;try{s.value="syncing",i.value="Creating new Google Sheet...",o.value||await u();const _=((m=Qo().currentUser)==null?void 0:m.email)||"",A=await window.gapi.client.sheets.spreadsheets.create({properties:{title:`CaseManage Student Data - ${new Date().toLocaleDateString()}`,locale:"en_US",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},sheets:[{properties:{title:u0,gridProperties:{rowCount:1e3,columnCount:9,frozenRowCount:1}}}]}),k=A.result.spreadsheetId;e.value=k,r.value=`https://docs.google.com/spreadsheets/d/${k}`,localStorage.setItem(Ng,k),await h(w,S);const U=A.result.sheets[0].properties.sheetId;return await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:k,resource:{requests:[{repeatCell:{range:{sheetId:U,startRowIndex:0,endRowIndex:1},cell:{userEnteredFormat:{backgroundColor:{red:.2,green:.6,blue:.9},textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat)"}},{autoResizeDimensions:{dimensions:{sheetId:U,dimension:"COLUMNS",startIndex:0,endIndex:9}}},{addProtectedRange:{protectedRange:{range:{sheetId:U},description:`Read-only protection for ${u0}`,warningOnly:!1,editors:{users:[],domainUsersCanEdit:!1}}}}]}}),s.value="success",i.value="Sheet created and linked successfully!",n.value=new Date,window.open(r.value,"_blank"),{spreadsheetId:k,url:r.value}}catch(T){throw console.error("Error creating sheet:",T),s.value="error",i.value=`Failed to create sheet: ${T.message}`,T}},h=async(w,S=[])=>{if(!e.value)throw new Error("No linked sheet. Create a sheet first.");try{s.value="syncing",i.value="Updating Google Sheet...",o.value||await u();const m=w.filter(U=>{var R,F;return((F=(R=U.app)==null?void 0:R.flags)==null?void 0:F.flag1)||U.flag1||!1});console.log(" Google Sheets - Original students:",w.length),console.log(" Google Sheets - Filtered students (separate setting only):",m.length),console.log(" Google Sheets - Students data:",m),m&&m.length>0&&console.log(" Google Sheets - First student:",m[0]);const T=["Student ID","First Name","Last Name","Grade","Case Manager","Separate Setting","Assessment Accommodations","Services","Last Updated"],_=m.map(U=>{var L,R,F,N,M,z,G,H,j,K,ne,he;return console.log(" Processing student:",U.id,{firstName:U.firstName||((R=(L=U.app)==null?void 0:L.studentData)==null?void 0:R.firstName),lastName:U.lastName||((N=(F=U.app)==null?void 0:F.studentData)==null?void 0:N.lastName),grade:U.grade||((z=(M=U.app)==null?void 0:M.studentData)==null?void 0:z.grade)}),[U.id||"",U.firstName||((H=(G=U.app)==null?void 0:G.studentData)==null?void 0:H.firstName)||"",U.lastName||((K=(j=U.app)==null?void 0:j.studentData)==null?void 0:K.lastName)||"",U.grade||((he=(ne=U.app)==null?void 0:ne.studentData)==null?void 0:he.grade)||"",v(U,S)||"",b(U)||"",g(U,"assessment")||"",y(U)||"",new Date().toLocaleString()]}),A=[T,..._];console.log(" Google Sheets - Data to write:",A),await window.gapi.client.sheets.spreadsheets.values.clear({spreadsheetId:e.value,range:`${u0}!A:Z`});const k=await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:e.value,range:`${u0}!A1`,valueInputOption:"RAW",resource:{values:A}});console.log(" Google Sheets - Update response:",k),s.value="success",i.value=`Updated ${_.length} students (separate setting only)`,n.value=new Date}catch(m){throw console.error("Error updating sheet:",m),s.value="error",i.value=`Failed to update: ${m.message}`,m.status===401&&(o.value="",await u()),m}},p=()=>{e.value="",r.value="",localStorage.removeItem(Ng),s.value="idle",i.value="",n.value=null},v=(w,S=[])=>{var _,A;const m=w.caseManagerId||((A=(_=w.app)==null?void 0:_.studentData)==null?void 0:A.caseManagerId)||w.casemanager_id;if(!m)return"Not Assigned";const T=S.find(k=>k.id===m);return T&&(T.name||`${T.firstName} ${T.lastName}`||T.email)||m},g=(w,S)=>{var T,_,A;const m=((_=(T=w.app)==null?void 0:T.accommodations)==null?void 0:_[S])||((A=w.accommodations)==null?void 0:A[S])||[];return Array.isArray(m)?m.join(", "):m},y=w=>{var m;const S=((m=w.app)==null?void 0:m.classServices)||w.classServices||[];return Array.isArray(S)?S.map(T=>T.name||T).join(", "):S},b=w=>{var m,T;return((T=(m=w.app)==null?void 0:m.flags)==null?void 0:T.flag1)||w.flag1||!1?"True":"False"},E=async()=>{if(!e.value)return!1;try{return await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:e.value}),!0}catch(w){return w.status===404&&p(),!1}},x=async(w,S,m,T=[],_=[])=>{var A;if(!e.value)throw new Error("No linked sheet. Create a sheet first.");try{o.value||await u();const U=((A=Qo().currentUser)==null?void 0:A.email)||"";console.log(" Creating custom tab:",w,"for teachers:",m,"excluding periods:",_);const R=(await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.value,resource:{requests:[{addSheet:{properties:{title:w,gridProperties:{rowCount:1e3,columnCount:12,frozenRowCount:1}}}}]}})).result.replies[0].addSheet.properties.sheetId;console.log(" Created sheet with ID:",R);const F=S.filter(G=>{var j,K;return((K=(j=G.app)==null?void 0:j.flags)==null?void 0:K.flag1)||G.flag1||!1});console.log(" Custom tab - Original students:",S.length),console.log(" Custom tab - Filtered students (separate setting only):",F.length);const N=["Student ID","First Name","Last Name","Grade","Case Manager","Period","Teacher","Subject","Separate Setting","Assessment Accommodations","Services","Last Updated"],M=[];F.forEach(G=>{const H=I(G,m,T,_);console.log(" Student:",G.id,"Periods found:",H.length,"Excluded periods:",_),H.forEach(j=>{console.log(" Adding row for period:",j.period,"teacher:",j.teacherName,"source:",j.source||"unknown")}),H.forEach(j=>{var K,ne,he,le,fe,te;M.push([G.id||"",G.firstName||((ne=(K=G.app)==null?void 0:K.studentData)==null?void 0:ne.firstName)||"",G.lastName||((le=(he=G.app)==null?void 0:he.studentData)==null?void 0:le.lastName)||"",G.grade||((te=(fe=G.app)==null?void 0:fe.studentData)==null?void 0:te.grade)||"",v(G,T)||"",j.period||"",j.teacherName||"",j.subject||"",b(G)||"",g(G,"assessment")||"",y(G)||"",new Date().toLocaleString()])})});const z=[N,...M];return await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:e.value,range:`${w}!A1`,valueInputOption:"RAW",resource:{values:z}}),await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.value,resource:{requests:[{repeatCell:{range:{sheetId:R,startRowIndex:0,endRowIndex:1},cell:{userEnteredFormat:{backgroundColor:{red:.2,green:.6,blue:.9},textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat)"}},{autoResizeDimensions:{dimensions:{sheetId:R,dimension:"COLUMNS",startIndex:0,endIndex:12}}},{addProtectedRange:{protectedRange:{range:{sheetId:R},description:`Read-only protection for ${w}`,warningOnly:!1,editors:{users:[],domainUsersCanEdit:!1}}}}]}}),console.log(" Custom tab created successfully with",M.length,"rows and read-only protection"),{sheetId:R,rowCount:M.length}}catch(k){throw console.error("Error creating custom tab:",k),k}},I=(w,S,m=[],T=[])=>{var k,U,L,R,F;const _=[];console.log(" getStudentPeriodsForTeachers for student:",w.id,"teacherIds:",S,"excludedPeriods:",T,"excludedPeriods array:",JSON.stringify(T));const A=N=>{let M=-1;if(/^\d+$/.test(N))M=parseInt(N)-1;else if(N==="SH")M=6;else if(N.startsWith("Per")){const z=N.replace("Per","");/^\d+$/.test(z)&&(M=parseInt(z)-1)}return console.log(" Period",N,"maps to index",M,"excluded?",T.includes(M.toString())),T.includes(M.toString())};if((k=w.aeries)!=null&&k.schedule){const N=Object.entries(w.aeries.schedule);console.log(" Aeries schedule entries:",N.length);for(let M=0;M<N.length;M++){const[z,G]=N[M],H=A(z);console.log(" Checking aeries period key:",z,"teacherId:",G==null?void 0:G.teacherId,"excluded?",H),G&&G.teacherId&&S.includes(String(G.teacherId))&&(H?console.log(" Excluding aeries period",z):(console.log(" Including aeries period",z),_.push({period:z.replace("period",""),teacherId:G.teacherId,teacherName:D(G.teacherId,m),subject:G.subject||"",source:"aeries"})))}}if((L=(U=w.app)==null?void 0:U.schedule)!=null&&L.periods){const N=Object.entries(w.app.schedule.periods);console.log(" App schedule entries:",N.length);for(let M=0;M<N.length;M++){const[z,G]=N[M],H=A(z);console.log(" Checking app period key:",z,"teacherId:",G,"excluded?",H),G&&S.includes(String(G))&&(H?console.log(" Excluding app period",z):(console.log(" Including app period",z),_.push({period:z,teacherId:G,teacherName:D(G,m),subject:"",source:"app"})))}}for(let N=0;N<7;N++){const M=`period${N+1}TeacherId`,z=w[M]||((R=w.aeries)==null?void 0:R[M])||((F=w.app)==null?void 0:F[M]);if(z&&S.includes(String(z))){const G=T.includes(N.toString());console.log(" Checking CSV period index",N,"field:",M,"teacherId:",z,"excluded?",G),G?console.log(" Excluding CSV period",N):(console.log(" Including CSV period",N),_.push({period:(N+1).toString(),teacherId:z,teacherName:D(z,m),subject:"",source:"csv"}))}}return console.log(" Final periods for student",w.id,":",_.length,_),_},D=(w,S=[])=>{let m=S.find(T=>T.id===w);return!m&&/^\d+$/.test(w)&&(m=S.find(T=>T.aeriesId===w)),m?m.name||`${m.firstName} ${m.lastName}`||`Teacher ${w}`:`Teacher ${w}`};return{isInitialized:t,linkedSheetId:e,linkedSheetUrl:r,lastSyncTime:n,syncStatus:s,syncMessage:i,initializeGoogleAuth:c,requestAccessToken:u,createLinkedSheet:f,updateSheetData:h,createCustomTab:x,deleteCustomTab:async w=>{if(!e.value)throw new Error("No linked sheet.");try{o.value||await u(),await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:e.value,resource:{requests:[{deleteSheet:{sheetId:w}}]}}),console.log(" Deleted custom tab with sheet ID:",w)}catch(S){throw console.error("Error deleting custom tab:",S),S}},unlinkSheet:p,checkSheetConnection:E}}const jue=Object.freeze(Object.defineProperty({__proto__:null,useGoogleSheetsRealtime:Px},Symbol.toStringTag,{value:"Module"}));function Gue(t,e,r){const{generateCSV:n,downloadCSV:s}=r,{linkedSheetId:i,linkedSheetUrl:a,lastSyncTime:o,syncStatus:l,syncMessage:c,initializeGoogleAuth:u,createLinkedSheet:f,updateSheetData:h,createCustomTab:p,deleteCustomTab:v,unlinkSheet:g,checkSheetConnection:y}=Px();let b=null,E=!1;const x=async()=>{try{const k=localStorage.getItem("casemanage_linked_sheet_id");k&&k.startsWith("1XSL0Sl7")&&(console.log("Clearing old sheet ID that was causing 403 errors"),localStorage.removeItem("casemanage_linked_sheet_id")),await u(),i.value&&await y()&&(await w(),I())}catch(k){console.error("Failed to initialize Google Auth:",k)}};Vt(()=>t.value,(k,U)=>{k&&U&&k!==U&&(E=!0,console.log(" Student data changed, will sync on next interval")),k!=null&&k.length},{deep:!0});const I=()=>{b&&clearInterval(b),b=setInterval(async()=>{if(i.value&&E&&l.value!=="syncing")try{console.log(" Hourly auto-sync starting..."),await w(),E=!1,console.log(" Hourly auto-sync completed")}catch(k){console.error(" Hourly auto-sync failed:",k)}},36e5)},D=()=>{b&&clearInterval(b)},P=async()=>{try{await f(t.value,e.value),I()}catch(k){console.error("Failed to create linked sheet:",k),alert("Failed to create Google Sheet. Please make sure you are signed in to Google.")}},w=async()=>{if(!(!i.value||l.value==="syncing"))try{await h(t.value,e.value)}catch(k){console.error("Failed to sync sheet:",k),alert("Failed to sync sheet. Please try again.")}};return{linkedSheetId:i,linkedSheetUrl:a,lastSyncTime:o,syncStatus:l,syncMessage:c,initializeIntegration:x,createLinkedGoogleSheet:P,syncNow:w,openGoogleSheet:()=>{a.value&&(window.open(a.value,"_blank","noopener,noreferrer")||(window.location.href=a.value))},unlinkSheet:g,createCustomTab:p,deleteCustomTab:v,createGoogleSheetWithData:()=>{const k=n();s(k,"student_data.csv"),window.open("https://sheets.new","_blank")},createBlankGoogleSheet:()=>{window.open("https://sheets.new","_blank")},exportToCSV:()=>{const k=n();s(k,"student_data_export.csv")},formatTime:k=>new Date(k).toLocaleString(),setupAutoSync:I,cleanupAutoSync:D}}function Wue(t,e){const{getStudentsForTeachers:r}=t,{createCustomTab:n,deleteCustomTab:s}=e,i=se([]),a=se(!1),o=se(""),l=se([]),c=se([]),u=5,f=be(()=>l.value.length===0?[]:r(l.value,c.value)),h=async y=>{if(!o.value.trim()||l.value.length===0){alert("Please enter a tab name and select at least one teacher");return}if(i.value.length>=u){alert(`Maximum of ${u} custom tabs allowed`);return}try{const b=r(l.value,c.value),E=await n(o.value.trim(),b,l.value,y,c.value),x={id:Date.now().toString(),name:o.value.trim(),teachers:[...l.value],studentCount:E.rowCount,sheetId:E.sheetId};i.value.push(x),v(),console.log("Custom tab added:",x),alert(`Custom tab "${x.name}" created successfully with ${E.rowCount} student entries!`)}catch(b){console.error("Failed to create custom tab:",b),alert("Failed to create custom tab in Google Sheet. Please try again.")}},p=async y=>{const b=i.value.find(E=>E.id===y);if(b&&confirm(`Are you sure you want to remove the "${b.name}" tab?`))try{b.sheetId&&await s(b.sheetId),i.value=i.value.filter(E=>E.id!==y),console.log("Custom tab removed:",y),alert(`Tab "${b.name}" removed successfully.`)}catch(E){console.error("Failed to delete custom tab:",E),alert("Failed to delete tab from Google Sheet. You may need to delete it manually."),i.value=i.value.filter(x=>x.id!==y)}},v=()=>{o.value="",l.value=[],c.value=[],a.value=!1};return{customTabs:i,showAddTabForm:a,newTabName:o,selectedTeachers:l,selectedExcludedPeriods:c,maxCustomTabs:u,filteredStudentsPreview:f,addCustomTab:h,removeCustomTab:p,resetForm:v,toggleAddTabForm:()=>{a.value=!a.value,a.value||v()}}}const zue={class:"sheets-section"},Kue={key:0,class:"linked-sheet-status"},que={class:"status-card success"},Xue={class:"sync-info"},Yue={key:0},Que={key:1,class:"syncing"},Jue={key:2,class:"success"},Zue={key:3,class:"error"},ede={class:"sheet-actions"},tde=["disabled"],rde={key:1,class:"create-sheet-section"},nde={class:"alternative-options"},sde={class:"button-group"},ade={__name:"GoogleSheetsConnector",props:{linkedSheetId:String,lastSyncTime:[String,Date],syncStatus:String,syncMessage:String},emits:["openGoogleSheet","syncNow","unlinkSheet","createLinkedGoogleSheet","createGoogleSheetWithData","createBlankGoogleSheet","exportToCSV"],setup(t){const e=r=>new Date(r).toLocaleString();return(r,n)=>(O(),B("div",zue,[n[12]||(n[12]=d("h4",null,"Google Sheets Integration",-1)),t.linkedSheetId?(O(),B("div",Kue,[d("div",que,[n[7]||(n[7]=d("h5",null," Linked Google Sheet",-1)),n[8]||(n[8]=d("p",null,"Your student data is synced to Google Sheets",-1)),d("button",{onClick:n[0]||(n[0]=s=>r.$emit("openGoogleSheet")),class:"sheet-link"}," Open Google Sheet  "),d("div",Xue,[t.lastSyncTime?(O(),B("span",Yue,"Last synced: "+Y(e(t.lastSyncTime)),1)):_e("",!0),t.syncStatus==="syncing"?(O(),B("span",Que," Syncing...")):t.syncStatus==="success"?(O(),B("span",Jue," Synced")):t.syncStatus==="error"?(O(),B("span",Zue," "+Y(t.syncMessage),1)):_e("",!0)]),n[9]||(n[9]=d("div",{class:"auto-sync-info"},[d("span",{class:"auto-sync-badge"},[d("span",{class:"pulse"}),Ce(" Auto-sync enabled ")]),d("p",{class:"auto-sync-description"}," Changes to student data, accommodations, and services are automatically synced to your Google Sheet. ")],-1)),d("div",ede,[d("button",{onClick:n[1]||(n[1]=s=>r.$emit("syncNow")),disabled:t.syncStatus==="syncing",class:"btn-sync"}," Sync Now ",8,tde),d("button",{onClick:n[2]||(n[2]=s=>r.$emit("unlinkSheet")),class:"btn-unlink"}," Unlink Sheet ")])])])):(O(),B("div",rde,[n[10]||(n[10]=In('<h5 data-v-ec72cef0>Create a Linked Google Sheet</h5><p data-v-ec72cef0>Link your student data to a Google Sheet that automatically updates when changes are made.</p><div class="features-list" data-v-ec72cef0><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0></span><span data-v-ec72cef0>Auto-syncs when students are added or updated</span></div><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0></span><span data-v-ec72cef0>Updates accommodations and services in real-time</span></div><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0></span><span data-v-ec72cef0>Maintains a live connection to your data</span></div></div>',3)),d("button",{onClick:n[3]||(n[3]=s=>r.$emit("createLinkedGoogleSheet")),class:"btn-primary"},"  Create & Link Google Sheet ")])),d("div",nde,[n[11]||(n[11]=d("h5",null,"Other Export Options",-1)),d("div",sde,[d("button",{onClick:n[4]||(n[4]=s=>r.$emit("createGoogleSheetWithData")),class:"btn-secondary"},"  Create Google Sheet with Data (One-time) "),d("button",{onClick:n[5]||(n[5]=s=>r.$emit("createBlankGoogleSheet")),class:"btn-secondary"},"  Create Blank Google Sheet "),d("button",{onClick:n[6]||(n[6]=s=>r.$emit("exportToCSV")),class:"btn-secondary"},"  Export to CSV Only ")])])]))}},ide=xt(ade,[["__scopeId","data-v-ec72cef0"]]),ode={class:"preview-section"},lde={class:"preview-table"},cde={key:0},ude={key:0},dde={key:0,class:"preview-note"},Og=5,fde={__name:"StudentPreview",props:{filteredStudents:{type:Array,required:!0},selectedTeachers:{type:Array,required:!0},selectedExcludedPeriods:{type:Array,required:!0},getStudentTeacherPeriods:{type:Function,required:!0}},setup(t){const e=t,r=be(()=>e.filteredStudents.slice(0,Og)),n=a=>{const o=it(a,"firstName")||"",l=it(a,"lastName")||"";return`${o} ${l}`.trim()},s=a=>it(a,"grade")||"",i=a=>e.getStudentTeacherPeriods(a,e.selectedTeachers,e.selectedExcludedPeriods);return(a,o)=>(O(),B("div",ode,[d("h6",null,"Preview ("+Y(t.filteredStudents.length)+" students)",1),d("div",lde,[d("table",null,[o[0]||(o[0]=d("thead",null,[d("tr",null,[d("th",null,"Name"),d("th",null,"Grade"),d("th",null,"Period"),d("th",null,"Teacher")])],-1)),d("tbody",null,[(O(!0),B(Fe,null,He(r.value,l=>(O(),B("tr",{key:l.id},[d("td",null,Y(n(l)),1),d("td",null,Y(s(l)),1),d("td",null,[(O(!0),B(Fe,null,He(i(l),(c,u)=>(O(),B("span",{key:u},[Ce(Y(c.period),1),u<i(l).length-1?(O(),B("span",cde,", ")):_e("",!0)]))),128))]),d("td",null,[(O(!0),B(Fe,null,He(i(l),(c,u)=>(O(),B("span",{key:u},[Ce(Y(c.teacherName),1),u<i(l).length-1?(O(),B("span",ude,", ")):_e("",!0)]))),128))])]))),128))])]),t.filteredStudents.length>Og?(O(),B("p",dde," ... and "+Y(t.filteredStudents.length-Og)+" more students ",1)):_e("",!0)])]))}},hde=xt(fde,[["__scopeId","data-v-936b1ce9"]]),pde={class:"custom-tabs-config"},mde={class:"add-tab-controls"},gde=["disabled"],vde={key:0,class:"max-tabs-warning"},yde={key:0,class:"add-tab-form"},xde={class:"form-group"},Ede=["value"],_de={class:"form-group"},bde={class:"teacher-checkboxes"},Sde=["value","checked","onChange"],Ade={class:"form-group"},Tde={class:"period-checkboxes"},wde=["value","checked","onChange"],Cde={class:"form-actions"},Ide={key:1,class:"existing-tabs"},kde={class:"tab-teachers"},Dde=["onClick"],Pde={__name:"CustomTabManager",props:{customTabs:{type:Array,required:!0},showAddTabForm:{type:Boolean,required:!0},newTabName:{type:String,required:!0},selectedTeachers:{type:Array,required:!0},selectedExcludedPeriods:{type:Array,required:!0},maxCustomTabs:{type:Number,required:!0},availableTeachers:{type:Array,required:!0},availablePeriods:{type:Array,required:!0},filteredStudentsPreview:{type:Array,required:!0},getStudentTeacherPeriods:{type:Function,required:!0}},emits:["toggleAddTabForm","update:newTabName","updateSelectedTeachers","updateSelectedExcludedPeriods","addCustomTab","removeCustomTab","resetForm"],setup(t){return(e,r)=>(O(),B("div",pde,[r[8]||(r[8]=d("h5",null,"Custom Teacher Tabs",-1)),r[9]||(r[9]=d("p",null,"Create custom tabs with data filtered by specific teachers",-1)),d("div",mde,[d("button",{onClick:r[0]||(r[0]=n=>e.$emit("toggleAddTabForm")),disabled:t.customTabs.length>=t.maxCustomTabs,class:"btn-primary"}," + Add Custom Tab ",8,gde),t.customTabs.length>=t.maxCustomTabs?(O(),B("span",vde," Maximum of "+Y(t.maxCustomTabs)+" custom tabs allowed ",1)):_e("",!0)]),t.showAddTabForm?(O(),B("div",yde,[d("div",xde,[r[4]||(r[4]=d("label",null,"Tab Name",-1)),d("input",{value:t.newTabName,onInput:r[1]||(r[1]=n=>e.$emit("update:newTabName",n.target.value)),type:"text",class:"form-input",placeholder:"e.g., Math Teachers",maxlength:"30"},null,40,Ede)]),d("div",_de,[r[5]||(r[5]=d("label",null,"Select Teachers",-1)),d("div",bde,[(O(!0),B(Fe,null,He(t.availableTeachers,n=>(O(),B("label",{key:n.id,class:"checkbox-label"},[d("input",{type:"checkbox",value:n.id,checked:t.selectedTeachers.includes(n.id),onChange:s=>e.$emit("updateSelectedTeachers",n.id,s.target.checked)},null,40,Sde),Ce(" "+Y(n.name),1)]))),128))])]),d("div",Ade,[r[6]||(r[6]=d("label",null,"Exclude Periods (Optional)",-1)),d("div",Tde,[(O(!0),B(Fe,null,He(t.availablePeriods,n=>(O(),B("label",{key:n.value,class:"checkbox-label"},[d("input",{type:"checkbox",value:n.value,checked:t.selectedExcludedPeriods.includes(n.value),onChange:s=>e.$emit("updateSelectedExcludedPeriods",n.value,s.target.checked)},null,40,wde),Ce(" "+Y(n.label),1)]))),128))])]),t.selectedTeachers.length>0?(O(),tr(hde,{key:0,"filtered-students":t.filteredStudentsPreview,"selected-teachers":t.selectedTeachers,"selected-excluded-periods":t.selectedExcludedPeriods,"get-student-teacher-periods":t.getStudentTeacherPeriods},null,8,["filtered-students","selected-teachers","selected-excluded-periods","get-student-teacher-periods"])):_e("",!0),d("div",Cde,[d("button",{onClick:r[2]||(r[2]=n=>e.$emit("addCustomTab")),class:"btn-primary"}," Create Tab "),d("button",{onClick:r[3]||(r[3]=n=>e.$emit("resetForm")),class:"btn-secondary"}," Cancel ")])])):_e("",!0),t.customTabs.length>0?(O(),B("div",Ide,[r[7]||(r[7]=d("h6",null,"Current Custom Tabs",-1)),(O(!0),B(Fe,null,He(t.customTabs,n=>(O(),B("div",{key:n.id,class:"tab-item"},[d("div",null,[d("strong",null,Y(n.name),1),d("span",kde,Y(n.teachers.length)+" teacher(s), "+Y(n.studentCount)+" students ",1)]),d("button",{onClick:s=>e.$emit("removeCustomTab",n.id),class:"btn-danger btn-small"}," Remove ",8,Dde)]))),128))])):_e("",!0)]))}},Rde=xt(Pde,[["__scopeId","data-v-236484db"]]),Fde={class:"export-options-section"},Nde={class:"export-grid"},Ode={class:"export-card"},Mde={class:"export-card"},Lde={class:"export-card"},Bde={__name:"TestingExportOptions",emits:["createGoogleSheetWithData","createBlankGoogleSheet","exportToCSV"],setup(t){return(e,r)=>(O(),B("div",Fde,[r[12]||(r[12]=d("h4",null,"Export Options",-1)),r[13]||(r[13]=d("p",null,"Additional ways to export and work with your student data",-1)),d("div",Nde,[d("div",Ode,[r[3]||(r[3]=d("div",{class:"export-icon"},"",-1)),r[4]||(r[4]=d("h5",null,"Google Sheets with Data",-1)),r[5]||(r[5]=d("p",null,"Create a new Google Sheet and populate it with current student data (one-time export)",-1)),d("button",{onClick:r[0]||(r[0]=n=>e.$emit("createGoogleSheetWithData")),class:"btn-primary"}," Create Sheet with Data ")]),d("div",Mde,[r[6]||(r[6]=d("div",{class:"export-icon"},"",-1)),r[7]||(r[7]=d("h5",null,"Blank Google Sheet",-1)),r[8]||(r[8]=d("p",null,"Create a new blank Google Sheet that you can customize yourself",-1)),d("button",{onClick:r[1]||(r[1]=n=>e.$emit("createBlankGoogleSheet")),class:"btn-primary"}," Create Blank Sheet ")]),d("div",Lde,[r[9]||(r[9]=d("div",{class:"export-icon"},"",-1)),r[10]||(r[10]=d("h5",null,"CSV Export",-1)),r[11]||(r[11]=d("p",null,"Download student data as a CSV file for use in Excel or other applications",-1)),d("button",{onClick:r[2]||(r[2]=n=>e.$emit("exportToCSV")),class:"btn-primary"}," Download CSV ")])]),r[14]||(r[14]=d("div",{class:"export-info"},[d("h5",null,"Export Information"),d("ul",null,[d("li",null,[d("strong",null,"Linked Sheets:"),Ce(" Automatically sync when data changes")]),d("li",null,[d("strong",null,"One-time Exports:"),Ce(" Snapshot of data at export time")]),d("li",null,[d("strong",null,"CSV Files:"),Ce(" Compatible with Excel, Numbers, and other spreadsheet apps")])])],-1))]))}},Ude=xt(Bde,[["__scopeId","data-v-3bc6896f"]]),$de={class:"testing-links-container"},Vde={__name:"TestingLinks",setup(t){const{students:e,fetchStudents:r}=Ii(),{userList:n,fetchUsers:s}=_a(),{appSettings:i,loadAppSettings:a}=qs(),o=Hue(e,n,i),{availablePeriods:l,availableTeachers:c,getStudentTeacherPeriods:u}=o,f=Gue(e,n,o),{linkedSheetId:h,lastSyncTime:p,syncStatus:v,syncMessage:g,initializeIntegration:y,createLinkedGoogleSheet:b,syncNow:E,openGoogleSheet:x,unlinkSheet:I,createGoogleSheetWithData:D,createBlankGoogleSheet:P,exportToCSV:w,cleanupAutoSync:S}=f,m=Wue(o,f),{customTabs:T,showAddTabForm:_,newTabName:A,selectedTeachers:k,selectedExcludedPeriods:U,maxCustomTabs:L,filteredStudentsPreview:R,addCustomTab:F,removeCustomTab:N,resetForm:M,toggleAddTabForm:z}=m,G=(K,ne)=>{if(ne)k.value.includes(K)||k.value.push(K);else{const he=k.value.indexOf(K);he>-1&&k.value.splice(he,1)}},H=(K,ne)=>{if(ne)U.value.includes(K)||U.value.push(K);else{const he=U.value.indexOf(K);he>-1&&U.value.splice(he,1)}},j=async()=>{await F(n.value)};return jt(async()=>{try{await Promise.all([r(),s(),a()]),console.log("Students loaded:",e.value.length),console.log("Users loaded:",n.value.length),console.log("App settings loaded:",i.value),await y()}catch(K){console.error("Failed to initialize TestingLinks:",K)}}),Va(()=>{S()}),(K,ne)=>(O(),B("div",$de,[ne[1]||(ne[1]=d("h3",null,"Testing Links & Google Sheets Integration",-1)),Le(ide,{"linked-sheet-id":X(h),"last-sync-time":X(p),"sync-status":X(v),"sync-message":X(g),onOpenGoogleSheet:X(x),onSyncNow:X(E),onUnlinkSheet:X(I),onCreateLinkedGoogleSheet:X(b),onCreateGoogleSheetWithData:X(D),onCreateBlankGoogleSheet:X(P),onExportToCsv:X(w)},null,8,["linked-sheet-id","last-sync-time","sync-status","sync-message","onOpenGoogleSheet","onSyncNow","onUnlinkSheet","onCreateLinkedGoogleSheet","onCreateGoogleSheetWithData","onCreateBlankGoogleSheet","onExportToCsv"]),X(h)?(O(),tr(Rde,{key:0,"custom-tabs":X(T),"show-add-tab-form":X(_),"new-tab-name":X(A),"selected-teachers":X(k),"selected-excluded-periods":X(U),"max-custom-tabs":X(L),"available-teachers":X(c),"available-periods":X(l),"filtered-students-preview":X(R),"get-student-teacher-periods":X(u),onToggleAddTabForm:X(z),"onUpdate:newTabName":ne[0]||(ne[0]=he=>A.value=he),onUpdateSelectedTeachers:G,onUpdateSelectedExcludedPeriods:H,onAddCustomTab:j,onRemoveCustomTab:X(N),onResetForm:X(M)},null,8,["custom-tabs","show-add-tab-form","new-tab-name","selected-teachers","selected-excluded-periods","max-custom-tabs","available-teachers","available-periods","filtered-students-preview","get-student-teacher-periods","onToggleAddTabForm","onRemoveCustomTab","onResetForm"])):_e("",!0),Le(Ude,{onCreateGoogleSheetWithData:X(D),onCreateBlankGoogleSheet:X(P),onExportToCsv:X(w)},null,8,["onCreateGoogleSheetWithData","onCreateBlankGoogleSheet","onExportToCsv"])]))}},Hde=xt(Vde,[["__scopeId","data-v-8d441fb1"]]),jde={class:"admin-dashboard"},Gde={class:"stats-grid"},Wde={class:"stat-card primary"},zde={class:"stat-icon"},Kde={class:"stat-content"},qde={class:"stat-card iep"},Xde={class:"stat-icon"},Yde={class:"stat-content"},Qde={class:"stat-card plan-504"},Jde={class:"stat-icon"},Zde={class:"stat-content"},efe={class:"stat-card users"},tfe={class:"stat-icon"},rfe={class:"stat-content"},nfe={class:"role-breakdown"},sfe={class:"role-stats-grid"},afe={class:"role-icon"},ife={class:"role-info"},ofe={class:"role-count"},lfe={class:"role-name"},cfe={class:"categories-grid"},ufe={class:"category-card"},dfe={class:"category-header"},ffe={class:"category-content"},hfe={class:"feature-list"},pfe={class:"feature-item"},mfe={class:"feature-icon"},gfe={class:"feature-item"},vfe={class:"feature-icon"},yfe={class:"feature-item"},xfe={class:"feature-icon"},Efe={class:"category-card"},_fe={class:"category-header"},bfe={class:"category-content"},Sfe={class:"feature-list"},Afe={class:"feature-item"},Tfe={class:"feature-icon"},wfe={class:"feature-item"},Cfe={class:"feature-icon"},Ife={class:"feature-item"},kfe={class:"feature-icon"},Dfe={class:"category-card"},Pfe={class:"category-header"},Rfe={class:"category-content"},Ffe={class:"feature-list"},Nfe={class:"feature-item"},Ofe={class:"feature-icon"},Mfe={class:"feature-item"},Lfe={class:"feature-icon"},Bfe={class:"feature-item"},Ufe={class:"feature-icon"},$fe={class:"feature-item"},Vfe={class:"feature-icon"},Hfe={class:"feature-item"},jfe={class:"feature-icon"},Gfe={class:"category-card"},Wfe={class:"category-header"},zfe={class:"category-content"},Kfe={class:"feature-list"},qfe={class:"feature-item"},Xfe={class:"feature-icon"},Yfe={class:"feature-item"},Qfe={class:"feature-icon"},Jfe={class:"feature-item"},Zfe={class:"feature-icon"},e0e={class:"system-status"},t0e={class:"status-grid"},r0e={class:"status-card"},n0e={class:"sync-status"},s0e={class:"sync-item"},a0e={key:0,class:"sync-time"},i0e={class:"sync-item"},o0e={class:"sync-time"},l0e={class:"status-card"},c0e={class:"user-activity"},u0e={class:"activity-item"},d0e={class:"activity-count"},f0e={class:"activity-item"},h0e={class:"activity-count"},p0e={class:"status-card"},m0e={class:"health-indicators"},g0e={class:"health-item"},v0e={class:"health-status healthy"},y0e={class:"health-item"},x0e={class:"health-status healthy"},E0e={class:"quick-actions"},_0e={class:"actions-grid"},b0e={__name:"AdminDashboard",emits:["goToCategory","goToStudents"],setup(t){const{students:e,fetchStudents:r}=Ii(),{userList:n,fetchUsers:s}=_a(),{linkedSheetId:i,lastSyncTime:a}=Px(),o=se(12),l=se(8),c=se(!0),u=se("Connected"),f=be(()=>{var E;return((E=e.value)==null?void 0:E.length)||0}),h=be(()=>{var E;return((E=n.value)==null?void 0:E.length)||0}),p=be(()=>{var E;return((E=e.value)==null?void 0:E.filter(x=>{var D,P;return(((P=(D=x.app)==null?void 0:D.studentData)==null?void 0:P.plan)||x.plan||"").toLowerCase()==="iep"}).length)||0}),v=be(()=>{var E;return((E=e.value)==null?void 0:E.filter(x=>{var D,P;return(((P=(D=x.app)==null?void 0:D.studentData)==null?void 0:P.plan)||x.plan||"")==="504"}).length)||0}),g=be(()=>{var I;const E={};(I=n.value)==null||I.forEach(D=>{const P=D.role||"unknown";E[P]||(E[P]=0),E[P]++});const x={admin:{name:"Administrators",icon:Bv},school_admin:{name:"School Admins",icon:i7},teacher:{name:"Teachers",icon:$B},case_manager:{name:"Case Managers",icon:T0},paraeducator:{name:"Paraeducators",icon:wm},service_provider:{name:"Service Providers",icon:nI},sped_chair:{name:"SPED Chairs",icon:VB},admin_504:{name:"504 Admins",icon:Ov},staff_view:{name:"Staff (View)",icon:jl},staff_edit:{name:"Staff (Edit)",icon:Uv}};return Object.entries(E).map(([D,P])=>{var w,S;return{name:((w=x[D])==null?void 0:w.name)||D.replace("_"," ").toUpperCase(),count:P,icon:((S=x[D])==null?void 0:S.icon)||jl}}).sort((D,P)=>P.count-D.count).slice(0,8)});be(()=>i.value?1:0);const y=be(()=>!!i.value),b=E=>E?new Date(E).toLocaleString():"Never";return jt(async()=>{try{await Promise.all([r(),s()])}catch(E){console.error("Error loading dashboard data:",E)}}),(E,x)=>(O(),B("div",jde,[d("div",Gde,[d("div",Wde,[d("div",zde,[Le(X(jl),{size:32})]),d("div",Kde,[d("h3",null,Y(f.value),1),x[8]||(x[8]=d("p",null,"Total Students",-1))])]),d("div",qde,[d("div",Xde,[Le(X(Mv),{size:32})]),d("div",Yde,[d("h3",null,Y(p.value),1),x[9]||(x[9]=d("p",null,"IEP Students",-1))])]),d("div",Qde,[d("div",Jde,[Le(X(Ov),{size:32})]),d("div",Zde,[d("h3",null,Y(v.value),1),x[10]||(x[10]=d("p",null,"504 Plan Students",-1))])]),d("div",efe,[d("div",tfe,[Le(X(T0),{size:32})]),d("div",rfe,[d("h3",null,Y(h.value),1),x[11]||(x[11]=d("p",null,"System Users",-1))])])]),d("div",nfe,[d("h2",null,[Le(X(sI),{size:20}),x[12]||(x[12]=Ce(" Staff Role Distribution"))]),d("div",sfe,[(O(!0),B(Fe,null,He(g.value,I=>(O(),B("div",{class:"role-stat",key:I.name},[d("div",afe,[(O(),tr(A1(I.icon),{size:24}))]),d("div",ife,[d("span",ofe,Y(I.count),1),d("span",lfe,Y(I.name),1)])]))),128))])]),d("div",cfe,[d("div",ufe,[d("div",dfe,[d("h2",null,[Le(X(jl),{size:18}),x[13]||(x[13]=Ce(" User & Student Management"))]),d("button",{onClick:x[0]||(x[0]=I=>E.$emit("goToCategory","users-students")),class:"category-btn"},[Le(X(jf),{size:16}),x[14]||(x[14]=Ce(" Manage "))])]),d("div",ffe,[d("div",hfe,[d("div",pfe,[d("div",mfe,[Le(X(aI),{size:18})]),x[15]||(x[15]=d("div",null,[d("h4",null,"Add Users"),d("p",null,"Create new user accounts with role assignments")],-1))]),d("div",gfe,[d("div",vfe,[Le(X(Uv),{size:18})]),x[16]||(x[16]=d("div",null,[d("h4",null,"Manage Users"),d("p",null,"Edit existing users, roles, and permissions")],-1))]),d("div",yfe,[d("div",xfe,[Le(X(XB),{size:18})]),x[17]||(x[17]=d("div",null,[d("h4",null,"Student Administration"),d("p",null,"Comprehensive student data management")],-1))])])])]),d("div",Efe,[d("div",_fe,[d("h2",null,[Le(X(wm),{size:18}),x[18]||(x[18]=Ce(" Paraeducator Management"))]),d("button",{onClick:x[1]||(x[1]=I=>E.$emit("goToCategory","aide-management")),class:"category-btn"},[Le(X(jf),{size:16}),x[19]||(x[19]=Ce(" Manage "))])]),d("div",bfe,[d("div",Sfe,[d("div",Afe,[d("div",Tfe,[Le(X(GB),{size:18})]),x[20]||(x[20]=d("div",null,[d("h4",null,"Aide Assignment"),d("p",null,"Assign paraeducators to students and periods")],-1))]),d("div",wfe,[d("div",Cfe,[Le(X(HB),{size:18})]),x[21]||(x[21]=d("div",null,[d("h4",null,"Aide Schedule"),d("p",null,"Manage paraeducator schedules and assignments")],-1))]),d("div",Ife,[d("div",kfe,[Le(X(eI),{size:18})]),x[22]||(x[22]=d("div",null,[d("h4",null,"Time Table"),d("p",null,"Configure school periods and time slots")],-1))])])])]),d("div",Dfe,[d("div",Pfe,[d("h2",null,[Le(X(L2),{size:18}),x[23]||(x[23]=Ce(" Data & Integration"))]),d("button",{onClick:x[2]||(x[2]=I=>E.$emit("goToCategory","data-integration")),class:"category-btn"},[Le(X(jf),{size:16}),x[24]||(x[24]=Ce(" Manage "))])]),d("div",Rfe,[d("div",Ffe,[d("div",Nfe,[d("div",Ofe,[Le(X(zB),{size:18})]),x[25]||(x[25]=d("div",null,[d("h4",null,"SEIS Import"),d("p",null,"Import student data from SEIS system")],-1))]),d("div",Mfe,[d("div",Lfe,[Le(X(JB),{size:18})]),x[26]||(x[26]=d("div",null,[d("h4",null,"Aeries API & Import"),d("p",null,"Connect to Aeries SIS for data synchronization")],-1))]),d("div",Bfe,[d("div",Ufe,[Le(X(c7),{size:18})]),x[27]||(x[27]=d("div",null,[d("h4",null,"Testing Links"),d("p",null,"Google Sheets integration and export tools")],-1))]),d("div",$fe,[d("div",Vfe,[Le(X(tI),{size:18})]),x[28]||(x[28]=d("div",null,[d("h4",null,"Teacher Feedback"),d("p",null,"Manage teacher feedback forms and responses")],-1))]),d("div",Hfe,[d("div",jfe,[Le(X(YB),{size:18})]),x[29]||(x[29]=d("div",null,[d("h4",null,"Backup & Restore"),d("p",null,"System backup and data restoration tools")],-1))])])])]),d("div",Gfe,[d("div",Wfe,[d("h2",null,[Le(X(rI),{size:18}),x[30]||(x[30]=Ce(" System Configuration"))]),d("button",{onClick:x[3]||(x[3]=I=>E.$emit("goToCategory","system-config")),class:"category-btn"},[Le(X(jf),{size:16}),x[31]||(x[31]=Ce(" Manage "))])]),d("div",zfe,[d("div",Kfe,[d("div",qfe,[d("div",Xfe,[Le(X(Bv),{size:18})]),x[32]||(x[32]=d("div",null,[d("h4",null,"Permissions"),d("p",null,"Role-based access control and permissions matrix")],-1))]),d("div",Yfe,[d("div",Qfe,[Le(X(h7),{size:18})]),x[33]||(x[33]=d("div",null,[d("h4",null,"App Settings"),d("p",null,"Configure application settings and preferences")],-1))]),d("div",Jfe,[d("div",Zfe,[Le(X(n7),{size:18})]),x[34]||(x[34]=d("div",null,[d("h4",null,"Theme Customization"),d("p",null,"Customize student page appearance and colors")],-1))])])])])]),d("div",e0e,[d("h2",null,[Le(X(u7),{size:20}),x[35]||(x[35]=Ce(" System Status"))]),d("div",t0e,[d("div",r0e,[d("h3",null,[Le(X(a7),{size:18}),x[36]||(x[36]=Ce(" Data Sync Status"))]),d("div",n0e,[d("div",s0e,[d("span",{class:Qe(["sync-indicator",{active:y.value}])},null,2),x[37]||(x[37]=d("span",null,"Google Sheets",-1)),X(a)?(O(),B("span",a0e,Y(b(X(a))),1)):_e("",!0)]),d("div",i0e,[d("span",{class:Qe(["sync-indicator",{active:c.value}])},null,2),x[38]||(x[38]=d("span",null,"Aeries SIS",-1)),d("span",o0e,Y(u.value),1)])])]),d("div",l0e,[d("h3",null,[Le(X(BB),{size:18}),x[39]||(x[39]=Ce(" User Activity"))]),d("div",c0e,[d("div",u0e,[x[40]||(x[40]=d("span",null,"Active Users Today",-1)),d("span",d0e,Y(o.value),1)]),d("div",f0e,[x[41]||(x[41]=d("span",null,"Recent Logins",-1)),d("span",h0e,Y(l.value),1)])])]),d("div",p0e,[d("h3",null,[Le(X(r7),{size:18}),x[42]||(x[42]=Ce(" System Health"))]),d("div",m0e,[d("div",g0e,[x[44]||(x[44]=d("span",null,"Database",-1)),d("span",v0e,[Le(X(vh),{size:16}),x[43]||(x[43]=Ce(" Healthy "))])]),d("div",y0e,[x[46]||(x[46]=d("span",null,"Functions",-1)),d("span",x0e,[Le(X(vh),{size:16}),x[45]||(x[45]=Ce(" Operational "))])])])])])]),d("div",E0e,[d("h2",null,[Le(X(p7),{size:20}),x[47]||(x[47]=Ce(" Quick Actions"))]),d("div",_0e,[d("button",{onClick:x[4]||(x[4]=I=>E.$emit("goToStudents")),class:"admin-action-btn primary"},[Le(X(jl),{size:20}),x[48]||(x[48]=d("span",null,"View Students",-1))]),d("button",{onClick:x[5]||(x[5]=I=>E.$emit("goToCategory","users-students")),class:"admin-action-btn success"},[Le(X(T0),{size:20}),x[49]||(x[49]=d("span",null,"Manage Users",-1))]),d("button",{onClick:x[6]||(x[6]=I=>E.$emit("goToCategory","aide-management")),class:"admin-action-btn warning"},[Le(X(wm),{size:20}),x[50]||(x[50]=d("span",null,"Paraeducators",-1))]),d("button",{onClick:x[7]||(x[7]=I=>E.$emit("goToCategory","data-integration")),class:"admin-action-btn info"},[Le(X(L2),{size:20}),x[51]||(x[51]=d("span",null,"Data & Integration",-1))])])])]))}},S0e=xt(b0e,[["__scopeId","data-v-b32b4e32"]]);var A0e={};class T0e{constructor(){this.encryptionKey="default-dev-key-replace-in-production",this.encryptionEnabled=!0,console.log(" IEP Encryption:",this.encryptionEnabled?"Enabled":"Disabled")}setEncryptionEnabled(e){this.encryptionEnabled=e,console.log(" IEP Encryption:",this.encryptionEnabled?"Enabled":"Disabled"),e||console.warn(" Warning: Encryption disabled in production environment")}encryptSensitiveFields(e){if(!this.encryptionEnabled)return console.log(" Encryption disabled, returning raw data"),e;const r=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],n=JSON.parse(JSON.stringify(e));return r.forEach(s=>{const i=this.getNestedValue(n,s);if(i){const a=this.encryptField(i);this.setNestedValue(n,s,a)}}),n}decryptSensitiveFields(e){if(!this.encryptionEnabled)return console.log(" Encryption disabled, returning raw data"),e;const r=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],n=JSON.parse(JSON.stringify(e));return r.forEach(s=>{const i=this.getNestedValue(n,s);if(i){const a=this.decryptField(i);this.setNestedValue(n,s,a)}}),n}encryptField(e){if(!this.encryptionEnabled)return e;try{const r=typeof e=="object"?JSON.stringify(e):String(e);return qi.AES.encrypt(r,this.encryptionKey).toString()}catch(r){return console.error("Encryption failed:",r),e}}decryptField(e){if(!this.encryptionEnabled)return e;try{const n=qi.AES.decrypt(e,this.encryptionKey).toString(qi.enc.Utf8);try{return JSON.parse(n)}catch{return n}}catch(r){return console.error("Decryption failed:",r),e}}getNestedValue(e,r){return r.split(".").reduce((n,s)=>n&&n[s],e)}setNestedValue(e,r,n){const s=r.split("."),i=s.pop(),a=s.reduce((o,l)=>o[l]=o[l]||{},e);return a[i]=n,e}async logAccess(e,r,n){var s,i;try{const a=Ze(_t(qe,"iepAccessLogs"));await Ht(a,{studentId:e,userId:(s=St.currentUser)==null?void 0:s.uid,userEmail:(i=St.currentUser)==null?void 0:i.email,action:r,fields:n,timestamp:wn(),userAgent:navigator.userAgent,encryptionEnabled:this.encryptionEnabled})}catch(a){console.error("Failed to log access:",a)}}async verifyAccess(e,r="read"){var n,s,i,a,o,l;if(!St.currentUser)return!1;try{const u=(await nr(Ze(qe,"users",St.currentUser.uid))).data();if(["admin","administrator","sped_chair"].includes(u.role))return!0;if(u.role==="case_manager"){const h=((i=(s=(n=(await nr(Ze(qe,"students",e))).data())==null?void 0:n.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId)===St.currentUser.uid;return await this.logAccess(e,`access_attempt_${r}`,{success:h,role:"case_manager"}),h}if(u.role==="teacher"&&r==="read"){const h=((l=(o=(a=(await nr(Ze(qe,"students",e))).data())==null?void 0:a.app)==null?void 0:o.schedule)==null?void 0:l.periods)||{},p=Object.values(h).includes(St.currentUser.uid);return await this.logAccess(e,`access_attempt_${r}`,{success:p,role:"teacher"}),p}return!1}catch(c){return console.error("Access verification failed:",c),!1}}async getAccessHistory(e){try{const r=or(_t(qe,"iepAccessLogs"),Ur("studentId","==",e),Ur("timestamp",">=",new Date(Date.now()-2592e6)));return(await Gt(r)).docs.map(s=>({id:s.id,...s.data()}))}catch(r){return console.error("Failed to fetch access history:",r),[]}}maskSensitiveData(e){var n,s,i;const r=JSON.parse(JSON.stringify(e));return(n=r.app)!=null&&n.accommodations&&(r.app.accommodations={assessment:"[RESTRICTED]",instruction:"[RESTRICTED]"}),(i=(s=r.app)==null?void 0:s.schedule)!=null&&i.classServices&&(r.app.schedule.classServices=["[RESTRICTED]"]),r}isEncryptionEnabled(){return this.encryptionEnabled}isValueEncrypted(e){try{return typeof e!="string"?!1:(qi.AES.decrypt(e,this.encryptionKey).toString(qi.enc.Utf8),!0)}catch{return!1}}getEncryptionStatus(){return{enabled:this.encryptionEnabled,environment:"production",keyAvailable:!!this.encryptionKey,environmentVariable:A0e.VUE_APP_ENABLE_ENCRYPTION,viteEncryptionValue:null,isViteSet:!1,viteEncryptionEnabled:this.encryptionEnabled}}}const d0=new T0e,w0e={class:"debug-encryption"},C0e={class:"debug-header"},I0e={class:"encryption-status"},k0e={class:"status-row"},D0e={class:"encryption-toggle"},P0e=["checked"],R0e={key:0,class:"warning"},F0e={class:"status-details"},N0e={class:"status-row"},O0e={class:"status-value"},M0e={class:"status-row"},L0e={class:"status-value"},B0e={class:"status-row"},U0e={class:"status-value"},$0e={key:0,class:"env-value-set"},V0e={class:"env-guidance"},H0e={key:0,class:"dev-guidance"},j0e={key:1,class:"prod-guidance"},G0e={key:1,class:"env-value-not-set"},W0e={class:"status-row"},z0e={class:"status-value"},K0e={key:0,class:"debug-info"},q0e={class:"field-name"},X0e={class:"field-value"},Y0e={class:"value-preview"},Q0e={__name:"DebugEncryption",props:{selectedStudent:{type:Object,default:null}},setup(t){const e=t,r=be(()=>d0.getEncryptionStatus()),n=be(()=>d0.isEncryptionEnabled()),s=be(()=>r.value.environment),i=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],a=()=>{d0.setEncryptionEnabled(!n.value)},o=(u,f)=>f.split(".").reduce((h,p)=>h&&h[p],u),l=u=>{if(!e.selectedStudent)return!1;const f=o(e.selectedStudent,u);return f?d0.isValueEncrypted(f):!1},c=u=>{if(!e.selectedStudent)return"No data";const f=o(e.selectedStudent,u);if(!f)return"Empty";if(l(u))return f.substring(0,20)+"...";const h=typeof f=="object"?JSON.stringify(f):String(f);return h.length>40?h.substring(0,40)+"...":h};return(u,f)=>(O(),B("div",w0e,[d("div",C0e,[f[0]||(f[0]=d("h3",null," IEP Encryption Control",-1)),d("div",{class:Qe(["environment-badge",s.value])},Y(s.value.toUpperCase()),3)]),d("div",I0e,[d("div",k0e,[f[1]||(f[1]=d("div",{class:"status-label"},"Status:",-1)),d("div",{class:Qe(["status-value",{enabled:n.value}])},Y(n.value?" Enabled":" Disabled"),3)]),d("div",D0e,[d("label",null,[d("input",{type:"checkbox",checked:n.value,onChange:a},null,40,P0e),f[2]||(f[2]=Ce(" Toggle Encryption "))]),s.value==="production"&&!n.value?(O(),B("div",R0e,"  Warning: Encryption disabled in production ")):_e("",!0)]),d("div",F0e,[d("div",N0e,[f[3]||(f[3]=d("div",{class:"status-label"},"Environment:",-1)),d("div",O0e,Y(s.value),1)]),d("div",M0e,[f[4]||(f[4]=d("div",{class:"status-label"},"Encryption Key:",-1)),d("div",L0e,Y(r.value.keyAvailable?" Available":" Missing"),1)]),d("div",B0e,[f[6]||(f[6]=d("div",{class:"status-label"},"VITE_ENABLE_ENCRYPTION:",-1)),d("div",U0e,[r.value.isViteSet?(O(),B("div",$0e,[d("span",{class:Qe(["env-value",{"true-value":r.value.viteEncryptionValue==="true","false-value":r.value.viteEncryptionValue==="false"}])},Y(r.value.viteEncryptionValue),3),d("div",V0e,[r.value.viteEncryptionValue==="true"?(O(),B("span",H0e," Development mode")):r.value.viteEncryptionValue==="false"?(O(),B("span",j0e," Production mode")):_e("",!0)])])):(O(),B("div",G0e,f[5]||(f[5]=[d("span",{class:"not-set"},"Not set",-1),d("div",{class:"env-guidance"},[d("span",{class:"default-guidance"},"Defaults to enabled (secure)")],-1)])))])]),d("div",W0e,[f[7]||(f[7]=d("div",{class:"status-label"},"Legacy ENV:",-1)),d("div",z0e,Y(r.value.environmentVariable||"Not set"),1)])])]),t.selectedStudent?(O(),B("div",K0e,[f[8]||(f[8]=d("h4",null,"Selected Student Data:",-1)),(O(),B(Fe,null,He(i,h=>d("div",{class:"field-status",key:h},[d("div",q0e,Y(h)+":",1),d("div",X0e,[d("div",{class:Qe(["encryption-status",{encrypted:l(h)}])},Y(l(h)?" Encrypted":" Plain Text"),3),d("div",Y0e,Y(c(h)),1)])])),64))])):_e("",!0)]))}},mD=xt(Q0e,[["__scopeId","data-v-7902f511"]]),J0e={class:"session-debug"},Z0e={class:"debug-info"},ehe={class:"info-row"},the={class:"info-row"},rhe={class:"info-row"},nhe={class:"info-row"},she={key:0,class:"info-row"},ahe={class:"countdown"},ihe={class:"debug-actions"},ohe={class:"timeout-setter"},lhe={__name:"SessionTimeoutDebug",setup(t){const{isEnabled:e,timeoutMinutes:r,showWarning:n,warningCountdown:s,updateSettings:i,resetTimeout:a}=zy(),{currentUser:o}=sf(),l=se(!1),c=se(30),u=se(.17);jt(()=>{l.value=e.value,c.value=r.value});const f=async()=>{!l.value&&!c.value&&(l.value=e.value,c.value=r.value),await i(!0,u.value),setTimeout(()=>{a()},100)},h=async()=>{await i(l.value,c.value),setTimeout(()=>{a()},100)},p=()=>{document.dispatchEvent(new Event("click"))},v=()=>{console.log(" Session Timeout Debug Info:"),console.log("- Enabled:",e.value),console.log("- Timeout Minutes:",r.value),console.log("- Warning Showing:",n.value),console.log("- Warning Countdown:",s.value),console.log("- User Logged In:",!!o.value),console.log("- Current User:",o.value)};return(g,y)=>(O(),B("div",J0e,[d("h4",null,[Le(X(Bv),{size:16}),y[1]||(y[1]=Ce(" Session Timeout Debug"))]),d("div",Z0e,[d("div",ehe,[y[2]||(y[2]=d("strong",null,"Timeout Enabled:",-1)),d("span",{class:Qe({"status-active":X(e),"status-inactive":!X(e)})},[X(e)?(O(),tr(X(vh),{key:0,size:14})):(O(),tr(X(Tm),{key:1,size:14})),Ce(" "+Y(X(e)?"YES":"NO"),1)],2)]),d("div",the,[y[3]||(y[3]=d("strong",null,"Timeout Minutes:",-1)),d("span",null,Y(X(r))+" minutes",1)]),d("div",rhe,[y[4]||(y[4]=d("strong",null,"User Logged In:",-1)),d("span",{class:Qe({"status-active":!!X(o),"status-inactive":!X(o)})},[X(o)?(O(),tr(X(vh),{key:0,size:14})):(O(),tr(X(Tm),{key:1,size:14})),Ce(" "+Y(X(o)?"YES":"NO"),1)],2)]),d("div",nhe,[y[5]||(y[5]=d("strong",null,"Warning Showing:",-1)),d("span",{class:Qe({"status-warning":X(n),"status-inactive":!X(n)})},[X(n)?(O(),tr(X(d7),{key:0,size:14})):(O(),tr(X(Tm),{key:1,size:14})),Ce(" "+Y(X(n)?"YES":"NO"),1)],2)]),X(n)?(O(),B("div",she,[y[6]||(y[6]=d("strong",null,"Countdown:",-1)),d("span",ahe,Y(X(s))+"s",1)])):_e("",!0)]),d("div",ihe,[d("div",ohe,[d("label",null,[y[8]||(y[8]=Ce(" Set Test Timeout: ")),Be(d("select",{"onUpdate:modelValue":y[0]||(y[0]=b=>u.value=b),class:"timeout-select"},y[7]||(y[7]=[In('<option value="0.05" data-v-f9b33c99>3 seconds</option><option value="0.17" data-v-f9b33c99>10 seconds</option><option value="0.5" data-v-f9b33c99>30 seconds</option><option value="1" data-v-f9b33c99>1 minute</option><option value="2" data-v-f9b33c99>2 minutes</option><option value="5" data-v-f9b33c99>5 minutes</option>',6)]),512),[[cr,u.value]])]),d("button",{onClick:f,class:"btn btn-warning"}," Apply Test Timeout ")]),d("div",{class:"admin-action-btns"},[d("button",{onClick:p,class:"admin-action-btn",style:{"min-width":"120px","max-width":"120px"}}," Trigger Activity "),d("button",{onClick:v,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Show Console Info "),d("button",{onClick:h,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Reset to Original ")])])]))}},che=xt(lhe,[["__scopeId","data-v-f9b33c99"]]),uhe={class:"security-control-center"},dhe={class:"security-section"},fhe={class:"security-section"},hhe={class:"setting-group"},phe={key:0,class:"setting-group"},mhe={class:"setting-group"},ghe={class:"setting-group"},vhe={class:"security-section"},yhe={class:"setting-group"},xhe={class:"setting-group"},Ehe={class:"security-section"},_he={class:"ip-list"},bhe={class:"ip-input"},She={key:0,class:"ip-table"},Ahe=["onClick"],The={key:1,class:"no-ips"},whe={class:"security-section"},Che={class:"alert-settings"},Ihe={class:"setting-group"},khe={class:"setting-group"},Dhe={class:"alert-emails"},Phe={class:"email-input"},Rhe={key:0,class:"email-list"},Fhe=["onClick"],Nhe={__name:"SecurityControlCenter",props:{selectedStudent:{type:Object,default:null}},setup(t){const{isEnabled:e,timeoutMinutes:r,updateSettings:n}=zy(),s=se(!1),i=se(!1),a=se(!0),o=se(!0),l=se([]),c=se(""),u=se({unusualAccess:!0,bulkExport:!0}),f=se([]),h=se(""),p=async()=>{try{await n(e.value,r.value)}catch(S){console.error("Failed to toggle session timeout:",S)}},v=async()=>{try{await n(e.value,r.value)}catch(S){console.error("Failed to update session timeout:",S)}},g=()=>{console.log("Password policy updated:",s.value)},y=()=>{console.log("MFA policy updated:",i.value)},b=()=>{console.log("Export policy updated:",a.value)},E=()=>{console.log("PDF policy updated:",o.value)},x=()=>{c.value&&!l.value.includes(c.value)&&(l.value.push(c.value),c.value="")},I=S=>{l.value=l.value.filter(m=>m!==S)},D=()=>{console.log("Alert settings updated:",u.value)},P=()=>{h.value&&!f.value.includes(h.value)&&(f.value.push(h.value),h.value="")},w=S=>{f.value=f.value.filter(m=>m!==S)};return(S,m)=>(O(),B("div",uhe,[d("div",dhe,[m[10]||(m[10]=d("h3",null," IEP Data Encryption",-1)),Le(mD,{"selected-student":t.selectedStudent},null,8,["selected-student"])]),d("div",fhe,[m[17]||(m[17]=d("h3",null," Session Security",-1)),Le(che),d("div",hhe,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":m[0]||(m[0]=T=>Cr(e)?e.value=T:null),onChange:p},null,544),[[wt,X(e)]]),m[11]||(m[11]=Ce(" Enable Auto Logout Timer "))]),m[12]||(m[12]=d("div",{class:"setting-description"}," Automatically log out users after a period of inactivity ",-1))]),X(e)?(O(),B("div",phe,[d("label",null,[m[13]||(m[13]=Ce(" Auto Logout Timer (minutes): ")),Be(d("input",{type:"number","onUpdate:modelValue":m[1]||(m[1]=T=>Cr(r)?r.value=T:null),min:"5",max:"120",onChange:v},null,544),[[ht,X(r)]])]),m[14]||(m[14]=d("div",{class:"setting-description"}," Users will be automatically logged out after this period of inactivity ",-1))])):_e("",!0),d("div",mhe,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":m[2]||(m[2]=T=>s.value=T),onChange:g},null,544),[[wt,s.value]]),m[15]||(m[15]=Ce(" Enforce Password Change Every 90 Days "))])]),d("div",ghe,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":m[3]||(m[3]=T=>i.value=T),onChange:y},null,544),[[wt,i.value]]),m[16]||(m[16]=Ce(" Require Two-Factor Authentication for Admin Access "))])])]),d("div",vhe,[m[20]||(m[20]=d("h3",null," Data Access Controls",-1)),d("div",yhe,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":m[4]||(m[4]=T=>a.value=T),onChange:b},null,544),[[wt,a.value]]),m[18]||(m[18]=Ce(" Restrict Data Export to Admins Only "))])]),d("div",xhe,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":m[5]||(m[5]=T=>o.value=T),onChange:E},null,544),[[wt,o.value]]),m[19]||(m[19]=Ce(" Add Watermark to Exported PDFs "))])])]),d("div",Ehe,[m[21]||(m[21]=d("h3",null," IP Access Control",-1)),d("div",_he,[d("div",bhe,[Be(d("input",{type:"text","onUpdate:modelValue":m[6]||(m[6]=T=>c.value=T),placeholder:"Enter IP address or range"},null,512),[[ht,c.value]]),d("button",{onClick:x,class:"btn btn-primary"}," Add IP ")]),l.value.length?(O(),B("div",She,[(O(!0),B(Fe,null,He(l.value,T=>(O(),B("div",{key:T,class:"ip-row"},[d("span",null,Y(T),1),d("button",{onClick:_=>I(T),class:"btn btn-danger btn-sm"}," Remove ",8,Ahe)]))),128))])):(O(),B("div",The," No IP restrictions configured "))])]),d("div",whe,[m[25]||(m[25]=d("h3",null," Security Alerts",-1)),d("div",Che,[d("div",Ihe,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":m[7]||(m[7]=T=>u.value.unusualAccess=T),onChange:D},null,544),[[wt,u.value.unusualAccess]]),m[22]||(m[22]=Ce(" Alert on Unusual Access Patterns "))])]),d("div",khe,[d("label",null,[Be(d("input",{type:"checkbox","onUpdate:modelValue":m[8]||(m[8]=T=>u.value.bulkExport=T),onChange:D},null,544),[[wt,u.value.bulkExport]]),m[23]||(m[23]=Ce(" Alert on Bulk Data Exports "))])]),d("div",Dhe,[m[24]||(m[24]=d("h4",null,"Alert Recipients:",-1)),d("div",Phe,[Be(d("input",{type:"email","onUpdate:modelValue":m[9]||(m[9]=T=>h.value=T),placeholder:"Enter email address"},null,512),[[ht,h.value]]),d("button",{onClick:P,class:"btn btn-primary"}," Add ")]),f.value.length?(O(),B("div",Rhe,[(O(!0),B(Fe,null,He(f.value,T=>(O(),B("div",{key:T,class:"email-row"},[d("span",null,Y(T),1),d("button",{onClick:_=>w(T),class:"btn btn-danger btn-sm"}," Remove ",8,Fhe)]))),128))])):_e("",!0)])])])]))}},Ohe=xt(Nhe,[["__scopeId","data-v-1ecfe656"]]),Mhe={class:"card-header"},Lhe={class:"component-info"},Bhe={class:"component-name"},Uhe={class:"component-description"},$he={class:"card-body"},Vhe={class:"status-details"},Hhe={class:"detail-row"},jhe={key:0,class:"detail-row"},Ghe={key:1,class:"detail-row"},Whe={class:"detail-value"},zhe={key:0,class:"errors-section"},Khe={class:"errors-list"},qhe={class:"card-actions"},Xhe=["disabled"],Yhe={key:1,class:"details-section"},Qhe={class:"details-content"},Jhe={class:"detail-item"},Zhe={class:"detail-item"},epe={key:0,class:"detail-item"},tpe={class:"detail-item"},rpe={key:0,class:"loading-overlay"},npe={__name:"ComponentHealthCard",props:{component:{type:Object,required:!0}},emits:["test","toggle"],setup(t){const e=t,r=se(!1),n=se(!1);Vt(()=>e.component.status,(u,f)=>{f==="checking"&&u!=="checking"?n.value=!1:u==="checking"&&(n.value=!0)},{immediate:!0});const s=u=>{switch(u){case"operational":return"";case"degraded":return"";case"down":return"";case"disabled":return"";case"checking":return"";default:return""}},i=u=>{switch(u){case"operational":return"Healthy";case"degraded":return"Issues";case"down":return"Failed";case"disabled":return"Disabled";case"checking":return"Testing...";default:return"Unknown"}},a=u=>u<100?"latency-good":u<500?"latency-ok":"latency-poor",o=u=>u?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).format(u):"Never",l=u=>u?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).format(u):"Never",c=u=>u.toLowerCase().replace(/\s+/g,"-");return(u,f)=>(O(),B("div",{class:Qe(["health-card",[t.component.status,{disabled:!t.component.enabled}]])},[d("div",Mhe,[d("div",Lhe,[d("h4",Bhe,Y(t.component.name),1),d("p",Uhe,Y(t.component.description),1)]),d("div",{class:Qe(["status-indicator",t.component.status])},Y(s(t.component.status)),3)]),d("div",$he,[d("div",Vhe,[d("div",Hhe,[f[3]||(f[3]=d("span",{class:"detail-label"},"Status:",-1)),d("span",{class:Qe(["detail-value",t.component.status])},Y(i(t.component.status)),3)]),t.component.latency!==null?(O(),B("div",jhe,[f[4]||(f[4]=d("span",{class:"detail-label"},"Latency:",-1)),d("span",{class:Qe(["detail-value",a(t.component.latency)])},Y(t.component.latency)+"ms ",3)])):_e("",!0),t.component.lastCheck?(O(),B("div",Ghe,[f[5]||(f[5]=d("span",{class:"detail-label"},"Last Check:",-1)),d("span",Whe,Y(o(t.component.lastCheck)),1)])):_e("",!0)]),t.component.errors&&t.component.errors.length?(O(),B("div",zhe,[f[6]||(f[6]=d("div",{class:"errors-header"}," Issues:",-1)),d("ul",Khe,[(O(!0),B(Fe,null,He(t.component.errors,h=>(O(),B("li",{key:h,class:"error-item"},Y(h),1))),128))])])):_e("",!0),d("div",qhe,[d("button",{onClick:f[0]||(f[0]=h=>u.$emit("test",t.component)),disabled:n.value,class:"btn btn-primary btn-sm"},Y(n.value?"":"")+" Test ",9,Xhe),d("button",{onClick:f[1]||(f[1]=h=>u.$emit("toggle",t.component)),class:Qe(["btn btn-sm",t.component.enabled?"btn-warning":"btn-success"])},Y(t.component.enabled?" Disable":" Enable"),3),d("button",{onClick:f[2]||(f[2]=h=>r.value=!r.value),class:"btn btn-secondary btn-sm"},Y(r.value?" Less":" More"),1)]),r.value?(O(),B("div",Yhe,[d("div",Qhe,[d("div",Jhe,[f[7]||(f[7]=d("strong",null,"Test Function:",-1)),Ce(" "+Y(t.component.testFunction||"N/A"),1)]),d("div",Zhe,[f[8]||(f[8]=d("strong",null,"Enabled:",-1)),Ce(" "+Y(t.component.enabled?"Yes":"No"),1)]),t.component.lastCheck?(O(),B("div",epe,[f[9]||(f[9]=d("strong",null,"Last Test:",-1)),Ce(" "+Y(l(t.component.lastCheck)),1)])):_e("",!0),d("div",tpe,[f[10]||(f[10]=d("strong",null,"Component ID:",-1)),Ce(" "+Y(c(t.component.name)),1)])])])):_e("",!0)]),n.value?(O(),B("div",rpe,f[11]||(f[11]=[d("div",{class:"loading-spinner"},"",-1),d("div",{class:"loading-text"},"Testing component...",-1)]))):_e("",!0)],2))}},jS=xt(npe,[["__scopeId","data-v-18cc0437"]]),spe={class:"health-dashboard"},ape={class:"dashboard-header"},ipe={class:"header-controls"},ope=["disabled"],lpe={key:0,class:"last-update"},cpe={class:"status-overview"},upe={class:"status-icon"},dpe={class:"status-info"},fpe={class:"status-details"},hpe={class:"component-categories"},ppe={class:"category-section"},mpe={class:"components-grid"},gpe={class:"category-section"},vpe={class:"components-grid"},ype={class:"quick-actions"},xpe={class:"admin-action-btns"},Epe=["disabled"],_pe={class:"logs-section"},bpe={class:"logs-container"},Spe={class:"log-time"},Ape={class:"log-component"},Tpe={class:"log-message"},wpe={key:0,class:"no-logs"},Cpe={class:"modal-header"},Ipe={class:"modal-content"},kpe={__name:"ComponentHealthDashboard",setup(t){const e=se(!1),r=se(null),n=se(!1),s=se({}),i=se([]),a=se(!1),o=se([{name:"Firebase Auth",status:"operational",description:"User authentication service",lastCheck:new Date,enabled:!0,latency:150,errors:[]},{name:"Firestore Database",status:"operational",description:"Main database service",lastCheck:new Date,enabled:!0,latency:200,errors:[]},{name:"Firebase Storage",status:"operational",description:"File storage service",lastCheck:new Date,enabled:!0,latency:180,errors:[]},{name:"Cloud Functions",status:"operational",description:"Server-side functions",lastCheck:new Date,enabled:!0,latency:300,errors:[]}]),l=se([{name:"Session Timeout",status:"operational",description:"Automatic user logout system",lastCheck:new Date,enabled:!0,latency:50,errors:[]},{name:"IEP Encryption",status:"operational",description:"Sensitive data encryption",lastCheck:new Date,enabled:!0,latency:80,errors:[]},{name:"Access Control",status:"operational",description:"Role-based permissions",lastCheck:new Date,enabled:!0,latency:120,errors:[]},{name:"Audit Logging",status:"operational",description:"Activity tracking system",lastCheck:new Date,enabled:!0,latency:90,errors:[]}]),c=be(()=>[...o.value,...l.value]),u=be(()=>c.value.length),f=be(()=>c.value.filter(S=>S.status==="operational").length),h=be(()=>{const S=c.value.map(m=>m.status);return S.every(m=>m==="operational"||m==="disabled")?"operational":S.some(m=>m==="down"||m==="error")?"down":"degraded"}),p=S=>{switch(S){case"operational":return"";case"degraded":return"";case"down":return"";case"disabled":return"";default:return""}},v=S=>{switch(S){case"operational":return"All systems operational";case"degraded":return"Some issues detected";case"down":return"Critical issues found";case"checking":return"Running diagnostics...";default:return"Unknown status"}},g=S=>S?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).format(S):"",y=(S,m,T="info")=>{i.value.unshift({id:Date.now()+Math.random(),timestamp:new Date,component:S,message:m,type:T}),i.value.length>20&&(i.value=i.value.slice(0,20))},b=async S=>{y(S.name,"Starting component test...","info");try{const m=performance.now();await new Promise(A=>setTimeout(A,Math.random()*1e3+500));const T=Math.round(performance.now()-m),_=c.value.find(A=>A.name===S.name);_&&(_.status=Math.random()>.1?"operational":"degraded",_.latency=T,_.lastCheck=new Date,_.errors=_.status==="degraded"?["Minor performance issue detected"]:[]),y(S.name,`Test completed - ${_.status} (${T}ms)`,_.status==="operational"?"success":"warning"),s.value={component:S.name,data:{status:_.status,latency:`${T}ms`,timestamp:new Date().toISOString(),details:_.status==="operational"?"All checks passed successfully":"Minor performance issues detected"}},n.value=!0}catch(m){y(S.name,`Test failed: ${m.message}`,"error")}},E=S=>{const m=c.value.find(T=>T.name===S.name);m&&(m.enabled=!m.enabled,m.status=m.enabled?"operational":"disabled",y(S.name,`Component ${m.enabled?"enabled":"disabled"}`,"info"))},x=async()=>{if(!e.value){e.value=!0,r.value=new Date,y("System","Starting full system refresh...","info");try{const S=c.value.filter(m=>m.enabled).map(m=>b(m));await Promise.all(S),y("System","Full system refresh completed","success")}catch(S){y("System",`Refresh failed: ${S.message}`,"error")}finally{e.value=!1}}},I=async()=>{a.value=!0,y("System","Starting comprehensive system test...","info");try{await x(),y("System","Comprehensive system test completed","success")}catch(S){y("System",`System test failed: ${S.message}`,"error")}finally{a.value=!1}},D=()=>{const S={timestamp:new Date().toISOString(),overallStatus:h.value,components:c.value.map(A=>({name:A.name,status:A.status,enabled:A.enabled,latency:A.latency,lastCheck:A.lastCheck,errors:A.errors})),logs:i.value.slice(0,10)},m=new Blob([JSON.stringify(S,null,2)],{type:"application/json"}),T=URL.createObjectURL(m),_=document.createElement("a");_.href=T,_.download=`health-report-${Date.now()}.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(T),y("System","Health report exported","info")},P=()=>{i.value=[]},w=()=>{n.value=!1,s.value={}};return jt(()=>{y("System","Component Health Dashboard initialized","success")}),(S,m)=>(O(),B("div",spe,[d("div",ape,[m[1]||(m[1]=d("h2",null," Component Health Dashboard",-1)),d("div",ipe,[d("button",{onClick:x,disabled:e.value,class:"btn btn-primary"},Y(e.value?" Refreshing...":" Refresh All"),9,ope),r.value?(O(),B("span",lpe," Last update: "+Y(g(r.value)),1)):_e("",!0)])]),d("div",cpe,[d("div",{class:Qe(["status-card overall",h.value])},[d("div",upe,Y(p(h.value)),1),d("div",dpe,[m[2]||(m[2]=d("h3",null,"System Status",-1)),d("p",null,Y(v(h.value)),1),d("div",fpe,Y(f.value)+"/"+Y(u.value)+" components healthy ",1)])],2)]),d("div",hpe,[d("div",ppe,[m[3]||(m[3]=d("h3",null," Core Services",-1)),d("div",mpe,[(O(!0),B(Fe,null,He(o.value,T=>(O(),tr(jS,{key:T.name,component:T,onTest:b,onToggle:E},null,8,["component"]))),128))])]),d("div",gpe,[m[4]||(m[4]=d("h3",null," Authentication & Security",-1)),d("div",vpe,[(O(!0),B(Fe,null,He(l.value,T=>(O(),tr(jS,{key:T.name,component:T,onTest:b,onToggle:E},null,8,["component"]))),128))])])]),d("div",ype,[m[5]||(m[5]=d("h3",null," Quick Tests",-1)),d("div",xpe,[d("button",{onClick:I,disabled:a.value,class:"admin-action-btn",style:{"min-width":"160px","max-width":"160px"}},Y(a.value?" Testing...":" Full System Test"),9,Epe),d("button",{onClick:D,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},"  Export Report ")])]),d("div",_pe,[d("div",{class:"logs-header"},[m[6]||(m[6]=d("h3",null," Component Activity Logs",-1)),d("div",{class:"log-controls"},[d("button",{onClick:P,class:"btn btn-sm btn-secondary"},"Clear")])]),d("div",bpe,[(O(!0),B(Fe,null,He(i.value,T=>(O(),B("div",{key:T.id,class:Qe(["log-entry",T.type])},[d("span",Spe,Y(g(T.timestamp)),1),d("span",Ape,Y(T.component),1),d("span",Tpe,Y(T.message),1)],2))),128)),i.value.length===0?(O(),B("div",wpe,' No activity logs yet. Click "Refresh All" to start monitoring. ')):_e("",!0)])]),n.value?(O(),B("div",{key:0,class:"test-modal-overlay",onClick:w},[d("div",{class:"test-modal",onClick:m[0]||(m[0]=dn(()=>{},["stop"]))},[d("div",Cpe,[d("h3",null,Y(s.value.component)+" Test Results",1),d("button",{onClick:w,class:"btn btn-sm btn-secondary"},"")]),d("div",Ipe,[d("pre",null,Y(JSON.stringify(s.value.data,null,2)),1)])])])):_e("",!0)]))}},Dpe=xt(kpe,[["__scopeId","data-v-106cd980"]]),Ppe={class:"admin-permissions-matrix"},Rpe={class:"matrix-container"},Fpe={key:0,class:"loading-state"},Npe={key:1,class:"permissions-table"},Ope={key:0},Mpe={key:0,class:"permission-row"},Lpe={class:"page-info"},Bpe={class:"page-name"},Upe={class:"page-category"},$pe={class:"page-description"},Vpe={class:"permission-cell"},Hpe=["checked","disabled","onChange"],jpe={class:"permission-cell"},Gpe=["checked","disabled","onChange"],Wpe={class:"permission-cell"},zpe=["checked","disabled","onChange"],Kpe={class:"matrix-actions"},qpe={class:"bulk-actions"},Xpe={class:"bulk-buttons"},Ype={key:0,class:"save-status"},Qpe={__name:"AdminPermissionsMatrix",setup(t){const e=se(null),r=se(!0),n=be(()=>!r.value&&s.value.length>0&&Object.keys(i).length>0),s=se([{key:"dashboard",label:"Dashboard",category:"Dashboard",description:"Main admin overview and statistics"},{key:"usersAdd",label:"Add Users",category:"User Management",description:"Create new user accounts"},{key:"usersEdit",label:"Manage Users",category:"User Management",description:"Edit existing user accounts"},{key:"students",label:"Students",category:"Student Management",description:"View and manage student records"},{key:"addStudents",label:"Add Students",category:"Student Management",description:"Bulk import student data"},{key:"aide-assignment",label:"Aide Assignment",category:"Aide Management",description:"Assign aides to students"},{key:"aide-schedule",label:"Aide Schedule",category:"Aide Management",description:"Manage aide schedules"},{key:"time-table",label:"Time Table",category:"Aide Management",description:"Configure school time periods"},{key:"seis",label:"SEIS Import",category:"Data Integration",description:"Import SEIS student data"},{key:"aeries",label:"Aeries API & Import",category:"Data Integration",description:"Connect to Aeries SIS"},{key:"testing-links",label:"Testing Links",category:"Data Integration",description:"Google Sheets integration for testing"},{key:"teacher-feedback",label:"Teacher Feedback Forms",category:"Data Integration",description:"Manage teacher feedback system"},{key:"backup-restore",label:"Backup & Restore",category:"Data Integration",description:"Database backup and restore"},{key:"settings",label:"App Settings",category:"Settings",description:"Global application settings"},{key:"delete-all-users",label:"Delete All Users",category:"Bulk Actions",description:"Mass deletion of user accounts (dangerous operation)"},{key:"delete-all-students",label:"Delete All Students",category:"Bulk Actions",description:"Mass deletion of student records (dangerous operation)"},{key:"permissions",label:"Admin Panel Permissions",category:"System",description:"User role and permission management"},{key:"audit-logs",label:"Audit Logs",category:"System",description:"View and search system audit logs"},{key:"iep-security",label:"IEP Security",category:"System",description:"IEP data encryption and security"},{key:"security",label:"Security Controls",category:"System",description:"Security monitoring and controls"},{key:"component-health",label:"Component Debug",category:"System",description:"Component health and debugging"},{key:"app-settings-testing",label:"App Settings Testing",category:"System",description:"App settings testing and debugging tools"}]),i=Rs({}),a={school_admin:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!0,settings:!0,"delete-all-users":!0,"delete-all-students":!0,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0},admin_504:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!1,settings:!1,"delete-all-users":!1,"delete-all-students":!1,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0},sped_chair:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!1,settings:!1,"delete-all-users":!1,"delete-all-students":!1,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0}},o=()=>{if(!s.value||s.value.length===0){console.warn("adminPages not initialized yet");return}s.value.forEach(y=>{y&&y.key&&(i[y.key]={school_admin:a.school_admin[y.key]||!1,admin_504:a.admin_504[y.key]||!1,sped_chair:a.sped_chair[y.key]||!1})})},l=async()=>{try{const y=Ze(qe,"app_settings","admin_panel_permissions"),b=await nr(y);if(b.exists()){const E=b.data();s.value.forEach(x=>{x&&x.key&&E[x.key]&&(i[x.key]={school_admin:E[x.key].school_admin??a.school_admin[x.key],admin_504:E[x.key].admin_504??a.admin_504[x.key],sped_chair:E[x.key].sped_chair??a.sped_chair[x.key]})}),g("Permissions loaded successfully","success")}else o(),g("Using default permissions","info")}catch(y){console.error("Error loading permissions:",y),g("Error loading permissions","error"),o()}finally{r.value=!1}},c=async()=>{try{const y=Ze(qe,"app_settings","admin_panel_permissions");await Ht(y,i),g("Permissions saved successfully","success")}catch(y){console.error("Error saving permissions:",y),g("Error saving permissions","error")}},u=async(y,b,E)=>{i[y]&&(i[y][b]=E,await c())},f=async y=>{s.value.forEach(b=>{b&&b.key&&i[b.key]&&(i[b.key][y]=!0)}),await c(),g(`All permissions granted to ${y}`,"success")},h=async()=>{s.value.forEach(y=>{y&&y.key&&i[y.key]&&(i[y.key].school_admin=!1,i[y.key].admin_504=!1,i[y.key].sped_chair=!1)}),await c(),g("All permissions revoked","warning")},p=async()=>{o(),await c(),g("Permissions reset to defaults","info")},v=(y,b)=>["permissions","iep-security","security","component-health"].includes(y)?!0:["delete-all-users","delete-all-students"].includes(y)?b!=="school_admin":b==="admin_504"?["settings"].includes(y):b==="sped_chair"?["settings"].includes(y):!1,g=(y,b)=>{e.value={message:y,type:b},setTimeout(()=>{e.value=null},3e3)};return jt(async()=>{await l()}),(y,b)=>(O(),B("div",Ppe,[b[9]||(b[9]=d("div",{class:"matrix-header"},[d("h2",null," Admin Panel Permissions Matrix"),d("p",{class:"matrix-description"}," Control which admin panel pages different admin roles can access. Changes are saved automatically. ")],-1)),d("div",Rpe,[r.value?(O(),B("div",Fpe,b[3]||(b[3]=[d("p",null,"Loading permissions...",-1)]))):(O(),B("table",Npe,[b[7]||(b[7]=d("thead",null,[d("tr",null,[d("th",{class:"page-column"},"Admin Panel Page"),d("th",{class:"role-column"},"School Admin"),d("th",{class:"role-column"},"504 Coordinator"),d("th",{class:"role-column"},"SPED Chair")])],-1)),n.value?(O(),B("tbody",Ope,[(O(!0),B(Fe,null,He(s.value,E=>(O(),B(Fe,{key:(E==null?void 0:E.key)||"unknown"},[E&&E.key&&i[E.key]?(O(),B("tr",Mpe,[d("td",Lpe,[d("div",Bpe,Y(E.label),1),d("div",Upe,Y(E.category),1),d("div",$pe,Y(E.description),1)]),d("td",Vpe,[d("label",{class:Qe(["permission-toggle",{disabled:v(E.key,"school_admin")}])},[d("input",{type:"checkbox",checked:i[E.key]&&i[E.key].school_admin,disabled:v(E.key,"school_admin"),onChange:x=>u(E.key,"school_admin",x.target.checked)},null,40,Hpe),b[4]||(b[4]=d("span",{class:"toggle-slider"},null,-1))],2)]),d("td",jpe,[d("label",{class:Qe(["permission-toggle",{disabled:v(E.key,"admin_504")}])},[d("input",{type:"checkbox",checked:i[E.key]&&i[E.key].admin_504,disabled:v(E.key,"admin_504"),onChange:x=>u(E.key,"admin_504",x.target.checked)},null,40,Gpe),b[5]||(b[5]=d("span",{class:"toggle-slider"},null,-1))],2)]),d("td",Wpe,[d("label",{class:Qe(["permission-toggle",{disabled:v(E.key,"sped_chair")}])},[d("input",{type:"checkbox",checked:i[E.key]&&i[E.key].sped_chair,disabled:v(E.key,"sped_chair"),onChange:x=>u(E.key,"sped_chair",x.target.checked)},null,40,zpe),b[6]||(b[6]=d("span",{class:"toggle-slider"},null,-1))],2)])])):_e("",!0)],64))),128))])):_e("",!0)]))]),d("div",Kpe,[d("div",qpe,[b[8]||(b[8]=d("h3",null,"Bulk Actions",-1)),d("div",Xpe,[d("button",{onClick:b[0]||(b[0]=E=>f("school_admin")),class:"btn btn-success"}," Grant All to School Admin "),d("button",{onClick:b[1]||(b[1]=E=>f("admin_504")),class:"btn btn-success"}," Grant All to 504 Coordinator "),d("button",{onClick:b[2]||(b[2]=E=>f("sped_chair")),class:"btn btn-success"}," Grant All to SPED Chair "),d("button",{onClick:h,class:"btn btn-warning"}," Revoke All Permissions "),d("button",{onClick:p,class:"btn btn-secondary"}," Reset to Defaults ")])])]),e.value?(O(),B("div",Ype,[d("div",{class:Qe(["status-message",e.value.type])},Y(e.value.message),3)])):_e("",!0)]))}},Jpe=xt(Qpe,[["__scopeId","data-v-be29f1ae"]]),Zpe={class:"theme-manager"},eme={key:0,class:"loading-state"},tme={key:1,class:"error-state"},rme={class:"error-message"},nme={key:2,class:"theme-editor"},sme={class:"default-themes"},ame={class:"theme-presets"},ime=["onClick"],ome={class:"theme-preview-colors"},lme={class:"theme-info"},cme={class:"theme-actions"},ume=["disabled"],dme=["disabled"],fme={class:"theme-sections"},hme={class:"theme-section"},pme={class:"enhanced-color-grid"},mme={class:"color-input"},gme={class:"color-picker-wrapper"},vme={class:"color-input"},yme={class:"color-picker-wrapper"},xme={class:"color-input"},Eme={class:"color-picker-wrapper"},_me={class:"color-input"},bme={class:"color-picker-wrapper"},Sme={class:"color-input"},Ame={class:"color-picker-wrapper"},Tme={class:"color-input"},wme={class:"color-picker-wrapper"},Cme={class:"theme-section"},Ime={class:"typography-grid"},kme={class:"option-group"},Dme={class:"option-group"},Pme={class:"option-group"},Rme={class:"theme-section"},Fme={class:"style-options-grid"},Nme={class:"option-group"},Ome={class:"option-group"},Mme={class:"option-group"},Lme={class:"theme-section"},Bme={class:"student-preview-container"},Ume={class:"mockup-header"},$me={class:"mockup-table"},Vme={class:"mockup-table-row"},Hme={class:"mockup-cell"},jme={class:"mockup-table-row"},Gme={class:"mockup-cell"},Wme={__name:"ThemeManager",setup(t){const{currentTheme:e,loading:r,error:n,loadTheme:s,saveTheme:i,resetTheme:a,updateThemeProperty:o,DEFAULT_THEME:l}=iI(),c=[{name:"Professional Blue",description:"Clean, accessible blue theme for professional use",primaryColor:"#1976d2",primaryHover:"#1565c0",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#212529",textSecondary:"#495057",textMuted:"#6c757d",textInverse:"#ffffff",headerTextColor:"#1a202c",accentColor:"#e3f2fd",secondaryColor:"#6c757d",secondaryHover:"#545b62",successColor:"#28a745",warningColor:"#ffc107",errorColor:"#dc3545",infoColor:"#17a2b8",borderColor:"#dee2e6",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"standard",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Inter', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.5"},{name:"Educational Orange",description:"Warm, professional orange theme optimized for readability",primaryColor:"#e65100",primaryHover:"#bf360c",primaryLight:"#fff3e0",primaryDark:"#bf360c",bgPrimary:"#fafafa",bgSecondary:"#ffffff",bgTertiary:"#f5f5f5",textPrimary:"#212121",textSecondary:"#424242",textMuted:"#757575",textInverse:"#ffffff",headerTextColor:"#bf360c",accentColor:"#ffcc80",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#2e7d32",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#e0e0e0",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Source Sans Pro', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Accessible Green",description:"Professional green theme with excellent readability",primaryColor:"#2e7d32",primaryHover:"#1b5e20",primaryLight:"#e8f5e8",primaryDark:"#1b5e20",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#1b5e20",textSecondary:"#2e7d32",textMuted:"#558b2f",textInverse:"#ffffff",headerTextColor:"#1b5e20",accentColor:"#a5d6a7",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#4caf50",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#c8e6c9",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Open Sans', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Professional Dark",description:"High-contrast dark theme for reduced eye strain",primaryColor:"#bb86fc",primaryHover:"#9c27b0",primaryLight:"#f3e5f5",primaryDark:"#6a1b9a",bgPrimary:"#121212",bgSecondary:"#1e1e1e",bgTertiary:"#2d2d2d",textPrimary:"#ffffff",textSecondary:"#e0e0e0",textMuted:"#bdbdbd",textInverse:"#000000",headerTextColor:"#bb86fc",accentColor:"#424242",secondaryColor:"#616161",secondaryHover:"#424242",successColor:"#4caf50",warningColor:"#ff9800",errorColor:"#f44336",infoColor:"#2196f3",borderColor:"#424242",borderStyle:"rounded",shadowStyle:"medium",contrastLevel:"maximum",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Roboto', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Corporate Navy",description:"Professional navy blue theme for corporate environments",primaryColor:"#1565c0",primaryHover:"#0d47a1",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#0d47a1",textSecondary:"#1565c0",textMuted:"#1976d2",textInverse:"#ffffff",headerTextColor:"#0d47a1",accentColor:"#bbdefb",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#2e7d32",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#e1f5fe",borderStyle:"sharp",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"2px",borderRadiusMd:"4px",borderRadiusLg:"6px",borderRadiusXl:"8px",fontFamilyBase:"'Source Sans Pro', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.5"},{name:"High Contrast",description:"Maximum accessibility theme with high contrast ratios",primaryColor:"#000000",primaryHover:"#212121",primaryLight:"#f5f5f5",primaryDark:"#000000",bgPrimary:"#ffffff",bgSecondary:"#ffffff",bgTertiary:"#f8f9fa",textPrimary:"#000000",textSecondary:"#212121",textMuted:"#424242",textInverse:"#ffffff",headerTextColor:"#000000",accentColor:"#e0e0e0",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#1b5e20",warningColor:"#e65100",errorColor:"#b71c1c",infoColor:"#0d47a1",borderColor:"#000000",borderStyle:"sharp",shadowStyle:"bold",contrastLevel:"maximum",borderRadiusSm:"0px",borderRadiusMd:"2px",borderRadiusLg:"4px",borderRadiusXl:"6px",fontFamilyBase:"'Roboto', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1.125rem",lineHeight:"1.7"}],u=Rs({...l}),f=se(!1),h=se(""),p=se(!1),v=se(null);Vt(e,S=>{Object.assign(u,S)},{deep:!0});const g=(S,m=!1)=>{h.value=S,p.value=m,setTimeout(()=>{h.value="",p.value=!1},5e3)},y=async()=>{f.value=!0;try{await i(u),g("Theme saved successfully!")}catch(S){g("Error saving theme: "+S.message,!0)}finally{f.value=!1}},b=async()=>{if(confirm("Are you sure you want to reset the theme to defaults? This cannot be undone."))try{await a(),g("Theme reset to defaults")}catch(S){g("Error resetting theme: "+S.message,!0)}},E=S=>{Object.assign(u,S),Object.keys(S).forEach(m=>{m!=="name"&&m!=="description"&&o(m,S[m])}),g(`Applied ${S.name} theme`)},x=S=>S.primaryColor===u.primaryColor&&S.bgPrimary===u.bgPrimary&&S.textPrimary===u.textPrimary,I=S=>{const T={rounded:{sm:"4px",md:"6px",lg:"8px",xl:"12px"},sharp:{sm:"2px",md:"4px",lg:"6px",xl:"8px"},"extra-rounded":{sm:"8px",md:"12px",lg:"16px",xl:"20px"}}[S];T&&(o("borderRadiusSm",T.sm),o("borderRadiusMd",T.md),o("borderRadiusLg",T.lg),o("borderRadiusXl",T.xl))},D=S=>{const T={none:{sm:"none",md:"none",lg:"none",xl:"none"},subtle:{sm:"0 1px 2px rgba(0, 0, 0, 0.05)",md:"0 2px 4px rgba(0, 0, 0, 0.1)",lg:"0 4px 6px rgba(0, 0, 0, 0.1)",xl:"0 4px 20px rgba(0, 0, 0, 0.15)"},medium:{sm:"0 2px 4px rgba(0, 0, 0, 0.1)",md:"0 4px 8px rgba(0, 0, 0, 0.15)",lg:"0 6px 12px rgba(0, 0, 0, 0.2)",xl:"0 8px 24px rgba(0, 0, 0, 0.25)"},bold:{sm:"0 4px 8px rgba(0, 0, 0, 0.15)",md:"0 8px 16px rgba(0, 0, 0, 0.2)",lg:"0 12px 24px rgba(0, 0, 0, 0.25)",xl:"0 16px 32px rgba(0, 0, 0, 0.3)"}}[S];T&&(o("shadowSm",T.sm),o("shadowMd",T.md),o("shadowLg",T.lg),o("shadowXl",T.xl))},P=S=>{o("fontSizeBase",S);const m=parseFloat(S),T=S.replace(/[\d.]/g,"");o("fontSizeXs",`${(m*.75).toFixed(3)}${T}`),o("fontSizeSm",`${(m*.875).toFixed(3)}${T}`),o("fontSizeLg",`${(m*1.125).toFixed(3)}${T}`),o("fontSizeXl",`${(m*1.25).toFixed(3)}${T}`),o("fontSizeXxl",`${(m*1.5).toFixed(3)}${T}`)},w=S=>{o("contrastLevel",S),S==="high"?u.textPrimary.includes("#")&&(o("textPrimary","#000000"),o("textSecondary","#212121")):S==="maximum"&&(o("textPrimary","#000000"),o("textSecondary","#000000"),o("bgPrimary","#ffffff"),o("bgSecondary","#ffffff"))};return jt(async()=>{try{await s()}catch(S){console.error("Error loading theme:",S)}}),(S,m)=>(O(),B("div",Zpe,[m[72]||(m[72]=d("div",{class:"theme-header"},[d("h2",null," Student Page Theme Customization"),d("p",{class:"theme-description"}," Customize the visual appearance of the student page. Changes are applied in real-time and saved to the database. ")],-1)),X(r)?(O(),B("div",eme,m[38]||(m[38]=[d("div",{class:"spinner"},null,-1),d("p",null,"Loading theme settings...",-1)]))):X(n)?(O(),B("div",tme,[d("p",rme,Y(X(n)),1),d("button",{onClick:m[0]||(m[0]=(...T)=>X(s)&&X(s)(...T)),class:"btn btn-primary"},"Retry")])):(O(),B("div",nme,[d("div",sme,[m[39]||(m[39]=d("h3",null," Quick Theme Selection",-1)),d("div",ame,[(O(),B(Fe,null,He(c,T=>d("div",{key:T.name,onClick:_=>E(T),class:Qe(["theme-preset",{active:x(T)}])},[d("div",ome,[d("div",{class:"color-dot",style:Nr({backgroundColor:T.primaryColor})},null,4),d("div",{class:"color-dot",style:Nr({backgroundColor:T.bgPrimary})},null,4),d("div",{class:"color-dot",style:Nr({backgroundColor:T.textPrimary})},null,4)]),d("div",lme,[d("h4",null,Y(T.name),1),d("p",null,Y(T.description),1)])],10,ime)),64))])]),d("div",cme,[d("button",{onClick:y,disabled:f.value,class:"btn btn-primary"},Y(f.value?" Saving...":" Save Theme"),9,ume),d("button",{onClick:b,disabled:f.value,class:"btn btn-warning"},"  Reset to Default ",8,dme)]),h.value?(O(),B("div",{key:0,class:Qe(["status-message",{error:p.value,success:!p.value}])},Y(h.value),3)):_e("",!0),d("div",fme,[d("section",hme,[m[46]||(m[46]=d("h3",null," Essential Student Page Colors",-1)),d("div",pme,[d("div",mme,[m[40]||(m[40]=d("label",null,"Primary Color (Buttons & Links)",-1)),d("div",gme,[Be(d("input",{type:"color","onUpdate:modelValue":m[1]||(m[1]=T=>u.primaryColor=T),onInput:m[2]||(m[2]=T=>X(o)("primaryColor",T.target.value)),class:"color-picker"},null,544),[[ht,u.primaryColor]]),Be(d("input",{type:"text","onUpdate:modelValue":m[3]||(m[3]=T=>u.primaryColor=T),onInput:m[4]||(m[4]=T=>X(o)("primaryColor",T.target.value)),class:"color-text",placeholder:"#1976d2"},null,544),[[ht,u.primaryColor]])])]),d("div",vme,[m[41]||(m[41]=d("label",null,"Header Text Color",-1)),d("div",yme,[Be(d("input",{type:"color","onUpdate:modelValue":m[5]||(m[5]=T=>u.headerTextColor=T),onInput:m[6]||(m[6]=T=>X(o)("headerTextColor",T.target.value)),class:"color-picker"},null,544),[[ht,u.headerTextColor]]),Be(d("input",{type:"text","onUpdate:modelValue":m[7]||(m[7]=T=>u.headerTextColor=T),onInput:m[8]||(m[8]=T=>X(o)("headerTextColor",T.target.value)),class:"color-text",placeholder:"#1a1a1a"},null,544),[[ht,u.headerTextColor]])])]),d("div",xme,[m[42]||(m[42]=d("label",null,"Background Color",-1)),d("div",Eme,[Be(d("input",{type:"color","onUpdate:modelValue":m[9]||(m[9]=T=>u.bgPrimary=T),onInput:m[10]||(m[10]=T=>X(o)("bgPrimary",T.target.value)),class:"color-picker"},null,544),[[ht,u.bgPrimary]]),Be(d("input",{type:"text","onUpdate:modelValue":m[11]||(m[11]=T=>u.bgPrimary=T),onInput:m[12]||(m[12]=T=>X(o)("bgPrimary",T.target.value)),class:"color-text",placeholder:"#f4f6f9"},null,544),[[ht,u.bgPrimary]])])]),d("div",_me,[m[43]||(m[43]=d("label",null,"Text Color",-1)),d("div",bme,[Be(d("input",{type:"color","onUpdate:modelValue":m[13]||(m[13]=T=>u.textPrimary=T),onInput:m[14]||(m[14]=T=>X(o)("textPrimary",T.target.value)),class:"color-picker"},null,544),[[ht,u.textPrimary]]),Be(d("input",{type:"text","onUpdate:modelValue":m[15]||(m[15]=T=>u.textPrimary=T),onInput:m[16]||(m[16]=T=>X(o)("textPrimary",T.target.value)),class:"color-text",placeholder:"#333333"},null,544),[[ht,u.textPrimary]])])]),d("div",Sme,[m[44]||(m[44]=d("label",null,"Accent Color (Service Pills)",-1)),d("div",Ame,[Be(d("input",{type:"color","onUpdate:modelValue":m[17]||(m[17]=T=>u.accentColor=T),onInput:m[18]||(m[18]=T=>X(o)("accentColor",T.target.value)),class:"color-picker"},null,544),[[ht,u.accentColor]]),Be(d("input",{type:"text","onUpdate:modelValue":m[19]||(m[19]=T=>u.accentColor=T),onInput:m[20]||(m[20]=T=>X(o)("accentColor",T.target.value)),class:"color-text",placeholder:"#e3f2fd"},null,544),[[ht,u.accentColor]])])]),d("div",Tme,[m[45]||(m[45]=d("label",null,"Card Background",-1)),d("div",wme,[Be(d("input",{type:"color","onUpdate:modelValue":m[21]||(m[21]=T=>u.bgSecondary=T),onInput:m[22]||(m[22]=T=>X(o)("bgSecondary",T.target.value)),class:"color-picker"},null,544),[[ht,u.bgSecondary]]),Be(d("input",{type:"text","onUpdate:modelValue":m[23]||(m[23]=T=>u.bgSecondary=T),onInput:m[24]||(m[24]=T=>X(o)("bgSecondary",T.target.value)),class:"color-text",placeholder:"#ffffff"},null,544),[[ht,u.bgSecondary]])])])])]),d("section",Cme,[m[53]||(m[53]=d("h3",null," Typography & Readability",-1)),d("div",Ime,[d("div",kme,[m[48]||(m[48]=d("label",null,"Font Family",-1)),Be(d("select",{"onUpdate:modelValue":m[25]||(m[25]=T=>u.fontFamilyBase=T),onChange:m[26]||(m[26]=T=>X(o)("fontFamilyBase",T.target.value)),class:"style-select"},m[47]||(m[47]=[In('<option value="&#39;Inter&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Inter (Modern &amp; Clean)</option><option value="&#39;Roboto&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Roboto (Google Standard)</option><option value="&#39;Open Sans&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Open Sans (Friendly)</option><option value="&#39;Source Sans Pro&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Source Sans Pro (Professional)</option><option value="&#39;Lato&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Lato (Humanist)</option><option value="&#39;Nunito Sans&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Nunito Sans (Rounded)</option><option value="&#39;System UI&#39;, -apple-system, sans-serif" data-v-5e89749a>System Default</option>',7)]),544),[[cr,u.fontFamilyBase]])]),d("div",Dme,[m[50]||(m[50]=d("label",null,"Base Font Size",-1)),Be(d("select",{"onUpdate:modelValue":m[27]||(m[27]=T=>u.fontSizeBase=T),onChange:m[28]||(m[28]=T=>P(T.target.value)),class:"style-select"},m[49]||(m[49]=[d("option",{value:"0.875rem"},"Small (14px) - Compact",-1),d("option",{value:"1rem"},"Medium (16px) - Standard",-1),d("option",{value:"1.125rem"},"Large (18px) - Comfortable",-1),d("option",{value:"1.25rem"},"Extra Large (20px) - Accessible",-1)]),544),[[cr,u.fontSizeBase]])]),d("div",Pme,[m[52]||(m[52]=d("label",null,"Line Height",-1)),Be(d("select",{"onUpdate:modelValue":m[29]||(m[29]=T=>u.lineHeight=T),onChange:m[30]||(m[30]=T=>X(o)("lineHeight",T.target.value)),class:"style-select"},m[51]||(m[51]=[d("option",{value:"1.4"},"Compact (1.4)",-1),d("option",{value:"1.5"},"Standard (1.5)",-1),d("option",{value:"1.6"},"Comfortable (1.6)",-1),d("option",{value:"1.7"},"Spacious (1.7)",-1)]),544),[[cr,u.lineHeight]])])])]),d("section",Rme,[m[60]||(m[60]=d("h3",null," Visual Style",-1)),d("div",Fme,[d("div",Nme,[m[55]||(m[55]=d("label",null,"Border Radius Style",-1)),Be(d("select",{"onUpdate:modelValue":m[31]||(m[31]=T=>u.borderStyle=T),onChange:m[32]||(m[32]=T=>I(T.target.value)),class:"style-select"},m[54]||(m[54]=[d("option",{value:"rounded"},"Rounded (Modern)",-1),d("option",{value:"sharp"},"Sharp (Professional)",-1),d("option",{value:"extra-rounded"},"Extra Rounded (Friendly)",-1)]),544),[[cr,u.borderStyle]])]),d("div",Ome,[m[57]||(m[57]=d("label",null,"Shadow Style",-1)),Be(d("select",{"onUpdate:modelValue":m[33]||(m[33]=T=>u.shadowStyle=T),onChange:m[34]||(m[34]=T=>D(T.target.value)),class:"style-select"},m[56]||(m[56]=[d("option",{value:"subtle"},"Subtle",-1),d("option",{value:"medium"},"Medium",-1),d("option",{value:"bold"},"Bold",-1),d("option",{value:"none"},"No Shadows",-1)]),544),[[cr,u.shadowStyle]])]),d("div",Mme,[m[59]||(m[59]=d("label",null,"Contrast Level",-1)),Be(d("select",{"onUpdate:modelValue":m[35]||(m[35]=T=>u.contrastLevel=T),onChange:m[36]||(m[36]=T=>w(T.target.value)),class:"style-select"},m[58]||(m[58]=[d("option",{value:"standard"},"Standard Contrast",-1),d("option",{value:"high"},"High Contrast (Accessible)",-1),d("option",{value:"maximum"},"Maximum Contrast",-1)]),544),[[cr,u.contrastLevel]])])])]),d("section",Lme,[m[71]||(m[71]=d("h3",null," Student Page Preview",-1)),d("div",Bme,[d("div",{class:"student-page-mockup",style:Nr({fontFamily:u.fontFamilyBase,fontSize:u.fontSizeBase,lineHeight:u.lineHeight})},[d("div",Ume,[d("h2",{style:Nr({color:u.headerTextColor||u.textPrimary,fontFamily:u.fontFamilyBase})},"Student Management",4),m[61]||(m[61]=In('<div class="mockup-search" data-v-5e89749a><input type="text" placeholder="Search students..." readonly data-v-5e89749a></div><div class="mockup-controls" data-v-5e89749a><button class="mockup-btn primary" data-v-5e89749a> Filters</button><select class="mockup-select" data-v-5e89749a><option data-v-5e89749a>First Name</option></select><div class="mockup-radio-group" data-v-5e89749a><label class="active" data-v-5e89749a>List</label><label data-v-5e89749a>Class</label></div></div>',2))]),d("div",$me,[m[70]||(m[70]=In('<div class="mockup-table-header" data-v-5e89749a><div class="mockup-cell" data-v-5e89749a>Student Name</div><div class="mockup-cell" data-v-5e89749a>Grade</div><div class="mockup-cell" data-v-5e89749a>Case Manager</div><div class="mockup-cell" data-v-5e89749a>Services</div><div class="mockup-cell" data-v-5e89749a>Actions</div></div>',1)),d("div",Vme,[m[62]||(m[62]=d("div",{class:"mockup-cell"},"John Smith",-1)),m[63]||(m[63]=d("div",{class:"mockup-cell"},"9th",-1)),m[64]||(m[64]=d("div",{class:"mockup-cell"},"Ms. Johnson",-1)),d("div",Hme,[d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"Speech",4),d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"OT",4)]),m[65]||(m[65]=d("div",{class:"mockup-cell"},[d("button",{class:"mockup-btn primary small"},"Edit")],-1))]),d("div",jme,[m[66]||(m[66]=d("div",{class:"mockup-cell"},"Jane Doe",-1)),m[67]||(m[67]=d("div",{class:"mockup-cell"},"10th",-1)),m[68]||(m[68]=d("div",{class:"mockup-cell"},"Mr. Wilson",-1)),d("div",Gme,[d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"Resource",4)]),m[69]||(m[69]=d("div",{class:"mockup-cell"},[d("button",{class:"mockup-btn primary small"},"Edit")],-1))])])],4)])])])])),d("input",{ref_key:"fileInput",ref:v,type:"file",accept:".json",style:{display:"none"},onChange:m[37]||(m[37]=(...T)=>S.handleFileImport&&S.handleFileImport(...T))},null,544)]))}},zme=xt(Wme,[["__scopeId","data-v-5e89749a"]]),Kme={class:"secure-pdf-test"},qme={class:"test-section"},Xme={class:"status-grid"},Yme={class:"status-item"},Qme={class:"status-value"},Jme={class:"status-item"},Zme={class:"status-value"},ege={class:"status-item"},tge={class:"status-value"},rge={class:"status-item"},nge={class:"status-value"},sge={class:"test-section"},age=["disabled"],ige=["disabled"],oge={class:"test-section"},lge=["disabled"],cge={key:0,class:"error-message"},uge={key:1,class:"success-message"},dge={key:0,class:"test-section"},fge=["disabled"],hge={key:0,class:"error-message"},pge={key:1,class:"success-message"},mge={class:"test-section"},gge=["disabled"],vge={key:0,class:"error-message"},yge={key:1,class:"success-message"},xge={class:"test-section"},Ege=["disabled"],_ge={key:0,class:"error-message"},bge={key:1,class:"success-message"},Sge={__name:"SecurePdfTest",setup(t){const e=se(null),r=se("test-student-123"),n=se(null),s=se(!1),i=se(!1),a=se(!1),o=se(null),l=se(null),c=se(!1),u=se(null),f=se(null),h=se("Checking..."),p=se("Checking..."),v=se("Checking..."),g=se("Checking..."),y=se(null),b=se(null),E=se(null),x=se(null),{uploadPdf:I,downloadPdf:D,isUploading:P,isDownloading:w}=Jy();be(()=>{var R,F,N;return((R=St.currentUser)==null?void 0:R.role)||((N=(F=St.currentUser)==null?void 0:F.claims)==null?void 0:N.role)||"unknown"});const S=R=>{const F=R.target.files[0];if(F){if(F.type!=="application/pdf"){alert("Please select a PDF file"),R.target.value="";return}e.value=F,b.value=null,y.value=null,o.value=null,l.value=null}},m=async()=>{var R,F;if(!r.value){alert("Please enter a student ID");return}try{s.value=!0;const N=St.currentUser;if(N){const G=await N.getIdTokenResult();console.log(" User token result:",G),console.log(" User role from token:",G.claims.role)}const M=Ze(qe,"students",r.value);(await nr(M)).exists()?alert(" Test student already exists"):(await Ht(M,{app:{studentData:{firstName:"Test",lastName:"Student",grade:"7",plan:"IEP",caseManagerId:((R=St.currentUser)==null?void 0:R.uid)||"test-case-manager"},staffIds:[((F=St.currentUser)==null?void 0:F.uid)||"test-user"],schedule:{periods:{},classServices:[]},providers:{},accommodations:{instruction:"",assessment:""},flags:{flag1:!1,flag2:!1}},createdAt:wn()}),alert(" Test student created successfully!"))}catch(N){alert(` Error creating test student: ${N.message}`),console.error("Error creating test student:",N),N.message.includes("permissions")&&alert(" Admin permissions required. Try using an existing student ID instead.")}finally{s.value=!1}},T=async()=>{var R,F,N,M;try{i.value=!0;const z=_t(qe,"students"),G=or(z,ia(5)),H=await Gt(G);if(H.empty)alert(" No students found in database");else{const j=H.docs.map(ne=>({id:ne.id,...ne.data()}));console.log(" Available students:",j);const K=j[0];r.value=K.id,alert(` Found student: ${((F=(R=K.app)==null?void 0:R.studentData)==null?void 0:F.firstName)||"Unknown"} ${((M=(N=K.app)==null?void 0:N.studentData)==null?void 0:M.lastName)||"Student"} (ID: ${K.id})`)}}catch(z){alert(` Error finding student: ${z.message}`),console.error("Error finding student:",z)}finally{i.value=!1}},_=async()=>{if(!e.value||!r.value){alert("Please select a file and enter a student ID");return}try{b.value=null,y.value=null;const R=await I(e.value,r.value);y.value=R,console.log(" Test PDF uploaded successfully:",R)}catch(R){b.value=R.message,console.error(" Test PDF upload failed:",R)}},A=async()=>{if(!y.value||!r.value){alert("Please upload a PDF first");return}try{E.value=null,x.value=null,await D(y.value,r.value,"test-document.pdf"),x.value=!0,console.log(" Test PDF downloaded successfully")}catch(R){E.value=R.message,console.error(" Test PDF download failed:",R)}},k=async()=>{if(!e.value){alert("Please select a file first");return}try{a.value=!0,o.value=null,l.value=null;const R=mh(wc,`public/test-${Date.now()}.pdf`);await D4(R,e.value),l.value=!0,console.log(" Direct upload successful")}catch(R){o.value=R.message,console.error(" Direct upload failed:",R)}finally{a.value=!1}},U=async()=>{if(!r.value){alert("Please enter a student ID first");return}try{c.value=!0,u.value=null,f.value=null;const{getFunctions:R,httpsCallable:F}=await la(async()=>{const{getFunctions:j,httpsCallable:K}=await Promise.resolve().then(()=>A0);return{getFunctions:j,httpsCallable:K}},void 0),N=R(),M=F(N,"getStudentFileUrl"),z="test-document.pdf";console.log(` Testing cloud function with studentId: ${r.value}, fileName: ${z}`);const G=await M({studentId:r.value,fileName:z});console.log(" Cloud function result:",G.data),f.value=!0;const H=G.data.url;H&&!H.includes("token=")?console.log(" URL is private (no download token)"):console.warn(" URL may not be private")}catch(R){u.value=R.message,console.error(" Cloud function test failed:",R)}finally{c.value=!1}},L=async()=>{try{const R=I0.encryptionKey;h.value=R&&R!=="your-dev-key-here"?" Configured":" Using default key";try{const F=mh(wc,"public/test-access");await R4(F),p.value=" Accessible"}catch(F){F.code==="storage/unauthorized"?p.value=" Limited access (expected)":p.value=" Access denied"}try{const F=Ze(qe,"test","test");await nr(F),v.value=" Accessible"}catch{v.value=" Access denied"}try{const F=St.currentUser;if(F){const N=await F.getIdTokenResult();g.value=N.claims.role||"unknown",console.log(" User role detected:",g.value)}else g.value="not authenticated"}catch(F){g.value="error reading role",console.error("Error reading user role:",F)}}catch(R){console.error("Error checking system status:",R)}};return jt(()=>{L()}),(R,F)=>(O(),B("div",Kme,[F[16]||(F[16]=d("h2",null," Secure PDF System Test",-1)),d("div",qme,[F[5]||(F[5]=d("h3",null,"System Status",-1)),d("div",Xme,[d("div",Yme,[F[1]||(F[1]=d("span",{class:"status-label"},"Encryption Key:",-1)),d("span",Qme,Y(h.value),1)]),d("div",Jme,[F[2]||(F[2]=d("span",{class:"status-label"},"Storage Access:",-1)),d("span",Zme,Y(p.value),1)]),d("div",ege,[F[3]||(F[3]=d("span",{class:"status-label"},"Firestore Access:",-1)),d("span",tge,Y(v.value),1)]),d("div",rge,[F[4]||(F[4]=d("span",{class:"status-label"},"User Role:",-1)),d("span",nge,Y(g.value),1)])])]),d("div",sge,[F[6]||(F[6]=d("h3",null,"Test Student ID",-1)),Be(d("input",{"onUpdate:modelValue":F[0]||(F[0]=N=>r.value=N),placeholder:"Enter test student ID",class:"student-id-input"},null,512),[[ht,r.value]]),F[7]||(F[7]=d("p",{class:"help-text"},"Enter a student ID to test with. You can:",-1)),F[8]||(F[8]=d("ul",{class:"help-text"},[d("li",null,"Use an existing student ID from your database"),d("li",null,"Create a new test student (requires admin permissions)"),d("li",null,'Use "test-student-123" for testing')],-1)),d("button",{onClick:m,disabled:s.value,class:"btn btn-secondary"},Y(s.value?"Creating...":"Create Test Student"),9,age),d("button",{onClick:T,disabled:i.value,class:"btn btn-secondary"},Y(i.value?"Finding...":"Find Existing Student"),9,ige)]),d("div",oge,[F[9]||(F[9]=d("h3",null,"Upload Test PDF",-1)),d("input",{type:"file",accept:"application/pdf",onChange:S,ref_key:"fileInput",ref:n},null,544),d("button",{onClick:_,disabled:!e.value||X(P)},Y(X(P)?" Uploading...":" Upload PDF"),9,lge),b.value?(O(),B("div",cge,Y(b.value),1)):_e("",!0),y.value?(O(),B("div",uge,"  PDF uploaded successfully! Secure filename: "+Y(y.value),1)):_e("",!0)]),y.value?(O(),B("div",dge,[F[10]||(F[10]=d("h3",null,"Download Test PDF",-1)),d("button",{onClick:A,disabled:X(w)},Y(X(w)?" Downloading...":" Download PDF"),9,fge),E.value?(O(),B("div",hge,Y(E.value),1)):_e("",!0),x.value?(O(),B("div",pge,"  PDF downloaded successfully! ")):_e("",!0)])):_e("",!0),d("div",mge,[F[11]||(F[11]=d("h3",null,"Alternative Test: Direct Storage Upload",-1)),F[12]||(F[12]=d("p",{class:"help-text"},"This test bypasses the secure PDF system and uploads directly to storage for comparison.",-1)),d("button",{onClick:k,disabled:!e.value||a.value},Y(a.value?" Uploading...":" Test Direct Upload"),9,gge),o.value?(O(),B("div",vge,Y(o.value),1)):_e("",!0),l.value?(O(),B("div",yge,"  Direct upload successful! This confirms storage permissions are working. ")):_e("",!0)]),d("div",xge,[F[14]||(F[14]=d("h3",null,"Test Cloud Function: Private URL Generation",-1)),F[15]||(F[15]=d("p",{class:"help-text"},"Test if the cloud function can generate private URLs for existing files.",-1)),d("button",{onClick:U,disabled:c.value},Y(c.value?" Testing...":" Test Cloud Function"),9,Ege),u.value?(O(),B("div",_ge,Y(u.value),1)):_e("",!0),f.value?(O(),B("div",bge,F[13]||(F[13]=[Ce("  Cloud function working! Private URL generated successfully. "),d("br",null,null,-1),d("small",null,"URL expires in 5 minutes",-1)]))):_e("",!0)])]))}},Age=xt(Sge,[["__scopeId","data-v-4c041459"]]);async function Tge(){var t;console.log("Starting student ID migration...");try{const e=_t(qe,"students"),r=await Gt(e);console.log(`Found ${r.size} students to migrate`);let n=0,s=0;for(const i of r.docs){const a=i.data(),o=i.id;if(!/^\d+$/.test(o)){console.log(`Student ${o} already uses auto-generated ID, skipping`);continue}const l=o;try{const c=Ze(_t(qe,"students")),u={...a,app:{...a.app,studentData:{...(t=a.app)==null?void 0:t.studentData,ssid:l}},migratedFrom:o,migratedAt:new Date().toISOString()};await Ht(c,u),await po(Ze(qe,"students",o)),console.log(` Migrated student ${o}  ${c.id}`),n++}catch(c){console.error(` Failed to migrate student ${o}:`,c),s++}}return console.log(`Migration complete: ${n} migrated, ${s} errors`),{migratedCount:n,errorCount:s}}catch(e){throw console.error("Migration failed:",e),e}}async function wge(){var t,e;console.log("Verifying migration...");try{const r=_t(qe,"students"),n=await Gt(r);let s=0,i=0;for(const a of n.docs){const o=a.data(),l=a.id,c=(e=(t=o.app)==null?void 0:t.studentData)==null?void 0:e.ssid;c?(console.log(` Student ${l} has SSID: ${c}`),s++):(console.warn(` Student ${l} missing SSID in app data`),i++)}return console.log(`Verification complete: ${s} verified, ${i} issues`),{verifiedCount:s,issuesCount:i}}catch(r){throw console.error("Verification failed:",r),r}}async function Cge(){var s,i,a,o;console.log(" Starting period label migration...");const{getNumber:t}=xo();let e=0,r=0,n=[];try{const l=_t(qe,"students"),c=await Gt(l);e=c.size,console.log(` Found ${e} students to check`);for(const u of c.docs)try{const f=u.data();let h=!1,p={};const v=((i=(s=f.app)==null?void 0:s.schedule)==null?void 0:i.periods)||f.schedule||{};if(Object.entries(v).forEach(([g,y])=>{if(isNaN(parseInt(g))){const b=t(g);if(b)p[b]=y,h=!0,console.log(` Converting "${g}"  ${b} for student ${u.id}`);else{const E=g.match(/^(?:period|per)(\d+)$/i);E?(p[parseInt(E[1])]=y,h=!0,console.log(` Converting "${g}"  ${E[1]} for student ${u.id}`)):(console.warn(` Could not convert period key "${g}" for student ${u.id}`),p[g]=y)}}else p[g]=y}),h){const g={};(o=(a=f.app)==null?void 0:a.schedule)!=null&&o.periods?g["app.schedule.periods"]=p:f.schedule&&(g.schedule=p),Object.keys(g).length>0&&(await Rp(Ze(qe,"students",u.id),g),r++,console.log(` Updated student ${u.id}`))}}catch(f){console.error(` Error processing student ${u.id}:`,f),n.push({studentId:u.id,error:f.message})}return console.log(" Migration completed!"),console.log(" Results:"),console.log(`   - Total students checked: ${e}`),console.log(`   - Students migrated: ${r}`),console.log(`   - Errors: ${n.length}`),n.length>0&&(console.warn(" Errors encountered:"),n.forEach(({studentId:u,error:f})=>{console.warn(`   - ${u}: ${f}`)})),{success:!0,totalStudents:e,migratedStudents:r,errors:n}}catch(l){return console.error(" Migration failed:",l),{success:!1,error:l.message,totalStudents:e,migratedStudents:r,errors:n}}}async function Ige(){var n,s;console.log(" Starting migration preview...");const{getNumber:t}=xo();let e=0,r=[];try{const i=_t(qe,"students"),a=await Gt(i);e=a.size;for(const o of a.docs){const l=o.data(),c=((s=(n=l.app)==null?void 0:n.schedule)==null?void 0:s.periods)||l.schedule||{};let u=[];Object.keys(c).forEach(f=>{if(isNaN(parseInt(f))){const h=t(f);if(h)u.push({from:f,to:h});else{const p=f.match(/^(?:period|per)(\d+)$/i);p&&u.push({from:f,to:parseInt(p[1])})}}}),u.length>0&&r.push({id:o.id,name:`${l.firstName||""} ${l.lastName||""}`.trim(),changes:u})}return console.log(" Migration Preview Results:"),console.log(`   - Total students: ${e}`),console.log(`   - Students needing migration: ${r.length}`),r.length>0&&(console.log("   - Changes needed:"),r.forEach(o=>{console.log(`      ${o.name} (${o.id}):`),o.changes.forEach(l=>{console.log(`        "${l.from}"  ${l.to}`)})})),{totalStudents:e,studentsNeedingMigration:r,changesNeeded:r.length>0}}catch(i){return console.error(" Preview failed:",i),{error:i.message,totalStudents:0,studentsNeedingMigration:[],changesNeeded:!1}}}const kge={class:"testing-view"},Dge={class:"test-section"},Pge={class:"status-grid"},Rge={class:"status-item"},Fge={class:"status-item"},Nge={class:"status-item"},Oge={key:0,class:"test-section"},Mge={class:"settings-display"},Lge={class:"setting-group"},Bge={class:"setting-values"},Uge={class:"setting-group"},$ge={class:"setting-values"},Vge={class:"setting-group"},Hge={class:"setting-values"},jge={class:"setting-group"},Gge={class:"setting-values"},Wge={class:"test-section"},zge={class:"admin-action-btns"},Kge=["disabled"],qge=["disabled"],Xge={class:"test-section"},Yge={class:"integration-test"},Qge={key:0,class:"test-form-container"},Jge={class:"test-section"},Zge={class:"admin-action-btns"},eve=["disabled"],tve=["disabled"],rve={key:0,class:"migration-result"},nve={class:"test-section"},sve={class:"period-migration-controls"},ave=["disabled"],ive=["disabled"],ove={key:0,class:"migration-result"},lve={class:"test-section"},cve={class:"ssid-test-controls"},uve=["disabled"],dve={key:0,class:"ssid-test-result"},fve={class:"test-section"},hve={__name:"TestingView",setup(t){const{appSettings:e,loadAppSettings:r,resetAppSettings:n,loading:s,error:i}=qs(),{labels:a}=xo(),o=se(!1),l=se(!1),c=se(!1),u=se(null),f=se(!1),h=se(null),p=se(!1),v=se(null);jt(async()=>{console.log("TestingView: Component mounted, checking app settings...")});const g=async()=>{try{await r(),console.log("TestingView: Settings reloaded successfully")}catch(S){console.error("TestingView: Error reloading settings:",S)}},y=async()=>{try{await n(),console.log("TestingView: Settings reset successfully")}catch(S){console.error("TestingView: Error resetting settings:",S)}},b=S=>{console.log("TestingView: Test student saved:",S),o.value=!1},E=async()=>{l.value=!0,u.value=null;try{const S=await Tge();u.value=S,console.log("Migration completed:",S)}catch(S){u.value={error:S.message},console.error("Migration failed:",S)}finally{l.value=!1}},x=async()=>{c.value=!0,u.value=null;try{const S=await wge();u.value=S,console.log("Verification completed:",S)}catch(S){u.value={error:S.message},console.error("Verification failed:",S)}finally{c.value=!1}},I=async()=>{f.value=!0,h.value=null;try{const S=[{sourcedId:"123456789",givenName:"John",familyName:"Doe",specialEducation:"true"},{SSID:"987654321",FirstName:"Jane",LastName:"Smith",IEP:"Yes"},{ssid:"555666777",FirstName:"Bob",LastName:"Johnson",iep:"1"},{StateStudentID:"111222333",FirstName:"Alice",LastName:"Brown",504:"true"}],m={aeriesMapping:{},seisMapping:{},ssidExtraction:{},fieldMapping:{}};S.forEach((_,A)=>{const k={};Object.keys(_).forEach(U=>{k[U]=Vv(U)}),m.aeriesMapping[`row_${A}`]=k}),S.forEach((_,A)=>{const k={};Object.keys(_).forEach(U=>{k[U]=Hv(U)}),m.seisMapping[`row_${A}`]=k}),S.forEach((_,A)=>{var U;const k=(U=_.sourcedId||_.SSID||_.ssid||_.StateStudentID||_.stateStudentId)==null?void 0:U.trim();m.ssidExtraction[`row_${A}`]={original:_,extractedSSID:k,success:!!k}});const T=["specialEducation","iep","IEP","plan504","504","disabilities","accommodations"];m.fieldMapping={aeries:T.map(_=>({field:_,mapped:Vv(_)})),seis:T.map(_=>({field:_,mapped:Hv(_)}))},h.value={success:!0,message:"SSID resolution test completed successfully",results:m},console.log("SSID resolution test completed:",m)}catch(S){h.value={success:!1,error:S.message,message:"SSID resolution test failed"},console.error("SSID resolution test failed:",S)}finally{f.value=!1}},D=()=>{h.value=null},P=async()=>{p.value=!0,v.value=null;try{console.log("Starting period label migration preview...");const S=await Ige();S.error?v.value=`Preview failed: ${S.error}`:S.changesNeeded?v.value=`Preview completed: ${S.studentsNeedingMigration.length} students need migration (see console for details)`:v.value="No migration needed - all students already use numeric period keys"}catch(S){console.error("Period migration preview failed:",S),v.value=`Preview error: ${S.message}`}finally{p.value=!1}},w=async()=>{if(confirm("This will update period keys from labels to numbers for all students. Continue?")){p.value=!0,v.value=null;try{console.log("Starting period label migration...");const S=await Cge();S.success?(v.value=`Migration completed: ${S.migratedStudents}/${S.totalStudents} students updated`,S.errors.length>0&&(v.value+=` (${S.errors.length} errors - see console)`)):v.value=`Migration failed: ${S.error}`}catch(S){console.error("Period migration failed:",S),v.value=`Migration error: ${S.message}`}finally{p.value=!1}}};return(S,m)=>{var T,_,A,k,U,L;return O(),B("div",kge,[m[21]||(m[21]=d("h2",null,"App Settings Testing",-1)),d("div",Dge,[m[5]||(m[5]=d("h3",null,"App Settings Status",-1)),d("div",Pge,[d("div",Rge,[m[2]||(m[2]=d("strong",null,"Loading:",-1)),Ce(" "+Y(X(s)?"Yes":"No"),1)]),d("div",Fge,[m[3]||(m[3]=d("strong",null,"Error:",-1)),Ce(" "+Y(X(i)||"None"),1)]),d("div",Nge,[m[4]||(m[4]=d("strong",null,"Loaded:",-1)),Ce(" "+Y(X(e)&&Object.keys(X(e)).length>0?"Yes":"No"),1)])])]),X(e)?(O(),B("div",Oge,[m[10]||(m[10]=d("h3",null,"Current Settings",-1)),d("div",Mge,[d("div",Lge,[d("h4",null,"Grades ("+Y(((T=X(e).grades)==null?void 0:T.length)||0)+")",1),d("div",Bge,Y(((_=X(e).grades)==null?void 0:_.join(", "))||"None configured"),1)]),d("div",Uge,[d("h4",null,"Class Services ("+Y(((A=X(e).classServices)==null?void 0:A.length)||0)+")",1),d("div",$ge,[(O(!0),B(Fe,null,He(X(e).classServices,R=>{var F;return O(),B("div",{key:R.name,class:"service-item"},[d("strong",null,Y(R.name)+":",1),Ce(" "+Y(((F=R.enabledSubcategories)==null?void 0:F.join(", "))||"None enabled"),1)])}),128))])]),d("div",Vge,[d("h4",null,"Service Providers ("+Y(((k=X(e).serviceProviders)==null?void 0:k.length)||0)+")",1),d("div",Hge,Y(((U=X(e).serviceProviders)==null?void 0:U.join(", "))||"None configured"),1)]),d("div",jge,[m[9]||(m[9]=d("h4",null,"Periods",-1)),d("div",Gge,[m[6]||(m[6]=d("strong",null,"Number:",-1)),Ce(" "+Y(X(e).numPeriods||0),1),m[7]||(m[7]=d("br",null,null,-1)),m[8]||(m[8]=d("strong",null,"Labels:",-1)),Ce(" "+Y(((L=X(a))==null?void 0:L.join(", "))||"None"),1)])])])])):_e("",!0),d("div",Wge,[m[11]||(m[11]=d("h3",null,"Test Actions",-1)),d("div",zge,[d("button",{onClick:g,disabled:X(s),class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},Y(X(s)?"Loading...":"Reload Settings"),9,Kge),d("button",{onClick:y,disabled:X(s),class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Reset to Defaults ",8,qge)])]),d("div",Xge,[m[13]||(m[13]=d("h3",null,"Component Integration Test",-1)),d("div",Yge,[m[12]||(m[12]=d("p",null,"This section tests if the StudentForm can access app settings:",-1)),d("button",{onClick:m[0]||(m[0]=R=>o.value=!o.value),class:"btn btn-primary"},Y(o.value?"Hide":"Show")+" Test Student Form ",1),o.value?(O(),B("div",Qge,[Le(Zy,{users:{userRoles:{}},mode:"new",onClose:m[1]||(m[1]=R=>o.value=!1),onSaved:b})])):_e("",!0)])]),d("div",Jge,[m[15]||(m[15]=d("h3",null,"Migration Tools",-1)),d("div",Zge,[d("button",{onClick:E,disabled:l.value,class:"admin-action-btn",style:{"min-width":"160px","max-width":"160px"}},Y(l.value?"Migrating...":"Migrate Student IDs"),9,eve),d("button",{onClick:x,disabled:c.value,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},Y(c.value?"Verifying...":"Verify Migration"),9,tve)]),u.value?(O(),B("div",rve,[m[14]||(m[14]=d("h4",null,"Migration Result:",-1)),d("pre",null,Y(JSON.stringify(u.value,null,2)),1)])):_e("",!0)]),d("div",nve,[m[17]||(m[17]=d("h3",null,"Period Label Migration",-1)),d("div",sve,[d("button",{onClick:P,disabled:p.value,class:"btn btn-secondary"},Y(p.value?"Previewing...":"Preview Period Migration"),9,ave),d("button",{onClick:w,disabled:p.value,class:"btn btn-warning"},Y(p.value?"Migrating...":"Run Period Migration"),9,ive)]),v.value?(O(),B("div",ove,[m[16]||(m[16]=d("h4",null,"Period Migration Result:",-1)),d("p",null,Y(v.value),1)])):_e("",!0)]),d("div",lve,[m[19]||(m[19]=d("h3",null,"SSID Resolution Test",-1)),d("div",cve,[d("button",{onClick:I,disabled:f.value,class:"btn btn-primary"},Y(f.value?"Testing...":"Test SSID Resolution"),9,uve),d("button",{onClick:D,class:"btn btn-secondary"}," Clear Results ")]),h.value?(O(),B("div",dve,[m[18]||(m[18]=d("h4",null,"SSID Resolution Test Result:",-1)),d("pre",null,Y(JSON.stringify(h.value,null,2)),1)])):_e("",!0)]),d("div",fve,[m[20]||(m[20]=d("h3",null," Secure PDF System Test",-1)),Le(Age)])])}}},pve=xt(hve,[["__scopeId","data-v-16ace2fd"]]),Po=se({}),pu=se(!1);function mve(){const t=async()=>{try{const s=Ze(qe,"app_settings","admin_panel_permissions"),i=await nr(s);i.exists()?Po.value=i.data():Po.value=n(),pu.value=!0,console.log("Admin permissions loaded:",Po.value)}catch(s){console.error("Error loading admin permissions:",s),Po.value=n(),pu.value=!0}},e=(s,i)=>!pu.value||!Po.value[s]?!1:i==="admin"?!0:Po.value[s][i]===!0,r=(s,i)=>pu.value?s.filter(a=>i==="admin"?!0:e(a.key,i)):[],n=()=>({dashboard:{school_admin:!0,admin_504:!0,sped_chair:!0},usersAdd:{school_admin:!0,admin_504:!0,sped_chair:!1},usersEdit:{school_admin:!0,admin_504:!0,sped_chair:!0},students:{school_admin:!0,admin_504:!0,sped_chair:!0},addStudents:{school_admin:!0,admin_504:!0,sped_chair:!0},"aide-assignment":{school_admin:!0,admin_504:!0,sped_chair:!0},"aide-schedule":{school_admin:!0,admin_504:!0,sped_chair:!0},"time-table":{school_admin:!0,admin_504:!1,sped_chair:!0},seis:{school_admin:!0,admin_504:!0,sped_chair:!0},aeries:{school_admin:!0,admin_504:!0,sped_chair:!0},"testing-links":{school_admin:!0,admin_504:!1,sped_chair:!0},"teacher-feedback":{school_admin:!0,admin_504:!0,sped_chair:!0},"backup-restore":{school_admin:!0,admin_504:!1,sped_chair:!0},settings:{school_admin:!0,admin_504:!0,sped_chair:!0},permissions:{school_admin:!1,admin_504:!1,sped_chair:!1},"iep-security":{school_admin:!1,admin_504:!1,sped_chair:!1},security:{school_admin:!1,admin_504:!1,sped_chair:!1},"component-health":{school_admin:!1,admin_504:!1,sped_chair:!1}});return{adminPermissions:be(()=>Po.value),permissionsLoaded:be(()=>pu.value),loadPermissions:t,hasPermission:e,getPermittedTabs:r}}const gve={name:"AdminView",components:{TabBar:PG,UserAddForm:VG,UserTable:fW,AdminStudents:NW,StudentBulkImporter:Lz,AdminPermissions:gK,SeisImport:RK,AeriesImport:HK,AeriesAPIConnector:Qq,AppSettings:WX,AdminAideAssignment:EI,AdminTimeTable:tD,AdminAideSchedule:hD,AdminBackupRestore:pD,AdminAuditLogs:Vce,AdminTeacherFeedback:Vue,TestingLinks:Hde,AdminDashboard:S0e,DebugEncryption:mD,SecurityControlCenter:Ohe,ComponentHealthDashboard:Dpe,AdminPermissionsMatrix:Jpe,ThemeManager:zme,TestingView:pve},setup(){const t=Ci(),e=oB(),r=se("dashboard"),n=se("dashboard"),{students:s,fetchStudents:i}=Ii(),{users:a,fetchUsers:o}=_a(),{currentUser:l}=sf(),{loadPermissions:c,getPermittedTabs:u,permissionsLoaded:f}=mve();jt(async()=>{try{await Promise.all([i(),o(),c()]),l.value&&await tn.logSystemAccess("admin_panel_access",{userRole:l.value.role,accessTime:new Date().toISOString(),initialCategory:e.query.category||"dashboard"});const w=e.query.category;w&&b(w)}catch(w){console.error("Error loading data:",w)}});const h=[{key:"dashboard",label:"Dashboard",category:"dashboard"},{key:"usersAdd",label:"Add Users",category:"users-students"},{key:"usersEdit",label:"Manage Users",category:"users-students"},{key:"students",label:"Students",category:"users-students"},{key:"addStudents",label:"Add Students",category:"users-students"},{key:"aide-assignment",label:"Aide Assignment",category:"aide-management"},{key:"aide-schedule",label:"Aide Schedule",category:"aide-management",status:"not-working"},{key:"time-table",label:"Time Table",category:"aide-management"},{key:"seis",label:"SEIS Import",category:"data-integration",status:"not-active"},{key:"aeries",label:"Aeries API & Import",category:"data-integration",status:"not-active"},{key:"testing-links",label:"Testing Links",category:"data-integration"},{key:"teacher-feedback",label:"Teacher Feedback Forms",category:"data-integration"},{key:"backup-restore",label:"Backup & Restore",category:"data-integration"},{key:"permissions",label:"Permissions",category:"system-config"},{key:"settings",label:"App Settings",category:"system-config"},{key:"theme",label:"Theme Customization",category:"system-config"},{key:"audit-logs",label:"Audit Logs",category:"monitoring"},{key:"security",label:"Security Controls",category:"monitoring"},{key:"component-health",label:"Component Debug",category:"monitoring"},{key:"app-settings-testing",label:"App Settings Testing",category:"monitoring"}],p=[{key:"admin-permissions",label:"Admin Panel Permissions",category:"monitoring"}],v=be(()=>{var m;const w=(m=l.value)==null?void 0:m.role;if(!f.value)return[];let S=[...h];return w==="admin"&&(S=[...S,...p]),u(S,w)}),g=w=>v.value.filter(S=>S.category===w),y=w=>g(w).length>0,b=async w=>{n.value=w;const S=g(w);S.length>0&&(r.value=S[0].key),l.value&&await tn.logSystemAccess("admin_category_access",{category:w,userRole:l.value.role,availableTabs:S.map(m=>m.key)})};return{activeTab:r,activeCategory:n,getTabsForCategory:g,categoryHasTabs:y,setActiveCategory:b,handleTabChange:async w=>{r.value=w,l.value&&await tn.logSystemAccess("admin_tab_access",{tab:w,category:n.value,userRole:l.value.role})},goToStudents:()=>{t.push("/students")},goToDashboard:()=>{t.push("/admin/dashboard")},handleGoToCategory:w=>{b(w)},handleBulkImporterClose:()=>{r.value="students"},students:s,userMap:a,currentUser:l,permissionsLoaded:f}}},vve={class:"admin-header"},yve={class:"admin-nav"},xve={class:"admin-actions"},Eve={key:0,class:"sub-tab-container"},_ve={class:"admin-section"},bve={key:0,class:"admin-section"},Sve={key:1,class:"admin-section"},Ave={key:2,class:"admin-section"},Tve={key:3,class:"admin-section"},wve={key:4,class:"admin-section"},Cve={key:5,class:"admin-section"},Ive={key:6,class:"admin-section"},kve={key:7,class:"admin-section"},Dve={key:8,class:"admin-section"},Pve={key:9,class:"admin-section"},Rve={key:10,class:"admin-section"},Fve={key:11,class:"admin-section"},Nve={key:12,class:"admin-section"},Ove={key:13,class:"admin-section"},Mve={key:14,class:"admin-section"},Lve={key:15,class:"admin-section"},Bve={key:16,class:"admin-section"},Uve={key:17,class:"admin-section"},$ve={key:18,class:"admin-section"},Vve={key:19,class:"admin-section"},Hve={key:20,class:"admin-section"},jve={key:21,class:"admin-section"};function Gve(t,e,r,n,s,i){const a=fr("TabBar"),o=fr("AdminDashboard"),l=fr("UserAddForm"),c=fr("UserTable"),u=fr("AdminStudents"),f=fr("StudentBulkImporter"),h=fr("AdminPermissions"),p=fr("AdminAideAssignment"),v=fr("AdminAideSchedule"),g=fr("AdminTimeTable"),y=fr("SeisImport"),b=fr("AeriesAPIConnector"),E=fr("AeriesImport"),x=fr("AppSettings"),I=fr("ThemeManager"),D=fr("TestingLinks"),P=fr("AdminTeacherFeedback"),w=fr("AdminBackupRestore"),S=fr("AdminAuditLogs"),m=fr("DebugEncryption"),T=fr("SecurityControlCenter"),_=fr("ComponentHealthDashboard"),A=fr("AdminPermissionsMatrix"),k=fr("TestingView");return O(),B("div",null,[d("div",vve,[e[8]||(e[8]=d("h1",null,"Admin Panel",-1)),d("div",yve,[n.categoryHasTabs("dashboard")?(O(),B("button",{key:0,onClick:e[0]||(e[0]=U=>n.setActiveCategory("dashboard")),class:Qe([{active:n.activeCategory==="dashboard"},"category-btn"])}," Dashboard ",2)):_e("",!0),n.categoryHasTabs("users-students")?(O(),B("button",{key:1,onClick:e[1]||(e[1]=U=>n.setActiveCategory("users-students")),class:Qe([{active:n.activeCategory==="users-students"},"category-btn"])}," User & Student ",2)):_e("",!0),n.categoryHasTabs("aide-management")?(O(),B("button",{key:2,onClick:e[2]||(e[2]=U=>n.setActiveCategory("aide-management")),class:Qe([{active:n.activeCategory==="aide-management"},"category-btn"])}," Paraprofessionals ",2)):_e("",!0),n.categoryHasTabs("data-integration")?(O(),B("button",{key:3,onClick:e[3]||(e[3]=U=>n.setActiveCategory("data-integration")),class:Qe([{active:n.activeCategory==="data-integration"},"category-btn"])}," Data & Integration ",2)):_e("",!0),n.categoryHasTabs("system-config")?(O(),B("button",{key:4,onClick:e[4]||(e[4]=U=>n.setActiveCategory("system-config")),class:Qe([{active:n.activeCategory==="system-config"},"category-btn"])}," Configuration ",2)):_e("",!0),n.categoryHasTabs("monitoring")?(O(),B("button",{key:5,onClick:e[5]||(e[5]=U=>n.setActiveCategory("monitoring")),class:Qe([{active:n.activeCategory==="monitoring"},"category-btn"])}," System ",2)):_e("",!0)]),d("div",xve,[d("button",{onClick:e[6]||(e[6]=(...U)=>n.goToStudents&&n.goToStudents(...U)),class:"return-btn"},e[7]||(e[7]=[d("span",null,"",-1)]))])]),n.activeCategory?(O(),B("div",Eve,[Le(a,{tabs:n.getTabsForCategory(n.activeCategory),"active-tab":n.activeTab,onTabChange:n.handleTabChange},null,8,["tabs","active-tab","onTabChange"])])):_e("",!0),d("div",_ve,[n.activeTab==="dashboard"?(O(),B("div",bve,[Le(o,{onGoToCategory:n.handleGoToCategory,onGoToStudents:n.goToStudents},null,8,["onGoToCategory","onGoToStudents"])])):_e("",!0),n.activeTab==="usersAdd"?(O(),B("div",Sve,[Le(l)])):_e("",!0),n.activeTab==="usersEdit"?(O(),B("div",Ave,[Le(c)])):_e("",!0),n.activeTab==="students"?(O(),B("div",Tve,[Le(u)])):_e("",!0),n.activeTab==="addStudents"?(O(),B("div",wve,[Le(f,{onClose:n.handleBulkImporterClose,onImported:t.handleStudentsImported},null,8,["onClose","onImported"])])):_e("",!0),n.activeTab==="permissions"?(O(),B("div",Cve,[Le(h)])):_e("",!0),n.activeTab==="aide-assignment"?(O(),B("div",Ive,[Le(p)])):_e("",!0),n.activeTab==="aide-schedule"?(O(),B("div",kve,[Le(v)])):_e("",!0),n.activeTab==="time-table"?(O(),B("div",Dve,[Le(g)])):_e("",!0),n.activeTab==="seis"?(O(),B("div",Pve,[Le(y)])):_e("",!0),n.activeTab==="aeries"?(O(),B("div",Rve,[Le(b),e[9]||(e[9]=d("hr",{style:{margin:"2rem 0",border:"1px solid #ddd"}},null,-1)),Le(E)])):_e("",!0),n.activeTab==="settings"?(O(),B("div",Fve,[Le(x)])):_e("",!0),n.activeTab==="theme"?(O(),B("div",Nve,[Le(I)])):_e("",!0),n.activeTab==="testing-links"?(O(),B("div",Ove,[Le(D,{students:n.students,userMap:n.userMap},null,8,["students","userMap"])])):_e("",!0),n.activeTab==="teacher-feedback"?(O(),B("div",Mve,[Le(P)])):_e("",!0),n.activeTab==="backup-restore"?(O(),B("div",Lve,[Le(w)])):_e("",!0),n.activeTab==="audit-logs"?(O(),B("div",Bve,[Le(S)])):_e("",!0),n.activeTab==="iep-security"?(O(),B("div",Uve,[e[10]||(e[10]=d("h2",null,"IEP Data Security",-1)),Le(m,{"selected-student":t.currentStudent},null,8,["selected-student"])])):_e("",!0),n.activeTab==="security"?(O(),B("div",$ve,[Le(T,{"selected-student":t.currentStudent},null,8,["selected-student"])])):_e("",!0),n.activeTab==="component-health"?(O(),B("div",Vve,[Le(_)])):_e("",!0),n.activeTab==="admin-permissions"?(O(),B("div",Hve,[Le(A)])):_e("",!0),n.activeTab==="app-settings-testing"?(O(),B("div",jve,[Le(k)])):_e("",!0)])])}const Wve=xt(gve,[["render",Gve],["__scopeId","data-v-8a2935bd"]]),zve={class:"aide-schedule-view"},Kve={class:"header"},qve={class:"user-info"},Xve={class:"content"},Yve={key:0,class:"error-message"},Qve={key:1,class:"error-message"},Jve={key:2,class:"loading"},Zve={key:3,class:"schedule-container"},e1e={class:"schedule-display"},t1e={class:"schedule-timeline"},r1e={class:"time-info"},n1e={class:"time"},s1e={class:"type-badge"},a1e={class:"assignment-info"},i1e={key:0},o1e={key:1,class:"no-assignment"},l1e={class:"schedule-editor"},c1e={class:"editor-content"},u1e={class:"time-block-header"},d1e={class:"time"},f1e={class:"type-badge"},h1e={class:"assignment-editor"},p1e=["onUpdate:modelValue"],m1e=["value"],g1e=["value"],v1e={class:"editor-actions"},y1e=["disabled"],x1e={key:0},E1e={key:1},_1e={__name:"AideScheduleView",setup(t){const e=Ci(),r=Fs(),{userList:n,fetchUsers:s}=_a(),{students:i,fetchStudents:a}=Ii(),{loadAppSettings:o,saveAppSettings:l}=qs(),c=se(!0),u=se(!1),f=se({}),h=se({}),p=be(()=>{var P;return((P=r.currentUser)==null?void 0:P.role)==="paraeducator"}),v=be(()=>{var P;return(P=r.currentUser)==null?void 0:P.uid}),g=be(()=>{var P;return((P=n.value)==null?void 0:P.filter(w=>w.role==="teacher"))||[]});async function y(){var P;try{const w=await nr(Ze(qe,"app_settings","global"));if(w.exists()){const S=w.data();f.value=((P=S.timeTables)==null?void 0:P[0])||S.timeTable||{}}}catch(w){console.error("Error loading time table:",w)}}function b(){return f.value.schedule?f.value.schedule.map((P,w)=>({...P,id:P.id||`block-${w}`,assignments:h.value[P.id||`block-${w}`]||{}})):[]}function E(){return b().map(w=>{const S=w.assignments[v.value];let m="";if(S){if(S.startsWith("teacher:")){const T=S.replace("teacher:",""),_=g.value.find(A=>A.id===T);m=_?_.name||_.email:"Unknown Teacher"}else if(S.startsWith("student:")){const T=S.replace("student:",""),_=i.value.find(A=>A.id===T);m=_?`${it(_,"firstName")} ${it(_,"lastName")}`:"Unknown Student"}}return{...w,assignment:m}})}async function x(){try{u.value=!0;const P=await o(),w={...P.detailedAideSchedule};b().forEach(m=>{w[m.id]||(w[m.id]={}),w[m.id][v.value]=m.assignments[v.value]});const S={...P,detailedAideSchedule:w};await l(S),console.log("My schedule saved successfully")}catch(P){console.error("Error saving my schedule:",P)}finally{u.value=!1}}function I(){r.logout(),e.push("/login")}async function D(){try{c.value=!0,await Promise.all([s(),a(),o(),y()]);const P=await nr(Ze(qe,"app_settings","global"));if(P.exists()){const w=P.data();h.value=w.detailedAideSchedule||{}}c.value=!1}catch(P){console.error("Error loading aide schedule data:",P),c.value=!1}}return jt(D),(P,w)=>{var S,m;return O(),B("div",zve,[d("div",Kve,[w[2]||(w[2]=d("h1",null,"My Schedule",-1)),d("div",qve,[d("span",null,Y(((S=X(r).currentUser)==null?void 0:S.name)||((m=X(r).currentUser)==null?void 0:m.email)),1),d("button",{onClick:I,class:"btn btn-secondary"}," Logout ")])]),d("div",Xve,[X(r).currentUser?p.value?c.value?(O(),B("div",Jve," Loading your schedule... ")):(O(),B("div",Zve,[d("div",e1e,[w[7]||(w[7]=d("h2",null,"My Daily Schedule",-1)),d("div",t1e,[(O(!0),B(Fe,null,He(E(),T=>(O(),B("div",{key:T.id,class:Qe(["time-block",T.type])},[d("div",r1e,[d("span",n1e,Y(T.startTime)+" - "+Y(T.endTime),1),d("span",s1e,Y(T.type),1)]),d("div",a1e,[T.assignment?(O(),B("span",i1e,Y(T.assignment),1)):(O(),B("span",o1e,"No Assignment"))])],2))),128))])]),d("div",l1e,[w[9]||(w[9]=d("h2",null,"Edit My Schedule",-1)),d("div",c1e,[(O(!0),B(Fe,null,He(b(),T=>(O(),B("div",{key:T.id,class:"time-block-editor"},[d("div",u1e,[d("span",d1e,Y(T.startTime)+" - "+Y(T.endTime),1),d("span",f1e,Y(T.type),1)]),d("div",h1e,[Be(d("select",{"onUpdate:modelValue":_=>T.assignments[v.value]=_,class:"assignment-select"},[w[8]||(w[8]=d("option",{value:""},"No Assignment",-1)),(O(!0),B(Fe,null,He(g.value,_=>(O(),B("option",{key:_.id,value:`teacher:${_.id}`},Y(_.name||_.email),9,m1e))),128)),(O(!0),B(Fe,null,He(X(i),_=>(O(),B("option",{key:_.id,value:`student:${_.id}`},Y(X(it)(_,"firstName"))+" "+Y(X(it)(_,"lastName")),9,g1e))),128))],8,p1e),[[cr,T.assignments[v.value]]])])]))),128))]),d("div",v1e,[d("button",{onClick:x,class:"btn btn-primary",disabled:u.value},[u.value?(O(),B("span",x1e,"")):(O(),B("span",E1e,"")),Ce(" "+Y(u.value?"Saving...":"Save My Schedule"),1)],8,y1e)])])])):(O(),B("div",Qve,[w[5]||(w[5]=d("h2",null,"Access Denied",-1)),w[6]||(w[6]=d("p",null,"This page is only available to paraeducators.",-1)),d("button",{onClick:w[1]||(w[1]=T=>X(e).push("/")),class:"btn btn-primary"},"Go Home")])):(O(),B("div",Yve,[w[3]||(w[3]=d("h2",null,"Authentication Required",-1)),w[4]||(w[4]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:w[0]||(w[0]=T=>X(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])])}}},b1e=xt(_1e,[["__scopeId","data-v-f2c7a0cd"]]),S1e=t=>{console.log("Router guards setup completed")},A1e=[{path:"/login",name:"Login",component:wG},{path:"/",name:"Home",redirect:"/students"},{path:"/students",name:"Students",component:SG,meta:{requiresAuth:!0,allowedRoles:uB}},{path:"/admin",name:"Admin",component:Wve,meta:{requiresAuth:!0,allowedRoles:iu}},{path:"/admin/aide-assignment",name:"AdminAideAssignment",component:EI,meta:{requiresAuth:!0,allowedRoles:iu}},{path:"/admin/time-table",name:"AdminTimeTable",component:tD,meta:{requiresAuth:!0,allowedRoles:iu}},{path:"/admin/aide-schedule",name:"AdminAideSchedule",component:hD,meta:{requiresAuth:!0,allowedRoles:iu}},{path:"/admin/backup-restore",name:"AdminBackupRestore",component:pD,meta:{requiresAuth:!0,allowedRoles:iu}},{path:"/aide-schedule",name:"AideSchedule",component:b1e,meta:{requiresAuth:!0,allowedRoles:["paraeducator"]}}],T1e=aB({history:NL("/"),routes:A1e});S1e();const Rx=X0(I7),w1e=uR();Rx.use(T1e);Rx.use(w1e);Rx.mount("#app");
//# sourceMappingURL=index-BMkH1AaQ.js.map
