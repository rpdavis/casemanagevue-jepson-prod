(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Uh(t){const e=Object.create(null);for(const r of t.split(","))e[r]=1;return r=>r in e}const Zt={},Zl=[],js=()=>{},VD=()=>!1,Ld=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),a1=t=>t.startsWith("onUpdate:"),xr=Object.assign,i1=(t,e)=>{const r=t.indexOf(e);r>-1&&t.splice(r,1)},HD=Object.prototype.hasOwnProperty,ur=(t,e)=>HD.call(t,e),dt=Array.isArray,ec=t=>Oc(t)==="[object Map]",dl=t=>Oc(t)==="[object Set]",p2=t=>Oc(t)==="[object Date]",jD=t=>Oc(t)==="[object RegExp]",Tt=t=>typeof t=="function",Tr=t=>typeof t=="string",ga=t=>typeof t=="symbol",gr=t=>t!==null&&typeof t=="object",o1=t=>(gr(t)||Tt(t))&&Tt(t.then)&&Tt(t.catch),XS=Object.prototype.toString,Oc=t=>XS.call(t),GD=t=>Oc(t).slice(8,-1),$h=t=>Oc(t)==="[object Object]",l1=t=>Tr(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,tc=Uh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Vh=t=>{const e=Object.create(null);return r=>e[r]||(e[r]=t(r))},WD=/-(\w)/g,Pn=Vh(t=>t.replace(WD,(e,r)=>r?r.toUpperCase():"")),zD=/\B([A-Z])/g,_s=Vh(t=>t.replace(zD,"-$1").toLowerCase()),Bd=Vh(t=>t.charAt(0).toUpperCase()+t.slice(1)),Du=Vh(t=>t?`on${Bd(t)}`:""),ls=(t,e)=>!Object.is(t,e),rc=(t,...e)=>{for(let r=0;r<t.length;r++)t[r](...e)},Bg=(t,e,r,n=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:n,value:r})},L0=t=>{const e=parseFloat(t);return isNaN(e)?t:e},B0=t=>{const e=Tr(t)?Number(t):NaN;return isNaN(e)?t:e};let m2;const Hh=()=>m2||(m2=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),KD="Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt,console,Error,Symbol",qD=Uh(KD);function Nr(t){if(dt(t)){const e={};for(let r=0;r<t.length;r++){const n=t[r],s=Tr(n)?JD(n):Nr(n);if(s)for(const i in s)e[i]=s[i]}return e}else if(Tr(t)||gr(t))return t}const XD=/;(?![^(]*\))/g,YD=/:([^]+)/,QD=/\/\*[^]*?\*\//g;function JD(t){const e={};return t.replace(QD,"").split(XD).forEach(r=>{if(r){const n=r.split(YD);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function Xe(t){let e="";if(Tr(t))e=t;else if(dt(t))for(let r=0;r<t.length;r++){const n=Xe(t[r]);n&&(e+=n+" ")}else if(gr(t))for(const r in t)t[r]&&(e+=r+" ");return e.trim()}function ZD(t){if(!t)return null;let{class:e,style:r}=t;return e&&!Tr(e)&&(t.class=Xe(e)),r&&(t.style=Nr(r)),t}const e3="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",t3=Uh(e3);function YS(t){return!!t||t===""}function r3(t,e){if(t.length!==e.length)return!1;let r=!0;for(let n=0;r&&n<t.length;n++)r=io(t[n],e[n]);return r}function io(t,e){if(t===e)return!0;let r=p2(t),n=p2(e);if(r||n)return r&&n?t.getTime()===e.getTime():!1;if(r=ga(t),n=ga(e),r||n)return t===e;if(r=dt(t),n=dt(e),r||n)return r&&n?r3(t,e):!1;if(r=gr(t),n=gr(e),r||n){if(!r||!n)return!1;const s=Object.keys(t).length,i=Object.keys(e).length;if(s!==i)return!1;for(const a in t){const o=t.hasOwnProperty(a),l=e.hasOwnProperty(a);if(o&&!l||!o&&l||!io(t[a],e[a]))return!1}}return String(t)===String(e)}function jh(t,e){return t.findIndex(r=>io(r,e))}const QS=t=>!!(t&&t.__v_isRef===!0),Z=t=>Tr(t)?t:t==null?"":dt(t)||gr(t)&&(t.toString===XS||!Tt(t.toString))?QS(t)?Z(t.value):JSON.stringify(t,JS,2):String(t),JS=(t,e)=>QS(e)?JS(t,e.value):ec(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((r,[n,s],i)=>(r[Qp(n,i)+" =>"]=s,r),{})}:dl(e)?{[`Set(${e.size})`]:[...e.values()].map(r=>Qp(r))}:ga(e)?Qp(e):gr(e)&&!dt(e)&&!$h(e)?String(e):e,Qp=(t,e="")=>{var r;return ga(t)?`Symbol(${(r=t.description)!=null?r:e})`:t};/**
* @vue/reactivity v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let jn;class c1{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=jn,!e&&jn&&(this.index=(jn.scopes||(jn.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].pause();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,r;if(this.scopes)for(e=0,r=this.scopes.length;e<r;e++)this.scopes[e].resume();for(e=0,r=this.effects.length;e<r;e++)this.effects[e].resume()}}run(e){if(this._active){const r=jn;try{return jn=this,e()}finally{jn=r}}}on(){++this._on===1&&(this.prevScope=jn,jn=this)}off(){this._on>0&&--this._on===0&&(jn=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function u1(t){return new c1(t)}function d1(){return jn}function ZS(t,e=!1){jn&&jn.cleanups.push(t)}let br;const Jp=new WeakSet;class ld{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,jn&&jn.active&&jn.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Jp.has(this)&&(Jp.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||tA(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,g2(this),rA(this);const e=br,r=ha;br=this,ha=!0;try{return this.fn()}finally{nA(this),br=e,ha=r,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)p1(e);this.deps=this.depsTail=void 0,g2(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Jp.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Ug(this)&&this.run()}get dirty(){return Ug(this)}}let eA=0,Pu,Ru;function tA(t,e=!1){if(t.flags|=8,e){t.next=Ru,Ru=t;return}t.next=Pu,Pu=t}function f1(){eA++}function h1(){if(--eA>0)return;if(Ru){let e=Ru;for(Ru=void 0;e;){const r=e.next;e.next=void 0,e.flags&=-9,e=r}}let t;for(;Pu;){let e=Pu;for(Pu=void 0;e;){const r=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){t||(t=n)}e=r}}if(t)throw t}function rA(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function nA(t){let e,r=t.depsTail,n=r;for(;n;){const s=n.prevDep;n.version===-1?(n===r&&(r=s),p1(n),n3(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}t.deps=e,t.depsTail=r}function Ug(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(sA(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function sA(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===cd)||(t.globalVersion=cd,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!Ug(t))))return;t.flags|=2;const e=t.dep,r=br,n=ha;br=t,ha=!0;try{rA(t);const s=t.fn(t._value);(e.version===0||ls(s,t._value))&&(t.flags|=128,t._value=s,e.version++)}catch(s){throw e.version++,s}finally{br=r,ha=n,nA(t),t.flags&=-3}}function p1(t,e=!1){const{dep:r,prevSub:n,nextSub:s}=t;if(n&&(n.nextSub=s,t.prevSub=void 0),s&&(s.prevSub=n,t.nextSub=void 0),r.subs===t&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)p1(i,!0)}!e&&!--r.sc&&r.map&&r.map.delete(r.key)}function n3(t){const{prevDep:e,nextDep:r}=t;e&&(e.nextDep=r,t.prevDep=void 0),r&&(r.prevDep=e,t.nextDep=void 0)}function s3(t,e){t.effect instanceof ld&&(t=t.effect.fn);const r=new ld(t);e&&xr(r,e);try{r.run()}catch(s){throw r.stop(),s}const n=r.run.bind(r);return n.effect=r,n}function a3(t){t.effect.stop()}let ha=!0;const aA=[];function vi(){aA.push(ha),ha=!1}function yi(){const t=aA.pop();ha=t===void 0?!0:t}function g2(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const r=br;br=void 0;try{e()}finally{br=r}}}let cd=0,i3=class{constructor(e,r){this.sub=e,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}};class Gh{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!br||!ha||br===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==br)r=this.activeLink=new i3(br,this),br.deps?(r.prevDep=br.depsTail,br.depsTail.nextDep=r,br.depsTail=r):br.deps=br.depsTail=r,iA(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=br.depsTail,r.nextDep=void 0,br.depsTail.nextDep=r,br.depsTail=r,br.deps===r&&(br.deps=n)}return r}trigger(e){this.version++,cd++,this.notify(e)}notify(e){f1();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{h1()}}}function iA(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)iA(n)}const r=t.dep.subs;r!==t&&(t.prevSub=r,r&&(r.nextSub=t)),t.dep.subs=t}}const U0=new WeakMap,Vo=Symbol(""),$g=Symbol(""),ud=Symbol("");function zn(t,e,r){if(ha&&br){let n=U0.get(t);n||U0.set(t,n=new Map);let s=n.get(r);s||(n.set(r,s=new Gh),s.map=n,s.key=r),s.track()}}function ei(t,e,r,n,s,i){const a=U0.get(t);if(!a){cd++;return}const o=l=>{l&&l.trigger()};if(f1(),e==="clear")a.forEach(o);else{const l=dt(t),c=l&&l1(r);if(l&&r==="length"){const u=Number(n);a.forEach((f,h)=>{(h==="length"||h===ud||!ga(h)&&h>=u)&&o(f)})}else switch((r!==void 0||a.has(void 0))&&o(a.get(r)),c&&o(a.get(ud)),e){case"add":l?c&&o(a.get("length")):(o(a.get(Vo)),ec(t)&&o(a.get($g)));break;case"delete":l||(o(a.get(Vo)),ec(t)&&o(a.get($g)));break;case"set":ec(t)&&o(a.get(Vo));break}}h1()}function o3(t,e){const r=U0.get(t);return r&&r.get(e)}function Rl(t){const e=Yt(t);return e===t?e:(zn(e,"iterate",ud),Fs(t)?e:e.map(kn))}function Wh(t){return zn(t=Yt(t),"iterate",ud),t}const l3={__proto__:null,[Symbol.iterator](){return Zp(this,Symbol.iterator,kn)},concat(...t){return Rl(this).concat(...t.map(e=>dt(e)?Rl(e):e))},entries(){return Zp(this,"entries",t=>(t[1]=kn(t[1]),t))},every(t,e){return Ya(this,"every",t,e,void 0,arguments)},filter(t,e){return Ya(this,"filter",t,e,r=>r.map(kn),arguments)},find(t,e){return Ya(this,"find",t,e,kn,arguments)},findIndex(t,e){return Ya(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return Ya(this,"findLast",t,e,kn,arguments)},findLastIndex(t,e){return Ya(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return Ya(this,"forEach",t,e,void 0,arguments)},includes(...t){return em(this,"includes",t)},indexOf(...t){return em(this,"indexOf",t)},join(t){return Rl(this).join(t)},lastIndexOf(...t){return em(this,"lastIndexOf",t)},map(t,e){return Ya(this,"map",t,e,void 0,arguments)},pop(){return ru(this,"pop")},push(...t){return ru(this,"push",t)},reduce(t,...e){return v2(this,"reduce",t,e)},reduceRight(t,...e){return v2(this,"reduceRight",t,e)},shift(){return ru(this,"shift")},some(t,e){return Ya(this,"some",t,e,void 0,arguments)},splice(...t){return ru(this,"splice",t)},toReversed(){return Rl(this).toReversed()},toSorted(t){return Rl(this).toSorted(t)},toSpliced(...t){return Rl(this).toSpliced(...t)},unshift(...t){return ru(this,"unshift",t)},values(){return Zp(this,"values",kn)}};function Zp(t,e,r){const n=Wh(t),s=n[e]();return n!==t&&!Fs(t)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=r(i.value)),i}),s}const c3=Array.prototype;function Ya(t,e,r,n,s,i){const a=Wh(t),o=a!==t&&!Fs(t),l=a[e];if(l!==c3[e]){const f=l.apply(t,i);return o?kn(f):f}let c=r;a!==t&&(o?c=function(f,h){return r.call(this,kn(f),h,t)}:r.length>2&&(c=function(f,h){return r.call(this,f,h,t)}));const u=l.call(a,c,n);return o&&s?s(u):u}function v2(t,e,r,n){const s=Wh(t);let i=r;return s!==t&&(Fs(t)?r.length>3&&(i=function(a,o,l){return r.call(this,a,o,l,t)}):i=function(a,o,l){return r.call(this,a,kn(o),l,t)}),s[e](i,...n)}function em(t,e,r){const n=Yt(t);zn(n,"iterate",ud);const s=n[e](...r);return(s===-1||s===!1)&&qh(r[0])?(r[0]=Yt(r[0]),n[e](...r)):s}function ru(t,e,r=[]){vi(),f1();const n=Yt(t)[e].apply(t,r);return h1(),yi(),n}const u3=Uh("__proto__,__v_isRef,__isVue"),oA=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(ga));function d3(t){ga(t)||(t=String(t));const e=Yt(this);return zn(e,"has",t),e.hasOwnProperty(t)}class lA{constructor(e=!1,r=!1){this._isReadonly=e,this._isShallow=r}get(e,r,n){if(r==="__v_skip")return e.__v_skip;const s=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(s?i?pA:hA:i?fA:dA).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const a=dt(e);if(!s){let l;if(a&&(l=l3[r]))return l;if(r==="hasOwnProperty")return d3}const o=Reflect.get(e,r,Cr(e)?e:n);return(ga(r)?oA.has(r):u3(r))||(s||zn(e,"get",r),i)?o:Cr(o)?a&&l1(r)?o:o.value:gr(o)?s?g1(o):As(o):o}}class cA extends lA{constructor(e=!1){super(!1,e)}set(e,r,n,s){let i=e[r];if(!this._isShallow){const l=xi(i);if(!Fs(n)&&!xi(n)&&(i=Yt(i),n=Yt(n)),!dt(e)&&Cr(i)&&!Cr(n))return l?!1:(i.value=n,!0)}const a=dt(e)&&l1(r)?Number(r)<e.length:ur(e,r),o=Reflect.set(e,r,n,Cr(e)?e:s);return e===Yt(s)&&(a?ls(n,i)&&ei(e,"set",r,n):ei(e,"add",r,n)),o}deleteProperty(e,r){const n=ur(e,r);e[r];const s=Reflect.deleteProperty(e,r);return s&&n&&ei(e,"delete",r,void 0),s}has(e,r){const n=Reflect.has(e,r);return(!ga(r)||!oA.has(r))&&zn(e,"has",r),n}ownKeys(e){return zn(e,"iterate",dt(e)?"length":Vo),Reflect.ownKeys(e)}}class uA extends lA{constructor(e=!1){super(!0,e)}set(e,r){return!0}deleteProperty(e,r){return!0}}const f3=new cA,h3=new uA,p3=new cA(!0),m3=new uA(!0),Vg=t=>t,wf=t=>Reflect.getPrototypeOf(t);function g3(t,e,r){return function(...n){const s=this.__v_raw,i=Yt(s),a=ec(i),o=t==="entries"||t===Symbol.iterator&&a,l=t==="keys"&&a,c=s[t](...n),u=r?Vg:e?$0:kn;return!e&&zn(i,"iterate",l?$g:Vo),{next(){const{value:f,done:h}=c.next();return h?{value:f,done:h}:{value:o?[u(f[0]),u(f[1])]:u(f),done:h}},[Symbol.iterator](){return this}}}}function Cf(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function v3(t,e){const r={get(s){const i=this.__v_raw,a=Yt(i),o=Yt(s);t||(ls(s,o)&&zn(a,"get",s),zn(a,"get",o));const{has:l}=wf(a),c=e?Vg:t?$0:kn;if(l.call(a,s))return c(i.get(s));if(l.call(a,o))return c(i.get(o));i!==a&&i.get(s)},get size(){const s=this.__v_raw;return!t&&zn(Yt(s),"iterate",Vo),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,a=Yt(i),o=Yt(s);return t||(ls(s,o)&&zn(a,"has",s),zn(a,"has",o)),s===o?i.has(s):i.has(s)||i.has(o)},forEach(s,i){const a=this,o=a.__v_raw,l=Yt(o),c=e?Vg:t?$0:kn;return!t&&zn(l,"iterate",Vo),o.forEach((u,f)=>s.call(i,c(u),c(f),a))}};return xr(r,t?{add:Cf("add"),set:Cf("set"),delete:Cf("delete"),clear:Cf("clear")}:{add(s){!e&&!Fs(s)&&!xi(s)&&(s=Yt(s));const i=Yt(this);return wf(i).has.call(i,s)||(i.add(s),ei(i,"add",s,s)),this},set(s,i){!e&&!Fs(i)&&!xi(i)&&(i=Yt(i));const a=Yt(this),{has:o,get:l}=wf(a);let c=o.call(a,s);c||(s=Yt(s),c=o.call(a,s));const u=l.call(a,s);return a.set(s,i),c?ls(i,u)&&ei(a,"set",s,i):ei(a,"add",s,i),this},delete(s){const i=Yt(this),{has:a,get:o}=wf(i);let l=a.call(i,s);l||(s=Yt(s),l=a.call(i,s)),o&&o.call(i,s);const c=i.delete(s);return l&&ei(i,"delete",s,void 0),c},clear(){const s=Yt(this),i=s.size!==0,a=s.clear();return i&&ei(s,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(s=>{r[s]=g3(s,t,e)}),r}function zh(t,e){const r=v3(t,e);return(n,s,i)=>s==="__v_isReactive"?!t:s==="__v_isReadonly"?t:s==="__v_raw"?n:Reflect.get(ur(r,s)&&s in n?r:n,s,i)}const y3={get:zh(!1,!1)},x3={get:zh(!1,!0)},E3={get:zh(!0,!1)},_3={get:zh(!0,!0)},dA=new WeakMap,fA=new WeakMap,hA=new WeakMap,pA=new WeakMap;function b3(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function S3(t){return t.__v_skip||!Object.isExtensible(t)?0:b3(GD(t))}function As(t){return xi(t)?t:Kh(t,!1,f3,y3,dA)}function m1(t){return Kh(t,!1,p3,x3,fA)}function g1(t){return Kh(t,!0,h3,E3,hA)}function A3(t){return Kh(t,!0,m3,_3,pA)}function Kh(t,e,r,n,s){if(!gr(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=S3(t);if(i===0)return t;const a=s.get(t);if(a)return a;const o=new Proxy(t,i===2?n:r);return s.set(t,o),o}function Fa(t){return xi(t)?Fa(t.__v_raw):!!(t&&t.__v_isReactive)}function xi(t){return!!(t&&t.__v_isReadonly)}function Fs(t){return!!(t&&t.__v_isShallow)}function qh(t){return t?!!t.__v_raw:!1}function Yt(t){const e=t&&t.__v_raw;return e?Yt(e):t}function Xh(t){return!ur(t,"__v_skip")&&Object.isExtensible(t)&&Bg(t,"__v_skip",!0),t}const kn=t=>gr(t)?As(t):t,$0=t=>gr(t)?g1(t):t;function Cr(t){return t?t.__v_isRef===!0:!1}function se(t){return mA(t,!1)}function v1(t){return mA(t,!0)}function mA(t,e){return Cr(t)?t:new T3(t,e)}class T3{constructor(e,r){this.dep=new Gh,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?e:Yt(e),this._value=r?e:kn(e),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(e){const r=this._rawValue,n=this.__v_isShallow||Fs(e)||xi(e);e=n?e:Yt(e),ls(e,r)&&(this._rawValue=e,this._value=n?e:kn(e),this.dep.trigger())}}function w3(t){t.dep&&t.dep.trigger()}function q(t){return Cr(t)?t.value:t}function C3(t){return Tt(t)?t():q(t)}const I3={get:(t,e,r)=>e==="__v_raw"?t:q(Reflect.get(t,e,r)),set:(t,e,r,n)=>{const s=t[e];return Cr(s)&&!Cr(r)?(s.value=r,!0):Reflect.set(t,e,r,n)}};function y1(t){return Fa(t)?t:new Proxy(t,I3)}class k3{constructor(e){this.__v_isRef=!0,this._value=void 0;const r=this.dep=new Gh,{get:n,set:s}=e(r.track.bind(r),r.trigger.bind(r));this._get=n,this._set=s}get value(){return this._value=this._get()}set value(e){this._set(e)}}function gA(t){return new k3(t)}function vA(t){const e=dt(t)?new Array(t.length):{};for(const r in t)e[r]=yA(t,r);return e}class D3{constructor(e,r,n){this._object=e,this._key=r,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const e=this._object[this._key];return this._value=e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return o3(Yt(this._object),this._key)}}class P3{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function R3(t,e,r){return Cr(t)?t:Tt(t)?new P3(t):gr(t)&&arguments.length>1?yA(t,e,r):se(t)}function yA(t,e,r){const n=t[e];return Cr(n)?n:new D3(t,e,r)}class F3{constructor(e,r,n){this.fn=e,this.setter=r,this._value=void 0,this.dep=new Gh(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=cd-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&br!==this)return tA(this,!0),!0}get value(){const e=this.dep.track();return sA(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function N3(t,e,r=!1){let n,s;return Tt(t)?n=t:(n=t.get,s=t.set),new F3(n,s,r)}const O3={GET:"get",HAS:"has",ITERATE:"iterate"},M3={SET:"set",ADD:"add",DELETE:"delete",CLEAR:"clear"},If={},V0=new WeakMap;let Hi;function L3(){return Hi}function xA(t,e=!1,r=Hi){if(r){let n=V0.get(r);n||V0.set(r,n=[]),n.push(t)}}function B3(t,e,r=Zt){const{immediate:n,deep:s,once:i,scheduler:a,augmentJob:o,call:l}=r,c=A=>s?A:Fs(A)||s===!1||s===0?ti(A,1):ti(A);let u,f,h,p,g=!1,y=!1;if(Cr(t)?(f=()=>t.value,g=Fs(t)):Fa(t)?(f=()=>c(t),g=!0):dt(t)?(y=!0,g=t.some(A=>Fa(A)||Fs(A)),f=()=>t.map(A=>{if(Cr(A))return A.value;if(Fa(A))return c(A);if(Tt(A))return l?l(A,2):A()})):Tt(t)?e?f=l?()=>l(t,2):t:f=()=>{if(h){vi();try{h()}finally{yi()}}const A=Hi;Hi=u;try{return l?l(t,3,[p]):t(p)}finally{Hi=A}}:f=js,e&&s){const A=f,D=s===!0?1/0:s;f=()=>ti(A(),D)}const E=d1(),b=()=>{u.stop(),E&&E.active&&i1(E.effects,u)};if(i&&e){const A=e;e=(...D)=>{A(...D),b()}}let _=y?new Array(t.length).fill(If):If;const v=A=>{if(!(!(u.flags&1)||!u.dirty&&!A))if(e){const D=u.run();if(s||g||(y?D.some((k,T)=>ls(k,_[T])):ls(D,_))){h&&h();const k=Hi;Hi=u;try{const T=[D,_===If?void 0:y&&_[0]===If?[]:_,p];_=D,l?l(e,3,T):e(...T)}finally{Hi=k}}}else u.run()};return o&&o(v),u=new ld(f),u.scheduler=a?()=>a(v,!1):v,p=A=>xA(A,!1,u),h=u.onStop=()=>{const A=V0.get(u);if(A){if(l)l(A,4);else for(const D of A)D();V0.delete(u)}},e?n?v(!0):_=u.run():a?a(v.bind(null,!0),!0):u.run(),b.pause=u.pause.bind(u),b.resume=u.resume.bind(u),b.stop=b,b}function ti(t,e=1/0,r){if(e<=0||!gr(t)||t.__v_skip||(r=r||new Set,r.has(t)))return t;if(r.add(t),e--,Cr(t))ti(t.value,e,r);else if(dt(t))for(let n=0;n<t.length;n++)ti(t[n],e,r);else if(dl(t)||ec(t))t.forEach(n=>{ti(n,e,r)});else if($h(t)){for(const n in t)ti(t[n],e,r);for(const n of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,n)&&ti(t[n],e,r)}return t}/**
* @vue/runtime-core v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const EA=[];function U3(t){EA.push(t)}function $3(){EA.pop()}function V3(t,e){}const H3={SETUP_FUNCTION:0,0:"SETUP_FUNCTION",RENDER_FUNCTION:1,1:"RENDER_FUNCTION",NATIVE_EVENT_HANDLER:5,5:"NATIVE_EVENT_HANDLER",COMPONENT_EVENT_HANDLER:6,6:"COMPONENT_EVENT_HANDLER",VNODE_HOOK:7,7:"VNODE_HOOK",DIRECTIVE_HOOK:8,8:"DIRECTIVE_HOOK",TRANSITION_HOOK:9,9:"TRANSITION_HOOK",APP_ERROR_HANDLER:10,10:"APP_ERROR_HANDLER",APP_WARN_HANDLER:11,11:"APP_WARN_HANDLER",FUNCTION_REF:12,12:"FUNCTION_REF",ASYNC_COMPONENT_LOADER:13,13:"ASYNC_COMPONENT_LOADER",SCHEDULER:14,14:"SCHEDULER",COMPONENT_UPDATE:15,15:"COMPONENT_UPDATE",APP_UNMOUNT_CLEANUP:16,16:"APP_UNMOUNT_CLEANUP"},j3={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",0:"setup function",1:"render function",2:"watcher getter",3:"watcher callback",4:"watcher cleanup function",5:"native event handler",6:"component event handler",7:"vnode hook",8:"directive hook",9:"transition hook",10:"app errorHandler",11:"app warnHandler",12:"ref function",13:"async component loader",14:"scheduler flush",15:"component update",16:"app unmount cleanup function"};function Mc(t,e,r,n){try{return n?t(...n):t()}catch(s){fl(s,e,r)}}function zs(t,e,r,n){if(Tt(t)){const s=Mc(t,e,r,n);return s&&o1(s)&&s.catch(i=>{fl(i,e,r)}),s}if(dt(t)){const s=[];for(let i=0;i<t.length;i++)s.push(zs(t[i],e,r,n));return s}}function fl(t,e,r,n=!0){const s=e?e.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=e&&e.appContext.config||Zt;if(e){let o=e.parent;const l=e.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;o;){const u=o.ec;if(u){for(let f=0;f<u.length;f++)if(u[f](t,l,c)===!1)return}o=o.parent}if(i){vi(),Mc(i,null,10,[t,l,c]),yi();return}}G3(t,r,s,n,a)}function G3(t,e,r,n=!0,s=!1){if(s)throw t;console.error(t)}const cs=[];let ka=-1;const nc=[];let ji=null,$l=0;const _A=Promise.resolve();let H0=null;function hl(t){const e=H0||_A;return t?e.then(this?t.bind(this):t):e}function W3(t){let e=ka+1,r=cs.length;for(;e<r;){const n=e+r>>>1,s=cs[n],i=fd(s);i<t||i===t&&s.flags&2?e=n+1:r=n}return e}function x1(t){if(!(t.flags&1)){const e=fd(t),r=cs[cs.length-1];!r||!(t.flags&2)&&e>=fd(r)?cs.push(t):cs.splice(W3(e),0,t),t.flags|=1,bA()}}function bA(){H0||(H0=_A.then(SA))}function dd(t){dt(t)?nc.push(...t):ji&&t.id===-1?ji.splice($l+1,0,t):t.flags&1||(nc.push(t),t.flags|=1),bA()}function y2(t,e,r=ka+1){for(;r<cs.length;r++){const n=cs[r];if(n&&n.flags&2){if(t&&n.id!==t.uid)continue;cs.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function j0(t){if(nc.length){const e=[...new Set(nc)].sort((r,n)=>fd(r)-fd(n));if(nc.length=0,ji){ji.push(...e);return}for(ji=e,$l=0;$l<ji.length;$l++){const r=ji[$l];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}ji=null,$l=0}}const fd=t=>t.id==null?t.flags&2?-1:1/0:t.id;function SA(t){try{for(ka=0;ka<cs.length;ka++){const e=cs[ka];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),Mc(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;ka<cs.length;ka++){const e=cs[ka];e&&(e.flags&=-2)}ka=-1,cs.length=0,j0(),H0=null,(cs.length||nc.length)&&SA()}}let Vl,kf=[];function AA(t,e){var r,n;Vl=t,Vl?(Vl.enabled=!0,kf.forEach(({event:s,args:i})=>Vl.emit(s,...i)),kf=[]):typeof window<"u"&&window.HTMLElement&&!((n=(r=window.navigator)==null?void 0:r.userAgent)!=null&&n.includes("jsdom"))?((e.__VUE_DEVTOOLS_HOOK_REPLAY__=e.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(i=>{AA(i,e)}),setTimeout(()=>{Vl||(e.__VUE_DEVTOOLS_HOOK_REPLAY__=null,kf=[])},3e3)):kf=[]}let fn=null,Yh=null;function hd(t){const e=fn;return fn=t,Yh=t&&t.type.__scopeId||null,e}function z3(t){Yh=t}function K3(){Yh=null}const q3=t=>Qh;function Qh(t,e=fn,r){if(!e||t._n)return t;const n=(...s)=>{n._d&&Xg(-1);const i=hd(e);let a;try{a=t(...s)}finally{hd(i),n._d&&Xg(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function Ne(t,e){if(fn===null)return t;const r=Hd(fn),n=t.dirs||(t.dirs=[]);for(let s=0;s<e.length;s++){let[i,a,o,l=Zt]=e[s];i&&(Tt(i)&&(i={mounted:i,updated:i}),i.deep&&ti(a),n.push({dir:i,instance:r,value:a,oldValue:void 0,arg:o,modifiers:l}))}return t}function Da(t,e,r,n){const s=t.dirs,i=e&&e.dirs;for(let a=0;a<s.length;a++){const o=s[a];i&&(o.oldValue=i[a].value);let l=o.dir[n];l&&(vi(),zs(l,r,8,[t.el,o,t,e]),yi())}}const TA=Symbol("_vte"),wA=t=>t.__isTeleport,Fu=t=>t&&(t.disabled||t.disabled===""),x2=t=>t&&(t.defer||t.defer===""),E2=t=>typeof SVGElement<"u"&&t instanceof SVGElement,_2=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,Hg=(t,e)=>{const r=t&&t.to;return Tr(r)?e?e(r):null:r},CA={name:"Teleport",__isTeleport:!0,process(t,e,r,n,s,i,a,o,l,c){const{mc:u,pc:f,pbc:h,o:{insert:p,querySelector:g,createText:y,createComment:E}}=c,b=Fu(e.props);let{shapeFlag:_,children:v,dynamicChildren:A}=e;if(t==null){const D=e.el=y(""),k=e.anchor=y("");p(D,r,n),p(k,r,n);const T=(m,S)=>{_&16&&(s&&s.isCE&&(s.ce._teleportTarget=m),u(v,m,S,s,i,a,o,l))},x=()=>{const m=e.target=Hg(e.props,g),S=IA(m,e,y,p);m&&(a!=="svg"&&E2(m)?a="svg":a!=="mathml"&&_2(m)&&(a="mathml"),b||(T(m,S),m0(e,!1)))};b&&(T(r,k),m0(e,!0)),x2(e.props)?(e.el.__isMounted=!1,cn(()=>{x(),delete e.el.__isMounted},i)):x()}else{if(x2(e.props)&&t.el.__isMounted===!1){cn(()=>{CA.process(t,e,r,n,s,i,a,o,l,c)},i);return}e.el=t.el,e.targetStart=t.targetStart;const D=e.anchor=t.anchor,k=e.target=t.target,T=e.targetAnchor=t.targetAnchor,x=Fu(t.props),m=x?r:k,S=x?D:T;if(a==="svg"||E2(k)?a="svg":(a==="mathml"||_2(k))&&(a="mathml"),A?(h(t.dynamicChildren,A,m,s,i,a,o),P1(t,e,!0)):l||f(t,e,m,S,s,i,a,o,!1),b)x?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):Df(e,r,D,c,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const I=e.target=Hg(e.props,g);I&&Df(e,I,null,c,0)}else x&&Df(e,k,T,c,1);m0(e,b)}},remove(t,e,r,{um:n,o:{remove:s}},i){const{shapeFlag:a,children:o,anchor:l,targetStart:c,targetAnchor:u,target:f,props:h}=t;if(f&&(s(c),s(u)),i&&s(l),a&16){const p=i||!Fu(h);for(let g=0;g<o.length;g++){const y=o[g];n(y,e,r,p,!!y.dynamicChildren)}}},move:Df,hydrate:X3};function Df(t,e,r,{o:{insert:n},m:s},i=2){i===0&&n(t.targetAnchor,e,r);const{el:a,anchor:o,shapeFlag:l,children:c,props:u}=t,f=i===2;if(f&&n(a,e,r),(!f||Fu(u))&&l&16)for(let h=0;h<c.length;h++)s(c[h],e,r,2);f&&n(o,e,r)}function X3(t,e,r,n,s,i,{o:{nextSibling:a,parentNode:o,querySelector:l,insert:c,createText:u}},f){const h=e.target=Hg(e.props,l);if(h){const p=Fu(e.props),g=h._lpa||h.firstChild;if(e.shapeFlag&16)if(p)e.anchor=f(a(t),e,o(t),r,n,s,i),e.targetStart=g,e.targetAnchor=g&&a(g);else{e.anchor=a(t);let y=g;for(;y;){if(y&&y.nodeType===8){if(y.data==="teleport start anchor")e.targetStart=y;else if(y.data==="teleport anchor"){e.targetAnchor=y,h._lpa=e.targetAnchor&&a(e.targetAnchor);break}}y=a(y)}e.targetAnchor||IA(h,e,u,c),f(g&&a(g),e,h,r,n,s,i)}m0(e,p)}return e.anchor&&a(e.anchor)}const Y3=CA;function m0(t,e){const r=t.ctx;if(r&&r.ut){let n,s;for(e?(n=t.el,s=t.anchor):(n=t.targetStart,s=t.targetAnchor);n&&n!==s;)n.nodeType===1&&n.setAttribute("data-v-owner",r.uid),n=n.nextSibling;r.ut()}}function IA(t,e,r,n){const s=e.targetStart=r(""),i=e.targetAnchor=r("");return s[TA]=i,t&&(n(s,t),n(i,t)),i}const Gi=Symbol("_leaveCb"),Pf=Symbol("_enterCb");function E1(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Gt(()=>{t.isMounted=!0}),tp(()=>{t.isUnmounting=!0}),t}const Ls=[Function,Array],_1={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ls,onEnter:Ls,onAfterEnter:Ls,onEnterCancelled:Ls,onBeforeLeave:Ls,onLeave:Ls,onAfterLeave:Ls,onLeaveCancelled:Ls,onBeforeAppear:Ls,onAppear:Ls,onAfterAppear:Ls,onAppearCancelled:Ls},kA=t=>{const e=t.subTree;return e.component?kA(e.component):e},Q3={name:"BaseTransition",props:_1,setup(t,{slots:e}){const r=Xs(),n=E1();return()=>{const s=e.default&&Jh(e.default(),!0);if(!s||!s.length)return;const i=DA(s),a=Yt(t),{mode:o}=a;if(n.isLeaving)return tm(i);const l=b2(i);if(!l)return tm(i);let c=vc(l,a,n,r,f=>c=f);l.type!==Xr&&Ei(l,c);let u=r.subTree&&b2(r.subTree);if(u&&u.type!==Xr&&!ia(l,u)&&kA(r).type!==Xr){let f=vc(u,a,n,r);if(Ei(u,f),o==="out-in"&&l.type!==Xr)return n.isLeaving=!0,f.afterLeave=()=>{n.isLeaving=!1,r.job.flags&8||r.update(),delete f.afterLeave,u=void 0},tm(i);o==="in-out"&&l.type!==Xr?f.delayLeave=(h,p,g)=>{const y=RA(n,u);y[String(u.key)]=u,h[Gi]=()=>{p(),h[Gi]=void 0,delete c.delayedLeave,u=void 0},c.delayedLeave=()=>{g(),delete c.delayedLeave,u=void 0}}:u=void 0}else u&&(u=void 0);return i}}};function DA(t){let e=t[0];if(t.length>1){for(const r of t)if(r.type!==Xr){e=r;break}}return e}const PA=Q3;function RA(t,e){const{leavingVNodes:r}=t;let n=r.get(e.type);return n||(n=Object.create(null),r.set(e.type,n)),n}function vc(t,e,r,n,s){const{appear:i,mode:a,persisted:o=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:f,onBeforeLeave:h,onLeave:p,onAfterLeave:g,onLeaveCancelled:y,onBeforeAppear:E,onAppear:b,onAfterAppear:_,onAppearCancelled:v}=e,A=String(t.key),D=RA(r,t),k=(m,S)=>{m&&zs(m,n,9,S)},T=(m,S)=>{const I=S[1];k(m,S),dt(m)?m.every(C=>C.length<=1)&&I():m.length<=1&&I()},x={mode:a,persisted:o,beforeEnter(m){let S=l;if(!r.isMounted)if(i)S=E||l;else return;m[Gi]&&m[Gi](!0);const I=D[A];I&&ia(t,I)&&I.el[Gi]&&I.el[Gi](),k(S,[m])},enter(m){let S=c,I=u,C=f;if(!r.isMounted)if(i)S=b||c,I=_||u,C=v||f;else return;let F=!1;const W=m[Pf]=P=>{F||(F=!0,P?k(C,[m]):k(I,[m]),x.delayedLeave&&x.delayedLeave(),m[Pf]=void 0)};S?T(S,[m,W]):W()},leave(m,S){const I=String(t.key);if(m[Pf]&&m[Pf](!0),r.isUnmounting)return S();k(h,[m]);let C=!1;const F=m[Gi]=W=>{C||(C=!0,S(),W?k(y,[m]):k(g,[m]),m[Gi]=void 0,D[I]===t&&delete D[I])};D[I]=t,p?T(p,[m,F]):F()},clone(m){const S=vc(m,e,r,n,s);return s&&s(S),S}};return x}function tm(t){if($d(t))return t=Ba(t),t.children=null,t}function b2(t){if(!$d(t))return wA(t.type)&&t.children?DA(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:r}=t;if(r){if(e&16)return r[0];if(e&32&&Tt(r.default))return r.default()}}function Ei(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Ei(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function Jh(t,e=!1,r){let n=[],s=0;for(let i=0;i<t.length;i++){let a=t[i];const o=r==null?a.key:String(r)+String(a.key!=null?a.key:i);a.type===De?(a.patchFlag&128&&s++,n=n.concat(Jh(a.children,e,o))):(e||a.type!==Xr)&&n.push(o!=null?Ba(a,{key:o}):a)}if(s>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}/*! #__NO_SIDE_EFFECTS__ */function Ud(t,e){return Tt(t)?xr({name:t.name},e,{setup:t}):t}function J3(){const t=Xs();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function b1(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function Z3(t){const e=Xs(),r=v1(null);if(e){const s=e.refs===Zt?e.refs={}:e.refs;Object.defineProperty(s,t,{enumerable:!0,get:()=>r.value,set:i=>r.value=i})}return r}function sc(t,e,r,n,s=!1){if(dt(t)){t.forEach((g,y)=>sc(g,e&&(dt(e)?e[y]:e),r,n,s));return}if(to(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&sc(t,e,r,n.component.subTree);return}const i=n.shapeFlag&4?Hd(n.component):n.el,a=s?null:i,{i:o,r:l}=t,c=e&&e.r,u=o.refs===Zt?o.refs={}:o.refs,f=o.setupState,h=Yt(f),p=f===Zt?()=>!1:g=>ur(h,g);if(c!=null&&c!==l&&(Tr(c)?(u[c]=null,p(c)&&(f[c]=null)):Cr(c)&&(c.value=null)),Tt(l))Mc(l,o,12,[a,u]);else{const g=Tr(l),y=Cr(l);if(g||y){const E=()=>{if(t.f){const b=g?p(l)?f[l]:u[l]:l.value;s?dt(b)&&i1(b,i):dt(b)?b.includes(i)||b.push(i):g?(u[l]=[i],p(l)&&(f[l]=u[l])):(l.value=[i],t.k&&(u[t.k]=l.value))}else g?(u[l]=a,p(l)&&(f[l]=a)):y&&(l.value=a,t.k&&(u[t.k]=a))};a?(E.id=-1,cn(E,r)):E()}}}let S2=!1;const Fl=()=>{S2||(console.error("Hydration completed but contains mismatches."),S2=!0)},eP=t=>t.namespaceURI.includes("svg")&&t.tagName!=="foreignObject",tP=t=>t.namespaceURI.includes("MathML"),Rf=t=>{if(t.nodeType===1){if(eP(t))return"svg";if(tP(t))return"mathml"}},Xl=t=>t.nodeType===8;function rP(t){const{mt:e,p:r,o:{patchProp:n,createText:s,nextSibling:i,parentNode:a,remove:o,insert:l,createComment:c}}=t,u=(v,A)=>{if(!A.hasChildNodes()){r(null,v,A),j0(),A._vnode=v;return}f(A.firstChild,v,null,null,null),j0(),A._vnode=v},f=(v,A,D,k,T,x=!1)=>{x=x||!!A.dynamicChildren;const m=Xl(v)&&v.data==="[",S=()=>y(v,A,D,k,T,m),{type:I,ref:C,shapeFlag:F,patchFlag:W}=A;let P=v.nodeType;A.el=v,W===-2&&(x=!1,A.dynamicChildren=null);let R=null;switch(I){case ro:P!==3?A.children===""?(l(A.el=s(""),a(v),v),R=v):R=S():(v.data!==A.children&&(Fl(),v.data=A.children),R=i(v));break;case Xr:_(v)?(R=i(v),b(A.el=v.content.firstChild,v,D)):P!==8||m?R=S():R=i(v);break;case jo:if(m&&(v=i(v),P=v.nodeType),P===1||P===3){R=v;const N=!A.children.length;for(let M=0;M<A.staticCount;M++)N&&(A.children+=R.nodeType===1?R.outerHTML:R.data),M===A.staticCount-1&&(A.anchor=R),R=i(R);return m?i(R):R}else S();break;case De:m?R=g(v,A,D,k,T,x):R=S();break;default:if(F&1)(P!==1||A.type.toLowerCase()!==v.tagName.toLowerCase())&&!_(v)?R=S():R=h(v,A,D,k,T,x);else if(F&6){A.slotScopeIds=T;const N=a(v);if(m?R=E(v):Xl(v)&&v.data==="teleport start"?R=E(v,v.data,"teleport end"):R=i(v),e(A,N,null,D,k,Rf(N),x),to(A)&&!A.type.__asyncResolved){let M;m?(M=Pe(De),M.anchor=R?R.previousSibling:N.lastChild):M=v.nodeType===3?we(""):Pe("div"),M.el=v,A.component.subTree=M}}else F&64?P!==8?R=S():R=A.type.hydrate(v,A,D,k,T,x,t,p):F&128&&(R=A.type.hydrate(v,A,D,k,Rf(a(v)),T,x,t,f))}return C!=null&&sc(C,null,k,A),R},h=(v,A,D,k,T,x)=>{x=x||!!A.dynamicChildren;const{type:m,props:S,patchFlag:I,shapeFlag:C,dirs:F,transition:W}=A,P=m==="input"||m==="option";if(P||I!==-1){F&&Da(A,null,D,"created");let R=!1;if(_(v)){R=sT(null,W)&&D&&D.vnode.props&&D.vnode.props.appear;const M=v.content.firstChild;if(R){const O=M.getAttribute("class");O&&(M.$cls=O),W.beforeEnter(M)}b(M,v,D),A.el=v=M}if(C&16&&!(S&&(S.innerHTML||S.textContent))){let M=p(v.firstChild,A,v,D,k,T,x);for(;M;){Ff(v,1)||Fl();const O=M;M=M.nextSibling,o(O)}}else if(C&8){let M=A.children;M[0]===`
`&&(v.tagName==="PRE"||v.tagName==="TEXTAREA")&&(M=M.slice(1)),v.textContent!==M&&(Ff(v,0)||Fl(),v.textContent=A.children)}if(S){if(P||!x||I&48){const M=v.tagName.includes("-");for(const O in S)(P&&(O.endsWith("value")||O==="indeterminate")||Ld(O)&&!tc(O)||O[0]==="."||M)&&n(v,O,null,S[O],void 0,D)}else if(S.onClick)n(v,"onClick",null,S.onClick,void 0,D);else if(I&4&&Fa(S.style))for(const M in S.style)S.style[M]}let N;(N=S&&S.onVnodeBeforeMount)&&ys(N,D,A),F&&Da(A,null,D,"beforeMount"),((N=S&&S.onVnodeMounted)||F||R)&&hT(()=>{N&&ys(N,D,A),R&&W.enter(v),F&&Da(A,null,D,"mounted")},k)}return v.nextSibling},p=(v,A,D,k,T,x,m)=>{m=m||!!A.dynamicChildren;const S=A.children,I=S.length;for(let C=0;C<I;C++){const F=m?S[C]:S[C]=Es(S[C]),W=F.type===ro;v?(W&&!m&&C+1<I&&Es(S[C+1]).type===ro&&(l(s(v.data.slice(F.children.length)),D,i(v)),v.data=F.children),v=f(v,F,k,T,x,m)):W&&!F.children?l(F.el=s(""),D):(Ff(D,1)||Fl(),r(null,F,D,null,k,T,Rf(D),x))}return v},g=(v,A,D,k,T,x)=>{const{slotScopeIds:m}=A;m&&(T=T?T.concat(m):m);const S=a(v),I=p(i(v),A,S,D,k,T,x);return I&&Xl(I)&&I.data==="]"?i(A.anchor=I):(Fl(),l(A.anchor=c("]"),S,I),I)},y=(v,A,D,k,T,x)=>{if(Ff(v.parentElement,1)||Fl(),A.el=null,x){const I=E(v);for(;;){const C=i(v);if(C&&C!==I)o(C);else break}}const m=i(v),S=a(v);return o(v),r(null,A,S,m,D,k,Rf(S),T),D&&(D.vnode.el=A.el,np(D,A.el)),m},E=(v,A="[",D="]")=>{let k=0;for(;v;)if(v=i(v),v&&Xl(v)&&(v.data===A&&k++,v.data===D)){if(k===0)return i(v);k--}return v},b=(v,A,D)=>{const k=A.parentNode;k&&k.replaceChild(v,A);let T=D;for(;T;)T.vnode.el===A&&(T.vnode.el=T.subTree.el=v),T=T.parent},_=v=>v.nodeType===1&&v.tagName==="TEMPLATE";return[u,f]}const A2="data-allow-mismatch",nP={0:"text",1:"children",2:"class",3:"style",4:"attribute"};function Ff(t,e){if(e===0||e===1)for(;t&&!t.hasAttribute(A2);)t=t.parentElement;const r=t&&t.getAttribute(A2);if(r==null)return!1;if(r==="")return!0;{const n=r.split(",");return e===0&&n.includes("children")?!0:n.includes(nP[e])}}const sP=Hh().requestIdleCallback||(t=>setTimeout(t,1)),aP=Hh().cancelIdleCallback||(t=>clearTimeout(t)),iP=(t=1e4)=>e=>{const r=sP(e,{timeout:t});return()=>aP(r)};function oP(t){const{top:e,left:r,bottom:n,right:s}=t.getBoundingClientRect(),{innerHeight:i,innerWidth:a}=window;return(e>0&&e<i||n>0&&n<i)&&(r>0&&r<a||s>0&&s<a)}const lP=t=>(e,r)=>{const n=new IntersectionObserver(s=>{for(const i of s)if(i.isIntersecting){n.disconnect(),e();break}},t);return r(s=>{if(s instanceof Element){if(oP(s))return e(),n.disconnect(),!1;n.observe(s)}}),()=>n.disconnect()},cP=t=>e=>{if(t){const r=matchMedia(t);if(r.matches)e();else return r.addEventListener("change",e,{once:!0}),()=>r.removeEventListener("change",e)}},uP=(t=[])=>(e,r)=>{Tr(t)&&(t=[t]);let n=!1;const s=a=>{n||(n=!0,i(),e(),a.target.dispatchEvent(new a.constructor(a.type,a)))},i=()=>{r(a=>{for(const o of t)a.removeEventListener(o,s)})};return r(a=>{for(const o of t)a.addEventListener(o,s,{once:!0})}),i};function dP(t,e){if(Xl(t)&&t.data==="["){let r=1,n=t.nextSibling;for(;n;){if(n.nodeType===1){if(e(n)===!1)break}else if(Xl(n))if(n.data==="]"){if(--r===0)break}else n.data==="["&&r++;n=n.nextSibling}}else e(t)}const to=t=>!!t.type.__asyncLoader;/*! #__NO_SIDE_EFFECTS__ */function fP(t){Tt(t)&&(t={loader:t});const{loader:e,loadingComponent:r,errorComponent:n,delay:s=200,hydrate:i,timeout:a,suspensible:o=!0,onError:l}=t;let c=null,u,f=0;const h=()=>(f++,c=null,p()),p=()=>{let g;return c||(g=c=e().catch(y=>{if(y=y instanceof Error?y:new Error(String(y)),l)return new Promise((E,b)=>{l(y,()=>E(h()),()=>b(y),f+1)});throw y}).then(y=>g!==c&&c?c:(y&&(y.__esModule||y[Symbol.toStringTag]==="Module")&&(y=y.default),u=y,y)))};return Ud({name:"AsyncComponentWrapper",__asyncLoader:p,__asyncHydrate(g,y,E){const b=i?()=>{const v=i(()=>{E()},A=>dP(g,A));v&&(y.bum||(y.bum=[])).push(v),(y.u||(y.u=[])).push(()=>!0)}:E;u?b():p().then(()=>!y.isUnmounted&&b())},get __asyncResolved(){return u},setup(){const g=dn;if(b1(g),u)return()=>rm(u,g);const y=v=>{c=null,fl(v,g,13,!n)};if(o&&g.suspense||yc)return p().then(v=>()=>rm(v,g)).catch(v=>(y(v),()=>n?Pe(n,{error:v}):null));const E=se(!1),b=se(),_=se(!!s);return s&&setTimeout(()=>{_.value=!1},s),a!=null&&setTimeout(()=>{if(!E.value&&!b.value){const v=new Error(`Async component timed out after ${a}ms.`);y(v),b.value=v}},a),p().then(()=>{E.value=!0,g.parent&&$d(g.parent.vnode)&&g.parent.update()}).catch(v=>{y(v),b.value=v}),()=>{if(E.value&&u)return rm(u,g);if(b.value&&n)return Pe(n,{error:b.value});if(r&&!_.value)return Pe(r)}}})}function rm(t,e){const{ref:r,props:n,children:s,ce:i}=e.vnode,a=Pe(t,n,s);return a.ref=r,a.ce=i,delete e.vnode.ce,a}const $d=t=>t.type.__isKeepAlive,hP={name:"KeepAlive",__isKeepAlive:!0,props:{include:[String,RegExp,Array],exclude:[String,RegExp,Array],max:[String,Number]},setup(t,{slots:e}){const r=Xs(),n=r.ctx;if(!n.renderer)return()=>{const _=e.default&&e.default();return _&&_.length===1?_[0]:_};const s=new Map,i=new Set;let a=null;const o=r.suspense,{renderer:{p:l,m:c,um:u,o:{createElement:f}}}=n,h=f("div");n.activate=(_,v,A,D,k)=>{const T=_.component;c(_,v,A,0,o),l(T.vnode,_,v,A,T,o,D,_.slotScopeIds,k),cn(()=>{T.isDeactivated=!1,T.a&&rc(T.a);const x=_.props&&_.props.onVnodeMounted;x&&ys(x,T.parent,_)},o)},n.deactivate=_=>{const v=_.component;W0(v.m),W0(v.a),c(_,h,null,1,o),cn(()=>{v.da&&rc(v.da);const A=_.props&&_.props.onVnodeUnmounted;A&&ys(A,v.parent,_),v.isDeactivated=!0},o)};function p(_){nm(_),u(_,r,o,!0)}function g(_){s.forEach((v,A)=>{const D=ev(v.type);D&&!_(D)&&y(A)})}function y(_){const v=s.get(_);v&&(!a||!ia(v,a))?p(v):a&&nm(a),s.delete(_),i.delete(_)}Ht(()=>[t.include,t.exclude],([_,v])=>{_&&g(A=>gu(_,A)),v&&g(A=>!gu(v,A))},{flush:"post",deep:!0});let E=null;const b=()=>{E!=null&&(z0(r.subTree.type)?cn(()=>{s.set(E,Nf(r.subTree))},r.subTree.suspense):s.set(E,Nf(r.subTree)))};return Gt(b),ep(b),tp(()=>{s.forEach(_=>{const{subTree:v,suspense:A}=r,D=Nf(v);if(_.type===D.type&&_.key===D.key){nm(D);const k=D.component.da;k&&cn(k,A);return}p(_)})}),()=>{if(E=null,!e.default)return a=null;const _=e.default(),v=_[0];if(_.length>1)return a=null,_;if(!_i(v)||!(v.shapeFlag&4)&&!(v.shapeFlag&128))return a=null,v;let A=Nf(v);if(A.type===Xr)return a=null,A;const D=A.type,k=ev(to(A)?A.type.__asyncResolved||{}:D),{include:T,exclude:x,max:m}=t;if(T&&(!k||!gu(T,k))||x&&k&&gu(x,k))return A.shapeFlag&=-257,a=A,v;const S=A.key==null?D:A.key,I=s.get(S);return A.el&&(A=Ba(A),v.shapeFlag&128&&(v.ssContent=A)),E=S,I?(A.el=I.el,A.component=I.component,A.transition&&Ei(A,A.transition),A.shapeFlag|=512,i.delete(S),i.add(S)):(i.add(S),m&&i.size>parseInt(m,10)&&y(i.values().next().value)),A.shapeFlag|=256,a=A,z0(v.type)?v:A}}},pP=hP;function gu(t,e){return dt(t)?t.some(r=>gu(r,e)):Tr(t)?t.split(",").includes(e):jD(t)?(t.lastIndex=0,t.test(e)):!1}function FA(t,e){OA(t,"a",e)}function NA(t,e){OA(t,"da",e)}function OA(t,e,r=dn){const n=t.__wdc||(t.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return t()});if(Zh(e,n,r),r){let s=r.parent;for(;s&&s.parent;)$d(s.parent.vnode)&&mP(n,e,r,s),s=s.parent}}function mP(t,e,r,n){const s=Zh(e,t,n,!0);ja(()=>{i1(n[e],s)},r)}function nm(t){t.shapeFlag&=-257,t.shapeFlag&=-513}function Nf(t){return t.shapeFlag&128?t.ssContent:t}function Zh(t,e,r=dn,n=!1){if(r){const s=r[t]||(r[t]=[]),i=e.__weh||(e.__weh=(...a)=>{vi();const o=Zo(r),l=zs(e,r,t,a);return o(),yi(),l});return n?s.unshift(i):s.push(i),i}}const Ii=t=>(e,r=dn)=>{(!yc||t==="sp")&&Zh(t,(...n)=>e(...n),r)},MA=Ii("bm"),Gt=Ii("m"),S1=Ii("bu"),ep=Ii("u"),tp=Ii("bum"),ja=Ii("um"),LA=Ii("sp"),BA=Ii("rtg"),UA=Ii("rtc");function $A(t,e=dn){Zh("ec",t,e)}const A1="components",gP="directives";function _r(t,e){return w1(A1,t,!0,e)||t}const VA=Symbol.for("v-ndc");function T1(t){return Tr(t)?w1(A1,t,!1)||t:t||VA}function vP(t){return w1(gP,t)}function w1(t,e,r=!0,n=!1){const s=fn||dn;if(s){const i=s.type;if(t===A1){const o=ev(i,!1);if(o&&(o===e||o===Pn(e)||o===Bd(Pn(e))))return i}const a=T2(s[t]||i[t],e)||T2(s.appContext[t],e);return!a&&n?i:a}}function T2(t,e){return t&&(t[e]||t[Pn(e)]||t[Bd(Pn(e))])}function $e(t,e,r,n){let s;const i=r&&r[n],a=dt(t);if(a||Tr(t)){const o=a&&Fa(t);let l=!1,c=!1;o&&(l=!Fs(t),c=xi(t),t=Wh(t)),s=new Array(t.length);for(let u=0,f=t.length;u<f;u++)s[u]=e(l?c?$0(kn(t[u])):kn(t[u]):t[u],u,void 0,i&&i[u])}else if(typeof t=="number"){s=new Array(t);for(let o=0;o<t;o++)s[o]=e(o+1,o,void 0,i&&i[o])}else if(gr(t))if(t[Symbol.iterator])s=Array.from(t,(o,l)=>e(o,l,void 0,i&&i[l]));else{const o=Object.keys(t);s=new Array(o.length);for(let l=0,c=o.length;l<c;l++){const u=o[l];s[l]=e(t[u],u,l,i&&i[l])}}else s=[];return r&&(r[n]=s),s}function yP(t,e){for(let r=0;r<e.length;r++){const n=e[r];if(dt(n))for(let s=0;s<n.length;s++)t[n[s].name]=n[s].fn;else n&&(t[n.name]=n.key?(...s)=>{const i=n.fn(...s);return i&&(i.key=n.key),i}:n.fn)}return t}function HA(t,e,r={},n,s){if(fn.ce||fn.parent&&to(fn.parent)&&fn.parent.ce)return e!=="default"&&(r.name=e),L(),Jt(De,null,[Pe("slot",r,n&&n())],64);let i=t[e];i&&i._c&&(i._d=!1),L();const a=i&&C1(i(r)),o=r.key||a&&a.key,l=Jt(De,{key:(o&&!ga(o)?o:`_${e}`)+(!a&&n?"_fb":"")},a||(n?n():[]),a&&t._===1?64:-2);return!s&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),i&&i._c&&(i._d=!0),l}function C1(t){return t.some(e=>_i(e)?!(e.type===Xr||e.type===De&&!C1(e.children)):!0)?t:null}function xP(t,e){const r={};for(const n in t)r[e&&/[A-Z]/.test(n)?`on:${n}`:Du(n)]=t[n];return r}const jg=t=>t?ET(t)?Hd(t):jg(t.parent):null,Nu=xr(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>jg(t.parent),$root:t=>jg(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>I1(t),$forceUpdate:t=>t.f||(t.f=()=>{x1(t.update)}),$nextTick:t=>t.n||(t.n=hl.bind(t.proxy)),$watch:t=>YP.bind(t)}),sm=(t,e)=>t!==Zt&&!t.__isScriptSetup&&ur(t,e),Gg={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:r,setupState:n,data:s,props:i,accessCache:a,type:o,appContext:l}=t;let c;if(e[0]!=="$"){const p=a[e];if(p!==void 0)switch(p){case 1:return n[e];case 2:return s[e];case 4:return r[e];case 3:return i[e]}else{if(sm(n,e))return a[e]=1,n[e];if(s!==Zt&&ur(s,e))return a[e]=2,s[e];if((c=t.propsOptions[0])&&ur(c,e))return a[e]=3,i[e];if(r!==Zt&&ur(r,e))return a[e]=4,r[e];Wg&&(a[e]=0)}}const u=Nu[e];let f,h;if(u)return e==="$attrs"&&zn(t.attrs,"get",""),u(t);if((f=o.__cssModules)&&(f=f[e]))return f;if(r!==Zt&&ur(r,e))return a[e]=4,r[e];if(h=l.config.globalProperties,ur(h,e))return h[e]},set({_:t},e,r){const{data:n,setupState:s,ctx:i}=t;return sm(s,e)?(s[e]=r,!0):n!==Zt&&ur(n,e)?(n[e]=r,!0):ur(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=r,!0)},has({_:{data:t,setupState:e,accessCache:r,ctx:n,appContext:s,propsOptions:i}},a){let o;return!!r[a]||t!==Zt&&ur(t,a)||sm(e,a)||(o=i[0])&&ur(o,a)||ur(n,a)||ur(Nu,a)||ur(s.config.globalProperties,a)},defineProperty(t,e,r){return r.get!=null?t._.accessCache[e]=0:ur(r,"value")&&this.set(t,e,r.value,null),Reflect.defineProperty(t,e,r)}},EP=xr({},Gg,{get(t,e){if(e!==Symbol.unscopables)return Gg.get(t,e,t)},has(t,e){return e[0]!=="_"&&!qD(e)}});function _P(){return null}function bP(){return null}function SP(t){}function AP(t){}function TP(){return null}function wP(){}function CP(t,e){return null}function IP(){return jA().slots}function kP(){return jA().attrs}function jA(){const t=Xs();return t.setupContext||(t.setupContext=ST(t))}function pd(t){return dt(t)?t.reduce((e,r)=>(e[r]=null,e),{}):t}function DP(t,e){const r=pd(t);for(const n in e){if(n.startsWith("__skip"))continue;let s=r[n];s?dt(s)||Tt(s)?s=r[n]={type:s,default:e[n]}:s.default=e[n]:s===null&&(s=r[n]={default:e[n]}),s&&e[`__skip_${n}`]&&(s.skipFactory=!0)}return r}function PP(t,e){return!t||!e?t||e:dt(t)&&dt(e)?t.concat(e):xr({},pd(t),pd(e))}function RP(t,e){const r={};for(const n in t)e.includes(n)||Object.defineProperty(r,n,{enumerable:!0,get:()=>t[n]});return r}function FP(t){const e=Xs();let r=t();return Qg(),o1(r)&&(r=r.catch(n=>{throw Zo(e),n})),[r,()=>Zo(e)]}let Wg=!0;function NP(t){const e=I1(t),r=t.proxy,n=t.ctx;Wg=!1,e.beforeCreate&&w2(e.beforeCreate,t,"bc");const{data:s,computed:i,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:f,mounted:h,beforeUpdate:p,updated:g,activated:y,deactivated:E,beforeDestroy:b,beforeUnmount:_,destroyed:v,unmounted:A,render:D,renderTracked:k,renderTriggered:T,errorCaptured:x,serverPrefetch:m,expose:S,inheritAttrs:I,components:C,directives:F,filters:W}=e;if(c&&OP(c,n,null),a)for(const N in a){const M=a[N];Tt(M)&&(n[N]=M.bind(r))}if(s){const N=s.call(r,r);gr(N)&&(t.data=As(N))}if(Wg=!0,i)for(const N in i){const M=i[N],O=Tt(M)?M.bind(r,r):Tt(M.get)?M.get.bind(r,r):js,G=!Tt(M)&&Tt(M.set)?M.set.bind(r):js,z=Se({get:O,set:G});Object.defineProperty(n,N,{enumerable:!0,configurable:!0,get:()=>z.value,set:j=>z.value=j})}if(o)for(const N in o)GA(o[N],n,r,N);if(l){const N=Tt(l)?l.call(r):l;Reflect.ownKeys(N).forEach(M=>{Ou(M,N[M])})}u&&w2(u,t,"c");function R(N,M){dt(M)?M.forEach(O=>N(O.bind(r))):M&&N(M.bind(r))}if(R(MA,f),R(Gt,h),R(S1,p),R(ep,g),R(FA,y),R(NA,E),R($A,x),R(UA,k),R(BA,T),R(tp,_),R(ja,A),R(LA,m),dt(S))if(S.length){const N=t.exposed||(t.exposed={});S.forEach(M=>{Object.defineProperty(N,M,{get:()=>r[M],set:O=>r[M]=O})})}else t.exposed||(t.exposed={});D&&t.render===js&&(t.render=D),I!=null&&(t.inheritAttrs=I),C&&(t.components=C),F&&(t.directives=F),m&&b1(t)}function OP(t,e,r=js){dt(t)&&(t=zg(t));for(const n in t){const s=t[n];let i;gr(s)?"default"in s?i=Ns(s.from||n,s.default,!0):i=Ns(s.from||n):i=Ns(s),Cr(i)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):e[n]=i}}function w2(t,e,r){zs(dt(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,r)}function GA(t,e,r,n){let s=n.includes(".")?cT(r,n):()=>r[n];if(Tr(t)){const i=e[t];Tt(i)&&Ht(s,i)}else if(Tt(t))Ht(s,t.bind(r));else if(gr(t))if(dt(t))t.forEach(i=>GA(i,e,r,n));else{const i=Tt(t.handler)?t.handler.bind(r):e[t.handler];Tt(i)&&Ht(s,i,t)}}function I1(t){const e=t.type,{mixins:r,extends:n}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=t.appContext,o=i.get(e);let l;return o?l=o:!s.length&&!r&&!n?l=e:(l={},s.length&&s.forEach(c=>G0(l,c,a,!0)),G0(l,e,a)),gr(e)&&i.set(e,l),l}function G0(t,e,r,n=!1){const{mixins:s,extends:i}=e;i&&G0(t,i,r,!0),s&&s.forEach(a=>G0(t,a,r,!0));for(const a in e)if(!(n&&a==="expose")){const o=MP[a]||r&&r[a];t[a]=o?o(t[a],e[a]):e[a]}return t}const MP={data:C2,props:I2,emits:I2,methods:vu,computed:vu,beforeCreate:as,created:as,beforeMount:as,mounted:as,beforeUpdate:as,updated:as,beforeDestroy:as,beforeUnmount:as,destroyed:as,unmounted:as,activated:as,deactivated:as,errorCaptured:as,serverPrefetch:as,components:vu,directives:vu,watch:BP,provide:C2,inject:LP};function C2(t,e){return e?t?function(){return xr(Tt(t)?t.call(this,this):t,Tt(e)?e.call(this,this):e)}:e:t}function LP(t,e){return vu(zg(t),zg(e))}function zg(t){if(dt(t)){const e={};for(let r=0;r<t.length;r++)e[t[r]]=t[r];return e}return t}function as(t,e){return t?[...new Set([].concat(t,e))]:e}function vu(t,e){return t?xr(Object.create(null),t,e):e}function I2(t,e){return t?dt(t)&&dt(e)?[...new Set([...t,...e])]:xr(Object.create(null),pd(t),pd(e??{})):e}function BP(t,e){if(!t)return e;if(!e)return t;const r=xr(Object.create(null),t);for(const n in e)r[n]=as(t[n],e[n]);return r}function WA(){return{app:null,config:{isNativeTag:VD,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let UP=0;function $P(t,e){return function(n,s=null){Tt(n)||(n=xr({},n)),s!=null&&!gr(s)&&(s=null);const i=WA(),a=new WeakSet,o=[];let l=!1;const c=i.app={_uid:UP++,_component:n,_props:s,_container:null,_context:i,_instance:null,version:TT,get config(){return i.config},set config(u){},use(u,...f){return a.has(u)||(u&&Tt(u.install)?(a.add(u),u.install(c,...f)):Tt(u)&&(a.add(u),u(c,...f))),c},mixin(u){return i.mixins.includes(u)||i.mixins.push(u),c},component(u,f){return f?(i.components[u]=f,c):i.components[u]},directive(u,f){return f?(i.directives[u]=f,c):i.directives[u]},mount(u,f,h){if(!l){const p=c._ceVNode||Pe(n,s);return p.appContext=i,h===!0?h="svg":h===!1&&(h=void 0),f&&e?e(p,u):t(p,u,h),l=!0,c._container=u,u.__vue_app__=c,Hd(p.component)}},onUnmount(u){o.push(u)},unmount(){l&&(zs(o,c._instance,16),t(null,c._container),delete c._container.__vue_app__)},provide(u,f){return i.provides[u]=f,c},runWithContext(u){const f=Ho;Ho=c;try{return u()}finally{Ho=f}}};return c}}let Ho=null;function Ou(t,e){if(dn){let r=dn.provides;const n=dn.parent&&dn.parent.provides;n===r&&(r=dn.provides=Object.create(n)),r[t]=e}}function Ns(t,e,r=!1){const n=dn||fn;if(n||Ho){let s=Ho?Ho._context.provides:n?n.parent==null||n.ce?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&t in s)return s[t];if(arguments.length>1)return r&&Tt(e)?e.call(n&&n.proxy):e}}function zA(){return!!(dn||fn||Ho)}const KA={},qA=()=>Object.create(KA),XA=t=>Object.getPrototypeOf(t)===KA;function VP(t,e,r,n=!1){const s={},i=qA();t.propsDefaults=Object.create(null),YA(t,e,s,i);for(const a in t.propsOptions[0])a in s||(s[a]=void 0);r?t.props=n?s:m1(s):t.type.props?t.props=s:t.props=i,t.attrs=i}function HP(t,e,r,n){const{props:s,attrs:i,vnode:{patchFlag:a}}=t,o=Yt(s),[l]=t.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const u=t.vnode.dynamicProps;for(let f=0;f<u.length;f++){let h=u[f];if(rp(t.emitsOptions,h))continue;const p=e[h];if(l)if(ur(i,h))p!==i[h]&&(i[h]=p,c=!0);else{const g=Pn(h);s[g]=Kg(l,o,g,p,t,!1)}else p!==i[h]&&(i[h]=p,c=!0)}}}else{YA(t,e,s,i)&&(c=!0);let u;for(const f in o)(!e||!ur(e,f)&&((u=_s(f))===f||!ur(e,u)))&&(l?r&&(r[f]!==void 0||r[u]!==void 0)&&(s[f]=Kg(l,o,f,void 0,t,!0)):delete s[f]);if(i!==o)for(const f in i)(!e||!ur(e,f))&&(delete i[f],c=!0)}c&&ei(t.attrs,"set","")}function YA(t,e,r,n){const[s,i]=t.propsOptions;let a=!1,o;if(e)for(let l in e){if(tc(l))continue;const c=e[l];let u;s&&ur(s,u=Pn(l))?!i||!i.includes(u)?r[u]=c:(o||(o={}))[u]=c:rp(t.emitsOptions,l)||(!(l in n)||c!==n[l])&&(n[l]=c,a=!0)}if(i){const l=Yt(r),c=o||Zt;for(let u=0;u<i.length;u++){const f=i[u];r[f]=Kg(s,l,f,c[f],t,!ur(c,f))}}return a}function Kg(t,e,r,n,s,i){const a=t[r];if(a!=null){const o=ur(a,"default");if(o&&n===void 0){const l=a.default;if(a.type!==Function&&!a.skipFactory&&Tt(l)){const{propsDefaults:c}=s;if(r in c)n=c[r];else{const u=Zo(s);n=c[r]=l.call(null,e),u()}}else n=l;s.ce&&s.ce._setProp(r,n)}a[0]&&(i&&!o?n=!1:a[1]&&(n===""||n===_s(r))&&(n=!0))}return n}const jP=new WeakMap;function QA(t,e,r=!1){const n=r?jP:e.propsCache,s=n.get(t);if(s)return s;const i=t.props,a={},o=[];let l=!1;if(!Tt(t)){const u=f=>{l=!0;const[h,p]=QA(f,e,!0);xr(a,h),p&&o.push(...p)};!r&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!l)return gr(t)&&n.set(t,Zl),Zl;if(dt(i))for(let u=0;u<i.length;u++){const f=Pn(i[u]);k2(f)&&(a[f]=Zt)}else if(i)for(const u in i){const f=Pn(u);if(k2(f)){const h=i[u],p=a[f]=dt(h)||Tt(h)?{type:h}:xr({},h),g=p.type;let y=!1,E=!0;if(dt(g))for(let b=0;b<g.length;++b){const _=g[b],v=Tt(_)&&_.name;if(v==="Boolean"){y=!0;break}else v==="String"&&(E=!1)}else y=Tt(g)&&g.name==="Boolean";p[0]=y,p[1]=E,(y||ur(p,"default"))&&o.push(f)}}const c=[a,o];return gr(t)&&n.set(t,c),c}function k2(t){return t[0]!=="$"&&!tc(t)}const k1=t=>t[0]==="_"||t==="$stable",D1=t=>dt(t)?t.map(Es):[Es(t)],GP=(t,e,r)=>{if(e._n)return e;const n=Qh((...s)=>D1(e(...s)),r);return n._c=!1,n},JA=(t,e,r)=>{const n=t._ctx;for(const s in t){if(k1(s))continue;const i=t[s];if(Tt(i))e[s]=GP(s,i,n);else if(i!=null){const a=D1(i);e[s]=()=>a}}},ZA=(t,e)=>{const r=D1(e);t.slots.default=()=>r},eT=(t,e,r)=>{for(const n in e)(r||!k1(n))&&(t[n]=e[n])},WP=(t,e,r)=>{const n=t.slots=qA();if(t.vnode.shapeFlag&32){const s=e.__;s&&Bg(n,"__",s,!0);const i=e._;i?(eT(n,e,r),r&&Bg(n,"_",i,!0)):JA(e,n)}else e&&ZA(t,e)},zP=(t,e,r)=>{const{vnode:n,slots:s}=t;let i=!0,a=Zt;if(n.shapeFlag&32){const o=e._;o?r&&o===1?i=!1:eT(s,e,r):(i=!e.$stable,JA(e,s)),a=e}else e&&(ZA(t,e),a={default:1});if(i)for(const o in s)!k1(o)&&a[o]==null&&delete s[o]},cn=hT;function tT(t){return nT(t)}function rT(t){return nT(t,rP)}function nT(t,e){const r=Hh();r.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:h,setScopeId:p=js,insertStaticContent:g}=t,y=(K,Y,pe,xe=null,ae=null,de=null,Ee=void 0,he=null,Ce=!!Y.dynamicChildren)=>{if(K===Y)return;K&&!ia(K,Y)&&(xe=ne(K),j(K,ae,de,!0),K=null),Y.patchFlag===-2&&(Ce=!1,Y.dynamicChildren=null);const{type:Te,ref:Ge,shapeFlag:Ie}=Y;switch(Te){case ro:E(K,Y,pe,xe);break;case Xr:b(K,Y,pe,xe);break;case jo:K==null&&_(Y,pe,xe,Ee);break;case De:C(K,Y,pe,xe,ae,de,Ee,he,Ce);break;default:Ie&1?D(K,Y,pe,xe,ae,de,Ee,he,Ce):Ie&6?F(K,Y,pe,xe,ae,de,Ee,he,Ce):(Ie&64||Ie&128)&&Te.process(K,Y,pe,xe,ae,de,Ee,he,Ce,Q)}Ge!=null&&ae?sc(Ge,K&&K.ref,de,Y||K,!Y):Ge==null&&K&&K.ref!=null&&sc(K.ref,null,de,K,!0)},E=(K,Y,pe,xe)=>{if(K==null)n(Y.el=o(Y.children),pe,xe);else{const ae=Y.el=K.el;Y.children!==K.children&&c(ae,Y.children)}},b=(K,Y,pe,xe)=>{K==null?n(Y.el=l(Y.children||""),pe,xe):Y.el=K.el},_=(K,Y,pe,xe)=>{[K.el,K.anchor]=g(K.children,Y,pe,xe,K.el,K.anchor)},v=({el:K,anchor:Y},pe,xe)=>{let ae;for(;K&&K!==Y;)ae=h(K),n(K,pe,xe),K=ae;n(Y,pe,xe)},A=({el:K,anchor:Y})=>{let pe;for(;K&&K!==Y;)pe=h(K),s(K),K=pe;s(Y)},D=(K,Y,pe,xe,ae,de,Ee,he,Ce)=>{Y.type==="svg"?Ee="svg":Y.type==="math"&&(Ee="mathml"),K==null?k(Y,pe,xe,ae,de,Ee,he,Ce):m(K,Y,ae,de,Ee,he,Ce)},k=(K,Y,pe,xe,ae,de,Ee,he)=>{let Ce,Te;const{props:Ge,shapeFlag:Ie,transition:Ve,dirs:Ue}=K;if(Ce=K.el=a(K.type,de,Ge&&Ge.is,Ge),Ie&8?u(Ce,K.children):Ie&16&&x(K.children,Ce,null,xe,ae,am(K,de),Ee,he),Ue&&Da(K,null,xe,"created"),T(Ce,K,K.scopeId,Ee,xe),Ge){for(const Ke in Ge)Ke!=="value"&&!tc(Ke)&&i(Ce,Ke,null,Ge[Ke],de,xe);"value"in Ge&&i(Ce,"value",null,Ge.value,de),(Te=Ge.onVnodeBeforeMount)&&ys(Te,xe,K)}Ue&&Da(K,null,xe,"beforeMount");const ze=sT(ae,Ve);ze&&Ve.beforeEnter(Ce),n(Ce,Y,pe),((Te=Ge&&Ge.onVnodeMounted)||ze||Ue)&&cn(()=>{Te&&ys(Te,xe,K),ze&&Ve.enter(Ce),Ue&&Da(K,null,xe,"mounted")},ae)},T=(K,Y,pe,xe,ae)=>{if(pe&&p(K,pe),xe)for(let de=0;de<xe.length;de++)p(K,xe[de]);if(ae){let de=ae.subTree;if(Y===de||z0(de.type)&&(de.ssContent===Y||de.ssFallback===Y)){const Ee=ae.vnode;T(K,Ee,Ee.scopeId,Ee.slotScopeIds,ae.parent)}}},x=(K,Y,pe,xe,ae,de,Ee,he,Ce=0)=>{for(let Te=Ce;Te<K.length;Te++){const Ge=K[Te]=he?Wi(K[Te]):Es(K[Te]);y(null,Ge,Y,pe,xe,ae,de,Ee,he)}},m=(K,Y,pe,xe,ae,de,Ee)=>{const he=Y.el=K.el;let{patchFlag:Ce,dynamicChildren:Te,dirs:Ge}=Y;Ce|=K.patchFlag&16;const Ie=K.props||Zt,Ve=Y.props||Zt;let Ue;if(pe&&Io(pe,!1),(Ue=Ve.onVnodeBeforeUpdate)&&ys(Ue,pe,Y,K),Ge&&Da(Y,K,pe,"beforeUpdate"),pe&&Io(pe,!0),(Ie.innerHTML&&Ve.innerHTML==null||Ie.textContent&&Ve.textContent==null)&&u(he,""),Te?S(K.dynamicChildren,Te,he,pe,xe,am(Y,ae),de):Ee||M(K,Y,he,null,pe,xe,am(Y,ae),de,!1),Ce>0){if(Ce&16)I(he,Ie,Ve,pe,ae);else if(Ce&2&&Ie.class!==Ve.class&&i(he,"class",null,Ve.class,ae),Ce&4&&i(he,"style",Ie.style,Ve.style,ae),Ce&8){const ze=Y.dynamicProps;for(let Ke=0;Ke<ze.length;Ke++){const ue=ze[Ke],be=Ie[ue],Ae=Ve[ue];(Ae!==be||ue==="value")&&i(he,ue,be,Ae,ae,pe)}}Ce&1&&K.children!==Y.children&&u(he,Y.children)}else!Ee&&Te==null&&I(he,Ie,Ve,pe,ae);((Ue=Ve.onVnodeUpdated)||Ge)&&cn(()=>{Ue&&ys(Ue,pe,Y,K),Ge&&Da(Y,K,pe,"updated")},xe)},S=(K,Y,pe,xe,ae,de,Ee)=>{for(let he=0;he<Y.length;he++){const Ce=K[he],Te=Y[he],Ge=Ce.el&&(Ce.type===De||!ia(Ce,Te)||Ce.shapeFlag&198)?f(Ce.el):pe;y(Ce,Te,Ge,null,xe,ae,de,Ee,!0)}},I=(K,Y,pe,xe,ae)=>{if(Y!==pe){if(Y!==Zt)for(const de in Y)!tc(de)&&!(de in pe)&&i(K,de,Y[de],null,ae,xe);for(const de in pe){if(tc(de))continue;const Ee=pe[de],he=Y[de];Ee!==he&&de!=="value"&&i(K,de,he,Ee,ae,xe)}"value"in pe&&i(K,"value",Y.value,pe.value,ae)}},C=(K,Y,pe,xe,ae,de,Ee,he,Ce)=>{const Te=Y.el=K?K.el:o(""),Ge=Y.anchor=K?K.anchor:o("");let{patchFlag:Ie,dynamicChildren:Ve,slotScopeIds:Ue}=Y;Ue&&(he=he?he.concat(Ue):Ue),K==null?(n(Te,pe,xe),n(Ge,pe,xe),x(Y.children||[],pe,Ge,ae,de,Ee,he,Ce)):Ie>0&&Ie&64&&Ve&&K.dynamicChildren?(S(K.dynamicChildren,Ve,pe,ae,de,Ee,he),(Y.key!=null||ae&&Y===ae.subTree)&&P1(K,Y,!0)):M(K,Y,pe,Ge,ae,de,Ee,he,Ce)},F=(K,Y,pe,xe,ae,de,Ee,he,Ce)=>{Y.slotScopeIds=he,K==null?Y.shapeFlag&512?ae.ctx.activate(Y,pe,xe,Ee,Ce):W(Y,pe,xe,ae,de,Ee,Ce):P(K,Y,Ce)},W=(K,Y,pe,xe,ae,de,Ee)=>{const he=K.component=xT(K,xe,ae);if($d(K)&&(he.ctx.renderer=Q),_T(he,!1,Ee),he.asyncDep){if(ae&&ae.registerDep(he,R,Ee),!K.el){const Ce=he.subTree=Pe(Xr);b(null,Ce,Y,pe)}}else R(he,K,Y,pe,ae,de,Ee)},P=(K,Y,pe)=>{const xe=Y.component=K.component;if(rR(K,Y,pe))if(xe.asyncDep&&!xe.asyncResolved){N(xe,Y,pe);return}else xe.next=Y,xe.update();else Y.el=K.el,xe.vnode=Y},R=(K,Y,pe,xe,ae,de,Ee)=>{const he=()=>{if(K.isMounted){let{next:Ie,bu:Ve,u:Ue,parent:ze,vnode:Ke}=K;{const We=aT(K);if(We){Ie&&(Ie.el=Ke.el,N(K,Ie,Ee)),We.asyncDep.then(()=>{K.isUnmounted||he()});return}}let ue=Ie,be;Io(K,!1),Ie?(Ie.el=Ke.el,N(K,Ie,Ee)):Ie=Ke,Ve&&rc(Ve),(be=Ie.props&&Ie.props.onVnodeBeforeUpdate)&&ys(be,ze,Ie,Ke),Io(K,!0);const Ae=g0(K),Me=K.subTree;K.subTree=Ae,y(Me,Ae,f(Me.el),ne(Me),K,ae,de),Ie.el=Ae.el,ue===null&&np(K,Ae.el),Ue&&cn(Ue,ae),(be=Ie.props&&Ie.props.onVnodeUpdated)&&cn(()=>ys(be,ze,Ie,Ke),ae)}else{let Ie;const{el:Ve,props:Ue}=Y,{bm:ze,m:Ke,parent:ue,root:be,type:Ae}=K,Me=to(Y);if(Io(K,!1),ze&&rc(ze),!Me&&(Ie=Ue&&Ue.onVnodeBeforeMount)&&ys(Ie,ue,Y),Io(K,!0),Ve&&ee){const We=()=>{K.subTree=g0(K),ee(Ve,K.subTree,K,ae,null)};Me&&Ae.__asyncHydrate?Ae.__asyncHydrate(Ve,K,We):We()}else{be.ce&&be.ce._def.shadowRoot!==!1&&be.ce._injectChildStyle(Ae);const We=K.subTree=g0(K);y(null,We,pe,xe,K,ae,de),Y.el=We.el}if(Ke&&cn(Ke,ae),!Me&&(Ie=Ue&&Ue.onVnodeMounted)){const We=Y;cn(()=>ys(Ie,ue,We),ae)}(Y.shapeFlag&256||ue&&to(ue.vnode)&&ue.vnode.shapeFlag&256)&&K.a&&cn(K.a,ae),K.isMounted=!0,Y=pe=xe=null}};K.scope.on();const Ce=K.effect=new ld(he);K.scope.off();const Te=K.update=Ce.run.bind(Ce),Ge=K.job=Ce.runIfDirty.bind(Ce);Ge.i=K,Ge.id=K.uid,Ce.scheduler=()=>x1(Ge),Io(K,!0),Te()},N=(K,Y,pe)=>{Y.component=K;const xe=K.vnode.props;K.vnode=Y,K.next=null,HP(K,Y.props,xe,pe),zP(K,Y.children,pe),vi(),y2(K),yi()},M=(K,Y,pe,xe,ae,de,Ee,he,Ce=!1)=>{const Te=K&&K.children,Ge=K?K.shapeFlag:0,Ie=Y.children,{patchFlag:Ve,shapeFlag:Ue}=Y;if(Ve>0){if(Ve&128){G(Te,Ie,pe,xe,ae,de,Ee,he,Ce);return}else if(Ve&256){O(Te,Ie,pe,xe,ae,de,Ee,he,Ce);return}}Ue&8?(Ge&16&&oe(Te,ae,de),Ie!==Te&&u(pe,Ie)):Ge&16?Ue&16?G(Te,Ie,pe,xe,ae,de,Ee,he,Ce):oe(Te,ae,de,!0):(Ge&8&&u(pe,""),Ue&16&&x(Ie,pe,xe,ae,de,Ee,he,Ce))},O=(K,Y,pe,xe,ae,de,Ee,he,Ce)=>{K=K||Zl,Y=Y||Zl;const Te=K.length,Ge=Y.length,Ie=Math.min(Te,Ge);let Ve;for(Ve=0;Ve<Ie;Ve++){const Ue=Y[Ve]=Ce?Wi(Y[Ve]):Es(Y[Ve]);y(K[Ve],Ue,pe,null,ae,de,Ee,he,Ce)}Te>Ge?oe(K,ae,de,!0,!1,Ie):x(Y,pe,xe,ae,de,Ee,he,Ce,Ie)},G=(K,Y,pe,xe,ae,de,Ee,he,Ce)=>{let Te=0;const Ge=Y.length;let Ie=K.length-1,Ve=Ge-1;for(;Te<=Ie&&Te<=Ve;){const Ue=K[Te],ze=Y[Te]=Ce?Wi(Y[Te]):Es(Y[Te]);if(ia(Ue,ze))y(Ue,ze,pe,null,ae,de,Ee,he,Ce);else break;Te++}for(;Te<=Ie&&Te<=Ve;){const Ue=K[Ie],ze=Y[Ve]=Ce?Wi(Y[Ve]):Es(Y[Ve]);if(ia(Ue,ze))y(Ue,ze,pe,null,ae,de,Ee,he,Ce);else break;Ie--,Ve--}if(Te>Ie){if(Te<=Ve){const Ue=Ve+1,ze=Ue<Ge?Y[Ue].el:xe;for(;Te<=Ve;)y(null,Y[Te]=Ce?Wi(Y[Te]):Es(Y[Te]),pe,ze,ae,de,Ee,he,Ce),Te++}}else if(Te>Ve)for(;Te<=Ie;)j(K[Te],ae,de,!0),Te++;else{const Ue=Te,ze=Te,Ke=new Map;for(Te=ze;Te<=Ve;Te++){const _t=Y[Te]=Ce?Wi(Y[Te]):Es(Y[Te]);_t.key!=null&&Ke.set(_t.key,Te)}let ue,be=0;const Ae=Ve-ze+1;let Me=!1,We=0;const lt=new Array(Ae);for(Te=0;Te<Ae;Te++)lt[Te]=0;for(Te=Ue;Te<=Ie;Te++){const _t=K[Te];if(be>=Ae){j(_t,ae,de,!0);continue}let $t;if(_t.key!=null)$t=Ke.get(_t.key);else for(ue=ze;ue<=Ve;ue++)if(lt[ue-ze]===0&&ia(_t,Y[ue])){$t=ue;break}$t===void 0?j(_t,ae,de,!0):(lt[$t-ze]=Te+1,$t>=We?We=$t:Me=!0,y(_t,Y[$t],pe,null,ae,de,Ee,he,Ce),be++)}const yt=Me?KP(lt):Zl;for(ue=yt.length-1,Te=Ae-1;Te>=0;Te--){const _t=ze+Te,$t=Y[_t],ht=_t+1<Ge?Y[_t+1].el:xe;lt[Te]===0?y(null,$t,pe,ht,ae,de,Ee,he,Ce):Me&&(ue<0||Te!==yt[ue]?z($t,pe,ht,2):ue--)}}},z=(K,Y,pe,xe,ae=null)=>{const{el:de,type:Ee,transition:he,children:Ce,shapeFlag:Te}=K;if(Te&6){z(K.component.subTree,Y,pe,xe);return}if(Te&128){K.suspense.move(Y,pe,xe);return}if(Te&64){Ee.move(K,Y,pe,Q);return}if(Ee===De){n(de,Y,pe);for(let Ie=0;Ie<Ce.length;Ie++)z(Ce[Ie],Y,pe,xe);n(K.anchor,Y,pe);return}if(Ee===jo){v(K,Y,pe);return}if(xe!==2&&Te&1&&he)if(xe===0)he.beforeEnter(de),n(de,Y,pe),cn(()=>he.enter(de),ae);else{const{leave:Ie,delayLeave:Ve,afterLeave:Ue}=he,ze=()=>{K.ctx.isUnmounted?s(de):n(de,Y,pe)},Ke=()=>{Ie(de,()=>{ze(),Ue&&Ue()})};Ve?Ve(de,ze,Ke):Ke()}else n(de,Y,pe)},j=(K,Y,pe,xe=!1,ae=!1)=>{const{type:de,props:Ee,ref:he,children:Ce,dynamicChildren:Te,shapeFlag:Ge,patchFlag:Ie,dirs:Ve,cacheIndex:Ue}=K;if(Ie===-2&&(ae=!1),he!=null&&(vi(),sc(he,null,pe,K,!0),yi()),Ue!=null&&(Y.renderCache[Ue]=void 0),Ge&256){Y.ctx.deactivate(K);return}const ze=Ge&1&&Ve,Ke=!to(K);let ue;if(Ke&&(ue=Ee&&Ee.onVnodeBeforeUnmount)&&ys(ue,Y,K),Ge&6)te(K.component,pe,xe);else{if(Ge&128){K.suspense.unmount(pe,xe);return}ze&&Da(K,null,Y,"beforeUnmount"),Ge&64?K.type.remove(K,Y,pe,Q,xe):Te&&!Te.hasOnce&&(de!==De||Ie>0&&Ie&64)?oe(Te,Y,pe,!1,!0):(de===De&&Ie&384||!ae&&Ge&16)&&oe(Ce,Y,pe),xe&&H(K)}(Ke&&(ue=Ee&&Ee.onVnodeUnmounted)||ze)&&cn(()=>{ue&&ys(ue,Y,K),ze&&Da(K,null,Y,"unmounted")},pe)},H=K=>{const{type:Y,el:pe,anchor:xe,transition:ae}=K;if(Y===De){V(pe,xe);return}if(Y===jo){A(K);return}const de=()=>{s(pe),ae&&!ae.persisted&&ae.afterLeave&&ae.afterLeave()};if(K.shapeFlag&1&&ae&&!ae.persisted){const{leave:Ee,delayLeave:he}=ae,Ce=()=>Ee(pe,de);he?he(K.el,de,Ce):Ce()}else de()},V=(K,Y)=>{let pe;for(;K!==Y;)pe=h(K),s(K),K=pe;s(Y)},te=(K,Y,pe)=>{const{bum:xe,scope:ae,job:de,subTree:Ee,um:he,m:Ce,a:Te,parent:Ge,slots:{__:Ie}}=K;W0(Ce),W0(Te),xe&&rc(xe),Ge&&dt(Ie)&&Ie.forEach(Ve=>{Ge.renderCache[Ve]=void 0}),ae.stop(),de&&(de.flags|=8,j(Ee,K,Y,pe)),he&&cn(he,Y),cn(()=>{K.isUnmounted=!0},Y),Y&&Y.pendingBranch&&!Y.isUnmounted&&K.asyncDep&&!K.asyncResolved&&K.suspenseId===Y.pendingId&&(Y.deps--,Y.deps===0&&Y.resolve())},oe=(K,Y,pe,xe=!1,ae=!1,de=0)=>{for(let Ee=de;Ee<K.length;Ee++)j(K[Ee],Y,pe,xe,ae)},ne=K=>{if(K.shapeFlag&6)return ne(K.component.subTree);if(K.shapeFlag&128)return K.suspense.next();const Y=h(K.anchor||K.el),pe=Y&&Y[TA];return pe?h(pe):Y};let le=!1;const J=(K,Y,pe)=>{K==null?Y._vnode&&j(Y._vnode,null,null,!0):y(Y._vnode||null,K,Y,null,null,null,pe),Y._vnode=K,le||(le=!0,y2(),j0(),le=!1)},Q={p:y,um:j,m:z,r:H,mt:W,mc:x,pc:M,pbc:S,n:ne,o:t};let ve,ee;return e&&([ve,ee]=e(Q)),{render:J,hydrate:ve,createApp:$P(J,ve)}}function am({type:t,props:e},r){return r==="svg"&&t==="foreignObject"||r==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:r}function Io({effect:t,job:e},r){r?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function sT(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function P1(t,e,r=!1){const n=t.children,s=e.children;if(dt(n)&&dt(s))for(let i=0;i<n.length;i++){const a=n[i];let o=s[i];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=s[i]=Wi(s[i]),o.el=a.el),!r&&o.patchFlag!==-2&&P1(a,o)),o.type===ro&&(o.el=a.el),o.type===Xr&&!o.el&&(o.el=a.el)}}function KP(t){const e=t.slice(),r=[0];let n,s,i,a,o;const l=t.length;for(n=0;n<l;n++){const c=t[n];if(c!==0){if(s=r[r.length-1],t[s]<c){e[n]=s,r.push(n);continue}for(i=0,a=r.length-1;i<a;)o=i+a>>1,t[r[o]]<c?i=o+1:a=o;c<t[r[i]]&&(i>0&&(e[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=e[a];return r}function aT(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:aT(e)}function W0(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const iT=Symbol.for("v-scx"),oT=()=>Ns(iT);function qP(t,e){return Vd(t,null,e)}function XP(t,e){return Vd(t,null,{flush:"post"})}function lT(t,e){return Vd(t,null,{flush:"sync"})}function Ht(t,e,r){return Vd(t,e,r)}function Vd(t,e,r=Zt){const{immediate:n,deep:s,flush:i,once:a}=r,o=xr({},r),l=e&&n||!e&&i!=="post";let c;if(yc){if(i==="sync"){const p=oT();c=p.__watcherHandles||(p.__watcherHandles=[])}else if(!l){const p=()=>{};return p.stop=js,p.resume=js,p.pause=js,p}}const u=dn;o.call=(p,g,y)=>zs(p,u,g,y);let f=!1;i==="post"?o.scheduler=p=>{cn(p,u&&u.suspense)}:i!=="sync"&&(f=!0,o.scheduler=(p,g)=>{g?p():x1(p)}),o.augmentJob=p=>{e&&(p.flags|=4),f&&(p.flags|=2,u&&(p.id=u.uid,p.i=u))};const h=B3(t,e,o);return yc&&(c?c.push(h):l&&h()),h}function YP(t,e,r){const n=this.proxy,s=Tr(t)?t.includes(".")?cT(n,t):()=>n[t]:t.bind(n,n);let i;Tt(e)?i=e:(i=e.handler,r=e);const a=Zo(this),o=Vd(s,i.bind(n),r);return a(),o}function cT(t,e){const r=e.split(".");return()=>{let n=t;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}function QP(t,e,r=Zt){const n=Xs(),s=Pn(e),i=_s(e),a=uT(t,s),o=gA((l,c)=>{let u,f=Zt,h;return lT(()=>{const p=t[s];ls(u,p)&&(u=p,c())}),{get(){return l(),r.get?r.get(u):u},set(p){const g=r.set?r.set(p):p;if(!ls(g,u)&&!(f!==Zt&&ls(p,f)))return;const y=n.vnode.props;y&&(e in y||s in y||i in y)&&(`onUpdate:${e}`in y||`onUpdate:${s}`in y||`onUpdate:${i}`in y)||(u=p,c()),n.emit(`update:${e}`,g),ls(p,g)&&ls(p,f)&&!ls(g,h)&&c(),f=p,h=g}}});return o[Symbol.iterator]=()=>{let l=0;return{next(){return l<2?{value:l++?a||Zt:o,done:!1}:{done:!0}}}},o}const uT=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${Pn(e)}Modifiers`]||t[`${_s(e)}Modifiers`];function JP(t,e,...r){if(t.isUnmounted)return;const n=t.vnode.props||Zt;let s=r;const i=e.startsWith("update:"),a=i&&uT(n,e.slice(7));a&&(a.trim&&(s=r.map(u=>Tr(u)?u.trim():u)),a.number&&(s=r.map(L0)));let o,l=n[o=Du(e)]||n[o=Du(Pn(e))];!l&&i&&(l=n[o=Du(_s(e))]),l&&zs(l,t,6,s);const c=n[o+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[o])return;t.emitted[o]=!0,zs(c,t,6,s)}}function dT(t,e,r=!1){const n=e.emitsCache,s=n.get(t);if(s!==void 0)return s;const i=t.emits;let a={},o=!1;if(!Tt(t)){const l=c=>{const u=dT(c,e,!0);u&&(o=!0,xr(a,u))};!r&&e.mixins.length&&e.mixins.forEach(l),t.extends&&l(t.extends),t.mixins&&t.mixins.forEach(l)}return!i&&!o?(gr(t)&&n.set(t,null),null):(dt(i)?i.forEach(l=>a[l]=null):xr(a,i),gr(t)&&n.set(t,a),a)}function rp(t,e){return!t||!Ld(e)?!1:(e=e.slice(2).replace(/Once$/,""),ur(t,e[0].toLowerCase()+e.slice(1))||ur(t,_s(e))||ur(t,e))}function g0(t){const{type:e,vnode:r,proxy:n,withProxy:s,propsOptions:[i],slots:a,attrs:o,emit:l,render:c,renderCache:u,props:f,data:h,setupState:p,ctx:g,inheritAttrs:y}=t,E=hd(t);let b,_;try{if(r.shapeFlag&4){const A=s||n,D=A;b=Es(c.call(D,A,u,f,p,h,g)),_=o}else{const A=e;b=Es(A.length>1?A(f,{attrs:o,slots:a,emit:l}):A(f,null)),_=e.props?o:eR(o)}}catch(A){Mu.length=0,fl(A,t,1),b=Pe(Xr)}let v=b;if(_&&y!==!1){const A=Object.keys(_),{shapeFlag:D}=v;A.length&&D&7&&(i&&A.some(a1)&&(_=tR(_,i)),v=Ba(v,_,!1,!0))}return r.dirs&&(v=Ba(v,null,!1,!0),v.dirs=v.dirs?v.dirs.concat(r.dirs):r.dirs),r.transition&&Ei(v,r.transition),b=v,hd(E),b}function ZP(t,e=!0){let r;for(let n=0;n<t.length;n++){const s=t[n];if(_i(s)){if(s.type!==Xr||s.children==="v-if"){if(r)return;r=s}}else return}return r}const eR=t=>{let e;for(const r in t)(r==="class"||r==="style"||Ld(r))&&((e||(e={}))[r]=t[r]);return e},tR=(t,e)=>{const r={};for(const n in t)(!a1(n)||!(n.slice(9)in e))&&(r[n]=t[n]);return r};function rR(t,e,r){const{props:n,children:s,component:i}=t,{props:a,children:o,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(r&&l>=0){if(l&1024)return!0;if(l&16)return n?D2(n,a,c):!!a;if(l&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const h=u[f];if(a[h]!==n[h]&&!rp(c,h))return!0}}}else return(s||o)&&(!o||!o.$stable)?!0:n===a?!1:n?a?D2(n,a,c):!0:!!a;return!1}function D2(t,e,r){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(e[i]!==t[i]&&!rp(r,i))return!0}return!1}function np({vnode:t,parent:e},r){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===t&&(n.el=t.el),n===t)(t=e.vnode).el=r,e=e.parent;else break}}const z0=t=>t.__isSuspense;let qg=0;const nR={name:"Suspense",__isSuspense:!0,process(t,e,r,n,s,i,a,o,l,c){if(t==null)aR(e,r,n,s,i,a,o,l,c);else{if(i&&i.deps>0&&!t.suspense.isInFallback){e.suspense=t.suspense,e.suspense.vnode=e,e.el=t.el;return}iR(t,e,r,n,s,a,o,l,c)}},hydrate:oR,normalize:lR},sR=nR;function md(t,e){const r=t.props&&t.props[e];Tt(r)&&r()}function aR(t,e,r,n,s,i,a,o,l){const{p:c,o:{createElement:u}}=l,f=u("div"),h=t.suspense=fT(t,s,n,e,f,r,i,a,o,l);c(null,h.pendingBranch=t.ssContent,f,null,n,h,i,a),h.deps>0?(md(t,"onPending"),md(t,"onFallback"),c(null,t.ssFallback,e,r,n,null,i,a),ac(h,t.ssFallback)):h.resolve(!1,!0)}function iR(t,e,r,n,s,i,a,o,{p:l,um:c,o:{createElement:u}}){const f=e.suspense=t.suspense;f.vnode=e,e.el=t.el;const h=e.ssContent,p=e.ssFallback,{activeBranch:g,pendingBranch:y,isInFallback:E,isHydrating:b}=f;if(y)f.pendingBranch=h,ia(h,y)?(l(y,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0?f.resolve():E&&(b||(l(g,p,r,n,s,null,i,a,o),ac(f,p)))):(f.pendingId=qg++,b?(f.isHydrating=!1,f.activeBranch=y):c(y,s,f),f.deps=0,f.effects.length=0,f.hiddenContainer=u("div"),E?(l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0?f.resolve():(l(g,p,r,n,s,null,i,a,o),ac(f,p))):g&&ia(h,g)?(l(g,h,r,n,s,f,i,a,o),f.resolve(!0)):(l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0&&f.resolve()));else if(g&&ia(h,g))l(g,h,r,n,s,f,i,a,o),ac(f,h);else if(md(e,"onPending"),f.pendingBranch=h,h.shapeFlag&512?f.pendingId=h.component.suspenseId:f.pendingId=qg++,l(null,h,f.hiddenContainer,null,s,f,i,a,o),f.deps<=0)f.resolve();else{const{timeout:_,pendingId:v}=f;_>0?setTimeout(()=>{f.pendingId===v&&f.fallback(p)},_):_===0&&f.fallback(p)}}function fT(t,e,r,n,s,i,a,o,l,c,u=!1){const{p:f,m:h,um:p,n:g,o:{parentNode:y,remove:E}}=c;let b;const _=cR(t);_&&e&&e.pendingBranch&&(b=e.pendingId,e.deps++);const v=t.props?B0(t.props.timeout):void 0,A=i,D={vnode:t,parent:e,parentComponent:r,namespace:a,container:n,hiddenContainer:s,deps:0,pendingId:qg++,timeout:typeof v=="number"?v:-1,activeBranch:null,pendingBranch:null,isInFallback:!u,isHydrating:u,isUnmounted:!1,effects:[],resolve(k=!1,T=!1){const{vnode:x,activeBranch:m,pendingBranch:S,pendingId:I,effects:C,parentComponent:F,container:W}=D;let P=!1;D.isHydrating?D.isHydrating=!1:k||(P=m&&S.transition&&S.transition.mode==="out-in",P&&(m.transition.afterLeave=()=>{I===D.pendingId&&(h(S,W,i===A?g(m):i,0),dd(C))}),m&&(y(m.el)===W&&(i=g(m)),p(m,F,D,!0)),P||h(S,W,i,0)),ac(D,S),D.pendingBranch=null,D.isInFallback=!1;let R=D.parent,N=!1;for(;R;){if(R.pendingBranch){R.effects.push(...C),N=!0;break}R=R.parent}!N&&!P&&dd(C),D.effects=[],_&&e&&e.pendingBranch&&b===e.pendingId&&(e.deps--,e.deps===0&&!T&&e.resolve()),md(x,"onResolve")},fallback(k){if(!D.pendingBranch)return;const{vnode:T,activeBranch:x,parentComponent:m,container:S,namespace:I}=D;md(T,"onFallback");const C=g(x),F=()=>{D.isInFallback&&(f(null,k,S,C,m,null,I,o,l),ac(D,k))},W=k.transition&&k.transition.mode==="out-in";W&&(x.transition.afterLeave=F),D.isInFallback=!0,p(x,m,null,!0),W||F()},move(k,T,x){D.activeBranch&&h(D.activeBranch,k,T,x),D.container=k},next(){return D.activeBranch&&g(D.activeBranch)},registerDep(k,T,x){const m=!!D.pendingBranch;m&&D.deps++;const S=k.vnode.el;k.asyncDep.catch(I=>{fl(I,k,0)}).then(I=>{if(k.isUnmounted||D.isUnmounted||D.pendingId!==k.suspenseId)return;k.asyncResolved=!0;const{vnode:C}=k;Jg(k,I,!1),S&&(C.el=S);const F=!S&&k.subTree.el;T(k,C,y(S||k.subTree.el),S?null:g(k.subTree),D,a,x),F&&E(F),np(k,C.el),m&&--D.deps===0&&D.resolve()})},unmount(k,T){D.isUnmounted=!0,D.activeBranch&&p(D.activeBranch,r,k,T),D.pendingBranch&&p(D.pendingBranch,r,k,T)}};return D}function oR(t,e,r,n,s,i,a,o,l){const c=e.suspense=fT(e,n,r,t.parentNode,document.createElement("div"),null,s,i,a,o,!0),u=l(t,c.pendingBranch=e.ssContent,r,c,i,a);return c.deps===0&&c.resolve(!1,!0),u}function lR(t){const{shapeFlag:e,children:r}=t,n=e&32;t.ssContent=P2(n?r.default:r),t.ssFallback=n?P2(r.fallback):Pe(Xr)}function P2(t){let e;if(Tt(t)){const r=Jo&&t._c;r&&(t._d=!1,L()),t=t(),r&&(t._d=!0,e=Yn,pT())}return dt(t)&&(t=ZP(t)),t=Es(t),e&&!t.dynamicChildren&&(t.dynamicChildren=e.filter(r=>r!==t)),t}function hT(t,e){e&&e.pendingBranch?dt(t)?e.effects.push(...t):e.effects.push(t):dd(t)}function ac(t,e){t.activeBranch=e;const{vnode:r,parentComponent:n}=t;let s=e.el;for(;!s&&e.component;)e=e.component.subTree,s=e.el;r.el=s,n&&n.subTree===r&&(n.vnode.el=s,np(n,s))}function cR(t){const e=t.props&&t.props.suspensible;return e!=null&&e!==!1}const De=Symbol.for("v-fgt"),ro=Symbol.for("v-txt"),Xr=Symbol.for("v-cmt"),jo=Symbol.for("v-stc"),Mu=[];let Yn=null;function L(t=!1){Mu.push(Yn=t?null:[])}function pT(){Mu.pop(),Yn=Mu[Mu.length-1]||null}let Jo=1;function Xg(t,e=!1){Jo+=t,t<0&&Yn&&e&&(Yn.hasOnce=!0)}function mT(t){return t.dynamicChildren=Jo>0?Yn||Zl:null,pT(),Jo>0&&Yn&&Yn.push(t),t}function B(t,e,r,n,s,i){return mT(d(t,e,r,n,s,i,!0))}function Jt(t,e,r,n,s){return mT(Pe(t,e,r,n,s,!0))}function _i(t){return t?t.__v_isVNode===!0:!1}function ia(t,e){return t.type===e.type&&t.key===e.key}function uR(t){}const gT=({key:t})=>t??null,v0=({ref:t,ref_key:e,ref_for:r})=>(typeof t=="number"&&(t=""+t),t!=null?Tr(t)||Cr(t)||Tt(t)?{i:fn,r:t,k:e,f:!!r}:t:null);function d(t,e=null,r=null,n=0,s=null,i=t===De?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&gT(e),ref:e&&v0(e),scopeId:Yh,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:fn};return o?(R1(l,r),i&128&&t.normalize(l)):r&&(l.shapeFlag|=Tr(r)?8:16),Jo>0&&!a&&Yn&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Yn.push(l),l}const Pe=dR;function dR(t,e=null,r=null,n=0,s=null,i=!1){if((!t||t===VA)&&(t=Xr),_i(t)){const o=Ba(t,e,!0);return r&&R1(o,r),Jo>0&&!i&&Yn&&(o.shapeFlag&6?Yn[Yn.indexOf(t)]=o:Yn.push(o)),o.patchFlag=-2,o}if(yR(t)&&(t=t.__vccOpts),e){e=vT(e);let{class:o,style:l}=e;o&&!Tr(o)&&(e.class=Xe(o)),gr(l)&&(qh(l)&&!dt(l)&&(l=xr({},l)),e.style=Nr(l))}const a=Tr(t)?1:z0(t)?128:wA(t)?64:gr(t)?4:Tt(t)?2:0;return d(t,e,r,n,s,a,i,!0)}function vT(t){return t?qh(t)||XA(t)?xr({},t):t:null}function Ba(t,e,r=!1,n=!1){const{props:s,ref:i,patchFlag:a,children:o,transition:l}=t,c=e?yT(s||{},e):s,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&gT(c),ref:e&&e.ref?r&&i?dt(i)?i.concat(v0(e)):[i,v0(e)]:v0(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==De?a===-1?16:a|16:a,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:l,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Ba(t.ssContent),ssFallback:t.ssFallback&&Ba(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return l&&n&&Ei(u,l.clone(u)),u}function we(t=" ",e=0){return Pe(ro,null,t,e)}function Rn(t,e){const r=Pe(jo,null,t);return r.staticCount=e,r}function _e(t="",e=!1){return e?(L(),Jt(Xr,null,t)):Pe(Xr,null,t)}function Es(t){return t==null||typeof t=="boolean"?Pe(Xr):dt(t)?Pe(De,null,t.slice()):_i(t)?Wi(t):Pe(ro,null,String(t))}function Wi(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Ba(t)}function R1(t,e){let r=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(dt(e))r=16;else if(typeof e=="object")if(n&65){const s=e.default;s&&(s._c&&(s._d=!1),R1(t,s()),s._c&&(s._d=!0));return}else{r=32;const s=e._;!s&&!XA(e)?e._ctx=fn:s===3&&fn&&(fn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else Tt(e)?(e={default:e,_ctx:fn},r=32):(e=String(e),n&64?(r=16,e=[we(e)]):r=8);t.children=e,t.shapeFlag|=r}function yT(...t){const e={};for(let r=0;r<t.length;r++){const n=t[r];for(const s in n)if(s==="class")e.class!==n.class&&(e.class=Xe([e.class,n.class]));else if(s==="style")e.style=Nr([e.style,n.style]);else if(Ld(s)){const i=e[s],a=n[s];a&&i!==a&&!(dt(i)&&i.includes(a))&&(e[s]=i?[].concat(i,a):a)}else s!==""&&(e[s]=n[s])}return e}function ys(t,e,r,n=null){zs(t,e,7,[r,n])}const fR=WA();let hR=0;function xT(t,e,r){const n=t.type,s=(e?e.appContext:t.appContext)||fR,i={uid:hR++,vnode:t,type:n,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new c1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:QA(n,s),emitsOptions:dT(n,s),emit:null,emitted:null,propsDefaults:Zt,inheritAttrs:n.inheritAttrs,ctx:Zt,data:Zt,props:Zt,attrs:Zt,slots:Zt,refs:Zt,setupState:Zt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=JP.bind(null,i),t.ce&&t.ce(i),i}let dn=null;const Xs=()=>dn||fn;let K0,Yg;{const t=Hh(),e=(r,n)=>{let s;return(s=t[r])||(s=t[r]=[]),s.push(n),i=>{s.length>1?s.forEach(a=>a(i)):s[0](i)}};K0=e("__VUE_INSTANCE_SETTERS__",r=>dn=r),Yg=e("__VUE_SSR_SETTERS__",r=>yc=r)}const Zo=t=>{const e=dn;return K0(t),t.scope.on(),()=>{t.scope.off(),K0(e)}},Qg=()=>{dn&&dn.scope.off(),K0(null)};function ET(t){return t.vnode.shapeFlag&4}let yc=!1;function _T(t,e=!1,r=!1){e&&Yg(e);const{props:n,children:s}=t.vnode,i=ET(t);VP(t,n,i,e),WP(t,s,r||e);const a=i?pR(t,e):void 0;return e&&Yg(!1),a}function pR(t,e){const r=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,Gg);const{setup:n}=r;if(n){vi();const s=t.setupContext=n.length>1?ST(t):null,i=Zo(t),a=Mc(n,t,0,[t.props,s]),o=o1(a);if(yi(),i(),(o||t.sp)&&!to(t)&&b1(t),o){if(a.then(Qg,Qg),e)return a.then(l=>{Jg(t,l,e)}).catch(l=>{fl(l,t,0)});t.asyncDep=a}else Jg(t,a,e)}else bT(t,e)}function Jg(t,e,r){Tt(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:gr(e)&&(t.setupState=y1(e)),bT(t,r)}let q0,Zg;function mR(t){q0=t,Zg=e=>{e.render._rc&&(e.withProxy=new Proxy(e.ctx,EP))}}const gR=()=>!q0;function bT(t,e,r){const n=t.type;if(!t.render){if(!e&&q0&&!n.render){const s=n.template||I1(t).template;if(s){const{isCustomElement:i,compilerOptions:a}=t.appContext.config,{delimiters:o,compilerOptions:l}=n,c=xr(xr({isCustomElement:i,delimiters:o},a),l);n.render=q0(s,c)}}t.render=n.render||js,Zg&&Zg(t)}{const s=Zo(t);vi();try{NP(t)}finally{yi(),s()}}}const vR={get(t,e){return zn(t,"get",""),t[e]}};function ST(t){const e=r=>{t.exposed=r||{}};return{attrs:new Proxy(t.attrs,vR),slots:t.slots,emit:t.emit,expose:e}}function Hd(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(y1(Xh(t.exposed)),{get(e,r){if(r in e)return e[r];if(r in Nu)return Nu[r](t)},has(e,r){return r in e||r in Nu}})):t.proxy}function ev(t,e=!0){return Tt(t)?t.displayName||t.name:t.name||e&&t.__name}function yR(t){return Tt(t)&&"__vccOpts"in t}const Se=(t,e)=>N3(t,e,yc);function el(t,e,r){const n=arguments.length;return n===2?gr(e)&&!dt(e)?_i(e)?Pe(t,null,[e]):Pe(t,e):Pe(t,null,e):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&_i(r)&&(r=[r]),Pe(t,e,r))}function xR(){}function ER(t,e,r,n){const s=r[n];if(s&&AT(s,t))return s;const i=e();return i.memo=t.slice(),i.cacheIndex=n,r[n]=i}function AT(t,e){const r=t.memo;if(r.length!=e.length)return!1;for(let n=0;n<r.length;n++)if(ls(r[n],e[n]))return!1;return Jo>0&&Yn&&Yn.push(t),!0}const TT="3.5.17",_R=js,bR=j3,SR=Vl,AR=AA,TR={createComponentInstance:xT,setupComponent:_T,renderComponentRoot:g0,setCurrentRenderingInstance:hd,isVNode:_i,normalizeVNode:Es,getComponentPublicInstance:Hd,ensureValidVNode:C1,pushWarningContext:U3,popWarningContext:$3},wR=TR,CR=null,IR=null,kR=null;/**
* @vue/runtime-dom v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let tv;const R2=typeof window<"u"&&window.trustedTypes;if(R2)try{tv=R2.createPolicy("vue",{createHTML:t=>t})}catch{}const wT=tv?t=>tv.createHTML(t):t=>t,DR="http://www.w3.org/2000/svg",PR="http://www.w3.org/1998/Math/MathML",Za=typeof document<"u"?document:null,F2=Za&&Za.createElement("template"),RR={insert:(t,e,r)=>{e.insertBefore(t,r||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,r,n)=>{const s=e==="svg"?Za.createElementNS(DR,t):e==="mathml"?Za.createElementNS(PR,t):r?Za.createElement(t,{is:r}):Za.createElement(t);return t==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:t=>Za.createTextNode(t),createComment:t=>Za.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Za.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,r,n,s,i){const a=r?r.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{F2.innerHTML=wT(n==="svg"?`<svg>${t}</svg>`:n==="mathml"?`<math>${t}</math>`:t);const o=F2.content;if(n==="svg"||n==="mathml"){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}e.insertBefore(o,r)}return[a?a.nextSibling:e.firstChild,r?r.previousSibling:e.lastChild]}},Mi="transition",nu="animation",xc=Symbol("_vtc"),CT={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},IT=xr({},_1,CT),FR=t=>(t.displayName="Transition",t.props=IT,t),NR=FR((t,{slots:e})=>el(PA,kT(t),e)),ko=(t,e=[])=>{dt(t)?t.forEach(r=>r(...e)):t&&t(...e)},N2=t=>t?dt(t)?t.some(e=>e.length>1):t.length>1:!1;function kT(t){const e={};for(const C in t)C in CT||(e[C]=t[C]);if(t.css===!1)return e;const{name:r="v",type:n,duration:s,enterFromClass:i=`${r}-enter-from`,enterActiveClass:a=`${r}-enter-active`,enterToClass:o=`${r}-enter-to`,appearFromClass:l=i,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:f=`${r}-leave-from`,leaveActiveClass:h=`${r}-leave-active`,leaveToClass:p=`${r}-leave-to`}=t,g=OR(s),y=g&&g[0],E=g&&g[1],{onBeforeEnter:b,onEnter:_,onEnterCancelled:v,onLeave:A,onLeaveCancelled:D,onBeforeAppear:k=b,onAppear:T=_,onAppearCancelled:x=v}=e,m=(C,F,W,P)=>{C._enterCancelled=P,$i(C,F?u:o),$i(C,F?c:a),W&&W()},S=(C,F)=>{C._isLeaving=!1,$i(C,f),$i(C,p),$i(C,h),F&&F()},I=C=>(F,W)=>{const P=C?T:_,R=()=>m(F,C,W);ko(P,[F,R]),O2(()=>{$i(F,C?l:i),Ca(F,C?u:o),N2(P)||M2(F,n,y,R)})};return xr(e,{onBeforeEnter(C){ko(b,[C]),Ca(C,i),Ca(C,a)},onBeforeAppear(C){ko(k,[C]),Ca(C,l),Ca(C,c)},onEnter:I(!1),onAppear:I(!0),onLeave(C,F){C._isLeaving=!0;const W=()=>S(C,F);Ca(C,f),C._enterCancelled?(Ca(C,h),rv()):(rv(),Ca(C,h)),O2(()=>{C._isLeaving&&($i(C,f),Ca(C,p),N2(A)||M2(C,n,E,W))}),ko(A,[C,W])},onEnterCancelled(C){m(C,!1,void 0,!0),ko(v,[C])},onAppearCancelled(C){m(C,!0,void 0,!0),ko(x,[C])},onLeaveCancelled(C){S(C),ko(D,[C])}})}function OR(t){if(t==null)return null;if(gr(t))return[im(t.enter),im(t.leave)];{const e=im(t);return[e,e]}}function im(t){return B0(t)}function Ca(t,e){e.split(/\s+/).forEach(r=>r&&t.classList.add(r)),(t[xc]||(t[xc]=new Set)).add(e)}function $i(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.remove(n));const r=t[xc];r&&(r.delete(e),r.size||(t[xc]=void 0))}function O2(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let MR=0;function M2(t,e,r,n){const s=t._endId=++MR,i=()=>{s===t._endId&&n()};if(r!=null)return setTimeout(i,r);const{type:a,timeout:o,propCount:l}=DT(t,e);if(!a)return n();const c=a+"end";let u=0;const f=()=>{t.removeEventListener(c,h),i()},h=p=>{p.target===t&&++u>=l&&f()};setTimeout(()=>{u<l&&f()},o+1),t.addEventListener(c,h)}function DT(t,e){const r=window.getComputedStyle(t),n=g=>(r[g]||"").split(", "),s=n(`${Mi}Delay`),i=n(`${Mi}Duration`),a=L2(s,i),o=n(`${nu}Delay`),l=n(`${nu}Duration`),c=L2(o,l);let u=null,f=0,h=0;e===Mi?a>0&&(u=Mi,f=a,h=i.length):e===nu?c>0&&(u=nu,f=c,h=l.length):(f=Math.max(a,c),u=f>0?a>c?Mi:nu:null,h=u?u===Mi?i.length:l.length:0);const p=u===Mi&&/\b(transform|all)(,|$)/.test(n(`${Mi}Property`).toString());return{type:u,timeout:f,propCount:h,hasTransform:p}}function L2(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((r,n)=>B2(r)+B2(t[n])))}function B2(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function rv(){return document.body.offsetHeight}function LR(t,e,r){const n=t[xc];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):r?t.setAttribute("class",e):t.className=e}const X0=Symbol("_vod"),PT=Symbol("_vsh"),RT={beforeMount(t,{value:e},{transition:r}){t[X0]=t.style.display==="none"?"":t.style.display,r&&e?r.beforeEnter(t):su(t,e)},mounted(t,{value:e},{transition:r}){r&&e&&r.enter(t)},updated(t,{value:e,oldValue:r},{transition:n}){!e!=!r&&(n?e?(n.beforeEnter(t),su(t,!0),n.enter(t)):n.leave(t,()=>{su(t,!1)}):su(t,e))},beforeUnmount(t,{value:e}){su(t,e)}};function su(t,e){t.style.display=e?t[X0]:"none",t[PT]=!e}function BR(){RT.getSSRProps=({value:t})=>{if(!t)return{style:{display:"none"}}}}const FT=Symbol("");function UR(t){const e=Xs();if(!e)return;const r=e.ut=(s=t(e.proxy))=>{Array.from(document.querySelectorAll(`[data-v-owner="${e.uid}"]`)).forEach(i=>Y0(i,s))},n=()=>{const s=t(e.proxy);e.ce?Y0(e.ce,s):nv(e.subTree,s),r(s)};S1(()=>{dd(n)}),Gt(()=>{Ht(n,js,{flush:"post"});const s=new MutationObserver(n);s.observe(e.subTree.el.parentNode,{childList:!0}),ja(()=>s.disconnect())})}function nv(t,e){if(t.shapeFlag&128){const r=t.suspense;t=r.activeBranch,r.pendingBranch&&!r.isHydrating&&r.effects.push(()=>{nv(r.activeBranch,e)})}for(;t.component;)t=t.component.subTree;if(t.shapeFlag&1&&t.el)Y0(t.el,e);else if(t.type===De)t.children.forEach(r=>nv(r,e));else if(t.type===jo){let{el:r,anchor:n}=t;for(;r&&(Y0(r,e),r!==n);)r=r.nextSibling}}function Y0(t,e){if(t.nodeType===1){const r=t.style;let n="";for(const s in e)r.setProperty(`--${s}`,e[s]),n+=`--${s}: ${e[s]};`;r[FT]=n}}const $R=/(^|;)\s*display\s*:/;function VR(t,e,r){const n=t.style,s=Tr(r);let i=!1;if(r&&!s){if(e)if(Tr(e))for(const a of e.split(";")){const o=a.slice(0,a.indexOf(":")).trim();r[o]==null&&y0(n,o,"")}else for(const a in e)r[a]==null&&y0(n,a,"");for(const a in r)a==="display"&&(i=!0),y0(n,a,r[a])}else if(s){if(e!==r){const a=n[FT];a&&(r+=";"+a),n.cssText=r,i=$R.test(r)}}else e&&t.removeAttribute("style");X0 in t&&(t[X0]=i?n.display:"",t[PT]&&(n.display="none"))}const U2=/\s*!important$/;function y0(t,e,r){if(dt(r))r.forEach(n=>y0(t,e,n));else if(r==null&&(r=""),e.startsWith("--"))t.setProperty(e,r);else{const n=HR(t,e);U2.test(r)?t.setProperty(_s(n),r.replace(U2,""),"important"):t[n]=r}}const $2=["Webkit","Moz","ms"],om={};function HR(t,e){const r=om[e];if(r)return r;let n=Pn(e);if(n!=="filter"&&n in t)return om[e]=n;n=Bd(n);for(let s=0;s<$2.length;s++){const i=$2[s]+n;if(i in t)return om[e]=i}return e}const V2="http://www.w3.org/1999/xlink";function H2(t,e,r,n,s,i=t3(e)){n&&e.startsWith("xlink:")?r==null?t.removeAttributeNS(V2,e.slice(6,e.length)):t.setAttributeNS(V2,e,r):r==null||i&&!YS(r)?t.removeAttribute(e):t.setAttribute(e,i?"":ga(r)?String(r):r)}function j2(t,e,r,n,s){if(e==="innerHTML"||e==="textContent"){r!=null&&(t[e]=e==="innerHTML"?wT(r):r);return}const i=t.tagName;if(e==="value"&&i!=="PROGRESS"&&!i.includes("-")){const o=i==="OPTION"?t.getAttribute("value")||"":t.value,l=r==null?t.type==="checkbox"?"on":"":String(r);(o!==l||!("_value"in t))&&(t.value=l),r==null&&t.removeAttribute(e),t._value=r;return}let a=!1;if(r===""||r==null){const o=typeof t[e];o==="boolean"?r=YS(r):r==null&&o==="string"?(r="",a=!0):o==="number"&&(r=0,a=!0)}try{t[e]=r}catch{}a&&t.removeAttribute(s||e)}function ri(t,e,r,n){t.addEventListener(e,r,n)}function jR(t,e,r,n){t.removeEventListener(e,r,n)}const G2=Symbol("_vei");function GR(t,e,r,n,s=null){const i=t[G2]||(t[G2]={}),a=i[e];if(n&&a)a.value=n;else{const[o,l]=WR(e);if(n){const c=i[e]=qR(n,s);ri(t,o,c,l)}else a&&(jR(t,o,a,l),i[e]=void 0)}}const W2=/(?:Once|Passive|Capture)$/;function WR(t){let e;if(W2.test(t)){e={};let n;for(;n=t.match(W2);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):_s(t.slice(2)),e]}let lm=0;const zR=Promise.resolve(),KR=()=>lm||(zR.then(()=>lm=0),lm=Date.now());function qR(t,e){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;zs(XR(n,r.value),e,5,[n])};return r.value=t,r.attached=KR(),r}function XR(t,e){if(dt(e)){const r=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{r.call(t),t._stopped=!0},e.map(n=>s=>!s._stopped&&n&&n(s))}else return e}const z2=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,YR=(t,e,r,n,s,i)=>{const a=s==="svg";e==="class"?LR(t,n,a):e==="style"?VR(t,r,n):Ld(e)?a1(e)||GR(t,e,r,n,i):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):QR(t,e,n,a))?(j2(t,e,n),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&H2(t,e,n,a,i,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Tr(n))?j2(t,Pn(e),n,i,e):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),H2(t,e,n,a))};function QR(t,e,r,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in t&&z2(e)&&Tt(r));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=t.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return z2(e)&&Tr(r)?!1:e in t}const K2={};/*! #__NO_SIDE_EFFECTS__ */function NT(t,e,r){const n=Ud(t,e);$h(n)&&xr(n,e);class s extends sp{constructor(a){super(n,a,r)}}return s.def=n,s}/*! #__NO_SIDE_EFFECTS__ */const JR=(t,e)=>NT(t,e,WT),ZR=typeof HTMLElement<"u"?HTMLElement:class{};class sp extends ZR{constructor(e,r={},n=J0){super(),this._def=e,this._props=r,this._createApp=n,this._isVueCE=!0,this._instance=null,this._app=null,this._nonce=this._def.nonce,this._connected=!1,this._resolved=!1,this._numberProps=null,this._styleChildren=new WeakSet,this._ob=null,this.shadowRoot&&n!==J0?this._root=this.shadowRoot:e.shadowRoot!==!1?(this.attachShadow({mode:"open"}),this._root=this.shadowRoot):this._root=this}connectedCallback(){if(!this.isConnected)return;!this.shadowRoot&&!this._resolved&&this._parseSlots(),this._connected=!0;let e=this;for(;e=e&&(e.parentNode||e.host);)if(e instanceof sp){this._parent=e;break}this._instance||(this._resolved?this._mount(this._def):e&&e._pendingResolve?this._pendingResolve=e._pendingResolve.then(()=>{this._pendingResolve=void 0,this._resolveDef()}):this._resolveDef())}_setParent(e=this._parent){e&&(this._instance.parent=e._instance,this._inheritParentContext(e))}_inheritParentContext(e=this._parent){e&&this._app&&Object.setPrototypeOf(this._app._context.provides,e._instance.provides)}disconnectedCallback(){this._connected=!1,hl(()=>{this._connected||(this._ob&&(this._ob.disconnect(),this._ob=null),this._app&&this._app.unmount(),this._instance&&(this._instance.ce=void 0),this._app=this._instance=null)})}_resolveDef(){if(this._pendingResolve)return;for(let n=0;n<this.attributes.length;n++)this._setAttr(this.attributes[n].name);this._ob=new MutationObserver(n=>{for(const s of n)this._setAttr(s.attributeName)}),this._ob.observe(this,{attributes:!0});const e=(n,s=!1)=>{this._resolved=!0,this._pendingResolve=void 0;const{props:i,styles:a}=n;let o;if(i&&!dt(i))for(const l in i){const c=i[l];(c===Number||c&&c.type===Number)&&(l in this._props&&(this._props[l]=B0(this._props[l])),(o||(o=Object.create(null)))[Pn(l)]=!0)}this._numberProps=o,this._resolveProps(n),this.shadowRoot&&this._applyStyles(a),this._mount(n)},r=this._def.__asyncLoader;r?this._pendingResolve=r().then(n=>{n.configureApp=this._def.configureApp,e(this._def=n,!0)}):e(this._def)}_mount(e){this._app=this._createApp(e),this._inheritParentContext(),e.configureApp&&e.configureApp(this._app),this._app._ceVNode=this._createVNode(),this._app.mount(this._root);const r=this._instance&&this._instance.exposed;if(r)for(const n in r)ur(this,n)||Object.defineProperty(this,n,{get:()=>q(r[n])})}_resolveProps(e){const{props:r}=e,n=dt(r)?r:Object.keys(r||{});for(const s of Object.keys(this))s[0]!=="_"&&n.includes(s)&&this._setProp(s,this[s]);for(const s of n.map(Pn))Object.defineProperty(this,s,{get(){return this._getProp(s)},set(i){this._setProp(s,i,!0,!0)}})}_setAttr(e){if(e.startsWith("data-v-"))return;const r=this.hasAttribute(e);let n=r?this.getAttribute(e):K2;const s=Pn(e);r&&this._numberProps&&this._numberProps[s]&&(n=B0(n)),this._setProp(s,n,!1,!0)}_getProp(e){return this._props[e]}_setProp(e,r,n=!0,s=!1){if(r!==this._props[e]&&(r===K2?delete this._props[e]:(this._props[e]=r,e==="key"&&this._app&&(this._app._ceVNode.key=r)),s&&this._instance&&this._update(),n)){const i=this._ob;i&&i.disconnect(),r===!0?this.setAttribute(_s(e),""):typeof r=="string"||typeof r=="number"?this.setAttribute(_s(e),r+""):r||this.removeAttribute(_s(e)),i&&i.observe(this,{attributes:!0})}}_update(){const e=this._createVNode();this._app&&(e.appContext=this._app._context),GT(e,this._root)}_createVNode(){const e={};this.shadowRoot||(e.onVnodeMounted=e.onVnodeUpdated=this._renderSlots.bind(this));const r=Pe(this._def,xr(e,this._props));return this._instance||(r.ce=n=>{this._instance=n,n.ce=this,n.isCE=!0;const s=(i,a)=>{this.dispatchEvent(new CustomEvent(i,$h(a[0])?xr({detail:a},a[0]):{detail:a}))};n.emit=(i,...a)=>{s(i,a),_s(i)!==i&&s(_s(i),a)},this._setParent()}),r}_applyStyles(e,r){if(!e)return;if(r){if(r===this._def||this._styleChildren.has(r))return;this._styleChildren.add(r)}const n=this._nonce;for(let s=e.length-1;s>=0;s--){const i=document.createElement("style");n&&i.setAttribute("nonce",n),i.textContent=e[s],this.shadowRoot.prepend(i)}}_parseSlots(){const e=this._slots={};let r;for(;r=this.firstChild;){const n=r.nodeType===1&&r.getAttribute("slot")||"default";(e[n]||(e[n]=[])).push(r),this.removeChild(r)}}_renderSlots(){const e=(this._teleportTarget||this).querySelectorAll("slot"),r=this._instance.type.__scopeId;for(let n=0;n<e.length;n++){const s=e[n],i=s.getAttribute("name")||"default",a=this._slots[i],o=s.parentNode;if(a)for(const l of a){if(r&&l.nodeType===1){const c=r+"-s",u=document.createTreeWalker(l,1);l.setAttribute(c,"");let f;for(;f=u.nextNode();)f.setAttribute(c,"")}o.insertBefore(l,s)}else for(;s.firstChild;)o.insertBefore(s.firstChild,s);o.removeChild(s)}}_injectChildStyle(e){this._applyStyles(e.styles,e)}_removeChildStyle(e){}}function OT(t){const e=Xs(),r=e&&e.ce;return r||null}function eF(){const t=OT();return t&&t.shadowRoot}function tF(t="$style"){{const e=Xs();if(!e)return Zt;const r=e.type.__cssModules;if(!r)return Zt;const n=r[t];return n||Zt}}const MT=new WeakMap,LT=new WeakMap,Q0=Symbol("_moveCb"),q2=Symbol("_enterCb"),rF=t=>(delete t.props.mode,t),nF=rF({name:"TransitionGroup",props:xr({},IT,{tag:String,moveClass:String}),setup(t,{slots:e}){const r=Xs(),n=E1();let s,i;return ep(()=>{if(!s.length)return;const a=t.moveClass||`${t.name||"v"}-move`;if(!lF(s[0].el,r.vnode.el,a)){s=[];return}s.forEach(aF),s.forEach(iF);const o=s.filter(oF);rv(),o.forEach(l=>{const c=l.el,u=c.style;Ca(c,a),u.transform=u.webkitTransform=u.transitionDuration="";const f=c[Q0]=h=>{h&&h.target!==c||(!h||/transform$/.test(h.propertyName))&&(c.removeEventListener("transitionend",f),c[Q0]=null,$i(c,a))};c.addEventListener("transitionend",f)}),s=[]}),()=>{const a=Yt(t),o=kT(a);let l=a.tag||De;if(s=[],i)for(let c=0;c<i.length;c++){const u=i[c];u.el&&u.el instanceof Element&&(s.push(u),Ei(u,vc(u,o,n,r)),MT.set(u,u.el.getBoundingClientRect()))}i=e.default?Jh(e.default()):[];for(let c=0;c<i.length;c++){const u=i[c];u.key!=null&&Ei(u,vc(u,o,n,r))}return Pe(l,null,i)}}}),sF=nF;function aF(t){const e=t.el;e[Q0]&&e[Q0](),e[q2]&&e[q2]()}function iF(t){LT.set(t,t.el.getBoundingClientRect())}function oF(t){const e=MT.get(t),r=LT.get(t),n=e.left-r.left,s=e.top-r.top;if(n||s){const i=t.el.style;return i.transform=i.webkitTransform=`translate(${n}px,${s}px)`,i.transitionDuration="0s",t}}function lF(t,e,r){const n=t.cloneNode(),s=t[xc];s&&s.forEach(o=>{o.split(/\s+/).forEach(l=>l&&n.classList.remove(l))}),r.split(/\s+/).forEach(o=>o&&n.classList.add(o)),n.style.display="none";const i=e.nodeType===1?e:e.parentNode;i.appendChild(n);const{hasTransform:a}=DT(n);return i.removeChild(n),a}const oo=t=>{const e=t.props["onUpdate:modelValue"]||!1;return dt(e)?r=>rc(e,r):e};function cF(t){t.target.composing=!0}function X2(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Gs=Symbol("_assign"),ft={created(t,{modifiers:{lazy:e,trim:r,number:n}},s){t[Gs]=oo(s);const i=n||s.props&&s.props.type==="number";ri(t,e?"change":"input",a=>{if(a.target.composing)return;let o=t.value;r&&(o=o.trim()),i&&(o=L0(o)),t[Gs](o)}),r&&ri(t,"change",()=>{t.value=t.value.trim()}),e||(ri(t,"compositionstart",cF),ri(t,"compositionend",X2),ri(t,"change",X2))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:r,modifiers:{lazy:n,trim:s,number:i}},a){if(t[Gs]=oo(a),t.composing)return;const o=(i||t.type==="number")&&!/^0\d/.test(t.value)?L0(t.value):t.value,l=e??"";o!==l&&(document.activeElement===t&&t.type!=="range"&&(n&&e===r||s&&t.value.trim()===l)||(t.value=l))}},bt={deep:!0,created(t,e,r){t[Gs]=oo(r),ri(t,"change",()=>{const n=t._modelValue,s=Ec(t),i=t.checked,a=t[Gs];if(dt(n)){const o=jh(n,s),l=o!==-1;if(i&&!l)a(n.concat(s));else if(!i&&l){const c=[...n];c.splice(o,1),a(c)}}else if(dl(n)){const o=new Set(n);i?o.add(s):o.delete(s),a(o)}else a(BT(t,i))})},mounted:Y2,beforeUpdate(t,e,r){t[Gs]=oo(r),Y2(t,e,r)}};function Y2(t,{value:e,oldValue:r},n){t._modelValue=e;let s;if(dt(e))s=jh(e,n.props.value)>-1;else if(dl(e))s=e.has(n.props.value);else{if(e===r)return;s=io(e,BT(t,!0))}t.checked!==s&&(t.checked=s)}const Ss={created(t,{value:e},r){t.checked=io(e,r.props.value),t[Gs]=oo(r),ri(t,"change",()=>{t[Gs](Ec(t))})},beforeUpdate(t,{value:e,oldValue:r},n){t[Gs]=oo(n),e!==r&&(t.checked=io(e,n.props.value))}},sr={deep:!0,created(t,{value:e,modifiers:{number:r}},n){const s=dl(e);ri(t,"change",()=>{const i=Array.prototype.filter.call(t.options,a=>a.selected).map(a=>r?L0(Ec(a)):Ec(a));t[Gs](t.multiple?s?new Set(i):i:i[0]),t._assigning=!0,hl(()=>{t._assigning=!1})}),t[Gs]=oo(n)},mounted(t,{value:e}){Q2(t,e)},beforeUpdate(t,e,r){t[Gs]=oo(r)},updated(t,{value:e}){t._assigning||Q2(t,e)}};function Q2(t,e){const r=t.multiple,n=dt(e);if(!(r&&!n&&!dl(e))){for(let s=0,i=t.options.length;s<i;s++){const a=t.options[s],o=Ec(a);if(r)if(n){const l=typeof o;l==="string"||l==="number"?a.selected=e.some(c=>String(c)===String(o)):a.selected=jh(e,o)>-1}else a.selected=e.has(o);else if(io(Ec(a),e)){t.selectedIndex!==s&&(t.selectedIndex=s);return}}!r&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Ec(t){return"_value"in t?t._value:t.value}function BT(t,e){const r=e?"_trueValue":"_falseValue";return r in t?t[r]:e}const UT={created(t,e,r){Of(t,e,r,null,"created")},mounted(t,e,r){Of(t,e,r,null,"mounted")},beforeUpdate(t,e,r,n){Of(t,e,r,n,"beforeUpdate")},updated(t,e,r,n){Of(t,e,r,n,"updated")}};function $T(t,e){switch(t){case"SELECT":return sr;case"TEXTAREA":return ft;default:switch(e){case"checkbox":return bt;case"radio":return Ss;default:return ft}}}function Of(t,e,r,n,s){const a=$T(t.tagName,r.props&&r.props.type)[s];a&&a(t,e,r,n)}function uF(){ft.getSSRProps=({value:t})=>({value:t}),Ss.getSSRProps=({value:t},e)=>{if(e.props&&io(e.props.value,t))return{checked:!0}},bt.getSSRProps=({value:t},e)=>{if(dt(t)){if(e.props&&jh(t,e.props.value)>-1)return{checked:!0}}else if(dl(t)){if(e.props&&t.has(e.props.value))return{checked:!0}}else if(t)return{checked:!0}},UT.getSSRProps=(t,e)=>{if(typeof e.type!="string")return;const r=$T(e.type.toUpperCase(),e.props&&e.props.type);if(r.getSSRProps)return r.getSSRProps(t,e)}}const dF=["ctrl","shift","alt","meta"],fF={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>dF.some(r=>t[`${r}Key`]&&!e.includes(r))},Yr=(t,e)=>{const r=t._withMods||(t._withMods={}),n=e.join(".");return r[n]||(r[n]=(s,...i)=>{for(let a=0;a<e.length;a++){const o=fF[e[a]];if(o&&o(s,e))return}return t(s,...i)})},hF={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},F1=(t,e)=>{const r=t._withKeys||(t._withKeys={}),n=e.join(".");return r[n]||(r[n]=s=>{if(!("key"in s))return;const i=_s(s.key);if(e.some(a=>a===i||hF[a]===i))return t(s)})},VT=xr({patchProp:YR},RR);let Lu,J2=!1;function HT(){return Lu||(Lu=tT(VT))}function jT(){return Lu=J2?Lu:rT(VT),J2=!0,Lu}const GT=(...t)=>{HT().render(...t)},pF=(...t)=>{jT().hydrate(...t)},J0=(...t)=>{const e=HT().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=KT(n);if(!s)return;const i=e._component;!Tt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const a=r(s,!1,zT(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},e},WT=(...t)=>{const e=jT().createApp(...t),{mount:r}=e;return e.mount=n=>{const s=KT(n);if(s)return r(s,!0,zT(s))},e};function zT(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function KT(t){return Tr(t)?document.querySelector(t):t}let Z2=!1;const mF=()=>{Z2||(Z2=!0,uF(),BR())};/**
* vue v3.5.17
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const gF=()=>{},vF=Object.freeze(Object.defineProperty({__proto__:null,BaseTransition:PA,BaseTransitionPropsValidators:_1,Comment:Xr,DeprecationTypes:kR,EffectScope:c1,ErrorCodes:H3,ErrorTypeStrings:bR,Fragment:De,KeepAlive:pP,ReactiveEffect:ld,Static:jo,Suspense:sR,Teleport:Y3,Text:ro,TrackOpTypes:O3,Transition:NR,TransitionGroup:sF,TriggerOpTypes:M3,VueElement:sp,assertNumber:V3,callWithAsyncErrorHandling:zs,callWithErrorHandling:Mc,camelize:Pn,capitalize:Bd,cloneVNode:Ba,compatUtils:IR,compile:gF,computed:Se,createApp:J0,createBlock:Jt,createCommentVNode:_e,createElementBlock:B,createElementVNode:d,createHydrationRenderer:rT,createPropsRestProxy:RP,createRenderer:tT,createSSRApp:WT,createSlots:yP,createStaticVNode:Rn,createTextVNode:we,createVNode:Pe,customRef:gA,defineAsyncComponent:fP,defineComponent:Ud,defineCustomElement:NT,defineEmits:bP,defineExpose:SP,defineModel:wP,defineOptions:AP,defineProps:_P,defineSSRCustomElement:JR,defineSlots:TP,devtools:SR,effect:s3,effectScope:u1,getCurrentInstance:Xs,getCurrentScope:d1,getCurrentWatcher:L3,getTransitionRawChildren:Jh,guardReactiveProps:vT,h:el,handleError:fl,hasInjectionContext:zA,hydrate:pF,hydrateOnIdle:iP,hydrateOnInteraction:uP,hydrateOnMediaQuery:cP,hydrateOnVisible:lP,initCustomFormatter:xR,initDirectivesForSSR:mF,inject:Ns,isMemoSame:AT,isProxy:qh,isReactive:Fa,isReadonly:xi,isRef:Cr,isRuntimeOnly:gR,isShallow:Fs,isVNode:_i,markRaw:Xh,mergeDefaults:DP,mergeModels:PP,mergeProps:yT,nextTick:hl,normalizeClass:Xe,normalizeProps:ZD,normalizeStyle:Nr,onActivated:FA,onBeforeMount:MA,onBeforeUnmount:tp,onBeforeUpdate:S1,onDeactivated:NA,onErrorCaptured:$A,onMounted:Gt,onRenderTracked:UA,onRenderTriggered:BA,onScopeDispose:ZS,onServerPrefetch:LA,onUnmounted:ja,onUpdated:ep,onWatcherCleanup:xA,openBlock:L,popScopeId:K3,provide:Ou,proxyRefs:y1,pushScopeId:z3,queuePostFlushCb:dd,reactive:As,readonly:g1,ref:se,registerRuntimeCompiler:mR,render:GT,renderList:$e,renderSlot:HA,resolveComponent:_r,resolveDirective:vP,resolveDynamicComponent:T1,resolveFilter:CR,resolveTransitionHooks:vc,setBlockTracking:Xg,setDevtoolsHook:AR,setTransitionHooks:Ei,shallowReactive:m1,shallowReadonly:A3,shallowRef:v1,ssrContextKey:iT,ssrUtils:wR,stop:a3,toDisplayString:Z,toHandlerKey:Du,toHandlers:xP,toRaw:Yt,toRef:R3,toRefs:vA,toValue:C3,transformVNodeArgs:uR,triggerRef:w3,unref:q,useAttrs:kP,useCssModule:tF,useCssVars:UR,useHost:OT,useId:J3,useModel:QP,useSSRContext:oT,useShadowRoot:eF,useSlots:IP,useTemplateRef:Z3,useTransitionState:E1,vModelCheckbox:bt,vModelDynamic:UT,vModelRadio:Ss,vModelSelect:sr,vModelText:ft,vShow:RT,version:TT,warn:_R,watch:Ht,watchEffect:qP,watchPostEffect:XP,watchSyncEffect:lT,withAsyncContext:FP,withCtx:Qh,withDefaults:CP,withDirectives:Ne,withKeys:F1,withMemo:ER,withModifiers:Yr,withScopeId:q3},Symbol.toStringTag,{value:"Module"}));/*!
 * pinia v2.3.1
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */let qT;const ap=t=>qT=t,XT=Symbol();function sv(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var Bu;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(Bu||(Bu={}));function yF(){const t=u1(!0),e=t.run(()=>se({}));let r=[],n=[];const s=Xh({install(i){ap(s),s._a=i,i.provide(XT,s),i.config.globalProperties.$pinia=s,n.forEach(a=>r.push(a)),n=[]},use(i){return this._a?r.push(i):n.push(i),this},_p:r,_a:null,_e:t,_s:new Map,state:e});return s}const YT=()=>{};function eE(t,e,r,n=YT){t.push(e);const s=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),n())};return!r&&d1()&&ZS(s),s}function Nl(t,...e){t.slice().forEach(r=>{r(...e)})}const xF=t=>t(),tE=Symbol(),cm=Symbol();function av(t,e){t instanceof Map&&e instanceof Map?e.forEach((r,n)=>t.set(n,r)):t instanceof Set&&e instanceof Set&&e.forEach(t.add,t);for(const r in e){if(!e.hasOwnProperty(r))continue;const n=e[r],s=t[r];sv(s)&&sv(n)&&t.hasOwnProperty(r)&&!Cr(n)&&!Fa(n)?t[r]=av(s,n):t[r]=n}return t}const EF=Symbol();function _F(t){return!sv(t)||!t.hasOwnProperty(EF)}const{assign:Vi}=Object;function bF(t){return!!(Cr(t)&&t.effect)}function SF(t,e,r,n){const{state:s,actions:i,getters:a}=e,o=r.state.value[t];let l;function c(){o||(r.state.value[t]=s?s():{});const u=vA(r.state.value[t]);return Vi(u,i,Object.keys(a||{}).reduce((f,h)=>(f[h]=Xh(Se(()=>{ap(r);const p=r._s.get(t);return a[h].call(p,p)})),f),{}))}return l=QT(t,c,e,r,n,!0),l}function QT(t,e,r={},n,s,i){let a;const o=Vi({actions:{}},r),l={deep:!0};let c,u,f=[],h=[],p;const g=n.state.value[t];!i&&!g&&(n.state.value[t]={}),se({});let y;function E(x){let m;c=u=!1,typeof x=="function"?(x(n.state.value[t]),m={type:Bu.patchFunction,storeId:t,events:p}):(av(n.state.value[t],x),m={type:Bu.patchObject,payload:x,storeId:t,events:p});const S=y=Symbol();hl().then(()=>{y===S&&(c=!0)}),u=!0,Nl(f,m,n.state.value[t])}const b=i?function(){const{state:m}=r,S=m?m():{};this.$patch(I=>{Vi(I,S)})}:YT;function _(){a.stop(),f=[],h=[],n._s.delete(t)}const v=(x,m="")=>{if(tE in x)return x[cm]=m,x;const S=function(){ap(n);const I=Array.from(arguments),C=[],F=[];function W(N){C.push(N)}function P(N){F.push(N)}Nl(h,{args:I,name:S[cm],store:D,after:W,onError:P});let R;try{R=x.apply(this&&this.$id===t?this:D,I)}catch(N){throw Nl(F,N),N}return R instanceof Promise?R.then(N=>(Nl(C,N),N)).catch(N=>(Nl(F,N),Promise.reject(N))):(Nl(C,R),R)};return S[tE]=!0,S[cm]=m,S},A={_p:n,$id:t,$onAction:eE.bind(null,h),$patch:E,$reset:b,$subscribe(x,m={}){const S=eE(f,x,m.detached,()=>I()),I=a.run(()=>Ht(()=>n.state.value[t],C=>{(m.flush==="sync"?u:c)&&x({storeId:t,type:Bu.direct,events:p},C)},Vi({},l,m)));return S},$dispose:_},D=As(A);n._s.set(t,D);const T=(n._a&&n._a.runWithContext||xF)(()=>n._e.run(()=>(a=u1()).run(()=>e({action:v}))));for(const x in T){const m=T[x];if(Cr(m)&&!bF(m)||Fa(m))i||(g&&_F(m)&&(Cr(m)?m.value=g[x]:av(m,g[x])),n.state.value[t][x]=m);else if(typeof m=="function"){const S=v(m,x);T[x]=S,o.actions[x]=m}}return Vi(D,T),Vi(Yt(D),T),Object.defineProperty(D,"$state",{get:()=>n.state.value[t],set:x=>{E(m=>{Vi(m,x)})}}),n._p.forEach(x=>{Vi(D,a.run(()=>x({store:D,app:n._a,pinia:n,options:o})))}),g&&i&&r.hydrate&&r.hydrate(D.$state,g),c=!0,u=!0,D}/*! #__NO_SIDE_EFFECTS__ */function JT(t,e,r){let n,s;const i=typeof e=="function";typeof t=="string"?(n=t,s=i?r:e):(s=t,n=t.id);function a(o,l){const c=zA();return o=o||(c?Ns(XT,null):null),o&&ap(o),o=qT,o._s.has(n)||(i?QT(n,e,s,o):SF(n,s,o)),o._s.get(n)}return a.$id=n,a}var rE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZT=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e},AF=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const s=t[r++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[r++];e[n++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[r++],a=t[r++],o=t[r++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(l>>10)),e[n++]=String.fromCharCode(56320+(l&1023))}else{const i=t[r++],a=t[r++];e[n++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},ew={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<t.length;s+=3){const i=t[s],a=s+1<t.length,o=a?t[s+1]:0,l=s+2<t.length,c=l?t[s+2]:0,u=i>>2,f=(i&3)<<4|o>>4;let h=(o&15)<<2|c>>6,p=c&63;l||(p=64,a||(h=64)),n.push(r[u],r[f],r[h],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ZT(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):AF(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<t.length;){const i=r[t.charAt(s++)],o=s<t.length?r[t.charAt(s)]:0;++s;const c=s<t.length?r[t.charAt(s)]:64;++s;const f=s<t.length?r[t.charAt(s)]:64;if(++s,i==null||o==null||c==null||f==null)throw new TF;const h=i<<2|o>>4;if(n.push(h),c!==64){const p=o<<4&240|c>>2;if(n.push(p),f!==64){const g=c<<6&192|f;n.push(g)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class TF extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wF=function(t){const e=ZT(t);return ew.encodeByteArray(e,!0)},Z0=function(t){return wF(t).replace(/\./g,"")},tw=function(t){try{return ew.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IF=()=>CF().__FIREBASE_DEFAULTS__,kF=()=>{if(typeof process>"u"||typeof rE>"u")return;const t=rE.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},DF=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&tw(t[1]);return e&&JSON.parse(e)},ip=()=>{try{return IF()||kF()||DF()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},rw=t=>{var e,r;return(r=(e=ip())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},N1=t=>{const e=rw(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},nw=()=>{var t;return(t=ip())===null||t===void 0?void 0:t.config},sw=t=>{var e;return(e=ip())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Z0(JSON.stringify(r)),Z0(JSON.stringify(a)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ts(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function RF(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ts())}function FF(){var t;const e=(t=ip())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NF(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function OF(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function MF(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function LF(){const t=ts();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function BF(){return!FF()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function UF(){try{return typeof indexedDB=="object"}catch{return!1}}function $F(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},s.onupgradeneeded=()=>{r=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VF="FirebaseError";class Ea extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=VF,Object.setPrototypeOf(this,Ea.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jd.prototype.create)}}class jd{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?HF(i,n):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new Ea(s,o,n)}}function HF(t,e){return t.replace(jF,(r,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const jF=/\{\$([^}]+)}/g;function GF(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function eh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const s of r){if(!n.includes(s))return!1;const i=t[s],a=e[s];if(nE(i)&&nE(a)){if(!eh(i,a))return!1}else if(i!==a)return!1}for(const s of n)if(!r.includes(s))return!1;return!0}function nE(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gd(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function WF(t,e){const r=new zF(t,e);return r.subscribe.bind(r)}class zF{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let s;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");KF(e,["next","error","complete"])?s=e:s={next:e,error:r,complete:n},s.next===void 0&&(s.next=um),s.error===void 0&&(s.error=um),s.complete===void 0&&(s.complete=um);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function KF(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function um(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(t){return t&&t._delegate?t._delegate:t}class bi{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new PF;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:r});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(r=e==null?void 0:e.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(YF(e))try{this.getOrInitializeService({instanceIdentifier:No})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(r);try{const i=this.getOrInitializeService({instanceIdentifier:s});n.resolve(i)}catch{}}}}clearInstance(e=No){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=No){return this.instances.has(e)}getOptions(e=No){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);n===o&&a.resolve(s)}return s}onInit(e,r){var n;const s=this.normalizeInstanceIdentifier(r),i=(n=this.onInitCallbacks.get(s))!==null&&n!==void 0?n:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const s of n)try{s(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:XF(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=No){return this.component?this.component.multipleInstances?e:No:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XF(t){return t===No?void 0:t}function YF(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new qF(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Qt||(Qt={}));const JF={debug:Qt.DEBUG,verbose:Qt.VERBOSE,info:Qt.INFO,warn:Qt.WARN,error:Qt.ERROR,silent:Qt.SILENT},ZF=Qt.INFO,e8={[Qt.DEBUG]:"log",[Qt.VERBOSE]:"log",[Qt.INFO]:"info",[Qt.WARN]:"warn",[Qt.ERROR]:"error"},t8=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),s=e8[e];if(s)console[s](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class O1{constructor(e){this.name=e,this._logLevel=ZF,this._logHandler=t8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qt.DEBUG,...e),this._logHandler(this,Qt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qt.VERBOSE,...e),this._logHandler(this,Qt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qt.INFO,...e),this._logHandler(this,Qt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qt.WARN,...e),this._logHandler(this,Qt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qt.ERROR,...e),this._logHandler(this,Qt.ERROR,...e)}}const r8=(t,e)=>e.some(r=>t instanceof r);let sE,aE;function n8(){return sE||(sE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s8(){return aE||(aE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iw=new WeakMap,iv=new WeakMap,ow=new WeakMap,dm=new WeakMap,M1=new WeakMap;function a8(t){const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",a)},i=()=>{r(no(t.result)),s()},a=()=>{n(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&iw.set(r,t)}).catch(()=>{}),M1.set(e,t),e}function i8(t){if(iv.has(t))return;const e=new Promise((r,n)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",a),t.removeEventListener("abort",a)},i=()=>{r(),s()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",a),t.addEventListener("abort",a)});iv.set(t,e)}let ov={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return iv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||ow.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return no(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function o8(t){ov=t(ov)}function l8(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(fm(this),e,...r);return ow.set(n,e.sort?e.sort():[e]),no(n)}:s8().includes(t)?function(...e){return t.apply(fm(this),e),no(iw.get(this))}:function(...e){return no(t.apply(fm(this),e))}}function c8(t){return typeof t=="function"?l8(t):(t instanceof IDBTransaction&&i8(t),r8(t,n8())?new Proxy(t,ov):t)}function no(t){if(t instanceof IDBRequest)return a8(t);if(dm.has(t))return dm.get(t);const e=c8(t);return e!==t&&(dm.set(t,e),M1.set(e,t)),e}const fm=t=>M1.get(t);function u8(t,e,{blocked:r,upgrade:n,blocking:s,terminated:i}={}){const a=indexedDB.open(t,e),o=no(a);return n&&a.addEventListener("upgradeneeded",l=>{n(no(a.result),l.oldVersion,l.newVersion,no(a.transaction),l)}),r&&a.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),o}const d8=["get","getKey","getAll","getAllKeys","count"],f8=["put","add","delete","clear"],hm=new Map;function iE(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(hm.get(e))return hm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,s=f8.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(s||d8.includes(r)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let c=l.store;return n&&(c=c.index(o.shift())),(await Promise.all([c[r](...o),s&&l.done]))[0]};return hm.set(e,i),i}o8(t=>({...t,get:(e,r,n)=>iE(e,r)||t.get(e,r,n),has:(e,r)=>!!iE(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h8{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(p8(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function p8(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lv="@firebase/app",oE="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Si=new O1("@firebase/app"),m8="@firebase/app-compat",g8="@firebase/analytics-compat",v8="@firebase/analytics",y8="@firebase/app-check-compat",x8="@firebase/app-check",E8="@firebase/auth",_8="@firebase/auth-compat",b8="@firebase/database",S8="@firebase/data-connect",A8="@firebase/database-compat",T8="@firebase/functions",w8="@firebase/functions-compat",C8="@firebase/installations",I8="@firebase/installations-compat",k8="@firebase/messaging",D8="@firebase/messaging-compat",P8="@firebase/performance",R8="@firebase/performance-compat",F8="@firebase/remote-config",N8="@firebase/remote-config-compat",O8="@firebase/storage",M8="@firebase/storage-compat",L8="@firebase/firestore",B8="@firebase/vertexai-preview",U8="@firebase/firestore-compat",$8="firebase",V8="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cv="[DEFAULT]",H8={[lv]:"fire-core",[m8]:"fire-core-compat",[v8]:"fire-analytics",[g8]:"fire-analytics-compat",[x8]:"fire-app-check",[y8]:"fire-app-check-compat",[E8]:"fire-auth",[_8]:"fire-auth-compat",[b8]:"fire-rtdb",[S8]:"fire-data-connect",[A8]:"fire-rtdb-compat",[T8]:"fire-fn",[w8]:"fire-fn-compat",[C8]:"fire-iid",[I8]:"fire-iid-compat",[k8]:"fire-fcm",[D8]:"fire-fcm-compat",[P8]:"fire-perf",[R8]:"fire-perf-compat",[F8]:"fire-rc",[N8]:"fire-rc-compat",[O8]:"fire-gcs",[M8]:"fire-gcs-compat",[L8]:"fire-fst",[U8]:"fire-fst-compat",[B8]:"fire-vertex","fire-js":"fire-js",[$8]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th=new Map,j8=new Map,uv=new Map;function lE(t,e){try{t.container.addComponent(e)}catch(r){Si.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function lo(t){const e=t.name;if(uv.has(e))return Si.debug(`There were multiple attempts to register component ${e}.`),!1;uv.set(e,t);for(const r of th.values())lE(r,t);for(const r of j8.values())lE(r,t);return!0}function Wd(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function oi(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},so=new jd("app","Firebase",G8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W8{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new bi("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw so.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pl=V8;function lw(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:cv,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw so.create("bad-app-name",{appName:String(s)});if(r||(r=nw()),!r)throw so.create("no-options");const i=th.get(s);if(i){if(eh(r,i.options)&&eh(n,i.config))return i;throw so.create("duplicate-app",{appName:s})}const a=new QF(s);for(const l of uv.values())a.addComponent(l);const o=new W8(r,n,a);return th.set(s,o),o}function zd(t=cv){const e=th.get(t);if(!e&&t===cv&&nw())return lw();if(!e)throw so.create("no-app",{appName:t});return e}function Ws(t,e,r){var n;let s=(n=H8[t])!==null&&n!==void 0?n:t;r&&(s+=`-${r}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Si.warn(o.join(" "));return}lo(new bi(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z8="firebase-heartbeat-database",K8=1,gd="firebase-heartbeat-store";let pm=null;function cw(){return pm||(pm=u8(z8,K8,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(gd)}catch(r){console.warn(r)}}}}).catch(t=>{throw so.create("idb-open",{originalErrorMessage:t.message})})),pm}async function q8(t){try{const r=(await cw()).transaction(gd),n=await r.objectStore(gd).get(uw(t));return await r.done,n}catch(e){if(e instanceof Ea)Si.warn(e.message);else{const r=so.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Si.warn(r.message)}}}async function cE(t,e){try{const n=(await cw()).transaction(gd,"readwrite");await n.objectStore(gd).put(e,uw(t)),await n.done}catch(r){if(r instanceof Ea)Si.warn(r.message);else{const n=so.create("idb-set",{originalErrorMessage:r==null?void 0:r.message});Si.warn(n.message)}}}function uw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X8=1024,Y8=30*24*60*60*1e3;class Q8{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Z8(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=uE();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=Y8}),this._storage.overwrite(this._heartbeatsCache))}catch(n){Si.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=uE(),{heartbeatsToSend:n,unsentEntries:s}=J8(this._heartbeatsCache.heartbeats),i=Z0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(r){return Si.warn(r),""}}}function uE(){return new Date().toISOString().substring(0,10)}function J8(t,e=X8){const r=[];let n=t.slice();for(const s of t){const i=r.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),dE(r)>e){i.dates.pop();break}}else if(r.push({agent:s.agent,dates:[s.date]}),dE(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Z8{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return UF()?$F().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await q8(this.app);return r!=null&&r.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return cE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const s=await this.read();return cE(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function dE(t){return Z0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e6(t){lo(new bi("platform-logger",e=>new h8(e),"PRIVATE")),lo(new bi("heartbeat",e=>new Q8(e),"PRIVATE")),Ws(lv,oE,t),Ws(lv,oE,"esm2017"),Ws("fire-js","")}e6("");function L1(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function dw(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const fw=dw,hw=new jd("auth","Firebase",dw());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh=new O1("@firebase/auth");function t6(t,...e){rh.logLevel<=Qt.WARN&&rh.warn(`Auth (${pl}): ${t}`,...e)}function x0(t,...e){rh.logLevel<=Qt.ERROR&&rh.error(`Auth (${pl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(t,...e){throw U1(t,...e)}function pa(t,...e){return U1(t,...e)}function B1(t,e,r){const n=Object.assign(Object.assign({},fw()),{[e]:r});return new jd("auth","Firebase",n).create(e,{appName:t.name})}function Go(t){return B1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function r6(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&Ua(t,"argument-error"),B1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function U1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return hw.create(t,...e)}function Dt(t,e,...r){if(!t)throw U1(e,...r)}function li(t){const e="INTERNAL ASSERTION FAILED: "+t;throw x0(e),new Error(e)}function Ai(t,e){t||li(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function n6(){return fE()==="http:"||fE()==="https:"}function fE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s6(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(n6()||OF()||"connection"in navigator)?navigator.onLine:!0}function a6(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ai(r>e,"Short delay should be less than long delay!"),this.isMobile=RF()||MF()}get(){return s6()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $1(t,e){Ai(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;li("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;li("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;li("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i6={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o6=new Kd(3e4,6e4);function V1(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Lc(t,e,r,n,s={}){return mw(t,s,async()=>{let i={},a={};n&&(e==="GET"?a=n:i={body:JSON.stringify(n)});const o=Gd(Object.assign({key:t.config.apiKey},a)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},i);return NF()||(c.referrerPolicy="no-referrer"),pw.fetch()(gw(t,t.config.apiHost,r,o),c)})}async function mw(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},i6),e);try{const s=new c6(t),i=await Promise.race([r(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw Mf(t,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,c]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Mf(t,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw Mf(t,"email-already-in-use",a);if(l==="USER_DISABLED")throw Mf(t,"user-disabled",a);const u=n[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw B1(t,u,c);Ua(t,u)}}catch(s){if(s instanceof Ea)throw s;Ua(t,"network-request-failed",{message:String(s)})}}async function l6(t,e,r,n,s={}){const i=await Lc(t,e,r,n,s);return"mfaPendingCredential"in i&&Ua(t,"multi-factor-auth-required",{_serverResponse:i}),i}function gw(t,e,r,n){const s=`${e}${r}?${n}`;return t.config.emulator?$1(t.config,s):`${t.config.apiScheme}://${s}`}class c6{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(pa(this.auth,"network-request-failed")),o6.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Mf(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const s=pa(t,e,n);return s.customData._tokenResponse=r,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u6(t,e){return Lc(t,"POST","/v1/accounts:delete",e)}async function vw(t,e){return Lc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fv(t,e=!1){return dr(t).getIdToken(e)}async function yw(t,e=!1){const r=dr(t),n=await r.getIdToken(e),s=H1(n);Dt(s&&s.exp&&s.auth_time&&s.iat,r.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:n,authTime:Uu(mm(s.auth_time)),issuedAtTime:Uu(mm(s.iat)),expirationTime:Uu(mm(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function mm(t){return Number(t)*1e3}function H1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return x0("JWT malformed, contained fewer than 3 sections"),null;try{const s=tw(r);return s?JSON.parse(s):(x0("Failed to decode base64 JWT payload"),null)}catch(s){return x0("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function hE(t){const e=H1(t);return Dt(e,"internal-error"),Dt(typeof e.exp<"u","internal-error"),Dt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vd(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof Ea&&d6(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function d6({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const s=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Uu(this.lastLoginAt),this.creationTime=Uu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nh(t){var e;const r=t.auth,n=await t.getIdToken(),s=await vd(t,vw(r,{idToken:n}));Dt(s==null?void 0:s.users.length,r,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Ew(i.providerUserInfo):[],o=h6(t.providerData,a),l=t.isAnonymous,c=!(t.email&&i.passwordHash)&&!(o!=null&&o.length),u=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new hv(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,f)}async function xw(t){const e=dr(t);await nh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function h6(t,e){return[...t.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function Ew(t){return t.map(e=>{var{providerId:r}=e,n=L1(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p6(t,e){const r=await mw(t,{},async()=>{const n=Gd({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,a=gw(t,s,"/v1/token",`key=${i}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",pw.fetch()(a,{method:"POST",headers:o,body:n})});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function m6(t,e){return Lc(t,"POST","/v2/accounts:revokeToken",V1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Dt(e.idToken,"internal-error"),Dt(typeof e.idToken<"u","internal-error"),Dt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Dt(e.length!==0,"internal-error");const r=hE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Dt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:s,expiresIn:i}=await p6(e,r);this.updateTokensAndExpiration(n,s,Number(i))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:s,expirationTime:i}=r,a=new ic;return n&&(Dt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),s&&(Dt(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Dt(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ic,this.toJSON())}_performRefresh(){return li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Li(t,e){Dt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ci{constructor(e){var{uid:r,auth:n,stsTokenManager:s}=e,i=L1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new f6(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new hv(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const r=await vd(this,this.stsTokenManager.getToken(this.auth,e));return Dt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return yw(this,e)}reload(){return xw(this)}_assign(e){this!==e&&(Dt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new ci(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){Dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await nh(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(oi(this.auth.app))return Promise.reject(Go(this.auth));const e=await this.getIdToken();return await vd(this,u6(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,s,i,a,o,l,c,u;const f=(n=r.displayName)!==null&&n!==void 0?n:void 0,h=(s=r.email)!==null&&s!==void 0?s:void 0,p=(i=r.phoneNumber)!==null&&i!==void 0?i:void 0,g=(a=r.photoURL)!==null&&a!==void 0?a:void 0,y=(o=r.tenantId)!==null&&o!==void 0?o:void 0,E=(l=r._redirectEventId)!==null&&l!==void 0?l:void 0,b=(c=r.createdAt)!==null&&c!==void 0?c:void 0,_=(u=r.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:v,emailVerified:A,isAnonymous:D,providerData:k,stsTokenManager:T}=r;Dt(v&&T,e,"internal-error");const x=ic.fromJSON(this.name,T);Dt(typeof v=="string",e,"internal-error"),Li(f,e.name),Li(h,e.name),Dt(typeof A=="boolean",e,"internal-error"),Dt(typeof D=="boolean",e,"internal-error"),Li(p,e.name),Li(g,e.name),Li(y,e.name),Li(E,e.name),Li(b,e.name),Li(_,e.name);const m=new ci({uid:v,auth:e,email:h,emailVerified:A,displayName:f,isAnonymous:D,photoURL:g,phoneNumber:p,tenantId:y,stsTokenManager:x,createdAt:b,lastLoginAt:_});return k&&Array.isArray(k)&&(m.providerData=k.map(S=>Object.assign({},S))),E&&(m._redirectEventId=E),m}static async _fromIdTokenResponse(e,r,n=!1){const s=new ic;s.updateFromServerResponse(r);const i=new ci({uid:r.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await nh(i),i}static async _fromGetAccountInfoResponse(e,r,n){const s=r.users[0];Dt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Ew(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new ic;o.updateFromIdToken(n);const l=new ci({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new hv(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE=new Map;function ui(t){Ai(t instanceof Function,"Expected a class definition");let e=pE.get(t);return e?(Ai(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,pE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}_w.type="NONE";const pv=_w;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(t,e,r){return`firebase:${t}:${e}:${r}`}class oc{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:s,name:i}=this.auth;this.fullUserKey=E0(this.userKey,s.apiKey,i),this.fullPersistenceKey=E0("persistence",s.apiKey,i),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ci._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new oc(ui(pv),e,n);const s=(await Promise.all(r.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||ui(pv);const a=E0(n,e.config.apiKey,e.name);let o=null;for(const c of r)try{const u=await c._get(a);if(u){const f=ci._fromJSON(e,u);c!==i&&(o=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new oc(i,e,n):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(r.map(async c=>{if(c!==i)try{await c._remove(a)}catch{}})),new oc(i,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Tw(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(bw(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Cw(e))return"Blackberry";if(Iw(e))return"Webos";if(Sw(e))return"Safari";if((e.includes("chrome/")||Aw(e))&&!e.includes("edge/"))return"Chrome";if(ww(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function bw(t=ts()){return/firefox\//i.test(t)}function Sw(t=ts()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Aw(t=ts()){return/crios\//i.test(t)}function Tw(t=ts()){return/iemobile/i.test(t)}function ww(t=ts()){return/android/i.test(t)}function Cw(t=ts()){return/blackberry/i.test(t)}function Iw(t=ts()){return/webos/i.test(t)}function j1(t=ts()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function g6(t=ts()){var e;return j1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function v6(){return LF()&&document.documentMode===10}function kw(t=ts()){return j1(t)||ww(t)||Iw(t)||Cw(t)||/windows phone/i.test(t)||Tw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(t,e=[]){let r;switch(t){case"Browser":r=mE(ts());break;case"Worker":r=`${mE(ts())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${pl}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});n.onAbort=r,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const s of r)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x6(t,e={}){return Lc(t,"GET","/v2/passwordPolicy",V1(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E6=6;class _6{constructor(e){var r,n,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:E6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,s,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(r=l.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(n=l.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),s&&(r.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e,r,n,s){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gE(this),this.idTokenSubscription=new gE(this),this.beforeStateQueue=new y6(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hw,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=ui(r)),this._initializationPromise=this.queue(async()=>{var n,s;if(!this._deleted&&(this.persistenceManager=await oc.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await vw(this,{idToken:e}),n=await ci._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(oi(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let s=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Dt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await nh(e)}catch(r){if((r==null?void 0:r.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=a6()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(oi(this.app))return Promise.reject(Go(this));const r=e?dr(e):null;return r&&Dt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Dt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return oi(this.app)?Promise.reject(Go(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return oi(this.app)?Promise.reject(Go(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ui(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await x6(this),r=new _6(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new jd("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await m6(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&ui(e)||this._popupRedirectResolver;Dt(r,this,"argument-error"),this.redirectPersistenceManager=await oc.create(this,[ui(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,s){if(this._deleted)return()=>{};const i=typeof r=="function"?r:r.next.bind(r);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Dt(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof r=="function"){const l=e.addObserver(r,n,s);return()=>{a=!0,l()}}else{const l=e.addObserver(r);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Dw(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const s=await this._getAppCheckToken();return s&&(r["X-Firebase-AppCheck"]=s),r}async _getAppCheckToken(){var e;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r!=null&&r.error&&t6(`Error while retrieving App Check token: ${r.error}`),r==null?void 0:r.token}}function op(t){return dr(t)}class gE{constructor(e){this.auth=e,this.observer=null,this.addObserver=WF(r=>this.observer=r)}get next(){return Dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let G1={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function S6(t){G1=t}function A6(t){return G1.loadJS(t)}function T6(){return G1.gapiScript}function w6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pw(t,e){const r=Wd(t,"auth");if(r.isInitialized()){const s=r.getImmediate(),i=r.getOptions();if(eh(i,e??{}))return s;Ua(s,"already-initialized")}return r.initialize({options:e})}function C6(t,e){const r=(e==null?void 0:e.persistence)||[],n=(Array.isArray(r)?r:[r]).map(ui);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function Rw(t,e,r){const n=op(t);Dt(n._canInitEmulator,n,"emulator-config-failed"),Dt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,i=Fw(e),{host:a,port:o}=I6(e),l=o===null?"":`:${o}`;n.config.emulator={url:`${i}//${a}${l}/`},n.settings.appVerificationDisabledForTesting=!0,n.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),k6()}function Fw(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function I6(t){const e=Fw(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const i=s[1];return{host:i,port:vE(n.substr(i.length+1))}}else{const[i,a]=n.split(":");return{host:i,port:vE(a)}}}function vE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function k6(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return li("not implemented")}_getIdTokenResponse(e){return li("not implemented")}_linkToIdToken(e,r){return li("not implemented")}_getReauthenticationResolver(e){return li("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lc(t,e){return l6(t,"POST","/v1/accounts:signInWithIdp",V1(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D6="http://localhost";class co extends W1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new co(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Ua("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s}=r,i=L1(r,["providerId","signInMethod"]);if(!n||!s)return null;const a=new co(n,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const r=this.buildRequest();return lc(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,lc(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,lc(e,r)}buildRequest(){const e={requestUri:D6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=Gd(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qd extends z1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni extends qd{constructor(){super("facebook.com")}static credential(e){return co._fromParams({providerId:ni.PROVIDER_ID,signInMethod:ni.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ni.credentialFromTaggedObject(e)}static credentialFromError(e){return ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ni.credential(e.oauthAccessToken)}catch{return null}}}ni.FACEBOOK_SIGN_IN_METHOD="facebook.com";ni.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa extends qd{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return co._fromParams({providerId:oa.PROVIDER_ID,signInMethod:oa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return oa.credentialFromTaggedObject(e)}static credentialFromError(e){return oa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return oa.credential(r,n)}catch{return null}}}oa.GOOGLE_SIGN_IN_METHOD="google.com";oa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si extends qd{constructor(){super("github.com")}static credential(e){return co._fromParams({providerId:si.PROVIDER_ID,signInMethod:si.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return si.credentialFromTaggedObject(e)}static credentialFromError(e){return si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return si.credential(e.oauthAccessToken)}catch{return null}}}si.GITHUB_SIGN_IN_METHOD="github.com";si.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends qd{constructor(){super("twitter.com")}static credential(e,r){return co._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return ai.credential(r,n)}catch{return null}}}ai.TWITTER_SIGN_IN_METHOD="twitter.com";ai.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _c{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,s=!1){const i=await ci._fromIdTokenResponse(e,n,s),a=yE(n);return new _c({user:i,providerId:a,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const s=yE(n);return new _c({user:e,providerId:s,_tokenResponse:n,operationType:r})}}function yE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh extends Ea{constructor(e,r,n,s){var i;super(r.code,r.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,sh.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,s){return new sh(e,r,n,s)}}function Nw(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?sh._fromErrorAndOperation(t,i,e,n):i})}async function P6(t,e,r=!1){const n=await vd(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return _c._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R6(t,e,r=!1){const{auth:n}=t;if(oi(n.app))return Promise.reject(Go(n));const s="reauthenticate";try{const i=await vd(t,Nw(n,s,e,t),r);Dt(i.idToken,n,"internal-error");const a=H1(i.idToken);Dt(a,n,"internal-error");const{sub:o}=a;return Dt(t.uid===o,n,"user-mismatch"),_c._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ua(n,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F6(t,e,r=!1){if(oi(t.app))return Promise.reject(Go(t));const n="signIn",s=await Nw(t,n,e),i=await _c._fromIdTokenResponse(t,n,s);return r||await t._updateCurrentUser(i.user),i}function Ow(t,e,r,n){return dr(t).onIdTokenChanged(e,r,n)}function Mw(t,e,r){return dr(t).beforeAuthStateChanged(e,r)}function K1(t,e,r,n){return dr(t).onAuthStateChanged(e,r,n)}function lp(t){return dr(t).signOut()}const ah="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(ah,"1"),this.storage.removeItem(ah),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N6=1e3,O6=10;class Bw extends Lw{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kw(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),s=this.localCache[r];n!==s&&e(r,s,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const n=e.key;r?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(n);!r&&this.localCache[n]===a||this.notifyListeners(n,a)},i=this.storage.getItem(n);v6()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,O6):s()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},N6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}Bw.type="LOCAL";const q1=Bw;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uw extends Lw{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}Uw.type="SESSION";const X1=Uw;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(s=>s.isListeningto(e));if(r)return r;const n=new cp(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:s,data:i}=r.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const o=Array.from(a).map(async c=>c(r.origin,i)),l=await M6(o);r.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:l})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}cp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const c=Y1("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},n);a={messageChannel:s,onMessage(f){const h=f;if(h.data.eventId===c)switch(h.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(h.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:r},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(){return window}function B6(t){Na().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(){return typeof Na().WorkerGlobalScope<"u"&&typeof Na().importScripts=="function"}async function U6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function V6(){return $w()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="firebaseLocalStorageDb",H6=1,ih="firebaseLocalStorage",Hw="fbase_key";class Xd{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function up(t,e){return t.transaction([ih],e?"readwrite":"readonly").objectStore(ih)}function j6(){const t=indexedDB.deleteDatabase(Vw);return new Xd(t).toPromise()}function mv(){const t=indexedDB.open(Vw,H6);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(ih,{keyPath:Hw})}catch(s){r(s)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(ih)?e(n):(n.close(),await j6(),e(await mv()))})})}async function xE(t,e,r){const n=up(t,!0).put({[Hw]:e,value:r});return new Xd(n).toPromise()}async function G6(t,e){const r=up(t,!1).get(e),n=await new Xd(r).toPromise();return n===void 0?null:n.value}function EE(t,e){const r=up(t,!0).delete(e);return new Xd(r).toPromise()}const W6=800,z6=3;class jw{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await mv(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>z6)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return $w()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=cp._getInstance(V6()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await U6(),!this.activeServiceWorker)return;this.sender=new L6(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mv();return await xE(e,ah,"1"),await EE(e,ah),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>xE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>G6(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>EE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=up(s,!1).getAll();return new Xd(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),r.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),W6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jw.type="LOCAL";const Gw=jw;new Kd(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ww(t,e){return e?ui(e):(Dt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q1 extends W1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return lc(e,this._buildIdpRequest())}_linkToIdToken(e,r){return lc(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return lc(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function K6(t){return F6(t.auth,new Q1(t),t.bypassAuthState)}function q6(t){const{auth:e,user:r}=t;return Dt(r,e,"internal-error"),R6(r,new Q1(t),t.bypassAuthState)}async function X6(t){const{auth:e,user:r}=t;return Dt(r,e,"internal-error"),P6(r,new Q1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zw{constructor(e,r,n,s,i=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:r,sessionId:n,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return K6;case"linkViaPopup":case"linkViaRedirect":return X6;case"reauthViaPopup":case"reauthViaRedirect":return q6;default:Ua(this.auth,"internal-error")}}resolve(e){Ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ai(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6=new Kd(2e3,1e4);async function J1(t,e,r){if(oi(t.app))return Promise.reject(pa(t,"operation-not-supported-in-this-environment"));const n=op(t);r6(t,e,z1);const s=Ww(n,r);return new Lo(n,"signInViaPopup",e,s).executeNotNull()}class Lo extends zw{constructor(e,r,n,s,i){super(e,r,s,i),this.provider=n,this.authWindow=null,this.pollId=null,Lo.currentPopupAction&&Lo.currentPopupAction.cancel(),Lo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Dt(e,this.auth,"internal-error"),e}async onExecution(){Ai(this.filter.length===1,"Popup operations only handle one event");const e=Y1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(pa(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(pa(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Lo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(pa(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Y6.get())};e()}}Lo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6="pendingRedirect",_0=new Map;class J6 extends zw{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=_0.get(this.auth._key());if(!e){try{const n=await Z6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}_0.set(this.auth._key(),e)}return this.bypassAuthState||_0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Z6(t,e){const r=r5(e),n=t5(t);if(!await n._isAvailable())return!1;const s=await n._get(r)==="true";return await n._remove(r),s}function e5(t,e){_0.set(t._key(),e)}function t5(t){return ui(t._redirectPersistence)}function r5(t){return E0(Q6,t.config.apiKey,t.name)}async function n5(t,e,r=!1){if(oi(t.app))return Promise.reject(Go(t));const n=op(t),s=Ww(n,e),a=await new J6(n,s,r).execute();return a&&!r&&(delete a.user._redirectEventId,await n._persistUserIfCurrent(a.user),await n._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s5=10*60*1e3;class a5{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!i5(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!Kw(e)){const s=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(pa(this.auth,s))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=s5&&this.cachedEventUids.clear(),this.cachedEventUids.has(_E(e))}saveEventToCache(e){this.cachedEventUids.add(_E(e)),this.lastProcessedEventTime=Date.now()}}function _E(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Kw({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function i5(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Kw(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o5(t,e={}){return Lc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l5=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,c5=/^https?/;async function u5(t){if(t.config.emulator)return;const{authorizedDomains:e}=await o5(t);for(const r of e)try{if(d5(r))return}catch{}Ua(t,"unauthorized-domain")}function d5(t){const e=dv(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const a=new URL(t);return a.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&a.hostname===n}if(!c5.test(r))return!1;if(l5.test(t))return n===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f5=new Kd(3e4,6e4);function bE(){const t=Na().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function h5(t){return new Promise((e,r)=>{var n,s,i;function a(){bE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{bE(),r(pa(t,"network-request-failed"))},timeout:f5.get()})}if(!((s=(n=Na().gapi)===null||n===void 0?void 0:n.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Na().gapi)===null||i===void 0)&&i.load)a();else{const o=w6("iframefcb");return Na()[o]=()=>{gapi.load?a():r(pa(t,"network-request-failed"))},A6(`${T6()}?onload=${o}`).catch(l=>r(l))}}).catch(e=>{throw b0=null,e})}let b0=null;function p5(t){return b0=b0||h5(t),b0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5=new Kd(5e3,15e3),g5="__/auth/iframe",v5="emulator/auth/iframe",y5={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},x5=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function E5(t){const e=t.config;Dt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?$1(e,v5):`https://${t.config.authDomain}/${g5}`,n={apiKey:e.apiKey,appName:t.name,v:pl},s=x5.get(t.config.apiHost);s&&(n.eid=s);const i=t._getFrameworks();return i.length&&(n.fw=i.join(",")),`${r}?${Gd(n).slice(1)}`}async function _5(t){const e=await p5(t),r=Na().gapi;return Dt(r,t,"internal-error"),e.open({where:document.body,url:E5(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:y5,dontclear:!0},n=>new Promise(async(s,i)=>{await n.restyle({setHideOnLeave:!1});const a=pa(t,"network-request-failed"),o=Na().setTimeout(()=>{i(a)},m5.get());function l(){Na().clearTimeout(o),s(n)}n.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},S5=500,A5=600,T5="_blank",w5="http://localhost";class SE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function C5(t,e,r,n=S5,s=A5){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-n)/2,0).toString();let o="";const l=Object.assign(Object.assign({},b5),{width:n.toString(),height:s.toString(),top:i,left:a}),c=ts().toLowerCase();r&&(o=Aw(c)?T5:r),bw(c)&&(e=e||w5,l.scrollbars="yes");const u=Object.entries(l).reduce((h,[p,g])=>`${h}${p}=${g},`,"");if(g6(c)&&o!=="_self")return I5(e||"",o),new SE(null);const f=window.open(e||"",o,u);Dt(f,t,"popup-blocked");try{f.focus()}catch{}return new SE(f)}function I5(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k5="__/auth/handler",D5="emulator/auth/handler",P5=encodeURIComponent("fac");async function AE(t,e,r,n,s,i){Dt(t.config.authDomain,t,"auth-domain-config-required"),Dt(t.config.apiKey,t,"invalid-api-key");const a={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:pl,eventId:s};if(e instanceof z1){e.setDefaultLanguage(t.languageCode),a.providerId=e.providerId||"",GF(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries({}))a[u]=f}if(e instanceof qd){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(a.scopes=u.join(","))}t.tenantId&&(a.tid=t.tenantId);const o=a;for(const u of Object.keys(o))o[u]===void 0&&delete o[u];const l=await t._getAppCheckToken(),c=l?`#${P5}=${encodeURIComponent(l)}`:"";return`${R5(t)}?${Gd(o).slice(1)}${c}`}function R5({config:t}){return t.emulator?$1(t,D5):`https://${t.authDomain}/${k5}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gm="webStorageSupport";class F5{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=X1,this._completeRedirectFn=n5,this._overrideRedirectResult=e5}async _openPopup(e,r,n,s){var i;Ai((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await AE(e,r,n,dv(),s);return C5(e,a,Y1())}async _openRedirect(e,r,n,s){await this._originValidation(e);const i=await AE(e,r,n,dv(),s);return B6(i),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:s,promise:i}=this.eventManagers[r];return s?Promise.resolve(s):(Ai(i,"If manager is not set, promise should be"),i)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await _5(e),n=new a5(e);return r.register("authEvent",s=>(Dt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(gm,{type:gm},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[gm];a!==void 0&&r(!!a),Ua(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=u5(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return kw()||Sw()||j1()}}const qw=F5;var TE="@firebase/auth",wE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O5(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function M5(t){lo(new bi("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;Dt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});const l={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Dw(t)},c=new b6(n,s,i,l);return C6(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),lo(new bi("auth-internal",e=>{const r=op(e.getProvider("auth").getImmediate());return(n=>new N5(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ws(TE,wE,O5(t)),Ws(TE,wE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L5=5*60,B5=sw("authIdTokenMaxAge")||L5;let CE=null;const U5=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>B5)return;const s=r==null?void 0:r.token;CE!==s&&(CE=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function uo(t=zd()){const e=Wd(t,"auth");if(e.isInitialized())return e.getImmediate();const r=Pw(t,{popupRedirectResolver:qw,persistence:[Gw,q1,X1]}),n=sw("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(n,location.origin);if(location.origin===i.origin){const a=U5(i.toString());Mw(r,a,()=>a(r.currentUser)),Ow(r,o=>a(o))}}const s=rw("auth");return s&&Rw(r,`http://${s}`),r}function $5(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}S6({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=s=>{const i=pa("internal-error");i.customData=s,r(i)},n.type="text/javascript",n.charset="UTF-8",$5().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});M5("Browser");const V5=Object.freeze(Object.defineProperty({__proto__:null,AuthCredential:W1,FacebookAuthProvider:ni,GithubAuthProvider:si,GoogleAuthProvider:oa,OAuthCredential:co,TwitterAuthProvider:ai,beforeAuthStateChanged:Mw,browserLocalPersistence:q1,browserPopupRedirectResolver:qw,browserSessionPersistence:X1,connectAuthEmulator:Rw,getAuth:uo,getIdToken:fv,getIdTokenResult:yw,inMemoryPersistence:pv,indexedDBLocalPersistence:Gw,initializeAuth:Pw,onAuthStateChanged:K1,onIdTokenChanged:Ow,prodErrorMap:fw,reload:xw,signInWithPopup:J1,signOut:lp},Symbol.toStringTag,{value:"Module"}));var IE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wo,Xw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(T,x){function m(){}m.prototype=x.prototype,T.D=x.prototype,T.prototype=new m,T.prototype.constructor=T,T.C=function(S,I,C){for(var F=Array(arguments.length-2),W=2;W<arguments.length;W++)F[W-2]=arguments[W];return x.prototype[I].apply(S,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(T,x,m){m||(m=0);var S=Array(16);if(typeof x=="string")for(var I=0;16>I;++I)S[I]=x.charCodeAt(m++)|x.charCodeAt(m++)<<8|x.charCodeAt(m++)<<16|x.charCodeAt(m++)<<24;else for(I=0;16>I;++I)S[I]=x[m++]|x[m++]<<8|x[m++]<<16|x[m++]<<24;x=T.g[0],m=T.g[1],I=T.g[2];var C=T.g[3],F=x+(C^m&(I^C))+S[0]+3614090360&4294967295;x=m+(F<<7&4294967295|F>>>25),F=C+(I^x&(m^I))+S[1]+3905402710&4294967295,C=x+(F<<12&4294967295|F>>>20),F=I+(m^C&(x^m))+S[2]+606105819&4294967295,I=C+(F<<17&4294967295|F>>>15),F=m+(x^I&(C^x))+S[3]+3250441966&4294967295,m=I+(F<<22&4294967295|F>>>10),F=x+(C^m&(I^C))+S[4]+4118548399&4294967295,x=m+(F<<7&4294967295|F>>>25),F=C+(I^x&(m^I))+S[5]+1200080426&4294967295,C=x+(F<<12&4294967295|F>>>20),F=I+(m^C&(x^m))+S[6]+2821735955&4294967295,I=C+(F<<17&4294967295|F>>>15),F=m+(x^I&(C^x))+S[7]+4249261313&4294967295,m=I+(F<<22&4294967295|F>>>10),F=x+(C^m&(I^C))+S[8]+1770035416&4294967295,x=m+(F<<7&4294967295|F>>>25),F=C+(I^x&(m^I))+S[9]+2336552879&4294967295,C=x+(F<<12&4294967295|F>>>20),F=I+(m^C&(x^m))+S[10]+4294925233&4294967295,I=C+(F<<17&4294967295|F>>>15),F=m+(x^I&(C^x))+S[11]+2304563134&4294967295,m=I+(F<<22&4294967295|F>>>10),F=x+(C^m&(I^C))+S[12]+1804603682&4294967295,x=m+(F<<7&4294967295|F>>>25),F=C+(I^x&(m^I))+S[13]+4254626195&4294967295,C=x+(F<<12&4294967295|F>>>20),F=I+(m^C&(x^m))+S[14]+2792965006&4294967295,I=C+(F<<17&4294967295|F>>>15),F=m+(x^I&(C^x))+S[15]+1236535329&4294967295,m=I+(F<<22&4294967295|F>>>10),F=x+(I^C&(m^I))+S[1]+4129170786&4294967295,x=m+(F<<5&4294967295|F>>>27),F=C+(m^I&(x^m))+S[6]+3225465664&4294967295,C=x+(F<<9&4294967295|F>>>23),F=I+(x^m&(C^x))+S[11]+643717713&4294967295,I=C+(F<<14&4294967295|F>>>18),F=m+(C^x&(I^C))+S[0]+3921069994&4294967295,m=I+(F<<20&4294967295|F>>>12),F=x+(I^C&(m^I))+S[5]+3593408605&4294967295,x=m+(F<<5&4294967295|F>>>27),F=C+(m^I&(x^m))+S[10]+38016083&4294967295,C=x+(F<<9&4294967295|F>>>23),F=I+(x^m&(C^x))+S[15]+3634488961&4294967295,I=C+(F<<14&4294967295|F>>>18),F=m+(C^x&(I^C))+S[4]+3889429448&4294967295,m=I+(F<<20&4294967295|F>>>12),F=x+(I^C&(m^I))+S[9]+568446438&4294967295,x=m+(F<<5&4294967295|F>>>27),F=C+(m^I&(x^m))+S[14]+3275163606&4294967295,C=x+(F<<9&4294967295|F>>>23),F=I+(x^m&(C^x))+S[3]+4107603335&4294967295,I=C+(F<<14&4294967295|F>>>18),F=m+(C^x&(I^C))+S[8]+1163531501&4294967295,m=I+(F<<20&4294967295|F>>>12),F=x+(I^C&(m^I))+S[13]+2850285829&4294967295,x=m+(F<<5&4294967295|F>>>27),F=C+(m^I&(x^m))+S[2]+4243563512&4294967295,C=x+(F<<9&4294967295|F>>>23),F=I+(x^m&(C^x))+S[7]+1735328473&4294967295,I=C+(F<<14&4294967295|F>>>18),F=m+(C^x&(I^C))+S[12]+2368359562&4294967295,m=I+(F<<20&4294967295|F>>>12),F=x+(m^I^C)+S[5]+4294588738&4294967295,x=m+(F<<4&4294967295|F>>>28),F=C+(x^m^I)+S[8]+2272392833&4294967295,C=x+(F<<11&4294967295|F>>>21),F=I+(C^x^m)+S[11]+1839030562&4294967295,I=C+(F<<16&4294967295|F>>>16),F=m+(I^C^x)+S[14]+4259657740&4294967295,m=I+(F<<23&4294967295|F>>>9),F=x+(m^I^C)+S[1]+2763975236&4294967295,x=m+(F<<4&4294967295|F>>>28),F=C+(x^m^I)+S[4]+1272893353&4294967295,C=x+(F<<11&4294967295|F>>>21),F=I+(C^x^m)+S[7]+4139469664&4294967295,I=C+(F<<16&4294967295|F>>>16),F=m+(I^C^x)+S[10]+3200236656&4294967295,m=I+(F<<23&4294967295|F>>>9),F=x+(m^I^C)+S[13]+681279174&4294967295,x=m+(F<<4&4294967295|F>>>28),F=C+(x^m^I)+S[0]+3936430074&4294967295,C=x+(F<<11&4294967295|F>>>21),F=I+(C^x^m)+S[3]+3572445317&4294967295,I=C+(F<<16&4294967295|F>>>16),F=m+(I^C^x)+S[6]+76029189&4294967295,m=I+(F<<23&4294967295|F>>>9),F=x+(m^I^C)+S[9]+3654602809&4294967295,x=m+(F<<4&4294967295|F>>>28),F=C+(x^m^I)+S[12]+3873151461&4294967295,C=x+(F<<11&4294967295|F>>>21),F=I+(C^x^m)+S[15]+530742520&4294967295,I=C+(F<<16&4294967295|F>>>16),F=m+(I^C^x)+S[2]+3299628645&4294967295,m=I+(F<<23&4294967295|F>>>9),F=x+(I^(m|~C))+S[0]+4096336452&4294967295,x=m+(F<<6&4294967295|F>>>26),F=C+(m^(x|~I))+S[7]+1126891415&4294967295,C=x+(F<<10&4294967295|F>>>22),F=I+(x^(C|~m))+S[14]+2878612391&4294967295,I=C+(F<<15&4294967295|F>>>17),F=m+(C^(I|~x))+S[5]+4237533241&4294967295,m=I+(F<<21&4294967295|F>>>11),F=x+(I^(m|~C))+S[12]+1700485571&4294967295,x=m+(F<<6&4294967295|F>>>26),F=C+(m^(x|~I))+S[3]+2399980690&4294967295,C=x+(F<<10&4294967295|F>>>22),F=I+(x^(C|~m))+S[10]+4293915773&4294967295,I=C+(F<<15&4294967295|F>>>17),F=m+(C^(I|~x))+S[1]+2240044497&4294967295,m=I+(F<<21&4294967295|F>>>11),F=x+(I^(m|~C))+S[8]+1873313359&4294967295,x=m+(F<<6&4294967295|F>>>26),F=C+(m^(x|~I))+S[15]+4264355552&4294967295,C=x+(F<<10&4294967295|F>>>22),F=I+(x^(C|~m))+S[6]+2734768916&4294967295,I=C+(F<<15&4294967295|F>>>17),F=m+(C^(I|~x))+S[13]+1309151649&4294967295,m=I+(F<<21&4294967295|F>>>11),F=x+(I^(m|~C))+S[4]+4149444226&4294967295,x=m+(F<<6&4294967295|F>>>26),F=C+(m^(x|~I))+S[11]+3174756917&4294967295,C=x+(F<<10&4294967295|F>>>22),F=I+(x^(C|~m))+S[2]+718787259&4294967295,I=C+(F<<15&4294967295|F>>>17),F=m+(C^(I|~x))+S[9]+3951481745&4294967295,T.g[0]=T.g[0]+x&4294967295,T.g[1]=T.g[1]+(I+(F<<21&4294967295|F>>>11))&4294967295,T.g[2]=T.g[2]+I&4294967295,T.g[3]=T.g[3]+C&4294967295}n.prototype.u=function(T,x){x===void 0&&(x=T.length);for(var m=x-this.blockSize,S=this.B,I=this.h,C=0;C<x;){if(I==0)for(;C<=m;)s(this,T,C),C+=this.blockSize;if(typeof T=="string"){for(;C<x;)if(S[I++]=T.charCodeAt(C++),I==this.blockSize){s(this,S),I=0;break}}else for(;C<x;)if(S[I++]=T[C++],I==this.blockSize){s(this,S),I=0;break}}this.h=I,this.o+=x},n.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var x=1;x<T.length-8;++x)T[x]=0;var m=8*this.o;for(x=T.length-8;x<T.length;++x)T[x]=m&255,m/=256;for(this.u(T),T=Array(16),x=m=0;4>x;++x)for(var S=0;32>S;S+=8)T[m++]=this.g[x]>>>S&255;return T};function i(T,x){var m=o;return Object.prototype.hasOwnProperty.call(m,T)?m[T]:m[T]=x(T)}function a(T,x){this.h=x;for(var m=[],S=!0,I=T.length-1;0<=I;I--){var C=T[I]|0;S&&C==x||(m[I]=C,S=!1)}this.g=m}var o={};function l(T){return-128<=T&&128>T?i(T,function(x){return new a([x|0],0>x?-1:0)}):new a([T|0],0>T?-1:0)}function c(T){if(isNaN(T)||!isFinite(T))return f;if(0>T)return E(c(-T));for(var x=[],m=1,S=0;T>=m;S++)x[S]=T/m|0,m*=4294967296;return new a(x,0)}function u(T,x){if(T.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(T.charAt(0)=="-")return E(u(T.substring(1),x));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var m=c(Math.pow(x,8)),S=f,I=0;I<T.length;I+=8){var C=Math.min(8,T.length-I),F=parseInt(T.substring(I,I+C),x);8>C?(C=c(Math.pow(x,C)),S=S.j(C).add(c(F))):(S=S.j(m),S=S.add(c(F)))}return S}var f=l(0),h=l(1),p=l(16777216);t=a.prototype,t.m=function(){if(y(this))return-E(this).m();for(var T=0,x=1,m=0;m<this.g.length;m++){var S=this.i(m);T+=(0<=S?S:4294967296+S)*x,x*=4294967296}return T},t.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(g(this))return"0";if(y(this))return"-"+E(this).toString(T);for(var x=c(Math.pow(T,6)),m=this,S="";;){var I=A(m,x).g;m=b(m,I.j(x));var C=((0<m.g.length?m.g[0]:m.h)>>>0).toString(T);if(m=I,g(m))return C+S;for(;6>C.length;)C="0"+C;S=C+S}},t.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function g(T){if(T.h!=0)return!1;for(var x=0;x<T.g.length;x++)if(T.g[x]!=0)return!1;return!0}function y(T){return T.h==-1}t.l=function(T){return T=b(this,T),y(T)?-1:g(T)?0:1};function E(T){for(var x=T.g.length,m=[],S=0;S<x;S++)m[S]=~T.g[S];return new a(m,~T.h).add(h)}t.abs=function(){return y(this)?E(this):this},t.add=function(T){for(var x=Math.max(this.g.length,T.g.length),m=[],S=0,I=0;I<=x;I++){var C=S+(this.i(I)&65535)+(T.i(I)&65535),F=(C>>>16)+(this.i(I)>>>16)+(T.i(I)>>>16);S=F>>>16,C&=65535,F&=65535,m[I]=F<<16|C}return new a(m,m[m.length-1]&-2147483648?-1:0)};function b(T,x){return T.add(E(x))}t.j=function(T){if(g(this)||g(T))return f;if(y(this))return y(T)?E(this).j(E(T)):E(E(this).j(T));if(y(T))return E(this.j(E(T)));if(0>this.l(p)&&0>T.l(p))return c(this.m()*T.m());for(var x=this.g.length+T.g.length,m=[],S=0;S<2*x;S++)m[S]=0;for(S=0;S<this.g.length;S++)for(var I=0;I<T.g.length;I++){var C=this.i(S)>>>16,F=this.i(S)&65535,W=T.i(I)>>>16,P=T.i(I)&65535;m[2*S+2*I]+=F*P,_(m,2*S+2*I),m[2*S+2*I+1]+=C*P,_(m,2*S+2*I+1),m[2*S+2*I+1]+=F*W,_(m,2*S+2*I+1),m[2*S+2*I+2]+=C*W,_(m,2*S+2*I+2)}for(S=0;S<x;S++)m[S]=m[2*S+1]<<16|m[2*S];for(S=x;S<2*x;S++)m[S]=0;return new a(m,0)};function _(T,x){for(;(T[x]&65535)!=T[x];)T[x+1]+=T[x]>>>16,T[x]&=65535,x++}function v(T,x){this.g=T,this.h=x}function A(T,x){if(g(x))throw Error("division by zero");if(g(T))return new v(f,f);if(y(T))return x=A(E(T),x),new v(E(x.g),E(x.h));if(y(x))return x=A(T,E(x)),new v(E(x.g),x.h);if(30<T.g.length){if(y(T)||y(x))throw Error("slowDivide_ only works with positive integers.");for(var m=h,S=x;0>=S.l(T);)m=D(m),S=D(S);var I=k(m,1),C=k(S,1);for(S=k(S,2),m=k(m,2);!g(S);){var F=C.add(S);0>=F.l(T)&&(I=I.add(m),C=F),S=k(S,1),m=k(m,1)}return x=b(T,I.j(x)),new v(I,x)}for(I=f;0<=T.l(x);){for(m=Math.max(1,Math.floor(T.m()/x.m())),S=Math.ceil(Math.log(m)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),C=c(m),F=C.j(x);y(F)||0<F.l(T);)m-=S,C=c(m),F=C.j(x);g(C)&&(C=h),I=I.add(C),T=b(T,F)}return new v(I,T)}t.A=function(T){return A(this,T).h},t.and=function(T){for(var x=Math.max(this.g.length,T.g.length),m=[],S=0;S<x;S++)m[S]=this.i(S)&T.i(S);return new a(m,this.h&T.h)},t.or=function(T){for(var x=Math.max(this.g.length,T.g.length),m=[],S=0;S<x;S++)m[S]=this.i(S)|T.i(S);return new a(m,this.h|T.h)},t.xor=function(T){for(var x=Math.max(this.g.length,T.g.length),m=[],S=0;S<x;S++)m[S]=this.i(S)^T.i(S);return new a(m,this.h^T.h)};function D(T){for(var x=T.g.length+1,m=[],S=0;S<x;S++)m[S]=T.i(S)<<1|T.i(S-1)>>>31;return new a(m,T.h)}function k(T,x){var m=x>>5;x%=32;for(var S=T.g.length-m,I=[],C=0;C<S;C++)I[C]=0<x?T.i(C+m)>>>x|T.i(C+m+1)<<32-x:T.i(C+m);return new a(I,T.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Xw=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=c,a.fromString=u,Wo=a}).apply(typeof IE<"u"?IE:typeof self<"u"?self:typeof window<"u"?window:{});var Lf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Yw,yu,Qw,S0,gv,Jw,Zw,eC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,U,X){return w==Array.prototype||w==Object.prototype||(w[U]=X.value),w};function r(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lf=="object"&&Lf];for(var U=0;U<w.length;++U){var X=w[U];if(X&&X.Math==Math)return X}throw Error("Cannot find global object")}var n=r(this);function s(w,U){if(U)e:{var X=n;w=w.split(".");for(var ie=0;ie<w.length-1;ie++){var ke=w[ie];if(!(ke in X))break e;X=X[ke]}w=w[w.length-1],ie=X[w],U=U(ie),U!=ie&&U!=null&&e(X,w,{configurable:!0,writable:!0,value:U})}}function i(w,U){w instanceof String&&(w+="");var X=0,ie=!1,ke={next:function(){if(!ie&&X<w.length){var Be=X++;return{value:U(Be,w[Be]),done:!1}}return ie=!0,{done:!0,value:void 0}}};return ke[Symbol.iterator]=function(){return ke},ke}s("Array.prototype.values",function(w){return w||function(){return i(this,function(U,X){return X})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(w){var U=typeof w;return U=U!="object"?U:w?Array.isArray(w)?"array":U:"null",U=="array"||U=="object"&&typeof w.length=="number"}function c(w){var U=typeof w;return U=="object"&&w!=null||U=="function"}function u(w,U,X){return w.call.apply(w.bind,arguments)}function f(w,U,X){if(!w)throw Error();if(2<arguments.length){var ie=Array.prototype.slice.call(arguments,2);return function(){var ke=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ke,ie),w.apply(U,ke)}}return function(){return w.apply(U,arguments)}}function h(w,U,X){return h=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:f,h.apply(null,arguments)}function p(w,U){var X=Array.prototype.slice.call(arguments,1);return function(){var ie=X.slice();return ie.push.apply(ie,arguments),w.apply(this,ie)}}function g(w,U){function X(){}X.prototype=U.prototype,w.aa=U.prototype,w.prototype=new X,w.prototype.constructor=w,w.Qb=function(ie,ke,Be){for(var tt=Array(arguments.length-2),yr=2;yr<arguments.length;yr++)tt[yr-2]=arguments[yr];return U.prototype[ke].apply(ie,tt)}}function y(w){const U=w.length;if(0<U){const X=Array(U);for(let ie=0;ie<U;ie++)X[ie]=w[ie];return X}return[]}function E(w,U){for(let X=1;X<arguments.length;X++){const ie=arguments[X];if(l(ie)){const ke=w.length||0,Be=ie.length||0;w.length=ke+Be;for(let tt=0;tt<Be;tt++)w[ke+tt]=ie[tt]}else w.push(ie)}}class b{constructor(U,X){this.i=U,this.j=X,this.h=0,this.g=null}get(){let U;return 0<this.h?(this.h--,U=this.g,this.g=U.next,U.next=null):U=this.i(),U}}function _(w){return/^[\s\xa0]*$/.test(w)}function v(){var w=o.navigator;return w&&(w=w.userAgent)?w:""}function A(w){return A[" "](w),w}A[" "]=function(){};var D=v().indexOf("Gecko")!=-1&&!(v().toLowerCase().indexOf("webkit")!=-1&&v().indexOf("Edge")==-1)&&!(v().indexOf("Trident")!=-1||v().indexOf("MSIE")!=-1)&&v().indexOf("Edge")==-1;function k(w,U,X){for(const ie in w)U.call(X,w[ie],ie,w)}function T(w,U){for(const X in w)U.call(void 0,w[X],X,w)}function x(w){const U={};for(const X in w)U[X]=w[X];return U}const m="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(w,U){let X,ie;for(let ke=1;ke<arguments.length;ke++){ie=arguments[ke];for(X in ie)w[X]=ie[X];for(let Be=0;Be<m.length;Be++)X=m[Be],Object.prototype.hasOwnProperty.call(ie,X)&&(w[X]=ie[X])}}function I(w){var U=1;w=w.split(":");const X=[];for(;0<U&&w.length;)X.push(w.shift()),U--;return w.length&&X.push(w.join(":")),X}function C(w){o.setTimeout(()=>{throw w},0)}function F(){var w=O;let U=null;return w.g&&(U=w.g,w.g=w.g.next,w.g||(w.h=null),U.next=null),U}class W{constructor(){this.h=this.g=null}add(U,X){const ie=P.get();ie.set(U,X),this.h?this.h.next=ie:this.g=ie,this.h=ie}}var P=new b(()=>new R,w=>w.reset());class R{constructor(){this.next=this.g=this.h=null}set(U,X){this.h=U,this.g=X,this.next=null}reset(){this.next=this.g=this.h=null}}let N,M=!1,O=new W,G=()=>{const w=o.Promise.resolve(void 0);N=()=>{w.then(z)}};var z=()=>{for(var w;w=F();){try{w.h.call(w.g)}catch(X){C(X)}var U=P;U.j(w),100>U.h&&(U.h++,w.next=U.g,U.g=w)}M=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function H(w,U){this.type=w,this.g=this.target=U,this.defaultPrevented=!1}H.prototype.h=function(){this.defaultPrevented=!0};var V=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var w=!1,U=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const X=()=>{};o.addEventListener("test",X,U),o.removeEventListener("test",X,U)}catch{}return w}();function te(w,U){if(H.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w){var X=this.type=w.type,ie=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;if(this.target=w.target||w.srcElement,this.g=U,U=w.relatedTarget){if(D){e:{try{A(U.nodeName);var ke=!0;break e}catch{}ke=!1}ke||(U=null)}}else X=="mouseover"?U=w.fromElement:X=="mouseout"&&(U=w.toElement);this.relatedTarget=U,ie?(this.clientX=ie.clientX!==void 0?ie.clientX:ie.pageX,this.clientY=ie.clientY!==void 0?ie.clientY:ie.pageY,this.screenX=ie.screenX||0,this.screenY=ie.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=typeof w.pointerType=="string"?w.pointerType:oe[w.pointerType]||"",this.state=w.state,this.i=w,w.defaultPrevented&&te.aa.h.call(this)}}g(te,H);var oe={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.aa.h.call(this);var w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var ne="closure_listenable_"+(1e6*Math.random()|0),le=0;function J(w,U,X,ie,ke){this.listener=w,this.proxy=null,this.src=U,this.type=X,this.capture=!!ie,this.ha=ke,this.key=++le,this.da=this.fa=!1}function Q(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function ve(w){this.src=w,this.g={},this.h=0}ve.prototype.add=function(w,U,X,ie,ke){var Be=w.toString();w=this.g[Be],w||(w=this.g[Be]=[],this.h++);var tt=K(w,U,ie,ke);return-1<tt?(U=w[tt],X||(U.fa=!1)):(U=new J(U,this.src,Be,!!ie,ke),U.fa=X,w.push(U)),U};function ee(w,U){var X=U.type;if(X in w.g){var ie=w.g[X],ke=Array.prototype.indexOf.call(ie,U,void 0),Be;(Be=0<=ke)&&Array.prototype.splice.call(ie,ke,1),Be&&(Q(U),w.g[X].length==0&&(delete w.g[X],w.h--))}}function K(w,U,X,ie){for(var ke=0;ke<w.length;++ke){var Be=w[ke];if(!Be.da&&Be.listener==U&&Be.capture==!!X&&Be.ha==ie)return ke}return-1}var Y="closure_lm_"+(1e6*Math.random()|0),pe={};function xe(w,U,X,ie,ke){if(Array.isArray(U)){for(var Be=0;Be<U.length;Be++)xe(w,U[Be],X,ie,ke);return null}return X=Ve(X),w&&w[ne]?w.K(U,X,c(ie)?!!ie.capture:!1,ke):ae(w,U,X,!1,ie,ke)}function ae(w,U,X,ie,ke,Be){if(!U)throw Error("Invalid event type");var tt=c(ke)?!!ke.capture:!!ke,yr=Ge(w);if(yr||(w[Y]=yr=new ve(w)),X=yr.add(U,X,ie,tt,Be),X.proxy)return X;if(ie=de(),X.proxy=ie,ie.src=w,ie.listener=X,w.addEventListener)V||(ke=tt),ke===void 0&&(ke=!1),w.addEventListener(U.toString(),ie,ke);else if(w.attachEvent)w.attachEvent(Ce(U.toString()),ie);else if(w.addListener&&w.removeListener)w.addListener(ie);else throw Error("addEventListener and attachEvent are unavailable.");return X}function de(){function w(X){return U.call(w.src,w.listener,X)}const U=Te;return w}function Ee(w,U,X,ie,ke){if(Array.isArray(U))for(var Be=0;Be<U.length;Be++)Ee(w,U[Be],X,ie,ke);else ie=c(ie)?!!ie.capture:!!ie,X=Ve(X),w&&w[ne]?(w=w.i,U=String(U).toString(),U in w.g&&(Be=w.g[U],X=K(Be,X,ie,ke),-1<X&&(Q(Be[X]),Array.prototype.splice.call(Be,X,1),Be.length==0&&(delete w.g[U],w.h--)))):w&&(w=Ge(w))&&(U=w.g[U.toString()],w=-1,U&&(w=K(U,X,ie,ke)),(X=-1<w?U[w]:null)&&he(X))}function he(w){if(typeof w!="number"&&w&&!w.da){var U=w.src;if(U&&U[ne])ee(U.i,w);else{var X=w.type,ie=w.proxy;U.removeEventListener?U.removeEventListener(X,ie,w.capture):U.detachEvent?U.detachEvent(Ce(X),ie):U.addListener&&U.removeListener&&U.removeListener(ie),(X=Ge(U))?(ee(X,w),X.h==0&&(X.src=null,U[Y]=null)):Q(w)}}}function Ce(w){return w in pe?pe[w]:pe[w]="on"+w}function Te(w,U){if(w.da)w=!0;else{U=new te(U,this);var X=w.listener,ie=w.ha||w.src;w.fa&&he(w),w=X.call(ie,U)}return w}function Ge(w){return w=w[Y],w instanceof ve?w:null}var Ie="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ve(w){return typeof w=="function"?w:(w[Ie]||(w[Ie]=function(U){return w.handleEvent(U)}),w[Ie])}function Ue(){j.call(this),this.i=new ve(this),this.M=this,this.F=null}g(Ue,j),Ue.prototype[ne]=!0,Ue.prototype.removeEventListener=function(w,U,X,ie){Ee(this,w,U,X,ie)};function ze(w,U){var X,ie=w.F;if(ie)for(X=[];ie;ie=ie.F)X.push(ie);if(w=w.M,ie=U.type||U,typeof U=="string")U=new H(U,w);else if(U instanceof H)U.target=U.target||w;else{var ke=U;U=new H(ie,w),S(U,ke)}if(ke=!0,X)for(var Be=X.length-1;0<=Be;Be--){var tt=U.g=X[Be];ke=Ke(tt,ie,!0,U)&&ke}if(tt=U.g=w,ke=Ke(tt,ie,!0,U)&&ke,ke=Ke(tt,ie,!1,U)&&ke,X)for(Be=0;Be<X.length;Be++)tt=U.g=X[Be],ke=Ke(tt,ie,!1,U)&&ke}Ue.prototype.N=function(){if(Ue.aa.N.call(this),this.i){var w=this.i,U;for(U in w.g){for(var X=w.g[U],ie=0;ie<X.length;ie++)Q(X[ie]);delete w.g[U],w.h--}}this.F=null},Ue.prototype.K=function(w,U,X,ie){return this.i.add(String(w),U,!1,X,ie)},Ue.prototype.L=function(w,U,X,ie){return this.i.add(String(w),U,!0,X,ie)};function Ke(w,U,X,ie){if(U=w.i.g[String(U)],!U)return!0;U=U.concat();for(var ke=!0,Be=0;Be<U.length;++Be){var tt=U[Be];if(tt&&!tt.da&&tt.capture==X){var yr=tt.listener,Sn=tt.ha||tt.src;tt.fa&&ee(w.i,tt),ke=yr.call(Sn,ie)!==!1&&ke}}return ke&&!ie.defaultPrevented}function ue(w,U,X){if(typeof w=="function")X&&(w=h(w,X));else if(w&&typeof w.handleEvent=="function")w=h(w.handleEvent,w);else throw Error("Invalid listener argument");return 2147483647<Number(U)?-1:o.setTimeout(w,U||0)}function be(w){w.g=ue(()=>{w.g=null,w.i&&(w.i=!1,be(w))},w.l);const U=w.h;w.h=null,w.m.apply(null,U)}class Ae extends j{constructor(U,X){super(),this.m=U,this.l=X,this.h=null,this.i=!1,this.g=null}j(U){this.h=arguments,this.g?this.i=!0:be(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Me(w){j.call(this),this.h=w,this.g={}}g(Me,j);var We=[];function lt(w){k(w.g,function(U,X){this.g.hasOwnProperty(X)&&he(U)},w),w.g={}}Me.prototype.N=function(){Me.aa.N.call(this),lt(this)},Me.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yt=o.JSON.stringify,_t=o.JSON.parse,$t=class{stringify(w){return o.JSON.stringify(w,void 0)}parse(w){return o.JSON.parse(w,void 0)}};function ht(){}ht.prototype.h=null;function ct(w){return w.h||(w.h=w.i())}function pt(){}var Ct={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Rt(){H.call(this,"d")}g(Rt,H);function mr(){H.call(this,"c")}g(mr,H);var mn={},Qs=null;function ms(){return Qs=Qs||new Ue}mn.La="serverreachability";function wl(w){H.call(this,mn.La,w)}g(wl,H);function za(w){const U=ms();ze(U,new wl(U))}mn.STAT_EVENT="statevent";function So(w,U){H.call(this,mn.STAT_EVENT,w),this.stat=U}g(So,H);function ln(w){const U=ms();ze(U,new So(U,w))}mn.Ma="timingevent";function Ao(w,U){H.call(this,mn.Ma,w),this.size=U}g(Ao,H);function Rr(w,U){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){w()},U)}function Ln(){this.g=!0}Ln.prototype.xa=function(){this.g=!1};function Cl(w,U,X,ie,ke,Be){w.info(function(){if(w.g)if(Be)for(var tt="",yr=Be.split("&"),Sn=0;Sn<yr.length;Sn++){var or=yr[Sn].split("=");if(1<or.length){var Bn=or[0];or=or[1];var Un=Bn.split("_");tt=2<=Un.length&&Un[1]=="type"?tt+(Bn+"="+or+"&"):tt+(Bn+"=redacted&")}}else tt=null;else tt=Be;return"XMLHTTP REQ ("+ie+") [attempt "+ke+"]: "+U+`
`+X+`
`+tt})}function qc(w,U,X,ie,ke,Be,tt){w.info(function(){return"XMLHTTP RESP ("+ie+") [ attempt "+ke+"]: "+U+`
`+X+`
`+Be+" "+tt})}function re(w,U,X,ie){w.info(function(){return"XMLHTTP TEXT ("+U+"): "+ce(w,X)+(ie?" "+ie:"")})}function me(w,U){w.info(function(){return"TIMEOUT: "+U})}Ln.prototype.info=function(){};function ce(w,U){if(!w.g)return U;if(!U)return null;try{var X=JSON.parse(U);if(X){for(w=0;w<X.length;w++)if(Array.isArray(X[w])){var ie=X[w];if(!(2>ie.length)){var ke=ie[1];if(Array.isArray(ke)&&!(1>ke.length)){var Be=ke[0];if(Be!="noop"&&Be!="stop"&&Be!="close")for(var tt=1;tt<ke.length;tt++)ke[tt]=""}}}}return yt(X)}catch{return U}}var fe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ge={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ye;function Re(){}g(Re,ht),Re.prototype.g=function(){return new XMLHttpRequest},Re.prototype.i=function(){return{}},ye=new Re;function He(w,U,X,ie){this.j=w,this.i=U,this.l=X,this.R=ie||1,this.U=new Me(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Fe}function Fe(){this.i=null,this.g="",this.h=!1}var Oe={},Le={};function Qe(w,U,X){w.L=1,w.v=vf(qa(U)),w.m=X,w.P=!0,et(w,null)}function et(w,U){w.F=Date.now(),st(w),w.A=qa(w.v);var X=w.A,ie=w.R;Array.isArray(ie)||(ie=[String(ie)]),zx(X.i,"t",ie),w.C=0,X=w.j.J,w.h=new Fe,w.g=u2(w.j,X?U:null,!w.m),0<w.O&&(w.M=new Ae(h(w.Y,w,w.g),w.O)),U=w.U,X=w.g,ie=w.ca;var ke="readystatechange";Array.isArray(ke)||(ke&&(We[0]=ke.toString()),ke=We);for(var Be=0;Be<ke.length;Be++){var tt=xe(X,ke[Be],ie||U.handleEvent,!1,U.h||U);if(!tt)break;U.g[tt.key]=tt}U=w.H?x(w.H):{},w.m?(w.u||(w.u="POST"),U["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.A,w.u,w.m,U)):(w.u="GET",w.g.ea(w.A,w.u,null,U)),za(),Cl(w.i,w.u,w.A,w.l,w.R,w.m)}He.prototype.ca=function(w){w=w.target;const U=this.M;U&&Xa(w)==3?U.j():this.Y(w)},He.prototype.Y=function(w){try{if(w==this.g)e:{const Un=Xa(this.g);var U=this.g.Ba();const Pl=this.g.Z();if(!(3>Un)&&(Un!=3||this.g&&(this.h.h||this.g.oa()||Zx(this.g)))){this.J||Un!=4||U==7||(U==8||0>=Pl?za(3):za(2)),vr(this);var X=this.g.Z();this.X=X;t:if(ut(this)){var ie=Zx(this.g);w="";var ke=ie.length,Be=Xa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ir(this),hr(this);var tt="";break t}this.h.i=new o.TextDecoder}for(U=0;U<ke;U++)this.h.h=!0,w+=this.h.i.decode(ie[U],{stream:!(Be&&U==ke-1)});ie.length=0,this.h.g+=w,this.C=0,tt=this.h.g}else tt=this.g.oa();if(this.o=X==200,qc(this.i,this.u,this.A,this.l,this.R,Un,X),this.o){if(this.T&&!this.K){t:{if(this.g){var yr,Sn=this.g;if((yr=Sn.g?Sn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(yr)){var or=yr;break t}}or=null}if(X=or)re(this.i,this.l,X,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ka(this,X);else{this.o=!1,this.s=3,ln(12),Ir(this),hr(this);break e}}if(this.P){X=!0;let Js;for(;!this.J&&this.C<tt.length;)if(Js=Je(this,tt),Js==Le){Un==4&&(this.s=4,ln(14),X=!1),re(this.i,this.l,null,"[Incomplete Response]");break}else if(Js==Oe){this.s=4,ln(15),re(this.i,this.l,tt,"[Invalid Chunk]"),X=!1;break}else re(this.i,this.l,Js,null),Ka(this,Js);if(ut(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Un!=4||tt.length!=0||this.h.h||(this.s=1,ln(16),X=!1),this.o=this.o&&X,!X)re(this.i,this.l,tt,"[Invalid Chunked Response]"),Ir(this),hr(this);else if(0<tt.length&&!this.W){this.W=!0;var Bn=this.j;Bn.g==this&&Bn.ba&&!Bn.M&&(Bn.j.info("Great, no buffering proxy detected. Bytes received: "+tt.length),Xp(Bn),Bn.M=!0,ln(11))}}else re(this.i,this.l,tt,null),Ka(this,tt);Un==4&&Ir(this),this.o&&!this.J&&(Un==4?i2(this.j,this):(this.o=!1,st(this)))}else UD(this.g),X==400&&0<tt.indexOf("Unknown SID")?(this.s=3,ln(12)):(this.s=0,ln(13)),Ir(this),hr(this)}}}catch{}finally{}};function ut(w){return w.g?w.u=="GET"&&w.L!=2&&w.j.Ca:!1}function Je(w,U){var X=w.C,ie=U.indexOf(`
`,X);return ie==-1?Le:(X=Number(U.substring(X,ie)),isNaN(X)?Oe:(ie+=1,ie+X>U.length?Le:(U=U.slice(ie,ie+X),w.C=ie+X,U)))}He.prototype.cancel=function(){this.J=!0,Ir(this)};function st(w){w.S=Date.now()+w.I,kt(w,w.I)}function kt(w,U){if(w.B!=null)throw Error("WatchDog timer not null");w.B=Rr(h(w.ba,w),U)}function vr(w){w.B&&(o.clearTimeout(w.B),w.B=null)}He.prototype.ba=function(){this.B=null;const w=Date.now();0<=w-this.S?(me(this.i,this.A),this.L!=2&&(za(),ln(17)),Ir(this),this.s=2,hr(this)):kt(this,this.S-w)};function hr(w){w.j.G==0||w.J||i2(w.j,w)}function Ir(w){vr(w);var U=w.M;U&&typeof U.ma=="function"&&U.ma(),w.M=null,lt(w.U),w.g&&(U=w.g,w.g=null,U.abort(),U.ma())}function Ka(w,U){try{var X=w.j;if(X.G!=0&&(X.g==w||Ts(X.h,w))){if(!w.K&&Ts(X.h,w)&&X.G==3){try{var ie=X.Da.g.parse(U)}catch{ie=null}if(Array.isArray(ie)&&ie.length==3){var ke=ie;if(ke[0]==0){e:if(!X.u){if(X.g)if(X.g.F+3e3<w.F)Sf(X),_f(X);else break e;qp(X),ln(18)}}else X.za=ke[1],0<X.za-X.T&&37500>ke[2]&&X.F&&X.v==0&&!X.C&&(X.C=Rr(h(X.Za,X),6e3));if(1>=Il(X.h)&&X.ca){try{X.ca()}catch{}X.ca=void 0}}else Co(X,11)}else if((w.K||X.g==w)&&Sf(X),!_(U))for(ke=X.Da.g.parse(U),U=0;U<ke.length;U++){let or=ke[U];if(X.T=or[0],or=or[1],X.G==2)if(or[0]=="c"){X.K=or[1],X.ia=or[2];const Bn=or[3];Bn!=null&&(X.la=Bn,X.j.info("VER="+X.la));const Un=or[4];Un!=null&&(X.Aa=Un,X.j.info("SVER="+X.Aa));const Pl=or[5];Pl!=null&&typeof Pl=="number"&&0<Pl&&(ie=1.5*Pl,X.L=ie,X.j.info("backChannelRequestTimeoutMs_="+ie)),ie=X;const Js=w.g;if(Js){const Tf=Js.g?Js.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Tf){var Be=ie.h;Be.g||Tf.indexOf("spdy")==-1&&Tf.indexOf("quic")==-1&&Tf.indexOf("h2")==-1||(Be.j=Be.l,Be.g=new Set,Be.h&&(Wp(Be,Be.h),Be.h=null))}if(ie.D){const Yp=Js.g?Js.g.getResponseHeader("X-HTTP-Session-Id"):null;Yp&&(ie.ya=Yp,wr(ie.I,ie.D,Yp))}}X.G=3,X.l&&X.l.ua(),X.ba&&(X.R=Date.now()-w.F,X.j.info("Handshake RTT: "+X.R+"ms")),ie=X;var tt=w;if(ie.qa=c2(ie,ie.J?ie.ia:null,ie.W),tt.K){Bx(ie.h,tt);var yr=tt,Sn=ie.L;Sn&&(yr.I=Sn),yr.B&&(vr(yr),st(yr)),ie.g=tt}else s2(ie);0<X.i.length&&bf(X)}else or[0]!="stop"&&or[0]!="close"||Co(X,7);else X.G==3&&(or[0]=="stop"||or[0]=="close"?or[0]=="stop"?Co(X,7):Kp(X):or[0]!="noop"&&X.l&&X.l.ta(or),X.v=0)}}za(4)}catch{}}var To=class{constructor(w,U){this.g=w,this.map=U}};function Fi(w){this.l=w||10,o.PerformanceNavigationTiming?(w=o.performance.getEntriesByType("navigation"),w=0<w.length&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Sa(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function Il(w){return w.h?1:w.g?w.g.size:0}function Ts(w,U){return w.h?w.h==U:w.g?w.g.has(U):!1}function Wp(w,U){w.g?w.g.add(U):w.h=U}function Bx(w,U){w.h&&w.h==U?w.h=null:w.g&&w.g.has(U)&&w.g.delete(U)}Fi.prototype.cancel=function(){if(this.i=Ux(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Ux(w){if(w.h!=null)return w.i.concat(w.h.D);if(w.g!=null&&w.g.size!==0){let U=w.i;for(const X of w.g.values())U=U.concat(X.D);return U}return y(w.i)}function AD(w){if(w.V&&typeof w.V=="function")return w.V();if(typeof Map<"u"&&w instanceof Map||typeof Set<"u"&&w instanceof Set)return Array.from(w.values());if(typeof w=="string")return w.split("");if(l(w)){for(var U=[],X=w.length,ie=0;ie<X;ie++)U.push(w[ie]);return U}U=[],X=0;for(ie in w)U[X++]=w[ie];return U}function TD(w){if(w.na&&typeof w.na=="function")return w.na();if(!w.V||typeof w.V!="function"){if(typeof Map<"u"&&w instanceof Map)return Array.from(w.keys());if(!(typeof Set<"u"&&w instanceof Set)){if(l(w)||typeof w=="string"){var U=[];w=w.length;for(var X=0;X<w;X++)U.push(X);return U}U=[],X=0;for(const ie in w)U[X++]=ie;return U}}}function $x(w,U){if(w.forEach&&typeof w.forEach=="function")w.forEach(U,void 0);else if(l(w)||typeof w=="string")Array.prototype.forEach.call(w,U,void 0);else for(var X=TD(w),ie=AD(w),ke=ie.length,Be=0;Be<ke;Be++)U.call(void 0,ie[Be],X&&X[Be],w)}var Vx=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wD(w,U){if(w){w=w.split("&");for(var X=0;X<w.length;X++){var ie=w[X].indexOf("="),ke=null;if(0<=ie){var Be=w[X].substring(0,ie);ke=w[X].substring(ie+1)}else Be=w[X];U(Be,ke?decodeURIComponent(ke.replace(/\+/g," ")):"")}}}function wo(w){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,w instanceof wo){this.h=w.h,mf(this,w.j),this.o=w.o,this.g=w.g,gf(this,w.s),this.l=w.l;var U=w.i,X=new Qc;X.i=U.i,U.g&&(X.g=new Map(U.g),X.h=U.h),Hx(this,X),this.m=w.m}else w&&(U=String(w).match(Vx))?(this.h=!1,mf(this,U[1]||"",!0),this.o=Xc(U[2]||""),this.g=Xc(U[3]||"",!0),gf(this,U[4]),this.l=Xc(U[5]||"",!0),Hx(this,U[6]||"",!0),this.m=Xc(U[7]||"")):(this.h=!1,this.i=new Qc(null,this.h))}wo.prototype.toString=function(){var w=[],U=this.j;U&&w.push(Yc(U,jx,!0),":");var X=this.g;return(X||U=="file")&&(w.push("//"),(U=this.o)&&w.push(Yc(U,jx,!0),"@"),w.push(encodeURIComponent(String(X)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),X=this.s,X!=null&&w.push(":",String(X))),(X=this.l)&&(this.g&&X.charAt(0)!="/"&&w.push("/"),w.push(Yc(X,X.charAt(0)=="/"?kD:ID,!0))),(X=this.i.toString())&&w.push("?",X),(X=this.m)&&w.push("#",Yc(X,PD)),w.join("")};function qa(w){return new wo(w)}function mf(w,U,X){w.j=X?Xc(U,!0):U,w.j&&(w.j=w.j.replace(/:$/,""))}function gf(w,U){if(U){if(U=Number(U),isNaN(U)||0>U)throw Error("Bad port number "+U);w.s=U}else w.s=null}function Hx(w,U,X){U instanceof Qc?(w.i=U,RD(w.i,w.h)):(X||(U=Yc(U,DD)),w.i=new Qc(U,w.h))}function wr(w,U,X){w.i.set(U,X)}function vf(w){return wr(w,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),w}function Xc(w,U){return w?U?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function Yc(w,U,X){return typeof w=="string"?(w=encodeURI(w).replace(U,CD),X&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function CD(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var jx=/[#\/\?@]/g,ID=/[#\?:]/g,kD=/[#\?]/g,DD=/[#\?@]/g,PD=/#/g;function Qc(w,U){this.h=this.g=null,this.i=w||null,this.j=!!U}function Ni(w){w.g||(w.g=new Map,w.h=0,w.i&&wD(w.i,function(U,X){w.add(decodeURIComponent(U.replace(/\+/g," ")),X)}))}t=Qc.prototype,t.add=function(w,U){Ni(this),this.i=null,w=kl(this,w);var X=this.g.get(w);return X||this.g.set(w,X=[]),X.push(U),this.h+=1,this};function Gx(w,U){Ni(w),U=kl(w,U),w.g.has(U)&&(w.i=null,w.h-=w.g.get(U).length,w.g.delete(U))}function Wx(w,U){return Ni(w),U=kl(w,U),w.g.has(U)}t.forEach=function(w,U){Ni(this),this.g.forEach(function(X,ie){X.forEach(function(ke){w.call(U,ke,ie,this)},this)},this)},t.na=function(){Ni(this);const w=Array.from(this.g.values()),U=Array.from(this.g.keys()),X=[];for(let ie=0;ie<U.length;ie++){const ke=w[ie];for(let Be=0;Be<ke.length;Be++)X.push(U[ie])}return X},t.V=function(w){Ni(this);let U=[];if(typeof w=="string")Wx(this,w)&&(U=U.concat(this.g.get(kl(this,w))));else{w=Array.from(this.g.values());for(let X=0;X<w.length;X++)U=U.concat(w[X])}return U},t.set=function(w,U){return Ni(this),this.i=null,w=kl(this,w),Wx(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[U]),this.h+=1,this},t.get=function(w,U){return w?(w=this.V(w),0<w.length?String(w[0]):U):U};function zx(w,U,X){Gx(w,U),0<X.length&&(w.i=null,w.g.set(kl(w,U),y(X)),w.h+=X.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],U=Array.from(this.g.keys());for(var X=0;X<U.length;X++){var ie=U[X];const Be=encodeURIComponent(String(ie)),tt=this.V(ie);for(ie=0;ie<tt.length;ie++){var ke=Be;tt[ie]!==""&&(ke+="="+encodeURIComponent(String(tt[ie]))),w.push(ke)}}return this.i=w.join("&")};function kl(w,U){return U=String(U),w.j&&(U=U.toLowerCase()),U}function RD(w,U){U&&!w.j&&(Ni(w),w.i=null,w.g.forEach(function(X,ie){var ke=ie.toLowerCase();ie!=ke&&(Gx(this,ie),zx(this,ke,X))},w)),w.j=U}function FD(w,U){const X=new Ln;if(o.Image){const ie=new Image;ie.onload=p(Oi,X,"TestLoadImage: loaded",!0,U,ie),ie.onerror=p(Oi,X,"TestLoadImage: error",!1,U,ie),ie.onabort=p(Oi,X,"TestLoadImage: abort",!1,U,ie),ie.ontimeout=p(Oi,X,"TestLoadImage: timeout",!1,U,ie),o.setTimeout(function(){ie.ontimeout&&ie.ontimeout()},1e4),ie.src=w}else U(!1)}function ND(w,U){const X=new Ln,ie=new AbortController,ke=setTimeout(()=>{ie.abort(),Oi(X,"TestPingServer: timeout",!1,U)},1e4);fetch(w,{signal:ie.signal}).then(Be=>{clearTimeout(ke),Be.ok?Oi(X,"TestPingServer: ok",!0,U):Oi(X,"TestPingServer: server error",!1,U)}).catch(()=>{clearTimeout(ke),Oi(X,"TestPingServer: error",!1,U)})}function Oi(w,U,X,ie,ke){try{ke&&(ke.onload=null,ke.onerror=null,ke.onabort=null,ke.ontimeout=null),ie(X)}catch{}}function OD(){this.g=new $t}function MD(w,U,X){const ie=X||"";try{$x(w,function(ke,Be){let tt=ke;c(ke)&&(tt=yt(ke)),U.push(ie+Be+"="+encodeURIComponent(tt))})}catch(ke){throw U.push(ie+"type="+encodeURIComponent("_badmap")),ke}}function yf(w){this.l=w.Ub||null,this.j=w.eb||!1}g(yf,ht),yf.prototype.g=function(){return new xf(this.l,this.j)},yf.prototype.i=function(w){return function(){return w}}({});function xf(w,U){Ue.call(this),this.D=w,this.o=U,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(xf,Ue),t=xf.prototype,t.open=function(w,U){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=w,this.A=U,this.readyState=1,Zc(this)},t.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const U={headers:this.u,method:this.B,credentials:this.m,cache:void 0};w&&(U.body=w),(this.D||o).fetch(new Request(this.A,U)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Jc(this)),this.readyState=0},t.Sa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,Zc(this)),this.g&&(this.readyState=3,Zc(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Kx(this)}else w.text().then(this.Ra.bind(this),this.ga.bind(this))};function Kx(w){w.j.read().then(w.Pa.bind(w)).catch(w.ga.bind(w))}t.Pa=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var U=w.value?w.value:new Uint8Array(0);(U=this.v.decode(U,{stream:!w.done}))&&(this.response=this.responseText+=U)}w.done?Jc(this):Zc(this),this.readyState==3&&Kx(this)}},t.Ra=function(w){this.g&&(this.response=this.responseText=w,Jc(this))},t.Qa=function(w){this.g&&(this.response=w,Jc(this))},t.ga=function(){this.g&&Jc(this)};function Jc(w){w.readyState=4,w.l=null,w.j=null,w.v=null,Zc(w)}t.setRequestHeader=function(w,U){this.u.append(w,U)},t.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],U=this.h.entries();for(var X=U.next();!X.done;)X=X.value,w.push(X[0]+": "+X[1]),X=U.next();return w.join(`\r
`)};function Zc(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(xf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function qx(w){let U="";return k(w,function(X,ie){U+=ie,U+=":",U+=X,U+=`\r
`}),U}function zp(w,U,X){e:{for(ie in X){var ie=!1;break e}ie=!0}ie||(X=qx(X),typeof w=="string"?X!=null&&encodeURIComponent(String(X)):wr(w,U,X))}function Mr(w){Ue.call(this),this.headers=new Map,this.o=w||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Mr,Ue);var LD=/^https?$/i,BD=["POST","PUT"];t=Mr.prototype,t.Ha=function(w){this.J=w},t.ea=function(w,U,X,ie){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);U=U?U.toUpperCase():"GET",this.D=w,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ye.g(),this.v=this.o?ct(this.o):ct(ye),this.g.onreadystatechange=h(this.Ea,this);try{this.B=!0,this.g.open(U,String(w),!0),this.B=!1}catch(Be){Xx(this,Be);return}if(w=X||"",X=new Map(this.headers),ie)if(Object.getPrototypeOf(ie)===Object.prototype)for(var ke in ie)X.set(ke,ie[ke]);else if(typeof ie.keys=="function"&&typeof ie.get=="function")for(const Be of ie.keys())X.set(Be,ie.get(Be));else throw Error("Unknown input type for opt_headers: "+String(ie));ie=Array.from(X.keys()).find(Be=>Be.toLowerCase()=="content-type"),ke=o.FormData&&w instanceof o.FormData,!(0<=Array.prototype.indexOf.call(BD,U,void 0))||ie||ke||X.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Be,tt]of X)this.g.setRequestHeader(Be,tt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Jx(this),this.u=!0,this.g.send(w),this.u=!1}catch(Be){Xx(this,Be)}};function Xx(w,U){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=U,w.m=5,Yx(w),Ef(w)}function Yx(w){w.A||(w.A=!0,ze(w,"complete"),ze(w,"error"))}t.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=w||7,ze(this,"complete"),ze(this,"abort"),Ef(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ef(this,!0)),Mr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Qx(this):this.bb())},t.bb=function(){Qx(this)};function Qx(w){if(w.h&&typeof a<"u"&&(!w.v[1]||Xa(w)!=4||w.Z()!=2)){if(w.u&&Xa(w)==4)ue(w.Ea,0,w);else if(ze(w,"readystatechange"),Xa(w)==4){w.h=!1;try{const tt=w.Z();e:switch(tt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var U=!0;break e;default:U=!1}var X;if(!(X=U)){var ie;if(ie=tt===0){var ke=String(w.D).match(Vx)[1]||null;!ke&&o.self&&o.self.location&&(ke=o.self.location.protocol.slice(0,-1)),ie=!LD.test(ke?ke.toLowerCase():"")}X=ie}if(X)ze(w,"complete"),ze(w,"success");else{w.m=6;try{var Be=2<Xa(w)?w.g.statusText:""}catch{Be=""}w.l=Be+" ["+w.Z()+"]",Yx(w)}}finally{Ef(w)}}}}function Ef(w,U){if(w.g){Jx(w);const X=w.g,ie=w.v[0]?()=>{}:null;w.g=null,w.v=null,U||ze(w,"ready");try{X.onreadystatechange=ie}catch{}}}function Jx(w){w.I&&(o.clearTimeout(w.I),w.I=null)}t.isActive=function(){return!!this.g};function Xa(w){return w.g?w.g.readyState:0}t.Z=function(){try{return 2<Xa(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(w){if(this.g){var U=this.g.responseText;return w&&U.indexOf(w)==0&&(U=U.substring(w.length)),_t(U)}};function Zx(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.H){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function UD(w){const U={};w=(w.g&&2<=Xa(w)&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let ie=0;ie<w.length;ie++){if(_(w[ie]))continue;var X=I(w[ie]);const ke=X[0];if(X=X[1],typeof X!="string")continue;X=X.trim();const Be=U[ke]||[];U[ke]=Be,Be.push(X)}T(U,function(ie){return ie.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function eu(w,U,X){return X&&X.internalChannelParams&&X.internalChannelParams[w]||U}function e2(w){this.Aa=0,this.i=[],this.j=new Ln,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=eu("failFast",!1,w),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=eu("baseRetryDelayMs",5e3,w),this.cb=eu("retryDelaySeedMs",1e4,w),this.Wa=eu("forwardChannelMaxRetries",2,w),this.wa=eu("forwardChannelRequestTimeoutMs",2e4,w),this.pa=w&&w.xmlHttpFactory||void 0,this.Xa=w&&w.Tb||void 0,this.Ca=w&&w.useFetchStreams||!1,this.L=void 0,this.J=w&&w.supportsCrossDomainXhr||!1,this.K="",this.h=new Fi(w&&w.concurrentRequestLimit),this.Da=new OD,this.P=w&&w.fastHandshake||!1,this.O=w&&w.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=w&&w.Rb||!1,w&&w.xa&&this.j.xa(),w&&w.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&w&&w.detectBufferingProxy||!1,this.ja=void 0,w&&w.longPollingTimeout&&0<w.longPollingTimeout&&(this.ja=w.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=e2.prototype,t.la=8,t.G=1,t.connect=function(w,U,X,ie){ln(0),this.W=w,this.H=U||{},X&&ie!==void 0&&(this.H.OSID=X,this.H.OAID=ie),this.F=this.X,this.I=c2(this,null,this.W),bf(this)};function Kp(w){if(t2(w),w.G==3){var U=w.U++,X=qa(w.I);if(wr(X,"SID",w.K),wr(X,"RID",U),wr(X,"TYPE","terminate"),tu(w,X),U=new He(w,w.j,U),U.L=2,U.v=vf(qa(X)),X=!1,o.navigator&&o.navigator.sendBeacon)try{X=o.navigator.sendBeacon(U.v.toString(),"")}catch{}!X&&o.Image&&(new Image().src=U.v,X=!0),X||(U.g=u2(U.j,null),U.g.ea(U.v)),U.F=Date.now(),st(U)}l2(w)}function _f(w){w.g&&(Xp(w),w.g.cancel(),w.g=null)}function t2(w){_f(w),w.u&&(o.clearTimeout(w.u),w.u=null),Sf(w),w.h.cancel(),w.s&&(typeof w.s=="number"&&o.clearTimeout(w.s),w.s=null)}function bf(w){if(!Sa(w.h)&&!w.s){w.s=!0;var U=w.Ga;N||G(),M||(N(),M=!0),O.add(U,w),w.B=0}}function $D(w,U){return Il(w.h)>=w.h.j-(w.s?1:0)?!1:w.s?(w.i=U.D.concat(w.i),!0):w.G==1||w.G==2||w.B>=(w.Va?0:w.Wa)?!1:(w.s=Rr(h(w.Ga,w,U),o2(w,w.B)),w.B++,!0)}t.Ga=function(w){if(this.s)if(this.s=null,this.G==1){if(!w){this.U=Math.floor(1e5*Math.random()),w=this.U++;const ke=new He(this,this.j,w);let Be=this.o;if(this.S&&(Be?(Be=x(Be),S(Be,this.S)):Be=this.S),this.m!==null||this.O||(ke.H=Be,Be=null),this.P)e:{for(var U=0,X=0;X<this.i.length;X++){t:{var ie=this.i[X];if("__data__"in ie.map&&(ie=ie.map.__data__,typeof ie=="string")){ie=ie.length;break t}ie=void 0}if(ie===void 0)break;if(U+=ie,4096<U){U=X;break e}if(U===4096||X===this.i.length-1){U=X+1;break e}}U=1e3}else U=1e3;U=n2(this,ke,U),X=qa(this.I),wr(X,"RID",w),wr(X,"CVER",22),this.D&&wr(X,"X-HTTP-Session-Id",this.D),tu(this,X),Be&&(this.O?U="headers="+encodeURIComponent(String(qx(Be)))+"&"+U:this.m&&zp(X,this.m,Be)),Wp(this.h,ke),this.Ua&&wr(X,"TYPE","init"),this.P?(wr(X,"$req",U),wr(X,"SID","null"),ke.T=!0,Qe(ke,X,null)):Qe(ke,X,U),this.G=2}}else this.G==3&&(w?r2(this,w):this.i.length==0||Sa(this.h)||r2(this))};function r2(w,U){var X;U?X=U.l:X=w.U++;const ie=qa(w.I);wr(ie,"SID",w.K),wr(ie,"RID",X),wr(ie,"AID",w.T),tu(w,ie),w.m&&w.o&&zp(ie,w.m,w.o),X=new He(w,w.j,X,w.B+1),w.m===null&&(X.H=w.o),U&&(w.i=U.D.concat(w.i)),U=n2(w,X,1e3),X.I=Math.round(.5*w.wa)+Math.round(.5*w.wa*Math.random()),Wp(w.h,X),Qe(X,ie,U)}function tu(w,U){w.H&&k(w.H,function(X,ie){wr(U,ie,X)}),w.l&&$x({},function(X,ie){wr(U,ie,X)})}function n2(w,U,X){X=Math.min(w.i.length,X);var ie=w.l?h(w.l.Na,w.l,w):null;e:{var ke=w.i;let Be=-1;for(;;){const tt=["count="+X];Be==-1?0<X?(Be=ke[0].g,tt.push("ofs="+Be)):Be=0:tt.push("ofs="+Be);let yr=!0;for(let Sn=0;Sn<X;Sn++){let or=ke[Sn].g;const Bn=ke[Sn].map;if(or-=Be,0>or)Be=Math.max(0,ke[Sn].g-100),yr=!1;else try{MD(Bn,tt,"req"+or+"_")}catch{ie&&ie(Bn)}}if(yr){ie=tt.join("&");break e}}}return w=w.i.splice(0,X),U.D=w,ie}function s2(w){if(!w.g&&!w.u){w.Y=1;var U=w.Fa;N||G(),M||(N(),M=!0),O.add(U,w),w.v=0}}function qp(w){return w.g||w.u||3<=w.v?!1:(w.Y++,w.u=Rr(h(w.Fa,w),o2(w,w.v)),w.v++,!0)}t.Fa=function(){if(this.u=null,a2(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var w=2*this.R;this.j.info("BP detection timer enabled: "+w),this.A=Rr(h(this.ab,this),w)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ln(10),_f(this),a2(this))};function Xp(w){w.A!=null&&(o.clearTimeout(w.A),w.A=null)}function a2(w){w.g=new He(w,w.j,"rpc",w.Y),w.m===null&&(w.g.H=w.o),w.g.O=0;var U=qa(w.qa);wr(U,"RID","rpc"),wr(U,"SID",w.K),wr(U,"AID",w.T),wr(U,"CI",w.F?"0":"1"),!w.F&&w.ja&&wr(U,"TO",w.ja),wr(U,"TYPE","xmlhttp"),tu(w,U),w.m&&w.o&&zp(U,w.m,w.o),w.L&&(w.g.I=w.L);var X=w.g;w=w.ia,X.L=1,X.v=vf(qa(U)),X.m=null,X.P=!0,et(X,w)}t.Za=function(){this.C!=null&&(this.C=null,_f(this),qp(this),ln(19))};function Sf(w){w.C!=null&&(o.clearTimeout(w.C),w.C=null)}function i2(w,U){var X=null;if(w.g==U){Sf(w),Xp(w),w.g=null;var ie=2}else if(Ts(w.h,U))X=U.D,Bx(w.h,U),ie=1;else return;if(w.G!=0){if(U.o)if(ie==1){X=U.m?U.m.length:0,U=Date.now()-U.F;var ke=w.B;ie=ms(),ze(ie,new Ao(ie,X)),bf(w)}else s2(w);else if(ke=U.s,ke==3||ke==0&&0<U.X||!(ie==1&&$D(w,U)||ie==2&&qp(w)))switch(X&&0<X.length&&(U=w.h,U.i=U.i.concat(X)),ke){case 1:Co(w,5);break;case 4:Co(w,10);break;case 3:Co(w,6);break;default:Co(w,2)}}}function o2(w,U){let X=w.Ta+Math.floor(Math.random()*w.cb);return w.isActive()||(X*=2),X*U}function Co(w,U){if(w.j.info("Error code "+U),U==2){var X=h(w.fb,w),ie=w.Xa;const ke=!ie;ie=new wo(ie||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||mf(ie,"https"),vf(ie),ke?FD(ie.toString(),X):ND(ie.toString(),X)}else ln(2);w.G=0,w.l&&w.l.sa(U),l2(w),t2(w)}t.fb=function(w){w?(this.j.info("Successfully pinged google.com"),ln(2)):(this.j.info("Failed to ping google.com"),ln(1))};function l2(w){if(w.G=0,w.ka=[],w.l){const U=Ux(w.h);(U.length!=0||w.i.length!=0)&&(E(w.ka,U),E(w.ka,w.i),w.h.i.length=0,y(w.i),w.i.length=0),w.l.ra()}}function c2(w,U,X){var ie=X instanceof wo?qa(X):new wo(X);if(ie.g!="")U&&(ie.g=U+"."+ie.g),gf(ie,ie.s);else{var ke=o.location;ie=ke.protocol,U=U?U+"."+ke.hostname:ke.hostname,ke=+ke.port;var Be=new wo(null);ie&&mf(Be,ie),U&&(Be.g=U),ke&&gf(Be,ke),X&&(Be.l=X),ie=Be}return X=w.D,U=w.ya,X&&U&&wr(ie,X,U),wr(ie,"VER",w.la),tu(w,ie),ie}function u2(w,U,X){if(U&&!w.J)throw Error("Can't create secondary domain capable XhrIo object.");return U=w.Ca&&!w.pa?new Mr(new yf({eb:X})):new Mr(w.pa),U.Ha(w.J),U}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function d2(){}t=d2.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Af(){}Af.prototype.g=function(w,U){return new ws(w,U)};function ws(w,U){Ue.call(this),this.g=new e2(U),this.l=w,this.h=U&&U.messageUrlParams||null,w=U&&U.messageHeaders||null,U&&U.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=U&&U.initMessageHeaders||null,U&&U.messageContentType&&(w?w["X-WebChannel-Content-Type"]=U.messageContentType:w={"X-WebChannel-Content-Type":U.messageContentType}),U&&U.va&&(w?w["X-WebChannel-Client-Profile"]=U.va:w={"X-WebChannel-Client-Profile":U.va}),this.g.S=w,(w=U&&U.Sb)&&!_(w)&&(this.g.m=w),this.v=U&&U.supportsCrossDomainXhr||!1,this.u=U&&U.sendRawJson||!1,(U=U&&U.httpSessionIdParam)&&!_(U)&&(this.g.D=U,w=this.h,w!==null&&U in w&&(w=this.h,U in w&&delete w[U])),this.j=new Dl(this)}g(ws,Ue),ws.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ws.prototype.close=function(){Kp(this.g)},ws.prototype.o=function(w){var U=this.g;if(typeof w=="string"){var X={};X.__data__=w,w=X}else this.u&&(X={},X.__data__=yt(w),w=X);U.i.push(new To(U.Ya++,w)),U.G==3&&bf(U)},ws.prototype.N=function(){this.g.l=null,delete this.j,Kp(this.g),delete this.g,ws.aa.N.call(this)};function f2(w){Rt.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var U=w.__sm__;if(U){e:{for(const X in U){w=X;break e}w=void 0}(this.i=w)&&(w=this.i,U=U!==null&&w in U?U[w]:void 0),this.data=U}else this.data=w}g(f2,Rt);function h2(){mr.call(this),this.status=1}g(h2,mr);function Dl(w){this.g=w}g(Dl,d2),Dl.prototype.ua=function(){ze(this.g,"a")},Dl.prototype.ta=function(w){ze(this.g,new f2(w))},Dl.prototype.sa=function(w){ze(this.g,new h2)},Dl.prototype.ra=function(){ze(this.g,"b")},Af.prototype.createWebChannel=Af.prototype.g,ws.prototype.send=ws.prototype.o,ws.prototype.open=ws.prototype.m,ws.prototype.close=ws.prototype.close,eC=function(){return new Af},Zw=function(){return ms()},Jw=mn,gv={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},fe.NO_ERROR=0,fe.TIMEOUT=8,fe.HTTP_ERROR=6,S0=fe,ge.COMPLETE="complete",Qw=ge,pt.EventType=Ct,Ct.OPEN="a",Ct.CLOSE="b",Ct.ERROR="c",Ct.MESSAGE="d",Ue.prototype.listen=Ue.prototype.K,yu=pt,Mr.prototype.listenOnce=Mr.prototype.L,Mr.prototype.getLastError=Mr.prototype.Ka,Mr.prototype.getLastErrorCode=Mr.prototype.Ba,Mr.prototype.getStatus=Mr.prototype.Z,Mr.prototype.getResponseJson=Mr.prototype.Oa,Mr.prototype.getResponseText=Mr.prototype.oa,Mr.prototype.send=Mr.prototype.ea,Mr.prototype.setWithCredentials=Mr.prototype.Ha,Yw=Mr}).apply(typeof Lf<"u"?Lf:typeof self<"u"?self:typeof window<"u"?window:{});const kE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Gn.UNAUTHENTICATED=new Gn(null),Gn.GOOGLE_CREDENTIALS=new Gn("google-credentials-uid"),Gn.FIRST_PARTY=new Gn("first-party-uid"),Gn.MOCK_USER=new Gn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Bc="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl=new O1("@firebase/firestore");function au(){return tl.logLevel}function mt(t,...e){if(tl.logLevel<=Qt.DEBUG){const r=e.map(Z1);tl.debug(`Firestore (${Bc}): ${t}`,...r)}}function Ti(t,...e){if(tl.logLevel<=Qt.ERROR){const r=e.map(Z1);tl.error(`Firestore (${Bc}): ${t}`,...r)}}function rl(t,...e){if(tl.logLevel<=Qt.WARN){const r=e.map(Z1);tl.warn(`Firestore (${Bc}): ${t}`,...r)}}function Z1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pt(t="Unexpected state"){const e=`FIRESTORE (${Bc}) INTERNAL ASSERTION FAILED: `+t;throw Ti(e),new Error(e)}function pr(t,e){t||Pt()}function Lt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const je={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class nt extends Ea{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Gn.UNAUTHENTICATED))}shutdown(){}}class H5{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class j5{constructor(e){this.t=e,this.currentUser=Gn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){pr(this.o===void 0);let n=this.i;const s=l=>this.i!==n?(n=this.i,r(l)):Promise.resolve();let i=new fi;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new fi,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{mt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(mt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new fi)}},0),a()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(mt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pr(typeof n.accessToken=="string"),new tC(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return pr(e===null||typeof e=="string"),new Gn(e)}}class G5{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Gn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class W5{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new G5(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Gn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class z5{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class K5{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){pr(this.o===void 0);const n=i=>{i.error!=null&&mt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,mt("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>n(i))};const s=i=>{mt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):mt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(pr(typeof r.token=="string"),this.R=r.token,new z5(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q5(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const s=q5(40);for(let i=0;i<s.length;++i)n.length<20&&s[i]<r&&(n+=e.charAt(s[i]%e.length))}return n}}function lr(t,e){return t<e?-1:t>e?1:0}function bc(t,e,r){return t.length===e.length&&t.every((n,s)=>r(n,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new nt(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new nt(je.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new nt(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new nt(je.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return an.fromMillis(Date.now())}static fromDate(e){return an.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new an(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?lr(this.nanoseconds,e.nanoseconds):lr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Ot(e)}static min(){return new Ot(new an(0,0))}static max(){return new Ot(new an(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(e,r,n){r===void 0?r=0:r>e.length&&Pt(),n===void 0?n=e.length-r:n>e.length-r&&Pt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return yd.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof yd?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let s=0;s<n;s++){const i=e.get(s),a=r.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}}class Sr extends yd{construct(e,r,n){return new Sr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new nt(je.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(s=>s.length>0))}return new Sr(r)}static emptyPath(){return new Sr([])}}const X5=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends yd{construct(e,r,n){return new xn(e,r,n)}static isValidIdentifier(e){return X5.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new xn(["__name__"])}static fromServerFormat(e){const r=[];let n="",s=0;const i=()=>{if(n.length===0)throw new nt(je.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new nt(je.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new nt(je.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(n+=o,s++):(i(),s++)}if(i(),a)throw new nt(je.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(r)}static emptyPath(){return new xn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.path=e}static fromPath(e){return new xt(Sr.fromString(e))}static fromName(e){return new xt(Sr.fromString(e).popFirst(5))}static empty(){return new xt(Sr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Sr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Sr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xt(new Sr(e.slice()))}}function Y5(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,s=Ot.fromTimestamp(n===1e9?new an(r+1,0):new an(r,n));return new fo(s,xt.empty(),e)}function Q5(t){return new fo(t.readTime,t.key,-1)}class fo{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new fo(Ot.min(),xt.empty(),-1)}static max(){return new fo(Ot.max(),xt.empty(),-1)}}function J5(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=xt.comparator(t.documentKey,e.documentKey),r!==0?r:lr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z5="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yd(t){if(t.code!==je.FAILED_PRECONDITION||t.message!==Z5)throw t;mt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Pt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new Ye((n,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(n,s)},this.catchCallback=i=>{this.wrapFailure(r,i).next(n,s)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof Ye?r:Ye.resolve(r)}catch(r){return Ye.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):Ye.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):Ye.reject(r)}static resolve(e){return new Ye((r,n)=>{r(e)})}static reject(e){return new Ye((r,n)=>{n(e)})}static waitFor(e){return new Ye((r,n)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&r()},l=>n(l))}),a=!0,i===s&&r()})}static or(e){let r=Ye.resolve(!1);for(const n of e)r=r.next(s=>s?Ye.resolve(s):n());return r}static forEach(e,r){const n=[];return e.forEach((s,i)=>{n.push(r.call(this,s,i))}),this.waitFor(n)}static mapArray(e,r){return new Ye((n,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const c=l;r(e[c]).next(u=>{a[c]=u,++o,o===i&&n(a)},u=>s(u))}})}static doWhile(e,r){return new Ye((n,s)=>{const i=()=>{e()===!0?r().next(()=>{i()},s):n()};i()})}}function tN(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Qd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ie(n),this.se=n=>r.writeSequenceNumber(n))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}ty.oe=-1;function dp(t){return t==null}function oh(t){return t===0&&1/t==-1/0}function rN(t){return typeof t=="number"&&Number.isInteger(t)&&!oh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function ml(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function nC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Or{constructor(e,r){this.comparator=e,this.root=r||Cn.EMPTY}insert(e,r){return new Or(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Cn.BLACK,null,null))}remove(e){return new Or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Cn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return r+n.left.size;s<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bf(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bf(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bf(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bf(this.root,e,this.comparator,!0)}}class Bf{constructor(e,r,n,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=r?n(e.key,r):1,r&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Cn{constructor(e,r,n,s,i){this.key=e,this.value=r,this.color=n??Cn.RED,this.left=s??Cn.EMPTY,this.right=i??Cn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,s,i){return new Cn(e??this.key,r??this.value,n??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let s=this;const i=n(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,r,n),null):i===0?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(e,r,n)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Cn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,s=this;if(r(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),r(e,s.key)===0){if(s.right.isEmpty())return Cn.EMPTY;n=s.right.min(),s=s.copy(n.key,n.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Cn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Cn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Pt();const e=this.left.check();if(e!==this.right.check())throw Pt();return e+(this.isRed()?0:1)}}Cn.EMPTY=null,Cn.RED=!0,Cn.BLACK=!1;Cn.EMPTY=new class{constructor(){this.size=0}get key(){throw Pt()}get value(){throw Pt()}get color(){throw Pt()}get left(){throw Pt()}get right(){throw Pt()}copy(e,r,n,s,i){return this}insert(e,r,n){return new Cn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.comparator=e,this.data=new Or(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const s=n.getNext();if(this.comparator(s.key,e[1])>=0)return;r(s.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new PE(this.data.getIterator())}getIteratorFrom(e){return new PE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Fn)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Fn(this.comparator);return r.data=e,r}}class PE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new Ps([])}unionWith(e){let r=new Fn(xn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Ps(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return bc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new sC("Invalid base64 string: "+i):i}}(e);return new _n(r)}static fromUint8Array(e){const r=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new _n(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return lr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}_n.EMPTY_BYTE_STRING=new _n("");const nN=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ho(t){if(pr(!!t),typeof t=="string"){let e=0;const r=nN.exec(t);if(pr(!!r),r[1]){let s=r[1];s=(s+"000000000").substr(0,9),e=Number(s)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Kr(t.seconds),nanos:Kr(t.nanos)}}function Kr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function nl(t){return typeof t=="string"?_n.fromBase64String(t):_n.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fp(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function ry(t){const e=t.mapValue.fields.__previous_value__;return fp(e)?ry(e):e}function xd(t){const e=ho(t.mapValue.fields.__local_write_time__.timestampValue);return new an(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e,r,n,s,i,a,o,l,c){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=c}}class Sc{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new Sc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Sc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uf={mapValue:{}};function sl(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?fp(t)?4:iN(t)?9007199254740991:aN(t)?10:11:Pt()}function $a(t,e){if(t===e)return!0;const r=sl(t);if(r!==sl(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return xd(t).isEqual(xd(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=ho(s.timestampValue),o=ho(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return nl(s.bytesValue).isEqual(nl(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Kr(s.geoPointValue.latitude)===Kr(i.geoPointValue.latitude)&&Kr(s.geoPointValue.longitude)===Kr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Kr(s.integerValue)===Kr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=Kr(s.doubleValue),o=Kr(i.doubleValue);return a===o?oh(a)===oh(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return bc(t.arrayValue.values||[],e.arrayValue.values||[],$a);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(DE(a)!==DE(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!$a(a[l],o[l])))return!1;return!0}(t,e);default:return Pt()}}function Ed(t,e){return(t.values||[]).find(r=>$a(r,e))!==void 0}function Ac(t,e){if(t===e)return 0;const r=sl(t),n=sl(e);if(r!==n)return lr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return lr(t.booleanValue,e.booleanValue);case 2:return function(i,a){const o=Kr(i.integerValue||i.doubleValue),l=Kr(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(t,e);case 3:return RE(t.timestampValue,e.timestampValue);case 4:return RE(xd(t),xd(e));case 5:return lr(t.stringValue,e.stringValue);case 6:return function(i,a){const o=nl(i),l=nl(a);return o.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let c=0;c<o.length&&c<l.length;c++){const u=lr(o[c],l[c]);if(u!==0)return u}return lr(o.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,a){const o=lr(Kr(i.latitude),Kr(a.latitude));return o!==0?o:lr(Kr(i.longitude),Kr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return FE(t.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,c,u;const f=i.fields||{},h=a.fields||{},p=(o=f.value)===null||o===void 0?void 0:o.arrayValue,g=(l=h.value)===null||l===void 0?void 0:l.arrayValue,y=lr(((c=p==null?void 0:p.values)===null||c===void 0?void 0:c.length)||0,((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0);return y!==0?y:FE(p,g)}(t.mapValue,e.mapValue);case 11:return function(i,a){if(i===Uf.mapValue&&a===Uf.mapValue)return 0;if(i===Uf.mapValue)return 1;if(a===Uf.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),c=a.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const h=lr(l[f],u[f]);if(h!==0)return h;const p=Ac(o[l[f]],c[u[f]]);if(p!==0)return p}return lr(l.length,u.length)}(t.mapValue,e.mapValue);default:throw Pt()}}function RE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return lr(t,e);const r=ho(t),n=ho(e),s=lr(r.seconds,n.seconds);return s!==0?s:lr(r.nanos,n.nanos)}function FE(t,e){const r=t.values||[],n=e.values||[];for(let s=0;s<r.length&&s<n.length;++s){const i=Ac(r[s],n[s]);if(i)return i}return lr(r.length,n.length)}function Tc(t){return vv(t)}function vv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=ho(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return nl(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return xt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",s=!0;for(const i of r.values||[])s?s=!1:n+=",",n+=vv(i);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let s="{",i=!0;for(const a of n)i?i=!1:s+=",",s+=`${a}:${vv(r.fields[a])}`;return s+"}"}(t.mapValue):Pt()}function lh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function yv(t){return!!t&&"integerValue"in t}function ny(t){return!!t&&"arrayValue"in t}function NE(t){return!!t&&"nullValue"in t}function OE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function A0(t){return!!t&&"mapValue"in t}function aN(t){var e,r;return((r=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="__vector__"}function $u(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ml(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=$u(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=$u(t.arrayValue.values[r]);return e}return Object.assign({},t)}function iN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bs{constructor(e){this.value=e}static empty(){return new bs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!A0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=$u(r)}setAll(e){let r=xn.emptyPath(),n={},s=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){const l=this.getFieldsMap(r);this.applyChanges(l,n,s),n={},s=[],r=o.popLast()}a?n[o.lastSegment()]=$u(a):s.push(o.lastSegment())});const i=this.getFieldsMap(r);this.applyChanges(i,n,s)}delete(e){const r=this.field(e.popLast());A0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return $a(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let s=r.mapValue.fields[e.get(n)];A0(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=s),r=s}return r.mapValue.fields}applyChanges(e,r,n){ml(r,(s,i)=>e[s]=i);for(const s of n)delete e[s]}clone(){return new bs($u(this.value))}}function aC(t){const e=[];return ml(t.fields,(r,n)=>{const s=new xn([r]);if(A0(n)){const i=aC(n.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new Ps(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e,r,n,s,i,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Kn(e,0,Ot.min(),Ot.min(),Ot.min(),bs.empty(),0)}static newFoundDocument(e,r,n,s){return new Kn(e,1,r,Ot.min(),n,s,0)}static newNoDocument(e,r){return new Kn(e,2,r,Ot.min(),Ot.min(),bs.empty(),0)}static newUnknownDocument(e,r){return new Kn(e,3,r,Ot.min(),Ot.min(),bs.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Ot.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=bs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=bs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ot.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Kn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Kn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,r){this.position=e,this.inclusive=r}}function ME(t,e,r){let n=0;for(let s=0;s<t.position.length;s++){const i=e[s],a=t.position[s];if(i.field.isKeyField()?n=xt.comparator(xt.fromName(a.referenceValue),r.key):n=Ac(a,r.data.field(i.field)),i.dir==="desc"&&(n*=-1),n!==0)break}return n}function LE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!$a(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,r="asc"){this.field=e,this.dir=r}}function oN(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{}class nn extends iC{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new cN(e,r,n):r==="array-contains"?new fN(e,n):r==="in"?new hN(e,n):r==="not-in"?new pN(e,n):r==="array-contains-any"?new mN(e,n):new nn(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new uN(e,n):new dN(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Ac(r,this.value)):r!==null&&sl(this.value)===sl(r)&&this.matchesComparison(Ac(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class va extends iC{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new va(e,r)}matches(e){return oC(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function oC(t){return t.op==="and"}function lC(t){return lN(t)&&oC(t)}function lN(t){for(const e of t.filters)if(e instanceof va)return!1;return!0}function xv(t){if(t instanceof nn)return t.field.canonicalString()+t.op.toString()+Tc(t.value);if(lC(t))return t.filters.map(e=>xv(e)).join(",");{const e=t.filters.map(r=>xv(r)).join(",");return`${t.op}(${e})`}}function cC(t,e){return t instanceof nn?function(n,s){return s instanceof nn&&n.op===s.op&&n.field.isEqual(s.field)&&$a(n.value,s.value)}(t,e):t instanceof va?function(n,s){return s instanceof va&&n.op===s.op&&n.filters.length===s.filters.length?n.filters.reduce((i,a,o)=>i&&cC(a,s.filters[o]),!0):!1}(t,e):void Pt()}function uC(t){return t instanceof nn?function(r){return`${r.field.canonicalString()} ${r.op} ${Tc(r.value)}`}(t):t instanceof va?function(r){return r.op.toString()+" {"+r.getFilters().map(uC).join(" ,")+"}"}(t):"Filter"}class cN extends nn{constructor(e,r,n){super(e,r,n),this.key=xt.fromName(n.referenceValue)}matches(e){const r=xt.comparator(e.key,this.key);return this.matchesComparison(r)}}class uN extends nn{constructor(e,r){super(e,"in",r),this.keys=dC("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class dN extends nn{constructor(e,r){super(e,"not-in",r),this.keys=dC("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function dC(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>xt.fromName(n.referenceValue))}class fN extends nn{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return ny(r)&&Ed(r.arrayValue,this.value)}}class hN extends nn{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&Ed(this.value.arrayValue,r)}}class pN extends nn{constructor(e,r){super(e,"not-in",r)}matches(e){if(Ed(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&!Ed(this.value.arrayValue,r)}}class mN extends nn{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!ny(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Ed(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e,r=null,n=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function BE(t,e=null,r=[],n=[],s=null,i=null,a=null){return new gN(t,e,r,n,s,i,a)}function sy(t){const e=Lt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>xv(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(i){return i.field.canonicalString()+i.dir}(n)).join(","),dp(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Tc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Tc(n)).join(",")),e.ue=r}return e.ue}function ay(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!oN(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!cC(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!LE(t.startAt,e.startAt)&&LE(t.endAt,e.endAt)}function Ev(t){return xt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e,r=null,n=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function vN(t,e,r,n,s,i,a,o){return new gl(t,e,r,n,s,i,a,o)}function hp(t){return new gl(t)}function UE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function iy(t){return t.collectionGroup!==null}function cc(t){const e=Lt(t);if(e.ce===null){e.ce=[];const r=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),r.add(i.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Fn(xn.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(o=o.add(c.field))})}),o})(e).forEach(i=>{r.has(i.canonicalString())||i.isKeyField()||e.ce.push(new _d(i,n))}),r.has(xn.keyField().canonicalString())||e.ce.push(new _d(xn.keyField(),n))}return e.ce}function Oa(t){const e=Lt(t);return e.le||(e.le=yN(e,cc(t))),e.le}function yN(t,e){if(t.limitType==="F")return BE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new _d(s.field,i)});const r=t.endAt?new wc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new wc(t.startAt.position,t.startAt.inclusive):null;return BE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function _v(t,e){const r=t.filters.concat([e]);return new gl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function ch(t,e,r){return new gl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function pp(t,e){return ay(Oa(t),Oa(e))&&t.limitType===e.limitType}function fC(t){return`${sy(Oa(t))}|lt:${t.limitType}`}function Hl(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(s=>uC(s)).join(", ")}]`),dp(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(s=>Tc(s)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(s=>Tc(s)).join(",")),`Target(${n})`}(Oa(t))}; limitType=${t.limitType})`}function mp(t,e){return e.isFoundDocument()&&function(n,s){const i=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(i):xt.isDocumentKey(n.path)?n.path.isEqual(i):n.path.isImmediateParentOf(i)}(t,e)&&function(n,s){for(const i of cc(n))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const i of n.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(a,o,l){const c=ME(a,o,l);return a.inclusive?c<=0:c<0}(n.startAt,cc(n),s)||n.endAt&&!function(a,o,l){const c=ME(a,o,l);return a.inclusive?c>=0:c>0}(n.endAt,cc(n),s))}(t,e)}function xN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hC(t){return(e,r)=>{let n=!1;for(const s of cc(t)){const i=EN(s,e,r);if(i!==0)return i;n=n||s.field.isKeyField()}return 0}}function EN(t,e,r){const n=t.field.isKeyField()?xt.comparator(e.key,r.key):function(i,a,o){const l=a.data.field(i),c=o.data.field(i);return l!==null&&c!==null?Ac(l,c):Pt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Pt()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[s,i]of n)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,r]);s.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let s=0;s<n.length;s++)if(this.equalsFn(n[s][0],e))return n.length===1?delete this.inner[r]:n.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ml(this.inner,(r,n)=>{for(const[s,i]of n)e(s,i)})}isEmpty(){return nC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N=new Or(xt.comparator);function wi(){return _N}const pC=new Or(xt.comparator);function xu(...t){let e=pC;for(const r of t)e=e.insert(r.key,r);return e}function mC(t){let e=pC;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Bo(){return Vu()}function gC(){return Vu()}function Vu(){return new Uc(t=>t.toString(),(t,e)=>t.isEqual(e))}const bN=new Or(xt.comparator),SN=new Fn(xt.comparator);function Xt(...t){let e=SN;for(const r of t)e=e.add(r);return e}const AN=new Fn(lr);function TN(){return AN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:oh(e)?"-0":e}}function vC(t){return{integerValue:""+t}}function wN(t,e){return rN(e)?vC(e):oy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(){this._=void 0}}function CN(t,e,r){return t instanceof bd?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&fp(i)&&(i=ry(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(r,e):t instanceof Sd?xC(t,e):t instanceof Ad?EC(t,e):function(s,i){const a=yC(s,i),o=$E(a)+$E(s.Pe);return yv(a)&&yv(s.Pe)?vC(o):oy(s.serializer,o)}(t,e)}function IN(t,e,r){return t instanceof Sd?xC(t,e):t instanceof Ad?EC(t,e):r}function yC(t,e){return t instanceof uh?function(n){return yv(n)||function(i){return!!i&&"doubleValue"in i}(n)}(e)?e:{integerValue:0}:null}class bd extends gp{}class Sd extends gp{constructor(e){super(),this.elements=e}}function xC(t,e){const r=_C(e);for(const n of t.elements)r.some(s=>$a(s,n))||r.push(n);return{arrayValue:{values:r}}}class Ad extends gp{constructor(e){super(),this.elements=e}}function EC(t,e){let r=_C(e);for(const n of t.elements)r=r.filter(s=>!$a(s,n));return{arrayValue:{values:r}}}class uh extends gp{constructor(e,r){super(),this.serializer=e,this.Pe=r}}function $E(t){return Kr(t.integerValue||t.doubleValue)}function _C(t){return ny(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e,r){this.field=e,this.transform=r}}function DN(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Sd&&s instanceof Sd||n instanceof Ad&&s instanceof Ad?bc(n.elements,s.elements,$a):n instanceof uh&&s instanceof uh?$a(n.Pe,s.Pe):n instanceof bd&&s instanceof bd}(t.transform,e.transform)}class PN{constructor(e,r){this.version=e,this.transformResults=r}}class fs{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new fs}static exists(e){return new fs(void 0,e)}static updateTime(e){return new fs(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function T0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vp{}function bC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new yp(t.key,fs.none()):new Jd(t.key,t.data,fs.none());{const r=t.data,n=bs.empty();let s=new Fn(xn.comparator);for(let i of e.fields)if(!s.has(i)){let a=r.field(i);a===null&&i.length>1&&(i=i.popLast(),a=r.field(i)),a===null?n.delete(i):n.set(i,a),s=s.add(i)}return new yo(t.key,n,new Ps(s.toArray()),fs.none())}}function RN(t,e,r){t instanceof Jd?function(s,i,a){const o=s.value.clone(),l=HE(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof yo?function(s,i,a){if(!T0(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=HE(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(SC(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(t,e,r):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Hu(t,e,r,n){return t instanceof Jd?function(i,a,o,l){if(!T0(i.precondition,a))return o;const c=i.value.clone(),u=jE(i.fieldTransforms,l,a);return c.setAll(u),a.convertToFoundDocument(a.version,c).setHasLocalMutations(),null}(t,e,r,n):t instanceof yo?function(i,a,o,l){if(!T0(i.precondition,a))return o;const c=jE(i.fieldTransforms,l,a),u=a.data;return u.setAll(SC(i)),u.setAll(c),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(i,a,o){return T0(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function FN(t,e){let r=null;for(const n of t.fieldTransforms){const s=e.data.field(n.field),i=yC(n.transform,s||null);i!=null&&(r===null&&(r=bs.empty()),r.set(n.field,i))}return r||null}function VE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&bc(n,s,(i,a)=>DN(i,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Jd extends vp{constructor(e,r,n,s=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class yo extends vp{constructor(e,r,n,s,i=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function SC(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function HE(t,e,r){const n=new Map;pr(t.length===r.length);for(let s=0;s<r.length;s++){const i=t[s],a=i.transform,o=e.data.field(i.field);n.set(i.field,IN(a,o,r[s]))}return n}function jE(t,e,r){const n=new Map;for(const s of t){const i=s.transform,a=r.data.field(s.field);n.set(s.field,CN(i,a,e))}return n}class yp extends vp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class NN extends vp{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,r,n,s){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=s}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&RN(i,e,n[s])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Hu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Hu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=gC();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=r.has(s.key)?null:o;const l=bC(a,o);l!==null&&n.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Ot.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Xt())}isEqual(e){return this.batchId===e.batchId&&bc(this.mutations,e.mutations,(r,n)=>VE(r,n))&&bc(this.baseMutations,e.baseMutations,(r,n)=>VE(r,n))}}class ly{constructor(e,r,n,s){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=s}static from(e,r,n){pr(e.mutations.length===n.length);let s=function(){return bN}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,n[a].version);return new ly(e,r,n,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jr,rr;function BN(t){switch(t){default:return Pt();case je.CANCELLED:case je.UNKNOWN:case je.DEADLINE_EXCEEDED:case je.RESOURCE_EXHAUSTED:case je.INTERNAL:case je.UNAVAILABLE:case je.UNAUTHENTICATED:return!1;case je.INVALID_ARGUMENT:case je.NOT_FOUND:case je.ALREADY_EXISTS:case je.PERMISSION_DENIED:case je.FAILED_PRECONDITION:case je.ABORTED:case je.OUT_OF_RANGE:case je.UNIMPLEMENTED:case je.DATA_LOSS:return!0}}function AC(t){if(t===void 0)return Ti("GRPC error has no .code"),je.UNKNOWN;switch(t){case Jr.OK:return je.OK;case Jr.CANCELLED:return je.CANCELLED;case Jr.UNKNOWN:return je.UNKNOWN;case Jr.DEADLINE_EXCEEDED:return je.DEADLINE_EXCEEDED;case Jr.RESOURCE_EXHAUSTED:return je.RESOURCE_EXHAUSTED;case Jr.INTERNAL:return je.INTERNAL;case Jr.UNAVAILABLE:return je.UNAVAILABLE;case Jr.UNAUTHENTICATED:return je.UNAUTHENTICATED;case Jr.INVALID_ARGUMENT:return je.INVALID_ARGUMENT;case Jr.NOT_FOUND:return je.NOT_FOUND;case Jr.ALREADY_EXISTS:return je.ALREADY_EXISTS;case Jr.PERMISSION_DENIED:return je.PERMISSION_DENIED;case Jr.FAILED_PRECONDITION:return je.FAILED_PRECONDITION;case Jr.ABORTED:return je.ABORTED;case Jr.OUT_OF_RANGE:return je.OUT_OF_RANGE;case Jr.UNIMPLEMENTED:return je.UNIMPLEMENTED;case Jr.DATA_LOSS:return je.DATA_LOSS;default:return Pt()}}(rr=Jr||(Jr={}))[rr.OK=0]="OK",rr[rr.CANCELLED=1]="CANCELLED",rr[rr.UNKNOWN=2]="UNKNOWN",rr[rr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rr[rr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rr[rr.NOT_FOUND=5]="NOT_FOUND",rr[rr.ALREADY_EXISTS=6]="ALREADY_EXISTS",rr[rr.PERMISSION_DENIED=7]="PERMISSION_DENIED",rr[rr.UNAUTHENTICATED=16]="UNAUTHENTICATED",rr[rr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rr[rr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rr[rr.ABORTED=10]="ABORTED",rr[rr.OUT_OF_RANGE=11]="OUT_OF_RANGE",rr[rr.UNIMPLEMENTED=12]="UNIMPLEMENTED",rr[rr.INTERNAL=13]="INTERNAL",rr[rr.UNAVAILABLE=14]="UNAVAILABLE",rr[rr.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N=new Wo([4294967295,4294967295],0);function GE(t){const e=UN().encode(t),r=new Xw;return r.update(e),new Uint8Array(r.digest())}function WE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Wo([r,n],0),new Wo([s,i],0)]}class cy{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Eu(`Invalid padding: ${r}`);if(n<0)throw new Eu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Eu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Eu(`Invalid padding when bitmap length is 0: ${r}`);this.Ie=8*e.length-r,this.Te=Wo.fromNumber(this.Ie)}Ee(e,r,n){let s=e.add(r.multiply(Wo.fromNumber(n)));return s.compare($N)===1&&(s=new Wo([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const r=GE(e),[n,s]=WE(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);if(!this.de(a))return!1}return!0}static create(e,r,n){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new cy(i,s,r);return n.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const r=GE(e),[n,s]=WE(r);for(let i=0;i<this.hashCount;i++){const a=this.Ee(n,s,i);this.Ae(a)}}Ae(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Eu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xp{constructor(e,r,n,s,i){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const s=new Map;return s.set(e,Zd.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new xp(Ot.min(),s,new Or(lr),wi(),Xt())}}class Zd{constructor(e,r,n,s,i){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Zd(n,r,Xt(),Xt(),Xt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w0{constructor(e,r,n,s){this.Re=e,this.removedTargetIds=r,this.key=n,this.Ve=s}}class TC{constructor(e,r){this.targetId=e,this.me=r}}class wC{constructor(e,r,n=_n.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=s}}class zE{constructor(){this.fe=0,this.ge=qE(),this.pe=_n.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Xt(),r=Xt(),n=Xt();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:r=r.add(s);break;case 1:n=n.add(s);break;default:Pt()}}),new Zd(this.pe,this.ye,e,r,n)}Ce(){this.we=!1,this.ge=qE()}Fe(e,r){this.we=!0,this.ge=this.ge.insert(e,r)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,pr(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class VN{constructor(e){this.Le=e,this.Be=new Map,this.ke=wi(),this.qe=KE(),this.Qe=new Or(lr)}Ke(e){for(const r of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(r,e.Ve):this.Ue(r,e.key,e.Ve);for(const r of e.removedTargetIds)this.Ue(r,e.key,e.Ve)}We(e){this.forEachTarget(e,r=>{const n=this.Ge(r);switch(e.state){case 0:this.ze(r)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(r);break;case 3:this.ze(r)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(r)&&(this.je(r),n.De(e.resumeToken));break;default:Pt()}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Be.forEach((n,s)=>{this.ze(s)&&r(s)})}He(e){const r=e.targetId,n=e.me.count,s=this.Je(r);if(s){const i=s.target;if(Ev(i))if(n===0){const a=new xt(i.path);this.Ue(r,a,Kn.newNoDocument(a,Ot.min()))}else pr(n===1);else{const a=this.Ye(r);if(a!==n){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(r);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(r,c)}}}}}Ze(e){const r=e.me.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:s=0},hashCount:i=0}=r;let a,o;try{a=nl(n).toUint8Array()}catch(l){if(l instanceof sC)return rl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new cy(a,s,i)}catch(l){return rl(l instanceof Eu?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,r,n){return r.me.count===n-this.nt(e,r.targetId)?0:2}nt(e,r){const n=this.Le.getRemoteKeysForTarget(r);let s=0;return n.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(r,i,null),s++)}),s}rt(e){const r=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&Ev(o.target)){const l=new xt(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Kn.newNoDocument(l,e))}i.be&&(r.set(a,i.ve()),i.Ce())}});let n=Xt();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(n=n.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new xp(e,r,this.Qe,this.ke,n);return this.ke=wi(),this.qe=KE(),this.Qe=new Or(lr),s}$e(e,r){if(!this.ze(e))return;const n=this.it(e,r.key)?2:0;this.Ge(e).Fe(r.key,n),this.ke=this.ke.insert(r.key,r),this.qe=this.qe.insert(r.key,this.st(r.key).add(e))}Ue(e,r,n){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,r)?s.Fe(r,1):s.Me(r),this.qe=this.qe.insert(r,this.st(r).delete(e)),n&&(this.ke=this.ke.insert(r,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const r=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let r=this.Be.get(e);return r||(r=new zE,this.Be.set(e,r)),r}st(e){let r=this.qe.get(e);return r||(r=new Fn(lr),this.qe=this.qe.insert(e,r)),r}ze(e){const r=this.Je(e)!==null;return r||mt("WatchChangeAggregator","Detected inactive target",e),r}Je(e){const r=this.Be.get(e);return r&&r.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new zE),this.Le.getRemoteKeysForTarget(e).forEach(r=>{this.Ue(e,r,null)})}it(e,r){return this.Le.getRemoteKeysForTarget(e).has(r)}}function KE(){return new Or(xt.comparator)}function qE(){return new Or(xt.comparator)}const HN={asc:"ASCENDING",desc:"DESCENDING"},jN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GN={and:"AND",or:"OR"};class WN{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function bv(t,e){return t.useProto3Json||dp(e)?e:{value:e}}function dh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function CC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function zN(t,e){return dh(t,e.toTimestamp())}function Ma(t){return pr(!!t),Ot.fromTimestamp(function(r){const n=ho(r);return new an(n.seconds,n.nanos)}(t))}function uy(t,e){return Sv(t,e).canonicalString()}function Sv(t,e){const r=function(s){return new Sr(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?r:r.child(e)}function IC(t){const e=Sr.fromString(t);return pr(FC(e)),e}function Av(t,e){return uy(t.databaseId,e.path)}function vm(t,e){const r=IC(e);if(r.get(1)!==t.databaseId.projectId)throw new nt(je.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new nt(je.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new xt(DC(r))}function kC(t,e){return uy(t.databaseId,e)}function KN(t){const e=IC(t);return e.length===4?Sr.emptyPath():DC(e)}function Tv(t){return new Sr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function DC(t){return pr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function XE(t,e,r){return{name:Av(t,e),fields:r.value.mapValue.fields}}function qN(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Pt()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(pr(u===void 0||typeof u=="string"),_n.fromBase64String(u||"")):(pr(u===void 0||u instanceof Buffer||u instanceof Uint8Array),_n.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(c){const u=c.code===void 0?je.UNKNOWN:AC(c.code);return new nt(u,c.message||"")}(a);r=new wC(n,s,i,o||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const s=vm(t,n.document.name),i=Ma(n.document.updateTime),a=n.document.createTime?Ma(n.document.createTime):Ot.min(),o=new bs({mapValue:{fields:n.document.fields}}),l=Kn.newFoundDocument(s,i,a,o),c=n.targetIds||[],u=n.removedTargetIds||[];r=new w0(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const s=vm(t,n.document),i=n.readTime?Ma(n.readTime):Ot.min(),a=Kn.newNoDocument(s,i),o=n.removedTargetIds||[];r=new w0([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const s=vm(t,n.document),i=n.removedTargetIds||[];r=new w0([],i,s,null)}else{if(!("filter"in e))return Pt();{e.filter;const n=e.filter;n.targetId;const{count:s=0,unchangedNames:i}=n,a=new LN(s,i),o=n.targetId;r=new TC(o,a)}}return r}function XN(t,e){let r;if(e instanceof Jd)r={update:XE(t,e.key,e.value)};else if(e instanceof yp)r={delete:Av(t,e.key)};else if(e instanceof yo)r={update:XE(t,e.key,e.data),updateMask:sO(e.fieldMask)};else{if(!(e instanceof NN))return Pt();r={verify:Av(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(i,a){const o=a.transform;if(o instanceof bd)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Sd)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ad)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof uh)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Pt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:zN(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Pt()}(t,e.precondition)),r}function YN(t,e){return t&&t.length>0?(pr(e!==void 0),t.map(r=>function(s,i){let a=s.updateTime?Ma(s.updateTime):Ma(i);return a.isEqual(Ot.min())&&(a=Ma(i)),new PN(a,s.transformResults||[])}(r,e))):[]}function QN(t,e){return{documents:[kC(t,e.path)]}}function JN(t,e){const r={structuredQuery:{}},n=e.path;let s;e.collectionGroup!==null?(s=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=kC(t,s);const i=function(c){if(c.length!==0)return RC(va.create(c,"and"))}(e.filters);i&&(r.structuredQuery.where=i);const a=function(c){if(c.length!==0)return c.map(u=>function(h){return{field:jl(h.field),direction:tO(h.dir)}}(u))}(e.orderBy);a&&(r.structuredQuery.orderBy=a);const o=bv(t,e.limit);return o!==null&&(r.structuredQuery.limit=o),e.startAt&&(r.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:r,parent:s}}function ZN(t){let e=KN(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let s=null;if(n>0){pr(n===1);const u=r.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];r.where&&(i=function(f){const h=PC(f);return h instanceof va&&lC(h)?h.getFilters():[h]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(h=>function(g){return new _d(Gl(g.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(h))}(r.orderBy));let o=null;r.limit&&(o=function(f){let h;return h=typeof f=="object"?f.value:f,dp(h)?null:h}(r.limit));let l=null;r.startAt&&(l=function(f){const h=!!f.before,p=f.values||[];return new wc(p,h)}(r.startAt));let c=null;return r.endAt&&(c=function(f){const h=!f.before,p=f.values||[];return new wc(p,h)}(r.endAt)),vN(e,s,a,i,o,"F",l,c)}function eO(t,e){const r=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pt()}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function PC(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Gl(r.unaryFilter.field);return nn.create(n,"==",{doubleValue:NaN});case"IS_NULL":const s=Gl(r.unaryFilter.field);return nn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Gl(r.unaryFilter.field);return nn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Gl(r.unaryFilter.field);return nn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Pt()}}(t):t.fieldFilter!==void 0?function(r){return nn.create(Gl(r.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Pt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return va.create(r.compositeFilter.filters.map(n=>PC(n)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Pt()}}(r.compositeFilter.op))}(t):Pt()}function tO(t){return HN[t]}function rO(t){return jN[t]}function nO(t){return GN[t]}function jl(t){return{fieldPath:t.canonicalString()}}function Gl(t){return xn.fromServerFormat(t.fieldPath)}function RC(t){return t instanceof nn?function(r){if(r.op==="=="){if(OE(r.value))return{unaryFilter:{field:jl(r.field),op:"IS_NAN"}};if(NE(r.value))return{unaryFilter:{field:jl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(OE(r.value))return{unaryFilter:{field:jl(r.field),op:"IS_NOT_NAN"}};if(NE(r.value))return{unaryFilter:{field:jl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jl(r.field),op:rO(r.op),value:r.value}}}(t):t instanceof va?function(r){const n=r.getFilters().map(s=>RC(s));return n.length===1?n[0]:{compositeFilter:{op:nO(r.op),filters:n}}}(t):Pt()}function sO(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function FC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e,r,n,s,i=Ot.min(),a=Ot.min(),o=_n.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Qi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.ct=e}}function iO(t){const e=ZN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ch(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(){this.un=new lO}addToCollectionParentIndex(e,r){return this.un.add(r),Ye.resolve()}getCollectionParents(e,r){return Ye.resolve(this.un.getEntries(r))}addFieldIndex(e,r){return Ye.resolve()}deleteFieldIndex(e,r){return Ye.resolve()}deleteAllFieldIndexes(e){return Ye.resolve()}createTargetIndexes(e,r){return Ye.resolve()}getDocumentsMatchingTarget(e,r){return Ye.resolve(null)}getIndexType(e,r){return Ye.resolve(0)}getFieldIndexes(e,r){return Ye.resolve([])}getNextCollectionGroupToUpdate(e){return Ye.resolve(null)}getMinOffset(e,r){return Ye.resolve(fo.min())}getMinOffsetFromCollectionGroup(e,r){return Ye.resolve(fo.min())}updateCollectionGroup(e,r,n){return Ye.resolve()}updateIndexEntries(e,r){return Ye.resolve()}}class lO{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r]||new Fn(Sr.comparator),i=!s.has(n);return this.index[r]=s.add(n),i}has(e){const r=e.lastSegment(),n=e.popLast(),s=this.index[r];return s&&s.has(n)}getEntries(e){return(this.index[e]||new Fn(Sr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Cc(0)}static kn(){return new Cc(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(){this.changes=new Uc(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Kn.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?Ye.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e,r,n,s){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=s}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(s=>(n=s,this.remoteDocumentCache.getEntry(e,r))).next(s=>(n!==null&&Hu(n.mutation,s,Ps.empty(),an.now()),s))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Xt()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Xt()){const s=Bo();return this.populateOverlays(e,s,r).next(()=>this.computeViews(e,r,s,n).next(i=>{let a=xu();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){const n=Bo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Xt()))}populateOverlays(e,r,n){const s=[];return n.forEach(i=>{r.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,s){let i=wi();const a=Vu(),o=function(){return Vu()}();return r.forEach((l,c)=>{const u=n.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof yo)?i=i.insert(c.key,c):u!==void 0?(a.set(c.key,u.mutation.getFieldMask()),Hu(u.mutation,c,u.mutation.getFieldMask(),an.now())):a.set(c.key,Ps.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>a.set(c,u)),r.forEach((c,u)=>{var f;return o.set(c,new uO(u,(f=a.get(c))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,r){const n=Vu();let s=new Or((a,o)=>a-o),i=Xt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(const o of a)o.keys().forEach(l=>{const c=r.get(l);if(c===null)return;let u=n.get(l)||Ps.empty();u=o.applyToLocalView(c,u),n.set(l,u);const f=(s.get(o.batchId)||Xt()).add(l);s=s.insert(o.batchId,f)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),c=l.key,u=l.value,f=gC();u.forEach(h=>{if(!i.has(h)){const p=bC(r.get(h),n.get(h));p!==null&&f.set(h,p),i=i.add(h)}}),a.push(this.documentOverlayCache.saveOverlays(e,c,f))}return Ye.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,s){return function(a){return xt.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):iy(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,s):this.getDocumentsMatchingCollectionQuery(e,r,n,s)}getNextDocuments(e,r,n,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,s-i.size):Ye.resolve(Bo());let o=-1,l=i;return a.next(c=>Ye.forEach(c,(u,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),i.get(u)?Ye.resolve():this.remoteDocumentCache.getEntry(e,u).next(h=>{l=l.insert(u,h)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,Xt())).next(u=>({batchId:o,changes:mC(u)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new xt(r)).next(n=>{let s=xu();return n.isFoundDocument()&&(s=s.insert(n.key,n)),s})}getDocumentsMatchingCollectionGroupQuery(e,r,n,s){const i=r.collectionGroup;let a=xu();return this.indexManager.getCollectionParents(e,i).next(o=>Ye.forEach(o,l=>{const c=function(f,h){return new gl(h,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,n,s).next(u=>{u.forEach((f,h)=>{a=a.insert(f,h)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,i,s))).next(a=>{i.forEach((l,c)=>{const u=c.getKey();a.get(u)===null&&(a=a.insert(u,Kn.newInvalidDocument(u)))});let o=xu();return a.forEach((l,c)=>{const u=i.get(l);u!==void 0&&Hu(u.mutation,c,Ps.empty(),an.now()),mp(r,c)&&(o=o.insert(l,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,r){return Ye.resolve(this.hr.get(r))}saveBundleMetadata(e,r){return this.hr.set(r.id,function(s){return{id:s.id,version:s.version,createTime:Ma(s.createTime)}}(r)),Ye.resolve()}getNamedQuery(e,r){return Ye.resolve(this.Pr.get(r))}saveNamedQuery(e,r){return this.Pr.set(r.name,function(s){return{name:s.name,query:iO(s.bundledQuery),readTime:Ma(s.readTime)}}(r)),Ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this.overlays=new Or(xt.comparator),this.Ir=new Map}getOverlay(e,r){return Ye.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Bo();return Ye.forEach(r,s=>this.getOverlay(e,s).next(i=>{i!==null&&n.set(s,i)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((s,i)=>{this.ht(e,r,i)}),Ye.resolve()}removeOverlaysForBatchId(e,r,n){const s=this.Ir.get(n);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(n)),Ye.resolve()}getOverlaysForCollection(e,r,n){const s=Bo(),i=r.length+1,a=new xt(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,c=l.getKey();if(!r.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>n&&s.set(l.getKey(),l)}return Ye.resolve(s)}getOverlaysForCollectionGroup(e,r,n,s){let i=new Or((c,u)=>c-u);const a=this.overlays.getIterator();for(;a.hasNext();){const c=a.getNext().value;if(c.getKey().getCollectionGroup()===r&&c.largestBatchId>n){let u=i.get(c.largestBatchId);u===null&&(u=Bo(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const o=Bo(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>o.set(c,u)),!(o.size()>=s)););return Ye.resolve(o)}ht(e,r,n){const s=this.overlays.get(n.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(n.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new MN(r,n));let i=this.Ir.get(r);i===void 0&&(i=Xt(),this.Ir.set(r,i)),this.Ir.set(r,i.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(){this.sessionToken=_n.EMPTY_BYTE_STRING}getSessionToken(e){return Ye.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,Ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dy{constructor(){this.Tr=new Fn(gn.Er),this.dr=new Fn(gn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,r){const n=new gn(e,r);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Vr(new gn(e,r))}mr(e,r){e.forEach(n=>this.removeReference(n,r))}gr(e){const r=new xt(new Sr([])),n=new gn(r,e),s=new gn(r,e+1),i=[];return this.dr.forEachInRange([n,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const r=new xt(new Sr([])),n=new gn(r,e),s=new gn(r,e+1);let i=Xt();return this.dr.forEachInRange([n,s],a=>{i=i.add(a.key)}),i}containsKey(e){const r=new gn(e,0),n=this.Tr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class gn{constructor(e,r){this.key=e,this.wr=r}static Er(e,r){return xt.comparator(e.key,r.key)||lr(e.wr,r.wr)}static Ar(e,r){return lr(e.wr,r.wr)||xt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Sr=1,this.br=new Fn(gn.Er)}checkEmpty(e){return Ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new ON(i,r,n,s);this.mutationQueue.push(a);for(const o of s)this.br=this.br.add(new gn(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Ye.resolve(a)}lookupMutationBatch(e,r){return Ye.resolve(this.Dr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,s=this.vr(n),i=s<0?0:s;return Ye.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ye.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new gn(r,0),s=new gn(r,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,s],a=>{const o=this.Dr(a.wr);i.push(o)}),Ye.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Fn(lr);return r.forEach(s=>{const i=new gn(s,0),a=new gn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{n=n.add(o.wr)})}),Ye.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,s=n.length+1;let i=n;xt.isDocumentKey(i)||(i=i.child(""));const a=new gn(new xt(i),0);let o=new Fn(lr);return this.br.forEachWhile(l=>{const c=l.key.path;return!!n.isPrefixOf(c)&&(c.length===s&&(o=o.add(l.wr)),!0)},a),Ye.resolve(this.Cr(o))}Cr(e){const r=[];return e.forEach(n=>{const s=this.Dr(n);s!==null&&r.push(s)}),r}removeMutationBatch(e,r){pr(this.Fr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.br;return Ye.forEach(r.mutations,s=>{const i=new gn(s.key,r.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=n})}On(e){}containsKey(e,r){const n=new gn(r,0),s=this.br.firstAfterOrEqual(n);return Ye.resolve(r.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ye.resolve()}Fr(e,r){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const r=this.vr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(e){this.Mr=e,this.docs=function(){return new Or(xt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,s=this.docs.get(n),i=s?s.size:0,a=this.Mr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return Ye.resolve(n?n.document.mutableCopy():Kn.newInvalidDocument(r))}getEntries(e,r){let n=wi();return r.forEach(s=>{const i=this.docs.get(s);n=n.insert(s,i?i.document.mutableCopy():Kn.newInvalidDocument(s))}),Ye.resolve(n)}getDocumentsMatchingQuery(e,r,n,s){let i=wi();const a=r.path,o=new xt(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!a.isPrefixOf(c.path))break;c.path.length>a.length+1||J5(Q5(u),n)<=0||(s.has(u.key)||mp(r,u))&&(i=i.insert(u.key,u.mutableCopy()))}return Ye.resolve(i)}getAllFromCollectionGroup(e,r,n,s){Pt()}Or(e,r){return Ye.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new vO(this)}getSize(e){return Ye.resolve(this.size)}}class vO extends cO{constructor(e){super(),this.cr=e}applyChanges(e){const r=[];return this.changes.forEach((n,s)=>{s.isValidDocument()?r.push(this.cr.addEntry(e,s)):this.cr.removeEntry(n)}),Ye.waitFor(r)}getFromCache(e,r){return this.cr.getEntry(e,r)}getAllFromCache(e,r){return this.cr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e){this.persistence=e,this.Nr=new Uc(r=>sy(r),ay),this.lastRemoteSnapshotVersion=Ot.min(),this.highestTargetId=0,this.Lr=0,this.Br=new dy,this.targetCount=0,this.kr=Cc.Bn()}forEachTarget(e,r){return this.Nr.forEach((n,s)=>r(s)),Ye.resolve()}getLastRemoteSnapshotVersion(e){return Ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ye.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Ye.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Lr&&(this.Lr=r),Ye.resolve()}Kn(e){this.Nr.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.kr=new Cc(r),this.highestTargetId=r),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,r){return this.Kn(r),this.targetCount+=1,Ye.resolve()}updateTargetData(e,r){return this.Kn(r),Ye.resolve()}removeTargetData(e,r){return this.Nr.delete(r.target),this.Br.gr(r.targetId),this.targetCount-=1,Ye.resolve()}removeTargets(e,r,n){let s=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),Ye.waitFor(i).next(()=>s)}getTargetCount(e){return Ye.resolve(this.targetCount)}getTargetData(e,r){const n=this.Nr.get(r)||null;return Ye.resolve(n)}addMatchingKeys(e,r,n){return this.Br.Rr(r,n),Ye.resolve()}removeMatchingKeys(e,r,n){this.Br.mr(r,n);const s=this.persistence.referenceDelegate,i=[];return s&&r.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),Ye.waitFor(i)}removeMatchingKeysForTargetId(e,r){return this.Br.gr(r),Ye.resolve()}getMatchingKeysForTargetId(e,r){const n=this.Br.yr(r);return Ye.resolve(n)}containsKey(e,r){return Ye.resolve(this.Br.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xO{constructor(e,r){this.qr={},this.overlays={},this.Qr=new ty(0),this.Kr=!1,this.Kr=!0,this.$r=new pO,this.referenceDelegate=e(this),this.Ur=new yO(this),this.indexManager=new oO,this.remoteDocumentCache=function(s){return new gO(s)}(n=>this.referenceDelegate.Wr(n)),this.serializer=new aO(r),this.Gr=new fO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new hO,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.qr[e.toKey()];return n||(n=new mO(r,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,r,n){mt("MemoryPersistence","Starting transaction:",e);const s=new EO(this.Qr.next());return this.referenceDelegate.zr(),n(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,r){return Ye.or(Object.values(this.qr).map(n=>()=>n.containsKey(e,r)))}}class EO extends eN{constructor(e){super(),this.currentSequenceNumber=e}}class fy{constructor(e){this.persistence=e,this.Jr=new dy,this.Yr=null}static Zr(e){return new fy(e)}get Xr(){if(this.Yr)return this.Yr;throw Pt()}addReference(e,r,n){return this.Jr.addReference(n,r),this.Xr.delete(n.toString()),Ye.resolve()}removeReference(e,r,n){return this.Jr.removeReference(n,r),this.Xr.add(n.toString()),Ye.resolve()}markPotentiallyOrphaned(e,r){return this.Xr.add(r.toString()),Ye.resolve()}removeTarget(e,r){this.Jr.gr(r.targetId).forEach(s=>this.Xr.add(s.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>n.removeTargetData(e,r))}zr(){this.Yr=new Set}jr(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ye.forEach(this.Xr,n=>{const s=xt.fromPath(n);return this.ei(e,s).next(i=>{i||r.removeEntry(s,Ot.min())})}).next(()=>(this.Yr=null,r.apply(e)))}updateLimboDocument(e,r){return this.ei(e,r).next(n=>{n?this.Xr.delete(r.toString()):this.Xr.add(r.toString())})}Wr(e){return 0}ei(e,r){return Ye.or([()=>Ye.resolve(this.Jr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Hr(e,r)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e,r,n,s){this.targetId=e,this.fromCache=r,this.$i=n,this.Ui=s}static Wi(e,r){let n=Xt(),s=Xt();for(const i of r.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new hy(e,r.fromCache,n,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _O{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return BF()?8:tN(ts())>0?6:4}()}initialize(e,r){this.Ji=e,this.indexManager=r,this.Gi=!0}getDocumentsMatchingQuery(e,r,n,s){const i={result:null};return this.Yi(e,r).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,r,s,n).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new _O;return this.Xi(e,r,a).next(o=>{if(i.result=o,this.zi)return this.es(e,r,a,o.size)})}).next(()=>i.result)}es(e,r,n,s){return n.documentReadCount<this.ji?(au()<=Qt.DEBUG&&mt("QueryEngine","SDK will not create cache indexes for query:",Hl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Ye.resolve()):(au()<=Qt.DEBUG&&mt("QueryEngine","Query:",Hl(r),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Hi*s?(au()<=Qt.DEBUG&&mt("QueryEngine","The SDK decides to create cache indexes for query:",Hl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Oa(r))):Ye.resolve())}Yi(e,r){if(UE(r))return Ye.resolve(null);let n=Oa(r);return this.indexManager.getIndexType(e,n).next(s=>s===0?null:(r.limit!==null&&s===1&&(r=ch(r,null,"F"),n=Oa(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(i=>{const a=Xt(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(l=>{const c=this.ts(r,o);return this.ns(r,c,a,l.readTime)?this.Yi(e,ch(r,null,"F")):this.rs(e,c,r,l)}))})))}Zi(e,r,n,s){return UE(r)||s.isEqual(Ot.min())?Ye.resolve(null):this.Ji.getDocuments(e,n).next(i=>{const a=this.ts(r,i);return this.ns(r,a,n,s)?Ye.resolve(null):(au()<=Qt.DEBUG&&mt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Hl(r)),this.rs(e,a,r,Y5(s,-1)).next(o=>o))})}ts(e,r){let n=new Fn(hC(e));return r.forEach((s,i)=>{mp(e,i)&&(n=n.add(i))}),n}ns(e,r,n,s){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const i=e.limitType==="F"?r.last():r.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,r,n){return au()<=Qt.DEBUG&&mt("QueryEngine","Using full collection scan to execute query:",Hl(r)),this.Ji.getDocumentsMatchingQuery(e,r,fo.min(),n)}rs(e,r,n,s){return this.Ji.getDocumentsMatchingQuery(e,n,s).next(i=>(r.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e,r,n,s){this.persistence=e,this.ss=r,this.serializer=s,this.os=new Or(lr),this._s=new Uc(i=>sy(i),ay),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new dO(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.os))}}function AO(t,e,r,n){return new SO(t,e,r,n)}async function NC(t,e){const r=Lt(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let s;return r.mutationQueue.getAllMutationBatches(n).next(i=>(s=i,r.ls(e),r.mutationQueue.getAllMutationBatches(n))).next(i=>{const a=[],o=[];let l=Xt();for(const c of s){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return r.localDocuments.getDocuments(n,l).next(c=>({hs:c,removedBatchIds:a,addedBatchIds:o}))})})}function TO(t,e){const r=Lt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const s=e.batch.keys(),i=r.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,c,u){const f=c.batch,h=f.keys();let p=Ye.resolve();return h.forEach(g=>{p=p.next(()=>u.getEntry(l,g)).next(y=>{const E=c.docVersions.get(g);pr(E!==null),y.version.compareTo(E)<0&&(f.applyToRemoteDocument(y,c),y.isValidDocument()&&(y.setReadTime(c.commitVersion),u.addEntry(y)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(r,n,e,i).next(()=>i.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,s,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let l=Xt();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(l=l.add(o.batch.mutations[c].key));return l}(e))).next(()=>r.localDocuments.getDocuments(n,s))})}function OC(t){const e=Lt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.Ur.getLastRemoteSnapshotVersion(r))}function wO(t,e){const r=Lt(t),n=e.snapshotVersion;let s=r.os;return r.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=r.cs.newChangeBuffer({trackRemovals:!0});s=r.os;const o=[];e.targetChanges.forEach((u,f)=>{const h=s.get(f);if(!h)return;o.push(r.Ur.removeMatchingKeys(i,u.removedDocuments,f).next(()=>r.Ur.addMatchingKeys(i,u.addedDocuments,f)));let p=h.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?p=p.withResumeToken(_n.EMPTY_BYTE_STRING,Ot.min()).withLastLimboFreeSnapshotVersion(Ot.min()):u.resumeToken.approximateByteSize()>0&&(p=p.withResumeToken(u.resumeToken,n)),s=s.insert(f,p),function(y,E,b){return y.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(h,p,u)&&o.push(r.Ur.updateTargetData(i,p))});let l=wi(),c=Xt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&o.push(r.persistence.referenceDelegate.updateLimboDocument(i,u))}),o.push(CO(i,a,e.documentUpdates).next(u=>{l=u.Ps,c=u.Is})),!n.isEqual(Ot.min())){const u=r.Ur.getLastRemoteSnapshotVersion(i).next(f=>r.Ur.setTargetsMetadata(i,i.currentSequenceNumber,n));o.push(u)}return Ye.waitFor(o).next(()=>a.apply(i)).next(()=>r.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(r.os=s,i))}function CO(t,e,r){let n=Xt(),s=Xt();return r.forEach(i=>n=n.add(i)),e.getEntries(t,n).next(i=>{let a=wi();return r.forEach((o,l)=>{const c=i.get(o);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Ot.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):mt("LocalStore","Ignoring outdated watch update for ",o,". Current version:",c.version," Watch version:",l.version)}),{Ps:a,Is:s}})}function IO(t,e){const r=Lt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function kO(t,e){const r=Lt(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let s;return r.Ur.getTargetData(n,e).next(i=>i?(s=i,Ye.resolve(s)):r.Ur.allocateTargetId(n).next(a=>(s=new Qi(e,a,"TargetPurposeListen",n.currentSequenceNumber),r.Ur.addTargetData(n,s).next(()=>s))))}).then(n=>{const s=r.os.get(n.targetId);return(s===null||n.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(r.os=r.os.insert(n.targetId,n),r._s.set(e,n.targetId)),n})}async function wv(t,e,r){const n=Lt(t),s=n.os.get(e),i=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",i,a=>n.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!Qd(a))throw a;mt("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}n.os=n.os.remove(e),n._s.delete(s.target)}function YE(t,e,r){const n=Lt(t);let s=Ot.min(),i=Xt();return n.persistence.runTransaction("Execute query","readwrite",a=>function(l,c,u){const f=Lt(l),h=f._s.get(u);return h!==void 0?Ye.resolve(f.os.get(h)):f.Ur.getTargetData(c,u)}(n,a,Oa(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,n.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>n.ss.getDocumentsMatchingQuery(a,e,r?s:Ot.min(),r?i:Xt())).next(o=>(DO(n,xN(e),o),{documents:o,Ts:i})))}function DO(t,e,r){let n=t.us.get(e)||Ot.min();r.forEach((s,i)=>{i.readTime.compareTo(n)>0&&(n=i.readTime)}),t.us.set(e,n)}class QE{constructor(){this.activeTargetIds=TN()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class PO{constructor(){this.so=new QE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,r,n){this.oo[e]=r}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new QE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){mt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){mt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $f=null;function ym(){return $f===null?$f=function(){return 268435456+Math.round(2147483648*Math.random())}():$f++,"0x"+$f.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $n="WebChannelConnection";class OO extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;const n=r.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=n+"://"+r.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(r,n,s,i,a){const o=ym(),l=this.xo(r,n.toUriEncodedString());mt("RestConnection",`Sending RPC '${r}' ${o}:`,l,s);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,i,a),this.No(r,l,c,s).then(u=>(mt("RestConnection",`Received RPC '${r}' ${o}: `,u),u),u=>{throw rl("RestConnection",`RPC '${r}' ${o} failed with error: `,u,"url: ",l,"request:",s),u})}Lo(r,n,s,i,a,o){return this.Mo(r,n,s,i,a)}Oo(r,n,s){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Bc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((i,a)=>r[a]=i),s&&s.headers.forEach((i,a)=>r[a]=i)}xo(r,n){const s=FO[r];return`${this.Do}/v1/${n}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,r,n,s){const i=ym();return new Promise((a,o)=>{const l=new Yw;l.setWithCredentials(!0),l.listenOnce(Qw.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case S0.NO_ERROR:const u=l.getResponseJson();mt($n,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),a(u);break;case S0.TIMEOUT:mt($n,`RPC '${e}' ${i} timed out`),o(new nt(je.DEADLINE_EXCEEDED,"Request time out"));break;case S0.HTTP_ERROR:const f=l.getStatus();if(mt($n,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let h=l.getResponseJson();Array.isArray(h)&&(h=h[0]);const p=h==null?void 0:h.error;if(p&&p.status&&p.message){const g=function(E){const b=E.toLowerCase().replace(/_/g,"-");return Object.values(je).indexOf(b)>=0?b:je.UNKNOWN}(p.status);o(new nt(g,p.message))}else o(new nt(je.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new nt(je.UNAVAILABLE,"Connection failed."));break;default:Pt()}}finally{mt($n,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);mt($n,`RPC '${e}' ${i} sending request:`,s),l.send(r,"POST",c,n,15)})}Bo(e,r,n){const s=ym(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=eC(),o=Zw(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,r,n),l.encodeInitMessageHeaders=!0;const u=i.join("");mt($n,`Creating RPC '${e}' stream ${s}: ${u}`,l);const f=a.createWebChannel(u,l);let h=!1,p=!1;const g=new NO({Io:E=>{p?mt($n,`Not sending because RPC '${e}' stream ${s} is closed:`,E):(h||(mt($n,`Opening RPC '${e}' stream ${s} transport.`),f.open(),h=!0),mt($n,`RPC '${e}' stream ${s} sending:`,E),f.send(E))},To:()=>f.close()}),y=(E,b,_)=>{E.listen(b,v=>{try{_(v)}catch(A){setTimeout(()=>{throw A},0)}})};return y(f,yu.EventType.OPEN,()=>{p||(mt($n,`RPC '${e}' stream ${s} transport opened.`),g.yo())}),y(f,yu.EventType.CLOSE,()=>{p||(p=!0,mt($n,`RPC '${e}' stream ${s} transport closed`),g.So())}),y(f,yu.EventType.ERROR,E=>{p||(p=!0,rl($n,`RPC '${e}' stream ${s} transport errored:`,E),g.So(new nt(je.UNAVAILABLE,"The operation could not be completed")))}),y(f,yu.EventType.MESSAGE,E=>{var b;if(!p){const _=E.data[0];pr(!!_);const v=_,A=v.error||((b=v[0])===null||b===void 0?void 0:b.error);if(A){mt($n,`RPC '${e}' stream ${s} received error:`,A);const D=A.status;let k=function(m){const S=Jr[m];if(S!==void 0)return AC(S)}(D),T=A.message;k===void 0&&(k=je.INTERNAL,T="Unknown error status: "+D+" with message "+A.message),p=!0,g.So(new nt(k,T)),f.close()}else mt($n,`RPC '${e}' stream ${s} received:`,_),g.bo(_)}}),y(o,Jw.STAT_EVENT,E=>{E.stat===gv.PROXY?mt($n,`RPC '${e}' stream ${s} detected buffering proxy`):E.stat===gv.NOPROXY&&mt($n,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.wo()},0),g}}function xm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ep(t){return new WN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e,r,n=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=r,this.ko=n,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const r=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),s=Math.max(0,r-n);s>0&&mt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(e,r,n,s,i,a,o,l){this.ui=e,this.Ho=n,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new MC(e,r)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,r){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():r&&r.code===je.RESOURCE_EXHAUSTED?(Ti(r.toString()),Ti("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):r&&r.code===je.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(r)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),r=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,s])=>{this.Yo===r&&this.P_(n,s)},n=>{e(()=>{const s=new nt(je.UNKNOWN,"Fetching auth token failed: "+n.message);return this.I_(s)})})}P_(e,r){const n=this.h_(this.Yo);this.stream=this.T_(e,r),this.stream.Eo(()=>{n(()=>this.listener.Eo())}),this.stream.Ro(()=>{n(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{n(()=>this.I_(s))}),this.stream.onMessage(s=>{n(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return mt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return r=>{this.ui.enqueueAndForget(()=>this.Yo===e?r():(mt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class MO extends LC{constructor(e,r,n,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}T_(e,r){return this.connection.Bo("Listen",e,r)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const r=qN(this.serializer,e),n=function(i){if(!("targetChange"in i))return Ot.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Ot.min():a.readTime?Ma(a.readTime):Ot.min()}(e);return this.listener.d_(r,n)}A_(e){const r={};r.database=Tv(this.serializer),r.addTarget=function(i,a){let o;const l=a.target;if(o=Ev(l)?{documents:QN(i,l)}:{query:JN(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=CC(i,a.resumeToken);const c=bv(i,a.expectedCount);c!==null&&(o.expectedCount=c)}else if(a.snapshotVersion.compareTo(Ot.min())>0){o.readTime=dh(i,a.snapshotVersion.toTimestamp());const c=bv(i,a.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const n=eO(this.serializer,e);n&&(r.labels=n),this.a_(r)}R_(e){const r={};r.database=Tv(this.serializer),r.removeTarget=e,this.a_(r)}}class LO extends LC{constructor(e,r,n,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,r){return this.connection.Bo("Write",e,r)}E_(e){return pr(!!e.streamToken),this.lastStreamToken=e.streamToken,pr(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){pr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const r=YN(e.writeResults,e.commitTime),n=Ma(e.commitTime);return this.listener.g_(n,r)}p_(){const e={};e.database=Tv(this.serializer),this.a_(e)}m_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>XN(this.serializer,n))};this.a_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO extends class{}{constructor(e,r,n,s){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new nt(je.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,r,n,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,Sv(r,n),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new nt(je.UNKNOWN,i.toString())})}Lo(e,r,n,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,Sv(r,n),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===je.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new nt(je.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class UO{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ti(r),this.D_=!1):mt("OnlineStateTracker",r)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(e,r,n,s,i){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{n.enqueueAndForget(async()=>{vl(this)&&(mt("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=Lt(l);c.L_.add(4),await ef(c),c.q_.set("Unknown"),c.L_.delete(4),await _p(c)}(this))})}),this.q_=new UO(n,s)}}async function _p(t){if(vl(t))for(const e of t.B_)await e(!0)}async function ef(t){for(const e of t.B_)await e(!1)}function BC(t,e){const r=Lt(t);r.N_.has(e.targetId)||(r.N_.set(e.targetId,e),vy(r)?gy(r):$c(r).r_()&&my(r,e))}function py(t,e){const r=Lt(t),n=$c(r);r.N_.delete(e),n.r_()&&UC(r,e),r.N_.size===0&&(n.r_()?n.o_():vl(r)&&r.q_.set("Unknown"))}function my(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ot.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}$c(t).A_(e)}function UC(t,e){t.Q_.xe(e),$c(t).R_(e)}function gy(t){t.Q_=new VN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),$c(t).start(),t.q_.v_()}function vy(t){return vl(t)&&!$c(t).n_()&&t.N_.size>0}function vl(t){return Lt(t).L_.size===0}function $C(t){t.Q_=void 0}async function VO(t){t.q_.set("Online")}async function HO(t){t.N_.forEach((e,r)=>{my(t,e)})}async function jO(t,e){$C(t),vy(t)?(t.q_.M_(e),gy(t)):t.q_.set("Unknown")}async function GO(t,e,r){if(t.q_.set("Online"),e instanceof wC&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.N_.delete(o),s.Q_.removeTarget(o))}(t,e)}catch(n){mt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await fh(t,n)}else if(e instanceof w0?t.Q_.Ke(e):e instanceof TC?t.Q_.He(e):t.Q_.We(e),!r.isEqual(Ot.min()))try{const n=await OC(t.localStore);r.compareTo(n)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.N_.get(c);u&&i.N_.set(c,u.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,c)=>{const u=i.N_.get(l);if(!u)return;i.N_.set(l,u.withResumeToken(_n.EMPTY_BYTE_STRING,u.snapshotVersion)),UC(i,l);const f=new Qi(u.target,l,c,u.sequenceNumber);my(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(t,r)}catch(n){mt("RemoteStore","Failed to raise snapshot:",n),await fh(t,n)}}async function fh(t,e,r){if(!Qd(e))throw e;t.L_.add(1),await ef(t),t.q_.set("Offline"),r||(r=()=>OC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{mt("RemoteStore","Retrying IndexedDB access"),await r(),t.L_.delete(1),await _p(t)})}function VC(t,e){return e().catch(r=>fh(t,r,e))}async function bp(t){const e=Lt(t),r=po(e);let n=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;WO(e);)try{const s=await IO(e.localStore,n);if(s===null){e.O_.length===0&&r.o_();break}n=s.batchId,zO(e,s)}catch(s){await fh(e,s)}HC(e)&&jC(e)}function WO(t){return vl(t)&&t.O_.length<10}function zO(t,e){t.O_.push(e);const r=po(t);r.r_()&&r.V_&&r.m_(e.mutations)}function HC(t){return vl(t)&&!po(t).n_()&&t.O_.length>0}function jC(t){po(t).start()}async function KO(t){po(t).p_()}async function qO(t){const e=po(t);for(const r of t.O_)e.m_(r.mutations)}async function XO(t,e,r){const n=t.O_.shift(),s=ly.from(n,e,r);await VC(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await bp(t)}async function YO(t,e){e&&po(t).V_&&await async function(n,s){if(function(a){return BN(a)&&a!==je.ABORTED}(s.code)){const i=n.O_.shift();po(n).s_(),await VC(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await bp(n)}}(t,e),HC(t)&&jC(t)}async function ZE(t,e){const r=Lt(t);r.asyncQueue.verifyOperationInProgress(),mt("RemoteStore","RemoteStore received new credentials");const n=vl(r);r.L_.add(3),await ef(r),n&&r.q_.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.L_.delete(3),await _p(r)}async function QO(t,e){const r=Lt(t);e?(r.L_.delete(2),await _p(r)):e||(r.L_.add(2),await ef(r),r.q_.set("Unknown"))}function $c(t){return t.K_||(t.K_=function(r,n,s){const i=Lt(r);return i.w_(),new MO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:VO.bind(null,t),Ro:HO.bind(null,t),mo:jO.bind(null,t),d_:GO.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),vy(t)?gy(t):t.q_.set("Unknown")):(await t.K_.stop(),$C(t))})),t.K_}function po(t){return t.U_||(t.U_=function(r,n,s){const i=Lt(r);return i.w_(),new LO(n,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:KO.bind(null,t),mo:YO.bind(null,t),f_:qO.bind(null,t),g_:XO.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await bp(t)):(await t.U_.stop(),t.O_.length>0&&(mt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e,r,n,s,i){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=s,this.removalCallback=i,this.deferred=new fi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,s,i){const a=Date.now()+n,o=new yy(e,r,a,s,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new nt(je.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function xy(t,e){if(Ti("AsyncQueue",`${e}: ${t}`),Qd(t))return new nt(je.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e){this.comparator=e?(r,n)=>e(r,n)||xt.comparator(r.key,n.key):(r,n)=>xt.comparator(r.key,n.key),this.keyedMap=xu(),this.sortedSet=new Or(this.comparator)}static emptySet(e){return new uc(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof uc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const s=r.getNext().key,i=n.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new uc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e_{constructor(){this.W_=new Or(xt.comparator)}track(e){const r=e.doc.key,n=this.W_.get(r);n?e.type!==0&&n.type===3?this.W_=this.W_.insert(r,e):e.type===3&&n.type!==1?this.W_=this.W_.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.W_=this.W_.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.W_=this.W_.remove(r):e.type===1&&n.type===2?this.W_=this.W_.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.W_=this.W_.insert(r,{type:2,doc:e.doc}):Pt():this.W_=this.W_.insert(r,e)}G_(){const e=[];return this.W_.inorderTraversal((r,n)=>{e.push(n)}),e}}class Ic{constructor(e,r,n,s,i,a,o,l,c){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,r,n,s,i){const a=[];return r.forEach(o=>{a.push({type:0,doc:o})}),new Ic(e,r,uc.emptySet(r),a,n,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pp(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let s=0;s<r.length;s++)if(r[s].type!==n[s].type||!r[s].doc.isEqual(n[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class ZO{constructor(){this.queries=t_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(r,n){const s=Lt(r),i=s.queries;s.queries=t_(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(n)})})(this,new nt(je.ABORTED,"Firestore shutting down"))}}function t_(){return new Uc(t=>fC(t),pp)}async function Ey(t,e){const r=Lt(t);let n=3;const s=e.query;let i=r.queries.get(s);i?!i.H_()&&e.J_()&&(n=2):(i=new JO,n=e.J_()?0:1);try{switch(n){case 0:i.z_=await r.onListen(s,!0);break;case 1:i.z_=await r.onListen(s,!1);break;case 2:await r.onFirstRemoteStoreListen(s)}}catch(a){const o=xy(a,`Initialization of query '${Hl(e.query)}' failed`);return void e.onError(o)}r.queries.set(s,i),i.j_.push(e),e.Z_(r.onlineState),i.z_&&e.X_(i.z_)&&by(r)}async function _y(t,e){const r=Lt(t),n=e.query;let s=3;const i=r.queries.get(n);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function e9(t,e){const r=Lt(t);let n=!1;for(const s of e){const i=s.query,a=r.queries.get(i);if(a){for(const o of a.j_)o.X_(s)&&(n=!0);a.z_=s}}n&&by(r)}function t9(t,e,r){const n=Lt(t),s=n.queries.get(e);if(s)for(const i of s.j_)i.onError(r);n.queries.delete(e)}function by(t){t.Y_.forEach(e=>{e.next()})}var Cv,r_;(r_=Cv||(Cv={})).ea="default",r_.Cache="cache";class Sy{constructor(e,r,n){this.query=e,this.ta=r,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const n=[];for(const s of e.docChanges)s.type!==3&&n.push(s);e=new Ic(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.na?this.ia(e)&&(this.ta.next(e),r=!0):this.sa(e,this.onlineState)&&(this.oa(e),r=!0),this.ra=e,r}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let r=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),r=!0),r}sa(e,r){if(!e.fromCache||!this.J_())return!0;const n=r!=="Offline";return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const r=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}oa(e){e=Ic.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Cv.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e){this.key=e}}class WC{constructor(e){this.key=e}}class r9{constructor(e,r){this.query=e,this.Ta=r,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Xt(),this.mutatedKeys=Xt(),this.Aa=hC(e),this.Ra=new uc(this.Aa)}get Va(){return this.Ta}ma(e,r){const n=r?r.fa:new e_,s=r?r.Ra:this.Ra;let i=r?r.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,f)=>{const h=s.get(u),p=mp(this.query,f)?f:null,g=!!h&&this.mutatedKeys.has(h.key),y=!!p&&(p.hasLocalMutations||this.mutatedKeys.has(p.key)&&p.hasCommittedMutations);let E=!1;h&&p?h.data.isEqual(p.data)?g!==y&&(n.track({type:3,doc:p}),E=!0):this.ga(h,p)||(n.track({type:2,doc:p}),E=!0,(l&&this.Aa(p,l)>0||c&&this.Aa(p,c)<0)&&(o=!0)):!h&&p?(n.track({type:0,doc:p}),E=!0):h&&!p&&(n.track({type:1,doc:h}),E=!0,(l||c)&&(o=!0)),E&&(p?(a=a.add(p),i=y?i.add(u):i.delete(u)):(a=a.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const u=this.query.limitType==="F"?a.last():a.first();a=a.delete(u.key),i=i.delete(u.key),n.track({type:1,doc:u})}return{Ra:a,fa:n,ns:o,mutatedKeys:i}}ga(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((u,f)=>function(p,g){const y=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pt()}};return y(p)-y(g)}(u.type,f.type)||this.Aa(u.doc,f.doc)),this.pa(n),s=s!=null&&s;const o=r&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,c=l!==this.Ea;return this.Ea=l,a.length!==0||c?{snapshot:new Ic(this.query,e.Ra,i,a,e.mutatedKeys,l===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new e_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(r=>this.Ta=this.Ta.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ta=this.Ta.delete(r)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Xt(),this.Ra.forEach(n=>{this.Sa(n.key)&&(this.da=this.da.add(n.key))});const r=[];return e.forEach(n=>{this.da.has(n)||r.push(new WC(n))}),this.da.forEach(n=>{e.has(n)||r.push(new GC(n))}),r}ba(e){this.Ta=e.Ts,this.da=Xt();const r=this.ma(e.documents);return this.applyChanges(r,!0)}Da(){return Ic.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class n9{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class s9{constructor(e){this.key=e,this.va=!1}}class a9{constructor(e,r,n,s,i,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Uc(o=>fC(o),pp),this.Ma=new Map,this.xa=new Set,this.Oa=new Or(xt.comparator),this.Na=new Map,this.La=new dy,this.Ba={},this.ka=new Map,this.qa=Cc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function i9(t,e,r=!0){const n=QC(t);let s;const i=n.Fa.get(e);return i?(n.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await zC(n,e,r,!0),s}async function o9(t,e){const r=QC(t);await zC(r,e,!0,!1)}async function zC(t,e,r,n){const s=await kO(t.localStore,Oa(e)),i=s.targetId,a=t.sharedClientState.addLocalQueryTarget(i,r);let o;return n&&(o=await l9(t,e,i,a==="current",s.resumeToken)),t.isPrimaryClient&&r&&BC(t.remoteStore,s),o}async function l9(t,e,r,n,s){t.Ka=(f,h,p)=>async function(y,E,b,_){let v=E.view.ma(b);v.ns&&(v=await YE(y.localStore,E.query,!1).then(({documents:T})=>E.view.ma(T,v)));const A=_&&_.targetChanges.get(E.targetId),D=_&&_.targetMismatches.get(E.targetId)!=null,k=E.view.applyChanges(v,y.isPrimaryClient,A,D);return s_(y,E.targetId,k.wa),k.snapshot}(t,f,h,p);const i=await YE(t.localStore,e,!0),a=new r9(e,i.Ts),o=a.ma(i.documents),l=Zd.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",s),c=a.applyChanges(o,t.isPrimaryClient,l);s_(t,r,c.wa);const u=new n9(e,r,a);return t.Fa.set(e,u),t.Ma.has(r)?t.Ma.get(r).push(e):t.Ma.set(r,[e]),c.snapshot}async function c9(t,e,r){const n=Lt(t),s=n.Fa.get(e),i=n.Ma.get(s.targetId);if(i.length>1)return n.Ma.set(s.targetId,i.filter(a=>!pp(a,e))),void n.Fa.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await wv(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),r&&py(n.remoteStore,s.targetId),Iv(n,s.targetId)}).catch(Yd)):(Iv(n,s.targetId),await wv(n.localStore,s.targetId,!0))}async function u9(t,e){const r=Lt(t),n=r.Fa.get(e),s=r.Ma.get(n.targetId);r.isPrimaryClient&&s.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),py(r.remoteStore,n.targetId))}async function d9(t,e,r){const n=y9(t);try{const s=await function(a,o){const l=Lt(a),c=an.now(),u=o.reduce((p,g)=>p.add(g.key),Xt());let f,h;return l.persistence.runTransaction("Locally write mutations","readwrite",p=>{let g=wi(),y=Xt();return l.cs.getEntries(p,u).next(E=>{g=E,g.forEach((b,_)=>{_.isValidDocument()||(y=y.add(b))})}).next(()=>l.localDocuments.getOverlayedDocuments(p,g)).next(E=>{f=E;const b=[];for(const _ of o){const v=FN(_,f.get(_.key).overlayedDocument);v!=null&&b.push(new yo(_.key,v,aC(v.value.mapValue),fs.exists(!0)))}return l.mutationQueue.addMutationBatch(p,c,b,o)}).next(E=>{h=E;const b=E.applyToLocalDocumentSet(f,y);return l.documentOverlayCache.saveOverlays(p,E.batchId,b)})}).then(()=>({batchId:h.batchId,changes:mC(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let c=a.Ba[a.currentUser.toKey()];c||(c=new Or(lr)),c=c.insert(o,l),a.Ba[a.currentUser.toKey()]=c}(n,s.batchId,r),await tf(n,s.changes),await bp(n.remoteStore)}catch(s){const i=xy(s,"Failed to persist write");r.reject(i)}}async function KC(t,e){const r=Lt(t);try{const n=await wO(r.localStore,e);e.targetChanges.forEach((s,i)=>{const a=r.Na.get(i);a&&(pr(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?pr(a.va):s.removedDocuments.size>0&&(pr(a.va),a.va=!1))}),await tf(r,n,e)}catch(n){await Yd(n)}}function n_(t,e,r){const n=Lt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const s=[];n.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Lt(a);l.onlineState=o;let c=!1;l.queries.forEach((u,f)=>{for(const h of f.j_)h.Z_(o)&&(c=!0)}),c&&by(l)}(n.eventManager,e),s.length&&n.Ca.d_(s),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function f9(t,e,r){const n=Lt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const s=n.Na.get(e),i=s&&s.key;if(i){let a=new Or(xt.comparator);a=a.insert(i,Kn.newNoDocument(i,Ot.min()));const o=Xt().add(i),l=new xp(Ot.min(),new Map,new Or(lr),a,o);await KC(n,l),n.Oa=n.Oa.remove(i),n.Na.delete(e),Ay(n)}else await wv(n.localStore,e,!1).then(()=>Iv(n,e,r)).catch(Yd)}async function h9(t,e){const r=Lt(t),n=e.batch.batchId;try{const s=await TO(r.localStore,e);XC(r,n,null),qC(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await tf(r,s)}catch(s){await Yd(s)}}async function p9(t,e,r){const n=Lt(t);try{const s=await function(a,o){const l=Lt(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,o).next(f=>(pr(f!==null),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(n.localStore,e);XC(n,e,r),qC(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await tf(n,s)}catch(s){await Yd(s)}}function qC(t,e){(t.ka.get(e)||[]).forEach(r=>{r.resolve()}),t.ka.delete(e)}function XC(t,e,r){const n=Lt(t);let s=n.Ba[n.currentUser.toKey()];if(s){const i=s.get(e);i&&(r?i.reject(r):i.resolve(),s=s.remove(e)),n.Ba[n.currentUser.toKey()]=s}}function Iv(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Ma.get(e))t.Fa.delete(n),r&&t.Ca.$a(n,r);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(n=>{t.La.containsKey(n)||YC(t,n)})}function YC(t,e){t.xa.delete(e.path.canonicalString());const r=t.Oa.get(e);r!==null&&(py(t.remoteStore,r),t.Oa=t.Oa.remove(e),t.Na.delete(r),Ay(t))}function s_(t,e,r){for(const n of r)n instanceof GC?(t.La.addReference(n.key,e),m9(t,n)):n instanceof WC?(mt("SyncEngine","Document no longer in limbo: "+n.key),t.La.removeReference(n.key,e),t.La.containsKey(n.key)||YC(t,n.key)):Pt()}function m9(t,e){const r=e.key,n=r.path.canonicalString();t.Oa.get(r)||t.xa.has(n)||(mt("SyncEngine","New document in limbo: "+r),t.xa.add(n),Ay(t))}function Ay(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const r=new xt(Sr.fromString(e)),n=t.qa.next();t.Na.set(n,new s9(r)),t.Oa=t.Oa.insert(r,n),BC(t.remoteStore,new Qi(Oa(hp(r.path)),n,"TargetPurposeLimboResolution",ty.oe))}}async function tf(t,e,r){const n=Lt(t),s=[],i=[],a=[];n.Fa.isEmpty()||(n.Fa.forEach((o,l)=>{a.push(n.Ka(l,e,r).then(c=>{var u;if((c||r)&&n.isPrimaryClient){const f=c?!c.fromCache:(u=r==null?void 0:r.targetChanges.get(l.targetId))===null||u===void 0?void 0:u.current;n.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(c){s.push(c);const f=hy.Wi(l.targetId,c);i.push(f)}}))}),await Promise.all(a),n.Ca.d_(s),await async function(l,c){const u=Lt(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Ye.forEach(c,h=>Ye.forEach(h.$i,p=>u.persistence.referenceDelegate.addReference(f,h.targetId,p)).next(()=>Ye.forEach(h.Ui,p=>u.persistence.referenceDelegate.removeReference(f,h.targetId,p)))))}catch(f){if(!Qd(f))throw f;mt("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const h=f.targetId;if(!f.fromCache){const p=u.os.get(h),g=p.snapshotVersion,y=p.withLastLimboFreeSnapshotVersion(g);u.os=u.os.insert(h,y)}}}(n.localStore,i))}async function g9(t,e){const r=Lt(t);if(!r.currentUser.isEqual(e)){mt("SyncEngine","User change. New user:",e.toKey());const n=await NC(r.localStore,e);r.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new nt(je.CANCELLED,a))})}),i.ka.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await tf(r,n.hs)}}function v9(t,e){const r=Lt(t),n=r.Na.get(e);if(n&&n.va)return Xt().add(n.key);{let s=Xt();const i=r.Ma.get(e);if(!i)return s;for(const a of i){const o=r.Fa.get(a);s=s.unionWith(o.view.Va)}return s}}function QC(t){const e=Lt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=KC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=v9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=f9.bind(null,e),e.Ca.d_=e9.bind(null,e.eventManager),e.Ca.$a=t9.bind(null,e.eventManager),e}function y9(t){const e=Lt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=h9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=p9.bind(null,e),e}class hh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ep(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,r){return null}Ha(e,r){return null}za(e){return AO(this.persistence,new bO,e.initialUser,this.serializer)}Ga(e){return new xO(fy.Zr,this.serializer)}Wa(e){return new PO}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}hh.provider={build:()=>new hh};class kv{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>n_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=g9.bind(null,this.syncEngine),await QO(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ZO}()}createDatastore(e){const r=Ep(e.databaseInfo.databaseId),n=function(i){return new OO(i)}(e.databaseInfo);return function(i,a,o,l){return new BO(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,s,i,a,o){return new $O(n,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>n_(this.syncEngine,r,0),function(){return JE.D()?new JE:new RO}())}createSyncEngine(e,r){return function(s,i,a,o,l,c,u){const f=new a9(s,i,a,o,l,c);return u&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(s){const i=Lt(s);mt("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await ef(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}kv.provider={build:()=>new kv};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ti("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,r,n,s,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=s,this.user=Gn.UNAUTHENTICATED,this.clientId=ey.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async a=>{mt("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(n,a=>(mt("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=xy(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Em(t,e){t.asyncQueue.verifyOperationInProgress(),mt("FirestoreClient","Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async s=>{n.isEqual(s)||(await NC(e.localStore,s),n=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function a_(t,e){t.asyncQueue.verifyOperationInProgress();const r=await E9(t);mt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>ZE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,s)=>ZE(e.remoteStore,s)),t._onlineComponents=e}async function E9(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){mt("FirestoreClient","Using user provided OfflineComponentProvider");try{await Em(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(s){return s.name==="FirebaseError"?s.code===je.FAILED_PRECONDITION||s.code===je.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(r))throw r;rl("Error using user provided cache. Falling back to memory cache: "+r),await Em(t,new hh)}}else mt("FirestoreClient","Using default OfflineComponentProvider"),await Em(t,new hh);return t._offlineComponents}async function JC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(mt("FirestoreClient","Using user provided OnlineComponentProvider"),await a_(t,t._uninitializedComponentsProvider._online)):(mt("FirestoreClient","Using default OnlineComponentProvider"),await a_(t,new kv))),t._onlineComponents}function _9(t){return JC(t).then(e=>e.syncEngine)}async function ph(t){const e=await JC(t),r=e.eventManager;return r.onListen=i9.bind(null,e.syncEngine),r.onUnlisten=c9.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=o9.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=u9.bind(null,e.syncEngine),r}function b9(t,e,r={}){const n=new fi;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new Ty({next:h=>{u.Za(),a.enqueueAndForget(()=>_y(i,f));const p=h.docs.has(o);!p&&h.fromCache?c.reject(new nt(je.UNAVAILABLE,"Failed to get document because the client is offline.")):p&&h.fromCache&&l&&l.source==="server"?c.reject(new nt(je.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new Sy(hp(o.path),u,{includeMetadataChanges:!0,_a:!0});return Ey(i,f)}(await ph(t),t.asyncQueue,e,r,n)),n.promise}function S9(t,e,r={}){const n=new fi;return t.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,c){const u=new Ty({next:h=>{u.Za(),a.enqueueAndForget(()=>_y(i,f)),h.fromCache&&l.source==="server"?c.reject(new nt(je.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),f=new Sy(o,u,{includeMetadataChanges:!0,_a:!0});return Ey(i,f)}(await ph(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e4(t,e,r){if(!r)throw new nt(je.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function t4(t,e,r,n){if(e===!0&&n===!0)throw new nt(je.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function o_(t){if(!xt.isDocumentKey(t))throw new nt(je.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function l_(t){if(xt.isDocumentKey(t))throw new nt(je.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Sp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Pt()}function Zn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new nt(je.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Sp(t);throw new nt(je.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}function A9(t,e){if(e<=0)throw new nt(je.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new nt(je.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new nt(je.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}t4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new nt(je.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,s){return n.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ap{constructor(e,r,n,s){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new nt(je.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new nt(je.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c_(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new rC;switch(n.type){case"firstParty":return new W5(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new nt(je.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=i_.get(r);n&&(mt("ComponentProvider","Removing Datastore"),i_.delete(r),n.terminate())}(this),Promise.resolve()}}function r4(t,e,r,n={}){var s;const i=(t=Zn(t,Ap))._getSettings(),a=`${e}:${r}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&rl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),n.mockUserToken){let o,l;if(typeof n.mockUserToken=="string")o=n.mockUserToken,l=Gn.MOCK_USER;else{o=aw(n.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const c=n.mockUserToken.sub||n.mockUserToken.user_id;if(!c)throw new nt(je.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Gn(c)}t._authCredentials=new H5(new tC(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new _a(this.firestore,e,this._query)}}class Nn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hi(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Nn(this.firestore,e,this._key)}}class hi extends _a{constructor(e,r,n){super(e,r,hp(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Nn(this.firestore,null,new xt(e))}withConverter(e){return new hi(this.firestore,e,this._path)}}function At(t,e,...r){if(t=dr(t),e4("collection","path",e),t instanceof Ap){const n=Sr.fromString(e,...r);return l_(n),new hi(t,null,n)}{if(!(t instanceof Nn||t instanceof hi))throw new nt(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Sr.fromString(e,...r));return l_(n),new hi(t.firestore,null,n)}}function Ze(t,e,...r){if(t=dr(t),arguments.length===1&&(e=ey.newId()),e4("doc","path",e),t instanceof Ap){const n=Sr.fromString(e,...r);return o_(n),new Nn(t,null,new xt(n))}{if(!(t instanceof Nn||t instanceof hi))throw new nt(je.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Sr.fromString(e,...r));return o_(n),new Nn(t.firestore,t instanceof hi?t.converter:null,new xt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new MC(this,"async_queue_retry"),this.Vu=()=>{const n=xm();n&&mt("AsyncQueue","Visibility state changed to "+n.visibilityState),this.t_.jo()},this.mu=e;const r=xm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const r=xm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const r=new fi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Qd(e))throw e;mt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const r=this.mu.then(()=>(this.du=!0,e().catch(n=>{this.Eu=n,this.du=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Ti("INTERNAL UNHANDLED ERROR: ",s),n}).then(n=>(this.du=!1,n))));return this.mu=r,r}enqueueAfterDelay(e,r,n){this.fu(),this.Ru.indexOf(e)>-1&&(r=0);const s=yy.createAndSchedule(this,e,r,n,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Pt()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const r of this.Tu)if(r.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.Tu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const r=this.Tu.indexOf(e);this.Tu.splice(r,1)}}function d_(t){return function(r,n){if(typeof r!="object"||r===null)return!1;const s=r;for(const i of n)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class ya extends Ap{constructor(e,r,n,s){super(e,r,n,s),this.type="firestore",this._queue=new u_,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new u_(e),this._firestoreClient=void 0,await e}}}function xo(t,e){const r=typeof t=="object"?t:zd(),n=typeof t=="string"?t:"(default)",s=Wd(r,"firestore").getImmediate({identifier:n});if(!s._initialized){const i=N1("firestore");i&&r4(s,...i)}return s}function Vc(t){if(t._terminated)throw new nt(je.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||T9(t),t._firestoreClient}function T9(t){var e,r,n;const s=t._freezeSettings(),i=function(o,l,c,u){return new sN(o,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,ZC(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((r=s.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=s.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new x9(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this._byteString=e}static fromBase64String(e){try{return new al(_n.fromBase64String(e))}catch(r){throw new nt(je.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new al(_n.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hc{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new nt(je.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new nt(je.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new nt(je.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return lr(this._lat,e._lat)||lr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,s){if(n.length!==s.length)return!1;for(let i=0;i<n.length;++i)if(n[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w9=/^__.*__$/;class C9{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new yo(e,this.data,this.fieldMask,r,this.fieldTransforms):new Jd(e,this.data,r,this.fieldTransforms)}}class n4{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new yo(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function s4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pt()}}class wy{constructor(e,r,n,s,i,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new wy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.Ou(e),s}Nu(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),s=this.Fu({path:n,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return mh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(s4(this.Cu)&&w9.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class I9{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||Ep(e)}Qu(e,r,n,s=!1){return new wy({Cu:e,methodName:r,qu:n,path:xn.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jc(t){const e=t._freezeSettings(),r=Ep(t._databaseId);return new I9(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Cy(t,e,r,n,s,i={}){const a=t.Qu(i.merge||i.mergeFields?2:0,e,r,s);ky("Data must be an object, but it was:",a,n);const o=l4(n,a);let l,c;if(i.merge)l=new Ps(a.fieldMask),c=a.fieldTransforms;else if(i.mergeFields){const u=[];for(const f of i.mergeFields){const h=Dv(e,f,r);if(!a.contains(h))throw new nt(je.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);u4(u,h)||u.push(h)}l=new Ps(u),c=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=a.fieldTransforms;return new C9(new bs(o),l,c)}class Cp extends rf{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cp}}class Iy extends rf{_toFieldTransform(e){return new kN(e.path,new bd)}isEqual(e){return e instanceof Iy}}function a4(t,e,r,n){const s=t.Qu(1,e,r);ky("Data must be an object, but it was:",s,n);const i=[],a=bs.empty();ml(n,(l,c)=>{const u=Dy(e,l,r);c=dr(c);const f=s.Nu(u);if(c instanceof Cp)i.push(u);else{const h=nf(c,f);h!=null&&(i.push(u),a.set(u,h))}});const o=new Ps(i);return new n4(a,o,s.fieldTransforms)}function i4(t,e,r,n,s,i){const a=t.Qu(1,e,r),o=[Dv(e,n,r)],l=[s];if(i.length%2!=0)throw new nt(je.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<i.length;h+=2)o.push(Dv(e,i[h])),l.push(i[h+1]);const c=[],u=bs.empty();for(let h=o.length-1;h>=0;--h)if(!u4(c,o[h])){const p=o[h];let g=l[h];g=dr(g);const y=a.Nu(p);if(g instanceof Cp)c.push(p);else{const E=nf(g,y);E!=null&&(c.push(p),u.set(p,E))}}const f=new Ps(c);return new n4(u,f,a.fieldTransforms)}function o4(t,e,r,n=!1){return nf(r,t.Qu(n?4:3,e))}function nf(t,e){if(c4(t=dr(t)))return ky("Unsupported field value:",e,t),l4(t,e);if(t instanceof rf)return function(n,s){if(!s4(s.Cu))throw s.Bu(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${n._methodName}() is not currently supported inside arrays`);const i=n._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(n,s){const i=[];let a=0;for(const o of n){let l=nf(o,s.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(t,e)}return function(n,s){if((n=dr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return wN(s.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const i=an.fromDate(n);return{timestampValue:dh(s.serializer,i)}}if(n instanceof an){const i=new an(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:dh(s.serializer,i)}}if(n instanceof Tp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof al)return{bytesValue:CC(s.serializer,n._byteString)};if(n instanceof Nn){const i=s.databaseId,a=n.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:uy(n.firestore._databaseId||s.databaseId,n._key.path)}}if(n instanceof wp)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return oy(o.serializer,l)})}}}}}}(n,s);throw s.Bu(`Unsupported field value: ${Sp(n)}`)}(t,e)}function l4(t,e){const r={};return nC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ml(t,(n,s)=>{const i=nf(s,e.Mu(n));i!=null&&(r[n]=i)}),{mapValue:{fields:r}}}function c4(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof an||t instanceof Tp||t instanceof al||t instanceof Nn||t instanceof rf||t instanceof wp)}function ky(t,e,r){if(!c4(r)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(r)){const n=Sp(r);throw n==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+n)}}function Dv(t,e,r){if((e=dr(e))instanceof Hc)return e._internalPath;if(typeof e=="string")return Dy(t,e);throw mh("Field path arguments must be of type string or ",t,!1,void 0,r)}const k9=new RegExp("[~\\*/\\[\\]]");function Dy(t,e,r){if(e.search(k9)>=0)throw mh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Hc(...e.split("."))._internalPath}catch{throw mh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function mh(t,e,r,n,s){const i=n&&!n.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${n}`),a&&(l+=` in document ${s}`),l+=")"),new nt(je.INVALID_ARGUMENT,o+t+l)}function u4(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e,r,n,s,i){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Nn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new D9(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Ip("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class D9 extends Py{data(){return super.data()}}function Ip(t,e){return typeof e=="string"?Dy(t,e):e instanceof Hc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new nt(je.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ry{}class sf extends Ry{}function cr(t,e,...r){let n=[];e instanceof Ry&&n.push(e),n=n.concat(r),function(i){const a=i.filter(l=>l instanceof kp).length,o=i.filter(l=>l instanceof af).length;if(a>1||a>0&&o>0)throw new nt(je.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const s of n)t=s._apply(t);return t}class af extends sf{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new af(e,r,n)}_apply(e){const r=this._parse(e);return f4(e._query,r),new _a(e.firestore,e.converter,_v(e._query,r))}_parse(e){const r=jc(e.firestore);return function(i,a,o,l,c,u,f){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new nt(je.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){h_(f,u);const p=[];for(const g of f)p.push(f_(l,i,g));h={arrayValue:{values:p}}}else h=f_(l,i,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||h_(f,u),h=o4(o,a,f,u==="in"||u==="not-in");return nn.create(c,u,h)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ur(t,e,r){const n=e,s=Ip("where",t);return af._create(s,n,r)}class kp extends Ry{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new kp(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:va.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)f4(a,l),a=_v(a,l)}(e._query,r),new _a(e.firestore,e.converter,_v(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Dp extends sf{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new Dp(e,r)}_apply(e){const r=function(s,i,a){if(s.startAt!==null)throw new nt(je.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new nt(je.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new _d(i,a)}(e._query,this._field,this._direction);return new _a(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new gl(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,r))}}function vn(t,e="asc"){const r=e,n=Ip("orderBy",t);return Dp._create(n,r)}class Pp extends sf{constructor(e,r,n){super(),this.type=e,this._limit=r,this._limitType=n}static _create(e,r,n){return new Pp(e,r,n)}_apply(e){return new _a(e.firestore,e.converter,ch(e._query,this._limit,this._limitType))}}function la(t){return A9("limit",t),Pp._create("limit",t,"F")}class Rp extends sf{constructor(e,r,n){super(),this.type=e,this._docOrFields=r,this._inclusive=n}static _create(e,r,n){return new Rp(e,r,n)}_apply(e){const r=P9(e,this.type,this._docOrFields,this._inclusive);return new _a(e.firestore,e.converter,function(s,i){return new gl(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,i,s.endAt)}(e._query,r))}}function gh(...t){return Rp._create("startAfter",t,!1)}function P9(t,e,r,n){if(r[0]=dr(r[0]),r[0]instanceof Py)return function(i,a,o,l,c){if(!l)throw new nt(je.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const f of cc(i))if(f.field.isKeyField())u.push(lh(a,l.key));else{const h=l.data.field(f.field);if(fp(h))throw new nt(je.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+f.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const p=f.field.canonicalString();throw new nt(je.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${p}' (used as the orderBy) does not exist.`)}u.push(h)}return new wc(u,c)}(t._query,t.firestore._databaseId,e,r[0]._document,n);{const s=jc(t.firestore);return function(a,o,l,c,u,f){const h=a.explicitOrderBy;if(u.length>h.length)throw new nt(je.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const p=[];for(let g=0;g<u.length;g++){const y=u[g];if(h[g].field.isKeyField()){if(typeof y!="string")throw new nt(je.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof y}`);if(!iy(a)&&y.indexOf("/")!==-1)throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${y}' contains a slash.`);const E=a.path.child(Sr.fromString(y));if(!xt.isDocumentKey(E))throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${E}' is not because it contains an odd number of segments.`);const b=new xt(E);p.push(lh(o,b))}else{const E=o4(l,c,y);p.push(E)}}return new wc(p,f)}(t._query,t.firestore._databaseId,s,e,r,n)}}function f_(t,e,r){if(typeof(r=dr(r))=="string"){if(r==="")throw new nt(je.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!iy(e)&&r.indexOf("/")!==-1)throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Sr.fromString(r));if(!xt.isDocumentKey(n))throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return lh(t,new xt(n))}if(r instanceof Nn)return lh(t,r._key);throw new nt(je.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Sp(r)}.`)}function h_(t,e){if(!Array.isArray(t)||t.length===0)throw new nt(je.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function f4(t,e){const r=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new nt(je.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new nt(je.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class h4{convertValue(e,r="none"){switch(sl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Kr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(nl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw Pt()}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return ml(e,(s,i)=>{n[s]=this.convertValue(i,r)}),n}convertVectorValue(e){var r,n,s;const i=(s=(n=(r=e.fields)===null||r===void 0?void 0:r.value.arrayValue)===null||n===void 0?void 0:n.values)===null||s===void 0?void 0:s.map(a=>Kr(a.doubleValue));return new wp(i)}convertGeoPoint(e){return new Tp(Kr(e.latitude),Kr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ry(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(xd(e));default:return null}}convertTimestamp(e){const r=ho(e);return new an(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Sr.fromString(e);pr(FC(n));const s=new Sc(n.get(1),n.get(3)),i=new xt(n.popFirst(5));return s.isEqual(r)||Ti(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fy(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ny extends Py{constructor(e,r,n,s,i,a){super(e,r,n,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new ju(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Ip("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}}class ju extends Ny{data(e={}){return super.data(e)}}class Oy{constructor(e,r,n,s){this._firestore=e,this._userDataWriter=r,this._snapshot=s,this.metadata=new Yl(s.hasPendingWrites,s.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new ju(this._firestore,this._userDataWriter,n.key,n,new Yl(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new nt(je.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new ju(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Yl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new ju(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Yl(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return o.type!==0&&(c=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),u=a.indexOf(o.doc.key)),{type:R9(o.type),doc:l,oldIndex:c,newIndex:u}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function R9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pt()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qt(t){t=Zn(t,Nn);const e=Zn(t.firestore,ya);return b9(Vc(e),t._key).then(r=>m4(e,t,r))}class My extends h4{constructor(e){super(),this.firestore=e}convertBytes(e){return new al(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Nn(this.firestore,null,r)}}function zt(t){t=Zn(t,_a);const e=Zn(t.firestore,ya),r=Vc(e),n=new My(e);return d4(t._query),S9(r,t._query).then(s=>new Oy(e,n,t,s))}function jt(t,e,r){t=Zn(t,Nn);const n=Zn(t.firestore,ya),s=Fy(t.converter,e,r);return Gc(n,[Cy(jc(n),"setDoc",t._key,s,t.converter!==null,r).toMutation(t._key,fs.none())])}function Fp(t,e,r,...n){t=Zn(t,Nn);const s=Zn(t.firestore,ya),i=jc(s);let a;return a=typeof(e=dr(e))=="string"||e instanceof Hc?i4(i,"updateDoc",t._key,e,r,n):a4(i,"updateDoc",t._key,e),Gc(s,[a.toMutation(t._key,fs.exists(!0))])}function mo(t){return Gc(Zn(t.firestore,ya),[new yp(t._key,fs.none())])}function p4(t,e){const r=Zn(t.firestore,ya),n=Ze(t),s=Fy(t.converter,e);return Gc(r,[Cy(jc(t.firestore),"addDoc",n._key,s,t.converter!==null,{}).toMutation(n._key,fs.exists(!1))]).then(()=>n)}function Np(t,...e){var r,n,s;t=dr(t);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||d_(e[a])||(i=e[a],a++);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(d_(e[a])){const f=e[a];e[a]=(r=f.next)===null||r===void 0?void 0:r.bind(f),e[a+1]=(n=f.error)===null||n===void 0?void 0:n.bind(f),e[a+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,c,u;if(t instanceof Nn)c=Zn(t.firestore,ya),u=hp(t._key.path),l={next:f=>{e[a]&&e[a](m4(c,t,f))},error:e[a+1],complete:e[a+2]};else{const f=Zn(t,_a);c=Zn(f.firestore,ya),u=f._query;const h=new My(c);l={next:p=>{e[a]&&e[a](new Oy(c,h,f,p))},error:e[a+1],complete:e[a+2]},d4(t._query)}return function(h,p,g,y){const E=new Ty(y),b=new Sy(p,E,g);return h.asyncQueue.enqueueAndForget(async()=>Ey(await ph(h),b)),()=>{E.Za(),h.asyncQueue.enqueueAndForget(async()=>_y(await ph(h),b))}}(Vc(c),u,o,l)}function Gc(t,e){return function(n,s){const i=new fi;return n.asyncQueue.enqueueAndForget(async()=>d9(await _9(n),s,i)),i.promise}(Vc(t),e)}function m4(t,e,r){const n=r.docs.get(e._key),s=new My(t);return new Ny(t,s,e._key,n,new Yl(r.hasPendingWrites,r.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e,r){this._firestore=e,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=jc(e)}set(e,r,n){this._verifyNotCommitted();const s=_m(e,this._firestore),i=Fy(s.converter,r,n),a=Cy(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,n);return this._mutations.push(a.toMutation(s._key,fs.none())),this}update(e,r,n,...s){this._verifyNotCommitted();const i=_m(e,this._firestore);let a;return a=typeof(r=dr(r))=="string"||r instanceof Hc?i4(this._dataReader,"WriteBatch.update",i._key,r,n,s):a4(this._dataReader,"WriteBatch.update",i._key,r),this._mutations.push(a.toMutation(i._key,fs.exists(!0))),this}delete(e){this._verifyNotCommitted();const r=_m(e,this._firestore);return this._mutations=this._mutations.concat(new yp(r._key,fs.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new nt(je.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function _m(t,e){if((t=dr(t)).firestore!==e)throw new nt(je.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Dn(){return new Iy("serverTimestamp")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ly(t){return Vc(t=Zn(t,ya)),new g4(t,e=>Gc(t,e))}(function(e,r=!0){(function(s){Bc=s})(pl),lo(new bi("firestore",(n,{instanceIdentifier:s,options:i})=>{const a=n.getProvider("app").getImmediate(),o=new ya(new j5(n.getProvider("auth-internal")),new K5(n.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new nt(je.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Sc(c.options.projectId,u)}(a,s),a);return i=Object.assign({useFetchStreams:r},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Ws(kE,"4.7.3",e),Ws(kE,"4.7.3","esm2017")})();const F9=Object.freeze(Object.defineProperty({__proto__:null,AbstractUserDataWriter:h4,Bytes:al,CollectionReference:hi,DocumentReference:Nn,DocumentSnapshot:Ny,FieldPath:Hc,FieldValue:rf,Firestore:ya,FirestoreError:nt,GeoPoint:Tp,Query:_a,QueryCompositeFilterConstraint:kp,QueryConstraint:sf,QueryDocumentSnapshot:ju,QueryFieldFilterConstraint:af,QueryLimitConstraint:Pp,QueryOrderByConstraint:Dp,QuerySnapshot:Oy,QueryStartAtConstraint:Rp,SnapshotMetadata:Yl,Timestamp:an,VectorValue:wp,WriteBatch:g4,_AutoId:ey,_ByteString:_n,_DatabaseId:Sc,_DocumentKey:xt,_EmptyAuthCredentialsProvider:rC,_FieldPath:xn,_cast:Zn,_logWarn:rl,_validateIsNotUsedTogether:t4,addDoc:p4,collection:At,connectFirestoreEmulator:r4,deleteDoc:mo,doc:Ze,ensureFirestoreConfigured:Vc,executeWrite:Gc,getDoc:qt,getDocs:zt,getFirestore:xo,limit:la,onSnapshot:Np,orderBy:vn,query:cr,serverTimestamp:Dn,setDoc:jt,startAfter:gh,updateDoc:Fp,where:Ur,writeBatch:Ly},Symbol.toStringTag,{value:"Module"}));var N9="firebase",O9="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ws(N9,O9,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v4="firebasestorage.googleapis.com",y4="storageBucket",M9=2*60*1e3,L9=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends Ea{constructor(e,r,n=0){super(bm(e),`Firebase Storage: ${r} (${bm(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Wr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return bm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var jr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(jr||(jr={}));function bm(t){return"storage/"+t}function By(){const t="An unknown error occurred, please check the error payload for server response.";return new Wr(jr.UNKNOWN,t)}function B9(t){return new Wr(jr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function U9(t){return new Wr(jr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $9(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Wr(jr.UNAUTHENTICATED,t)}function V9(){return new Wr(jr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function H9(t){return new Wr(jr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function j9(){return new Wr(jr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function G9(){return new Wr(jr.CANCELED,"User canceled the upload/download.")}function W9(t){return new Wr(jr.INVALID_URL,"Invalid URL '"+t+"'.")}function z9(t){return new Wr(jr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function K9(){return new Wr(jr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+y4+"' property when initializing the app?")}function q9(){return new Wr(jr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function X9(t){return new Wr(jr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function vh(t){return new Wr(jr.INVALID_ARGUMENT,t)}function x4(){return new Wr(jr.APP_DELETED,"The Firebase app was deleted.")}function E4(t){return new Wr(jr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Gu(t,e){return new Wr(jr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function iu(t){throw new Wr(jr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let n;try{n=Qn.makeFromUrl(e,r)}catch{return new Qn(e,"")}if(n.path==="")return n;throw z9(e)}static makeFromUrl(e,r){let n=null;const s="([A-Za-z0-9.\\-_]+)";function i(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function c(A){A.path_=decodeURIComponent(A.path)}const u="v[A-Za-z0-9_]+",f=r.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${u}/b/${s}/o${h}`,"i"),g={bucket:1,path:3},y=r===v4?"(?:storage.googleapis.com|storage.cloud.google.com)":r,E="([^?#]*)",b=new RegExp(`^https?://${y}/${s}/${E}`,"i"),v=[{regex:o,indices:l,postModify:i},{regex:p,indices:g,postModify:c},{regex:b,indices:{bucket:1,path:2},postModify:c}];for(let A=0;A<v.length;A++){const D=v[A],k=D.regex.exec(e);if(k){const T=k[D.indices.bucket];let x=k[D.indices.path];x||(x=""),n=new Qn(T,x),D.postModify(n);break}}if(n==null)throw W9(e);return n}}class Y9{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q9(t,e,r){let n=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let c=!1;function u(...E){c||(c=!0,e.apply(null,E))}function f(E){s=setTimeout(()=>{s=null,t(p,l())},E)}function h(){i&&clearTimeout(i)}function p(E,...b){if(c){h();return}if(E){h(),u.call(null,E,...b);return}if(l()||a){h(),u.call(null,E,...b);return}n<64&&(n*=2);let v;o===1?(o=2,v=0):v=(n+Math.random())*1e3,f(v)}let g=!1;function y(E){g||(g=!0,h(),!c&&(s!==null?(E||(o=2),clearTimeout(s),f(0)):E||(o=1)))}return f(0),i=setTimeout(()=>{a=!0,y(!0)},r),y}function J9(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z9(t){return t!==void 0}function eM(t){return typeof t=="object"&&!Array.isArray(t)}function _4(t){return typeof t=="string"||t instanceof String}function p_(t){return Uy()&&t instanceof Blob}function Uy(){return typeof Blob<"u"}function Pv(t,e,r,n){if(n<e)throw vh(`Invalid value for '${t}'. Expected ${e} or greater.`);if(n>r)throw vh(`Invalid value for '${t}'. Expected ${r} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $y(t,e,r){let n=e;return r==null&&(n=`https://${e}`),`${r}://${n}/v0${t}`}function tM(t){const e=encodeURIComponent;let r="?";for(const n in t)if(t.hasOwnProperty(n)){const s=e(n)+"="+e(t[n]);r=r+s+"&"}return r=r.slice(0,-1),r}var zo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(zo||(zo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rM(t,e){const r=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return r||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(e,r,n,s,i,a,o,l,c,u,f,h=!0){this.url_=e,this.method_=r,this.headers_=n,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,g)=>{this.resolve_=p,this.reject_=g,this.start_()})}start_(){const e=(n,s)=>{if(s){n(!1,new Vf(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,c=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===zo.NO_ERROR,l=i.getStatus();if(!o||rM(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===zo.ABORT;n(!1,new Vf(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;n(!0,new Vf(c,i))})},r=(n,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());Z9(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=By();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?x4():G9();a(l)}else{const l=j9();a(l)}};this.canceled_?r(!1,new Vf(!1,null,!0)):this.backoffId_=Q9(e,r,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&J9(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Vf{constructor(e,r,n){this.wasSuccessCode=e,this.connection=r,this.canceled=!!n}}function sM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function aM(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function iM(t,e){e&&(t["X-Firebase-GMPID"]=e)}function oM(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function lM(t,e,r,n,s,i,a=!0){const o=tM(t.urlParams),l=t.url+o,c=Object.assign({},t.headers);return iM(c,e),sM(c,r),aM(c,i),oM(c,n),new nM(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function uM(...t){const e=cM();if(e!==void 0){const r=new e;for(let n=0;n<t.length;n++)r.append(t[n]);return r.getBlob()}else{if(Uy())return new Blob(t);throw new Wr(jr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function dM(t,e,r){return t.webkitSlice?t.webkitSlice(e,r):t.mozSlice?t.mozSlice(e,r):t.slice?t.slice(e,r):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fM(t){if(typeof atob>"u")throw X9("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Sm{constructor(e,r){this.data=e,this.contentType=r||null}}function Vy(t,e){switch(t){case Hs.RAW:return new Sm(b4(e));case Hs.BASE64:case Hs.BASE64URL:return new Sm(S4(t,e));case Hs.DATA_URL:return new Sm(pM(e),mM(e))}throw By()}function b4(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);if(n<=127)e.push(n);else if(n<=2047)e.push(192|n>>6,128|n&63);else if((n&64512)===55296)if(!(r<t.length-1&&(t.charCodeAt(r+1)&64512)===56320))e.push(239,191,189);else{const i=n,a=t.charCodeAt(++r);n=65536|(i&1023)<<10|a&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63)}else(n&64512)===56320?e.push(239,191,189):e.push(224|n>>12,128|n>>6&63,128|n&63)}return new Uint8Array(e)}function hM(t){let e;try{e=decodeURIComponent(t)}catch{throw Gu(Hs.DATA_URL,"Malformed data URL.")}return b4(e)}function S4(t,e){switch(t){case Hs.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Gu(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Hs.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Gu(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=fM(e)}catch(s){throw s.message.includes("polyfill")?s:Gu(t,"Invalid character found")}const n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n}class A4{constructor(e){this.base64=!1,this.contentType=null;const r=e.match(/^data:([^,]+)?,/);if(r===null)throw Gu(Hs.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=r[1]||null;n!=null&&(this.base64=gM(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}function pM(t){const e=new A4(t);return e.base64?S4(Hs.BASE64,e.rest):hM(e.rest)}function mM(t){return new A4(t).contentType}function gM(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,r){let n=0,s="";p_(e)?(this.data_=e,n=e.size,s=e.type):e instanceof ArrayBuffer?(r?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(r?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,r){if(p_(this.data_)){const n=this.data_,s=dM(n,e,r);return s===null?null:new ii(s)}else{const n=new Uint8Array(this.data_.buffer,e,r-e);return new ii(n,!0)}}static getBlob(...e){if(Uy()){const r=e.map(n=>n instanceof ii?n.data_:n);return new ii(uM.apply(null,r))}else{const r=e.map(a=>_4(a)?Vy(Hs.RAW,a).data:a.data_);let n=0;r.forEach(a=>{n+=a.byteLength});const s=new Uint8Array(n);let i=0;return r.forEach(a=>{for(let o=0;o<a.length;o++)s[i++]=a[o]}),new ii(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T4(t){let e;try{e=JSON.parse(t)}catch{return null}return eM(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vM(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function yM(t,e){const r=e.split("/").filter(n=>n.length>0).join("/");return t.length===0?r:t+"/"+r}function w4(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xM(t,e){return e}class ss{constructor(e,r,n,s){this.server=e,this.local=r||e,this.writable=!!n,this.xform=s||xM}}let Hf=null;function EM(t){return!_4(t)||t.length<2?t:w4(t)}function _M(){if(Hf)return Hf;const t=[];t.push(new ss("bucket")),t.push(new ss("generation")),t.push(new ss("metageneration")),t.push(new ss("name","fullPath",!0));function e(i,a){return EM(a)}const r=new ss("name");r.xform=e,t.push(r);function n(i,a){return a!==void 0?Number(a):a}const s=new ss("size");return s.xform=n,t.push(s),t.push(new ss("timeCreated")),t.push(new ss("updated")),t.push(new ss("md5Hash",null,!0)),t.push(new ss("cacheControl",null,!0)),t.push(new ss("contentDisposition",null,!0)),t.push(new ss("contentEncoding",null,!0)),t.push(new ss("contentLanguage",null,!0)),t.push(new ss("contentType",null,!0)),t.push(new ss("metadata","customMetadata",!0)),Hf=t,Hf}function bM(t,e){function r(){const n=t.bucket,s=t.fullPath,i=new Qn(n,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:r})}function SM(t,e,r){const n={};n.type="file";const s=r.length;for(let i=0;i<s;i++){const a=r[i];n[a.local]=a.xform(n,e[a.server])}return bM(n,t),n}function AM(t,e,r){const n=T4(e);return n===null?null:SM(t,n,r)}function TM(t,e){const r={},n=e.length;for(let s=0;s<n;s++){const i=e[s];i.writable&&(r[i.server]=t[i.local])}return JSON.stringify(r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_="prefixes",g_="items";function wM(t,e,r){const n={prefixes:[],items:[],nextPageToken:r.nextPageToken};if(r[m_])for(const s of r[m_]){const i=s.replace(/\/$/,""),a=t._makeStorageReference(new Qn(e,i));n.prefixes.push(a)}if(r[g_])for(const s of r[g_]){const i=t._makeStorageReference(new Qn(e,s.name));n.items.push(i)}return n}function CM(t,e,r){const n=T4(r);return n===null?null:wM(t,e,n)}class Hy{constructor(e,r,n,s){this.url=e,this.method=r,this.handler=n,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C4(t){if(!t)throw By()}function IM(t,e){function r(n,s){const i=AM(t,s,e);return C4(i!==null),i}return r}function kM(t,e){function r(n,s){const i=CM(t,e,s);return C4(i!==null),i}return r}function jy(t){function e(r,n){let s;return r.getStatus()===401?r.getErrorText().includes("Firebase App Check token is invalid")?s=V9():s=$9():r.getStatus()===402?s=U9(t.bucket):r.getStatus()===403?s=H9(t.path):s=n,s.status=r.getStatus(),s.serverResponse=n.serverResponse,s}return e}function DM(t){const e=jy(t);function r(n,s){let i=e(n,s);return n.getStatus()===404&&(i=B9(t.path)),i.serverResponse=s.serverResponse,i}return r}function PM(t,e,r,n,s){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",r.length>0&&(i.delimiter=r),n&&(i.pageToken=n),s&&(i.maxResults=s);const a=e.bucketOnlyServerUrl(),o=$y(a,t.host,t._protocol),l="GET",c=t.maxOperationRetryTime,u=new Hy(o,l,kM(t,e.bucket),c);return u.urlParams=i,u.errorHandler=jy(e),u}function RM(t,e){const r=e.fullServerUrl(),n=$y(r,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function a(l,c){}const o=new Hy(n,s,a,i);return o.successCodes=[200,204],o.errorHandler=DM(e),o}function FM(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function NM(t,e,r){const n=Object.assign({},r);return n.fullPath=t.path,n.size=e.size(),n.contentType||(n.contentType=FM(null,e)),n}function OM(t,e,r,n,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let v="";for(let A=0;A<2;A++)v=v+Math.random().toString().slice(2);return v}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const c=NM(e,n,s),u=TM(c,r),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,h=`\r
--`+l+"--",p=ii.getBlob(f,n,h);if(p===null)throw q9();const g={name:c.fullPath},y=$y(i,t.host,t._protocol),E="POST",b=t.maxUploadRetryTime,_=new Hy(y,E,IM(t,r),b);return _.urlParams=g,_.headers=a,_.body=p.uploadData(),_.errorHandler=jy(e),_}class MM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=zo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=zo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=zo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,r,n,s){if(this.sent_)throw iu("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(r,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return n!==void 0?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw iu("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw iu("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw iu("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw iu("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class LM extends MM{initXhr(){this.xhr_.responseType="text"}}function Gy(){return new LM}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class il{constructor(e,r){this._service=e,r instanceof Qn?this._location=r:this._location=Qn.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new il(e,r)}get root(){const e=new Qn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return w4(this._location.path)}get storage(){return this._service}get parent(){const e=vM(this._location.path);if(e===null)return null;const r=new Qn(this._location.bucket,e);return new il(this._service,r)}_throwIfRoot(e){if(this._location.path==="")throw E4(e)}}function I4(t,e,r){t._throwIfRoot("uploadBytes");const n=OM(t.storage,t._location,_M(),new ii(e,!0),r);return t.storage.makeRequestWithTokens(n,Gy).then(s=>({metadata:s,ref:t}))}function BM(t,e,r=Hs.RAW,n){t._throwIfRoot("uploadString");const s=Vy(r,e),i=Object.assign({},n);return i.contentType==null&&s.contentType!=null&&(i.contentType=s.contentType),I4(t,s.data,i)}function UM(t){const e={prefixes:[],items:[]};return k4(t,e).then(()=>e)}async function k4(t,e,r){const s=await $M(t,{pageToken:r});e.prefixes.push(...s.prefixes),e.items.push(...s.items),s.nextPageToken!=null&&await k4(t,e,s.nextPageToken)}function $M(t,e){e!=null&&typeof e.maxResults=="number"&&Pv("options.maxResults",1,1e3,e.maxResults);const r=e||{},n=PM(t.storage,t._location,"/",r.pageToken,r.maxResults);return t.storage.makeRequestWithTokens(n,Gy)}function VM(t){t._throwIfRoot("deleteObject");const e=RM(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Gy)}function HM(t,e){const r=yM(t._location.path,e),n=new Qn(t._location.bucket,r);return new il(t.storage,n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jM(t){return/^[A-Za-z]+:\/\//.test(t)}function GM(t,e){return new il(t,e)}function D4(t,e){if(t instanceof Wy){const r=t;if(r._bucket==null)throw K9();const n=new il(r,r._bucket);return e!=null?D4(n,e):n}else return e!==void 0?HM(t,e):t}function WM(t,e){if(e&&jM(e)){if(t instanceof Wy)return GM(t,e);throw vh("To use ref(service, url), the first argument must be a Storage instance.")}else return D4(t,e)}function v_(t,e){const r=e==null?void 0:e[y4];return r==null?null:Qn.makeFromBucketSpec(r,t)}function zM(t,e,r,n={}){t.host=`${e}:${r}`,t._protocol="http";const{mockUserToken:s}=n;s&&(t._overrideAuthToken=typeof s=="string"?s:aw(s,t.app.options.projectId))}class Wy{constructor(e,r,n,s,i){this.app=e,this._authProvider=r,this._appCheckProvider=n,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=v4,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=M9,this._maxUploadRetryTime=L9,this._requests=new Set,s!=null?this._bucket=Qn.makeFromBucketSpec(s,this._host):this._bucket=v_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Qn.makeFromBucketSpec(this._url,e):this._bucket=v_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Pv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Pv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const r=await e.getToken();if(r!==null)return r.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new il(this,e)}_makeRequest(e,r,n,s,i=!0){if(this._deleted)return new Y9(x4());{const a=lM(e,this._appId,n,s,r,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,r){const[n,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,n,s).getPromise()}}const y_="@firebase/storage",x_="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4="storage";function R4(t,e,r){return t=dr(t),I4(t,e,r)}function F4(t,e,r,n){return t=dr(t),BM(t,e,r,n)}function N4(t){return t=dr(t),UM(t)}function Rv(t){return t=dr(t),VM(t)}function yh(t,e){return t=dr(t),WM(t,e)}function O4(t=zd(),e){t=dr(t);const n=Wd(t,P4).getImmediate({identifier:e}),s=N1("storage");return s&&M4(n,...s),n}function M4(t,e,r,n={}){zM(t,e,r,n)}function KM(t,{instanceIdentifier:e}){const r=t.getProvider("app").getImmediate(),n=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Wy(r,n,s,e,pl)}function qM(){lo(new bi(P4,KM,"PUBLIC").setMultipleInstances(!0)),Ws(y_,x_,""),Ws(y_,x_,"esm2017")}qM();const XM=Object.freeze(Object.defineProperty({__proto__:null,StorageError:Wr,get StorageErrorCode(){return jr},StringFormat:Hs,_FbsBlob:ii,_Location:Qn,_dataFromString:Vy,_invalidArgument:vh,_invalidRootOperation:E4,connectStorageEmulator:M4,deleteObject:Rv,getStorage:O4,listAll:N4,ref:yh,uploadBytes:R4,uploadString:F4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YM="type.googleapis.com/google.protobuf.Int64Value",QM="type.googleapis.com/google.protobuf.UInt64Value";function L4(t,e){const r={};for(const n in t)t.hasOwnProperty(n)&&(r[n]=e(t[n]));return r}function Fv(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Fv(e));if(typeof t=="function"||typeof t=="object")return L4(t,e=>Fv(e));throw new Error("Data cannot be encoded in JSON: "+t)}function xh(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case YM:case QM:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>xh(e)):typeof t=="function"||typeof t=="object"?L4(t,e=>xh(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E_={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class dc extends Ea{constructor(e,r,n){super(`${zy}/${e}`,r||""),this.details=n}}function JM(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function ZM(t,e){let r=JM(t),n=r,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!E_[a])return new dc("internal","internal");r=E_[a],n=a}const o=i.message;typeof o=="string"&&(n=o),s=i.details,s!==void 0&&(s=xh(s))}}catch{}return r==="ok"?null:new dc(r,n,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{constructor(e,r,n){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||n.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const r=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return r.error?null:r.token}return null}async getContext(e){const r=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:r,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv="us-central1";function tL(t){let e=null;return{promise:new Promise((r,n)=>{e=setTimeout(()=>{n(new dc("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class rL{constructor(e,r,n,s,i=Nv,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new eL(r,n,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(i);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=Nv}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const r=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${r}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${r}.cloudfunctions.net/${e}`}}function nL(t,e,r){t.emulatorOrigin=`http://${e}:${r}`}function sL(t,e,r){return n=>iL(t,e,n,r||{})}async function aL(t,e,r,n){r["Content-Type"]="application/json";let s;try{s=await n(t,{method:"POST",body:JSON.stringify(e),headers:r})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function iL(t,e,r,n){const s=t._url(e);return oL(t,s,r,n)}async function oL(t,e,r,n){r=Fv(r);const s={data:r},i={},a=await t.contextProvider.getContext(n.limitedUseAppCheckTokens);a.authToken&&(i.Authorization="Bearer "+a.authToken),a.messagingToken&&(i["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=a.appCheckToken);const o=n.timeout||7e4,l=tL(o),c=await Promise.race([aL(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new dc("cancelled","Firebase Functions instance was deleted.");const u=ZM(c.status,c.json);if(u)throw u;if(!c.json)throw new dc("internal","Response is not valid JSON object.");let f=c.json.data;if(typeof f>"u"&&(f=c.json.result),typeof f>"u")throw new dc("internal","Response is missing data field.");return{data:xh(f)}}const __="@firebase/functions",b_="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lL="auth-internal",cL="app-check-internal",uL="messaging-internal";function dL(t,e){const r=(n,{instanceIdentifier:s})=>{const i=n.getProvider("app").getImmediate(),a=n.getProvider(lL),o=n.getProvider(uL),l=n.getProvider(cL);return new rL(i,a,o,l,s,t)};lo(new bi(zy,r,"PUBLIC").setMultipleInstances(!0)),Ws(__,b_,e),Ws(__,b_,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(t=zd(),e=Nv){const n=Wd(dr(t),zy).getImmediate({identifier:e}),s=N1("functions");return s&&B4(n,...s),n}function B4(t,e,r){nL(dr(t),e,r)}function Ra(t,e,r){return sL(dr(t),e,r)}dL(fetch.bind(self));const C0=Object.freeze(Object.defineProperty({__proto__:null,connectFunctionsEmulator:B4,getFunctions:fc,httpsCallable:Ra},Symbol.toStringTag,{value:"Module"})),U4={apiKey:"AIzaSyDXMm_ZBTXOd7k0e9FqQkvRRBOWfMUtGZ8",authDomain:"casemanagevue-jepson-prod.firebaseapp.com",projectId:"casemanagevue-jepson-prod",storageBucket:"casemanagevue-jepson-prod.firebasestorage.app",messagingSenderId:"1017885957186",appId:"1:1017885957186:web:f561608ff50c63730661db"},Op=lw(U4),Et=uo(Op),qe=xo(Op),kc=O4(Op),$4=fc(Op);Et.setPersistence(q1).then(()=>{console.log("🔒 Firebase auth persistence set to LOCAL - each tab maintains independent auth state")}).catch(t=>{console.error("❌ Error setting auth persistence:",t)});const V4=new oa;console.log("🔥 Connected to Firebase project:",U4.projectId);const H4=Object.freeze(Object.defineProperty({__proto__:null,auth:Et,db:qe,functions:$4,googleProvider:V4,storage:kc},Symbol.toStringTag,{value:"Module"}));/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const Wl=typeof document<"u";function j4(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function fL(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&j4(t.default)}const fr=Object.assign;function Am(t,e){const r={};for(const n in e){const s=e[n];r[n]=xa(s)?s.map(t):t(s)}return r}const Wu=()=>{},xa=Array.isArray,G4=/#/g,hL=/&/g,pL=/\//g,mL=/=/g,gL=/\?/g,W4=/\+/g,vL=/%5B/g,yL=/%5D/g,z4=/%5E/g,xL=/%60/g,K4=/%7B/g,EL=/%7C/g,q4=/%7D/g,_L=/%20/g;function Ky(t){return encodeURI(""+t).replace(EL,"|").replace(vL,"[").replace(yL,"]")}function bL(t){return Ky(t).replace(K4,"{").replace(q4,"}").replace(z4,"^")}function Ov(t){return Ky(t).replace(W4,"%2B").replace(_L,"+").replace(G4,"%23").replace(hL,"%26").replace(xL,"`").replace(K4,"{").replace(q4,"}").replace(z4,"^")}function SL(t){return Ov(t).replace(mL,"%3D")}function AL(t){return Ky(t).replace(G4,"%23").replace(gL,"%3F")}function TL(t){return t==null?"":AL(t).replace(pL,"%2F")}function Td(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const wL=/\/$/,CL=t=>t.replace(wL,"");function Tm(t,e,r="/"){let n,s={},i="",a="";const o=e.indexOf("#");let l=e.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(n=e.slice(0,l),i=e.slice(l+1,o>-1?o:e.length),s=t(i)),o>-1&&(n=n||e.slice(0,o),a=e.slice(o,e.length)),n=PL(n??e,r),{fullPath:n+(i&&"?")+i+a,path:n,query:s,hash:Td(a)}}function IL(t,e){const r=e.query?t(e.query):"";return e.path+(r&&"?")+r+(e.hash||"")}function S_(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function kL(t,e,r){const n=e.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&Dc(e.matched[n],r.matched[s])&&X4(e.params,r.params)&&t(e.query)===t(r.query)&&e.hash===r.hash}function Dc(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function X4(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!DL(t[r],e[r]))return!1;return!0}function DL(t,e){return xa(t)?A_(t,e):xa(e)?A_(e,t):t===e}function A_(t,e){return xa(e)?t.length===e.length&&t.every((r,n)=>r===e[n]):t.length===1&&t[0]===e}function PL(t,e){if(t.startsWith("/"))return t;if(!t)return e;const r=e.split("/"),n=t.split("/"),s=n[n.length-1];(s===".."||s===".")&&n.push("");let i=r.length-1,a,o;for(a=0;a<n.length;a++)if(o=n[a],o!==".")if(o==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a).join("/")}const Bi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var wd;(function(t){t.pop="pop",t.push="push"})(wd||(wd={}));var zu;(function(t){t.back="back",t.forward="forward",t.unknown=""})(zu||(zu={}));function RL(t){if(!t)if(Wl){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),CL(t)}const FL=/^[^#]+#/;function NL(t,e){return t.replace(FL,"#")+e}function OL(t,e){const r=document.documentElement.getBoundingClientRect(),n=t.getBoundingClientRect();return{behavior:e.behavior,left:n.left-r.left-(e.left||0),top:n.top-r.top-(e.top||0)}}const Mp=()=>({left:window.scrollX,top:window.scrollY});function ML(t){let e;if("el"in t){const r=t.el,n=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;e=OL(s,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function T_(t,e){return(history.state?history.state.position-e:-1)+t}const Mv=new Map;function LL(t,e){Mv.set(t,e)}function BL(t){const e=Mv.get(t);return Mv.delete(t),e}let UL=()=>location.protocol+"//"+location.host;function Y4(t,e){const{pathname:r,search:n,hash:s}=e,i=t.indexOf("#");if(i>-1){let o=s.includes(t.slice(i))?t.slice(i).length:1,l=s.slice(o);return l[0]!=="/"&&(l="/"+l),S_(l,"")}return S_(r,t)+n+s}function $L(t,e,r,n){let s=[],i=[],a=null;const o=({state:h})=>{const p=Y4(t,location),g=r.value,y=e.value;let E=0;if(h){if(r.value=p,e.value=h,a&&a===g){a=null;return}E=y?h.position-y.position:0}else n(p);s.forEach(b=>{b(r.value,g,{delta:E,type:wd.pop,direction:E?E>0?zu.forward:zu.back:zu.unknown})})};function l(){a=r.value}function c(h){s.push(h);const p=()=>{const g=s.indexOf(h);g>-1&&s.splice(g,1)};return i.push(p),p}function u(){const{history:h}=window;h.state&&h.replaceState(fr({},h.state,{scroll:Mp()}),"")}function f(){for(const h of i)h();i=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function w_(t,e,r,n=!1,s=!1){return{back:t,current:e,forward:r,replaced:n,position:window.history.length,scroll:s?Mp():null}}function VL(t){const{history:e,location:r}=window,n={value:Y4(t,r)},s={value:e.state};s.value||i(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const f=t.indexOf("#"),h=f>-1?(r.host&&document.querySelector("base")?t:t.slice(f))+l:UL()+t+l;try{e[u?"replaceState":"pushState"](c,"",h),s.value=c}catch(p){console.error(p),r[u?"replace":"assign"](h)}}function a(l,c){const u=fr({},e.state,w_(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,u,!0),n.value=l}function o(l,c){const u=fr({},s.value,e.state,{forward:l,scroll:Mp()});i(u.current,u,!0);const f=fr({},w_(n.value,l,null),{position:u.position+1},c);i(l,f,!1),n.value=l}return{location:n,state:s,push:o,replace:a}}function HL(t){t=RL(t);const e=VL(t),r=$L(t,e.state,e.location,e.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const s=fr({location:"",base:t,go:n,createHref:NL.bind(null,t)},e,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function jL(t){return typeof t=="string"||t&&typeof t=="object"}function Q4(t){return typeof t=="string"||typeof t=="symbol"}const J4=Symbol("");var C_;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(C_||(C_={}));function Pc(t,e){return fr(new Error,{type:t,[J4]:!0},e)}function Qa(t,e){return t instanceof Error&&J4 in t&&(e==null||!!(t.type&e))}const I_="[^/]+?",GL={sensitive:!1,strict:!1,start:!0,end:!0},WL=/[.+*?^${}()[\]/\\]/g;function zL(t,e){const r=fr({},GL,e),n=[];let s=r.start?"^":"";const i=[];for(const c of t){const u=c.length?[]:[90];r.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const h=c[f];let p=40+(r.sensitive?.25:0);if(h.type===0)f||(s+="/"),s+=h.value.replace(WL,"\\$&"),p+=40;else if(h.type===1){const{value:g,repeatable:y,optional:E,regexp:b}=h;i.push({name:g,repeatable:y,optional:E});const _=b||I_;if(_!==I_){p+=10;try{new RegExp(`(${_})`)}catch(A){throw new Error(`Invalid custom RegExp for param "${g}" (${_}): `+A.message)}}let v=y?`((?:${_})(?:/(?:${_}))*)`:`(${_})`;f||(v=E&&c.length<2?`(?:/${v})`:"/"+v),E&&(v+="?"),s+=v,p+=20,E&&(p+=-8),y&&(p+=-20),_===".*"&&(p+=-50)}u.push(p)}n.push(u)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function o(c){const u=c.match(a),f={};if(!u)return null;for(let h=1;h<u.length;h++){const p=u[h]||"",g=i[h-1];f[g.name]=p&&g.repeatable?p.split("/"):p}return f}function l(c){let u="",f=!1;for(const h of t){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const p of h)if(p.type===0)u+=p.value;else if(p.type===1){const{value:g,repeatable:y,optional:E}=p,b=g in c?c[g]:"";if(xa(b)&&!y)throw new Error(`Provided param "${g}" is an array but it is not repeatable (* or + modifiers)`);const _=xa(b)?b.join("/"):b;if(!_)if(E)h.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${g}"`);u+=_}}return u||"/"}return{re:a,score:n,keys:i,parse:o,stringify:l}}function KL(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=e[r]-t[r];if(n)return n;r++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function Z4(t,e){let r=0;const n=t.score,s=e.score;for(;r<n.length&&r<s.length;){const i=KL(n[r],s[r]);if(i)return i;r++}if(Math.abs(s.length-n.length)===1){if(k_(n))return 1;if(k_(s))return-1}return s.length-n.length}function k_(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const qL={type:0,value:""},XL=/[a-zA-Z0-9_]/;function YL(t){if(!t)return[[]];if(t==="/")return[[qL]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(p){throw new Error(`ERR (${r})/"${c}": ${p}`)}let r=0,n=r;const s=[];let i;function a(){i&&s.push(i),i=[]}let o=0,l,c="",u="";function f(){c&&(r===0?i.push({type:0,value:c}):r===1||r===2||r===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function h(){c+=l}for(;o<t.length;){if(l=t[o++],l==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:l==="/"?(c&&f(),a()):l===":"?(f(),r=1):h();break;case 4:h(),r=n;break;case 1:l==="("?r=2:XL.test(l)?h():(f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:r=3:u+=l;break;case 3:f(),r=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:e("Unknown state");break}}return r===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),a(),s}function QL(t,e,r){const n=zL(YL(t.path),r),s=fr(n,{record:t,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function JL(t,e){const r=[],n=new Map;e=F_({strict:!1,end:!0,sensitive:!1},e);function s(f){return n.get(f)}function i(f,h,p){const g=!p,y=P_(f);y.aliasOf=p&&p.record;const E=F_(e,f),b=[y];if("alias"in f){const A=typeof f.alias=="string"?[f.alias]:f.alias;for(const D of A)b.push(P_(fr({},y,{components:p?p.record.components:y.components,path:D,aliasOf:p?p.record:y})))}let _,v;for(const A of b){const{path:D}=A;if(h&&D[0]!=="/"){const k=h.record.path,T=k[k.length-1]==="/"?"":"/";A.path=h.record.path+(D&&T+D)}if(_=QL(A,h,E),p?p.alias.push(_):(v=v||_,v!==_&&v.alias.push(_),g&&f.name&&!R_(_)&&a(f.name)),eI(_)&&l(_),y.children){const k=y.children;for(let T=0;T<k.length;T++)i(k[T],_,p&&p.children[T])}p=p||_}return v?()=>{a(v)}:Wu}function a(f){if(Q4(f)){const h=n.get(f);h&&(n.delete(f),r.splice(r.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=r.indexOf(f);h>-1&&(r.splice(h,1),f.record.name&&n.delete(f.record.name),f.children.forEach(a),f.alias.forEach(a))}}function o(){return r}function l(f){const h=t7(f,r);r.splice(h,0,f),f.record.name&&!R_(f)&&n.set(f.record.name,f)}function c(f,h){let p,g={},y,E;if("name"in f&&f.name){if(p=n.get(f.name),!p)throw Pc(1,{location:f});E=p.record.name,g=fr(D_(h.params,p.keys.filter(v=>!v.optional).concat(p.parent?p.parent.keys.filter(v=>v.optional):[]).map(v=>v.name)),f.params&&D_(f.params,p.keys.map(v=>v.name))),y=p.stringify(g)}else if(f.path!=null)y=f.path,p=r.find(v=>v.re.test(y)),p&&(g=p.parse(y),E=p.record.name);else{if(p=h.name?n.get(h.name):r.find(v=>v.re.test(h.path)),!p)throw Pc(1,{location:f,currentLocation:h});E=p.record.name,g=fr({},h.params,f.params),y=p.stringify(g)}const b=[];let _=p;for(;_;)b.unshift(_.record),_=_.parent;return{name:E,path:y,params:g,matched:b,meta:e7(b)}}t.forEach(f=>i(f));function u(){r.length=0,n.clear()}return{addRoute:i,resolve:c,removeRoute:a,clearRoutes:u,getRoutes:o,getRecordMatcher:s}}function D_(t,e){const r={};for(const n of e)n in t&&(r[n]=t[n]);return r}function P_(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:ZL(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function ZL(t){const e={},r=t.props||!1;if("component"in t)e.default=r;else for(const n in t.components)e[n]=typeof r=="object"?r[n]:r;return e}function R_(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function e7(t){return t.reduce((e,r)=>fr(e,r.meta),{})}function F_(t,e){const r={};for(const n in t)r[n]=n in e?e[n]:t[n];return r}function t7(t,e){let r=0,n=e.length;for(;r!==n;){const i=r+n>>1;Z4(t,e[i])<0?n=i:r=i+1}const s=r7(t);return s&&(n=e.lastIndexOf(s,n-1)),n}function r7(t){let e=t;for(;e=e.parent;)if(eI(e)&&Z4(t,e)===0)return e}function eI({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function n7(t){const e={};if(t===""||t==="?")return e;const n=(t[0]==="?"?t.slice(1):t).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(W4," "),a=i.indexOf("="),o=Td(a<0?i:i.slice(0,a)),l=a<0?null:Td(i.slice(a+1));if(o in e){let c=e[o];xa(c)||(c=e[o]=[c]),c.push(l)}else e[o]=l}return e}function N_(t){let e="";for(let r in t){const n=t[r];if(r=SL(r),n==null){n!==void 0&&(e+=(e.length?"&":"")+r);continue}(xa(n)?n.map(i=>i&&Ov(i)):[n&&Ov(n)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+r,i!=null&&(e+="="+i))})}return e}function s7(t){const e={};for(const r in t){const n=t[r];n!==void 0&&(e[r]=xa(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return e}const a7=Symbol(""),O_=Symbol(""),Lp=Symbol(""),qy=Symbol(""),Lv=Symbol("");function ou(){let t=[];function e(n){return t.push(n),()=>{const s=t.indexOf(n);s>-1&&t.splice(s,1)}}function r(){t=[]}return{add:e,list:()=>t.slice(),reset:r}}function zi(t,e,r,n,s,i=a=>a()){const a=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((o,l)=>{const c=h=>{h===!1?l(Pc(4,{from:r,to:e})):h instanceof Error?l(h):jL(h)?l(Pc(2,{from:e,to:h})):(a&&n.enterCallbacks[s]===a&&typeof h=="function"&&a.push(h),o())},u=i(()=>t.call(n&&n.instances[s],e,r,c));let f=Promise.resolve(u);t.length<3&&(f=f.then(c)),f.catch(h=>l(h))})}function wm(t,e,r,n,s=i=>i()){const i=[];for(const a of t)for(const o in a.components){let l=a.components[o];if(!(e!=="beforeRouteEnter"&&!a.instances[o]))if(j4(l)){const u=(l.__vccOpts||l)[e];u&&i.push(zi(u,r,n,a,o,s))}else{let c=l();i.push(()=>c.then(u=>{if(!u)throw new Error(`Couldn't resolve component "${o}" at "${a.path}"`);const f=fL(u)?u.default:u;a.mods[o]=u,a.components[o]=f;const p=(f.__vccOpts||f)[e];return p&&zi(p,r,n,a,o,s)()}))}}return i}function M_(t){const e=Ns(Lp),r=Ns(qy),n=Se(()=>{const l=q(t.to);return e.resolve(l)}),s=Se(()=>{const{matched:l}=n.value,{length:c}=l,u=l[c-1],f=r.matched;if(!u||!f.length)return-1;const h=f.findIndex(Dc.bind(null,u));if(h>-1)return h;const p=L_(l[c-2]);return c>1&&L_(u)===p&&f[f.length-1].path!==p?f.findIndex(Dc.bind(null,l[c-2])):h}),i=Se(()=>s.value>-1&&u7(r.params,n.value.params)),a=Se(()=>s.value>-1&&s.value===r.matched.length-1&&X4(r.params,n.value.params));function o(l={}){if(c7(l)){const c=e[q(t.replace)?"replace":"push"](q(t.to)).catch(Wu);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:Se(()=>n.value.href),isActive:i,isExactActive:a,navigate:o}}function i7(t){return t.length===1?t[0]:t}const o7=Ud({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:M_,setup(t,{slots:e}){const r=As(M_(t)),{options:n}=Ns(Lp),s=Se(()=>({[B_(t.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[B_(t.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=e.default&&i7(e.default(r));return t.custom?i:el("a",{"aria-current":r.isExactActive?t.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},i)}}}),l7=o7;function c7(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function u7(t,e){for(const r in e){const n=e[r],s=t[r];if(typeof n=="string"){if(n!==s)return!1}else if(!xa(s)||s.length!==n.length||n.some((i,a)=>i!==s[a]))return!1}return!0}function L_(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const B_=(t,e,r)=>t??e??r,d7=Ud({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:r}){const n=Ns(Lv),s=Se(()=>t.route||n.value),i=Ns(O_,0),a=Se(()=>{let c=q(i);const{matched:u}=s.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),o=Se(()=>s.value.matched[a.value]);Ou(O_,Se(()=>a.value+1)),Ou(a7,o),Ou(Lv,s);const l=se();return Ht(()=>[l.value,o.value,t.name],([c,u,f],[h,p,g])=>{u&&(u.instances[f]=c,p&&p!==u&&c&&c===h&&(u.leaveGuards.size||(u.leaveGuards=p.leaveGuards),u.updateGuards.size||(u.updateGuards=p.updateGuards))),c&&u&&(!p||!Dc(u,p)||!h)&&(u.enterCallbacks[f]||[]).forEach(y=>y(c))},{flush:"post"}),()=>{const c=s.value,u=t.name,f=o.value,h=f&&f.components[u];if(!h)return U_(r.default,{Component:h,route:c});const p=f.props[u],g=p?p===!0?c.params:typeof p=="function"?p(c):p:null,E=el(h,fr({},g,e,{onVnodeUnmounted:b=>{b.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return U_(r.default,{Component:E,route:c})||E}}});function U_(t,e){if(!t)return null;const r=t(e);return r.length===1?r[0]:r}const f7=d7;function h7(t){const e=JL(t.routes,t),r=t.parseQuery||n7,n=t.stringifyQuery||N_,s=t.history,i=ou(),a=ou(),o=ou(),l=v1(Bi);let c=Bi;Wl&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Am.bind(null,ne=>""+ne),f=Am.bind(null,TL),h=Am.bind(null,Td);function p(ne,le){let J,Q;return Q4(ne)?(J=e.getRecordMatcher(ne),Q=le):Q=ne,e.addRoute(Q,J)}function g(ne){const le=e.getRecordMatcher(ne);le&&e.removeRoute(le)}function y(){return e.getRoutes().map(ne=>ne.record)}function E(ne){return!!e.getRecordMatcher(ne)}function b(ne,le){if(le=fr({},le||l.value),typeof ne=="string"){const Y=Tm(r,ne,le.path),pe=e.resolve({path:Y.path},le),xe=s.createHref(Y.fullPath);return fr(Y,pe,{params:h(pe.params),hash:Td(Y.hash),redirectedFrom:void 0,href:xe})}let J;if(ne.path!=null)J=fr({},ne,{path:Tm(r,ne.path,le.path).path});else{const Y=fr({},ne.params);for(const pe in Y)Y[pe]==null&&delete Y[pe];J=fr({},ne,{params:f(Y)}),le.params=f(le.params)}const Q=e.resolve(J,le),ve=ne.hash||"";Q.params=u(h(Q.params));const ee=IL(n,fr({},ne,{hash:bL(ve),path:Q.path})),K=s.createHref(ee);return fr({fullPath:ee,hash:ve,query:n===N_?s7(ne.query):ne.query||{}},Q,{redirectedFrom:void 0,href:K})}function _(ne){return typeof ne=="string"?Tm(r,ne,l.value.path):fr({},ne)}function v(ne,le){if(c!==ne)return Pc(8,{from:le,to:ne})}function A(ne){return T(ne)}function D(ne){return A(fr(_(ne),{replace:!0}))}function k(ne){const le=ne.matched[ne.matched.length-1];if(le&&le.redirect){const{redirect:J}=le;let Q=typeof J=="function"?J(ne):J;return typeof Q=="string"&&(Q=Q.includes("?")||Q.includes("#")?Q=_(Q):{path:Q},Q.params={}),fr({query:ne.query,hash:ne.hash,params:Q.path!=null?{}:ne.params},Q)}}function T(ne,le){const J=c=b(ne),Q=l.value,ve=ne.state,ee=ne.force,K=ne.replace===!0,Y=k(J);if(Y)return T(fr(_(Y),{state:typeof Y=="object"?fr({},ve,Y.state):ve,force:ee,replace:K}),le||J);const pe=J;pe.redirectedFrom=le;let xe;return!ee&&kL(n,Q,J)&&(xe=Pc(16,{to:pe,from:Q}),z(Q,Q,!0,!1)),(xe?Promise.resolve(xe):S(pe,Q)).catch(ae=>Qa(ae)?Qa(ae,2)?ae:G(ae):M(ae,pe,Q)).then(ae=>{if(ae){if(Qa(ae,2))return T(fr({replace:K},_(ae.to),{state:typeof ae.to=="object"?fr({},ve,ae.to.state):ve,force:ee}),le||pe)}else ae=C(pe,Q,!0,K,ve);return I(pe,Q,ae),ae})}function x(ne,le){const J=v(ne,le);return J?Promise.reject(J):Promise.resolve()}function m(ne){const le=V.values().next().value;return le&&typeof le.runWithContext=="function"?le.runWithContext(ne):ne()}function S(ne,le){let J;const[Q,ve,ee]=p7(ne,le);J=wm(Q.reverse(),"beforeRouteLeave",ne,le);for(const Y of Q)Y.leaveGuards.forEach(pe=>{J.push(zi(pe,ne,le))});const K=x.bind(null,ne,le);return J.push(K),oe(J).then(()=>{J=[];for(const Y of i.list())J.push(zi(Y,ne,le));return J.push(K),oe(J)}).then(()=>{J=wm(ve,"beforeRouteUpdate",ne,le);for(const Y of ve)Y.updateGuards.forEach(pe=>{J.push(zi(pe,ne,le))});return J.push(K),oe(J)}).then(()=>{J=[];for(const Y of ee)if(Y.beforeEnter)if(xa(Y.beforeEnter))for(const pe of Y.beforeEnter)J.push(zi(pe,ne,le));else J.push(zi(Y.beforeEnter,ne,le));return J.push(K),oe(J)}).then(()=>(ne.matched.forEach(Y=>Y.enterCallbacks={}),J=wm(ee,"beforeRouteEnter",ne,le,m),J.push(K),oe(J))).then(()=>{J=[];for(const Y of a.list())J.push(zi(Y,ne,le));return J.push(K),oe(J)}).catch(Y=>Qa(Y,8)?Y:Promise.reject(Y))}function I(ne,le,J){o.list().forEach(Q=>m(()=>Q(ne,le,J)))}function C(ne,le,J,Q,ve){const ee=v(ne,le);if(ee)return ee;const K=le===Bi,Y=Wl?history.state:{};J&&(Q||K?s.replace(ne.fullPath,fr({scroll:K&&Y&&Y.scroll},ve)):s.push(ne.fullPath,ve)),l.value=ne,z(ne,le,J,K),G()}let F;function W(){F||(F=s.listen((ne,le,J)=>{if(!te.listening)return;const Q=b(ne),ve=k(Q);if(ve){T(fr(ve,{replace:!0,force:!0}),Q).catch(Wu);return}c=Q;const ee=l.value;Wl&&LL(T_(ee.fullPath,J.delta),Mp()),S(Q,ee).catch(K=>Qa(K,12)?K:Qa(K,2)?(T(fr(_(K.to),{force:!0}),Q).then(Y=>{Qa(Y,20)&&!J.delta&&J.type===wd.pop&&s.go(-1,!1)}).catch(Wu),Promise.reject()):(J.delta&&s.go(-J.delta,!1),M(K,Q,ee))).then(K=>{K=K||C(Q,ee,!1),K&&(J.delta&&!Qa(K,8)?s.go(-J.delta,!1):J.type===wd.pop&&Qa(K,20)&&s.go(-1,!1)),I(Q,ee,K)}).catch(Wu)}))}let P=ou(),R=ou(),N;function M(ne,le,J){G(ne);const Q=R.list();return Q.length?Q.forEach(ve=>ve(ne,le,J)):console.error(ne),Promise.reject(ne)}function O(){return N&&l.value!==Bi?Promise.resolve():new Promise((ne,le)=>{P.add([ne,le])})}function G(ne){return N||(N=!ne,W(),P.list().forEach(([le,J])=>ne?J(ne):le()),P.reset()),ne}function z(ne,le,J,Q){const{scrollBehavior:ve}=t;if(!Wl||!ve)return Promise.resolve();const ee=!J&&BL(T_(ne.fullPath,0))||(Q||!J)&&history.state&&history.state.scroll||null;return hl().then(()=>ve(ne,le,ee)).then(K=>K&&ML(K)).catch(K=>M(K,ne,le))}const j=ne=>s.go(ne);let H;const V=new Set,te={currentRoute:l,listening:!0,addRoute:p,removeRoute:g,clearRoutes:e.clearRoutes,hasRoute:E,getRoutes:y,resolve:b,options:t,push:A,replace:D,go:j,back:()=>j(-1),forward:()=>j(1),beforeEach:i.add,beforeResolve:a.add,afterEach:o.add,onError:R.add,isReady:O,install(ne){const le=this;ne.component("RouterLink",l7),ne.component("RouterView",f7),ne.config.globalProperties.$router=le,Object.defineProperty(ne.config.globalProperties,"$route",{enumerable:!0,get:()=>q(l)}),Wl&&!H&&l.value===Bi&&(H=!0,A(s.location).catch(ve=>{}));const J={};for(const ve in Bi)Object.defineProperty(J,ve,{get:()=>l.value[ve],enumerable:!0});ne.provide(Lp,le),ne.provide(qy,m1(J)),ne.provide(Lv,l);const Q=ne.unmount;V.add(ne),ne.unmount=function(){V.delete(ne),V.size<1&&(c=Bi,F&&F(),F=null,l.value=Bi,H=!1,N=!1),Q()}}};function oe(ne){return ne.reduce((le,J)=>le.then(()=>m(J)),Promise.resolve())}return te}function p7(t,e){const r=[],n=[],s=[],i=Math.max(e.matched.length,t.matched.length);for(let a=0;a<i;a++){const o=e.matched[a];o&&(t.matched.find(c=>Dc(c,o))?n.push(o):r.push(o));const l=t.matched[a];l&&(e.matched.find(c=>Dc(c,l))||s.push(l))}return[r,n,s]}function ki(){return Ns(Lp)}function m7(t){return Ns(qy)}class g7{constructor(){this.enabled=!0}async logStudentAccess(e,r,n={}){if(!(!this.enabled||!Et.currentUser))try{const s=Ze(At(qe,"auditLogs"));await jt(s,{type:"student_access",studentId:e,userId:Et.currentUser.uid,userEmail:Et.currentUser.email,action:r,details:n,timestamp:Dn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}async logUserManagement(e,r,n={}){if(!(!this.enabled||!Et.currentUser))try{const s=Ze(At(qe,"auditLogs"));await jt(s,{type:"user_management",targetUserId:e,performedBy:Et.currentUser.uid,performedByEmail:Et.currentUser.email,action:r,details:n,timestamp:Dn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}async logSystemAccess(e,r={}){var n,s;if(this.enabled)try{const i=Ze(At(qe,"auditLogs"));await jt(i,{type:"system_access",userId:((n=Et.currentUser)==null?void 0:n.uid)||"unknown",userEmail:((s=Et.currentUser)==null?void 0:s.email)||"unknown",action:e,details:r,timestamp:Dn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(i){console.error("Audit logging failed:",i)}}async logDataExport(e,r,n={}){if(!(!this.enabled||!Et.currentUser))try{const s=Ze(At(qe,"auditLogs"));await jt(s,{type:"data_export",exportType:e,studentIds:Array.isArray(r)?r:[r],studentCount:Array.isArray(r)?r.length:1,userId:Et.currentUser.uid,userEmail:Et.currentUser.email,details:n,timestamp:Dn(),sessionId:this.getSessionId(),ipAddress:await this.getClientIP(),userAgent:navigator.userAgent})}catch(s){console.error("Audit logging failed:",s)}}getSessionId(){return sessionStorage.getItem("sessionId")||sessionStorage.setItem("sessionId",`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`),sessionStorage.getItem("sessionId")}async getClientIP(){try{return(await(await fetch("https://api.ipify.org?format=json")).json()).ip}catch{return"unknown"}}async generateAccessReport(e,r){try{const n=new Date(r.start),s=new Date(r.end);return{studentId:e,accessCount:0,uniqueUsers:[],actions:[],timeRange:r}}catch(n){return console.error("Report generation failed:",n),null}}}const sn=new g7,on=JT("auth",()=>{const t=se(null),e=se(""),r=se(!0),n=ki(),s=()=>{K1(Et,async g=>{if(r.value=!0,g)try{const y=await qt(Ze(qe,"users",g.uid));y.exists()?(t.value={uid:g.uid,email:g.email,name:g.displayName,...y.data()},a()):t.value=null}catch(y){console.error("❌ Error fetching user data:",y),console.error("❌ This might be due to expired token - user will be logged out"),t.value=null}else t.value=null,o(),typeof window<"u"&&window.location.pathname!=="/login"&&(window.location.href="/login");r.value=!1})};let i=null;const a=()=>{o(),i=setInterval(async()=>{if(Et.currentUser)try{await f()||(console.error("❌ Failed to refresh token - logging user out for security"),await c())}catch(g){console.error("❌ Token refresh threw an error:",g),await c()}},45*60*1e3)},o=()=>{i&&(clearInterval(i),i=null)},l=async()=>{e.value="";try{const g=new oa,E=(await J1(Et,g)).user,b=await qt(Ze(qe,"users",E.uid));if(!b.exists()){e.value="⚠️ User not found in system.";return}t.value={uid:E.uid,email:E.email,name:E.displayName,...b.data()},n.push("/")}catch(g){console.error("❌ Login error:",g),e.value=g.message||"Authentication failed."}},c=async()=>{try{t.value&&await sn.logSystemAccess("logout",{userRole:t.value.role,success:!0}),await lp(Et),t.value=null,n.push("/login")}catch(g){console.error("❌ Logout error:",g),await sn.logSystemAccess("logout_error",{error:g.message,success:!1})}},u=g=>{t.value=g},f=async()=>{if(Et.currentUser)try{return await fv(Et.currentUser,!0),!0}catch(g){return console.error("❌ Error refreshing token:",g),console.error("❌ Error details:",g.code,g.message),!1}return!1},h=async()=>{if(!Et.currentUser)return!1;try{return await fv(Et.currentUser,!1),!0}catch(g){return console.error("❌ Current token is invalid:",g),!1}},p=Se(()=>t.value);return s(),{currentUser:t,user:p,errorMsg:e,isLoading:r,loginWithGoogle:l,logout:c,setUser:u,refreshToken:f,setupTokenRefresh:a,clearTokenRefresh:o,checkTokenValidity:h}}),v7=Object.freeze(Object.defineProperty({__proto__:null,useAuthStore:on},Symbol.toStringTag,{value:"Module"})),Ko=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"],y7=["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"],lu=["admin","school_admin","admin_504","sped_chair"],at={VIEW_USERS:"view_users",EDIT_USER:"edit_user",DELETE_USER:"delete_user",VIEW_STUDENTS:"view_students",EDIT_STUDENT_CM:"edit_student_CM",EDIT_STUDENT_ALL:"edit_student_All",ACCESS_ADMIN_PANEL:"access_admin_panel",MANAGE_AIDES:"manage_aides",MANAGE_SYSTEM_SETTINGS:"manage_system_settings",MANAGE_TEACHER_FEEDBACK:"manage_teacher_feedback",MANAGE_IMPORTS:"manage_imports",MANAGE_BACKUPS:"manage_backups"},tI={admin:[at.VIEW_USERS,at.EDIT_USER,at.DELETE_USER,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL,at.ACCESS_ADMIN_PANEL,at.MANAGE_AIDES,at.MANAGE_SYSTEM_SETTINGS,at.MANAGE_TEACHER_FEEDBACK,at.MANAGE_IMPORTS,at.MANAGE_BACKUPS],school_admin:[at.VIEW_USERS,at.EDIT_USER,at.DELETE_USER,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL,at.ACCESS_ADMIN_PANEL,at.MANAGE_AIDES,at.MANAGE_TEACHER_FEEDBACK,at.MANAGE_IMPORTS,at.MANAGE_BACKUPS],staff_view:[at.VIEW_USERS,at.VIEW_STUDENTS],staff_edit:[at.VIEW_USERS,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL],admin_504:[at.VIEW_USERS,at.EDIT_USER,at.DELETE_USER,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL,at.ACCESS_ADMIN_PANEL,at.MANAGE_AIDES,at.MANAGE_TEACHER_FEEDBACK],sped_chair:[at.VIEW_USERS,at.EDIT_USER,at.DELETE_USER,at.VIEW_STUDENTS,at.EDIT_STUDENT_ALL,at.ACCESS_ADMIN_PANEL,at.MANAGE_AIDES,at.MANAGE_TEACHER_FEEDBACK],case_manager:[at.VIEW_USERS,at.VIEW_STUDENTS,at.EDIT_STUDENT_CM,at.MANAGE_TEACHER_FEEDBACK],teacher:[at.VIEW_USERS,at.VIEW_STUDENTS],service_provider:[at.VIEW_USERS,at.VIEW_STUDENTS,at.EDIT_STUDENT_CM],paraeducator:[at.VIEW_USERS,at.VIEW_STUDENTS]};function $_(t){return Ko.includes(t)}const x7={admin:"System Administrator - Full access to all features and settings",school_admin:"School Administrator - Manage students, aides, and users (no system settings)",staff_view:"Staff Viewer - IEP access for counselors, nurses, intervention specialists",staff_edit:"Staff Editor - Edit all students, no admin panel access",admin_504:"504 Plan Coordinator - Manage 504 plans, students, and aides",sped_chair:"Special Education Chair - Manage special education programs",case_manager:"Case Manager - Manage assigned student caseload only",teacher:"Teacher - View students in assigned classes",service_provider:"Service Provider - Manage students receiving services",paraeducator:"Paraeducator - View assigned students only"},Xy=JT("permission",()=>{const t=on(),e=se([]),r=se({}),n=se({}),s=se(!1),i=async()=>{n.value=tI,s.value=!0,console.log("Using static permissions matrix:",n.value),e.value.length>0&&(r.value=a(e.value))};function a(c){const u={};return console.log("Deriving permissions for roles:",c),console.log("Current permissions matrix:",n.value),console.log("Matrix loaded:",s.value),c.forEach(f=>{const h=n.value[f]||[];console.log(`Role ${f} has permissions:`,h),h.forEach(p=>u[p]=!0)}),console.log("Final derived permissions:",u),u}let o=null;return Ht(()=>{var c;return(c=t.currentUser)==null?void 0:c.uid},()=>{var c;if(o&&o(),(c=t.currentUser)!=null&&c.uid){const u=Ze(qe,"users",t.currentUser.uid);o=Np(u,f=>{const h=f.data()||{};e.value=h.role?[h.role]:[],console.log("User roles updated:",e.value),t.currentUser&&(t.currentUser.value={...t.currentUser.value,...h},console.log("🔄 Updated auth store user data:",t.currentUser.value)),s.value&&(r.value=a(e.value))})}else e.value=[],r.value={}},{immediate:!0}),i(),{userRoles:e,userPermissions:r,permissionsMatrix:n,matrixLoaded:s,hasRole:c=>e.value.includes(c),can:c=>r.value[c]===!0,loadPermissionsMatrix:i}});function E7(){const t=Xy(),e=Se(()=>t.hasRole("admin")),r=Se(()=>t.can("manage_users")),n=s=>t.can(s);return{isAdmin:e,canManageUsers:r,hasRole:t.hasRole,can:t.can,hasPermission:n}}const St=(t,e)=>{const r=t.__vccOpts||t;for(const[n,s]of e)r[n]=s;return r},_7={name:"UserRoleSwitcher",setup(){const t=on();E7();const e=se(!1),r=se(""),n=se({}),s=se(!1),i=Se(()=>t.user),a=[{value:"admin",label:"Admin"},{value:"school_admin",label:"School Admin"},{value:"admin_504",label:"504 Coordinator"},{value:"sped_chair",label:"SPED Chair"},{value:"staff_view",label:"Staff (View)"},{value:"staff_edit",label:"Staff (Edit)"},{value:"case_manager",label:"Case Manager"},{value:"teacher",label:"Teacher"},{value:"service_provider",label:"Service Provider"},{value:"paraeducator",label:"Paraeducator"}],o=[{uid:"test-admin",name:"Test Admin",email:"admin@test.com",role:"admin"},{uid:"test-school-admin",name:"Test School Admin",email:"schooladmin@test.com",role:"school_admin"},{uid:"test-admin-504",name:"Test 504 Coordinator",email:"admin504@test.com",role:"admin_504"},{uid:"test-sped-chair",name:"Test SPED Chair",email:"spedchair@test.com",role:"sped_chair"},{uid:"test-case-manager",name:"Test Case Manager",email:"cm@test.com",role:"case_manager"},{uid:"test-paraeducator",name:"Test Paraeducator",email:"para@test.com",role:"paraeducator"},{uid:"test-teacher",name:"Test Teacher",email:"teacher@test.com",role:"teacher"},{uid:"test-service-provider",name:"Test Service Provider",email:"service@test.com",role:"service_provider"}],l=async()=>{s.value=!0;try{const b=Ze(qe,"config","permissions_matrix"),_=await qt(b);_.exists()?n.value=_.data():(console.warn("Permissions matrix not found in database"),n.value={})}catch(b){console.error("Error loading permissions matrix:",b),n.value={}}finally{s.value=!1}},c=Se(()=>{var A;const b=[{action:at.VIEW_USERS,label:"View Users"},{action:at.EDIT_USER,label:"Edit User"},{action:at.DELETE_USER,label:"Delete User"},{action:at.MANAGE_SUBJECTS,label:"Manage Subjects"},{action:at.MANAGE_ROLES,label:"Manage Roles"},{action:at.VIEW_STUDENTS,label:"View Students"},{action:at.EDIT_STUDENT_CM,label:"Edit Students (Own Caseload)"},{action:at.EDIT_STUDENT_ALL,label:"Edit All Students"},{action:at.TESTING,label:"Testing"}],_=(A=i.value)==null?void 0:A.role,v=n.value[_]||[];return b.map(D=>({...D,granted:v.includes(D.action)}))}),u=()=>{e.value=!e.value},f=()=>{if(!r.value)return;const b={uid:`test-${r.value}-${Date.now()}`,email:`${r.value}@test.com`,name:`Test ${r.value.charAt(0).toUpperCase()+r.value.slice(1)}`,role:r.value,lastSyncTrigger:new Date().toISOString()};t.setUser(b),localStorage.setItem("debug-user",JSON.stringify(b)),r.value=""},h=b=>{t.setUser(b),localStorage.setItem("debug-user",JSON.stringify(b))},p=()=>{localStorage.removeItem("debug-user"),window.location.reload()},g=()=>{window.location.reload()};return Gt(async()=>{await l();const b=localStorage.getItem("debug-user");if(b)try{const _=JSON.parse(b);t.setUser(_)}catch(_){console.error("Error parsing debug user:",_),localStorage.removeItem("debug-user")}return()=>{}}),{canSwitchRoles:Se(()=>{var _;const b=(_=i.value)==null?void 0:_.role;return["admin","administrator"].includes(b)}),hideRoleSwitcher:()=>{console.log("Role switcher hidden")},isExpanded:e,selectedRole:r,currentUser:i,availableRoles:a,testUsers:o,currentPermissions:c,loadingPermissions:s,toggleExpanded:u,switchRole:f,switchToUser:h,resetToRealUser:p,refreshPage:g}}},b7=["title"],S7={key:0,class:"debug-label"},A7={key:0,class:"switcher-content"},T7={class:"current-user-info"},w7={class:"role-selector"},C7=["value"],I7={class:"test-users"},k7={class:"test-user-buttons"},D7=["onClick"],P7={class:"permission-info"},R7={key:0,class:"loading-permissions"},F7={key:1,class:"permission-list"},N7={class:"permission-icon"},O7={class:"actions"};function M7(t,e,r,n,s,i){var a,o,l,c,u;return n.canSwitchRoles?(L(),B("div",{key:0,class:Xe(["user-role-switcher",{collapsed:!n.isExpanded}])},[d("div",{class:"switcher-header",onClick:e[1]||(e[1]=(...f)=>n.toggleExpanded&&n.toggleExpanded(...f)),title:n.isExpanded?"Collapse Debug Panel":"Expand Debug Panel"},[e[6]||(e[6]=d("span",{class:"debug-icon"},"🔧",-1)),n.isExpanded?(L(),B("span",S7,"Debug Role Switcher")):_e("",!0),e[7]||(e[7]=d("span",{class:"beta-label"},"BETA",-1)),d("button",{onClick:e[0]||(e[0]=Yr((...f)=>n.hideRoleSwitcher&&n.hideRoleSwitcher(...f),["stop"])),class:"close-debug-btn",title:"Close Role Switcher"},"×")],8,b7),n.isExpanded?(L(),B("div",A7,[e[18]||(e[18]=d("div",{class:"beta-warning"},[d("strong",null,"⚠️ BETA WARNING:"),we(" This debug tool is not working correctly and should be used with caution. It may not properly switch roles or could cause unexpected behavior. ")],-1)),d("div",T7,[e[8]||(e[8]=d("strong",null,"Current User:",-1)),we(" "+Z(((a=n.currentUser)==null?void 0:a.name)||((o=n.currentUser)==null?void 0:o.email)||"Unknown")+" ",1),e[9]||(e[9]=d("br",null,null,-1)),e[10]||(e[10]=d("strong",null,"Role:",-1)),e[11]||(e[11]=we()),d("span",{class:Xe("role-"+((l=n.currentUser)==null?void 0:l.role))},Z(((c=n.currentUser)==null?void 0:c.role)||"None"),3),e[12]||(e[12]=d("br",null,null,-1)),e[13]||(e[13]=d("strong",null,"UID:",-1)),we(" "+Z(((u=n.currentUser)==null?void 0:u.uid)||"None"),1)]),d("div",w7,[e[15]||(e[15]=d("label",{for:"role-select"},"Switch to Role:",-1)),Ne(d("select",{id:"role-select","onUpdate:modelValue":e[2]||(e[2]=f=>n.selectedRole=f),onChange:e[3]||(e[3]=(...f)=>n.switchRole&&n.switchRole(...f))},[e[14]||(e[14]=d("option",{value:""},"-- Select Role --",-1)),(L(!0),B(De,null,$e(n.availableRoles,f=>(L(),B("option",{key:f.value,value:f.value},Z(f.label),9,C7))),128))],544),[[sr,n.selectedRole]])]),d("div",I7,[e[16]||(e[16]=d("h5",null,"Quick Test Users:",-1)),d("div",k7,[(L(!0),B(De,null,$e(n.testUsers,f=>{var h;return L(),B("button",{key:f.uid,onClick:p=>n.switchToUser(f),class:Xe(["test-user-btn",{active:((h=n.currentUser)==null?void 0:h.uid)===f.uid}])},[we(Z(f.name)+" ",1),d("small",null,"("+Z(f.role)+")",1)],10,D7)}),128))])]),d("div",P7,[e[17]||(e[17]=d("h5",null,"Current Permissions:",-1)),n.loadingPermissions?(L(),B("div",R7," Loading permissions... ")):(L(),B("div",F7,[(L(!0),B(De,null,$e(n.currentPermissions,f=>(L(),B("div",{key:f.action,class:Xe(["permission-item",{granted:f.granted}])},[d("span",N7,Z(f.granted?"✅":"❌"),1),we(" "+Z(f.label),1)],2))),128))]))]),e[19]||(e[19]=Rn('<div class="testing-scenarios" data-v-26d536da><h5 data-v-26d536da>🧪 Testing Scenarios:</h5><div class="scenario-list" data-v-26d536da><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Students Page:</strong><ul data-v-26d536da><li data-v-26d536da>✅ Can view students</li><li data-v-26d536da>✅ Can edit own caseload (CM)</li><li data-v-26d536da>✅ Can edit all students (Admin)</li><li data-v-26d536da>✅ Paraeducator filter works</li></ul></div><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Admin Panel:</strong><ul data-v-26d536da><li data-v-26d536da>✅ Users management</li><li data-v-26d536da>✅ Permissions matrix</li><li data-v-26d536da>✅ Aide assignments</li><li data-v-26d536da>✅ App settings</li></ul></div><div class="scenario-item" data-v-26d536da><strong data-v-26d536da>Navigation:</strong><ul data-v-26d536da><li data-v-26d536da>✅ Admin button visibility</li><li data-v-26d536da>✅ My Schedule button (Para)</li><li data-v-26d536da>✅ Role-based menu items</li></ul></div></div></div>',1)),d("div",O7,[d("button",{onClick:e[4]||(e[4]=(...f)=>n.resetToRealUser&&n.resetToRealUser(...f)),class:"reset-btn"}," 🔄 Reset to Real User "),d("button",{onClick:e[5]||(e[5]=(...f)=>n.refreshPage&&n.refreshPage(...f)),class:"refresh-btn"}," 🔄 Refresh Page ")])])):_e("",!0)],2)):_e("",!0)}const L7=St(_7,[["render",M7],["__scopeId","data-v-26d536da"]]),B7={key:0,class:"debug-access-info"},U7={__name:"DebugAccessInfo",setup(t){const e=on(),r=se(!1),n=Se(()=>e.currentUser),s=Se(()=>{var o;const a=(o=n.value)==null?void 0:o.role;return["admin","administrator"].includes(a)}),i=()=>{r.value=!1,localStorage.setItem("debug-info-hidden","true")};return Gt(()=>{const a=localStorage.getItem("debug-info-hidden");s.value&&!a&&setTimeout(()=>{r.value=!0},3e3)}),(a,o)=>r.value?(L(),B("div",B7,[d("div",{class:"debug-info-content"},[o[0]||(o[0]=d("span",{class:"debug-info-icon"},"🔧",-1)),o[1]||(o[1]=d("span",{class:"debug-info-text"},[we("Debug tools available - Press "),d("kbd",null,"Ctrl+Shift+D")],-1)),d("button",{onClick:i,class:"debug-info-close"},"×")])])):_e("",!0)}},$7=St(U7,[["__scopeId","data-v-358a31dd"]]);class V7{constructor(){this.timeoutId=null,this.warningTimeoutId=null,this.isEnabled=se(!1),this.timeoutMinutes=se(30),this.showWarning=se(!1),this.warningCountdown=se(0),this.lastActivity=Date.now(),this.lastLogTime=null,this.router=null,this.unsubscribeSettings=null,this.activityEvents=["mousedown","keypress","scroll","touchstart","click","keydown"],this.init()}init(){console.log("🔧 Session timeout system initialization STARTED"),this.loadSettings(),this.setupActivityListeners(),this.setupAuthWatcher()}setupAuthWatcher(){K1(Et,e=>{e?setTimeout(()=>{this.resetTimeout()},1e3):(this.clearTimeouts(),this.hideWarning())})}async loadSettings(){try{const e=Ze(qe,"app_settings","security"),r=await qt(e);if(r.exists()){const n=r.data();this.isEnabled.value=n.sessionTimeoutEnabled||!1,this.timeoutMinutes.value=n.sessionTimeoutMinutes||30,Et.currentUser&&this.resetTimeout()}else this.isEnabled.value=!1,this.timeoutMinutes.value=30;console.log(`🔧 Session timeout settings loaded: enabled=${this.isEnabled.value}, timeout=${this.timeoutMinutes.value}min`)}catch(e){console.error("Failed to load session timeout settings:",e)}}async updateSettings(e,r){var n;try{const s=Ze(qe,"app_settings","security");await jt(s,{sessionTimeoutEnabled:e,sessionTimeoutMinutes:r,updatedAt:new Date().toISOString(),updatedBy:(n=Et.currentUser)==null?void 0:n.uid},{merge:!0}),this.isEnabled.value=e,this.timeoutMinutes.value=r,console.log(`✅ Session timeout settings updated: enabled=${e}, timeout=${r}min`),Et.currentUser&&this.resetTimeout()}catch(s){console.error("Failed to update session timeout settings:",s)}}setupActivityListeners(){this.boundActivityHandler=this.handleActivity.bind(this),this.activityEvents.forEach(e=>{document.addEventListener(e,this.boundActivityHandler,!0)})}handleActivity(){if(!this.isEnabled.value||!Et.currentUser)return;const e=Date.now();if(e-this.lastActivity<3e4){this.lastActivity=e;return}this.lastActivity=e,console.log("🔄 Activity detected - resetting session timeout"),this.resetTimeout(),this.showWarning.value&&this.hideWarning()}resetTimeout(){if(!this.isEnabled.value||!Et.currentUser){console.log("⚠️ Session timeout disabled or no user - skipping reset");return}this.clearTimeouts();const e=Math.round(this.timeoutMinutes.value*60*1e3),r=Math.max(5e3,e-2*60*1e3);console.log(`🔒 Session timeout reset: ${this.timeoutMinutes.value} minutes (${e}ms), warning in ${r}ms`),this.warningTimeoutId=setTimeout(()=>{console.log("🚨 Showing session warning"),this.showSessionWarning()},r),this.timeoutId=setTimeout(()=>{console.log("⏰ Session timeout triggered - logging out user"),this.handleSessionTimeout()},e)}showSessionWarning(){if(this.showWarning.value)return;this.showWarning.value=!0,this.warningCountdown.value=Math.min(120,Math.floor(this.timeoutMinutes.value*60/2)),console.log(`🚨 Session warning displayed, countdown: ${this.warningCountdown.value} seconds`);const e=setInterval(()=>{this.warningCountdown.value--,this.warningCountdown.value<=0&&(clearInterval(e),this.handleSessionTimeout())},1e3);this.countdownInterval=e}hideWarning(){this.showWarning.value=!1,this.warningCountdown.value=0,this.countdownInterval&&(clearInterval(this.countdownInterval),this.countdownInterval=null)}async handleSessionTimeout(){console.log("🔒 Handling session timeout");try{if(Et.currentUser){const e=Ze(qe,"auditLogs",`timeout_${Date.now()}_${Et.currentUser.uid}`);await jt(e,{type:"session_timeout",userId:Et.currentUser.uid,userEmail:Et.currentUser.email,timeoutMinutes:this.timeoutMinutes.value,lastActivity:new Date(this.lastActivity),timestamp:new Date,userAgent:navigator.userAgent})}this.clearTimeouts(),this.hideWarning(),console.log("🚨 SESSION TIMEOUT LOGOUT: About to call signOut()"),console.log("🔍 Session timeout stack trace:",new Error().stack),await lp(Et),console.log("🚪 User signed out due to session timeout"),this.router?this.router.push("/login"):window.location.href="/login"}catch(e){console.error("Error during session timeout:",e),window.location.href="/login"}}extendSession(){this.hideWarning(),this.resetTimeout()}clearTimeouts(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),this.warningTimeoutId&&(clearTimeout(this.warningTimeoutId),this.warningTimeoutId=null)}setRouter(e){this.router=e}destroy(){this.clearTimeouts(),this.hideWarning(),this.boundActivityHandler&&this.activityEvents.forEach(e=>{document.removeEventListener(e,this.boundActivityHandler,!0)})}}const Zs=new V7;function Yy(){const t=ki();return Zs.setRouter(t),{isEnabled:Zs.isEnabled,timeoutMinutes:Zs.timeoutMinutes,showWarning:Zs.showWarning,warningCountdown:Zs.warningCountdown,updateSettings:Zs.updateSettings.bind(Zs),extendSession:Zs.extendSession.bind(Zs),resetTimeout:Zs.resetTimeout.bind(Zs)}}/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V_=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),H7=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),j7=t=>{const e=H7(t);return e.charAt(0).toUpperCase()+e.slice(1)},G7=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim();/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W7=({size:t,strokeWidth:e=2,absoluteStrokeWidth:r,color:n,iconNode:s,name:i,class:a,...o},{slots:l})=>el("svg",{...jf,width:t||jf.width,height:t||jf.height,stroke:n||jf.stroke,"stroke-width":r?Number(e)*24/Number(t):e,class:G7("lucide",...i?[`lucide-${V_(j7(i))}-icon`,`lucide-${V_(i)}`]:["lucide-icon"]),...o},[...s.map(c=>el(...c)),...l.default?[l.default()]:[]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=(t,e)=>(r,{slots:n})=>el(W7,{...r,iconNode:e,name:t},n);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z7=vt("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K7=vt("arrow-down-wide-narrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=vt("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q7=vt("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X7=vt("brain",[["path",{d:"M12 18V5",key:"adv99a"}],["path",{d:"M15 13a4.17 4.17 0 0 1-3-4 4.17 4.17 0 0 1-3 4",key:"1e3is1"}],["path",{d:"M17.598 6.5A3 3 0 1 0 12 5a3 3 0 1 0-5.598 1.5",key:"1gqd8o"}],["path",{d:"M17.997 5.125a4 4 0 0 1 2.526 5.77",key:"iwvgf7"}],["path",{d:"M18 18a4 4 0 0 0 2-7.464",key:"efp6ie"}],["path",{d:"M19.967 17.483A4 4 0 1 1 12 18a4 4 0 1 1-7.967-.517",key:"1gq6am"}],["path",{d:"M6 18a4 4 0 0 1-2-7.464",key:"k1g0md"}],["path",{d:"M6.003 5.125a4 4 0 0 0-2.526 5.77",key:"q97ue3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y7=vt("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rI=vt("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nI=vt("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=vt("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q7=vt("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cm=vt("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J7=vt("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=vt("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sI=vt("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z7=vt("columns-2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H_=vt("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=vt("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ku=vt("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=vt("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=vt("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=vt("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=vt("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Im=vt("hand-heart",[["path",{d:"M11 14h2a2 2 0 0 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 16",key:"1v1a37"}],["path",{d:"m14.45 13.39 5.05-4.694C20.196 8 21 6.85 21 5.75a2.75 2.75 0 0 0-4.797-1.837.276.276 0 0 1-.406 0A2.75 2.75 0 0 0 11 5.75c0 1.2.802 2.248 1.5 2.946L16 11.95",key:"fhfbnt"}],["path",{d:"m2 15 6 6",key:"10dquu"}],["path",{d:"m7 20 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a1 1 0 0 0-2.75-2.91",key:"1x6kdw"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=vt("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=vt("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=vt("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=vt("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=vt("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=vt("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aI=vt("message-square",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=vt("monitor-speaker",[["path",{d:"M5.5 20H8",key:"1k40s5"}],["path",{d:"M17 9h.01",key:"1j24nn"}],["rect",{width:"10",height:"16",x:"12",y:"4",rx:"2",key:"ixliua"}],["path",{d:"M8 6H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h4",key:"1mp6e1"}],["circle",{cx:"17",cy:"15",r:"1",key:"tqvash"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=vt("palette",[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j_=vt("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=vt("presentation",[["path",{d:"M2 3h20",key:"91anmk"}],["path",{d:"M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3",key:"2k9sn8"}],["path",{d:"m7 21 5-5 5 5",key:"bip4we"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=vt("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=vt("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=vt("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iI=vt("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=vt("school",[["path",{d:"M14 22v-4a2 2 0 1 0-4 0v4",key:"hhkicm"}],["path",{d:"m18 10 3.447 1.724a1 1 0 0 1 .553.894V20a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-7.382a1 1 0 0 1 .553-.894L6 10",key:"1xqip1"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"m4 6 7.106-3.553a2 2 0 0 1 1.788 0L20 6",key:"9d2mlk"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oI=vt("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=vt("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uv=vt("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=vt("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lI=vt("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=vt("test-tube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qo=vt("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=vt("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=vt("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=vt("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cI=vt("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=vt("user-pen",[["path",{d:"M11.5 15H7a4 4 0 0 0-4 4v2",key:"15lzij"}],["path",{d:"M21.378 16.626a1 1 0 0 0-3.004-3.004l-4.01 4.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1817ys"}],["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uI=vt("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=vt("user-search",[["circle",{cx:"10",cy:"7",r:"4",key:"e45bow"}],["path",{d:"M10.3 15H7a4 4 0 0 0-4 4v2",key:"3bnktk"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["path",{d:"m21 21-1.9-1.9",key:"1g2n9r"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=vt("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zl=vt("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=vt("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dI=vt("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-vue-next v0.535.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=vt("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),SB={key:0,class:"session-timeout-overlay"},AB={class:"session-timeout-dialog"},TB={class:"dialog-header"},wB={class:"dialog-content"},CB={class:"countdown-section"},IB={class:"countdown-time"},kB={class:"info-note"},DB={class:"dialog-actions"},PB={__name:"SessionTimeoutDialog",setup(t){const e=ki(),{showWarning:r,warningCountdown:n,extendSession:s}=Yy(),i=o=>{const l=Math.floor(o/60),c=o%60;return`${l}:${c.toString().padStart(2,"0")}`},a=async()=>{try{await lp(Et),e.push("/login")}catch(o){console.error("Error signing out:",o)}};return(o,l)=>q(r)?(L(),B("div",SB,[d("div",AB,[d("div",TB,[Pe(q(sI),{class:"header-icon",size:24}),l[1]||(l[1]=d("h3",null,"Session Timeout",-1))]),d("div",wB,[d("div",CB,[d("div",IB,Z(i(q(n))),1),l[2]||(l[2]=d("p",{class:"countdown-label"},"until automatic logout",-1))]),d("div",kB,[Pe(q(iB),{size:16}),l[3]||(l[3]=d("span",null,"Any activity will extend your session",-1))])]),d("div",DB,[d("button",{onClick:l[0]||(l[0]=(...c)=>q(s)&&q(s)(...c)),class:"btn btn-primary"},[Pe(q(I0),{size:16}),l[4]||(l[4]=we(" Stay Logged In "))]),d("button",{onClick:a,class:"btn btn-secondary"},[Pe(q(cB),{size:16}),l[5]||(l[5]=we(" Logout Now "))])])])])):_e("",!0)}},RB=St(PB,[["__scopeId","data-v-9d2333fd"]]),cu={primaryColor:"#1976d2",primaryHover:"#1565c0",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",secondaryColor:"#6c757d",secondaryHover:"#545b62",secondaryLight:"#f8f9fa",secondaryDark:"#495057",bgPrimary:"#f4f6f9",bgSecondary:"#ffffff",bgTertiary:"#f8f9fa",bgMuted:"#e9ecef",textPrimary:"#333333",textSecondary:"#666666",textMuted:"#999999",textInverse:"#ffffff",headerTextColor:"#1a1a1a",accentColor:"#e3f2fd",borderColor:"#dee2e6",borderLight:"#e9ecef",borderDark:"#adb5bd",borderFocus:"#1976d2",successColor:"#28a745",successHover:"#218838",successLight:"#d4edda",warningColor:"#ffc107",warningHover:"#e0a800",warningLight:"#fff3cd",errorColor:"#dc3545",errorHover:"#c82333",errorLight:"#f8d7da",infoColor:"#17a2b8",infoHover:"#138496",infoLight:"#d1ecf1",adminTabBg:"#f8f9fa",adminTabActive:"#2a79c9",adminTabHover:"#e3eaf6",tableHeaderBg:"#dfe7f3",tableStripeBg:"#f8fafd",tableBorder:"#d1d1d1",tableHover:"#f0f0f0",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",shadowSm:"0 1px 2px rgba(0, 0, 0, 0.05)",shadowMd:"0 2px 4px rgba(0, 0, 0, 0.1)",shadowLg:"0 4px 6px rgba(0, 0, 0, 0.1)",shadowXl:"0 4px 20px rgba(0, 0, 0, 0.3)",fontFamilyBase:"'Inter', 'Segoe UI', 'Arial', sans-serif",fontSizeXs:"0.75rem",fontSizeSm:"0.875rem",fontSizeBase:"1rem",fontSizeLg:"1.125rem",fontSizeXl:"1.25rem",fontSizeXxl:"1.5rem",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"standard",lineHeight:"1.5"},G_={primaryColor:"--primary-color",primaryHover:"--primary-hover",primaryLight:"--primary-light",primaryDark:"--primary-dark",secondaryColor:"--secondary-color",secondaryHover:"--secondary-hover",secondaryLight:"--secondary-light",secondaryDark:"--secondary-dark",bgPrimary:"--bg-primary",bgSecondary:"--bg-secondary",bgTertiary:"--bg-tertiary",bgMuted:"--bg-muted",textPrimary:"--text-primary",textSecondary:"--text-secondary",textMuted:"--text-muted",textInverse:"--text-inverse",headerTextColor:"--header-text-color",accentColor:"--accent-color",borderColor:"--border-color",borderLight:"--border-light",borderDark:"--border-dark",borderFocus:"--border-focus",successColor:"--success-color",successHover:"--success-hover",successLight:"--success-light",warningColor:"--warning-color",warningHover:"--warning-hover",warningLight:"--warning-light",errorColor:"--error-color",errorHover:"--error-hover",errorLight:"--error-light",infoColor:"--info-color",infoHover:"--info-hover",infoLight:"--info-light",adminTabBg:"--admin-tab-bg",adminTabActive:"--admin-tab-active",adminTabHover:"--admin-tab-hover",tableHeaderBg:"--table-header-bg",tableStripeBg:"--table-stripe-bg",tableBorder:"--table-border",tableHover:"--table-hover",borderRadiusSm:"--border-radius-sm",borderRadiusMd:"--border-radius-md",borderRadiusLg:"--border-radius-lg",borderRadiusXl:"--border-radius-xl",shadowSm:"--shadow-sm",shadowMd:"--shadow-md",shadowLg:"--shadow-lg",shadowXl:"--shadow-xl",fontFamilyBase:"--font-family-base",fontSizeXs:"--font-size-xs",fontSizeSm:"--font-size-sm",fontSizeBase:"--font-size-base",fontSizeLg:"--font-size-lg",fontSizeXl:"--font-size-xl",fontSizeXxl:"--font-size-xxl",lineHeight:"--line-height-base"};function fI(){const t=se({...cu}),e=se(!1),r=se(null),n=se(!1),s=async()=>{if(e.value)return t.value;e.value=!0,r.value=null;try{const g=Ze(qe,"app_settings","theme"),y=await qt(g);if(y.exists()){const E=y.data();t.value={...cu,...E},console.log("Theme loaded from database:",t.value)}else t.value={...cu},console.log("No saved theme found, using defaults");return n.value=!0,a(t.value),t.value}catch(g){throw r.value=g.message,console.error("Error loading theme:",g),g}finally{e.value=!1}},i=async(g=t.value)=>{e.value=!0,r.value=null;try{const y=Ze(qe,"app_settings","theme");return await jt(y,{...g,lastUpdated:new Date().toISOString()}),t.value={...g},a(g),console.log("Theme saved successfully"),!0}catch(y){throw r.value=y.message,console.error("Error saving theme:",y),y}finally{e.value=!1}},a=g=>{const y=document.documentElement;Object.entries(G_).forEach(([E,b])=>{g[E]!==void 0&&y.style.setProperty(b,g[E])})},o=(g,y)=>{t.value[g]=y,a(t.value)},l=async()=>{t.value={...cu},a(t.value),await i(t.value)},c=g=>{a(g)},u=()=>{a(t.value)},f=g=>getComputedStyle(document.documentElement).getPropertyValue(g),h=g=>/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$|^rgb\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*\)$|^rgba\(\s*\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*[\d.]+\s*\)$/.test(g),p=g=>({light:g,dark:g,hover:g});return Gt(()=>{n.value||s()}),{currentTheme:t,loading:e,error:r,isInitialized:n,loadTheme:s,saveTheme:i,applyTheme:a,updateThemeProperty:o,resetTheme:l,previewTheme:c,revertTheme:u,getCssVariableValue:f,validateColor:h,generateColorVariations:p,CSS_VARIABLE_MAP:G_,DEFAULT_THEME:cu}}function FB(){const{loadTheme:t,currentTheme:e,isInitialized:r}=fI();return Gt(async()=>{if(!r.value)try{await t(),console.log("Theme initialized successfully")}catch(n){console.error("Failed to initialize theme:",n)}}),{currentTheme:e,isInitialized:r}}const NB={id:"app"},OB={id:"main-content"},MB={__name:"App",setup(t){const e=se(!1);FB();const r=n=>{n.ctrlKey&&n.shiftKey&&n.key==="D"&&(n.preventDefault(),e.value=!e.value,console.log("Debug Role Switcher:",e.value?"Shown":"Hidden"))};return Gt(()=>{document.addEventListener("keydown",r)}),ja(()=>{document.removeEventListener("keydown",r)}),(n,s)=>{const i=_r("router-view");return L(),B("div",NB,[d("div",OB,[Pe(i)]),e.value?(L(),Jt(L7,{key:0})):_e("",!0),Pe($7),Pe(RB)])}}},LB="modulepreload",BB=function(t){return"/"+t},W_={},ua=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=BB(l),l in W_)return;W_[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":LB,c||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((h,p)=>{f.addEventListener("load",h),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})};function qr(t,e=255){return typeof t!="string"?"":t.trim().replace(/\0/g,"").replace(/[<>'"&]/g,"").substring(0,e)}function UB(t){return typeof t!="string"?"":t.trim().toLowerCase().substring(0,255)}function z_(t,e=0,r=999999){const n=parseFloat(t);return isNaN(n)?0:Math.max(e,Math.min(r,n))}function D0(t,e){return!t||typeof t=="string"&&t.trim()===""?{isValid:!1,error:`${e} is required`}:{isValid:!0}}function $B(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?{isValid:!0}:{isValid:!1,error:"Invalid email format"}}function Cd(t,e,r=0,n=255){return typeof t!="string"?{isValid:!1,error:`${e} must be a string`}:t.length<r?{isValid:!1,error:`${e} must be at least ${r} characters`}:t.length>n?{isValid:!1,error:`${e} must be no more than ${n} characters`}:{isValid:!0}}function VB(t){return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair","case_manager","teacher","service_provider","paraeducator"].includes(t)?{isValid:!0}:{isValid:!1,error:"Invalid role"}}function HB(t,e=[],r=10*1024*1024){return t?e.length>0&&!e.includes(t.type)?{isValid:!1,error:`Invalid file type. Allowed: ${e.join(", ")}`}:t.size>r?{isValid:!1,error:`File too large. Maximum size: ${r/(1024*1024)}MB`}:[/\.exe$/i,/\.bat$/i,/\.cmd$/i,/\.scr$/i,/\.vbs$/i,/\.js$/i,/\.jar$/i].some(s=>s.test(t.name))?{isValid:!1,error:"Suspicious file type detected"}:{isValid:!0}:{isValid:!1,error:"No file selected"}}function Hr(t){if(typeof t!="string")return{isSafe:!0,threats:[]};const e=[];return/<script|javascript:|vbscript:|onload=|onerror=/i.test(t)&&e.push("Script injection attempt"),/(\bunion\b|\bselect\b|\binsert\b|\bupdate\b|\bdelete\b|\bdrop\b).*(\bfrom\b|\binto\b|\bwhere\b)/i.test(t)&&e.push("SQL injection pattern"),/\.\.\/|\.\.\\|%2e%2e%2f|%2e%2e%5c/i.test(t)&&e.push("Path traversal attempt"),/<[^>]*>/i.test(t)&&e.push("HTML injection attempt"),/\0/.test(t)&&e.push("Null byte injection"),{isSafe:e.length===0,threats:e}}const Ol={};function Rs(t,e=10,r=6e4){const n=Date.now(),s=`${t}_${Math.floor(n/r)}`;return Ol[s]||(Ol[s]=0),Ol[s]++,Ol[s]>e?{allowed:!1,error:`Rate limit exceeded. Maximum ${e} requests per ${r/1e3} seconds.`}:(Object.keys(Ol).forEach(i=>{const a=parseInt(i.split("_").pop())*r;n-a>r*2&&delete Ol[i]}),{allowed:!0})}function hI(t,e={}){const r=[],{isNew:n=!1}=e;if(!t||typeof t!="object")return{isValid:!1,errors:["Invalid student data"]};if(!t.app||!t.app.studentData)return r.push("Student data structure is invalid"),{isValid:!1,errors:r};const s=t.app.studentData;return[{field:"firstName",name:"First Name"},{field:"lastName",name:"Last Name"},{field:"caseManagerId",name:"Case Manager"}].forEach(({field:l,name:c})=>{const u=D0(s[l],c);u.isValid||r.push(u.error)}),[{field:"firstName",name:"First Name",maxLength:100},{field:"lastName",name:"Last Name",maxLength:100},{field:"studentId",name:"Student ID",maxLength:50},{field:"grade",name:"Grade",maxLength:10}].forEach(({field:l,name:c,maxLength:u})=>{if(s[l]){const f=Cd(s[l],c,1,u);f.isValid||r.push(f.error)}}),["firstName","lastName","studentId","grade"].forEach(l=>{if(s[l]){const c=Hr(s[l]);c.isSafe||r.push(`Security threat detected in ${l}: ${c.threats.join(", ")}`)}}),t.app.accommodations&&typeof t.app.accommodations!="string"&&t.app.accommodations!==null&&r.push("Accommodations must be encrypted string or null"),t.app.classServices&&typeof t.app.classServices!="string"&&t.app.classServices!==null&&r.push("Class services must be encrypted string or null"),s.plan&&typeof s.plan!="string"&&s.plan!==null&&r.push("Student plan must be encrypted string or null"),{isValid:r.length===0,errors:r}}function jB(t){const e=[];if(!t||typeof t!="object")return{isValid:!1,errors:["Invalid user data"]};const r=D0(t.name,"Name");r.isValid||e.push(r.error);const n=D0(t.email,"Email");n.isValid||e.push(n.error);const s=D0(t.role,"Role");if(s.isValid||e.push(s.error),t.email){const a=$B(t.email);a.isValid||e.push(a.error)}if(t.role){const a=VB(t.role);a.isValid||e.push(a.error)}if(t.name){const a=Cd(t.name,"Name",1,100);a.isValid||e.push(a.error)}if(t.email){const a=Cd(t.email,"Email",1,255);a.isValid||e.push(a.error)}return["name","email"].forEach(a=>{if(t[a]){const o=Hr(t[a]);o.isSafe||e.push(`Security threat detected in ${a}: ${o.threats.join(", ")}`)}}),{isValid:e.length===0,errors:e}}function pI(t){const e={...t};if(e.app&&e.app.studentData){const r=e.app.studentData;["firstName","lastName","studentId","grade"].forEach(s=>{r[s]&&(r[s]=qr(r[s],100))})}else["firstName","lastName","studentId","grade"].forEach(n=>{e[n]&&(e[n]=qr(e[n],100))});return e}function GB(t){const e={...t};return e.name&&(e.name=qr(e.name,100)),e.email&&(e.email=UB(e.email)),e}const WB=async(t,e,r=100,n=1e3)=>{const s=[];for(let a=0;a<t.length;a+=r)s.push(t.slice(a,a+r));const i=[];for(let a=0;a<s.length;a++)try{const o=await e(s[a]);i.push(o),a<s.length-1&&await new Promise(l=>setTimeout(l,n))}catch(o){throw console.error(`Error in batch ${a+1}:`,o),o}return i},ol=HB;function _h(t){if(!t||typeof t!="object")return t;if(t.toJSON&&typeof t.toJSON=="function")return t.toJSON();if(Array.isArray(t))return t.map(_h);const e={};for(const[r,n]of Object.entries(t)){if(r.toLowerCase().includes("schedule")&&typeof n=="object"&&n!==null)for(const[s,i]of Object.entries(n))i&&typeof i=="object"&&i.teacherId!==void 0&&(n[s].teacherId=String(i.teacherId));e[r]=_h(n)}return e}const ea=se([]);let km=null;function Di(){async function t(){if(!km)try{const{useGoogleSheetsRealtime:o}=await ua(async()=>{const{useGoogleSheetsRealtime:l}=await Promise.resolve().then(()=>hfe);return{useGoogleSheetsRealtime:l}},void 0);km=o()}catch(o){console.error("Failed to load Google Sheets sync:",o)}return km}async function e(){const o=await zt(At(qe,"students"));ea.value=o.docs.map(l=>{const c=l.data(),u=_h(c);return{id:l.id,...u}})}function r(o){ea.value=o.map(l=>{const c=_h(l);return{id:l.id,...c}})}async function n(){return(await zt(At(qe,"students"))).docs.map(l=>({id:l.id,...l.data()}))}async function s(o,l){await Fp(Ze(qe,"students",o),l);try{const c=await t();if(c&&c.linkedSheetId.value){const u=ea.value.findIndex(f=>f.id===o);u!==-1&&(ea.value[u]={...ea.value[u],...l}),await c.updateSheetData(ea.value)}}catch(c){console.error("Failed to sync to Google Sheets:",c)}}async function i(o){var c,u,f,h,p,g,y;const l=ea.value.find(E=>E.id===o);await mo(Ze(qe,"students",o)),await sn.logStudentAccess(o,"delete",{studentName:l?`${((u=(c=l.app)==null?void 0:c.studentData)==null?void 0:u.firstName)||""} ${((h=(f=l.app)==null?void 0:f.studentData)==null?void 0:h.lastName)||""}`.trim():"Unknown",ssid:(g=(p=l==null?void 0:l.app)==null?void 0:p.studentData)==null?void 0:g.ssid,deletedFields:l?Object.keys(((y=l.app)==null?void 0:y.studentData)||{}):[]});try{const E=await t();E&&E.linkedSheetId.value&&(ea.value=ea.value.filter(b=>b.id!==o),await E.updateSheetData(ea.value))}catch(E){console.error("Failed to sync to Google Sheets:",E)}}return{students:ea,fetchStudents:e,setStudents:r,fetchAllStudents:n,updateStudent:s,deleteStudent:i,deleteAllStudents:async()=>{try{const l=(await zt(At(qe,"students"))).docs;return await sn.logStudentAccess("bulk_operation","delete_all",{studentCount:l.length,operation:"bulk_delete_all_students",deletedStudentIds:l.map(c=>c.id)}),await WB(l,async c=>{const u=Ly(qe);c.forEach(f=>{u.delete(f.ref)}),await u.commit()},50,2e3),{success:!0}}catch(o){throw console.error("Error deleting all students:",o),await sn.logStudentAccess("bulk_operation","delete_all_failed",{error:o.message,operation:"bulk_delete_all_students_failed"}),o}}}}function ba(){const t=se({}),e=se([]);async function r(){console.log("🔍 USERS DEBUG: Starting fetchUsers()");try{const a=await zt(At(qe,"users"));console.log("🔍 USERS DEBUG: Retrieved",a.size,"users from database");const o={},l=[];a.forEach(u=>{const f=u.data();o[u.id]={id:u.id,...f},l.push({id:u.id,...f})}),t.value=o,e.value=l,console.log("🔍 USERS DEBUG: Processed users by role:");const c={};l.forEach(u=>{c[u.role]=(c[u.role]||0)+1}),console.log("🔍 USERS DEBUG: Role counts:",c),console.log("🔍 USERS DEBUG: All users list:",l.map(u=>({id:u.id,name:u.name,email:u.email,role:u.role}))),console.log("🔍 USERS DEBUG: fetchUsers() completed successfully")}catch(a){throw console.error("🔴 USERS DEBUG: Error in fetchUsers():",a),a}}const n=Se(()=>{const a=o=>o.sort((l,c)=>(l.name||l.email||l.id).localeCompare(c.name||c.email||c.id));return{teachers:a(e.value.filter(o=>["teacher","case_manager","sped_chair"].includes(o.role))),caseManagers:a(e.value.filter(o=>["case_manager","sped_chair","admin_504"].includes(o.role))),speech:a(e.value.filter(o=>o.provider==="SLP")),ot:a(e.value.filter(o=>o.provider==="OT")),mh:a(e.value.filter(o=>o.provider==="MH")),pt:a(e.value.filter(o=>o.provider==="PT")),sc:a(e.value.filter(o=>o.provider==="SC")),tr:a(e.value.filter(o=>o.provider==="TR")),aud:a(e.value.filter(o=>o.provider==="AUD")),vi:a(e.value.filter(o=>o.provider==="VI")),at:a(e.value.filter(o=>o.provider==="AT")),dhh:a(e.value.filter(o=>o.provider==="DHH")),om:a(e.value.filter(o=>o.provider==="O&M")),bis:a(e.value.filter(o=>o.provider==="BIS")),hn:a(e.value.filter(o=>o.provider==="HN")),sw:a(e.value.filter(o=>o.provider==="SW"))}}),s=Se(()=>e.value.filter(a=>["case_manager","sped_chair","admin_504"].includes(a.role)).sort((a,o)=>(a.name||a.email||a.id).localeCompare(o.name||o.email||o.id))),i=Se(()=>e.value.filter(a=>["teacher","case_manager","sped_chair"].includes(a.role)).sort((a,o)=>(a.name||a.email||a.id).localeCompare(o.name||o.email||o.id)));return{users:t,userList:e,fetchUsers:r,caseManagers:s,teacherList:i,userRoles:n}}function Jy(){const t=se({}),e=se(!1);async function r(){e.value=!0;try{const h=await zt(At(qe,"aideSchedules")),p={};h.forEach(g=>{p[g.id]=g.data()}),t.value=p}catch(h){console.error("Error loading aide assignments:",h),t.value={}}finally{e.value=!1}}async function n(h){if(!h){console.warn("loadAideAssignment called without aideId");return}e.value=!0;try{const p=await qt(Ze(qe,"aideSchedules",h));p.exists()?t.value[h]=p.data():t.value[h]={classAssignment:{},directAssignment:[]}}catch(p){console.error("Error loading aide assignment:",p),t.value[h]={classAssignment:{},directAssignment:[]}}finally{e.value=!1}}async function s(h,p){try{const g=JSON.parse(JSON.stringify(p));await jt(Ze(qe,"aideSchedules",h),g,{merge:!0}),t.value[h]=g}catch(g){throw console.error("Error saving aide assignment:",g),g}}async function i(){try{const h=Object.entries(t.value);for(const[p,g]of h){const y=JSON.parse(JSON.stringify(g));await jt(Ze(qe,"aideSchedules",p),y,{merge:!0})}}catch(h){throw console.error("Error saving all aide assignments:",h),h}}function a(h,p){const g=[];return Object.entries(t.value).forEach(([y,E])=>{E.classAssignment&&E.classAssignment[p]&&(Array.isArray(E.classAssignment[p])?E.classAssignment[p]:[E.classAssignment[p]]).includes(h)&&g.push(y)}),g}function o(h){var g;const p=(g=t.value[h])==null?void 0:g.directAssignment;return Array.isArray(p)?p.length>0?p[0]:null:p||null}function l(h){return Object.keys(t.value).find(g=>{var E;const y=(E=t.value[g])==null?void 0:E.directAssignment;return Array.isArray(y)?y.includes(h):y===h})||null}function c(h,p,g){const y=[],E=t.value[h];return E&&((Array.isArray(E.directAssignment)?E.directAssignment:E.directAssignment?[E.directAssignment]:[]).forEach(_=>{if(_){const v=p.find(A=>A.id===_);v&&y.push({...v,assignmentType:"direct"})}}),Object.entries(E.classAssignment||{}).forEach(([_,v])=>{v&&(Array.isArray(v)?v:[v]).forEach(D=>{D&&p.forEach(k=>{const T=f(k);if(T){const x=T[_];if((typeof x=="string"?x:x==null?void 0:x.teacherId)===D){const S=y.findIndex(I=>I.id===k.id);S===-1?y.push({...k,assignmentType:"class",period:_,teacherId:D}):(y[S].assignmentType="both",y[S].period=_,y[S].teacherId=D)}}})})})),y}function u(h,p,g,y){if(!h||!p||!g||!y)return!1;const E=g.find(k=>k.id===p);if(!E)return!1;const b=t.value[h];if(!b)return!1;if((Array.isArray(b.directAssignment)?b.directAssignment:b.directAssignment?[b.directAssignment]:[]).includes(p))return!0;const v=f(E);if(!v)return!1;const A=b.classAssignment||{};return Object.entries(v).some(([k,T])=>{const x=typeof T=="string"?T:T==null?void 0:T.teacherId,m=A[k];return!m||!x?!1:(Array.isArray(m)?m:[m]).includes(x)})}function f(h){var p,g,y,E,b;return h.schedule?h.schedule:(g=(p=h.app)==null?void 0:p.schedule)!=null&&g.periods?h.app.schedule.periods:(E=(y=h.aeries)==null?void 0:y.schedule)!=null&&E.periods?h.aeries.schedule.periods:(b=h.aeries)!=null&&b.schedule?h.aeries.schedule:null}return{aideAssignment:Se(()=>t.value),loading:Se(()=>e.value),loadAideAssignments:r,loadAideAssignment:n,saveAideAssignment:s,saveAllAideAssignments:i,getAidesForTeacher:a,getDirectStudentForAide:o,getAideForStudent:l,getStudentsForAide:c,shouldAideSeeStudent:u}}function Zy(){const t=se(!1),e=se(""),r=se("");let n,s,i,a;try{n=fc(),s=Ra(n,"getStudentFeedback"),i=Ra(n,"createFeedbackFormSheet"),a=Ra(n,"createFeedbackFormSheetWithUserAuth")}catch(A){console.warn("Firebase Functions not available:",A),s=()=>Promise.reject(new Error("Functions not available")),i=()=>Promise.reject(new Error("Functions not available")),a=()=>Promise.reject(new Error("Functions not available"))}const o=At(qe,"feedbackForms"),l=se(!1),c=se([]);let u;const f=Se(()=>{var D;return(((D=c.value)==null?void 0:D.filter(k=>k.active!==!1))||[]).sort((k,T)=>{var S,I;const x=(S=k.createdAt)!=null&&S.seconds?new Date(k.createdAt.seconds*1e3):new Date(k.createdAt);return((I=T.createdAt)!=null&&I.seconds?new Date(T.createdAt.seconds*1e3):new Date(T.createdAt))-x})}),h=async A=>{try{t.value=!0,e.value="",console.log("🔄 Creating Google Sheet with personal account for form:",A.title);const D=await i({title:A.title,description:A.description,formUrl:A.formUrl,studentId:A.studentId||null,studentName:A.studentName||null});if(!D.data.success)throw new Error("Failed to create Google Sheet: "+D.data.message);console.log("✅ Google Sheet created:",D.data.spreadsheetUrl);const k={title:A.title,description:A.description,formUrl:A.formUrl,spreadsheetId:D.data.spreadsheetId,spreadsheetUrl:D.data.spreadsheetUrl,userDriveId:D.data.userDriveId,parentFolderId:D.data.parentFolderId,active:!0,createdAt:new Date,createdBy:A.createdBy},T=Ze(o);return await jt(T,k),r.value="Feedback form and Google Sheet created successfully!",{id:T.id,...k}}catch(D){throw console.error("Error creating feedback form:",D),D.message.includes("storage quota exceeded")||D.message.includes("Service account storage quota exceeded")?D.value='❌ Cannot create Google Sheet: Service account has no storage quota. Please use the "Test with Personal Account" button in Google Drive Setup to use your personal Google account instead.':D.message.includes("permission")||D.message.includes("access")?D.value="❌ Permission denied: Please ensure the folder is shared with the service account or use your personal Google account.":D.value=D.message,D}finally{t.value=!1}},p=async(A,D)=>{try{t.value=!0,e.value="";const k=Ze(o,A);await jt(k,{...D,updatedAt:new Date},{merge:!0}),r.value="Feedback form updated successfully!"}catch(k){throw console.error("Error updating feedback form:",k),e.value=k.message,k}finally{t.value=!1}},g=async A=>{try{t.value=!0,e.value="";const D=Ze(o,A);await mo(D),r.value="Feedback form deleted successfully!"}catch(D){throw console.error("Error deleting feedback form:",D),e.value=D.message,D}finally{t.value=!1}},y=()=>{e.value="",r.value=""},E=A=>{const D=A.match(/\/forms\/d\/([a-zA-Z0-9-_]+)/);return D?D[1]:null},b=()=>{try{u=Np(o,A=>{c.value=A.docs.map(D=>({id:D.id,...D.data()})),l.value=!1},A=>{console.warn("Error listening to feedback forms:",A),l.value=!1})}catch(A){console.warn("Error initializing Firestore listeners:",A),l.value=!1}},_=()=>{u&&u()};return Gt(()=>{b()}),ja(()=>{_()}),{isLoading:t,error:e,successMessage:r,formsLoading:l,feedbackForms:c,activeForms:f,createFeedbackForm:h,updateFeedbackForm:p,deleteFeedbackForm:g,clearMessages:y,extractFormId:E,createFeedbackFormWithUserAuth:async(A,D)=>{try{t.value=!0,e.value="",console.log("🔄 Creating Google Sheet with personal account for form:",A.title);const k=await a({title:A.title,description:A.description,formUrl:A.formUrl,studentId:A.studentId||null,studentName:A.studentName||null,accessToken:D});if(!k.data.success)throw new Error("Failed to create Google Sheet: "+k.data.message);console.log("✅ Google Sheet created with personal account:",k.data.spreadsheetUrl);const T={title:A.title,description:A.description,formUrl:A.formUrl,spreadsheetId:k.data.spreadsheetId,spreadsheetUrl:k.data.spreadsheetUrl,driveType:"personal",active:!0,createdAt:new Date,createdBy:A.createdBy},x=Ze(o);return await jt(x,T),r.value="Feedback form and Google Sheet created successfully in your personal Google Drive!",{id:x.id,...T}}catch(k){throw console.error("Error creating feedback form with user auth:",k),k.value=k.message,k}finally{t.value=!1}}}}function zB(){const t=on(),e=se(!1),r=se(null),n=se([]),s=se(0);Se(()=>t.user);const i=Se(()=>{var v;return(v=t.user)==null?void 0:v.role}),a=Se(()=>{var v;return(v=t.user)==null?void 0:v.uid}),o=async()=>{try{const v=cr(At(qe,"students"),vn("app.studentData.lastName","asc"));return(await zt(v)).docs.map(k=>({id:k.id,...k.data()}))}catch(v){console.error("🔴 Admin query error:",v),console.error("🔴 Admin query error details:",v.message,v.code);try{const A=cr(At(qe,"students"));return(await zt(A)).docs.map(T=>({id:T.id,...T.data()}))}catch(A){return console.error("🔴 Fallback query also failed:",A),console.error("🔴 Fallback query error details:",A.message,A.code),[]}}},l=async()=>{try{const v=cr(At(qe,"students"),vn("app.studentData.lastName","asc"));return(await zt(v)).docs.map(D=>({id:D.id,...D.data()}))}catch(v){console.error("🔴 504 Admin query error:",v);try{const A=cr(At(qe,"students"));return(await zt(A)).docs.map(k=>({id:k.id,...k.data()}))}catch(A){return console.error("🔴 504 Admin fallback query failed:",A),[]}}},c=async()=>{try{const v=cr(At(qe,"students"),Ur("app.studentData.plan","==","IEP"),vn("app.studentData.lastName","asc"));return(await zt(v)).docs.map(D=>({id:D.id,...D.data()}))}catch(v){console.error("🔴 SPED Chair query error:",v);try{const A=cr(At(qe,"students"),Ur("app.studentData.plan","==","IEP"));return(await zt(A)).docs.map(k=>({id:k.id,...k.data()}))}catch(A){return console.error("🔴 SPED Chair fallback query failed:",A),[]}}},u=async v=>{try{const A=cr(At(qe,"students"),Ur("app.studentData.caseManagerId","==",v)),k=(await zt(A)).docs.map(I=>({id:I.id,...I.data()})),T=cr(At(qe,"students"),Ur("app.staffIds","array-contains",v)),m=(await zt(T)).docs.map(I=>({id:I.id,...I.data()})),S=[...k];return m.forEach(I=>{S.find(C=>C.id===I.id)||S.push(I)}),S.sort((I,C)=>{var P,R,N,M;const F=((R=(P=I.app)==null?void 0:P.studentData)==null?void 0:R.lastName)||"",W=((M=(N=C.app)==null?void 0:N.studentData)==null?void 0:M.lastName)||"";return F.localeCompare(W)}),S}catch(A){return console.error("🔒 Security: Error loading case manager students:",A),[]}},f=async v=>{try{const A=cr(At(qe,"students"),Ur("app.staffIds","array-contains",v),vn("app.studentData.lastName","asc"));return(await zt(A)).docs.map(k=>({id:k.id,...k.data()}))}catch(A){return console.error("🔒 Security: Error loading teacher students:",A),[]}},h=async v=>{var A;console.log("🔍 Service Provider query: Loading students for provider",v),console.log("🔍 Service Provider query: userId type:",typeof v),console.log("🔍 Service Provider query: userId value:",JSON.stringify(v));try{const D=cr(At(qe,"students"),Ur("app.staffIds","array-contains",v));console.log("🔍 Service Provider query: Executing staffIds query...");const k=await zt(D);console.log("🔍 Service Provider query: Success! Found",k.size,"students");const T=k.docs.map(x=>({id:x.id,...x.data()}));return T.sort((x,m)=>{var C,F,W,P;const S=((F=(C=x.app)==null?void 0:C.studentData)==null?void 0:F.lastName)||"",I=((P=(W=m.app)==null?void 0:W.studentData)==null?void 0:P.lastName)||"";return S.localeCompare(I)}),T}catch(D){console.error("🔴 Service Provider query FAILED:",D);const k=uo();return console.error("🔴 Service Provider auth mismatch - userId:",v,"authUid:",(A=k.currentUser)==null?void 0:A.uid),[]}},p=async v=>{var A;try{try{const I=cr(At(qe,"students"),Ur("app.staffIds","array-contains",v),vn("app.studentData.lastName","asc")),C=await zt(I);if(C.size>0)return C.docs.map(W=>({id:W.id,...W.data()}))}catch{}const D=await qt(Ze(qe,"aideSchedules",v));if(!D.exists())return[];const k=D.data();let T=[];if(k.studentIds&&Array.isArray(k.studentIds)?T=k.studentIds:k.directAssignment&&(T=Array.isArray(k.directAssignment)?k.directAssignment:[k.directAssignment]),T.length===0)return[];const x=T.map(async I=>{try{const C=await qt(Ze(qe,"students",I));return C.exists()?{id:C.id,...C.data()}:null}catch(C){return console.warn("Failed to fetch student",I,":",C.message),null}}),S=(await Promise.all(x)).filter(I=>I!==null);return S.sort((I,C)=>{var P,R,N,M;const F=((R=(P=I.app)==null?void 0:P.studentData)==null?void 0:R.lastName)||"",W=((M=(N=C.app)==null?void 0:N.studentData)==null?void 0:M.lastName)||"";return F.localeCompare(W)}),S}catch(D){console.error("🔴 Paraeducator query FAILED:",D);const k=uo();return console.error("🔴 Paraeducator auth mismatch - userId:",v,"authUid:",(A=k.currentUser)==null?void 0:A.uid),[]}},g=async()=>{const v=cr(At(qe,"students"),Ur("app.flags.flag2","==",!0),vn("app.studentData.lastName","asc")),A=cr(At(qe,"students"),Ur("app.flags.separateSetting","==",!0),vn("app.studentData.lastName","asc")),[D,k]=await Promise.all([zt(v),zt(A)]),T=D.docs.map(S=>({id:S.id,...S.data()})),x=k.docs.map(S=>({id:S.id,...S.data()})),m=[...T];return x.forEach(S=>{m.find(I=>I.id===S.id)||m.push(S)}),m.sort((S,I)=>{var W,P,R,N;const C=((P=(W=S.app)==null?void 0:W.studentData)==null?void 0:P.lastName)||"",F=((N=(R=I.app)==null?void 0:R.studentData)==null?void 0:N.lastName)||"";return C.localeCompare(F)})},y=async(v={})=>{if(!a.value||!i.value)return console.error("🔴 No authenticated user or role - FAILING AUTH CHECK"),r.value="Authentication required",[];e.value=!0,r.value=null;try{let A=[];switch(i.value){case"admin":case"school_admin":case"staff_view":case"staff_edit":case"administrator":A=await o();break;case"sped_chair":A=await c();break;case"admin_504":A=await l();break;case"case_manager":A=await u(a.value);break;case"teacher":A=await f(a.value);break;case"service_provider":A=await h(a.value);break;case"paraeducator":A=await p(a.value);break;default:return console.error("🔴 Unknown role:",i.value),r.value="Invalid user role",[]}return v.testingOnly&&(A=await g()),n.value=A,s.value=A.length,A}catch(A){return console.error("🔴 Error loading students:",A),r.value=A.message||"Failed to load students",[]}finally{e.value=!1}},E=async v=>{if(!v)throw new Error("Student ID is required");if(!a.value||!i.value)throw new Error("Authentication required");e.value=!0,r.value=null;try{const A=await qt(Ze(qe,"students",v));if(!A.exists())throw new Error("Student not found");const D={id:A.id,...A.data()};if(!await b(D,a.value,i.value))throw new Error("Access denied to this student");return D}catch(A){throw console.error("🔴 Error getting student:",A),r.value=A.message,A}finally{e.value=!1}},b=async(v,A,D)=>{var k,T,x,m,S,I,C;if(!v||!A||!D)return!1;if(["admin","school_admin","admin_504","sped_chair"].includes(D))return!0;if(D==="case_manager")return((T=(k=v.app)==null?void 0:k.studentData)==null?void 0:T.caseManagerId)===A;if(D==="teacher"){if(!((m=(x=v.app)==null?void 0:x.schedule)!=null&&m.periods))return!1;const F=v.app.schedule.periods,W=Object.values(F);return W.includes(A)?!0:W.some(P=>{var R;return typeof P=="object"&&P!==null?P.teacherId===A||((R=P.coTeaching)==null?void 0:R.caseManagerId)===A:!1})}if(D==="service_provider"){if((S=v.app)!=null&&S.providers&&Object.values(v.app.providers).includes(A))return!0;if((C=(I=v.app)==null?void 0:I.schedule)!=null&&C.periods){const F=v.app.schedule.periods,W=Object.values(F);return W.includes(A)?!0:W.some(P=>{var R;return typeof P=="object"&&P!==null?P.teacherId===A||((R=P.coTeaching)==null?void 0:R.caseManagerId)===A:!1})}}return!1},_=async(v=50,A=null)=>{if(!a.value||!i.value)throw new Error("Authentication required");e.value=!0,r.value=null;try{let D=cr(At(qe,"students"),vn("app.studentData.lastName","asc"),la(v));A&&(D=cr(D,gh(A))),i.value==="case_manager"&&(D=cr(At(qe,"students"),Ur("app.studentData.caseManagerId","==",a.value),vn("app.studentData.lastName","asc"),la(v)),A&&(D=cr(D,gh(A))));const k=await zt(D);return{students:k.docs.map(x=>({id:x.id,...x.data()})),lastDoc:k.docs[k.docs.length-1],hasMore:k.docs.length===v}}catch(D){throw console.error("🔴 Error loading paginated students:",D),r.value=D.message,D}finally{e.value=!1}};return{students:Se(()=>n.value),loading:Se(()=>e.value),error:Se(()=>r.value),totalCount:Se(()=>s.value),loadStudents:y,getStudent:E,verifyStudentAccess:b,loadStudentsPaginated:_,getAdminStudents:o,getAdmin504Students:l,getCaseManagerStudents:u,getTeacherStudents:f,getServiceProviderStudents:h,getParaeducatorStudents:p,getTestingStudents:g}}function KB(t,e){const r={isSecure:!0,violations:[],summary:"",studentCount:t.length,authorizedCount:0,unauthorizedCount:0};return!e||!e.role?(r.isSecure=!1,r.violations.push("No user or role provided"),r):(t.forEach((n,s)=>{var a,o,l,c;qB(n,e)?r.authorizedCount++:(r.unauthorizedCount++,r.isSecure=!1,r.violations.push({studentIndex:s,studentName:`${(o=(a=n.app)==null?void 0:a.studentData)==null?void 0:o.firstName} ${(c=(l=n.app)==null?void 0:l.studentData)==null?void 0:c.lastName}`,studentId:n.id,reason:XB(n,e)}))}),r.summary=`User ${e.role} (${e.uid}) has access to ${r.authorizedCount}/${r.studentCount} students`,r.isSecure||(r.summary+=`. SECURITY VIOLATION: ${r.unauthorizedCount} unauthorized students accessible!`),r)}function qB(t,e){var s,i,a,o,l,c,u;const{role:r,uid:n}=e;switch(r){case"admin":case"school_admin":case"admin_504":case"sped_chair":case"staff_view":case"staff_edit":return!0;case"case_manager":return((i=(s=t.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId)===n;case"teacher":const f=((o=(a=t.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{};return Object.values(f).includes(n);case"service_provider":const h=((l=t.app)==null?void 0:l.providers)||{},p=((u=(c=t.app)==null?void 0:c.schedule)==null?void 0:u.periods)||{},g=Object.values(h).includes(n),y=Object.values(p).includes(n);return g||y;case"paraeducator":return!0;default:return!1}}function XB(t,e){var s,i,a,o,l,c,u;const{role:r,uid:n}=e;switch(r){case"case_manager":const f=(i=(s=t.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId;return`Case manager ${n} is not assigned to student (assigned to: ${f})`;case"teacher":const h=((o=(a=t.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{},p=Object.values(h);return`Teacher ${n} does not teach this student (teachers: ${p.join(", ")})`;case"service_provider":const g=((l=t.app)==null?void 0:l.providers)||{},y=((u=(c=t.app)==null?void 0:c.schedule)==null?void 0:u.periods)||{},E=Object.values(g).filter(_=>_),b=Object.values(y);return`Service provider ${n} is not assigned to student (providers: ${E.join(", ")}, teachers: ${b.join(", ")})`;case"paraeducator":return null;default:return`Unknown role: ${r}`}}function YB(t){t.isSecure?console.log("✅ SECURITY TEST PASSED:",t.summary):(console.error("🚨 SECURITY TEST FAILED:",t.summary),console.error("Violations:",t.violations))}function K_(t,e){const r=KB(t,e);return YB(r),r}const mI=(t,e)=>{console.log(`🔍 DEBUG: Schedule Operation - ${t}:`,e)};function gI(t){return mI("getTeacherIdFromPeriod",{periodData:t,type:typeof t}),t?typeof t=="string"?t:t.teacherId||null:null}function Bp(t){var e;return mI("getCoTeachingCaseManagerFromPeriod",{periodData:t}),!t||typeof t!="object"?null:((e=t.coTeaching)==null?void 0:e.caseManagerId)||null}function QB(t,e={}){if(!t||!t.periods)return[];const r=new Set;return Object.values(t.periods).forEach(n=>{const s=gI(n);s&&r.add(s);const i=Bp(n);if(i){const a=e[i];a&&(a.role==="teacher"||a.roles&&a.roles.includes("teacher"))&&r.add(i)}}),Array.from(r)}function JB(t){if(!t||!t.periods)return[];const e=new Set;return Object.values(t.periods).forEach(r=>{const n=Bp(r);n&&e.add(n)}),Array.from(e)}function ZB(t,e){var r,n;return!((n=(r=t.app)==null?void 0:r.schedule)!=null&&n.periods)||!e?!1:Object.values(t.app.schedule.periods).some(s=>Bp(s)===e)}function eU(){const t=ki(),e=on(),{students:r,setStudents:n}=Di(),{users:s,userList:i,fetchUsers:a,caseManagers:o,teacherList:l,userRoles:c}=ba(),{loadAideAssignment:u,loadAideAssignments:f,shouldAideSeeStudent:h,aideAssignment:p}=Jy(),{feedbackForms:g,formsLoading:y}=Zy(),{loadStudents:E}=zB(),b=se(!1),_=se(null),v=Se(()=>e.currentUser),A=Se(()=>{var N;const R=(N=v.value)==null?void 0:N.role;return["admin","school_admin","admin_504","sped_chair"].includes(R)}),D=Se(()=>{var R;return["case_manager","admin_504","sped_chair"].includes((R=v.value)==null?void 0:R.role)}),k=Se(()=>s.value||{}),T=Se(()=>{var R;return((R=i.value)==null?void 0:R.filter(N=>N.role==="paraeducator").sort((N,M)=>(N.name||N.email||N.id).localeCompare(M.name||M.email||M.id)))||[]}),x=Se(()=>{var R;return((R=i.value)==null?void 0:R.filter(N=>N.role==="service_provider").sort((N,M)=>(N.name||N.email||N.id).localeCompare(M.name||M.email||M.id)))||[]}),m=Se(()=>{var R,N;return!((R=r.value)!=null&&R.length)||!((N=o.value)!=null&&N.length)?[]:o.value.map(M=>{const O=r.value.filter(z=>W(z)===M.id).length,G=M.name||M.email||M.id;return{...M,displayName:`${G} (${O})`,count:O}}).sort((M,O)=>M.displayName.localeCompare(O.displayName))}),S=async()=>{var R;b.value=!0,_.value=null;try{await a();const N=v.value;if(N){const O=await E();n(O);const G=K_(O,N);G.isSecure||console.error("🚨 SECURITY VIOLATION DETECTED:",G.violations)}else n([]);const M=(R=v.value)==null?void 0:R.role;if(["admin","school_admin","admin_504","sped_chair"].includes(M))await f();else if(M==="paraeducator"&&v.value.uid){await u(v.value.uid);const O=Ze(qe,"aideSchedules",v.value.uid),G=Np(O,async z=>{if(z.exists()){await u(v.value.uid);const j=await E();n(j)}});ja(()=>G())}}catch(N){console.error("Error fetching data:",N),_.value=N.message||"Failed to load data"}finally{b.value=!1}},I=R=>r.value.find(N=>N.id===R)||{},C=R=>{const N=s.value[R];return N&&(N.name||N.email)||R},F=R=>{if(!R)return"N/A";const N=s.value[R];return N&&(N.name||N.email)||R},W=R=>{var N,M;return((M=(N=R.app)==null?void 0:N.studentData)==null?void 0:M.caseManagerId)||R.caseManagerId||R.casemanager_id},P=R=>{var N,M,O,G,z;return R.schedule?R.schedule:(M=(N=R.app)==null?void 0:N.schedule)!=null&&M.periods?R.app.schedule.periods:(G=(O=R.aeries)==null?void 0:O.schedule)!=null&&G.periods?R.aeries.schedule.periods:(z=R.aeries)!=null&&z.schedule?R.aeries.schedule:null};return Gt(()=>{S()}),Ht(()=>{var R;return(R=v.value)==null?void 0:R.role},async(R,N)=>{if(R&&R!==N){const M=v.value;if(M){const O=await E();n(O);const G=K_(O,M);G.isSecure||console.error("🚨 SECURITY VIOLATION DETECTED:",G.violations)}}},{immediate:!1}),{isLoading:b,error:_,students:r,userMap:s,userList:i,userMapObj:k,caseManagers:o,caseManagersWithCounts:m,teacherList:l,userRoles:c,aideAssignment:p,feedbackForms:g,formsLoading:y,paraeducators:T,serviceProviders:x,currentUser:v,isAdmin:A,showProviderView:D,fetchData:S,getStudentById:I,getUserName:C,getCaseManagerName:F,getCaseManagerId:W,getSchedule:P,shouldAideSeeStudent:h,getTeacherIdFromPeriod:gI,getCoTeachingCaseManagerFromPeriod:Bp,getAllTeacherIdsFromSchedule:QB,getCoTeachingCaseManagersFromSchedule:JB,isCoTeachingCaseManager:ZB,router:t}}function it(t,e,r="—"){const n=(l,c)=>c.split(".").reduce((u,f)=>u&&u[f]!==void 0?u[f]:null,l),s=n(t.overrides,e);if(t.overrides&&s!=null&&s!=="")return s;if(t.app){if(["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(e)){const c=n(t.app,`studentData.${e}`);if(c!=null&&c!=="")return c}if(["reviewDate","reevalDate","meetingDate"].includes(e)){const c=n(t.app,`dates.${e}`);if(c!=null&&c!=="")return c}if(["instruction","assessment"].includes(e)){const c=n(t.app,`accommodations.${e}`);if(c!=null&&c!=="")return c}const l=n(t.app,e);if(l!=null&&l!=="")return l}const i=n(t.aeries,e);if(t.aeries&&i!=null&&i!=="")return i;const a=n(t.seis,e);if(t.seis&&a!=null&&a!=="")return a;const o=n(t,e);return o!=null&&o!==""?o:r}function uu(t,e){const r=(o,l)=>l.split(".").reduce((c,u)=>c&&c[u]!==void 0?c[u]:null,o),n=r(t.overrides,e);if(t.overrides&&n!=null&&n!=="")return"Override";if(t.app){if(["firstName","lastName","grade","plan"].includes(e)){const l=r(t.app,`studentData.${e}`);if(l!=null&&l!=="")return"App"}if(["reviewDate","reevalDate","meetingDate"].includes(e)){const l=r(t.app,`dates.${e}`);if(l!=null&&l!=="")return"App"}if(["instruction","assessment"].includes(e)){const l=r(t.app,`accommodations.${e}`);if(l!=null&&l!=="")return"App"}const o=r(t.app,e);if(o!=null&&o!=="")return"App"}const s=r(t.aeries,e);if(t.aeries&&s!=null&&s!=="")return"Aeries";const i=r(t.seis,e);if(t.seis&&i!=null&&i!=="")return"SEIS";const a=r(t,e);return a!=null&&a!==""?"Top-level":"—"}function tU(t){return t?`<ul class="bullet-list">${t.split(/\n|\r|\d+\.\s+|\-\s+|;/).map(r=>r.trim()).filter(Boolean).map(r=>`<li>${r}</li>`).join("")}</ul>`:"<div>—</div>"}function rU(t){const{students:e,currentUser:r,shouldAideSeeStudent:n,userMap:s,getCaseManagerId:i,getSchedule:a,aideAssignment:o}=t,l=se(!1),c=se([]),u=As({sortBy:"firstName",cm:"all",teacher:"all",paraeducator:"all",plan:"all",serviceProvider:"all",search:"",providerView:"all",viewMode:"list"});let f=null;const h=()=>{f&&clearTimeout(f),f=setTimeout(()=>{E()},300)},p=()=>{l.value&&g(),l.value=!l.value},g=()=>{u.sortBy="firstName",u.cm="all",u.teacher="all",u.paraeducator="all",u.plan="all",u.serviceProvider="all",u.search="",u.providerView="all",u.viewMode="list",E()},y=()=>({paraeducator:u.paraeducator,teacher:u.teacher}),E=(b=u)=>{var D,k,T,x;console.log("🔍 FILTER DEBUG: applyFilters called with students.value.length:",e.value.length),console.log("🔍 FILTER DEBUG: currentUser:",(D=r.value)==null?void 0:D.role,(k=r.value)==null?void 0:k.uid);let _=e.value;const v=(T=r.value)==null?void 0:T.role,A=["admin","school_admin"];if(console.log("🔍 FILTER DEBUG: Provider view filtering check:",{userRole:v,providerView:b.providerView,shouldSkip:A.includes(v),resultLengthBefore:_.length}),!A.includes(v)&&b.providerView==="case_manager"?(console.log("🔍 FILTER DEBUG: Applying case_manager filter"),_=_.filter(m=>{var S;return i(m)===((S=r.value)==null?void 0:S.uid)}),console.log("🔍 FILTER DEBUG: After case_manager filter:",_.length)):!A.includes(v)&&b.providerView==="service_provider"?(console.log("🔍 FILTER DEBUG: Applying service_provider filter"),_=_.filter(m=>{var W;const S=a(m),I=S?Object.entries(S).some(([P,R])=>{var N,M;return typeof R=="string"?R===((N=r.value)==null?void 0:N.uid):R&&typeof R=="object"?R.teacherId===((M=r.value)==null?void 0:M.uid):!1}):!1,C=(m.services||[]).some(P=>{var R;return P.includes((R=r.value)==null?void 0:R.uid)}),F=i(m)!==((W=r.value)==null?void 0:W.uid);return(I||C)&&F}),console.log("🔍 FILTER DEBUG: After service_provider filter:",_.length)):console.log("🔍 FILTER DEBUG: Skipping provider view filtering for role:",v),((x=r.value)==null?void 0:x.role)==="paraeducator"&&console.log("🔍 FILTER DEBUG: Paraeducator - using database-filtered students, no additional filtering"),b.search){const m=b.search.toLowerCase();_=_.filter(S=>{const I=it(S,"firstName")||"",C=it(S,"lastName")||"";return`${I} ${C}`.toLowerCase().includes(m)})}if(b.cm&&b.cm!=="all"&&(_=_.filter(m=>i(m)===b.cm)),b.teacher&&b.teacher!=="all"&&(_=_.filter(m=>{const S=a(m);return S?Object.entries(S).some(([I,C])=>typeof C=="string"?C===b.teacher:C&&typeof C=="object"?C.teacherId===b.teacher:!1):!1})),b.paraeducator&&b.paraeducator!=="all"){console.log("🔍 FILTER DEBUG: Applying paraeducator filter for:",b.paraeducator);const m=o.value[b.paraeducator];if(m){console.log("🔍 FILTER DEBUG: Found aide data:",m);let S=[];m.studentIds&&Array.isArray(m.studentIds)?(S=m.studentIds,console.log("🔍 FILTER DEBUG: Using studentIds array:",S)):m.directAssignment&&(S=Array.isArray(m.directAssignment)?m.directAssignment:[m.directAssignment],console.log("🔍 FILTER DEBUG: Using directAssignment as fallback:",S)),_=_.filter(I=>S.includes(I.id)),console.log("🔍 FILTER DEBUG: After paraeducator filter:",_.length,"students")}else console.log("🔍 FILTER DEBUG: No aide data found for:",b.paraeducator),_=[]}b.plan&&b.plan!=="all"&&(_=_.filter(m=>it(m,"plan")===b.plan)),b.serviceProvider&&b.serviceProvider!=="all"&&(_=_.filter(m=>{var C;const S=((C=m.app)==null?void 0:C.providers)||{};for(const[F,W]of Object.entries(S))if(W===b.serviceProvider)return!0;return["speechId","speech_id","otId","ot_id","mhId","mh_id","ptId","pt_id","scId","sc_id","trId","tr_id","audId","aud_id","viId","vi_id","atId","at_id","dhhId","dhh_id","omId","om_id","bisId","bis_id","hnId","hn_id","swId","sw_id"].some(F=>m[F]===b.serviceProvider)})),b.sortBy&&_.sort((m,S)=>{const I=it(m,b.sortBy)||"",C=it(S,b.sortBy)||"";if(["reviewDate","reevalDate","meetingDate"].includes(b.sortBy)){const F=I?new Date(I).getTime():0,W=C?new Date(C).getTime():0;return F-W}return I.toString().toLowerCase().localeCompare(C.toString().toLowerCase())}),c.value=_,console.log("🔍 FILTER DEBUG: applyFilters completed. filteredStudents.value.length:",c.value.length)};return Ht(()=>[e.value,r.value],()=>{console.log("🔍 FILTER DEBUG: Watcher triggered. students.value.length:",e.value.length),e.value.length>0?(console.log("🔍 FILTER DEBUG: Calling applyFilters from watcher"),E()):console.log("🔍 FILTER DEBUG: No students to filter")},{deep:!0}),{showFilters:l,filteredStudents:c,currentFilters:u,toggleFilters:p,clearFilters:g,applyFilters:E,debouncedApplyFilters:h,getCurrentFilters:y}}const _u={grades:[],classServices:[{name:"SDC",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"Co-teach",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"RSP",subcategories:["English","Math","History","Science"],enabledSubcategories:["English","Math","History","Science"]},{name:"Other",subcategories:["FA","Directed Studies","DS: Reading Intv"],enabledSubcategories:["FA","Directed Studies","DS: Reading Intv"]}],sdcSubcategories:[],customClassServices:[],serviceProviders:["SLP","OT","PT","SC","MH","TR","AUD","VI","AT","DHH","O&M","BIS","HN","SW"],customServiceProviders:[],numPeriods:7,periodLabels:["1","2","3","4","5","6","sh"],gmailApi:{enabled:!1,isWorkspace:!1,isInternalOAuth:!1,lastCheck:null}},Aa=se({..._u}),Ta=se(!1),Do=se(null);let Wf=!1;function Ms(){const t=Ze(qe,"app_settings","global"),e=async()=>{if(Ta.value)return new Promise(i=>{const a=Ht(Ta,o=>{o||(a(),i(Aa.value))})});if(Wf&&!Do.value)return Aa.value;Ta.value=!0,Do.value=null;try{const i=await qt(t);Aa.value=i.exists()?i.data():{..._u}}catch{Aa.value={..._u}}finally{Ta.value=!1,Wf=!0}return Aa.value},r=async i=>{Ta.value=!0,Do.value=null;try{const a=Ze(qe,"app_settings","global");await jt(a,i),Aa.value={...i};try{localStorage.setItem("app_settings_backup",JSON.stringify(i))}catch(o){console.warn("⚠️ Failed to save localStorage backup:",o)}}catch(a){Do.value=a.message||"Unknown error";try{localStorage.setItem("app_settings_backup",JSON.stringify(i)),console.warn("⚠️ saveAppSettings: Fell back to localStorage due to Firestore error")}catch(o){throw console.error("❌ Both Firestore and localStorage saves failed:",o),new Error("Failed to save settings to both Firestore and localStorage")}}finally{Ta.value=!1}},n=async()=>{Ta.value=!0,Do.value=null;try{await jt(t,{..._u}),Aa.value={..._u},Wf=!0}catch(i){throw Do.value=i.message,i}finally{Ta.value=!1}};return!Wf&&!Ta.value&&e(),{appSettings:Aa,loadAppSettings:e,saveAppSettings:r,resetAppSettings:n,checkGmailApiStatus:async()=>{try{console.log("ℹ️ Skipping OAuth validation to avoid authentication issues");const i=!1;let a=!1,o=i;try{const c=await fetch("https://oauth2.googleapis.com/tokeninfo");if(c.ok){const u=await c.json();a=u.hd&&u.hd.includes(".")}}catch(c){console.warn("Could not get detailed OAuth info:",c)}const l={enabled:i,isWorkspace:a,isInternalOAuth:o,lastCheck:new Date().toISOString()};return Aa.value={...Aa.value,gmailApi:l},l}catch(i){return console.error("Failed to check Gmail API status:",i),{enabled:!1,isWorkspace:!1,isInternalOAuth:!1,lastCheck:new Date().toISOString(),error:i.message}}},loading:Ta,error:Do}}function Eo(){const{appSettings:t}=Ms(),e=Se(()=>{const o=t.value;return o!=null&&o.periodLabels&&(o!=null&&o.numPeriods)?[...o.periodLabels.slice(0,o.numPeriods)]:["1","2","3","4","5","6","7"]}),r=o=>{const l=parseInt(o);if(!l||l<1)return`Period ${o}`;const c=l-1;return e.value[c]||`Period ${l}`},n=o=>{const l=e.value.findIndex(c=>c===o);return l!==-1?l+1:null},s=Se(()=>{var l;const o=((l=t.value)==null?void 0:l.numPeriods)||7;return Array.from({length:o},(c,u)=>u+1)}),i=Se(()=>{const o={};return e.value.forEach((l,c)=>{o[l]=c+1}),o}),a=Se(()=>{const o={};return e.value.forEach((l,c)=>{o[c+1]=l}),o});return{labels:e,getLabel:r,getNumber:n,numericPeriods:s,labelToNumberMap:i,numberToLabelMap:a}}function vI(t,e){const{students:r,userMapObj:n,currentUser:s,getCaseManagerId:i,getSchedule:a,getUserName:o,formatDate:l}=t,{getLabel:c}=Eo(),{filteredStudents:u,currentFilters:f,applyFilters:h}=e,p=(P,R)=>{if(!P)return{periods:{},isTeacher:!1,isCoTeacher:!1};let N=!1,M=!1;const O={};return Object.entries(P).forEach(([G,z])=>{const j=typeof z=="string"?z:z==null?void 0:z.teacherId,H=typeof z=="object"?z==null?void 0:z.coTeaching:null,V=H==null?void 0:H.caseManagerId;O[G]={teacherId:j,coTeaching:H,coTeachingCM:V,teacherName:o(j),coTeacherName:V?o(V):null,label:c(G)},j===R&&(N=!0),V===R&&(M=!0)}),{periods:O,isTeacher:N,isCoTeacher:M}},g=(P,R,N)=>{if(!P||!R)return[];switch(N){case"case_manager":return P.filter(M=>i(M)===R);case"service_provider":return P.filter(M=>{const O=a(M);return O?Object.values(O).some(z=>{var j;return typeof z=="string"?z===R:z&&typeof z=="object"?z.teacherId===R||((j=z.coTeaching)==null?void 0:j.caseManagerId)===R:!1}):!1});case"all":return P;default:return console.warn(`Unknown provider view: ${N}`),[]}},y=(P,R)=>!P||!R?[]:P.filter(N=>{const{isTeacher:M,isCoTeacher:O}=p(a(N),R);return M||O}),E=(P,R)=>{const N={};return P.forEach(M=>{const O=a(M);if(!O)return;const{periods:G}=p(O,R);Object.entries(G).forEach(([z,j])=>{(j.teacherId===R||j.coTeachingCM===R)&&(N[z]||(N[z]=[]),N[z].push(M))})}),N},b=Se(()=>u.value||[]),_=P=>{const R=it(P,"firstName"),N=it(P,"lastName");return`${R} ${N}`},v=P=>({name:_(P),grade:it(P,"grade"),plan:it(P,"plan"),caseManager:o(i(P))}),A=P=>({reviewDate:l(it(P,"reviewDate")),reevalDate:l(it(P,"reevalDate")),meetingDate:l(it(P,"meetingDate"))}),D=P=>{const R=a(P);return R?Object.entries(R).reduce((N,[M,O])=>(N[M]={teacherId:O,teacherName:o(O)},N),{}):{}},k=P=>{f.search=P,h()},T=P=>{f.cm=P,h()},x=P=>{f.teacher=P,h()},m=P=>{f.viewMode=P,h()},S=Se(()=>{const P={};return b.value.forEach(R=>{const N=it(R,"grade");P[N]||(P[N]=[]),P[N].push(R)}),P}),I=Se(()=>{const P={};return b.value.forEach(R=>{const N=it(R,"plan");P[N]||(P[N]=[]),P[N].push(R)}),P}),C=Se(()=>{var N;const P=(N=s.value)==null?void 0:N.role,R=f;return["teacher","paraeducator"].includes(P)?!1:P==="case_manager"||["sped_chair","admin_504","administrator_504_CM"].includes(P)?R.providerView!=="service_provider"&&R.teacher==="all":["admin","school_admin","staff_view","staff_edit","administrator"].includes(P)?R.teacher==="all"&&R.paraeducator==="all":P==="service_provider"?R.providerView!=="service_provider":!0}),F=Se(()=>{var R;const P=(R=s.value)==null?void 0:R.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(P)}),W=Se(()=>{var R;const P=(R=s.value)==null?void 0:R.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(P)});return Ht(()=>C.value,P=>{P&&f.viewMode==="class"&&(console.log("🔄 Auto-switching from class view to list view because class view is now disabled"),f.viewMode="list",h())},{immediate:!1}),{visibleStudents:b,currentUser:s,userMapObj:n,standardizeScheduleAccess:p,getProviderViewStudents:g,getClassViewStudents:y,groupStudentsByPeriod:E,groupStudentsByGrade:S,groupStudentsByPlan:I,canAccessFilters:W,isClassViewDisabled:C,isAdminRole:F,formatStudentName:_,formatStudentInfo:v,formatDates:A,getStudentSchedule:D,filterByName:k,filterByCaseManager:T,filterByTeacher:x,setViewMode:m,currentFilters:f,showProviderView:!1,providerViewOptions:Se(()=>[])}}const Ft={ADMIN:"admin",SCHOOL_ADMIN:"school_admin",ADMIN_504:"admin_504",SPED_CHAIR:"sped_chair",STAFF_VIEW:"staff_view",STAFF_EDIT:"staff_edit",CASE_MANAGER:"case_manager",TEACHER:"teacher",SERVICE_PROVIDER:"service_provider",PARAEDUCATOR:"paraeducator"},nU={[Ft.ADMIN]:100,[Ft.SCHOOL_ADMIN]:90,[Ft.SPED_CHAIR]:80,[Ft.ADMIN_504]:70,[Ft.STAFF_EDIT]:65,[Ft.CASE_MANAGER]:60,[Ft.SERVICE_PROVIDER]:50,[Ft.STAFF_VIEW]:45,[Ft.TEACHER]:40,[Ft.PARAEDUCATOR]:30},ot={CAN_VIEW_ALL_STUDENTS:"canViewAllStudents",CAN_EDIT_ALL_STUDENTS:"canEditAllStudents",CAN_EDIT_OWN_STUDENTS:"canEditOwnStudents",CAN_SEND_FEEDBACK:"canSendFeedback",CAN_MANAGE_USERS:"canManageUsers",CAN_MANAGE_AIDES:"canManageAides",CAN_ACCESS_TESTING:"canAccessTesting",CAN_ACCESS_FILTERS:"canAccessFilters",SHOW_PROVIDER_VIEW:"showProviderView",CAN_USE_CLASS_VIEW:"canUseClassView"},sU={[Ft.ADMIN]:[ot.CAN_VIEW_ALL_STUDENTS,ot.CAN_EDIT_ALL_STUDENTS,ot.CAN_SEND_FEEDBACK,ot.CAN_MANAGE_USERS,ot.CAN_MANAGE_AIDES,ot.CAN_ACCESS_TESTING,ot.CAN_ACCESS_FILTERS,ot.SHOW_PROVIDER_VIEW,ot.CAN_USE_CLASS_VIEW],[Ft.ADMINISTRATOR]:[ot.CAN_VIEW_ALL_STUDENTS,ot.CAN_EDIT_ALL_STUDENTS,ot.CAN_SEND_FEEDBACK,ot.CAN_MANAGE_USERS,ot.CAN_MANAGE_AIDES,ot.CAN_ACCESS_TESTING,ot.CAN_ACCESS_FILTERS,ot.SHOW_PROVIDER_VIEW,ot.CAN_USE_CLASS_VIEW],[Ft.SPED_CHAIR]:[ot.CAN_VIEW_ALL_STUDENTS,ot.CAN_EDIT_ALL_STUDENTS,ot.CAN_SEND_FEEDBACK,ot.CAN_MANAGE_AIDES,ot.CAN_ACCESS_TESTING,ot.CAN_ACCESS_FILTERS,ot.SHOW_PROVIDER_VIEW,ot.CAN_USE_CLASS_VIEW],[Ft.SCHOOL_ADMIN]:[ot.CAN_VIEW_ALL_STUDENTS,ot.CAN_EDIT_ALL_STUDENTS,ot.CAN_SEND_FEEDBACK,ot.CAN_MANAGE_USERS,ot.CAN_MANAGE_AIDES,ot.CAN_ACCESS_TESTING,ot.CAN_ACCESS_FILTERS,ot.SHOW_PROVIDER_VIEW,ot.CAN_USE_CLASS_VIEW],[Ft.STAFF_VIEW]:[ot.CAN_VIEW_ALL_STUDENTS,ot.CAN_ACCESS_TESTING,ot.CAN_ACCESS_FILTERS,ot.CAN_USE_CLASS_VIEW],[Ft.STAFF_EDIT]:[ot.CAN_VIEW_ALL_STUDENTS,ot.CAN_EDIT_ALL_STUDENTS,ot.CAN_ACCESS_TESTING,ot.CAN_ACCESS_FILTERS,ot.CAN_USE_CLASS_VIEW],[Ft.ADMINISTRATOR_504_CM]:[ot.CAN_VIEW_ALL_STUDENTS,ot.CAN_EDIT_OWN_STUDENTS,ot.CAN_SEND_FEEDBACK,ot.CAN_MANAGE_USERS,ot.CAN_ACCESS_TESTING,ot.CAN_ACCESS_FILTERS,ot.SHOW_PROVIDER_VIEW,ot.CAN_USE_CLASS_VIEW],[Ft.CASE_MANAGER]:[ot.CAN_EDIT_OWN_STUDENTS,ot.CAN_SEND_FEEDBACK,ot.CAN_ACCESS_TESTING,ot.SHOW_PROVIDER_VIEW,ot.CAN_USE_CLASS_VIEW],[Ft.TEACHER]:[ot.CAN_ACCESS_TESTING,ot.CAN_USE_CLASS_VIEW],[Ft.SERVICE_PROVIDER]:[ot.CAN_EDIT_ALL_STUDENTS,ot.CAN_ACCESS_TESTING,ot.SHOW_PROVIDER_VIEW,ot.CAN_USE_CLASS_VIEW],[Ft.PARAEDUCATOR]:[ot.CAN_ACCESS_TESTING,ot.CAN_USE_CLASS_VIEW]},aU={[Ft.SPED_CHAIR]:[{value:"all_iep",label:"*"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"},{value:"all",label:"All"}],[Ft.ADMINISTRATOR_504_CM]:[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}],admin_504:[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}],[Ft.CASE_MANAGER]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}],[Ft.SERVICE_PROVIDER]:[{value:"all",label:"All"}]},iU={[Ft.SPED_CHAIR]:"all",[Ft.ADMINISTRATOR_504_CM]:"case_manager",admin_504:"case_manager",[Ft.CASE_MANAGER]:"all",[Ft.SERVICE_PROVIDER]:"service_provider"},oU={[Ft.CASE_MANAGER]:{patterns:["case_manager","teacher"],description:"Students in their caseload and students they provide services to"},[Ft.TEACHER]:{patterns:["teacher"],description:"Students in their classes"},[Ft.SERVICE_PROVIDER]:{patterns:["teacher"],description:"Students in their classes"},[Ft.PARAEDUCATOR]:{patterns:["paraeducator"],description:"Students they are assigned to assist"},[Ft.SPED_CHAIR]:{patterns:["case_manager","teacher","all_iep"],description:"All students, with special access to IEP students"},[Ft.ADMINISTRATOR_504_CM]:{patterns:["case_manager","all_iep_504"],description:"All students, with special access to IEP/504 students"},[Ft.ADMIN]:{patterns:["all"],description:"All students"},[Ft.ADMINISTRATOR]:{patterns:["all"],description:"All students"},[Ft.SCHOOL_ADMIN]:{patterns:["all"],description:"All students"},[Ft.STAFF_VIEW]:{patterns:["all"],description:"All students (view-only)"},[Ft.STAFF_EDIT]:{patterns:["all"],description:"All students (can edit)"}},Pa={case_manager:(t,e,r)=>r.getCaseManagerId(e)===t,teacher:(t,e,r)=>{const n=r.getSchedule(e);return n?Object.values(n).some(s=>{var i;return typeof s=="string"?s===t:s&&typeof s=="object"?s.teacherId===t||((i=s.coTeaching)==null?void 0:i.caseManagerId)===t:!1}):!1},paraeducator:(t,e,r,n)=>{if(!n)return!1;const s=n[t];if(!s)return!1;if((Array.isArray(s.directAssignment)?s.directAssignment:s.directAssignment?[s.directAssignment]:[]).includes(e.id))return!0;const a=r.getSchedule(e);if(!a)return!1;const o=s.classAssignment||{};return Object.entries(a).some(([l,c])=>{const u=typeof c=="string"?c:c==null?void 0:c.teacherId,f=o[l];return!f||!u?!1:(Array.isArray(f)?f:[f]).includes(u)})},all_iep:(t,e,r)=>it(e,"plan")==="IEP",all_iep_504:(t,e,r)=>{const n=it(e,"plan");return n==="IEP"||n==="504"},all:()=>!0},lU={[Ft.CASE_MANAGER]:{canSendFeedback:(t,e,r)=>r.getCaseManagerId(e)===t,description:"Can send feedback for students in their caseload"},[Ft.SPED_CHAIR]:{canSendFeedback:(t,e,r)=>{const n=r.getCaseManagerId(e)===t,s=Pa.teacher(t,e,r),i=Pa.all_iep(t,e,r);return n||s||i},description:"Can send feedback for students they case manage, teach, or have IEP"},[Ft.ADMINISTRATOR_504_CM]:{canSendFeedback:(t,e,r)=>{const n=r.getCaseManagerId(e)===t,s=Pa.all_iep_504(t,e,r);return n||s},description:"Can send feedback for students they case manage or have IEP/504"},[Ft.ADMIN]:{canSendFeedback:()=>!0,description:"Can send feedback for all students"},[Ft.ADMINISTRATOR]:{canSendFeedback:()=>!0,description:"Can send feedback for all students"}},wn={hasPermission:(t,e)=>(sU[t]||[]).includes(e),getProviderViewOptions:t=>aU[t]||[],getDefaultProviderView:t=>iU[t]||"all",canAccessStudent:(t,e,r,n,s=null)=>{var a;return(((a=oU[e])==null?void 0:a.patterns)||[]).some(o=>{const l=Pa[o];return l?l(t,r,n,s):!1})},canSendFeedback:(t,e,r,n)=>{const s=lU[e];return s?s.canSendFeedback(t,r,n):!1},getRoleLevel:t=>nU[t]||0,hasHigherPrivileges:(t,e)=>wn.getRoleLevel(t)>wn.getRoleLevel(e)};function cU(t,e){const r=vI(t,e),n=Se(()=>{var F;return(F=r.currentUser.value)==null?void 0:F.uid}),s=Se(()=>{var F;return((F=r.currentUser.value)==null?void 0:F.role)||"guest"});console.log("🔍 UNIFIED ROLE VIEW: Composable initialized for role:",s.value);const i=Se(()=>wn.getProviderViewOptions(s.value));Ht(i,F=>{if(F.length>0){const W=wn.getDefaultProviderView(s.value);F.map(R=>R.value).includes(e.currentFilters.providerView)||(e.currentFilters.providerView=W,e.applyFilters())}},{immediate:!0});const a=Se(()=>{if(console.log("🔍 UNIFIED ROLE VIEW: visibleStudents computed called for role:",s.value),!n.value)return console.log("🔍 UNIFIED ROLE VIEW: No currentUserId, returning empty array"),[];const F=r.visibleStudents.value,W=e.currentFilters.providerView,P=s.value;if(console.log("🔍 UNIFIED ROLE VIEW: Processing students:",{role:P,baseStudentsCount:F.length,providerView:W,currentUserId:n.value}),P==="paraeducator"||P==="teacher"||P==="service_provider")return console.log(`🔍 ${P.toUpperCase()} ROLE VIEW: Received ${F.length} students from database`),console.log(`🔍 ${P.toUpperCase()} ROLE VIEW: Student names:`,F.map(R=>{var N,M,O,G;return`${((M=(N=R.app)==null?void 0:N.studentData)==null?void 0:M.firstName)||"Unknown"} ${((G=(O=R.app)==null?void 0:O.studentData)==null?void 0:G.lastName)||"Unknown"}`})),console.log(`🔍 ${P.toUpperCase()} ROLE VIEW: Returning students directly (no provider view filtering)`),F;if(!W||W==="")return F.filter(R=>wn.canAccessStudent(n.value,P,R,t));switch(W){case"case_manager":return F.filter(R=>Pa.case_manager(n.value,R,t));case"service_provider":return F.filter(R=>Pa.teacher(n.value,R,t));case"all":return F.filter(R=>wn.canAccessStudent(n.value,P,R,t));case"iep_all":return P==="sped_chair"?F.filter(R=>Pa.all_iep(n.value,R,t)):[];case"all_iep":return F.filter(R=>{const N=Pa.case_manager(n.value,R,t),M=Pa.teacher(n.value,R,t);return N||M});case"iep_504_all":return P==="administrator_504_CM"||P==="admin_504"?F.filter(R=>Pa.all_iep_504(n.value,R,t)):[];default:return console.warn(`Unknown provider view: ${W}`),[]}}),o=Se(()=>wn.hasPermission(s.value,ot.CAN_EDIT_ALL_STUDENTS)),l=Se(()=>wn.hasPermission(s.value,ot.CAN_EDIT_OWN_STUDENTS)),c=Se(()=>wn.hasPermission(s.value,ot.CAN_VIEW_ALL_STUDENTS)),u=Se(()=>wn.hasPermission(s.value,ot.CAN_MANAGE_USERS)),f=Se(()=>wn.hasPermission(s.value,ot.CAN_MANAGE_AIDES)),h=Se(()=>wn.hasPermission(s.value,ot.CAN_ACCESS_TESTING)),p=Se(()=>h.value),g=Se(()=>h.value),y=Se(()=>wn.hasPermission(s.value,ot.CAN_ACCESS_FILTERS)),E=Se(()=>wn.hasPermission(s.value,ot.SHOW_PROVIDER_VIEW)),b=Se(()=>wn.hasPermission(s.value,ot.CAN_USE_CLASS_VIEW)),_=F=>{var R,N;if(!n.value||!F)return!1;const W=s.value;return W==="paraeducator"||W==="teacher"?!1:W==="case_manager"?t.getCaseManagerId(F)===n.value:W==="service_provider"?(N=(R=F.app)==null?void 0:R.staffIds)==null?void 0:N.includes(n.value):["admin","school_admin","staff_edit","admin_504","sped_chair"].includes(W)},v=F=>!n.value||!F?!1:wn.canSendFeedback(n.value,s.value,F,t),A=Se(()=>n.value?r.groupStudentsByPeriod(a.value,n.value):{}),D=F=>{if(F==="class"&&!b.value){e.currentFilters.viewMode="list";return}e.currentFilters.viewMode=F},k=Se(()=>{if(s.value!=="teacher")return{instruction:[],assessment:[]};const F={instruction:[],assessment:[]};return a.value.forEach(W=>{var P,R,N,M;(R=(P=W.app)==null?void 0:P.accommodations)!=null&&R.instruction&&F.instruction.push(W),(M=(N=W.app)==null?void 0:N.accommodations)!=null&&M.assessment&&F.assessment.push(W)}),F}),T=Se(()=>{if(s.value!=="teacher")return{};const F={};return a.value.forEach(W=>{var R;const P=((R=W.app)==null?void 0:R.providers)||{};Object.entries(P).forEach(([N,M])=>{M&&(F[M]||(F[M]={provider:t.getUserName(M),providerType:N,students:[]}),F[M].students.push(W))})}),F}),x=Se(()=>s.value==="teacher"),m=Se(()=>s.value==="teacher"),S=Se(()=>s.value==="teacher"),I=Se(()=>!1),C=Se(()=>!1);return{...r,visibleStudents:a,studentsByPeriod:A,providerViewOptions:i,showProviderView:E,canEditAllStudents:o,canEditOwnStudents:l,canViewAllStudents:c,canManageUsers:u,canManageAides:f,canAccessTesting:h,canAccessTestingPartial:p,hasAnyTestingAccess:g,canAccessFilters:y,canUseClassView:b,canEditStudent:_,canSendFeedback:v,setViewMode:D,studentsByAccommodation:k,studentsByServiceProvider:T,canViewAccommodations:x,canViewBasicInfo:m,canViewServiceProviders:S,canViewDates:I,canEditStudents:C,currentRole:s,currentUserId:n}}function uU(t,e){const r=vI(t,e),n=Se(()=>{var o;return(o=r.currentUser.value)==null?void 0:o.uid}),s=Se(()=>[{value:"case_manager",label:"CM"},{value:"iep_504_all",label:"*"}]);Ht(s,o=>{const l="case_manager";o.map(u=>u.value).includes(e.currentFilters.providerView)||(e.currentFilters.providerView=l,e.applyFilters())},{immediate:!0});const i=Se(()=>{if(!n.value)return[];const o=r.visibleStudents.value;switch(e.currentFilters.providerView){case"case_manager":return r.getProviderViewStudents(o,n.value,"case_manager");case"iep_504_all":return o.filter(c=>{const u=it(c,"plan");return u==="IEP"||u==="504"});default:return[]}}),a=Se(()=>n.value?r.groupStudentsByPeriod(i.value,n.value):{});return{...r,visibleStudents:i,studentsByPeriod:a,providerViewOptions:s,showProviderView:!0}}function dU(t,e){var g,y,E,b;const{currentUser:r}=t;Xy();const n=Se(()=>{var _;return((_=r.value)==null?void 0:_.role)||"guest"}),i=Se(()=>{switch(n.value){case"admin_504":return uU(t,e);default:return cU(t,e)}}).value;n.value==="paraeducator"&&console.log("🔍 ROLE-BASED VIEW: Paraeducator activeView:",{visibleStudents:((y=(g=i.visibleStudents)==null?void 0:g.value)==null?void 0:y.length)||0,providerViewOptions:((b=(E=i.providerViewOptions)==null?void 0:E.value)==null?void 0:b.length)||0,role:n.value});const a=Se(()=>{var v;const _=(v=r.value)==null?void 0:v.role;return["admin","school_admin","staff_edit","sped_chair"].includes(_)}),o=Se(()=>{var v;const _=(v=r.value)==null?void 0:v.role;return["case_manager","admin_504"].includes(_)}),l=Se(()=>{var v;const _=(v=r.value)==null?void 0:v.role;return["admin","school_admin","staff_view","staff_edit","admin_504","sped_chair"].includes(_)}),c=Se(()=>{var v;const _=(v=r.value)==null?void 0:v.role;return["admin","school_admin","admin_504","sped_chair"].includes(_)}),u=Se(()=>{var v;const _=(v=r.value)==null?void 0:v.role;return["admin","school_admin","admin_504","sped_chair"].includes(_)}),f=Se(()=>!0),h=Se(()=>!0),p=Se(()=>!0);return{...i,currentRole:n,canEditAllStudents:a,canEditOwnStudents:o,canViewAllStudents:l,canManageUsers:c,canManageAides:u,canAccessTesting:f,canAccessTestingPartial:h,hasAnyTestingAccess:p}}function fU(t){Object.entries(t).reduce((e,[r,n])=>(e[r]=n.length,e),{})}function hU(t,e,r=null){const{aideAssignment:n,getCaseManagerId:s,getSchedule:i,standardizeScheduleAccess:a,currentUser:o}=t,{filteredStudents:l,currentFilters:c,getCurrentFilters:u}=e,f=r||l,h=se("list");Ht(()=>c.viewMode,_=>{h.value=_||"list"});const p=Se(()=>f.value.filter(_=>{var v,A,D,k;return((A=(v=_.app)==null?void 0:v.flags)==null?void 0:A.flag2)||((k=(D=_.app)==null?void 0:D.flags)==null?void 0:k.separateSetting)||_.separateSetting||_.flag2||!1})),g=Se(()=>{var T,x,m;const _={};if(h.value!=="class")return _;const v=(T=o.value)==null?void 0:T.uid;if(!v)return console.log("🔴 studentsByClass: No current user ID"),_;console.log("🔵 studentsByClass: Current user ID:",v);const A=(x=t.currentUser.value)==null?void 0:x.role;A==="paraeducator"&&console.log("🔍 studentsByClass DEBUG:",{role:A,roleBasedStudents:((m=r==null?void 0:r.value)==null?void 0:m.length)||0,aideAssignmentAvailable:!!n.value});let D;A==="case_manager"?(D=t.students.value,console.log("🔵 studentsByClass: Case manager - using raw database students:",D.length)):A==="paraeducator"?(D=(r==null?void 0:r.value)||t.students.value,console.log("🔵 studentsByClass: Paraeducator - using role-based students:",D.length)):(D=f.value,console.log("🔵 studentsByClass: Other role - using provider-filtered students:",D.length));const k=u();return k.paraeducator&&k.paraeducator,D.forEach(S=>{const I=i(S)||{};Object.entries(I).forEach(([C,F])=>{var z,j;let W,P;if(typeof F=="string")W=F;else if(F&&typeof F=="object")W=F.teacherId,P=(z=F.coTeaching)==null?void 0:z.caseManagerId;else return;let R=!1;const N=u(),M=N.teacher&&N.teacher!=="all",O=N.paraeducator&&N.paraeducator!=="all";if(A==="paraeducator"){const H=(j=n.value)==null?void 0:j[v];H!=null&&H.classAssignment&&H.classAssignment[C]&&(R=(Array.isArray(H.classAssignment[C])?H.classAssignment[C]:[H.classAssignment[C]]).includes(W))}else if(["admin","administrator"].includes(A))if(M)R=W===N.teacher||P===N.teacher;else if(O){const H=n.value[N.paraeducator];H!=null&&H.classAssignment&&H.classAssignment[C]&&(R=(Array.isArray(H.classAssignment[C])?H.classAssignment[C]:[H.classAssignment[C]]).includes(W))}else R=!0;else R=W===v||P===v;!R||(_[C]||(_[C]=[]),_[C].some(H=>H.id===S.id))||_[C].push(S)})}),console.log("🟢 studentsByClass: Final groups:",Object.keys(_).map(S=>`Period ${S}: ${_[S].length} students`)),fU(_),Object.keys(_).forEach(S=>{_[S].length===0&&delete _[S]}),Object.keys(_).sort((S,I)=>{const C=parseInt(S.replace(/\D/g,"")),F=parseInt(I.replace(/\D/g,""));return C-F}).reduce((S,I)=>(S[I]=_[I],S),{})}),y=Se(()=>{var m,S;const _=u(),v=(m=t.currentUser.value)==null?void 0:m.role,A=(S=t.currentUser.value)==null?void 0:S.uid;let D=null;if(v==="paraeducator")D=A;else{if(!(_.paraeducator&&_.paraeducator!=="all"))return[];D=_.paraeducator}if(!D)return[];const k=n.value[D];if(!k||!k.directAssignment)return console.log("🔍 directAssignmentStudents: No aide data or direct assignment for",D),[];const T=Array.isArray(k.directAssignment)?k.directAssignment:[k.directAssignment];console.log("🔍 directAssignmentStudents: Direct student IDs:",T),console.log("🔍 directAssignmentStudents: Available students:",f.value.length);const x=f.value.filter(I=>T.includes(I.id));return console.log("🔍 directAssignmentStudents: Found direct assignment students:",x.length),x}),E=Se(()=>{const _={};return f.value.forEach(v=>{const A=s(v);A&&(_[A]||(_[A]=[]),_[A].push(v))}),_});return{currentViewMode:h,studentsByClass:g,directAssignmentStudents:y,studentsByCaseManager:E,testingViewStudents:p,setViewMode:_=>{h.value=_,c.viewMode=_}}}function pU(t){const{router:e,fetchData:r}=t,n=se(null),s=se(null),i=se(!1),a=se(!1),o=se(!1),l=se(null),c=v=>{n.value=v},u=v=>{s.value=v},f=v=>{l.value=v,o.value=!0},h=()=>{console.log("Teacher feedback form sent successfully")},p=()=>{a.value=!1,r()},g=()=>{console.log("Student saved"),r()},y=()=>{e.push("/admin")},E=()=>{e.push("/aide-schedule")},b=async v=>{switch(v){case"add-student":a.value=!0;break;case"export":i.value=!0;break;case"print":window.print();break;case"admin":y();break;case"aide-schedule":E();break;case"logout":await _();break}},_=async()=>{try{const{useAuthStore:v}=await ua(async()=>{const{useAuthStore:D}=await Promise.resolve().then(()=>v7);return{useAuthStore:D}},void 0);await v().logout(),e.push("/login")}catch(v){console.error("Logout failed:",v)}};return{editingStudentId:n,emailingStudentId:s,showExport:i,showAddStudent:a,showFeedbackDialog:o,feedbackStudentId:l,editStudent:c,emailStudent:u,handleTeacherFeedback:f,handleFormSent:h,handleStudentAdded:p,handleStudentSaved:g,navigateToAdmin:y,navigateToAideSchedule:E,handleNavAction:b,handleLogout:_}}const mU={class:"student-nav-menu"},gU=["title"],vU={class:"nav-content"},yU={class:"nav-section"},xU={class:"nav-buttons"},EU={key:0,class:"nav-section"},_U={class:"nav-buttons"},bU={key:1,class:"nav-section"},SU={class:"nav-buttons"},AU={class:"nav-section"},TU={class:"user-info"},wU={class:"user-details"},CU={key:0,class:"user-role"},IU={__name:"StudentNavMenu",props:{currentUser:{type:Object,default:null},isAdmin:{type:Boolean,default:!1}},emits:["action"],setup(t,{emit:e}){const r=t,n=e,s=Se(()=>{var u;const c=(u=r.currentUser)==null?void 0:u.role;return c!=="paraeducator"&&c!=="teacher"}),i=se(!1);function a(){i.value=!i.value}function o(){i.value=!1}function l(c){n("action",c),o()}return(c,u)=>{var f,h,p,g;return L(),B("div",mU,[d("button",{onClick:a,class:Xe(["hamburger-btn",{active:i.value}]),title:i.value?"Close Menu":"Open Menu"},u[6]||(u[6]=[d("span",{class:"hamburger-line"},null,-1),d("span",{class:"hamburger-line"},null,-1),d("span",{class:"hamburger-line"},null,-1)]),10,gU),i.value?(L(),B("div",{key:0,class:"nav-overlay",onClick:o})):_e("",!0),d("div",{class:Xe(["nav-panel",{open:i.value}])},[d("div",{class:"nav-header"},[u[7]||(u[7]=d("h3",null,"Student Management",-1)),d("button",{onClick:o,class:"close-btn"},"×")]),d("div",vU,[d("div",yU,[u[11]||(u[11]=d("h4",null,"Actions",-1)),d("div",xU,[s.value?(L(),B("button",{key:0,onClick:u[0]||(u[0]=y=>l("add-student")),class:"nav-btn primary"},u[8]||(u[8]=[d("span",null,"➕",-1),we(" Add Student ")]))):_e("",!0),d("button",{onClick:u[1]||(u[1]=y=>l("export")),class:"nav-btn"},u[9]||(u[9]=[d("span",null,"📊",-1),we(" Export ")])),d("button",{onClick:u[2]||(u[2]=y=>l("print")),class:"nav-btn print-btn"},u[10]||(u[10]=[d("span",null,"🖨️",-1),we(" Print ")]))])]),t.isAdmin?(L(),B("div",EU,[u[13]||(u[13]=d("h4",null,"Admin",-1)),d("div",_U,[d("button",{onClick:u[3]||(u[3]=y=>l("admin")),class:"nav-btn"},u[12]||(u[12]=[d("span",null,"⚙️",-1),we(" Admin Panel ")]))])])):_e("",!0),((f=t.currentUser)==null?void 0:f.role)==="paraeducator"?(L(),B("div",bU,[u[15]||(u[15]=d("h4",null,"Schedule",-1)),d("div",SU,[d("button",{onClick:u[4]||(u[4]=y=>l("aide-schedule")),class:"nav-btn"},u[14]||(u[14]=[d("span",null,"📅",-1),we(" My Schedule ")]))])])):_e("",!0),d("div",AU,[u[17]||(u[17]=d("h4",null,"User",-1)),d("div",TU,[d("div",wU,[d("strong",null,Z(((h=t.currentUser)==null?void 0:h.name)||((p=t.currentUser)==null?void 0:p.email)||"User"),1),(g=t.currentUser)!=null&&g.role?(L(),B("span",CU,"("+Z(t.currentUser.role)+")",1)):_e("",!0)]),d("button",{onClick:u[5]||(u[5]=y=>l("logout")),class:"nav-btn danger"},u[16]||(u[16]=[d("span",null,"🚪",-1),we(" Logout ")]))])])])],2)])}}},kU=St(IU,[["__scopeId","data-v-fd6a61ad"]]);function DU(t){const{appSettings:e,loadAppSettings:r,loading:n,error:s}=Ms(),{getLabel:i}=Eo();Gt(async()=>{var P;try{await r(),t.studentData.students.value.length>0&&await sn.logStudentAccess("table_view","view",{studentCount:t.studentData.students.value.length,viewType:"student_table",hasFilters:(P=t.filterData)!=null&&P.currentFilters?Object.keys(t.filterData.currentFilters).length>0:!1})}catch(R){console.error("StudentTable: Error loading app settings:",R)}});const a=P=>{const R=t.userMap[P];return R&&(R.name||R.email)||P},o=P=>{const R=t.userMap[P];return R?R.initials?R.initials:R.name?R.name.split(" ").map(M=>M[0]).join("").toUpperCase():R.email?R.email[0].toUpperCase():"?":"?"},l=P=>{const R=t.userMap[P];if(!R)return P;if(R.name){const N=R.name.trim().split(" ");return N.length===1?N[0]:`${N[0][0]}. ${N.slice(1).join(" ")}`}return R.email?R.email[0].toUpperCase():P},c=P=>{const R=t.userMap[P];if(!R)return"";const N=[];return R.rm&&N.push(`Rm: ${R.rm}`),R.ext&&N.push(`Ext: ${R.ext}`),N.length>0?N.join(" | "):""},u=c,f=P=>{if(!P||P===""||P===null||P===void 0)return"";let R;if(typeof P=="string"&&P.match(/^\d{4}-\d{2}-\d{2}$/)){const[N,M,O]=P.split("-").map(G=>parseInt(G,10));R=new Date(N,M-1,O)}else R=new Date(P);return isNaN(R.getTime())?"":R.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})},h=P=>{if(!P)return"";const R=new Date,N=new Date(P),M=Math.ceil((N-R)/(1e3*60*60*24));return M<=0?"flag-critical":M<=7?"flag-high":M<=14?"flag-medium":M<=21?"flag-mid":M<=28?"flag-low":M<=35?"flag-prep":""},p=P=>{if(!P)return"";const R=new Date,N=new Date(P),M=Math.ceil((N-R)/(1e3*60*60*24));return M<=0?"flag-critical":M<=7?"flag-high":M<=14?"flag-medium":M<=21?"flag-mid":M<=28?"flag-low":M<=60?"flag-prep-reeval":""},g=P=>h(it(P,"meetingDate")),y=P=>h(it(P,"reviewDate")),E=P=>p(it(P,"reevalDate")),b=P=>{var R,N;return((N=(R=P.app)==null?void 0:R.studentData)==null?void 0:N.caseManagerId)||P.caseManagerId||P.casemanager_id},_=(P,R)=>{var N,M;return((M=(N=P.app)==null?void 0:N.flags)==null?void 0:M[R])||P[R]||!1},v=P=>{var R;return((R=P.app)==null?void 0:R.flags)&&Object.values(P.app.flags).some(Boolean)||P.flag1||P.flag2},A=(P,R)=>{var M,O,G;return((O=(M=P.app)==null?void 0:M.documents)==null?void 0:O[R])||((G=P.app)==null?void 0:G[R])||P[R]||P[`${R}_url`]||null},D=P=>{var N,M;const R=((M=(N=P.app)==null?void 0:N.documents)==null?void 0:M.additionalDocuments)||[];return Array.isArray(R)?R:[]},k=P=>{var R,N,M,O,G;if(P.schedule)return P.schedule;if((N=(R=P.app)==null?void 0:R.schedule)!=null&&N.periods)return P.app.schedule.periods;if((O=(M=P.aeries)==null?void 0:M.schedule)!=null&&O.periods)return P.aeries.schedule.periods;if((G=P.aeries)!=null&&G.schedule){const z={};return Object.entries(P.aeries.schedule).forEach(([j,H])=>{if(H&&H.teacherId){const V=parseInt(j.replace("period","")),te=i(V);let oe=H.teacherId;if(t.userMap){let ne=Object.values(t.userMap).find(le=>le.aeriesId===H.teacherId||le.aeriesId===parseInt(H.teacherId)||le.id===H.teacherId);if(ne||(ne=Object.values(t.userMap).find(le=>{var J,Q,ve,ee;return((J=le.aeriesId)==null?void 0:J.toString())===((Q=H.teacherId)==null?void 0:Q.toString())||((ve=le.id)==null?void 0:ve.toString())===((ee=H.teacherId)==null?void 0:ee.toString())})),ne&&ne.name){const le=ne.name.split(" ");if(le.length>=2){const J=le[0],Q=le[le.length-1];oe=`${J.charAt(0)}. ${Q}`}else oe=ne.name}}z[te]=oe}}),Object.keys(z).length>0?z:null}return null},T=P=>{const R=[],N=k(P);return N&&Object.entries(N).forEach(([M,O])=>{if(O&&typeof O=="object"&&O.coTeaching){const G=O.coTeaching.subject;G&&R.push(`Co-teach: ${G}`)}}),R};return{appSettings:e,appSettingsLoading:n,appSettingsError:s,getUserName:a,getUserInitials:o,getUserInitialLastName:l,getUserTooltip:c,getCaseManagerTooltip:u,formatDate:f,getMeetingUrgencyClass:g,getReviewUrgencyClass:y,getReevalUrgencyClass:E,getCaseManagerId:b,getFlagValue:_,hasFlags:v,getDocumentUrl:A,getAdditionalDocuments:D,getSchedule:k,getClassServices:P=>{var z,j;const R=((j=(z=P.app)==null?void 0:z.schedule)==null?void 0:j.classServices)||P.services||[],N=T(P),M=R.filter(H=>H&&H.startsWith&&H.startsWith("Co-teach:")),O=N.filter(H=>!M.includes(H)),G=[...R,...O];if(n.value)return Array.isArray(G)?G.filter(H=>typeof H=="string"&&H.includes(":")):[];if(s.value)return Array.isArray(G)?G.filter(H=>typeof H=="string"&&H.includes(":")):[];if(e.value&&e.value.classServices){const H=e.value.classServices.filter(V=>V.enabledSubcategories&&V.enabledSubcategories.length>0).map(V=>V.name);return Array.isArray(G)?G.filter(V=>{if(typeof V!="string"||!V.includes(":"))return!1;const te=V.split(":")[0];return H.includes(te)}):[]}return Array.isArray(G)?G.filter(H=>typeof H=="string"&&H.includes(":")):[]},getOtherServices:P=>{var N,M;const R=((M=(N=P.app)==null?void 0:N.schedule)==null?void 0:M.otherServices)||P.other_services||[];return Array.isArray(R)?R.filter(O=>!!O):[]},getCoTeachingServices:T,hasServiceProviders:P=>{var O;const R=((O=P.app)==null?void 0:O.providers)||{},N=Object.values(R).some(Boolean);if(n.value||s.value){const G=P.speechId||P.speech_id||P.mhId||P.mh_id||P.otId||P.ot_id||P.ptId||P.pt_id||P.scId||P.sc_id||P.trId||P.tr_id||P.audId||P.aud_id||P.viId||P.vi_id||P.atId||P.at_id||P.dhhId||P.dhh_id||P.omId||P.om_id||P.bisId||P.bis_id||P.hnId||P.hn_id||P.swId||P.sw_id;return N||G}let M=!1;if(e.value&&e.value.serviceProviders){const G=e.value.serviceProviders,z={SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"};M=G.some(j=>{const H=z[j];return P[H]||P[H.replace("Id","_id")]})}else M=P.speechId||P.speech_id||P.mhId||P.mh_id||P.otId||P.ot_id||P.ptId||P.pt_id||P.scId||P.sc_id||P.trId||P.tr_id||P.audId||P.aud_id||P.viId||P.vi_id||P.atId||P.at_id||P.dhhId||P.dhh_id||P.omId||P.om_id||P.bisId||P.bis_id||P.hnId||P.hn_id||P.swId||P.sw_id;return N||M},getServiceProviderId:(P,R)=>{var M,O;return((O=(M=P.app)==null?void 0:M.providers)==null?void 0:O[R])||P[R]||P[R.replace("Id","_id")]||null},getProviderFieldName:P=>({SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"})[P]||`${P.toLowerCase()}Id`,isDirectAssignment:P=>{if(!t.currentUser||t.currentUser.role!=="paraeducator")return!1;const R=t.currentUser.uid;let N=t.aideSchedule[R];if(!N){const M=Object.entries(t.userMap).find(([O,G])=>G.uid===R||G.email===t.currentUser.email);if(M){const[O]=M;N=t.aideSchedule[O]}}return(N==null?void 0:N.directAssignment)===P},formatListFromText:tU,getFlagClass:P=>{const R=P.toLowerCase();return R.includes("critical")?"flag-critical":R.includes("high")?"flag-high":R.includes("medium")?"flag-medium":R.includes("mid")?"flag-mid":R.includes("low")?"flag-low":R.includes("prep")?"flag-prep":"flag-low"},getPeriodLabel:i}}let zf;const PU=new Uint8Array(16);function RU(){if(!zf&&(zf=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!zf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return zf(PU)}const An=[];for(let t=0;t<256;++t)An.push((t+256).toString(16).slice(1));function FU(t,e=0){return An[t[e+0]]+An[t[e+1]]+An[t[e+2]]+An[t[e+3]]+"-"+An[t[e+4]]+An[t[e+5]]+"-"+An[t[e+6]]+An[t[e+7]]+"-"+An[t[e+8]]+An[t[e+9]]+"-"+An[t[e+10]]+An[t[e+11]]+An[t[e+12]]+An[t[e+13]]+An[t[e+14]]+An[t[e+15]]}const NU=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),q_={randomUUID:NU};function OU(t,e,r){if(q_.randomUUID&&!t)return q_.randomUUID();t=t||{};const n=t.random||(t.rng||RU)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,FU(n)}var Vt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yI(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ex(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var xI={exports:{}};function MU(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Dm={exports:{}};const LU={},BU=Object.freeze(Object.defineProperty({__proto__:null,default:LU},Symbol.toStringTag,{value:"Module"})),UU=ex(BU);var X_;function tr(){return X_||(X_=1,function(t,e){(function(r,n){t.exports=n()})(Vt,function(){var r=r||function(n,s){var i;if(typeof window<"u"&&window.crypto&&(i=window.crypto),typeof self<"u"&&self.crypto&&(i=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(i=globalThis.crypto),!i&&typeof window<"u"&&window.msCrypto&&(i=window.msCrypto),!i&&typeof Vt<"u"&&Vt.crypto&&(i=Vt.crypto),!i&&typeof MU=="function")try{i=UU}catch{}var a=function(){if(i){if(typeof i.getRandomValues=="function")try{return i.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof i.randomBytes=="function")try{return i.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function _(){}return function(v){var A;return _.prototype=v,A=new _,_.prototype=null,A}}(),l={},c=l.lib={},u=c.Base=function(){return{extend:function(_){var v=o(this);return _&&v.mixIn(_),(!v.hasOwnProperty("init")||this.init===v.init)&&(v.init=function(){v.$super.init.apply(this,arguments)}),v.init.prototype=v,v.$super=this,v},create:function(){var _=this.extend();return _.init.apply(_,arguments),_},init:function(){},mixIn:function(_){for(var v in _)_.hasOwnProperty(v)&&(this[v]=_[v]);_.hasOwnProperty("toString")&&(this.toString=_.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=c.WordArray=u.extend({init:function(_,v){_=this.words=_||[],v!=s?this.sigBytes=v:this.sigBytes=_.length*4},toString:function(_){return(_||p).stringify(this)},concat:function(_){var v=this.words,A=_.words,D=this.sigBytes,k=_.sigBytes;if(this.clamp(),D%4)for(var T=0;T<k;T++){var x=A[T>>>2]>>>24-T%4*8&255;v[D+T>>>2]|=x<<24-(D+T)%4*8}else for(var m=0;m<k;m+=4)v[D+m>>>2]=A[m>>>2];return this.sigBytes+=k,this},clamp:function(){var _=this.words,v=this.sigBytes;_[v>>>2]&=4294967295<<32-v%4*8,_.length=n.ceil(v/4)},clone:function(){var _=u.clone.call(this);return _.words=this.words.slice(0),_},random:function(_){for(var v=[],A=0;A<_;A+=4)v.push(a());return new f.init(v,_)}}),h=l.enc={},p=h.Hex={stringify:function(_){for(var v=_.words,A=_.sigBytes,D=[],k=0;k<A;k++){var T=v[k>>>2]>>>24-k%4*8&255;D.push((T>>>4).toString(16)),D.push((T&15).toString(16))}return D.join("")},parse:function(_){for(var v=_.length,A=[],D=0;D<v;D+=2)A[D>>>3]|=parseInt(_.substr(D,2),16)<<24-D%8*4;return new f.init(A,v/2)}},g=h.Latin1={stringify:function(_){for(var v=_.words,A=_.sigBytes,D=[],k=0;k<A;k++){var T=v[k>>>2]>>>24-k%4*8&255;D.push(String.fromCharCode(T))}return D.join("")},parse:function(_){for(var v=_.length,A=[],D=0;D<v;D++)A[D>>>2]|=(_.charCodeAt(D)&255)<<24-D%4*8;return new f.init(A,v)}},y=h.Utf8={stringify:function(_){try{return decodeURIComponent(escape(g.stringify(_)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(_){return g.parse(unescape(encodeURIComponent(_)))}},E=c.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(_){typeof _=="string"&&(_=y.parse(_)),this._data.concat(_),this._nDataBytes+=_.sigBytes},_process:function(_){var v,A=this._data,D=A.words,k=A.sigBytes,T=this.blockSize,x=T*4,m=k/x;_?m=n.ceil(m):m=n.max((m|0)-this._minBufferSize,0);var S=m*T,I=n.min(S*4,k);if(S){for(var C=0;C<S;C+=T)this._doProcessBlock(D,C);v=D.splice(0,S),A.sigBytes-=I}return new f.init(v,I)},clone:function(){var _=u.clone.call(this);return _._data=this._data.clone(),_},_minBufferSize:0});c.Hasher=E.extend({cfg:u.extend(),init:function(_){this.cfg=this.cfg.extend(_),this.reset()},reset:function(){E.reset.call(this),this._doReset()},update:function(_){return this._append(_),this._process(),this},finalize:function(_){_&&this._append(_);var v=this._doFinalize();return v},blockSize:16,_createHelper:function(_){return function(v,A){return new _.init(A).finalize(v)}},_createHmacHelper:function(_){return function(v,A){return new b.HMAC.init(_,A).finalize(v)}}});var b=l.algo={};return l}(Math);return r})}(Dm)),Dm.exports}var Pm={exports:{}},Y_;function Up(){return Y_||(Y_=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){return function(n){var s=r,i=s.lib,a=i.Base,o=i.WordArray,l=s.x64={};l.Word=a.extend({init:function(c,u){this.high=c,this.low=u}}),l.WordArray=a.extend({init:function(c,u){c=this.words=c||[],u!=n?this.sigBytes=u:this.sigBytes=c.length*8},toX32:function(){for(var c=this.words,u=c.length,f=[],h=0;h<u;h++){var p=c[h];f.push(p.high),f.push(p.low)}return o.create(f,this.sigBytes)},clone:function(){for(var c=a.clone.call(this),u=c.words=this.words.slice(0),f=u.length,h=0;h<f;h++)u[h]=u[h].clone();return c}})}(),r})}(Pm)),Pm.exports}var Rm={exports:{}},Q_;function $U(){return Q_||(Q_=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){return function(){if(typeof ArrayBuffer=="function"){var n=r,s=n.lib,i=s.WordArray,a=i.init,o=i.init=function(l){if(l instanceof ArrayBuffer&&(l=new Uint8Array(l)),(l instanceof Int8Array||typeof Uint8ClampedArray<"u"&&l instanceof Uint8ClampedArray||l instanceof Int16Array||l instanceof Uint16Array||l instanceof Int32Array||l instanceof Uint32Array||l instanceof Float32Array||l instanceof Float64Array)&&(l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength)),l instanceof Uint8Array){for(var c=l.byteLength,u=[],f=0;f<c;f++)u[f>>>2]|=l[f]<<24-f%4*8;a.call(this,u,c)}else a.apply(this,arguments)};o.prototype=i}}(),r.lib.WordArray})}(Rm)),Rm.exports}var Fm={exports:{}},J_;function VU(){return J_||(J_=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Utf16=a.Utf16BE={stringify:function(l){for(var c=l.words,u=l.sigBytes,f=[],h=0;h<u;h+=2){var p=c[h>>>2]>>>16-h%4*8&65535;f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,u=[],f=0;f<c;f++)u[f>>>1]|=l.charCodeAt(f)<<16-f%2*16;return i.create(u,c*2)}},a.Utf16LE={stringify:function(l){for(var c=l.words,u=l.sigBytes,f=[],h=0;h<u;h+=2){var p=o(c[h>>>2]>>>16-h%4*8&65535);f.push(String.fromCharCode(p))}return f.join("")},parse:function(l){for(var c=l.length,u=[],f=0;f<c;f++)u[f>>>1]|=o(l.charCodeAt(f)<<16-f%2*16);return i.create(u,c*2)}};function o(l){return l<<8&4278255360|l>>>8&16711935}}(),r.enc.Utf16})}(Fm)),Fm.exports}var Nm={exports:{}},Z_;function yl(){return Z_||(Z_=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64={stringify:function(l){var c=l.words,u=l.sigBytes,f=this._map;l.clamp();for(var h=[],p=0;p<u;p+=3)for(var g=c[p>>>2]>>>24-p%4*8&255,y=c[p+1>>>2]>>>24-(p+1)%4*8&255,E=c[p+2>>>2]>>>24-(p+2)%4*8&255,b=g<<16|y<<8|E,_=0;_<4&&p+_*.75<u;_++)h.push(f.charAt(b>>>6*(3-_)&63));var v=f.charAt(64);if(v)for(;h.length%4;)h.push(v);return h.join("")},parse:function(l){var c=l.length,u=this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var h=0;h<u.length;h++)f[u.charCodeAt(h)]=h}var p=u.charAt(64);if(p){var g=l.indexOf(p);g!==-1&&(c=g)}return o(l,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function o(l,c,u){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var g=u[l.charCodeAt(p-1)]<<p%4*2,y=u[l.charCodeAt(p)]>>>6-p%4*2,E=g|y;f[h>>>2]|=E<<24-h%4*8,h++}return i.create(f,h)}}(),r.enc.Base64})}(Nm)),Nm.exports}var Om={exports:{}},eb;function HU(){return eb||(eb=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.enc;a.Base64url={stringify:function(l,c){c===void 0&&(c=!0);var u=l.words,f=l.sigBytes,h=c?this._safe_map:this._map;l.clamp();for(var p=[],g=0;g<f;g+=3)for(var y=u[g>>>2]>>>24-g%4*8&255,E=u[g+1>>>2]>>>24-(g+1)%4*8&255,b=u[g+2>>>2]>>>24-(g+2)%4*8&255,_=y<<16|E<<8|b,v=0;v<4&&g+v*.75<f;v++)p.push(h.charAt(_>>>6*(3-v)&63));var A=h.charAt(64);if(A)for(;p.length%4;)p.push(A);return p.join("")},parse:function(l,c){c===void 0&&(c=!0);var u=l.length,f=c?this._safe_map:this._map,h=this._reverseMap;if(!h){h=this._reverseMap=[];for(var p=0;p<f.length;p++)h[f.charCodeAt(p)]=p}var g=f.charAt(64);if(g){var y=l.indexOf(g);y!==-1&&(u=y)}return o(l,u,h)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function o(l,c,u){for(var f=[],h=0,p=0;p<c;p++)if(p%4){var g=u[l.charCodeAt(p-1)]<<p%4*2,y=u[l.charCodeAt(p)]>>>6-p%4*2,E=g|y;f[h>>>2]|=E<<24-h%4*8,h++}return i.create(f,h)}}(),r.enc.Base64url})}(Om)),Om.exports}var Mm={exports:{}},tb;function xl(){return tb||(tb=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[];(function(){for(var y=0;y<64;y++)c[y]=n.abs(n.sin(y+1))*4294967296|0})();var u=l.MD5=o.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,E){for(var b=0;b<16;b++){var _=E+b,v=y[_];y[_]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}var A=this._hash.words,D=y[E+0],k=y[E+1],T=y[E+2],x=y[E+3],m=y[E+4],S=y[E+5],I=y[E+6],C=y[E+7],F=y[E+8],W=y[E+9],P=y[E+10],R=y[E+11],N=y[E+12],M=y[E+13],O=y[E+14],G=y[E+15],z=A[0],j=A[1],H=A[2],V=A[3];z=f(z,j,H,V,D,7,c[0]),V=f(V,z,j,H,k,12,c[1]),H=f(H,V,z,j,T,17,c[2]),j=f(j,H,V,z,x,22,c[3]),z=f(z,j,H,V,m,7,c[4]),V=f(V,z,j,H,S,12,c[5]),H=f(H,V,z,j,I,17,c[6]),j=f(j,H,V,z,C,22,c[7]),z=f(z,j,H,V,F,7,c[8]),V=f(V,z,j,H,W,12,c[9]),H=f(H,V,z,j,P,17,c[10]),j=f(j,H,V,z,R,22,c[11]),z=f(z,j,H,V,N,7,c[12]),V=f(V,z,j,H,M,12,c[13]),H=f(H,V,z,j,O,17,c[14]),j=f(j,H,V,z,G,22,c[15]),z=h(z,j,H,V,k,5,c[16]),V=h(V,z,j,H,I,9,c[17]),H=h(H,V,z,j,R,14,c[18]),j=h(j,H,V,z,D,20,c[19]),z=h(z,j,H,V,S,5,c[20]),V=h(V,z,j,H,P,9,c[21]),H=h(H,V,z,j,G,14,c[22]),j=h(j,H,V,z,m,20,c[23]),z=h(z,j,H,V,W,5,c[24]),V=h(V,z,j,H,O,9,c[25]),H=h(H,V,z,j,x,14,c[26]),j=h(j,H,V,z,F,20,c[27]),z=h(z,j,H,V,M,5,c[28]),V=h(V,z,j,H,T,9,c[29]),H=h(H,V,z,j,C,14,c[30]),j=h(j,H,V,z,N,20,c[31]),z=p(z,j,H,V,S,4,c[32]),V=p(V,z,j,H,F,11,c[33]),H=p(H,V,z,j,R,16,c[34]),j=p(j,H,V,z,O,23,c[35]),z=p(z,j,H,V,k,4,c[36]),V=p(V,z,j,H,m,11,c[37]),H=p(H,V,z,j,C,16,c[38]),j=p(j,H,V,z,P,23,c[39]),z=p(z,j,H,V,M,4,c[40]),V=p(V,z,j,H,D,11,c[41]),H=p(H,V,z,j,x,16,c[42]),j=p(j,H,V,z,I,23,c[43]),z=p(z,j,H,V,W,4,c[44]),V=p(V,z,j,H,N,11,c[45]),H=p(H,V,z,j,G,16,c[46]),j=p(j,H,V,z,T,23,c[47]),z=g(z,j,H,V,D,6,c[48]),V=g(V,z,j,H,C,10,c[49]),H=g(H,V,z,j,O,15,c[50]),j=g(j,H,V,z,S,21,c[51]),z=g(z,j,H,V,N,6,c[52]),V=g(V,z,j,H,x,10,c[53]),H=g(H,V,z,j,P,15,c[54]),j=g(j,H,V,z,k,21,c[55]),z=g(z,j,H,V,F,6,c[56]),V=g(V,z,j,H,G,10,c[57]),H=g(H,V,z,j,I,15,c[58]),j=g(j,H,V,z,M,21,c[59]),z=g(z,j,H,V,m,6,c[60]),V=g(V,z,j,H,R,10,c[61]),H=g(H,V,z,j,T,15,c[62]),j=g(j,H,V,z,W,21,c[63]),A[0]=A[0]+z|0,A[1]=A[1]+j|0,A[2]=A[2]+H|0,A[3]=A[3]+V|0},_doFinalize:function(){var y=this._data,E=y.words,b=this._nDataBytes*8,_=y.sigBytes*8;E[_>>>5]|=128<<24-_%32;var v=n.floor(b/4294967296),A=b;E[(_+64>>>9<<4)+15]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,E[(_+64>>>9<<4)+14]=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360,y.sigBytes=(E.length+1)*4,this._process();for(var D=this._hash,k=D.words,T=0;T<4;T++){var x=k[T];k[T]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360}return D},clone:function(){var y=o.clone.call(this);return y._hash=this._hash.clone(),y}});function f(y,E,b,_,v,A,D){var k=y+(E&b|~E&_)+v+D;return(k<<A|k>>>32-A)+E}function h(y,E,b,_,v,A,D){var k=y+(E&_|b&~_)+v+D;return(k<<A|k>>>32-A)+E}function p(y,E,b,_,v,A,D){var k=y+(E^b^_)+v+D;return(k<<A|k>>>32-A)+E}function g(y,E,b,_,v,A,D){var k=y+(b^(E|~_))+v+D;return(k<<A|k>>>32-A)+E}s.MD5=o._createHelper(u),s.HmacMD5=o._createHmacHelper(u)}(Math),r.MD5})}(Mm)),Mm.exports}var Lm={exports:{}},rb;function EI(){return rb||(rb=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=s.Hasher,o=n.algo,l=[],c=o.SHA1=a.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,f){for(var h=this._hash.words,p=h[0],g=h[1],y=h[2],E=h[3],b=h[4],_=0;_<80;_++){if(_<16)l[_]=u[f+_]|0;else{var v=l[_-3]^l[_-8]^l[_-14]^l[_-16];l[_]=v<<1|v>>>31}var A=(p<<5|p>>>27)+b+l[_];_<20?A+=(g&y|~g&E)+1518500249:_<40?A+=(g^y^E)+1859775393:_<60?A+=(g&y|g&E|y&E)-1894007588:A+=(g^y^E)-899497514,b=E,E=y,y=g<<30|g>>>2,g=p,p=A}h[0]=h[0]+p|0,h[1]=h[1]+g|0,h[2]=h[2]+y|0,h[3]=h[3]+E|0,h[4]=h[4]+b|0},_doFinalize:function(){var u=this._data,f=u.words,h=this._nDataBytes*8,p=u.sigBytes*8;return f[p>>>5]|=128<<24-p%32,f[(p+64>>>9<<4)+14]=Math.floor(h/4294967296),f[(p+64>>>9<<4)+15]=h,u.sigBytes=f.length*4,this._process(),this._hash},clone:function(){var u=a.clone.call(this);return u._hash=this._hash.clone(),u}});n.SHA1=a._createHelper(c),n.HmacSHA1=a._createHmacHelper(c)}(),r.SHA1})}(Lm)),Lm.exports}var Bm={exports:{}},nb;function tx(){return nb||(nb=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=[],u=[];(function(){function p(b){for(var _=n.sqrt(b),v=2;v<=_;v++)if(!(b%v))return!1;return!0}function g(b){return(b-(b|0))*4294967296|0}for(var y=2,E=0;E<64;)p(y)&&(E<8&&(c[E]=g(n.pow(y,1/2))),u[E]=g(n.pow(y,1/3)),E++),y++})();var f=[],h=l.SHA256=o.extend({_doReset:function(){this._hash=new a.init(c.slice(0))},_doProcessBlock:function(p,g){for(var y=this._hash.words,E=y[0],b=y[1],_=y[2],v=y[3],A=y[4],D=y[5],k=y[6],T=y[7],x=0;x<64;x++){if(x<16)f[x]=p[g+x]|0;else{var m=f[x-15],S=(m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3,I=f[x-2],C=(I<<15|I>>>17)^(I<<13|I>>>19)^I>>>10;f[x]=S+f[x-7]+C+f[x-16]}var F=A&D^~A&k,W=E&b^E&_^b&_,P=(E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22),R=(A<<26|A>>>6)^(A<<21|A>>>11)^(A<<7|A>>>25),N=T+R+F+u[x]+f[x],M=P+W;T=k,k=D,D=A,A=v+N|0,v=_,_=b,b=E,E=N+M|0}y[0]=y[0]+E|0,y[1]=y[1]+b|0,y[2]=y[2]+_|0,y[3]=y[3]+v|0,y[4]=y[4]+A|0,y[5]=y[5]+D|0,y[6]=y[6]+k|0,y[7]=y[7]+T|0},_doFinalize:function(){var p=this._data,g=p.words,y=this._nDataBytes*8,E=p.sigBytes*8;return g[E>>>5]|=128<<24-E%32,g[(E+64>>>9<<4)+14]=n.floor(y/4294967296),g[(E+64>>>9<<4)+15]=y,p.sigBytes=g.length*4,this._process(),this._hash},clone:function(){var p=o.clone.call(this);return p._hash=this._hash.clone(),p}});s.SHA256=o._createHelper(h),s.HmacSHA256=o._createHmacHelper(h)}(Math),r.SHA256})}(Bm)),Bm.exports}var Um={exports:{}},sb;function jU(){return sb||(sb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),tx())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=n.algo,o=a.SHA256,l=a.SHA224=o.extend({_doReset:function(){this._hash=new i.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var c=o._doFinalize.call(this);return c.sigBytes-=4,c}});n.SHA224=o._createHelper(l),n.HmacSHA224=o._createHmacHelper(l)}(),r.SHA224})}(Um)),Um.exports}var $m={exports:{}},ab;function _I(){return ab||(ab=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Up())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.Hasher,a=n.x64,o=a.Word,l=a.WordArray,c=n.algo;function u(){return o.create.apply(o,arguments)}var f=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],h=[];(function(){for(var g=0;g<80;g++)h[g]=u()})();var p=c.SHA512=i.extend({_doReset:function(){this._hash=new l.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(g,y){for(var E=this._hash.words,b=E[0],_=E[1],v=E[2],A=E[3],D=E[4],k=E[5],T=E[6],x=E[7],m=b.high,S=b.low,I=_.high,C=_.low,F=v.high,W=v.low,P=A.high,R=A.low,N=D.high,M=D.low,O=k.high,G=k.low,z=T.high,j=T.low,H=x.high,V=x.low,te=m,oe=S,ne=I,le=C,J=F,Q=W,ve=P,ee=R,K=N,Y=M,pe=O,xe=G,ae=z,de=j,Ee=H,he=V,Ce=0;Ce<80;Ce++){var Te,Ge,Ie=h[Ce];if(Ce<16)Ge=Ie.high=g[y+Ce*2]|0,Te=Ie.low=g[y+Ce*2+1]|0;else{var Ve=h[Ce-15],Ue=Ve.high,ze=Ve.low,Ke=(Ue>>>1|ze<<31)^(Ue>>>8|ze<<24)^Ue>>>7,ue=(ze>>>1|Ue<<31)^(ze>>>8|Ue<<24)^(ze>>>7|Ue<<25),be=h[Ce-2],Ae=be.high,Me=be.low,We=(Ae>>>19|Me<<13)^(Ae<<3|Me>>>29)^Ae>>>6,lt=(Me>>>19|Ae<<13)^(Me<<3|Ae>>>29)^(Me>>>6|Ae<<26),yt=h[Ce-7],_t=yt.high,$t=yt.low,ht=h[Ce-16],ct=ht.high,pt=ht.low;Te=ue+$t,Ge=Ke+_t+(Te>>>0<ue>>>0?1:0),Te=Te+lt,Ge=Ge+We+(Te>>>0<lt>>>0?1:0),Te=Te+pt,Ge=Ge+ct+(Te>>>0<pt>>>0?1:0),Ie.high=Ge,Ie.low=Te}var Ct=K&pe^~K&ae,Rt=Y&xe^~Y&de,mr=te&ne^te&J^ne&J,mn=oe&le^oe&Q^le&Q,Qs=(te>>>28|oe<<4)^(te<<30|oe>>>2)^(te<<25|oe>>>7),ms=(oe>>>28|te<<4)^(oe<<30|te>>>2)^(oe<<25|te>>>7),wl=(K>>>14|Y<<18)^(K>>>18|Y<<14)^(K<<23|Y>>>9),za=(Y>>>14|K<<18)^(Y>>>18|K<<14)^(Y<<23|K>>>9),So=f[Ce],ln=So.high,Ao=So.low,Rr=he+za,Ln=Ee+wl+(Rr>>>0<he>>>0?1:0),Rr=Rr+Rt,Ln=Ln+Ct+(Rr>>>0<Rt>>>0?1:0),Rr=Rr+Ao,Ln=Ln+ln+(Rr>>>0<Ao>>>0?1:0),Rr=Rr+Te,Ln=Ln+Ge+(Rr>>>0<Te>>>0?1:0),Cl=ms+mn,qc=Qs+mr+(Cl>>>0<ms>>>0?1:0);Ee=ae,he=de,ae=pe,de=xe,pe=K,xe=Y,Y=ee+Rr|0,K=ve+Ln+(Y>>>0<ee>>>0?1:0)|0,ve=J,ee=Q,J=ne,Q=le,ne=te,le=oe,oe=Rr+Cl|0,te=Ln+qc+(oe>>>0<Rr>>>0?1:0)|0}S=b.low=S+oe,b.high=m+te+(S>>>0<oe>>>0?1:0),C=_.low=C+le,_.high=I+ne+(C>>>0<le>>>0?1:0),W=v.low=W+Q,v.high=F+J+(W>>>0<Q>>>0?1:0),R=A.low=R+ee,A.high=P+ve+(R>>>0<ee>>>0?1:0),M=D.low=M+Y,D.high=N+K+(M>>>0<Y>>>0?1:0),G=k.low=G+xe,k.high=O+pe+(G>>>0<xe>>>0?1:0),j=T.low=j+de,T.high=z+ae+(j>>>0<de>>>0?1:0),V=x.low=V+he,x.high=H+Ee+(V>>>0<he>>>0?1:0)},_doFinalize:function(){var g=this._data,y=g.words,E=this._nDataBytes*8,b=g.sigBytes*8;y[b>>>5]|=128<<24-b%32,y[(b+128>>>10<<5)+30]=Math.floor(E/4294967296),y[(b+128>>>10<<5)+31]=E,g.sigBytes=y.length*4,this._process();var _=this._hash.toX32();return _},clone:function(){var g=i.clone.call(this);return g._hash=this._hash.clone(),g},blockSize:1024/32});n.SHA512=i._createHelper(p),n.HmacSHA512=i._createHmacHelper(p)}(),r.SHA512})}($m)),$m.exports}var Vm={exports:{}},ib;function GU(){return ib||(ib=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Up(),_I())})(Vt,function(r){return function(){var n=r,s=n.x64,i=s.Word,a=s.WordArray,o=n.algo,l=o.SHA512,c=o.SHA384=l.extend({_doReset:function(){this._hash=new a.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var u=l._doFinalize.call(this);return u.sigBytes-=16,u}});n.SHA384=l._createHelper(c),n.HmacSHA384=l._createHmacHelper(c)}(),r.SHA384})}(Vm)),Vm.exports}var Hm={exports:{}},ob;function WU(){return ob||(ob=1,function(t,e){(function(r,n,s){t.exports=n(tr(),Up())})(Vt,function(r){return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.x64,c=l.Word,u=s.algo,f=[],h=[],p=[];(function(){for(var E=1,b=0,_=0;_<24;_++){f[E+5*b]=(_+1)*(_+2)/2%64;var v=b%5,A=(2*E+3*b)%5;E=v,b=A}for(var E=0;E<5;E++)for(var b=0;b<5;b++)h[E+5*b]=b+(2*E+3*b)%5*5;for(var D=1,k=0;k<24;k++){for(var T=0,x=0,m=0;m<7;m++){if(D&1){var S=(1<<m)-1;S<32?x^=1<<S:T^=1<<S-32}D&128?D=D<<1^113:D<<=1}p[k]=c.create(T,x)}})();var g=[];(function(){for(var E=0;E<25;E++)g[E]=c.create()})();var y=u.SHA3=o.extend({cfg:o.cfg.extend({outputLength:512}),_doReset:function(){for(var E=this._state=[],b=0;b<25;b++)E[b]=new c.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(E,b){for(var _=this._state,v=this.blockSize/2,A=0;A<v;A++){var D=E[b+2*A],k=E[b+2*A+1];D=(D<<8|D>>>24)&16711935|(D<<24|D>>>8)&4278255360,k=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360;var T=_[A];T.high^=k,T.low^=D}for(var x=0;x<24;x++){for(var m=0;m<5;m++){for(var S=0,I=0,C=0;C<5;C++){var T=_[m+5*C];S^=T.high,I^=T.low}var F=g[m];F.high=S,F.low=I}for(var m=0;m<5;m++)for(var W=g[(m+4)%5],P=g[(m+1)%5],R=P.high,N=P.low,S=W.high^(R<<1|N>>>31),I=W.low^(N<<1|R>>>31),C=0;C<5;C++){var T=_[m+5*C];T.high^=S,T.low^=I}for(var M=1;M<25;M++){var S,I,T=_[M],O=T.high,G=T.low,z=f[M];z<32?(S=O<<z|G>>>32-z,I=G<<z|O>>>32-z):(S=G<<z-32|O>>>64-z,I=O<<z-32|G>>>64-z);var j=g[h[M]];j.high=S,j.low=I}var H=g[0],V=_[0];H.high=V.high,H.low=V.low;for(var m=0;m<5;m++)for(var C=0;C<5;C++){var M=m+5*C,T=_[M],te=g[M],oe=g[(m+1)%5+5*C],ne=g[(m+2)%5+5*C];T.high=te.high^~oe.high&ne.high,T.low=te.low^~oe.low&ne.low}var T=_[0],le=p[x];T.high^=le.high,T.low^=le.low}},_doFinalize:function(){var E=this._data,b=E.words;this._nDataBytes*8;var _=E.sigBytes*8,v=this.blockSize*32;b[_>>>5]|=1<<24-_%32,b[(n.ceil((_+1)/v)*v>>>5)-1]|=128,E.sigBytes=b.length*4,this._process();for(var A=this._state,D=this.cfg.outputLength/8,k=D/8,T=[],x=0;x<k;x++){var m=A[x],S=m.high,I=m.low;S=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,I=(I<<8|I>>>24)&16711935|(I<<24|I>>>8)&4278255360,T.push(I),T.push(S)}return new a.init(T,D)},clone:function(){for(var E=o.clone.call(this),b=E._state=this._state.slice(0),_=0;_<25;_++)b[_]=b[_].clone();return E}});s.SHA3=o._createHelper(y),s.HmacSHA3=o._createHmacHelper(y)}(Math),r.SHA3})}(Hm)),Hm.exports}var jm={exports:{}},lb;function zU(){return lb||(lb=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(n){var s=r,i=s.lib,a=i.WordArray,o=i.Hasher,l=s.algo,c=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),h=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=a.create([0,1518500249,1859775393,2400959708,2840853838]),g=a.create([1352829926,1548603684,1836072691,2053994217,0]),y=l.RIPEMD160=o.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(k,T){for(var x=0;x<16;x++){var m=T+x,S=k[m];k[m]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}var I=this._hash.words,C=p.words,F=g.words,W=c.words,P=u.words,R=f.words,N=h.words,M,O,G,z,j,H,V,te,oe,ne;H=M=I[0],V=O=I[1],te=G=I[2],oe=z=I[3],ne=j=I[4];for(var le,x=0;x<80;x+=1)le=M+k[T+W[x]]|0,x<16?le+=E(O,G,z)+C[0]:x<32?le+=b(O,G,z)+C[1]:x<48?le+=_(O,G,z)+C[2]:x<64?le+=v(O,G,z)+C[3]:le+=A(O,G,z)+C[4],le=le|0,le=D(le,R[x]),le=le+j|0,M=j,j=z,z=D(G,10),G=O,O=le,le=H+k[T+P[x]]|0,x<16?le+=A(V,te,oe)+F[0]:x<32?le+=v(V,te,oe)+F[1]:x<48?le+=_(V,te,oe)+F[2]:x<64?le+=b(V,te,oe)+F[3]:le+=E(V,te,oe)+F[4],le=le|0,le=D(le,N[x]),le=le+ne|0,H=ne,ne=oe,oe=D(te,10),te=V,V=le;le=I[1]+G+oe|0,I[1]=I[2]+z+ne|0,I[2]=I[3]+j+H|0,I[3]=I[4]+M+V|0,I[4]=I[0]+O+te|0,I[0]=le},_doFinalize:function(){var k=this._data,T=k.words,x=this._nDataBytes*8,m=k.sigBytes*8;T[m>>>5]|=128<<24-m%32,T[(m+64>>>9<<4)+14]=(x<<8|x>>>24)&16711935|(x<<24|x>>>8)&4278255360,k.sigBytes=(T.length+1)*4,this._process();for(var S=this._hash,I=S.words,C=0;C<5;C++){var F=I[C];I[C]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360}return S},clone:function(){var k=o.clone.call(this);return k._hash=this._hash.clone(),k}});function E(k,T,x){return k^T^x}function b(k,T,x){return k&T|~k&x}function _(k,T,x){return(k|~T)^x}function v(k,T,x){return k&x|T&~x}function A(k,T,x){return k^(T|~x)}function D(k,T){return k<<T|k>>>32-T}s.RIPEMD160=o._createHelper(y),s.HmacRIPEMD160=o._createHmacHelper(y)}(),r.RIPEMD160})}(jm)),jm.exports}var Gm={exports:{}},cb;function rx(){return cb||(cb=1,function(t,e){(function(r,n){t.exports=n(tr())})(Vt,function(r){(function(){var n=r,s=n.lib,i=s.Base,a=n.enc,o=a.Utf8,l=n.algo;l.HMAC=i.extend({init:function(c,u){c=this._hasher=new c.init,typeof u=="string"&&(u=o.parse(u));var f=c.blockSize,h=f*4;u.sigBytes>h&&(u=c.finalize(u)),u.clamp();for(var p=this._oKey=u.clone(),g=this._iKey=u.clone(),y=p.words,E=g.words,b=0;b<f;b++)y[b]^=1549556828,E[b]^=909522486;p.sigBytes=g.sigBytes=h,this.reset()},reset:function(){var c=this._hasher;c.reset(),c.update(this._iKey)},update:function(c){return this._hasher.update(c),this},finalize:function(c){var u=this._hasher,f=u.finalize(c);u.reset();var h=u.finalize(this._oKey.clone().concat(f));return h}})})()})}(Gm)),Gm.exports}var Wm={exports:{}},ub;function KU(){return ub||(ub=1,function(t,e){(function(r,n,s){t.exports=n(tr(),tx(),rx())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.Base,a=s.WordArray,o=n.algo,l=o.SHA256,c=o.HMAC,u=o.PBKDF2=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:25e4}),init:function(f){this.cfg=this.cfg.extend(f)},compute:function(f,h){for(var p=this.cfg,g=c.create(p.hasher,f),y=a.create(),E=a.create([1]),b=y.words,_=E.words,v=p.keySize,A=p.iterations;b.length<v;){var D=g.update(h).finalize(E);g.reset();for(var k=D.words,T=k.length,x=D,m=1;m<A;m++){x=g.finalize(x),g.reset();for(var S=x.words,I=0;I<T;I++)k[I]^=S[I]}y.concat(D),_[0]++}return y.sigBytes=v*4,y}});n.PBKDF2=function(f,h,p){return u.create(p).compute(f,h)}}(),r.PBKDF2})}(Wm)),Wm.exports}var zm={exports:{}},db;function _o(){return db||(db=1,function(t,e){(function(r,n,s){t.exports=n(tr(),EI(),rx())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.Base,a=s.WordArray,o=n.algo,l=o.MD5,c=o.EvpKDF=i.extend({cfg:i.extend({keySize:128/32,hasher:l,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,f){for(var h,p=this.cfg,g=p.hasher.create(),y=a.create(),E=y.words,b=p.keySize,_=p.iterations;E.length<b;){h&&g.update(h),h=g.update(u).finalize(f),g.reset();for(var v=1;v<_;v++)h=g.finalize(h),g.reset();y.concat(h)}return y.sigBytes=b*4,y}});n.EvpKDF=function(u,f,h){return c.create(h).compute(u,f)}}(),r.EvpKDF})}(zm)),zm.exports}var Km={exports:{}},fb;function bn(){return fb||(fb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),_o())})(Vt,function(r){r.lib.Cipher||function(n){var s=r,i=s.lib,a=i.Base,o=i.WordArray,l=i.BufferedBlockAlgorithm,c=s.enc;c.Utf8;var u=c.Base64,f=s.algo,h=f.EvpKDF,p=i.Cipher=l.extend({cfg:a.extend(),createEncryptor:function(S,I){return this.create(this._ENC_XFORM_MODE,S,I)},createDecryptor:function(S,I){return this.create(this._DEC_XFORM_MODE,S,I)},init:function(S,I,C){this.cfg=this.cfg.extend(C),this._xformMode=S,this._key=I,this.reset()},reset:function(){l.reset.call(this),this._doReset()},process:function(S){return this._append(S),this._process()},finalize:function(S){S&&this._append(S);var I=this._doFinalize();return I},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function S(I){return typeof I=="string"?m:k}return function(I){return{encrypt:function(C,F,W){return S(F).encrypt(I,C,F,W)},decrypt:function(C,F,W){return S(F).decrypt(I,C,F,W)}}}}()});i.StreamCipher=p.extend({_doFinalize:function(){var S=this._process(!0);return S},blockSize:1});var g=s.mode={},y=i.BlockCipherMode=a.extend({createEncryptor:function(S,I){return this.Encryptor.create(S,I)},createDecryptor:function(S,I){return this.Decryptor.create(S,I)},init:function(S,I){this._cipher=S,this._iv=I}}),E=g.CBC=function(){var S=y.extend();S.Encryptor=S.extend({processBlock:function(C,F){var W=this._cipher,P=W.blockSize;I.call(this,C,F,P),W.encryptBlock(C,F),this._prevBlock=C.slice(F,F+P)}}),S.Decryptor=S.extend({processBlock:function(C,F){var W=this._cipher,P=W.blockSize,R=C.slice(F,F+P);W.decryptBlock(C,F),I.call(this,C,F,P),this._prevBlock=R}});function I(C,F,W){var P,R=this._iv;R?(P=R,this._iv=n):P=this._prevBlock;for(var N=0;N<W;N++)C[F+N]^=P[N]}return S}(),b=s.pad={},_=b.Pkcs7={pad:function(S,I){for(var C=I*4,F=C-S.sigBytes%C,W=F<<24|F<<16|F<<8|F,P=[],R=0;R<F;R+=4)P.push(W);var N=o.create(P,F);S.concat(N)},unpad:function(S){var I=S.words[S.sigBytes-1>>>2]&255;S.sigBytes-=I}};i.BlockCipher=p.extend({cfg:p.cfg.extend({mode:E,padding:_}),reset:function(){var S;p.reset.call(this);var I=this.cfg,C=I.iv,F=I.mode;this._xformMode==this._ENC_XFORM_MODE?S=F.createEncryptor:(S=F.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==S?this._mode.init(this,C&&C.words):(this._mode=S.call(F,this,C&&C.words),this._mode.__creator=S)},_doProcessBlock:function(S,I){this._mode.processBlock(S,I)},_doFinalize:function(){var S,I=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(I.pad(this._data,this.blockSize),S=this._process(!0)):(S=this._process(!0),I.unpad(S)),S},blockSize:128/32});var v=i.CipherParams=a.extend({init:function(S){this.mixIn(S)},toString:function(S){return(S||this.formatter).stringify(this)}}),A=s.format={},D=A.OpenSSL={stringify:function(S){var I,C=S.ciphertext,F=S.salt;return F?I=o.create([1398893684,1701076831]).concat(F).concat(C):I=C,I.toString(u)},parse:function(S){var I,C=u.parse(S),F=C.words;return F[0]==1398893684&&F[1]==1701076831&&(I=o.create(F.slice(2,4)),F.splice(0,4),C.sigBytes-=16),v.create({ciphertext:C,salt:I})}},k=i.SerializableCipher=a.extend({cfg:a.extend({format:D}),encrypt:function(S,I,C,F){F=this.cfg.extend(F);var W=S.createEncryptor(C,F),P=W.finalize(I),R=W.cfg;return v.create({ciphertext:P,key:C,iv:R.iv,algorithm:S,mode:R.mode,padding:R.padding,blockSize:S.blockSize,formatter:F.format})},decrypt:function(S,I,C,F){F=this.cfg.extend(F),I=this._parse(I,F.format);var W=S.createDecryptor(C,F).finalize(I.ciphertext);return W},_parse:function(S,I){return typeof S=="string"?I.parse(S,this):S}}),T=s.kdf={},x=T.OpenSSL={execute:function(S,I,C,F,W){if(F||(F=o.random(64/8)),W)var P=h.create({keySize:I+C,hasher:W}).compute(S,F);else var P=h.create({keySize:I+C}).compute(S,F);var R=o.create(P.words.slice(I),C*4);return P.sigBytes=I*4,v.create({key:P,iv:R,salt:F})}},m=i.PasswordBasedCipher=k.extend({cfg:k.cfg.extend({kdf:x}),encrypt:function(S,I,C,F){F=this.cfg.extend(F);var W=F.kdf.execute(C,S.keySize,S.ivSize,F.salt,F.hasher);F.iv=W.iv;var P=k.encrypt.call(this,S,I,W.key,F);return P.mixIn(W),P},decrypt:function(S,I,C,F){F=this.cfg.extend(F),I=this._parse(I,F.format);var W=F.kdf.execute(C,S.keySize,S.ivSize,I.salt,F.hasher);F.iv=W.iv;var P=k.decrypt.call(this,S,I,W.key,F);return P}})}()})}(Km)),Km.exports}var qm={exports:{}},hb;function qU(){return hb||(hb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.mode.CFB=function(){var n=r.lib.BlockCipherMode.extend();n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize;s.call(this,i,a,l,o),this._prevBlock=i.slice(a,a+l)}}),n.Decryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=i.slice(a,a+l);s.call(this,i,a,l,o),this._prevBlock=c}});function s(i,a,o,l){var c,u=this._iv;u?(c=u.slice(0),this._iv=void 0):c=this._prevBlock,l.encryptBlock(c,0);for(var f=0;f<o;f++)i[a+f]^=c[f]}return n}(),r.mode.CFB})}(qm)),qm.exports}var Xm={exports:{}},pb;function XU(){return pb||(pb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.mode.CTR=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._counter;c&&(u=this._counter=c.slice(0),this._iv=void 0);var f=u.slice(0);o.encryptBlock(f,0),u[l-1]=u[l-1]+1|0;for(var h=0;h<l;h++)i[a+h]^=f[h]}});return n.Decryptor=s,n}(),r.mode.CTR})}(Xm)),Xm.exports}var Ym={exports:{}},mb;function YU(){return mb||(mb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return r.mode.CTRGladman=function(){var n=r.lib.BlockCipherMode.extend();function s(o){if((o>>24&255)===255){var l=o>>16&255,c=o>>8&255,u=o&255;l===255?(l=0,c===255?(c=0,u===255?u=0:++u):++c):++l,o=0,o+=l<<16,o+=c<<8,o+=u}else o+=1<<24;return o}function i(o){return(o[0]=s(o[0]))===0&&(o[1]=s(o[1])),o}var a=n.Encryptor=n.extend({processBlock:function(o,l){var c=this._cipher,u=c.blockSize,f=this._iv,h=this._counter;f&&(h=this._counter=f.slice(0),this._iv=void 0),i(h);var p=h.slice(0);c.encryptBlock(p,0);for(var g=0;g<u;g++)o[l+g]^=p[g]}});return n.Decryptor=a,n}(),r.mode.CTRGladman})}(Ym)),Ym.exports}var Qm={exports:{}},gb;function QU(){return gb||(gb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.mode.OFB=function(){var n=r.lib.BlockCipherMode.extend(),s=n.Encryptor=n.extend({processBlock:function(i,a){var o=this._cipher,l=o.blockSize,c=this._iv,u=this._keystream;c&&(u=this._keystream=c.slice(0),this._iv=void 0),o.encryptBlock(u,0);for(var f=0;f<l;f++)i[a+f]^=u[f]}});return n.Decryptor=s,n}(),r.mode.OFB})}(Qm)),Qm.exports}var Jm={exports:{}},vb;function JU(){return vb||(vb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.mode.ECB=function(){var n=r.lib.BlockCipherMode.extend();return n.Encryptor=n.extend({processBlock:function(s,i){this._cipher.encryptBlock(s,i)}}),n.Decryptor=n.extend({processBlock:function(s,i){this._cipher.decryptBlock(s,i)}}),n}(),r.mode.ECB})}(Jm)),Jm.exports}var Zm={exports:{}},yb;function ZU(){return yb||(yb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.pad.AnsiX923={pad:function(n,s){var i=n.sigBytes,a=s*4,o=a-i%a,l=i+o-1;n.clamp(),n.words[l>>>2]|=o<<24-l%4*8,n.sigBytes+=o},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Ansix923})}(Zm)),Zm.exports}var eg={exports:{}},xb;function e$(){return xb||(xb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.pad.Iso10126={pad:function(n,s){var i=s*4,a=i-n.sigBytes%i;n.concat(r.lib.WordArray.random(a-1)).concat(r.lib.WordArray.create([a<<24],1))},unpad:function(n){var s=n.words[n.sigBytes-1>>>2]&255;n.sigBytes-=s}},r.pad.Iso10126})}(eg)),eg.exports}var tg={exports:{}},Eb;function t$(){return Eb||(Eb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.pad.Iso97971={pad:function(n,s){n.concat(r.lib.WordArray.create([2147483648],1)),r.pad.ZeroPadding.pad(n,s)},unpad:function(n){r.pad.ZeroPadding.unpad(n),n.sigBytes--}},r.pad.Iso97971})}(tg)),tg.exports}var rg={exports:{}},_b;function r$(){return _b||(_b=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.pad.ZeroPadding={pad:function(n,s){var i=s*4;n.clamp(),n.sigBytes+=i-(n.sigBytes%i||i)},unpad:function(n){for(var s=n.words,i=n.sigBytes-1,i=n.sigBytes-1;i>=0;i--)if(s[i>>>2]>>>24-i%4*8&255){n.sigBytes=i+1;break}}},r.pad.ZeroPadding})}(rg)),rg.exports}var ng={exports:{}},bb;function n$(){return bb||(bb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return r.pad.NoPadding={pad:function(){},unpad:function(){}},r.pad.NoPadding})}(ng)),ng.exports}var sg={exports:{}},Sb;function s$(){return Sb||(Sb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),bn())})(Vt,function(r){return function(n){var s=r,i=s.lib,a=i.CipherParams,o=s.enc,l=o.Hex,c=s.format;c.Hex={stringify:function(u){return u.ciphertext.toString(l)},parse:function(u){var f=l.parse(u);return a.create({ciphertext:f})}}}(),r.format.Hex})}(sg)),sg.exports}var ag={exports:{}},Ab;function a$(){return Ab||(Ab=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),_o(),bn())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.BlockCipher,a=n.algo,o=[],l=[],c=[],u=[],f=[],h=[],p=[],g=[],y=[],E=[];(function(){for(var v=[],A=0;A<256;A++)A<128?v[A]=A<<1:v[A]=A<<1^283;for(var D=0,k=0,A=0;A<256;A++){var T=k^k<<1^k<<2^k<<3^k<<4;T=T>>>8^T&255^99,o[D]=T,l[T]=D;var x=v[D],m=v[x],S=v[m],I=v[T]*257^T*16843008;c[D]=I<<24|I>>>8,u[D]=I<<16|I>>>16,f[D]=I<<8|I>>>24,h[D]=I;var I=S*16843009^m*65537^x*257^D*16843008;p[T]=I<<24|I>>>8,g[T]=I<<16|I>>>16,y[T]=I<<8|I>>>24,E[T]=I,D?(D=x^v[v[v[S^x]]],k^=v[v[k]]):D=k=1}})();var b=[0,1,2,4,8,16,32,64,128,27,54],_=a.AES=i.extend({_doReset:function(){var v;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var A=this._keyPriorReset=this._key,D=A.words,k=A.sigBytes/4,T=this._nRounds=k+6,x=(T+1)*4,m=this._keySchedule=[],S=0;S<x;S++)S<k?m[S]=D[S]:(v=m[S-1],S%k?k>6&&S%k==4&&(v=o[v>>>24]<<24|o[v>>>16&255]<<16|o[v>>>8&255]<<8|o[v&255]):(v=v<<8|v>>>24,v=o[v>>>24]<<24|o[v>>>16&255]<<16|o[v>>>8&255]<<8|o[v&255],v^=b[S/k|0]<<24),m[S]=m[S-k]^v);for(var I=this._invKeySchedule=[],C=0;C<x;C++){var S=x-C;if(C%4)var v=m[S];else var v=m[S-4];C<4||S<=4?I[C]=v:I[C]=p[o[v>>>24]]^g[o[v>>>16&255]]^y[o[v>>>8&255]]^E[o[v&255]]}}},encryptBlock:function(v,A){this._doCryptBlock(v,A,this._keySchedule,c,u,f,h,o)},decryptBlock:function(v,A){var D=v[A+1];v[A+1]=v[A+3],v[A+3]=D,this._doCryptBlock(v,A,this._invKeySchedule,p,g,y,E,l);var D=v[A+1];v[A+1]=v[A+3],v[A+3]=D},_doCryptBlock:function(v,A,D,k,T,x,m,S){for(var I=this._nRounds,C=v[A]^D[0],F=v[A+1]^D[1],W=v[A+2]^D[2],P=v[A+3]^D[3],R=4,N=1;N<I;N++){var M=k[C>>>24]^T[F>>>16&255]^x[W>>>8&255]^m[P&255]^D[R++],O=k[F>>>24]^T[W>>>16&255]^x[P>>>8&255]^m[C&255]^D[R++],G=k[W>>>24]^T[P>>>16&255]^x[C>>>8&255]^m[F&255]^D[R++],z=k[P>>>24]^T[C>>>16&255]^x[F>>>8&255]^m[W&255]^D[R++];C=M,F=O,W=G,P=z}var M=(S[C>>>24]<<24|S[F>>>16&255]<<16|S[W>>>8&255]<<8|S[P&255])^D[R++],O=(S[F>>>24]<<24|S[W>>>16&255]<<16|S[P>>>8&255]<<8|S[C&255])^D[R++],G=(S[W>>>24]<<24|S[P>>>16&255]<<16|S[C>>>8&255]<<8|S[F&255])^D[R++],z=(S[P>>>24]<<24|S[C>>>16&255]<<16|S[F>>>8&255]<<8|S[W&255])^D[R++];v[A]=M,v[A+1]=O,v[A+2]=G,v[A+3]=z},keySize:256/32});n.AES=i._createHelper(_)}(),r.AES})}(ag)),ag.exports}var ig={exports:{}},Tb;function i$(){return Tb||(Tb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),_o(),bn())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.WordArray,a=s.BlockCipher,o=n.algo,l=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],c=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],f=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],h=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],p=o.DES=a.extend({_doReset:function(){for(var b=this._key,_=b.words,v=[],A=0;A<56;A++){var D=l[A]-1;v[A]=_[D>>>5]>>>31-D%32&1}for(var k=this._subKeys=[],T=0;T<16;T++){for(var x=k[T]=[],m=u[T],A=0;A<24;A++)x[A/6|0]|=v[(c[A]-1+m)%28]<<31-A%6,x[4+(A/6|0)]|=v[28+(c[A+24]-1+m)%28]<<31-A%6;x[0]=x[0]<<1|x[0]>>>31;for(var A=1;A<7;A++)x[A]=x[A]>>>(A-1)*4+3;x[7]=x[7]<<5|x[7]>>>27}for(var S=this._invSubKeys=[],A=0;A<16;A++)S[A]=k[15-A]},encryptBlock:function(b,_){this._doCryptBlock(b,_,this._subKeys)},decryptBlock:function(b,_){this._doCryptBlock(b,_,this._invSubKeys)},_doCryptBlock:function(b,_,v){this._lBlock=b[_],this._rBlock=b[_+1],g.call(this,4,252645135),g.call(this,16,65535),y.call(this,2,858993459),y.call(this,8,16711935),g.call(this,1,1431655765);for(var A=0;A<16;A++){for(var D=v[A],k=this._lBlock,T=this._rBlock,x=0,m=0;m<8;m++)x|=f[m][((T^D[m])&h[m])>>>0];this._lBlock=T,this._rBlock=k^x}var S=this._lBlock;this._lBlock=this._rBlock,this._rBlock=S,g.call(this,1,1431655765),y.call(this,8,16711935),y.call(this,2,858993459),g.call(this,16,65535),g.call(this,4,252645135),b[_]=this._lBlock,b[_+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function g(b,_){var v=(this._lBlock>>>b^this._rBlock)&_;this._rBlock^=v,this._lBlock^=v<<b}function y(b,_){var v=(this._rBlock>>>b^this._lBlock)&_;this._lBlock^=v,this._rBlock^=v<<b}n.DES=a._createHelper(p);var E=o.TripleDES=a.extend({_doReset:function(){var b=this._key,_=b.words;if(_.length!==2&&_.length!==4&&_.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var v=_.slice(0,2),A=_.length<4?_.slice(0,2):_.slice(2,4),D=_.length<6?_.slice(0,2):_.slice(4,6);this._des1=p.createEncryptor(i.create(v)),this._des2=p.createEncryptor(i.create(A)),this._des3=p.createEncryptor(i.create(D))},encryptBlock:function(b,_){this._des1.encryptBlock(b,_),this._des2.decryptBlock(b,_),this._des3.encryptBlock(b,_)},decryptBlock:function(b,_){this._des3.decryptBlock(b,_),this._des2.encryptBlock(b,_),this._des1.decryptBlock(b,_)},keySize:192/32,ivSize:64/32,blockSize:64/32});n.TripleDES=a._createHelper(E)}(),r.TripleDES})}(ig)),ig.exports}var og={exports:{}},wb;function o$(){return wb||(wb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),_o(),bn())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=a.RC4=i.extend({_doReset:function(){for(var u=this._key,f=u.words,h=u.sigBytes,p=this._S=[],g=0;g<256;g++)p[g]=g;for(var g=0,y=0;g<256;g++){var E=g%h,b=f[E>>>2]>>>24-E%4*8&255;y=(y+p[g]+b)%256;var _=p[g];p[g]=p[y],p[y]=_}this._i=this._j=0},_doProcessBlock:function(u,f){u[f]^=l.call(this)},keySize:256/32,ivSize:0});function l(){for(var u=this._S,f=this._i,h=this._j,p=0,g=0;g<4;g++){f=(f+1)%256,h=(h+u[f])%256;var y=u[f];u[f]=u[h],u[h]=y,p|=u[(u[f]+u[h])%256]<<24-g*8}return this._i=f,this._j=h,p}n.RC4=i._createHelper(o);var c=a.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)l.call(this)}});n.RC4Drop=i._createHelper(c)}(),r.RC4})}(og)),og.exports}var lg={exports:{}},Cb;function l$(){return Cb||(Cb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),_o(),bn())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=[],l=[],c=[],u=a.Rabbit=i.extend({_doReset:function(){for(var h=this._key.words,p=this.cfg.iv,g=0;g<4;g++)h[g]=(h[g]<<8|h[g]>>>24)&16711935|(h[g]<<24|h[g]>>>8)&4278255360;var y=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],E=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var g=0;g<4;g++)f.call(this);for(var g=0;g<8;g++)E[g]^=y[g+4&7];if(p){var b=p.words,_=b[0],v=b[1],A=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,D=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,k=A>>>16|D&4294901760,T=D<<16|A&65535;E[0]^=A,E[1]^=k,E[2]^=D,E[3]^=T,E[4]^=A,E[5]^=k,E[6]^=D,E[7]^=T;for(var g=0;g<4;g++)f.call(this)}},_doProcessBlock:function(h,p){var g=this._X;f.call(this),o[0]=g[0]^g[5]>>>16^g[3]<<16,o[1]=g[2]^g[7]>>>16^g[5]<<16,o[2]=g[4]^g[1]>>>16^g[7]<<16,o[3]=g[6]^g[3]>>>16^g[1]<<16;for(var y=0;y<4;y++)o[y]=(o[y]<<8|o[y]>>>24)&16711935|(o[y]<<24|o[y]>>>8)&4278255360,h[p+y]^=o[y]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,g=0;g<8;g++)l[g]=p[g];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var g=0;g<8;g++){var y=h[g]+p[g],E=y&65535,b=y>>>16,_=((E*E>>>17)+E*b>>>15)+b*b,v=((y&4294901760)*y|0)+((y&65535)*y|0);c[g]=_^v}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}n.Rabbit=i._createHelper(u)}(),r.Rabbit})}(lg)),lg.exports}var cg={exports:{}},Ib;function c$(){return Ib||(Ib=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),_o(),bn())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.StreamCipher,a=n.algo,o=[],l=[],c=[],u=a.RabbitLegacy=i.extend({_doReset:function(){var h=this._key.words,p=this.cfg.iv,g=this._X=[h[0],h[3]<<16|h[2]>>>16,h[1],h[0]<<16|h[3]>>>16,h[2],h[1]<<16|h[0]>>>16,h[3],h[2]<<16|h[1]>>>16],y=this._C=[h[2]<<16|h[2]>>>16,h[0]&4294901760|h[1]&65535,h[3]<<16|h[3]>>>16,h[1]&4294901760|h[2]&65535,h[0]<<16|h[0]>>>16,h[2]&4294901760|h[3]&65535,h[1]<<16|h[1]>>>16,h[3]&4294901760|h[0]&65535];this._b=0;for(var E=0;E<4;E++)f.call(this);for(var E=0;E<8;E++)y[E]^=g[E+4&7];if(p){var b=p.words,_=b[0],v=b[1],A=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,D=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360,k=A>>>16|D&4294901760,T=D<<16|A&65535;y[0]^=A,y[1]^=k,y[2]^=D,y[3]^=T,y[4]^=A,y[5]^=k,y[6]^=D,y[7]^=T;for(var E=0;E<4;E++)f.call(this)}},_doProcessBlock:function(h,p){var g=this._X;f.call(this),o[0]=g[0]^g[5]>>>16^g[3]<<16,o[1]=g[2]^g[7]>>>16^g[5]<<16,o[2]=g[4]^g[1]>>>16^g[7]<<16,o[3]=g[6]^g[3]>>>16^g[1]<<16;for(var y=0;y<4;y++)o[y]=(o[y]<<8|o[y]>>>24)&16711935|(o[y]<<24|o[y]>>>8)&4278255360,h[p+y]^=o[y]},blockSize:128/32,ivSize:64/32});function f(){for(var h=this._X,p=this._C,g=0;g<8;g++)l[g]=p[g];p[0]=p[0]+1295307597+this._b|0,p[1]=p[1]+3545052371+(p[0]>>>0<l[0]>>>0?1:0)|0,p[2]=p[2]+886263092+(p[1]>>>0<l[1]>>>0?1:0)|0,p[3]=p[3]+1295307597+(p[2]>>>0<l[2]>>>0?1:0)|0,p[4]=p[4]+3545052371+(p[3]>>>0<l[3]>>>0?1:0)|0,p[5]=p[5]+886263092+(p[4]>>>0<l[4]>>>0?1:0)|0,p[6]=p[6]+1295307597+(p[5]>>>0<l[5]>>>0?1:0)|0,p[7]=p[7]+3545052371+(p[6]>>>0<l[6]>>>0?1:0)|0,this._b=p[7]>>>0<l[7]>>>0?1:0;for(var g=0;g<8;g++){var y=h[g]+p[g],E=y&65535,b=y>>>16,_=((E*E>>>17)+E*b>>>15)+b*b,v=((y&4294901760)*y|0)+((y&65535)*y|0);c[g]=_^v}h[0]=c[0]+(c[7]<<16|c[7]>>>16)+(c[6]<<16|c[6]>>>16)|0,h[1]=c[1]+(c[0]<<8|c[0]>>>24)+c[7]|0,h[2]=c[2]+(c[1]<<16|c[1]>>>16)+(c[0]<<16|c[0]>>>16)|0,h[3]=c[3]+(c[2]<<8|c[2]>>>24)+c[1]|0,h[4]=c[4]+(c[3]<<16|c[3]>>>16)+(c[2]<<16|c[2]>>>16)|0,h[5]=c[5]+(c[4]<<8|c[4]>>>24)+c[3]|0,h[6]=c[6]+(c[5]<<16|c[5]>>>16)+(c[4]<<16|c[4]>>>16)|0,h[7]=c[7]+(c[6]<<8|c[6]>>>24)+c[5]|0}n.RabbitLegacy=i._createHelper(u)}(),r.RabbitLegacy})}(cg)),cg.exports}var ug={exports:{}},kb;function u$(){return kb||(kb=1,function(t,e){(function(r,n,s){t.exports=n(tr(),yl(),xl(),_o(),bn())})(Vt,function(r){return function(){var n=r,s=n.lib,i=s.BlockCipher,a=n.algo;const o=16,l=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],c=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var u={pbox:[],sbox:[]};function f(E,b){let _=b>>24&255,v=b>>16&255,A=b>>8&255,D=b&255,k=E.sbox[0][_]+E.sbox[1][v];return k=k^E.sbox[2][A],k=k+E.sbox[3][D],k}function h(E,b,_){let v=b,A=_,D;for(let k=0;k<o;++k)v=v^E.pbox[k],A=f(E,v)^A,D=v,v=A,A=D;return D=v,v=A,A=D,A=A^E.pbox[o],v=v^E.pbox[o+1],{left:v,right:A}}function p(E,b,_){let v=b,A=_,D;for(let k=o+1;k>1;--k)v=v^E.pbox[k],A=f(E,v)^A,D=v,v=A,A=D;return D=v,v=A,A=D,A=A^E.pbox[1],v=v^E.pbox[0],{left:v,right:A}}function g(E,b,_){for(let T=0;T<4;T++){E.sbox[T]=[];for(let x=0;x<256;x++)E.sbox[T][x]=c[T][x]}let v=0;for(let T=0;T<o+2;T++)E.pbox[T]=l[T]^b[v],v++,v>=_&&(v=0);let A=0,D=0,k=0;for(let T=0;T<o+2;T+=2)k=h(E,A,D),A=k.left,D=k.right,E.pbox[T]=A,E.pbox[T+1]=D;for(let T=0;T<4;T++)for(let x=0;x<256;x+=2)k=h(E,A,D),A=k.left,D=k.right,E.sbox[T][x]=A,E.sbox[T][x+1]=D;return!0}var y=a.Blowfish=i.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var E=this._keyPriorReset=this._key,b=E.words,_=E.sigBytes/4;g(u,b,_)}},encryptBlock:function(E,b){var _=h(u,E[b],E[b+1]);E[b]=_.left,E[b+1]=_.right},decryptBlock:function(E,b){var _=p(u,E[b],E[b+1]);E[b]=_.left,E[b+1]=_.right},blockSize:64/32,keySize:128/32,ivSize:64/32});n.Blowfish=i._createHelper(y)}(),r.Blowfish})}(ug)),ug.exports}(function(t,e){(function(r,n,s){t.exports=n(tr(),Up(),$U(),VU(),yl(),HU(),xl(),EI(),tx(),jU(),_I(),GU(),WU(),zU(),rx(),KU(),_o(),bn(),qU(),XU(),YU(),QU(),JU(),ZU(),e$(),t$(),r$(),n$(),s$(),a$(),i$(),o$(),l$(),c$(),u$())})(Vt,function(r){return r})})(xI);var d$=xI.exports;const qi=yI(d$);class f${constructor(){this.encryptionKey="your-dev-key-here"}async encryptAndUploadPdf(e,r){try{if(console.log("🔒 Starting PDF encryption for student:",r),console.log("📁 File details:",{name:e.name,size:e.size,type:e.type}),(!this.encryptionKey||this.encryptionKey==="your-dev-key-here")&&console.warn("⚠️ Using default encryption key - set VITE_PDF_ENCRYPTION_KEY in production"),!Et.currentUser)throw new Error("User not authenticated");if(console.log("👤 Current user:",Et.currentUser.uid),r){console.log("🔍 Checking student access for:",r);try{if(!(await qt(Ze(qe,"students",r))).exists())throw new Error(`Student ${r} not found`);console.log("✅ Student document exists")}catch(l){throw console.error("❌ Student access check failed:",l),new Error(`Student access check failed: ${l.message}`)}}console.log("📖 Reading file as ArrayBuffer...");const n=await e.arrayBuffer();console.log("✅ ArrayBuffer read, size:",n.byteLength),console.log("🔄 Converting to Base64...");const s=btoa(new Uint8Array(n).reduce((l,c)=>l+String.fromCharCode(c),""));console.log("✅ Base64 conversion complete, length:",s.length),console.log("🔐 Encrypting content...");const i=qi.AES.encrypt(s,this.encryptionKey).toString();console.log("✅ Encryption complete, length:",i.length);const a=`${OU()}.enc`;console.log("📝 Generated filename:",a),console.log("📤 Uploading to storage...");const o=yh(kc,`students/${r}/${a}`);return console.log("📍 Storage path:",`students/${r}/${a}`),await F4(o,i),console.log("✅ Upload to storage successful"),console.log("💾 Storing metadata in Firestore..."),await jt(Ze(qe,"pdfMetadata",a),{originalName:e.name,studentId:r,uploadedBy:Et.currentUser.uid,uploadedAt:Dn(),accessCount:0,lastAccessed:null,encryptionVersion:"1.0",fileSize:e.size,mimeType:e.type}),console.log("✅ Metadata stored successfully"),a}catch(n){throw console.error("❌ PDF encryption failed:",n),console.error("❌ Error details:",{message:n.message,code:n.code,stack:n.stack}),new Error(`Failed to securely store PDF: ${n.message}`)}}async downloadAndDecryptPdf(e,r){try{if(console.log("🔒 Starting secure PDF download process..."),console.log("🔍 Verifying user access permissions..."),!await this.verifyAccess(r))throw new Error("Access denied");console.log("✅ Access permissions verified"),console.log("🔑 Getting authentication token...");const{auth:s}=await ua(async()=>{const{auth:h}=await Promise.resolve().then(()=>H4);return{auth:h}},void 0),i=await s.currentUser.getIdToken(),a=`https://downloadstudentfile-zxuytv4xtq-uc.a.run.app/downloadStudentFile?studentId=${r}&fileName=${e}`;console.log("🌐 Downloading encrypted file via secure streaming...");const o=await fetch(a,{headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"}});if(!o.ok)throw new Error(`Failed to fetch file: ${o.status} ${o.statusText}`);const l=await o.text();console.log("✅ Downloaded encrypted content, size:",l.length,"characters"),console.log("🔓 Decrypting PDF content...");const c=qi.AES.decrypt(l,this.encryptionKey).toString(qi.enc.Utf8);console.log("📄 Converting to PDF format...");const u=atob(c),f=new Blob([new Uint8Array(u.split("").map(h=>h.charCodeAt(0)))],{type:"application/pdf"});return console.log("✅ PDF ready for viewing, size:",f.size,"bytes"),f}catch(n){throw console.error("❌ Error in downloadAndDecryptPdf:",n),new Error(`PDF download failed: ${n.message}`)}}async verifyAccess(e){var r,n,s,i,a,o,l,c,u,f;try{const h=Et.currentUser;if(!h)return!1;const g=(await qt(Ze(qe,"users",h.uid))).data();if(["admin","school_admin","administrator","sped_chair","admin_504"].includes(g.role)||["staff_view","staff_edit"].includes(g.role))return!0;if(g.role==="case_manager")return((s=(n=(r=(await qt(Ze(qe,"students",e))).data())==null?void 0:r.app)==null?void 0:n.studentData)==null?void 0:s.caseManagerId)===h.uid;if(g.role==="teacher"){const E=((o=(a=(i=(await qt(Ze(qe,"students",e))).data())==null?void 0:i.app)==null?void 0:a.schedule)==null?void 0:o.periods)||{};return Object.values(E).includes(h.uid)}return g.role==="service_provider"?(((c=(l=(await qt(Ze(qe,"students",e))).data())==null?void 0:l.app)==null?void 0:c.staffIds)||[]).includes(h.uid):g.role==="paraeducator"?(((f=(u=(await qt(Ze(qe,"students",e))).data())==null?void 0:u.app)==null?void 0:f.staffIds)||[]).includes(h.uid):!1}catch(h){return console.error("Access verification failed:",h),!1}}async logAccess(e,r){try{await jt(Ze(qe,"pdfAccessLogs",`${e}_${Date.now()}`),{fileId:e,studentId:r,userId:Et.currentUser.uid,userEmail:Et.currentUser.email,accessTime:Dn(),userAgent:navigator.userAgent,accessType:"download"})}catch(n){console.error("Failed to log access:",n)}}async updateAccessMetadata(e){try{const r=Ze(qe,"pdfMetadata",e),n=await qt(r);n.exists()&&await jt(r,{...n.data(),accessCount:(n.data().accessCount||0)+1,lastAccessed:Dn()},{merge:!0})}catch(r){console.error("Failed to update access metadata:",r)}}async getFileAccessHistory(e){try{const r=cr(At(qe,"pdfAccessLogs"),Ur("fileId","==",e),vn("accessTime","desc"));return(await zt(r)).docs.map(s=>s.data())}catch(r){return console.error("Failed to fetch access history:",r),[]}}}const P0=new f$;function nx(){const t=se(!1),e=se(!1),r=se(null);return{uploadPdf:async(a,o)=>{t.value=!0,r.value=null;try{if(a.type!=="application/pdf")throw new Error("Only PDF files are allowed");if(a.size>10*1024*1024)throw new Error("File size must be less than 10MB");return await P0.encryptAndUploadPdf(a,o)}catch(l){throw r.value=l.message,l}finally{t.value=!1}},downloadPdf:async(a,o,l)=>{e.value=!0,r.value=null;try{const c=await P0.downloadAndDecryptPdf(a,o),u=window.URL.createObjectURL(c),f=window.open(u,"_blank","noopener,noreferrer");setTimeout(()=>{window.URL.revokeObjectURL(u)},5e3)}catch(c){throw r.value=c.message,c}finally{e.value=!1}},getAccessHistory:async a=>{try{return await P0.getFileAccessHistory(a)}catch(o){return r.value=o.message,[]}},isUploading:t,isDownloading:e,error:r}}const h$={class:"documents-column"},p$={class:"docs-item"},m$={key:0,class:"loading-spinner"},g$={key:0,class:"loading-spinner"},v$=["onClick"],y$={key:0,class:"loading-spinner"},x$={__name:"StudentDocsCell",props:{student:{type:Object,required:!0},getDocumentUrl:{type:Function,required:!0},getAdditionalDocuments:{type:Function,required:!0}},setup(t){const e=t,{downloadPdf:r}=nx(),n=se({ataglance:!1,bip:!1}),s=async(a,o)=>{var l,c,u,f;try{if(!a){alert("File not found.");return}n.value[o]=!0;const h=((c=(l=e.student.app)==null?void 0:l.documents)==null?void 0:c.bipFileName)||((f=(u=e.student.app)==null?void 0:u.documents)==null?void 0:f.ataglanceFileName)||"document.pdf";await r(a,e.student.id,h)}catch(h){console.error("Error opening secure file:",h),alert("Error opening file. Please try again.")}finally{n.value[o]=!1}},i=async a=>{try{if(!a.pdfUrl){alert("File not found.");return}n.value[a.id]=!0,await r(a.pdfUrl,e.student.id,a.fileName)}catch(o){console.error("Error opening additional document:",o),alert("Error opening file. Please try again.")}finally{n.value[a.id]=!1}};return(a,o)=>(L(),B("td",h$,[d("div",p$,[t.getDocumentUrl(t.student,"ataglancePdfUrl")?(L(),B("a",{key:0,href:"#",onClick:o[0]||(o[0]=Yr(l=>s(t.getDocumentUrl(t.student,"ataglancePdfUrl"),"ataglance"),["prevent"])),class:Xe(["doc-link",{loading:n.value.ataglance}])},[n.value.ataglance?(L(),B("div",m$,[Pe(q(hc),{size:14,class:"spin"})])):(L(),Jt(q(Ku),{key:1,size:16,class:"doc-icon"})),d("span",null,Z(n.value.ataglance?"Loading...":"At-A-Glance"),1)],2)):_e("",!0),t.getDocumentUrl(t.student,"bipPdfUrl")?(L(),B("a",{key:1,href:"#",onClick:o[1]||(o[1]=Yr(l=>s(t.getDocumentUrl(t.student,"bipPdfUrl"),"bip"),["prevent"])),class:Xe(["doc-link",{loading:n.value.bip}])},[n.value.bip?(L(),B("div",g$,[Pe(q(hc),{size:14,class:"spin"})])):(L(),Jt(q(Ku),{key:1,size:16,class:"doc-icon"})),d("span",null,Z(n.value.bip?"Loading...":"BIP"),1)],2)):_e("",!0),(L(!0),B(De,null,$e(t.getAdditionalDocuments(t.student),l=>(L(),B("a",{key:l.id,href:"#",onClick:Yr(c=>i(l),["prevent"]),class:Xe(["doc-link",{loading:n.value[l.id]}])},[n.value[l.id]?(L(),B("div",y$,[Pe(q(hc),{size:14,class:"spin"})])):(L(),Jt(q(Ku),{key:1,size:16,class:"doc-icon"})),d("span",null,Z(n.value[l.id]?"Loading...":l.title),1)],10,v$))),128)),!t.getDocumentUrl(t.student,"ataglancePdfUrl")&&!t.getDocumentUrl(t.student,"bipPdfUrl")&&t.getAdditionalDocuments(t.student).length===0?(L(),B(De,{key:2},[we("—")],64)):_e("",!0)])]))}},E$=St(x$,[["__scopeId","data-v-d8e8016d"]]),_$={class:"actions-column"},b$={class:"actions-content"},S$={class:"action-buttons"},A$=["title"],T$={__name:"StudentActionsCell",props:{student:{type:Object,required:!0},currentUser:{type:Object,required:!1},studentData:{type:Object,required:!1},getUserName:{type:Function,required:!0},formatDate:{type:Function,required:!0}},emits:["edit","email","teacher-feedback"],setup(t,{emit:e}){const r=t,n=Se(()=>{var o;return(o=r.student)!=null&&o.updatedBy?r.getUserName(r.student.updatedBy):null}),s=Se(()=>{var o;if(!((o=r.student)!=null&&o.updatedAt))return"";try{let l="";r.student.updatedAt.seconds?l=new Date(r.student.updatedAt.seconds*1e3).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0}):l=new Date(r.student.updatedAt).toLocaleString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit",hour:"numeric",minute:"2-digit",hour12:!0});const c=n.value?` by ${n.value}`:"";return`Last Updated: ${l}${c}`}catch(l){console.warn("Error formatting date in tooltip:",l);const c=new Date(r.student.updatedAt.seconds*1e3),u=n.value?` by ${n.value}`:"";return`Last Updated: ${c.toLocaleDateString()}${u}`}}),i=Se(()=>{var u,f,h,p,g;if(!((u=r.currentUser)!=null&&u.role)||!r.student)return!1;const o=r.currentUser.role,l=r.currentUser.uid;return o==="paraeducator"||o==="teacher"?!1:o==="case_manager"?((h=(f=r.student.app)==null?void 0:f.studentData)==null?void 0:h.caseManagerId)===l:o==="service_provider"?(g=(p=r.student.app)==null?void 0:p.staffIds)==null?void 0:g.includes(l):["admin","school_admin","staff_edit","admin_504","sped_chair"].includes(o)}),a=Se(()=>{var o;return!((o=r.currentUser)!=null&&o.role)||!r.student||!r.studentData?!1:wn.canSendFeedback(r.currentUser.uid,r.currentUser.role,r.student,r.studentData)});return(o,l)=>{var c;return L(),B("td",_$,[d("div",b$,[d("div",S$,[i.value?(L(),B("button",{key:0,class:"edit-btn",onClick:l[0]||(l[0]=u=>o.$emit("edit",t.student.id)),title:"Edit Student"},[Pe(q(Qy),{size:16})])):_e("",!0),d("button",{class:"email-btn",onClick:l[1]||(l[1]=u=>o.$emit("email",t.student.id)),title:"Email Student"},[Pe(q(uB),{size:16})]),a.value?(L(),B("button",{key:1,class:"teacher-feedback-btn",onClick:l[2]||(l[2]=u=>o.$emit("teacher-feedback",t.student.id)),title:"Send Teacher Feedback Form"},[Pe(q(aI),{size:16})])):_e("",!0)]),(c=t.student)!=null&&c.updatedAt?(L(),B("div",{key:0,class:"action-updated-date",title:s.value},Z(t.student.updatedAt.seconds?new Date(t.student.updatedAt.seconds*1e3).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}):new Date(t.student.updatedAt).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"})),9,A$)):_e("",!0)])])}}},w$=St(T$,[["__scopeId","data-v-a703cbf2"]]),C$={class:"schedule-column"},I$={key:0,class:"schedule-list"},k$={class:"period-assignment"},D$={class:"primary-line"},P$={class:"period-label"},R$=["data-tooltip"],F$={key:0,class:"coteaching-info"},N$=["title","data-tooltip"],O$={key:1,class:"no-schedule"},M$={__name:"StudentScheduleCell",props:{student:{type:Object,required:!0},getSchedule:{type:Function,required:!0},getUserInitialLastName:{type:Function,required:!0},getPeriodLabel:{type:Function,required:!1},getUserTooltip:{type:Function,required:!0}},setup(t){const e=r=>r&&typeof r=="object"&&r.coTeaching&&r.teacherId;return(r,n)=>(L(),B("td",C$,[t.getSchedule(t.student)?(L(),B("div",I$,[d("ul",null,[(L(!0),B(De,null,$e(t.getSchedule(t.student),(s,i)=>(L(),B("li",{key:i,class:"schedule-period"},[d("div",k$,[d("div",D$,[d("span",P$,Z(t.getPeriodLabel?t.getPeriodLabel(i):i)+":",1),d("span",{class:"primary-teacher teacher-name","data-tooltip":t.getUserTooltip(s.teacherId||s),onMouseenter:n[0]||(n[0]=a=>a.target.classList.add("tooltip-active")),onMouseleave:n[1]||(n[1]=a=>a.target.classList.remove("tooltip-active"))},Z(t.getUserInitialLastName(s.teacherId||s)),41,R$)]),e(s)?(L(),B("div",F$,[d("span",{class:"coteaching-indicator teacher-name",title:`Co-teach ${s.coTeaching.subject}`,"data-tooltip":t.getUserTooltip(s.coTeaching.caseManagerId),onMouseenter:n[2]||(n[2]=a=>a.target.classList.add("tooltip-active")),onMouseleave:n[3]||(n[3]=a=>a.target.classList.remove("tooltip-active"))},Z(t.getUserInitialLastName(s.coTeaching.caseManagerId))+" (C"+Z(s.coTeaching.subject.charAt(0))+") ",41,N$)])):_e("",!0)])]))),128))])])):(L(),B("div",O$,"—"))]))}},L$={class:"service-column"},B$={key:0,class:"services-section"},U$={class:"services-container"},$$={key:1,class:"services-section"},V$={class:"services-container"},H$={key:0,class:"service-provider-item"},j$={key:0,class:"service-provider-item"},G$={key:1,class:"service-provider-item"},W$={key:2,class:"service-provider-item"},z$={key:3,class:"service-provider-item"},K$={key:4,class:"service-provider-item"},q$={key:5,class:"service-provider-item"},X$={__name:"StudentServicesCell",props:{student:{type:Object,required:!0},appSettings:{type:Object,required:!1},getClassServices:{type:Function,required:!0},getOtherServices:{type:Function,required:!0},hasServiceProviders:{type:Function,required:!0},getServiceProviderId:{type:Function,required:!0},getProviderFieldName:{type:Function,required:!0},getUserInitialLastName:{type:Function,required:!0}},setup(t){return(e,r)=>(L(),B("td",L$,[t.getClassServices(t.student).length>0||t.getOtherServices(t.student).length>0||t.hasServiceProviders(t.student)?(L(),B(De,{key:0},[t.getClassServices(t.student).length>0?(L(),B("div",B$,[r[0]||(r[0]=d("strong",null,"Class Services:",-1)),d("div",U$,[(L(!0),B(De,null,$e(t.getClassServices(t.student),n=>(L(),B("span",{key:n,class:"service-item"},Z(n.startsWith("Other: ")?n.replace("Other: ",""):n),1))),128))])])):_e("",!0),t.getOtherServices(t.student).length>0||t.hasServiceProviders(t.student)?(L(),B("div",$$,[r[1]||(r[1]=d("strong",null,"Related Services:",-1)),d("div",V$,[(L(!0),B(De,null,$e(t.getOtherServices(t.student),n=>(L(),B("span",{key:n,class:"service-item"},Z(n),1))),128)),t.appSettings&&t.appSettings.value&&t.appSettings.value.serviceProviders?(L(!0),B(De,{key:0},$e(t.appSettings.value.serviceProviders,n=>(L(),B(De,{key:n},[t.getServiceProviderId(t.student,t.getProviderFieldName(n))?(L(),B("span",H$,Z(n)+" ("+Z(t.getUserInitialLastName(t.getServiceProviderId(t.student,t.getProviderFieldName(n))))+") ",1)):_e("",!0)],64))),128)):(L(),B(De,{key:1},[t.getServiceProviderId(t.student,"speechId")?(L(),B("span",j$,"SP ("+Z(t.getUserInitialLastName(t.getServiceProviderId(t.student,"speechId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"mhId")?(L(),B("span",G$,"MH ("+Z(t.getUserInitialLastName(t.getServiceProviderId(t.student,"mhId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"otId")?(L(),B("span",W$,"OT ("+Z(t.getUserInitialLastName(t.getServiceProviderId(t.student,"otId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"ptId")?(L(),B("span",z$,"PT ("+Z(t.getUserInitialLastName(t.getServiceProviderId(t.student,"ptId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"scId")?(L(),B("span",K$,"SC ("+Z(t.getUserInitialLastName(t.getServiceProviderId(t.student,"scId")))+")",1)):_e("",!0),t.getServiceProviderId(t.student,"trId")?(L(),B("span",q$,"TR ("+Z(t.getUserInitialLastName(t.getServiceProviderId(t.student,"trId")))+")",1)):_e("",!0)],64))])])):_e("",!0)],64)):(L(),B(De,{key:1},[we(" — ")],64))]))}},Y$=["innerHTML"],Q$={key:2},Db={__name:"AccommodationsCell",props:{student:{type:Object,required:!0},fieldName:{type:String,required:!0},flagType:{type:String,required:!0},flagText:{type:String,required:!0},flagClass:{type:String,required:!0},getFlagValue:{type:Function,required:!0},formatListFromText:{type:Function,required:!0}},setup(t){return(e,r)=>(L(),B("td",{class:Xe([t.fieldName+"-column","instruction-cell",{"with-flag":t.getFlagValue(t.student,t.flagType)}])},[t.getFlagValue(t.student,t.flagType)?(L(),B("div",{key:0,class:Xe(["flag-overlay",t.flagClass])},Z(t.flagText),3)):_e("",!0),q(it)(t.student,t.fieldName)?(L(),B("div",{key:1,innerHTML:t.formatListFromText(q(it)(t.student,t.fieldName))},null,8,Y$)):(L(),B("div",Q$,"—"))],2))}},J$={class:"student-name"},Z$={class:"std-info-subheading"},eV=["data-tooltip"],tV={key:0,class:"custom-flags"},rV=["data-tooltip"],nV={key:0,class:"schedule-list"},sV={class:"period-assignment"},aV={class:"primary-line"},iV={class:"period-label"},oV=["data-tooltip"],lV={key:0,class:"coteaching-info"},cV=["title","data-tooltip"],uV={key:1,class:"no-schedule"},dV={key:0,class:"flag-overlay flag-separate-setting"},fV={key:1,class:"bullet-list"},hV=["innerHTML"],pV={key:2},mV={class:"student-info-column"},gV={class:"student-name"},vV=["title"],yV={class:"std-info-subheading"},xV=["data-tooltip"],EV={key:0,class:"custom-flags"},_V=["data-tooltip"],bV={class:"flag-count"},SV={class:"student-dates print"},AV={key:0,class:"direct-assignment-badge"},Kf={__name:"StudentTable",props:{students:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})},currentUser:{type:Object,default:null},studentData:{type:Object,default:null},testingView:{type:Boolean,default:!1},aideSchedule:{type:Object,default:()=>({})}},emits:["edit","email","teacher-feedback"],setup(t,{emit:e}){const r=t,{appSettings:n,getUserName:s,getUserInitialLastName:i,getUserTooltip:a,getCaseManagerTooltip:o,formatDate:l,getMeetingUrgencyClass:c,getReviewUrgencyClass:u,getReevalUrgencyClass:f,getCaseManagerId:h,getFlagValue:p,getDocumentUrl:g,getSchedule:y,getClassServices:E,getOtherServices:b,hasServiceProviders:_,getServiceProviderId:v,getProviderFieldName:A,isDirectAssignment:D,formatListFromText:k,getPeriodLabel:T,getAdditionalDocuments:x}=DU(r),m=S=>S&&typeof S=="object"&&S.coTeaching&&S.teacherId;return(S,I)=>(L(),B("table",{class:Xe(["students-table",{"testing-view":t.testingView}])},[d("thead",null,[d("tr",null,[t.testingView?(L(),B(De,{key:0},[I[8]||(I[8]=d("th",{class:"print"},"Student Info",-1)),I[9]||(I[9]=d("th",{class:"print"},"Schedule",-1)),I[10]||(I[10]=d("th",{class:"print"},"Assessment Accommodations",-1))],64)):(L(),B(De,{key:1},[I[11]||(I[11]=d("th",{class:"print student-info-column"},"Student Info",-1)),I[12]||(I[12]=d("th",{class:"print service-column"},"Services",-1)),I[13]||(I[13]=d("th",{class:"print schedule-column"},"Schedule",-1)),I[14]||(I[14]=d("th",{class:"print instruction-column"},"Instruction Accommodations",-1)),I[15]||(I[15]=d("th",{class:"print assessment-column"},"Assessment Accommodations",-1)),I[16]||(I[16]=d("th",{class:"print documents-column"},"Docs",-1)),I[17]||(I[17]=d("th",{class:"print actions-column"},"Actions",-1))],64))])]),d("tbody",null,[(L(!0),B(De,null,$e(t.students,C=>{var F,W,P,R,N,M,O;return L(),B("tr",{key:C.id},[t.testingView?(L(),B(De,{key:0},[d("td",null,[d("div",J$,[d("strong",null,Z(q(it)(C,"firstName"))+" "+Z(q(it)(C,"lastName")),1)]),d("div",Z$,[d("div",null,"Grd: "+Z(q(it)(C,"grade"))+" | Prg: "+Z(q(it)(C,"plan")),1),d("div",null,[I[18]||(I[18]=we("CM: ")),d("span",{class:"case-manager-name","data-tooltip":q(o)(q(h)(C)),onMouseenter:I[0]||(I[0]=G=>G.target.classList.add("tooltip-active")),onMouseleave:I[1]||(I[1]=G=>G.target.classList.remove("tooltip-active"))},Z(q(s)(q(h)(C))),41,eV)]),(((W=(F=C.app)==null?void 0:F.flags)==null?void 0:W.customFlags)||[]).length?(L(),B("div",tV,[(((R=(P=C.app)==null?void 0:P.flags)==null?void 0:R.customFlags)||[]).filter(G=>G.color===S.color).length?(L(),B(De,{key:0},$e(["blue","yellow","red"],G=>{var z,j,H,V;return d("span",{key:G,class:Xe(["flag-chip",G]),"data-tooltip":(((j=(z=C.app)==null?void 0:z.flags)==null?void 0:j.customFlags)||[]).filter(te=>te.color===G).map(te=>`• ${te.text}`).join(`
`)},[I[19]||(I[19]=d("span",{class:"flag-dot"},null,-1)),we(Z((((V=(H=C.app)==null?void 0:H.flags)==null?void 0:V.customFlags)||[]).filter(te=>te.color===G).length),1)],10,rV)}),64)):_e("",!0)])):_e("",!0)])]),d("td",null,[q(y)(C)?(L(),B("div",nV,[d("ul",null,[(L(!0),B(De,null,$e(q(y)(C),(G,z)=>(L(),B("li",{key:z,class:"schedule-period"},[d("div",sV,[d("div",aV,[d("span",iV,Z(q(T)?q(T)(z):z)+":",1),d("span",{class:"primary-teacher teacher-name","data-tooltip":q(a)(G.teacherId||G),onMouseenter:I[2]||(I[2]=j=>j.target.classList.add("tooltip-active")),onMouseleave:I[3]||(I[3]=j=>j.target.classList.remove("tooltip-active"))},Z(q(i)(G.teacherId||G)),41,oV)]),m(G)?(L(),B("div",lV,[d("span",{class:"coteaching-indicator teacher-name",title:`Co-teach ${G.coTeaching.subject}`,"data-tooltip":q(a)(G.coTeaching.caseManagerId),onMouseenter:I[4]||(I[4]=j=>j.target.classList.add("tooltip-active")),onMouseleave:I[5]||(I[5]=j=>j.target.classList.remove("tooltip-active"))},Z(q(i)(G.coTeaching.caseManagerId))+" (C"+Z(G.coTeaching.subject.charAt(0))+") ",41,cV)])):_e("",!0)])]))),128))])])):(L(),B("div",uV,"—"))]),d("td",{class:Xe(["instruction-cell",{"with-flag":q(p)(C,"flag2")}])},[q(p)(C,"flag2")?(L(),B("div",dV,"Separate setting")):_e("",!0),q(it)(C,"assessment")?(L(),B("div",fV,[d("div",{innerHTML:q(k)(q(it)(C,"assessment"))},null,8,hV)])):(L(),B("div",pV,"—"))],2)],64)):(L(),B(De,{key:1},[d("td",mV,[d("div",gV,[d("strong",null,Z(q(it)(C,"firstName"))+" "+Z(q(it)(C,"lastName")),1),d("span",{class:"data-source",title:`Data source: ${q(uu)(C,"firstName")}`},Z(q(uu)(C,"firstName")==="Override"?"🔒":q(uu)(C,"firstName")==="App"?"":q(uu)(C,"firstName")==="Aeries"?"📊":q(uu)(C,"firstName")==="SEIS"?"📋":""),9,vV)]),d("div",yV,[d("div",null,"Grd: "+Z(q(it)(C,"grade"))+" | Prg: "+Z(q(it)(C,"plan")),1),d("div",null,[I[20]||(I[20]=we("CM: ")),d("span",{class:"case-manager-name","data-tooltip":q(o)(q(h)(C)),onMouseenter:I[6]||(I[6]=G=>G.target.classList.add("tooltip-active")),onMouseleave:I[7]||(I[7]=G=>G.target.classList.remove("tooltip-active"))},Z(q(s)(q(h)(C))),41,xV)]),(((M=(N=C.app)==null?void 0:N.flags)==null?void 0:M.customFlags)||[]).length?(L(),B("div",EV,[(L(),B(De,null,$e(["blue","yellow","red"],G=>{var z,j,H,V,te,oe;return L(),B(De,{key:G},[(((j=(z=C.app)==null?void 0:z.flags)==null?void 0:j.customFlags)||[]).filter(ne=>ne.color===G).length?(L(),B("span",{key:0,class:Xe(["flag-chip",`flag-${G}`]),"data-tooltip":(((V=(H=C.app)==null?void 0:H.flags)==null?void 0:V.customFlags)||[]).filter(ne=>ne.color===G).map(ne=>`• ${ne.text}`).join(`
`)},[Pe(q(tB),{size:16,class:"lucide-flag"}),d("span",bV,Z((((oe=(te=C.app)==null?void 0:te.flags)==null?void 0:oe.customFlags)||[]).filter(ne=>ne.color===G).length),1)],10,_V)):_e("",!0)],64)}),64))])):_e("",!0)]),d("div",SV,[d("span",{class:Xe(["badge badge-review plan-review",q(u)(C)])},"PR: "+Z(q(l)(q(it)(C,"reviewDate"))),3),d("span",{class:Xe(["badge badge-reeval reeval-due",q(f)(C)])},"RE: "+Z(q(l)(q(it)(C,"reevalDate"))),3),d("span",{class:Xe(["badge badge-meeting meeting-date",[q(c)(C),q(it)(C,"meetingDate")?"date-set":""]])}," 🗓 "+Z(q(l)(q(it)(C,"meetingDate"))||"Not set"),3)]),((O=t.currentUser)==null?void 0:O.role)==="paraeducator"&&q(D)(C.id)?(L(),B("div",AV,I[21]||(I[21]=[d("span",{class:"badge badge-direct"},"Direct Assignment",-1)]))):_e("",!0)]),Pe(X$,{student:C,"app-settings":q(n),"get-class-services":q(E),"get-other-services":q(b),"has-service-providers":q(_),"get-service-provider-id":q(v),"get-provider-field-name":q(A),"get-user-initial-last-name":q(i)},null,8,["student","app-settings","get-class-services","get-other-services","has-service-providers","get-service-provider-id","get-provider-field-name","get-user-initial-last-name"]),Pe(M$,{student:C,"get-schedule":q(y),"get-user-initial-last-name":q(i),"get-period-label":q(T),"get-user-tooltip":q(a)},null,8,["student","get-schedule","get-user-initial-last-name","get-period-label","get-user-tooltip"]),Pe(Db,{student:C,"field-name":"instruction","flag-type":"flag1","flag-text":"Preferential Seating","flag-class":"flag-preferential-seating","get-flag-value":q(p),"format-list-from-text":q(k)},null,8,["student","get-flag-value","format-list-from-text"]),Pe(Db,{student:C,"field-name":"assessment","flag-type":"flag2","flag-text":"Separate Setting","flag-class":"flag-separate-setting","get-flag-value":q(p),"format-list-from-text":q(k)},null,8,["student","get-flag-value","format-list-from-text"]),Pe(E$,{student:C,"get-document-url":q(g),"get-additional-documents":q(x)},null,8,["student","get-document-url","get-additional-documents"]),Pe(w$,{student:C,"current-user":t.currentUser,"student-data":t.studentData,"get-user-name":q(s),"format-date":q(l),onEdit:G=>S.$emit("edit",C.id),onEmail:G=>S.$emit("email",C.id),onTeacherFeedback:G=>S.$emit("teacher-feedback",C.id)},null,8,["student","current-user","student-data","get-user-name","format-date","onEdit","onEmail","onTeacherFeedback"])],64))])}),128))])],2))}};function TV(t,e){const{appSettings:r,loadAppSettings:n,loading:s,error:i}=Ms(),a=on(),o=se(!1);Gt(async()=>{try{console.log("useStudentForm: Starting to load app settings..."),await n(),console.log("useStudentForm: App settings loaded successfully:",r.value)}catch(P){console.error("useStudentForm: Error loading app settings:",P)}});const l=Se(()=>{var R;const P=((R=r.value)==null?void 0:R.numPeriods)||7;return Array.from({length:P},(N,M)=>M+1)}),c=Se(()=>{var P;return(P=r.value)!=null&&P.grades&&r.value.grades.length>0?(console.log("useStudentForm: Using app settings grades:",r.value.grades),r.value.grades):(console.log("useStudentForm: Using fallback grades: [7, 8]"),["7","8"])}),u=Se(()=>{var P;if((P=r.value)!=null&&P.classServices&&r.value.classServices.length>0){const R=r.value.classServices.filter(N=>N.enabledSubcategories&&N.enabledSubcategories.length>0);return console.log("useStudentForm: Available class services:",R.length,"services"),R}return console.log("useStudentForm: No class services available"),[]}),f=Se(()=>{var P;return(P=r.value)!=null&&P.serviceProviders&&r.value.serviceProviders.length>0?(console.log("useStudentForm: Using app settings service providers:",r.value.serviceProviders.length,"providers"),r.value.serviceProviders):(console.log("useStudentForm: No service providers configured in app settings"),[])}),h=Se(()=>{var P;return(P=r.value)!=null&&P.customServiceProviders?r.value.customServiceProviders:[]}),p=Se(()=>{let P=t.users.userRoles?t.users.userRoles:{teachers:t.users.teachers||[],caseManagers:t.users.caseManagers||[],speech:t.users.speech||[],ot:t.users.ot||[],mh:t.users.mh||[]};return P.teachers&&(P={...P,teachers:P.teachers.map(R=>({...R,id:String(R.id)}))}),P}),g=P=>{var R,N,M,O,G,z,j,H,V,te,oe,ne,le,J,Q,ve,ee,K,Y,pe,xe,ae,de,Ee,he,Ce,Te,Ge,Ie,Ve,Ue,ze,Ke,ue,be,Ae,Me,We,lt,yt,_t,$t,ht,ct,pt,Ct,Rt,mr,mn,Qs;return{ssid:it(P,"ssid")||P.id||"",firstName:it(P,"firstName")||"",lastName:it(P,"lastName")||"",grade:it(P,"grade")||"7",plan:it(P,"plan")||"IEP",reviewDate:it(P,"reviewDate")||"",reevalDate:it(P,"reevalDate")||"",meetingDate:it(P,"meetingDate")||"",caseManagerId:it(P,"caseManagerId")||P.caseManagerId||P.casemanager_id||"",schedule:((N=(R=P.app)==null?void 0:R.schedule)==null?void 0:N.periods)||((O=(M=P.aeries)==null?void 0:M.schedule)==null?void 0:O.periods)||P.schedule||{},services:((z=(G=P.app)==null?void 0:G.schedule)==null?void 0:z.classServices)||P.services||[],speechId:((H=(j=P.app)==null?void 0:j.providers)==null?void 0:H.speechId)||P.speechId||P.speech_id||"",otId:((te=(V=P.app)==null?void 0:V.providers)==null?void 0:te.otId)||P.otId||P.ot_id||"",mhId:((ne=(oe=P.app)==null?void 0:oe.providers)==null?void 0:ne.mhId)||P.mhId||P.mh_id||"",ptId:((J=(le=P.app)==null?void 0:le.providers)==null?void 0:J.ptId)||P.ptId||P.pt_id||"",scId:((ve=(Q=P.app)==null?void 0:Q.providers)==null?void 0:ve.scId)||P.scId||P.sc_id||"",trId:((K=(ee=P.app)==null?void 0:ee.providers)==null?void 0:K.trId)||P.trId||P.tr_id||"",audId:((pe=(Y=P.app)==null?void 0:Y.providers)==null?void 0:pe.audId)||P.audId||P.aud_id||"",viId:((ae=(xe=P.app)==null?void 0:xe.providers)==null?void 0:ae.viId)||P.viId||P.vi_id||"",atId:((Ee=(de=P.app)==null?void 0:de.providers)==null?void 0:Ee.atId)||P.atId||P.at_id||"",dhhId:((Ce=(he=P.app)==null?void 0:he.providers)==null?void 0:Ce.dhhId)||P.dhhId||P.dhh_id||"",omId:((Ge=(Te=P.app)==null?void 0:Te.providers)==null?void 0:Ge.omId)||P.omId||P.om_id||"",bisId:((Ve=(Ie=P.app)==null?void 0:Ie.providers)==null?void 0:Ve.bisId)||P.bisId||P.bis_id||"",hnId:((ze=(Ue=P.app)==null?void 0:Ue.providers)==null?void 0:ze.hnId)||P.hnId||P.hn_id||"",swId:((ue=(Ke=P.app)==null?void 0:Ke.providers)==null?void 0:ue.swId)||P.swId||P.sw_id||"",instruction:it(P,"instruction")||"",assessment:it(P,"assessment")||"",flag1:((Ae=(be=P.app)==null?void 0:be.flags)==null?void 0:Ae.flag1)||P.flag1||!1,flag2:((We=(Me=P.app)==null?void 0:Me.flags)==null?void 0:We.flag2)||P.flag2||!1,app:{flags:{customFlags:((yt=(lt=P.app)==null?void 0:lt.flags)==null?void 0:yt.customFlags)||[]}},ataglancePdfUrl:(($t=(_t=P.app)==null?void 0:_t.documents)==null?void 0:$t.ataglancePdfUrl)||P.ataglancePdfUrl||P.ataglance_pdf_url||"",bipPdfUrl:((ct=(ht=P.app)==null?void 0:ht.documents)==null?void 0:ct.bipPdfUrl)||P.bipPdfUrl||P.bip_pdf_url||"",ataglanceFileName:((Ct=(pt=P.app)==null?void 0:pt.documents)==null?void 0:Ct.ataglanceFileName)||P.ataglanceFileName||"",bipFileName:((mr=(Rt=P.app)==null?void 0:Rt.documents)==null?void 0:mr.bipFileName)||P.bipFileName||"",bipFile:null,ataglanceFile:null,removeBipFile:!1,removeAtaglanceFile:!1,additionalDocuments:((Qs=(mn=P.app)==null?void 0:mn.documents)==null?void 0:Qs.additionalDocuments)||[]}},y=As(g(t.student||{})),E=P=>{const R=[];return P&&typeof P=="object"&&Object.entries(P).forEach(([N,M])=>{if(M&&typeof M=="object"&&M.coTeaching){const O=M.coTeaching.subject;O&&R.push(`Co-teach: ${O}`)}}),R},b=()=>{const P=E(y.schedule),R=y.services.filter(N=>!N.startsWith("Co-teach:"));y.services=[...R,...P]};Ht(()=>y.schedule,()=>{b()},{deep:!0}),Ht(()=>t.student,(P,R)=>{if(P&&Object.keys(P).length>0){const N=!R||Object.keys(R).length===0,M=P.id!==(R==null?void 0:R.id);if(N||M){console.log("🔍 useStudentForm DEBUG - Student data changed, updating form:",P.id),console.log("🔍 useStudentForm DEBUG - Student data:",{firstName:it(P,"firstName"),lastName:it(P,"lastName"),plan:it(P,"plan"),caseManagerId:it(P,"caseManagerId"),rawStudent:P});const O=g(P);Object.assign(y,O),b(),console.log("🔍 useStudentForm DEBUG - Form updated:",{plan:y.plan,caseManagerId:y.caseManagerId,firstName:y.firstName,lastName:y.lastName})}}},{immediate:!0,deep:!0}),Ht(()=>r.value,P=>{console.log("useStudentForm: App settings watcher triggered:",P),P!=null&&P.grades&&P.grades.length>0&&(P.grades.includes(y.grade)||(y.grade=P.grades[0]||"7"))},{immediate:!0,deep:!0});const _=(P,R)=>{const N=P.target.files[0]||null;if(N){const M=ol(N,{allowedTypes:["pdf"],maxSize:10485760,fieldName:R==="bipFile"?"BIP Document":"At-A-Glance Document"});if(!M.isValid){alert(M.error),P.target.value="";return}const O=Hr(N.name);if(!O.isSafe){alert(`File name contains potentially dangerous content: ${O.threats.join(", ")}`),P.target.value="";return}}y[R]=N},v=P=>{P.preventDefault(),P.stopPropagation(),y.removeBipFile=!0,y.bipFile=null},A=P=>{P.preventDefault(),P.stopPropagation(),y.removeAtaglanceFile=!0,y.ataglanceFile=null},D=P=>{if(!P||P.trim().length===0||P.trim().length>24)throw new Error("Title must be between 1 and 24 characters");if(2+y.additionalDocuments.length>=10)throw new Error("Maximum of 10 documents allowed (including BIP and At-A-Glance)");const N={id:crypto.randomUUID(),title:P.trim(),pdfUrl:"",fileName:"",toRemove:!1};return y.additionalDocuments.push(N),N.id},k=P=>{const R=y.additionalDocuments.find(N=>N.id===P);R&&(R.toRemove=!0)},T=P=>{const R=y.additionalDocuments.find(N=>N.id===P);R&&(R.toRemove=!1)},x=P=>{const R=y.additionalDocuments.findIndex(N=>N.id===P);R!==-1&&y.additionalDocuments.splice(R,1)},m={SLP:"speechId",OT:"otId",MH:"mhId",PT:"ptId",SC:"scId",TR:"trId",AUD:"audId",VI:"viId",AT:"atId",DHH:"dhhId","O&M":"omId",BIS:"bisId",HN:"hnId",SW:"swId"},S=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}],I=P=>{var N;if((N=r.value)!=null&&N.serviceProviders&&Array.isArray(r.value.serviceProviders)){const M=(r.value.serviceProvidersDetails||S).find(O=>O.abbreviation===P);if(M)return M.name+" ("+P+")"}const R=S.find(M=>M.abbreviation===P);return R?R.name+" ("+P+")":P},C=P=>{const N={SLP:"speech",OT:"ot",MH:"mh",PT:"pt",SC:"sc",TR:"tr",AUD:"aud",VI:"vi",AT:"at",DHH:"dhh","O&M":"om",BIS:"bis",HN:"hn",SW:"sw"}[P]||P.toLowerCase();return p.value[N]||[]},F=()=>{const P=pI(y),R={app:{studentData:{firstName:P.firstName,lastName:P.lastName,grade:P.grade,plan:P.plan,caseManagerId:P.caseManagerId}}},N=hI(R,{isNew:t.mode==="new"});if(!N.isValid)return alert(`Please fix the following errors:

${N.errors.join(`
`)}`),!1;const M=["firstName","lastName","instruction","assessment"];for(const O of M)if(y[O]){const G=Hr(y[O]);if(!G.isSafe)return alert(`Security threat detected in ${O}: ${G.threats.join(", ")}`),!1}return Object.assign(y,P),!0};return{form:y,isSaving:o,appSettings:r,appSettingsLoading:s,appSettingsError:i,periods:l,gradeOptions:c,availableClassServices:u,serviceProviders:f,customServiceProviders:h,userRoles:p,onFileChange:_,removeBipFile:v,removeAtaglanceFile:A,addAdditionalDocument:D,removeAdditionalDocument:k,undoRemoveAdditionalDocument:T,deleteAdditionalDocument:x,providerFieldMap:m,getProviderLabel:I,getProviderUsers:C,handleSubmit:async()=>{var P,R,N,M,O,G,z;try{if(o.value){console.log("Form submission already in progress, ignoring duplicate");return}if(console.log("🚀 Form submitted:",{plan:y.plan,caseManagerId:y.caseManagerId,firstName:y.firstName,lastName:y.lastName,mode:t.mode,studentId:(P=t.student)==null?void 0:P.id}),o.value=!0,console.log("🔍 AUTH DEBUG - Current user:",{uid:(R=Et.currentUser)==null?void 0:R.uid,email:(N=Et.currentUser)==null?void 0:N.email,claims:await((M=Et.currentUser)==null?void 0:M.getIdTokenResult())}),!F()){o.value=!1;return}const j=y.services.filter(J=>J&&J.includes(":")),H={};console.log("🔍 FORM SCHEDULE DEBUG - Complete form.schedule:",JSON.stringify(y.schedule,null,2)),console.log("🔍 FORM SCHEDULE DEBUG - periods.value:",l.value),l.value.forEach(J=>{if(console.log(`🔍 FORM SCHEDULE DEBUG - Period ${J} exists:`,!!y.schedule[J],"Value:",y.schedule[J]),y.schedule[J]){const Q=y.schedule[J];console.log(`🔍 SCHEDULE DEBUG - Period ${J}:`,{type:typeof Q,data:Q,hasCoTeaching:!!(Q&&Q.coTeaching),hasCaseManagerId:!!(Q&&Q.coTeaching&&Q.coTeaching.caseManagerId)}),typeof Q=="string"?H[J]=Q:typeof Q=="object"&&Q!==null&&(Q.coTeaching&&Q.coTeaching.caseManagerId?(console.log(`🔍 SCHEDULE DEBUG - Period ${J} has co-teaching, preserving structure`),H[J]={teacherId:Q.teacherId,coTeaching:{caseManagerId:Q.coTeaching.caseManagerId,subject:Q.coTeaching.subject||""}}):(console.log(`🔍 SCHEDULE DEBUG - Period ${J} converting to simple format`),H[J]=Q.teacherId||String(Q)||Q))}}),console.log("🔍 Schedule Composition Debug:"),console.log("Form schedule before:",JSON.stringify(y.schedule,null,2)),console.log("Composed schedule after:",JSON.stringify(H,null,2)),console.log("Composed data:",{classServices:j,schedule:H});let V=y.bipPdfUrl||null,te=y.ataglancePdfUrl||null;if(console.log("🔍 Form submission - PDF URLs:",{bipPdfUrl:V,ataglancePdfUrl:te,formBipPdfUrl:y.bipPdfUrl,formAtaglancePdfUrl:y.ataglancePdfUrl,bipFileName:y.bipFileName,ataglanceFileName:y.ataglanceFileName,bipFile:y.bipFile,ataglanceFile:y.ataglanceFile}),y.removeBipFile&&(console.log("Removing BIP file..."),V)){try{const J=se(kc,`students/${t.student.id||"temp"}/${V}`);await Rv(J),await deleteDoc(Ze(qe,"pdfMetadata",V)),console.log("Secure BIP file deleted:",V)}catch(J){console.warn("Error deleting secure BIP file:",J)}V=null}if(y.removeAtaglanceFile&&(console.log("Removing At-A-Glance file..."),te)){try{const J=se(kc,`students/${t.student.id||"temp"}/${te}`);await Rv(J),await deleteDoc(Ze(qe,"pdfMetadata",te)),console.log("Secure At-A-Glance file deleted:",te)}catch(J){console.warn("Error deleting secure At-A-Glance file:",J)}te=null}const oe={studentData:{firstName:y.firstName,lastName:y.lastName,grade:y.grade,plan:y.plan,caseManagerId:y.caseManagerId},dates:{reviewDate:y.reviewDate,reevalDate:y.reevalDate,meetingDate:y.meetingDate},schedule:{periods:H,classServices:j},providers:{speechId:y.speechId,otId:y.otId,mhId:y.mhId,ptId:y.ptId,scId:y.scId,trId:y.trId,audId:y.audId,viId:y.viId,atId:y.atId,dhhId:y.dhhId,omId:y.omId,bisId:y.bisId,hnId:y.hnId,swId:y.swId},accommodations:{instruction:y.instruction,assessment:y.assessment},flags:{flag1:y.flag1,flag2:y.flag2,customFlags:((G=(O=y.app)==null?void 0:O.flags)==null?void 0:G.customFlags)||[]},documents:{ataglancePdfUrl:te,bipPdfUrl:V,bipFileName:y.bipFileName||null,ataglanceFileName:y.ataglanceFileName||null,additionalDocuments:y.additionalDocuments.filter(J=>!J.toRemove&&J.pdfUrl).map(J=>({id:J.id,title:J.title,pdfUrl:J.pdfUrl,fileName:J.fileName,uploadDate:J.uploadDate||new Date().toISOString()}))}};console.log("📋 Documents being saved:",{ataglancePdfUrl:te,bipPdfUrl:V,bipFileName:y.bipFileName||null,ataglanceFileName:y.ataglanceFileName||null}),console.log("Saving payload:",oe);const ne={app:oe,updatedAt:Dn(),updatedBy:((z=a.currentUser)==null?void 0:z.uid)||null};console.log("Saving payload:",ne);let le=null;if(t.mode==="edit"&&t.student.id)console.log("Updating existing student:",t.student.id),await jt(Ze(qe,"students",t.student.id),ne,{merge:!0}),le=t.student.id,console.log("Student updated successfully"),await sn.logStudentAccess(t.student.id,"edit",{fields:Object.keys(oe.studentData||{}),hasDocuments:!!(te||V),formMode:"edit"});else{if(console.log("Adding new student"),!y.ssid||y.ssid.trim()===""){alert("SSID is required for new students");return}const J=y.ssid.trim();ne.app.studentData.ssid=J;const Q=Ze(At(qe,"students"));ne.createdAt=Dn(),await jt(Q,ne),le=Q.id,ne.id=le,console.log("Student added successfully with ID:",le,"SSID:",J),await sn.logStudentAccess(le,"create",{ssid:J,fields:Object.keys(oe.studentData||{}),hasDocuments:!!(te||V),formMode:"create"})}e("saved",ne),e("close")}catch(j){console.error("Error saving student:",j),console.error("Error details:",{code:j.code,message:j.message,stack:j.stack}),alert(`Error saving student: ${j.message||j}. Please try again.`)}finally{o.value=!1}},validateForm:F}}const wV={class:"form-col"},CV={class:"inner-grid-3"},IV={key:0,class:"ssid-field"},kV=["value"],DV=["value"],PV={__name:"StudentBasicInfo",props:{form:{type:Object,required:!0},mode:{type:String,default:"new"},gradeOptions:{type:Array,required:!0},userRoles:{type:Object,required:!0}},setup(t){const e=t,r=Se(()=>(e.userRoles.caseManagers||[]).sort((s,i)=>(s.name||s.email||s.id).localeCompare(i.name||i.email||i.id)));return(n,s)=>(L(),B("fieldset",wV,[s[21]||(s[21]=d("legend",null,"Student Info",-1)),d("div",CV,[t.mode==="new"?(L(),B("label",IV,[s[9]||(s[9]=d("span",{class:"field-label"},"SSID (State Student ID) *",-1)),Ne(d("input",{"onUpdate:modelValue":s[0]||(s[0]=i=>t.form.ssid=i),type:"text",required:"",placeholder:"Enter student SSID",class:"ssid-input"},null,512),[[ft,t.form.ssid]]),s[10]||(s[10]=d("div",{class:"field-help"},[d("strong",null,"Required:"),we(" This can be found in your Student Information System (SIS) such as Aeries, or in SEIS. The SSID is used to link student data across different systems. ")],-1))])):_e("",!0),d("label",null,[s[11]||(s[11]=we(" First Name: ")),Ne(d("input",{"onUpdate:modelValue":s[1]||(s[1]=i=>t.form.firstName=i),type:"text",required:""},null,512),[[ft,t.form.firstName]])]),d("label",null,[s[12]||(s[12]=we(" Last Name: ")),Ne(d("input",{"onUpdate:modelValue":s[2]||(s[2]=i=>t.form.lastName=i),type:"text",required:""},null,512),[[ft,t.form.lastName]])]),d("label",null,[s[13]||(s[13]=we(" Grade: ")),Ne(d("select",{"onUpdate:modelValue":s[3]||(s[3]=i=>t.form.grade=i)},[(L(!0),B(De,null,$e(t.gradeOptions,i=>(L(),B("option",{key:i,value:i},Z(i),9,kV))),128))],512),[[sr,t.form.grade]])]),d("label",null,[s[15]||(s[15]=we(" Plan Type: ")),Ne(d("select",{"onUpdate:modelValue":s[4]||(s[4]=i=>t.form.plan=i)},s[14]||(s[14]=[d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),512),[[sr,t.form.plan]])]),d("label",null,[s[16]||(s[16]=we(" Review Date: ")),Ne(d("input",{"onUpdate:modelValue":s[5]||(s[5]=i=>t.form.reviewDate=i),type:"date"},null,512),[[ft,t.form.reviewDate]])]),d("label",null,[s[17]||(s[17]=we(" Reevaluation Date: ")),Ne(d("input",{"onUpdate:modelValue":s[6]||(s[6]=i=>t.form.reevalDate=i),type:"date"},null,512),[[ft,t.form.reevalDate]])]),d("label",null,[s[18]||(s[18]=we(" Meeting Date: ")),Ne(d("input",{"onUpdate:modelValue":s[7]||(s[7]=i=>t.form.meetingDate=i),type:"date"},null,512),[[ft,t.form.meetingDate]])]),d("label",null,[s[20]||(s[20]=we(" Case Manager: ")),Ne(d("select",{"onUpdate:modelValue":s[8]||(s[8]=i=>t.form.caseManagerId=i)},[s[19]||(s[19]=d("option",{value:""},"-- Select Case Manager --",-1)),(L(!0),B(De,null,$e(r.value,i=>(L(),B("option",{key:i.id,value:i.id},Z(i.name||i.email||i.id),9,DV))),128))],512),[[sr,t.form.caseManagerId]])])])]))}},RV=St(PV,[["__scopeId","data-v-7a03f4ab"]]),FV={class:"form-col"},NV={class:"periods-container"},OV={class:"period-main"},MV={class:"period-label"},LV=["value","onChange"],BV=["value"],UV=["disabled","onClick"],$V={key:0,class:"coteaching-config"},VV={class:"coteaching-info"},HV={class:"classroom-teacher"},jV={class:"case-manager-name"},GV={class:"config-row"},WV=["value","onChange"],zV=["value"],KV={class:"config-row"},qV=["value","onChange"],XV=["value"],YV={__name:"StudentSchedule",props:{form:{type:Object,required:!0},periods:{type:Array,required:!0},userRoles:{type:Object,required:!0},appSettings:{type:Object,default:()=>({})}},setup(t){const e=t,{getLabel:r}=Eo(),n=Se(()=>(e.userRoles.teachers||[]).sort((_,v)=>(_.name||_.email||_.id).localeCompare(v.name||v.email||v.id))),s=Se(()=>(e.userRoles.caseManagers||[]).filter(_=>_.id&&(_.role==="case_manager"||_.role==="admin_504"||_.role==="administrator_504_CM"||_.role==="sped_chair"||_.roles&&_.roles.includes("case_manager"))).sort((_,v)=>(_.name||_.email||_.id).localeCompare(v.name||v.email||v.id))),i=Se(()=>{var b;if((b=e.appSettings)!=null&&b.classServices){const _=e.appSettings.classServices.find(v=>v.name==="Co-teach"&&v.enabledSubcategories);if(_)return _.enabledSubcategories.sort()}return["English","Math","History","Science"]}),a=b=>{const _=e.form.schedule[b];return typeof _=="string"?_:typeof _=="object"&&_!==null&&_.teacherId||""},o=(b,_)=>{if(p("SET_TEACHER_START",{period:b,teacherId:_,isCoTeachingActive:u(b),currentValue:e.form.schedule[b]}),u(b)){const v=f(b),A=h(b);e.form.schedule[b]={teacherId:_,coTeaching:{caseManagerId:v,subject:A}},p("SET_TEACHER_COTEACHING",{period:b,newValue:e.form.schedule[b]})}else e.form.schedule[b]=_,p("SET_TEACHER_SIMPLE",{period:b,newValue:e.form.schedule[b]})},l=b=>{if(!b)return"Unknown";const _=(e.userRoles.teachers||[]).find(v=>v.id===b);return _&&(_.name||_.email)||b},c=b=>{if(!b)return"Select Case Manager";const _=s.value.find(v=>v.id===b);return _&&(_.name||_.email)||b},u=b=>{var v;const _=e.form.schedule[b];return typeof _=="object"&&_!==null?!!((v=_.coTeaching)!=null&&v.caseManagerId):!1},f=b=>{var v;const _=e.form.schedule[b];return typeof _=="object"&&_!==null&&((v=_.coTeaching)==null?void 0:v.caseManagerId)||""},h=b=>{var v;const _=e.form.schedule[b];return typeof _=="object"&&_!==null&&((v=_.coTeaching)==null?void 0:v.subject)||""},p=(b,_)=>{const v=new Date().toISOString();console.log(`🕒 [${v}] Schedule Process: ${b}`,_)},g=(b,_)=>{p("UPDATE_CM_START",{period:b,caseManagerId:_,currentValue:e.form.schedule[b]});const v=a(b),A=h(b);v?(e.form.schedule[b]={teacherId:v,coTeaching:{caseManagerId:_,subject:A}},p("UPDATE_CM_COMPLETE",{period:b,newValue:e.form.schedule[b]}),console.log("🔍 CO-TEACHING DEBUG - Case Manager Updated:",{period:b,periodType:typeof b,caseManagerId:_,teacherId:v,subject:A,finalValue:e.form.schedule[b],entireSchedule:JSON.stringify(e.form.schedule,null,2)})):p("UPDATE_CM_BLOCKED",{reason:"No teacher ID",period:b})},y=(b,_)=>{p("UPDATE_SUBJECT_START",{period:b,subject:_,currentValue:e.form.schedule[b]});const v=a(b),A=f(b);v?(e.form.schedule[b]={teacherId:v,coTeaching:{caseManagerId:A,subject:_}},p("UPDATE_SUBJECT_COMPLETE",{period:b,newValue:e.form.schedule[b]}),console.log("🔍 CO-TEACHING DEBUG - Subject Updated:",{period:b,periodType:typeof b,subject:_,teacherId:v,caseManagerId:A,finalValue:e.form.schedule[b],entireSchedule:JSON.stringify(e.form.schedule,null,2)})):p("UPDATE_SUBJECT_BLOCKED",{reason:"No teacher ID",period:b})},E=b=>{var A;p("TOGGLE_START",{period:b,currentValue:e.form.schedule[b],formVersion:e.formVersion});const _=a(b);if(!_){p("TOGGLE_BLOCKED",{reason:"No teacher selected",period:b});return}const v=u(b);if(p("TOGGLE_STATE",{period:b,isActive:v,teacherId:_,beforeValue:e.form.schedule[b]}),v)e.form.schedule[b]=_;else{const D={teacherId:_,coTeaching:{caseManagerId:((A=s.value[0])==null?void 0:A.id)||"",subject:i.value[0]||""}};e.form.schedule[b]=D,setTimeout(()=>{var k;console.log("🔍 CO-TEACHING PERSISTENCE CHECK - 100ms later:",{period:b,stillExists:!!e.form.schedule[b],currentValue:e.form.schedule[b],isObject:typeof e.form.schedule[b]=="object",hasCoTeaching:!!((k=e.form.schedule[b])!=null&&k.coTeaching)})},100),setTimeout(()=>{var k;console.log("🔍 CO-TEACHING PERSISTENCE CHECK - 1000ms later:",{period:b,stillExists:!!e.form.schedule[b],currentValue:e.form.schedule[b],isObject:typeof e.form.schedule[b]=="object",hasCoTeaching:!!((k=e.form.schedule[b])!=null&&k.coTeaching)})},1e3)}p("TOGGLE_COMPLETE",{period:b,afterValue:e.form.schedule[b],formVersion:e.formVersion}),console.log("🔍 CO-TEACHING DEBUG - Toggle Complete:",{period:b,periodType:typeof b,isActive:!v,finalValue:e.form.schedule[b],entireSchedule:JSON.stringify(e.form.schedule,null,2),availableCaseManagers:s.value.length,availableSubjects:i.value.length})};return Ht(()=>e.form.schedule,(b,_)=>{console.log("🔍 SCHEDULE WATCHER - Schedule changed:",{timestamp:new Date().toISOString(),newSchedule:JSON.stringify(b,null,2),oldSchedule:JSON.stringify(_,null,2),periodsWithObjects:Object.keys(b).filter(v=>typeof b[v]=="object"),periodsWithCoTeaching:Object.keys(b).filter(v=>{var A;return(A=b[v])==null?void 0:A.coTeaching})})},{deep:!0}),(b,_)=>(L(),B("fieldset",FV,[_[7]||(_[7]=d("legend",null,"Schedule",-1)),d("div",NV,[(L(!0),B(De,null,$e(t.periods,v=>(L(),B("div",{key:v,class:"period-row"},[d("div",OV,[d("label",MV,Z(q(r)(v))+":",1),d("select",{value:a(v),onChange:A=>o(v,A.target.value),class:"teacher-select"},[_[0]||(_[0]=d("option",{value:""},"--",-1)),(L(!0),B(De,null,$e(n.value,A=>(L(),B("option",{key:A.id,value:A.id},Z(A.name||A.email||A.id),9,BV))),128))],40,LV),d("button",{type:"button",class:Xe(["coteaching-toggle",{active:u(v)}]),disabled:!a(v),onClick:A=>E(v),title:"Co-Teaching"}," C ",10,UV)]),u(v)?(L(),B("div",$V,[d("div",VV,[_[1]||(_[1]=d("span",{class:"coteaching-label"},"Co-Teaching:",-1)),d("span",HV,Z(l(a(v))),1),_[2]||(_[2]=d("span",{class:"plus-sign"},"+",-1)),d("span",jV,Z(c(f(v))),1)]),d("div",GV,[_[4]||(_[4]=d("label",{class:"config-label"},"Subject:",-1)),d("select",{value:h(v),onChange:A=>y(v,A.target.value),class:"subject-select",required:""},[_[3]||(_[3]=d("option",{value:""},"-- Select Subject --",-1)),(L(!0),B(De,null,$e(i.value,A=>(L(),B("option",{key:A,value:A},Z(A),9,zV))),128))],40,WV)]),d("div",KV,[_[6]||(_[6]=d("label",{class:"config-label"},"Case Manager:",-1)),d("select",{value:f(v),onChange:A=>g(v,A.target.value),class:"cm-select",required:""},[_[5]||(_[5]=d("option",{value:""},"-- Select Case Manager --",-1)),(L(!0),B(De,null,$e(s.value,A=>(L(),B("option",{key:A.id,value:A.id},Z(A.name||A.email||A.id),9,XV))),128))],40,qV)])])):_e("",!0)]))),128))])]))}},QV=St(YV,[["__scopeId","data-v-88d1e9f7"]]),JV={class:"checkbox-inline-group"},ZV=["value","checked","onChange"],Pb={__name:"ServiceCheckboxGroup",props:["label","items","modelValue"],emits:["update:modelValue"],setup(t,{emit:e}){const r=t,n=e;function s(i){const a=r.label+": "+i,o=r.modelValue?[...r.modelValue]:[],l=o.indexOf(a);l===-1?o.push(a):o.splice(l,1),n("update:modelValue",o)}return(i,a)=>(L(),B("fieldset",null,[d("legend",null,Z(t.label),1),d("div",JV,[(L(!0),B(De,null,$e(t.items,o=>(L(),B("label",{key:o},[d("input",{type:"checkbox",value:t.label+": "+o,checked:t.modelValue&&t.modelValue.includes(t.label+": "+o),onChange:l=>s(o)},null,40,ZV),we(" "+Z(o),1)]))),128))])]))}},eH={class:"form-col"},tH={class:"inner-grid-3"},rH={key:0,class:"loading-message"},nH={key:1,class:"error-message"},sH={style:{display:"none"}},aH={key:3,class:"no-services-message"},iH={__name:"StudentClassServices",props:{form:{type:Object,required:!0},availableClassServices:{type:Array,required:!0},appSettingsLoading:{type:Boolean,default:!1},appSettingsError:{type:String,default:null}},setup(t){const e=t,r=Se(()=>e.availableClassServices.filter(s=>s.name!=="Co-teach")),n=Se(()=>e.availableClassServices.filter(s=>s.name==="Co-teach"));return(s,i)=>(L(),B("fieldset",eH,[i[5]||(i[5]=d("legend",null,"Services: classes",-1)),d("div",tH,[t.appSettingsLoading?(L(),B("div",rH,i[2]||(i[2]=[d("span",{class:"loading-spinner"},"⏳",-1),we(" Loading app settings... ")]))):t.appSettingsError?(L(),B("div",nH,[i[3]||(i[3]=d("span",{class:"error-icon"},"⚠️",-1)),we(" Error loading app settings: "+Z(t.appSettingsError),1)])):t.availableClassServices.length>0?(L(),B(De,{key:2},[(L(!0),B(De,null,$e(r.value,a=>(L(),Jt(Pb,{key:a.name,label:a.name,items:a.enabledSubcategories,modelValue:t.form.services,"onUpdate:modelValue":i[0]||(i[0]=o=>t.form.services=o)},null,8,["label","items","modelValue"]))),128)),d("div",sH,[(L(!0),B(De,null,$e(n.value,a=>(L(),Jt(Pb,{key:a.name,label:a.name,items:a.enabledSubcategories,modelValue:t.form.services,"onUpdate:modelValue":i[1]||(i[1]=o=>t.form.services=o)},null,8,["label","items","modelValue"]))),128))])],64)):(L(),B("div",aH,i[4]||(i[4]=[d("span",{class:"info-icon"},"ℹ️",-1),we(" No class services configured. "),d("a",{href:"/admin",class:"settings-link"},"Configure in App Settings",-1)])))])]))}},oH=St(iH,[["__scopeId","data-v-d750acb2"]]),lH=["id","value"],cH=["value"],Rb={__name:"ServiceSelect",props:["id","label","list","modelValue"],emits:["update:modelValue"],setup(t){const e=t,r=Se(()=>(e.list||[]).sort((s,i)=>(s.name||s.email||s.id).localeCompare(i.name||i.email||i.id)));return(n,s)=>(L(),B("label",null,[we(Z(t.label)+": ",1),d("select",{id:t.id,value:t.modelValue,onChange:s[0]||(s[0]=i=>n.$emit("update:modelValue",i.target.value))},[s[1]||(s[1]=d("option",{value:""},"--",-1)),(L(!0),B(De,null,$e(r.value,i=>(L(),B("option",{key:i.id,value:i.id},Z(i.name),9,cH))),128))],40,lH)]))}},uH={class:"inner-grid-3"},dH={key:1,class:"no-services-message"},fH={__name:"StudentProviders",props:{form:{type:Object,required:!0},serviceProviders:{type:Array,required:!0},customServiceProviders:{type:Array,required:!0},providerFieldMap:{type:Object,required:!0},getProviderLabel:{type:Function,required:!0},getProviderUsers:{type:Function,required:!0}},setup(t){return(e,r)=>(L(),B("fieldset",null,[r[1]||(r[1]=d("legend",null,"Services: providers",-1)),d("div",uH,[t.serviceProviders.length>0?(L(),B(De,{key:0},[(L(!0),B(De,null,$e(t.serviceProviders,n=>(L(),Jt(Rb,{key:n,id:n,label:t.getProviderLabel(n),list:t.getProviderUsers(n),modelValue:t.form[t.providerFieldMap[n]||`${n.toLowerCase()}Id`],"onUpdate:modelValue":s=>t.form[t.providerFieldMap[n]||`${n.toLowerCase()}Id`]=s},null,8,["id","label","list","modelValue","onUpdate:modelValue"]))),128)),(L(!0),B(De,null,$e(t.customServiceProviders,n=>(L(),Jt(Rb,{key:n,id:n,label:n,list:[],modelValue:t.form[`${n.toLowerCase()}Id`],"onUpdate:modelValue":s=>t.form[`${n.toLowerCase()}Id`]=s},null,8,["id","label","modelValue","onUpdate:modelValue"]))),128))],64)):(L(),B("div",dH,r[0]||(r[0]=[d("span",{class:"info-icon"},"ℹ️",-1),we(" No service providers configured. "),d("a",{href:"/admin",class:"settings-link"},"Configure in App Settings",-1)])))])]))}},hH=St(fH,[["__scopeId","data-v-faa02238"]]),pH={class:"form-col"},mH={class:"document-section"},gH={key:0,class:"current-file"},vH={key:1,class:"removed-file"},yH={key:2,class:"upload-status loading-pulse"},xH={key:3,class:"error-message"},EH={class:"document-section"},_H={key:0,class:"current-file"},bH={key:1,class:"removed-file"},SH={key:2,class:"upload-status loading-pulse"},AH={class:"additional-documents-section"},TH={class:"additional-docs-header"},wH={class:"doc-counter"},CH={class:"additional-doc-header"},IH={class:"doc-title"},kH={key:0,class:"doc-upload-area"},DH=["onChange"],PH={key:1,class:"current-file"},RH=["onClick"],FH=["onClick"],NH={key:2,class:"removed-file"},OH=["onClick"],MH={key:3,class:"upload-status loading-pulse"},LH={key:0,class:"add-document-section"},BH={key:0,class:"add-document-button-container"},UH={key:1,class:"add-document-form"},$H={class:"title-input-container"},VH={class:"char-counter"},HH={class:"add-form-buttons"},jH=["disabled"],GH={key:1,class:"max-documents-message"},WH={__name:"StudentDocuments",props:{form:{type:Object,required:!0},student:{type:Object,default:()=>({})},mode:{type:String,default:"new"},onFileChange:{type:Function,required:!0},removeBipFile:{type:Function,required:!0},removeAtaglanceFile:{type:Function,required:!0},addAdditionalDocument:{type:Function,required:!0},removeAdditionalDocument:{type:Function,required:!0},undoRemoveAdditionalDocument:{type:Function,required:!0},deleteAdditionalDocument:{type:Function,required:!0}},emits:["loading-change"],setup(t,{emit:e}){const r=t,n=e,{uploadPdf:s,downloadPdf:i,isUploading:a,error:o}=nx(),l=se(null),c=Se(()=>a.value||l.value!==null);Ht(c,k=>{n("loading-change",k)},{immediate:!0});const u=Se(()=>{var T,x,m,S;const k=((T=r.student)==null?void 0:T.id)||((x=r.form)==null?void 0:x.id);return console.log("🔍 StudentDocuments - studentId computed:",{studentId:(m=r.student)==null?void 0:m.id,formId:(S=r.form)==null?void 0:S.id,finalId:k}),k}),f=async(k,T)=>{const x=k.target.files[0]||null;if(x){const m=ol(x,{allowedTypes:["pdf"],maxSize:10485760,fieldName:T==="bipFile"?"BIP Document":"At-A-Glance Document"});if(!m.isValid){alert(m.error),k.target.value="";return}const S=Hr(x.name);if(!S.isSafe){alert(`File name contains potentially dangerous content: ${S.threats.join(", ")}`),k.target.value="";return}try{if(l.value=T==="bipFile"?"bip":"ataglance",!u.value)throw new Error("Student ID is required for secure file upload");const I=T==="bipFile"?r.form.bipPdfUrl:r.form.ataglancePdfUrl;if(I){console.log(`🗑️ Cleaning up old ${T} file:`,I);try{const{ref:F,deleteObject:W}=await ua(async()=>{const{ref:G,deleteObject:z}=await Promise.resolve().then(()=>XM);return{ref:G,deleteObject:z}},void 0),{doc:P,deleteDoc:R}=await ua(async()=>{const{doc:G,deleteDoc:z}=await Promise.resolve().then(()=>F9);return{doc:G,deleteDoc:z}},void 0),{storage:N,db:M}=await ua(async()=>{const{storage:G,db:z}=await Promise.resolve().then(()=>H4);return{storage:G,db:z}},void 0),O=F(N,`students/${u.value}/${I}`);await W(O),await R(P(M,"pdfMetadata",I)),console.log(`✅ Old ${T} file cleaned up:`,I)}catch(F){console.warn(`Failed to clean up old ${T} file:`,F.message)}}const C=await s(x,u.value);T==="bipFile"?(Object.assign(r.form,{bipPdfUrl:C,bipFileName:x.name}),console.log("✅ BIP file updated in form:",{bipPdfUrl:r.form.bipPdfUrl,bipFileName:r.form.bipFileName})):(Object.assign(r.form,{ataglancePdfUrl:C,ataglanceFileName:x.name}),console.log("✅ At-A-Glance file updated in form:",{ataglancePdfUrl:r.form.ataglancePdfUrl,ataglanceFileName:r.form.ataglanceFileName})),console.log(`✅ Secure PDF uploaded: ${C}`),console.log("📋 Current form state:",{bipPdfUrl:r.form.bipPdfUrl,bipFileName:r.form.bipFileName,ataglancePdfUrl:r.form.ataglancePdfUrl,ataglanceFileName:r.form.ataglanceFileName})}catch(I){console.error("Secure PDF upload failed:",I),alert(`Failed to upload PDF: ${I.message}`)}finally{l.value=null,k.target.value=""}}r.onFileChange(k,T)},h=async k=>{try{const T=k==="bip"?r.form.bipPdfUrl:r.form.ataglancePdfUrl,x=k==="bip"?r.form.bipFileName:r.form.ataglanceFileName;if(!T||!u.value)throw new Error("File not found or student ID missing");await i(T,u.value,x)}catch(T){console.error("Secure PDF download failed:",T),alert(`Failed to download PDF: ${T.message}`)}},p=se(!1),g=se(""),y=Se(()=>r.form.additionalDocuments||[]),E=Se(()=>2+y.value.length<10),b=()=>{p.value=!0,g.value=""},_=()=>{p.value=!1,g.value=""},v=async()=>{try{if(!g.value.trim()){alert("Please enter a document title");return}const k=r.addAdditionalDocument(g.value.trim());p.value=!1,g.value=""}catch(k){alert(k.message)}},A=async(k,T)=>{const x=k.target.files[0]||null;if(x){const m=ol(x,{allowedTypes:["pdf"],maxSize:10485760,fieldName:"Additional Document"});if(!m.isValid){alert(m.error),k.target.value="";return}const S=Hr(x.name);if(!S.isSafe){alert(`File name contains potentially dangerous content: ${S.threats.join(", ")}`),k.target.value="";return}try{if(l.value=T,!u.value)throw new Error("Student ID is required for secure file upload");const I=await s(x,u.value),C=r.form.additionalDocuments.find(F=>F.id===T);C&&Object.assign(C,{pdfUrl:I,fileName:x.name,uploadDate:new Date().toISOString()}),console.log(`✅ Additional document uploaded: ${I}`)}catch(I){console.error("Additional document upload failed:",I),alert(`Failed to upload PDF: ${I.message}`)}finally{l.value=null,k.target.value=""}}},D=async k=>{try{if(!k.pdfUrl||!u.value)throw new Error("File not found or student ID missing");await i(k.pdfUrl,u.value,k.fileName)}catch(T){console.error("Additional document download failed:",T),alert(`Failed to download PDF: ${T.message}`)}};return(k,T)=>(L(),B("fieldset",pH,[T[29]||(T[29]=d("legend",null,"Documents",-1)),d("div",mH,[d("label",null,[T[14]||(T[14]=we(" BIP: ")),d("input",{type:"file",accept:"application/pdf",onChange:T[0]||(T[0]=x=>f(x,"bipFile"))},null,32),t.form.bipPdfUrl&&!t.form.removeBipFile?(L(),B("span",gH,[T[10]||(T[10]=we(" Current: ")),d("a",{href:"#",onClick:T[1]||(T[1]=Yr(x=>h("bip"),["prevent"])),target:"_blank"},"View BIP"),d("button",{type:"button",onClick:T[2]||(T[2]=(...x)=>t.removeBipFile&&t.removeBipFile(...x)),class:"btn-remove"},[Pe(q(qo),{size:16}),T[9]||(T[9]=we(" Remove "))])])):_e("",!0),t.form.removeBipFile?(L(),B("span",vH,[T[12]||(T[12]=we(" BIP file will be removed ")),d("button",{type:"button",onClick:T[3]||(T[3]=x=>t.form.removeBipFile=!1),class:"btn-undo"},[Pe(q(I0),{size:16}),T[11]||(T[11]=we(" Undo "))])])):_e("",!0),q(a)&&l.value==="bip"?(L(),B("div",yH,[Pe(q(hc),{size:16,class:"loading-spinner"}),T[13]||(T[13]=d("strong",null,"Loading... Uploading BIP document...",-1))])):_e("",!0),q(o)?(L(),B("div",xH,Z(q(o)),1)):_e("",!0)])]),d("div",EH,[d("label",null,[T[20]||(T[20]=we(" At-A-Glance PDF: ")),d("input",{type:"file",accept:"application/pdf",onChange:T[4]||(T[4]=x=>f(x,"ataglanceFile"))},null,32),t.form.ataglancePdfUrl&&!t.form.removeAtaglanceFile?(L(),B("span",_H,[T[16]||(T[16]=we(" Current: ")),d("a",{href:"#",onClick:T[5]||(T[5]=Yr(x=>h("ataglance"),["prevent"])),target:"_blank"},"View At-A-Glance"),d("button",{type:"button",onClick:T[6]||(T[6]=(...x)=>t.removeAtaglanceFile&&t.removeAtaglanceFile(...x)),class:"btn-remove"},[Pe(q(qo),{size:16}),T[15]||(T[15]=we(" Remove "))])])):_e("",!0),t.form.removeAtaglanceFile?(L(),B("span",bH,[T[18]||(T[18]=we(" At-A-Glance file will be removed ")),d("button",{type:"button",onClick:T[7]||(T[7]=x=>t.form.removeAtaglanceFile=!1),class:"btn-undo"},[Pe(q(I0),{size:16}),T[17]||(T[17]=we(" Undo "))])])):_e("",!0),q(a)&&l.value==="ataglance"?(L(),B("div",SH,[Pe(q(hc),{size:16,class:"loading-spinner"}),T[19]||(T[19]=d("strong",null,"Loading... Uploading At-A-Glance document...",-1))])):_e("",!0)])]),d("div",AH,[d("div",TH,[T[21]||(T[21]=d("h4",null,"Additional Documents",-1)),d("span",wH,Z(y.value.length)+"/8 max",1)]),(L(!0),B(De,null,$e(y.value,x=>(L(),B("div",{key:x.id,class:"document-section additional-doc"},[d("div",CH,[Pe(q(Ku),{size:16,class:"doc-icon"}),d("span",IH,Z(x.title),1)]),!x.pdfUrl&&!x.toRemove?(L(),B("div",kH,[d("input",{type:"file",accept:"application/pdf",onChange:m=>A(m,x.id),class:"additional-doc-input"},null,40,DH)])):_e("",!0),x.pdfUrl&&!x.toRemove?(L(),B("span",PH,[T[23]||(T[23]=we(" Current: ")),d("a",{href:"#",onClick:Yr(m=>D(x),["prevent"]),target:"_blank"},"View "+Z(x.title),9,RH),d("button",{type:"button",onClick:m=>t.removeAdditionalDocument(x.id),class:"btn-remove"},[Pe(q(qo),{size:16}),T[22]||(T[22]=we(" Remove "))],8,FH)])):_e("",!0),x.toRemove?(L(),B("span",NH,[we(Z(x.title)+" will be removed ",1),d("button",{type:"button",onClick:m=>t.undoRemoveAdditionalDocument(x.id),class:"btn-undo"},[Pe(q(I0),{size:16}),T[24]||(T[24]=we(" Undo "))],8,OH)])):_e("",!0),q(a)&&l.value===x.id?(L(),B("div",MH,[Pe(q(hc),{size:16,class:"loading-spinner"}),d("strong",null,"Loading... Uploading "+Z(x.title)+"...",1)])):_e("",!0)]))),128)),E.value?(L(),B("div",LH,[p.value?_e("",!0):(L(),B("div",BH,[d("button",{type:"button",onClick:b,class:"btn-add-document"},[Pe(q(j_),{size:16}),T[25]||(T[25]=we(" Add Document "))])])),p.value?(L(),B("div",UH,[d("div",$H,[T[26]||(T[26]=d("label",{for:"newDocTitle"},"Document Title (max 24 characters):",-1)),Ne(d("input",{id:"newDocTitle",type:"text","onUpdate:modelValue":T[8]||(T[8]=x=>g.value=x),maxlength:"24",placeholder:"Enter document title...",class:"title-input",onKeyup:F1(v,["enter"])},null,544),[[ft,g.value]]),d("span",VH,Z(g.value.length)+"/24",1)]),d("div",HH,[d("button",{type:"button",onClick:v,disabled:!g.value.trim(),class:"btn-confirm"},[Pe(q(j_),{size:16}),T[27]||(T[27]=we(" Add "))],8,jH),d("button",{type:"button",onClick:_,class:"btn-cancel"}," Cancel ")])])):_e("",!0)])):_e("",!0),E.value?_e("",!0):(L(),B("div",GH,T[28]||(T[28]=[d("span",null,"Maximum of 10 documents reached (including BIP and At-A-Glance)",-1)])))])]))}},zH=St(WH,[["__scopeId","data-v-039d1d4d"]]),KH={class:"form-col"},qH={class:"inner-grid-2"},XH={__name:"StudentAccommodations",props:{form:{type:Object,required:!0}},setup(t){return(e,r)=>(L(),B("fieldset",KH,[r[4]||(r[4]=d("legend",null,"Accommodations",-1)),d("div",qH,[d("label",null,[r[2]||(r[2]=we(" Instruction: ")),Ne(d("textarea",{"onUpdate:modelValue":r[0]||(r[0]=n=>t.form.instruction=n),placeholder:"Enter instructional accommodations..."},null,512),[[ft,t.form.instruction]])]),d("label",null,[r[3]||(r[3]=we(" Assessment: ")),Ne(d("textarea",{"onUpdate:modelValue":r[1]||(r[1]=n=>t.form.assessment=n),placeholder:"Enter assessment accommodations..."},null,512),[[ft,t.form.assessment]])])])]))}},YH=St(XH,[["__scopeId","data-v-4ce4f379"]]),QH={class:"flags-section"},JH={class:"flags-container"},ZH={class:"checkbox-label"},ej={class:"checkbox-label"},tj={class:"flags-section"},rj={class:"new-flag"},nj={class:"flag-colors"},sj={class:"color-option"},aj={class:"color-option"},ij={class:"color-option"},oj=["disabled"],lj={key:0,class:"current-flags"},cj={class:"flag-text"},uj=["onClick"],dj={key:1,class:"no-flags"},fj={__name:"StudentFlags",props:{form:{type:Object,required:!0}},setup(t){const e=t;e.form.app||(e.form.app={}),e.form.app.flags||(e.form.app.flags={}),e.form.app.flags.customFlags||(e.form.app.flags.customFlags=[]);const r=Se({get:()=>{var o,l;return((l=(o=e.form.app)==null?void 0:o.flags)==null?void 0:l.customFlags)||[]},set:o=>{e.form.app||(e.form.app={}),e.form.app.flags||(e.form.app.flags={}),e.form.app.flags.customFlags=o}}),n=As({text:"",color:"red"}),s=Se(()=>n.text.trim().length>0&&n.text.length<=50),i=()=>{var c;if(!s.value)return;const o=uo(),l={color:n.color,text:n.text.trim(),createdAt:new Date().toISOString(),createdBy:((c=o.currentUser)==null?void 0:c.uid)||"system"};r.value=[...r.value,l],n.text="",n.color="red"},a=o=>{const l=[...r.value];l.splice(o,1),r.value=l};return(o,l)=>(L(),B("fieldset",null,[l[16]||(l[16]=d("legend",null,"Flags",-1)),d("div",QH,[l[8]||(l[8]=d("h4",null,"System Flags",-1)),d("div",JH,[d("label",ZH,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":l[0]||(l[0]=c=>t.form.flag1=c)},null,512),[[bt,t.form.flag1]]),l[6]||(l[6]=we(" Preferential seating "))]),d("label",ej,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":l[1]||(l[1]=c=>t.form.flag2=c)},null,512),[[bt,t.form.flag2]]),l[7]||(l[7]=we(" Separate setting "))])])]),d("div",tj,[l[15]||(l[15]=d("h4",null,"Custom Flags",-1)),d("div",rj,[Ne(d("input",{"onUpdate:modelValue":l[2]||(l[2]=c=>n.text=c),maxlength:50,placeholder:"Enter flag note (max 50 chars)",class:"flag-input"},null,512),[[ft,n.text]]),d("div",nj,[d("label",sj,[Ne(d("input",{type:"radio",value:"blue","onUpdate:modelValue":l[3]||(l[3]=c=>n.color=c)},null,512),[[Ss,n.color]]),l[9]||(l[9]=d("span",{class:"color-dot blue"},null,-1)),l[10]||(l[10]=we(" Info "))]),d("label",aj,[Ne(d("input",{type:"radio",value:"yellow","onUpdate:modelValue":l[4]||(l[4]=c=>n.color=c)},null,512),[[Ss,n.color]]),l[11]||(l[11]=d("span",{class:"color-dot yellow"},null,-1)),l[12]||(l[12]=we(" Caution "))]),d("label",ij,[Ne(d("input",{type:"radio",value:"red","onUpdate:modelValue":l[5]||(l[5]=c=>n.color=c)},null,512),[[Ss,n.color]]),l[13]||(l[13]=d("span",{class:"color-dot red"},null,-1)),l[14]||(l[14]=we(" Alert "))])]),d("button",{type:"button",onClick:i,disabled:!s.value,class:"add-flag-btn"}," Add Flag ",8,oj)]),r.value.length?(L(),B("ul",lj,[(L(!0),B(De,null,$e(r.value,(c,u)=>(L(),B("li",{key:u,class:Xe([c.color,"flag-item"])},[d("span",{class:Xe(["color-dot",c.color])},null,2),d("span",cj,Z(c.text),1),d("button",{type:"button",class:"remove-flag",onClick:f=>a(u),title:"Remove flag"},"×",8,uj)],2))),128))])):_e("",!0),r.value.length?_e("",!0):(L(),B("div",dj," No custom flags added yet "))])]))}},hj=St(fj,[["__scopeId","data-v-6a7a6f60"]]),pj={class:"dialog-backdrop"},mj={class:"dialog"},gj=["disabled"],vj={__name:"StudentForm",props:{student:{type:Object,default:()=>({})},users:{type:Object,required:!0},mode:{type:String,default:"new"}},emits:["close","saved"],setup(t,{emit:e}){const r=t,n=e,{form:s,isSaving:i,appSettings:a,appSettingsLoading:o,appSettingsError:l,periods:c,gradeOptions:u,availableClassServices:f,serviceProviders:h,customServiceProviders:p,userRoles:g,onFileChange:y,removeBipFile:E,removeAtaglanceFile:b,addAdditionalDocument:_,removeAdditionalDocument:v,undoRemoveAdditionalDocument:A,deleteAdditionalDocument:D,providerFieldMap:k,getProviderLabel:T,getProviderUsers:x,handleSubmit:m}=TV(r,n),S=se(!1),I=Se(()=>i.value||S.value),C=Se(()=>S.value?"Loading files...":i.value?"Saving...":r.mode==="edit"?"Save":"Add Student"),F=W=>{S.value=W};return(W,P)=>(L(),B("div",pj,[d("div",mj,[d("header",null,[d("h2",null,Z(t.mode==="edit"?"Edit Student":"Add Student"),1),d("button",{onClick:P[0]||(P[0]=R=>W.$emit("close")),class:"close-btn"},"×")]),d("form",{onSubmit:P[2]||(P[2]=Yr((...R)=>q(m)&&q(m)(...R),["prevent"])),id:"student-form"},[Pe(RV,{form:q(s),mode:t.mode,"grade-options":q(u),"user-roles":q(g)},null,8,["form","mode","grade-options","user-roles"]),Pe(QV,{form:q(s),periods:q(c),"user-roles":q(g),"app-settings":q(a)},null,8,["form","periods","user-roles","app-settings"]),Pe(oH,{form:q(s),"available-class-services":q(f),"app-settings-loading":q(o),"app-settings-error":q(l)},null,8,["form","available-class-services","app-settings-loading","app-settings-error"]),Pe(hH,{form:q(s),"service-providers":q(h),"custom-service-providers":q(p),"provider-field-map":q(k),"get-provider-label":q(T),"get-provider-users":q(x)},null,8,["form","service-providers","custom-service-providers","provider-field-map","get-provider-label","get-provider-users"]),Pe(zH,{form:q(s),student:t.student,mode:t.mode,"on-file-change":q(y),"remove-bip-file":q(E),"remove-ataglance-file":q(b),"add-additional-document":q(_),"remove-additional-document":q(v),"undo-remove-additional-document":q(A),"delete-additional-document":q(D),onLoadingChange:F},null,8,["form","student","mode","on-file-change","remove-bip-file","remove-ataglance-file","add-additional-document","remove-additional-document","undo-remove-additional-document","delete-additional-document"]),Pe(YH,{form:q(s)},null,8,["form"]),Pe(hj,{form:q(s)},null,8,["form"]),d("footer",null,[d("button",{type:"button",onClick:P[1]||(P[1]=R=>W.$emit("close")),class:"btn btn-secondary"}," Cancel "),d("button",{type:"submit",class:"btn btn-primary",disabled:I.value},Z(C.value),9,gj)])],32)])]))}},sx=St(vj,[["__scopeId","data-v-f69b1564"]]),yj={key:0},xj={key:1,class:"loading-dialog"},Ej={__name:"StudentEditDialog",props:{studentId:{type:String,required:!0},users:{type:Object,required:!0}},emits:["close","saved"],setup(t,{emit:e}){const r=t,n=e,{students:s}=Di(),i=Se(()=>{const o=s.value.find(l=>l.id===r.studentId);return console.log("StudentEditDialog - studentId:",r.studentId),console.log("StudentEditDialog - found student:",o),console.log("StudentEditDialog - students count:",s.value.length),o||{}});function a(o){console.log("StudentEditDialog - student saved:",o),n("saved",o)}return(o,l)=>i.value&&Object.keys(i.value).length>0?(L(),B("div",yj,[Pe(sx,{student:i.value,users:t.users,mode:"edit",onClose:l[0]||(l[0]=c=>o.$emit("close")),onSaved:a},null,8,["student","users"])])):(L(),B("div",xj,l[1]||(l[1]=[d("div",{class:"dialog"},[d("header",null,[d("h2",null,"Loading Student Data...")]),d("div",{class:"content"},[d("p",null,"Please wait while we load the student information.")])],-1)])))}},_j=St(Ej,[["__scopeId","data-v-dea0919d"]]),bj={class:"dialog-backdrop"},Sj={class:"dialog"},Aj={class:"button-group"},Tj={key:0,class:"selected-recipients"},wj={class:"recipients-header"},Cj={class:"recipients-list"},Ij={key:0,class:"recipients-note"},kj={key:1,class:"members-list"},Dj={key:0,class:"email"},Pj=["value"],Rj={key:2,class:"update-categories"},Fj={class:"checkbox-group"},Nj={class:"checkbox-item"},Oj={class:"checkbox-item"},Mj={class:"checkbox-item"},Lj={class:"checkbox-item"},Bj={class:"checkbox-item"},Uj={class:"checkbox-item"},$j={class:"checkbox-item"},Vj=["disabled"],Hj={key:0,class:"no-docs"},jj=["disabled"],Gj=["disabled"],Wj={__name:"StudentsEmailDialog",props:{student:{type:Object,required:!0},userMap:{type:Object,required:!0},currentUser:{type:Object,required:!1}},emits:["close"],setup(t,{emit:e}){const r=t,{student:n,userMap:s}=r,i=e,{appSettings:a}=Ms(),o=Se(()=>{var W;return((W=a.value.gmailApi)==null?void 0:W.enabled)??!1}),l=async W=>{try{await navigator.clipboard.writeText(W),u()}catch(P){console.error("Failed to copy:",P),alert("Failed to copy to clipboard. Please copy the email addresses manually.")}},c=se(!1),u=()=>{c.value=!0,setTimeout(()=>{c.value=!1},2e3)},f=se(""),h=se([]),p=se({studentInfo:!1,meetingDates:!1,services:!1,schedule:!1,instructionAccommodations:!1,assessmentAccommodations:!1,documents:!1}),g=Se(()=>{var P,R;if((R=(P=n.app)==null?void 0:P.schedule)!=null&&R.periods){const N=[];return Object.values(n.app.schedule.periods).forEach(M=>{var G;const O=typeof M=="string"?M:M==null?void 0:M.teacherId;O&&N.push(O),(G=M==null?void 0:M.coTeaching)!=null&&G.caseManagerId&&N.push(M.coTeaching.caseManagerId)}),N}const W=n.schedule||{};return Object.values(W).filter(Boolean)}),y=Se(()=>[...new Set(g.value)]),E=Se(()=>{var P;const W=[];(P=n.app)!=null&&P.providers&&Object.entries(n.app.providers).forEach(([R,N])=>{N&&!["caseManagerId"].includes(R)&&W.push(N)});for(const R in n)R.endsWith("_id")&&!["casemanager_id","caseManagerId"].includes(R)&&n[R]&&W.push(n[R]);return[...new Set(W)].filter(R=>!y.value.includes(R))}),b=Se(()=>y.value.map(W=>({id:W,...s[W]||{}})).filter(W=>W&&W.email)),_=Se(()=>E.value.map(W=>({id:W,...s[W]||{}})).filter(W=>W&&W.email)),v=Se(()=>{var R,N,M,O;const W=((N=(R=n.app)==null?void 0:R.studentData)==null?void 0:N.caseManagerId)||((O=(M=n.app)==null?void 0:M.providers)==null?void 0:O.caseManagerId)||n.caseManagerId||n.casemanager_id;if(!W)return null;const P=s[W];return P&&P.email?{id:W,...P}:null}),A=Se(()=>{const W=[...b.value,..._.value];return v.value&&(W.map(R=>R.id).includes(v.value.id)||W.push(v.value)),W}),D=Se(()=>{var W;return(W=r.currentUser)==null?void 0:W.uid});Se(()=>{var P;const W=(P=r.currentUser)==null?void 0:P.role;return["paraeducator","staff_view","teacher"].includes(W)});const k=Se(()=>{var R,N,M,O,G;const W=(R=r.currentUser)==null?void 0:R.uid,P=((M=(N=n.app)==null?void 0:N.studentData)==null?void 0:M.caseManagerId)||((G=(O=n.app)==null?void 0:O.providers)==null?void 0:G.caseManagerId)||n.caseManagerId||n.casemanager_id;return W&&P&&W===P}),T=Se(()=>b.value.filter(W=>W.id!==D.value)),x=Se(()=>_.value.filter(W=>W.id!==D.value)),m=Se(()=>A.value.filter(W=>W.id!==D.value)),S=Se(()=>{var W,P,R,N;return!!((P=(W=n.app)==null?void 0:W.documents)!=null&&P.ataglancePdfUrl||(N=(R=n.app)==null?void 0:R.documents)!=null&&N.bipPdfUrl||n.ataglancePdfUrl||n.ataglance_pdf_url||n.bipPdfUrl||n.bip_pdf_url)}),I=Se(()=>f.value?f.value==="Individual"?h.value.length>0:!0:!1),C=Se(()=>{let W=[];return f.value==="Teachers"?W=T.value:f.value==="TeachersAndService"?W=[...T.value,...x.value]:f.value==="CaseManager"?W=v.value?[v.value]:[]:f.value==="Individual"&&(W=m.value.filter(P=>h.value.includes(P.id))),W.map(P=>P.email).filter(Boolean).join(",")});async function F(){var V,te,oe,ne,le,J,Q,ve;if(!o.value){alert('Gmail API features are disabled. Please use the "Copy Email Addresses" button instead.');return}if(!C.value){alert("No email addresses found for the selected recipients.");return}console.log("🔍 Student data for email:",{student:n,firstName:n.firstName,first_name:n.first_name,lastName:n.lastName,last_name:n.last_name,appStudentData:(V=n.app)==null?void 0:V.studentData});const W=n.firstName||n.first_name||((oe=(te=n.app)==null?void 0:te.studentData)==null?void 0:oe.firstName)||((ne=n.app)==null?void 0:ne.firstName)||"",P=n.lastName||n.last_name||((J=(le=n.app)==null?void 0:le.studentData)==null?void 0:J.lastName)||((Q=n.app)==null?void 0:Q.lastName)||"";console.log("🔍 Extracted names:",{firstName:W,lastName:P});const R=`${W} ${P}`.trim()||"Student",N=(((W==null?void 0:W[0])||"")+((P==null?void 0:P[0])||"")).toUpperCase()||"ST";console.log("🔍 Final values:",{fullName:R,initials:N});const M=Object.values(p.value).some(ee=>ee),O=M?`${N} - Student Update`:`${N} - Student Inquiry`;let G="";if(M){G+=`Hi team,

`,G+=`${R}'s student profile has been updated in the CaseManage app.

`,G+=`Update Summary:
`,p.value.studentInfo&&(G+=`• Student data has been updated
`),p.value.documents&&(G+=`• Documents have been updated and are available
`),p.value.schedule&&(G+=`• Schedule details have been updated
`),p.value.instructionAccommodations&&(G+=`• Instruction accommodations have been updated
`),p.value.assessmentAccommodations&&(G+=`• Assessment accommodations have been updated
`),p.value.services&&(G+=`• Services have been updated
`),p.value.meetingDates&&(G+=`• Meeting dates have been updated
`),G+=`
`,G+=`Please reach out if you have any questions.

`,G+=`To access the updated confidential information and documents:
`,G+=`Log into the CaseManage app: ${window.location.origin}
`,G+=`Navigate to the student's record to view the updates. Authentication is required.

`;const ee=v.value&&(`${v.value.firstName||""} ${v.value.lastName||""}`.trim()||v.value.displayName||v.value.email)||"Case Manager";ee&&ee!=="Case Manager"?G+=`For questions please contact the Case Manager (${ee}) directly.
`:G+=`For questions please contact the Case Manager directly.
`}else G=`Hi team,

I have a question regarding ${R}.

Please reach out if you need any additional information.

Thank you!`;console.log("🔍 Email composition:",{subject:O,body:G});const z=(ve=r.currentUser)==null?void 0:ve.email;if(!z){console.error("❌ No user email found in props.currentUser:",r.currentUser),alert("Unable to send email: User email not found. Please contact your administrator.");return}console.log("🔍 User work email:",z);const j=`https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(C.value)}&su=${encodeURIComponent(O)}&body=${encodeURIComponent(G)}`;if(!confirm(`IMPORTANT: Security Check

This email MUST be sent from your school account: ${z}

Please confirm:
1. You are signed into Gmail with ${z}
2. You are NOT signed into any other Gmail accounts

Click OK only if you are using your school account.
Click Cancel to open Gmail and switch accounts.`)){window.open("https://mail.google.com","_blank","noopener");return}window.open(j,"_blank","noopener"),console.log("✅ Gmail compose window opened"),i("close")}return(W,P)=>(L(),B("div",bj,[d("div",Sj,[d("header",null,[d("h2",null,"Email about "+Z(q(n).firstName||q(n).first_name)+" "+Z(q(n).lastName||q(n).last_name),1),d("button",{onClick:P[0]||(P[0]=R=>W.$emit("close")),title:"Close"},"×")]),d("main",null,[d("form",{onSubmit:P[14]||(P[14]=Yr(()=>{},["prevent"]))},[d("div",Aj,[v.value?(L(),B("button",{key:0,type:"button",class:Xe(["option-button",{active:f.value==="CaseManager"}]),onClick:P[1]||(P[1]=R=>f.value="CaseManager")}," Case Manager ",2)):_e("",!0),d("button",{type:"button",class:Xe(["option-button",{active:f.value==="Teachers"}]),onClick:P[2]||(P[2]=R=>f.value="Teachers")}," Teachers ",2),d("button",{type:"button",class:Xe(["option-button",{active:f.value==="TeachersAndService"}]),onClick:P[3]||(P[3]=R=>f.value="TeachersAndService")}," Teachers and service providers ",2),d("button",{type:"button",class:Xe(["option-button",{active:f.value==="Individual"}]),onClick:P[4]||(P[4]=R=>f.value="Individual")}," Individual member of the IEP team ",2)]),C.value?(L(),B("div",Tj,[d("div",wj,[P[17]||(P[17]=d("h4",null,"Selected Recipients:",-1)),o.value?_e("",!0):(L(),B("button",{key:0,type:"button",class:Xe(["copy-button",{copied:c.value}]),onClick:P[5]||(P[5]=R=>l(C.value))},Z(c.value?"Copied!":"Copy All"),3))]),d("div",Cj,Z(C.value),1),o.value?_e("",!0):(L(),B("div",Ij,P[18]||(P[18]=[d("p",null,"Note: Gmail API features are not enabled. You can copy these email addresses to use in your email client.",-1)])))])):_e("",!0),f.value==="Individual"?(L(),B("div",kj,[P[19]||(P[19]=d("div",null,"Select members:",-1)),(L(!0),B(De,null,$e(m.value,R=>(L(),B("div",{key:R.id},[d("label",null,[d("span",null,[we(Z(R.name||R.displayName||R.email||R.id)+" ",1),R.email?(L(),B("span",Dj,"("+Z(R.email)+")",1)):_e("",!0)]),Ne(d("input",{type:"checkbox",value:R.id,"onUpdate:modelValue":P[6]||(P[6]=N=>h.value=N)},null,8,Pj),[[bt,h.value]])])]))),128))])):_e("",!0),k.value?(L(),B("div",Rj,[P[27]||(P[27]=d("h4",null,"Select what has been updated:",-1)),d("div",Fj,[d("div",Nj,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":P[7]||(P[7]=R=>p.value.studentInfo=R)},null,512),[[bt,p.value.studentInfo]]),P[20]||(P[20]=d("label",null,"Student information",-1))]),d("div",Oj,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":P[8]||(P[8]=R=>p.value.meetingDates=R)},null,512),[[bt,p.value.meetingDates]]),P[21]||(P[21]=d("label",null,"Meeting dates",-1))]),d("div",Mj,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":P[9]||(P[9]=R=>p.value.services=R)},null,512),[[bt,p.value.services]]),P[22]||(P[22]=d("label",null,"Services",-1))]),d("div",Lj,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":P[10]||(P[10]=R=>p.value.schedule=R)},null,512),[[bt,p.value.schedule]]),P[23]||(P[23]=d("label",null,"Schedule",-1))]),d("div",Bj,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":P[11]||(P[11]=R=>p.value.instructionAccommodations=R)},null,512),[[bt,p.value.instructionAccommodations]]),P[24]||(P[24]=d("label",null,"Instruction accommodations",-1))]),d("div",Uj,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":P[12]||(P[12]=R=>p.value.assessmentAccommodations=R)},null,512),[[bt,p.value.assessmentAccommodations]]),P[25]||(P[25]=d("label",null,"Assessment accommodations",-1))]),d("div",$j,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":P[13]||(P[13]=R=>p.value.documents=R),disabled:!S.value},null,8,Vj),[[bt,p.value.documents]]),d("label",null,[P[26]||(P[26]=we(" Documents ")),S.value?_e("",!0):(L(),B("span",Hj,"(No docs available)"))])])])])):_e("",!0)],32)]),d("footer",null,[d("button",{onClick:P[15]||(P[15]=R=>W.$emit("close"))},"Cancel"),o.value?(L(),B("button",{key:0,disabled:!I.value,onClick:F},"Send Email",8,jj)):(L(),B("button",{key:1,disabled:!I.value,onClick:P[16]||(P[16]=R=>l(C.value))},Z(c.value?"Copied!":"Copy Email Addresses"),9,Gj))])])]))}},zj=St(Wj,[["__scopeId","data-v-d498c3e5"]]),Kj={class:"dialog-backdrop"},qj={class:"dialog"},Xj={class:"field-groups"},Yj={class:"field-group"},Qj={class:"field-group"},Jj={class:"field-group"},Zj={class:"field-group"},eG={class:"field-group"},tG={class:"field-group"},rG=["disabled"],nG={__name:"ExportDialog",props:{students:{type:Array,default:()=>[]},userMap:{type:Object,default:()=>({})}},emits:["close"],setup(t,{emit:e}){const r=t,n=e,s=on(),i=Xy(),a=se({studentData:{firstName:!0,lastName:!0,grade:!0,plan:!0,caseManagerId:!0},dates:{reviewDate:!0,reevalDate:!0,meetingDate:!0},providers:{all:!0},accommodations:{instruction:!0,assessment:!0},schedule:{periods:!0,classServices:!0},documents:{ataglancePdfUrl:!0,bipPdfUrl:!0}}),o=["speechId","otId","mhId","ptId","scId","trId","audId","viId","atId","dhhId","omId","bisId","hnId","swId"],l=Se(()=>Object.values(a.value).some(E=>Object.values(E).some(b=>b)));function c(E){if(!E||!r.userMap[E])return"";const b=r.userMap[E];return b.name||b.email||""}function u(E){const b=i.userPermissions||[];return Array.isArray(b)&&b.includes(E)}function f(){Object.keys(a.value).forEach(E=>{Object.keys(a.value[E]).forEach(b=>{a.value[E][b]=!0})})}function h(){Object.keys(a.value).forEach(E=>{Object.keys(a.value[E]).forEach(b=>{a.value[E][b]=!1})})}function p(E){var A,D,k,T,x,m,S,I,C,F,W,P,R,N,M,O,G,z,j,H,V,te,oe,ne,le,J,Q,ve,ee,K,Y,pe;const b=s.currentUser;if((b==null?void 0:b.role)==="admin"||(b==null?void 0:b.role)==="administrator"||(b==null?void 0:b.role)==="staff_view"||(b==null?void 0:b.role)==="sped_chair"||(b==null?void 0:b.role)==="administrator_504_CM"||(b==null?void 0:b.role)==="admin_504")return g(E);const v={};return a.value.studentData.firstName&&(v.firstName=(D=(A=E.app)==null?void 0:A.studentData)==null?void 0:D.firstName),a.value.studentData.lastName&&(v.lastName=(T=(k=E.app)==null?void 0:k.studentData)==null?void 0:T.lastName),a.value.studentData.grade&&(v.grade=(m=(x=E.app)==null?void 0:x.studentData)==null?void 0:m.grade),a.value.studentData.plan&&(v.plan=(I=(S=E.app)==null?void 0:S.studentData)==null?void 0:I.plan),a.value.studentData.caseManagerId&&(v.caseManagerId=(F=(C=E.app)==null?void 0:C.studentData)==null?void 0:F.caseManagerId),u("view_student_dates")&&(a.value.dates.reviewDate&&(v.reviewDate=(P=(W=E.app)==null?void 0:W.dates)==null?void 0:P.reviewDate),a.value.dates.reevalDate&&(v.reevalDate=(N=(R=E.app)==null?void 0:R.dates)==null?void 0:N.reevalDate),a.value.dates.meetingDate&&(v.meetingDate=(O=(M=E.app)==null?void 0:M.dates)==null?void 0:O.meetingDate)),(u("view_service_providers")||((z=(G=E.app)==null?void 0:G.studentData)==null?void 0:z.caseManagerId)===(b==null?void 0:b.uid)||o.some(xe=>{var ae,de;return((de=(ae=E.app)==null?void 0:ae.providers)==null?void 0:de[xe])===(b==null?void 0:b.uid)}))&&a.value.providers.all&&o.forEach(xe=>{var ae,de;v[xe]=(de=(ae=E.app)==null?void 0:ae.providers)==null?void 0:de[xe]}),u("view_accommodations")&&(a.value.accommodations.instruction&&(v.instruction=(H=(j=E.app)==null?void 0:j.accommodations)==null?void 0:H.instruction),a.value.accommodations.assessment&&(v.assessment=(te=(V=E.app)==null?void 0:V.accommodations)==null?void 0:te.assessment)),(u("view_schedule")||Object.values(((ne=(oe=E.app)==null?void 0:oe.schedule)==null?void 0:ne.periods)||{}).includes(b==null?void 0:b.uid))&&(a.value.schedule.periods&&(v.schedule=(J=(le=E.app)==null?void 0:le.schedule)==null?void 0:J.periods),a.value.schedule.classServices&&(v.classServices=(ve=(Q=E.app)==null?void 0:Q.schedule)==null?void 0:ve.classServices)),u("view_documents")&&(a.value.documents.ataglancePdfUrl&&(v.ataglancePdfUrl=(K=(ee=E.app)==null?void 0:ee.documents)==null?void 0:K.ataglancePdfUrl),a.value.documents.bipPdfUrl&&(v.bipPdfUrl=(pe=(Y=E.app)==null?void 0:Y.documents)==null?void 0:pe.bipPdfUrl)),v}function g(E){var _,v,A,D,k,T,x,m,S,I,C,F,W,P,R,N,M,O,G,z,j,H,V,te,oe,ne,le,J;const b={};return a.value.studentData.firstName&&(b.firstName=(v=(_=E.app)==null?void 0:_.studentData)==null?void 0:v.firstName),a.value.studentData.lastName&&(b.lastName=(D=(A=E.app)==null?void 0:A.studentData)==null?void 0:D.lastName),a.value.studentData.grade&&(b.grade=(T=(k=E.app)==null?void 0:k.studentData)==null?void 0:T.grade),a.value.studentData.plan&&(b.plan=(m=(x=E.app)==null?void 0:x.studentData)==null?void 0:m.plan),a.value.studentData.caseManagerId&&(b.caseManagerId=(I=(S=E.app)==null?void 0:S.studentData)==null?void 0:I.caseManagerId),a.value.dates.reviewDate&&(b.reviewDate=(F=(C=E.app)==null?void 0:C.dates)==null?void 0:F.reviewDate),a.value.dates.reevalDate&&(b.reevalDate=(P=(W=E.app)==null?void 0:W.dates)==null?void 0:P.reevalDate),a.value.dates.meetingDate&&(b.meetingDate=(N=(R=E.app)==null?void 0:R.dates)==null?void 0:N.meetingDate),a.value.providers.all&&o.forEach(Q=>{var ve,ee;b[Q]=(ee=(ve=E.app)==null?void 0:ve.providers)==null?void 0:ee[Q]}),a.value.accommodations.instruction&&(b.instruction=(O=(M=E.app)==null?void 0:M.accommodations)==null?void 0:O.instruction),a.value.accommodations.assessment&&(b.assessment=(z=(G=E.app)==null?void 0:G.accommodations)==null?void 0:z.assessment),a.value.schedule.periods&&(b.schedule=(H=(j=E.app)==null?void 0:j.schedule)==null?void 0:H.periods),a.value.schedule.classServices&&(b.classServices=(te=(V=E.app)==null?void 0:V.schedule)==null?void 0:te.classServices),a.value.documents.ataglancePdfUrl&&(b.ataglancePdfUrl=(ne=(oe=E.app)==null?void 0:oe.documents)==null?void 0:ne.ataglancePdfUrl),a.value.documents.bipPdfUrl&&(b.bipPdfUrl=(J=(le=E.app)==null?void 0:le.documents)==null?void 0:J.bipPdfUrl),b}function y(){const E=r.students.map(x=>p(x)),b=[],_=[],v={firstName:"First Name",lastName:"Last Name",grade:"Grade",plan:"Plan Type",caseManagerId:"Case Manager",reviewDate:"Plan Review",reevalDate:"Reevaluation",meetingDate:"Meeting Date",speechId:"Speech",otId:"OT",mhId:"Mental Health",ptId:"PT",scId:"SC",trId:"TR",audId:"Audiology",viId:"Vision",atId:"AT",dhhId:"DHH",omId:"O&M",bisId:"BIS",hnId:"HN",swId:"SW",instruction:"Instructional Accommodation",assessment:"Assessment Accommodations",schedule:"Schedule",classServices:"Class Services",ataglancePdfUrl:"At-A-Glance",bipPdfUrl:"BIP"};Object.entries(a.value).forEach(([x,m])=>{Object.entries(m).forEach(([S,I])=>{I&&(S==="all"?o.forEach(C=>{b.push(v[C])}):b.push(v[S]))})}),E.forEach(x=>{const m=[];Object.entries(a.value).forEach(([S,I])=>{Object.entries(I).forEach(([C,F])=>{if(F)if(C==="all")o.forEach(W=>{const P=x[W]||"";m.push(P?c(P):"")});else{let W=x[C]||"";C.endsWith("Id")?W=W?c(W):"":C==="classServices"?W=Array.isArray(x.classServices)?x.classServices.join(", "):"":C==="schedule"&&(W=x.schedule?Object.entries(x.schedule).map(([P,R])=>`${P}: ${c(R)}`).join("; "):""),m.push(W)}})}),_.push(m)});const A=[b.join(","),..._.map(x=>x.map(m=>`"${String(m).replace(/"/g,'""')}"`).join(","))].join(`
`),D=new Blob([A],{type:"text/csv"}),k=window.URL.createObjectURL(D),T=document.createElement("a");T.href=k,T.download="students-export.csv",T.click(),window.URL.revokeObjectURL(k),n("close")}return(E,b)=>(L(),B("div",Kj,[d("div",qj,[d("header",null,[b[17]||(b[17]=d("h2",null,"Export Students",-1)),d("button",{onClick:b[0]||(b[0]=_=>E.$emit("close")),class:"close-btn"},"×")]),d("main",null,[d("p",null,"Export "+Z(t.students.length)+" students",1),d("div",Xj,[d("div",Yj,[b[23]||(b[23]=d("h4",null,"Student Info",-1)),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[1]||(b[1]=_=>a.value.studentData.firstName=_)},null,512),[[bt,a.value.studentData.firstName]]),b[18]||(b[18]=we(" First Name "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[2]||(b[2]=_=>a.value.studentData.lastName=_)},null,512),[[bt,a.value.studentData.lastName]]),b[19]||(b[19]=we(" Last Name "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[3]||(b[3]=_=>a.value.studentData.grade=_)},null,512),[[bt,a.value.studentData.grade]]),b[20]||(b[20]=we(" Grade "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[4]||(b[4]=_=>a.value.studentData.plan=_)},null,512),[[bt,a.value.studentData.plan]]),b[21]||(b[21]=we(" Plan Type "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[5]||(b[5]=_=>a.value.studentData.caseManagerId=_)},null,512),[[bt,a.value.studentData.caseManagerId]]),b[22]||(b[22]=we(" Case Manager "))])]),d("div",Qj,[b[27]||(b[27]=d("h4",null,"Important Dates",-1)),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[6]||(b[6]=_=>a.value.dates.reviewDate=_)},null,512),[[bt,a.value.dates.reviewDate]]),b[24]||(b[24]=we(" Plan Review "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[7]||(b[7]=_=>a.value.dates.reevalDate=_)},null,512),[[bt,a.value.dates.reevalDate]]),b[25]||(b[25]=we(" Reevaluation "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[8]||(b[8]=_=>a.value.dates.meetingDate=_)},null,512),[[bt,a.value.dates.meetingDate]]),b[26]||(b[26]=we(" Meeting Date "))])]),d("div",Jj,[b[29]||(b[29]=d("h4",null,"Related Services",-1)),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[9]||(b[9]=_=>a.value.providers.all=_)},null,512),[[bt,a.value.providers.all]]),b[28]||(b[28]=we(" All Service Providers "))])]),d("div",Zj,[b[32]||(b[32]=d("h4",null,"Accommodations",-1)),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[10]||(b[10]=_=>a.value.accommodations.instruction=_)},null,512),[[bt,a.value.accommodations.instruction]]),b[30]||(b[30]=we(" Instructional "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[11]||(b[11]=_=>a.value.accommodations.assessment=_)},null,512),[[bt,a.value.accommodations.assessment]]),b[31]||(b[31]=we(" Assessment "))])]),d("div",eG,[b[35]||(b[35]=d("h4",null,"Schedule & Services",-1)),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[12]||(b[12]=_=>a.value.schedule.periods=_)},null,512),[[bt,a.value.schedule.periods]]),b[33]||(b[33]=we(" Class Schedule "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[13]||(b[13]=_=>a.value.schedule.classServices=_)},null,512),[[bt,a.value.schedule.classServices]]),b[34]||(b[34]=we(" Class Services "))])]),d("div",tG,[b[38]||(b[38]=d("h4",null,"Documents",-1)),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[14]||(b[14]=_=>a.value.documents.ataglancePdfUrl=_)},null,512),[[bt,a.value.documents.ataglancePdfUrl]]),b[36]||(b[36]=we(" At-A-Glance "))]),d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":b[15]||(b[15]=_=>a.value.documents.bipPdfUrl=_)},null,512),[[bt,a.value.documents.bipPdfUrl]]),b[37]||(b[37]=we(" BIP "))])])]),d("div",{class:"quick-select"},[d("button",{onClick:f},"Select All"),d("button",{onClick:h},"Deselect All")])]),d("footer",null,[d("button",{onClick:b[16]||(b[16]=_=>E.$emit("close")),class:"btn-secondary"},"Cancel"),d("button",{onClick:y,class:"btn-primary",disabled:!l.value},"Export",8,rG)])])]))}},sG=St(nG,[["__scopeId","data-v-08e1f384"]]),aG={class:"modal-body"},iG={class:"student-info"},oG={class:"case-manager-info"},lG={class:"form-group"},cG={key:0,class:"no-forms-message"},uG={key:1,class:"form-selection"},dG=["id","value"],fG=["for"],hG={class:"form-title"},pG={class:"form-details"},mG={key:0,class:"form-description"},gG={class:"form-date"},vG={key:0,class:"form-group"},yG={class:"teacher-selection-header"},xG={class:"teacher-actions"},EG=["title"],_G={class:"teacher-selection"},bG={key:0,class:"no-teachers-message"},SG={key:1,class:"teacher-checkboxes"},AG=["id","value"],TG=["for"],wG={class:"teacher-email"},CG={key:0,class:"selected-emails-preview"},IG={class:"email-preview"},kG={key:1,class:"form-group"},DG={class:"duplication-options"},PG={class:"option-item"},RG={key:2,class:"form-group"},FG={class:"send-history"},NG={class:"history-info"},OG={class:"history-date"},MG={class:"history-teachers"},LG={key:0,class:"history-success"},BG={key:1,class:"history-failed"},UG={key:0,class:"history-links"},$G=["href"],VG=["href"],HG={key:0,class:"resource-links"},jG={class:"resource-section"},GG={class:"resource-note"},WG={class:"success-details"},zG={key:0,class:"student-info"},KG={class:"form-link"},qG=["href"],XG={class:"modal-footer"},YG=["disabled"],QG={key:0},JG={key:1},ZG={__name:"TeacherFeedbackDialog",props:{student:{type:Object,required:!0},currentUser:{type:Object,required:!0}},emits:["close","form-sent"],setup(t,{emit:e}){const r=t,n=e,{activeForms:s}=Zy(),{userList:i,fetchUsers:a}=ba(),o=se(!1),l=se(""),c=se(""),u=se(null),f=se(!1),h=se("Copy teacher emails to clipboard"),p=se(""),g=se([]),y=Se(()=>s.value||[]),E=Se(()=>{var I;return p.value&&((I=y.value)==null?void 0:I.find(C=>C.id===p.value))||null}),b=Se(()=>{if(!p.value||!r.student)return[];try{return JSON.parse(localStorage.getItem("casemanage_sent_forms")||"[]").filter(C=>C&&C.studentId===r.student.id&&C.formId===p.value).sort((C,F)=>new Date(F.sentAt)-new Date(C.sentAt))||[]}catch(I){return console.warn("Error parsing send history:",I),[]}}),_=Se(()=>{var C,F,W;if(!r.student||!i.value)return[];const I=new Set;if((F=(C=r.student.app)==null?void 0:C.schedule)!=null&&F.periods)Object.values(r.student.app.schedule.periods).forEach(P=>{var N;const R=typeof P=="string"?P:P==null?void 0:P.teacherId;R&&I.add(R),(N=P==null?void 0:P.coTeaching)!=null&&N.caseManagerId&&I.add(P.coTeaching.caseManagerId)});else{const P=r.student.schedule||{};Object.values(P).forEach(R=>{R&&I.add(R)})}return(W=r.student.aeries)!=null&&W.schedule&&Object.values(r.student.aeries.schedule).forEach(P=>{P!=null&&P.teacherId&&I.add(P.teacherId)}),Array.from(I).map(P=>(i.value||[]).find(R=>R&&R.id===P)).filter(Boolean).filter(P=>P&&P.role==="teacher")}),v=Se(()=>p.value&&(g.value||[]).length>0),A=I=>I?(I.seconds?new Date(I.seconds*1e3):new Date(I)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",D=I=>I?(I.seconds?new Date(I.seconds*1e3):new Date(I)).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):"",k=()=>{g.value=[..._.value]},T=async()=>{const I=g.value.map(C=>C.email).join(", ");try{await navigator.clipboard.writeText(I),h.value="✅ Copied!",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}catch(C){console.error("Failed to copy emails:",C);const F=document.createElement("textarea");F.value=I,document.body.appendChild(F),F.select();try{document.execCommand("copy"),h.value="✅ Copied!",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}catch{h.value="❌ Copy failed",setTimeout(()=>{h.value="Copy teacher emails to clipboard"},2e3)}document.body.removeChild(F)}},x=async()=>{var I,C,F,W;if(v.value)try{o.value=!0,l.value="",u.value=null;const P=E.value,R=g.value.map(oe=>oe.email),N=g.value.map(oe=>oe.name||oe.email).join(", "),M=r.student.firstName||r.student.first_name||((C=(I=r.student.app)==null?void 0:I.studentData)==null?void 0:C.firstName)||"",O=r.student.lastName||r.student.last_name||((W=(F=r.student.app)==null?void 0:F.studentData)==null?void 0:W.lastName)||"",G=`${M} ${O}`.trim(),z=(((M==null?void 0:M[0])||"")+((O==null?void 0:O[0])||"")).toUpperCase()||"ST";let j=P.formUrl;j.includes("/edit")&&(j=j.replace("/edit","/copy"));const H=new URLSearchParams;z&&z!=="ST"&&H.append("title",`${z} - ${P.title}`),G&&H.append("student",G),R.length>0&&H.append("responders",R.join(", "));const V=j.includes("?")?"&":"?",te=H.toString()?`${j}${V}${H.toString()}`:j;window.open(te,"_blank","noopener"),l.value=`Form opened for ${N}. Student: ${z} - ${G}`,c.value="success",u.value={message:`Form opened successfully for ${z} - ${G}`,sent:R.length,failed:0,formUrl:te,studentInitials:z,studentName:G},m(P,g.value,te)}catch(P){console.error("Error opening form:",P),l.value="Failed to open form. Please try again.",c.value="error"}finally{o.value=!1}},m=(I,C,F=null)=>{const W=JSON.parse(localStorage.getItem("casemanage_sent_forms")||"[]"),P={id:`${I.id}_${r.student.id}_${Date.now()}`,formId:I.id,formTitle:I.title,formUrl:F||I.formUrl,sheetUrl:null,studentId:r.student.id,studentName:`${r.student.firstName} ${r.student.lastName}`,caseManagerId:r.currentUser.uid,caseManagerName:r.currentUser.name||r.currentUser.email,teachers:C.map(N=>({id:N.id,name:N.name,email:N.email})),sentAt:new Date().toISOString(),method:"gmail"},R=W.findIndex(N=>N.id===P.id);R!==-1?W[R]=P:W.push(P),localStorage.setItem("casemanage_sent_forms",JSON.stringify(W))},S=()=>{n("close")};return Gt(()=>{p.value="",g.value=[],l.value="",a()}),Ht(_,I=>{I&&I.length>0&&g.value.length===0&&(g.value=[...I])},{immediate:!0}),(I,C)=>{var F,W,P,R;return L(),B("div",{class:"modal-overlay",onClick:S},[d("div",{class:"modal-content",onClick:C[3]||(C[3]=Yr(()=>{},["stop"]))},[d("div",{class:"modal-header"},[C[4]||(C[4]=d("h3",null,"Send Teacher Feedback Form",-1)),d("button",{onClick:S,class:"close-btn"},"×")]),d("div",aG,[d("div",iG,[d("h4",null,Z(t.student.firstName)+" "+Z(t.student.lastName)+" (Grade "+Z(t.student.grade)+")",1),d("p",oG,"Case Manager: "+Z(((F=t.currentUser)==null?void 0:F.name)||((W=t.currentUser)==null?void 0:W.email)),1)]),d("div",lG,[C[6]||(C[6]=d("label",null,"Select Feedback Form to Send:",-1)),y.value.length===0?(L(),B("div",cG,C[5]||(C[5]=[d("p",null,"No feedback forms available. Forms must be created in the Admin Panel first.",-1),d("p",null,[d("em",null,"Contact your administrator to create feedback forms.")],-1)]))):(L(),B("div",uG,[(L(!0),B(De,null,$e(y.value,N=>(L(),B("div",{key:N.id,class:"form-option"},[Ne(d("input",{type:"radio",id:N.id,value:N.id,"onUpdate:modelValue":C[0]||(C[0]=M=>p.value=M)},null,8,dG),[[Ss,p.value]]),d("label",{for:N.id,class:"form-option-label"},[d("div",hG,Z(N.title),1),d("div",pG,[N.description?(L(),B("span",mG,Z(N.description),1)):_e("",!0),d("span",gG,"Created: "+Z(A(N.createdAt)),1)])],8,fG)]))),128))]))]),p.value?(L(),B("div",vG,[d("div",yG,[C[7]||(C[7]=d("label",null,"Select Teachers to Send Form To:",-1)),d("div",xG,[_.value.length>0?(L(),B("button",{key:0,onClick:k,type:"button",class:"btn-select-all"}," Select All ")):_e("",!0),g.value.length>0?(L(),B("button",{key:1,onClick:T,type:"button",class:"btn-copy-emails",title:h.value}," 📋 Copy Emails ",8,EG)):_e("",!0)])]),d("div",_G,[_.value.length===0?(L(),B("div",bG,C[8]||(C[8]=[d("p",null,"No teachers found for this student's schedule.",-1)]))):(L(),B("div",SG,[(L(!0),B(De,null,$e(_.value,N=>(L(),B("div",{key:N.id,class:"checkbox-item"},[Ne(d("input",{type:"checkbox",id:`teacher-${N.id}`,value:N,"onUpdate:modelValue":C[1]||(C[1]=M=>g.value=M)},null,8,AG),[[bt,g.value]]),d("label",{for:`teacher-${N.id}`},[we(Z(N.name||N.email)+" ",1),d("span",wG,"("+Z(N.email)+")",1)],8,TG)]))),128))]))]),g.value.length>0?(L(),B("div",CG,[C[9]||(C[9]=d("p",null,[d("strong",null,"Selected teacher emails:")],-1)),d("div",IG,Z(g.value.map(N=>N.email).join(", ")),1)])):_e("",!0)])):_e("",!0),p.value&&g.value.length>0&&((P=E.value)!=null&&P.sheetTemplateUrl)?(L(),B("div",kG,[C[11]||(C[11]=d("label",null,"Response Collection:",-1)),d("div",DG,[d("div",PG,[Ne(d("input",{type:"checkbox",id:"duplicate-sheet","onUpdate:modelValue":C[2]||(C[2]=N=>f.value=N)},null,512),[[bt,f.value]]),C[10]||(C[10]=d("label",{for:"duplicate-sheet"},[d("strong",null,"Duplicate custom sheet"),d("span",{class:"option-description"},"Create a copy of the response template sheet in your Google Drive")],-1))])])])):_e("",!0),p.value&&b.value.length>0?(L(),B("div",RG,[C[12]||(C[12]=d("label",null,"Previous Sends for this Student:",-1)),d("div",FG,[(L(!0),B(De,null,$e(b.value,N=>(L(),B("div",{key:N.id,class:"history-item"},[d("div",NG,[d("span",OG,Z(D(N.sentAt)),1),d("span",MG,Z((N.teacherEmails||[]).length)+" teacher"+Z((N.teacherEmails||[]).length===1?"":"s"),1),N.successful>0?(L(),B("span",LG,"✅ "+Z(N.successful)+" sent",1)):_e("",!0),N.failed>0?(L(),B("span",BG,"❌ "+Z(N.failed)+" failed",1)):_e("",!0)]),N.formUrl||N.sheetUrl?(L(),B("div",UG,[N.formUrl?(L(),B("a",{key:0,href:N.formUrl,target:"_blank",class:"history-link"},"📝 Form",8,$G)):_e("",!0),N.sheetUrl?(L(),B("a",{key:1,href:N.sheetUrl,target:"_blank",class:"history-link"},"📊 Sheet",8,VG)):_e("",!0)])):_e("",!0)]))),128))])])):_e("",!0),l.value?(L(),B("div",{key:3,class:Xe(`status-message ${c.value}`)},[we(Z(l.value)+" ",1),c.value==="success"&&u.value?(L(),B("div",HG,[d("div",jG,[C[16]||(C[16]=d("h5",null,"✅ Form Opened Successfully!",-1)),d("p",GG,[d("strong",null,Z(u.value.message),1)]),d("div",WG,[d("p",null,[C[13]||(C[13]=we(" 📝 Form opened for ")),d("strong",null,Z(u.value.sent),1),we(" teacher"+Z(u.value.sent===1?"":"s"),1)]),u.value.studentInitials?(L(),B("p",zG,[C[14]||(C[14]=we(" 👤 Student: ")),d("strong",null,Z(u.value.studentInitials),1),we(" - "+Z(u.value.studentName),1)])):_e("",!0),d("p",KG,[C[15]||(C[15]=we(" 🔗 Form Link: ")),d("a",{href:u.value.formUrl,target:"_blank"},Z((R=E.value)==null?void 0:R.title),9,qG)])])])])):_e("",!0)],2)):_e("",!0)]),d("div",XG,[d("button",{onClick:S,class:"secondary-btn"},"Cancel"),d("button",{onClick:x,class:"primary-btn",disabled:!v.value||o.value},[o.value?(L(),B("span",QG,"Creating Form...")):(L(),B("span",JG,"📝 Create New Form"))],8,YG)])])])}}},eW=St(ZG,[["__scopeId","data-v-f8c1ccfe"]]),tW={class:"students-view"},rW={class:"page-header"},nW={class:"header-left"},sW={class:"search-container"},aW={class:"header-controls"},iW={class:"filter-group sort-group"},oW={key:0,class:"filter-group"},lW={class:"radio-group"},cW=["title"],uW=["value"],dW={class:"filter-group"},fW={class:"radio-group"},hW=["checked"],pW=["checked","disabled"],mW={key:0,class:"disabled-icon"},gW=["checked"],vW={key:0,class:"selected-radio-display"},yW={key:1,class:"filters-panel"},xW={class:"filters-content"},EW={class:"filter-group"},_W=["value"],bW={class:"filter-group"},SW=["value"],AW={class:"filter-group"},TW=["value"],wW={class:"filter-group"},CW={class:"filter-group"},IW=["value"],kW={class:"content"},DW={class:"print-user-name"},PW={key:0},RW={key:1,class:"view-container"},FW={key:0,class:"group-section"},NW={class:"group-header"},OW={key:2,class:"view-section"},MW={__name:"StudentsView",setup(t){var de;const e=on(),r=eU(),n=rU(r),s=dU(r,n);console.log("🔍 STUDENTS VIEW DEBUG: Setting up watcher, currentRole:",(de=s.currentRole)==null?void 0:de.value),Ht(()=>{var Ee;return(Ee=s.currentRole)==null?void 0:Ee.value},Ee=>{console.log("🔍 STUDENTS VIEW DEBUG: Role changed to:",Ee),Ee==="paraeducator"&&(console.log("🔍 STUDENTS VIEW DEBUG: Paraeducator role detected, setting up visibleStudents watcher"),Ht(()=>{var he;return(he=s.visibleStudents)==null?void 0:he.value},he=>{console.log("🔍 STUDENTS VIEW: Paraeducator visibleStudents changed:",{count:(he==null?void 0:he.length)||0,studentNames:(he==null?void 0:he.map(Ce=>{var Te,Ge,Ie,Ve;return`${((Ge=(Te=Ce.app)==null?void 0:Te.studentData)==null?void 0:Ge.firstName)||"Unknown"} ${((Ve=(Ie=Ce.app)==null?void 0:Ie.studentData)==null?void 0:Ve.lastName)||"Unknown"}`}))||[]})},{immediate:!0}))},{immediate:!0});const i=pU(r),{students:a,userMapObj:o,caseManagers:l,caseManagersWithCounts:c,teacherList:u,userRoles:f,aideAssignment:h,paraeducators:p,serviceProviders:g,currentUser:y,isAdmin:E,showProviderView:b,getStudentById:_}=r,{showFilters:v,currentFilters:A,toggleFilters:D,applyFilters:k,debouncedApplyFilters:T}=n,{visibleStudents:x,canEditAllStudents:m,canEditOwnStudents:S,canViewAllStudents:I,canAccessTesting:C,canAccessTestingPartial:F,canAccessFilters:W,isClassViewDisabled:P,setViewMode:R,providerViewOptions:N}=s,M=hU(r,n,Se(()=>s.visibleStudents.value)),{currentViewMode:O,studentsByClass:G,directAssignmentStudents:z,testingViewStudents:j}=M,{editingStudentId:H,emailingStudentId:V,showExport:te,showAddStudent:oe,showFeedbackDialog:ne,feedbackStudentId:le,editStudent:J,emailStudent:Q,handleTeacherFeedback:ve,handleFormSent:ee,handleStudentAdded:K,handleStudentSaved:Y,handleNavAction:pe}=i,xe=Ee=>{var Ce;const he=(Ce=y.value)==null?void 0:Ce.role;switch(Ee){case"all_iep":return"CM+SP";case"case_manager":return"Case Manager";case"service_provider":return"Service Provider";case"teacher":return"Service Provider";case"iep_504_all":return"All IEP/504 students";case"all":return he==="sped_chair"?"All students (with IEPs)":"All students";default:return"All students"}};Se(()=>{var he;return N!=null&&N.value?N.value:((he=y.value)==null?void 0:he.role)==="case_manager"?[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}]:[{value:"all",label:"All"},{value:"case_manager",label:"CM"},{value:"service_provider",label:"SP"}]});const ae=Se(()=>{var he;const Ee=[];if(A.providerView&&((he=N==null?void 0:N.value)!=null&&he.length)){const Ce=xe(A.providerView);Ce&&Ee.push(Ce)}if(A.viewMode){let Ce="";switch(A.viewMode){case"list":Ce="List view";break;case"class":Ce="Class-period view";break;case"testing":Ce="Separate Setting For Testing";break}Ce&&Ee.push(Ce)}return Ee.length>0?Ee.join(" | "):""});return(Ee,he)=>{var Ce,Te,Ge,Ie,Ve,Ue,ze,Ke;return L(),B("div",tW,[Pe(kU,{"current-user":q(y),"is-admin":q(E),onAction:q(pe)},null,8,["current-user","is-admin","onAction"]),d("div",rW,[d("div",nW,[he[25]||(he[25]=d("h1",null,"Student Management",-1)),d("div",sW,[Ne(d("input",{type:"text","onUpdate:modelValue":he[0]||(he[0]=ue=>q(A).search=ue),onInput:he[1]||(he[1]=(...ue)=>q(T)&&q(T)(...ue)),placeholder:"Search students...",class:"search-input"},null,544),[[ft,q(A).search]])])]),d("div",aW,[d("div",iW,[Pe(q(K7),{size:16,class:"sort-icon"}),Ne(d("select",{"onUpdate:modelValue":he[2]||(he[2]=ue=>q(A).sortBy=ue),onChange:he[3]||(he[3]=ue=>q(k)()),class:"sort-select"},he[26]||(he[26]=[Rn('<option value="firstName">First Names</option><option value="lastName">Last Name</option><option value="grade">Grade</option><option value="reviewDate">Plan Review Date</option><option value="reevalDate">Re-evaluation Date</option><option value="meetingDate">Meeting Date</option>',6)]),544),[[sr,q(A).sortBy]])]),q(N)&&q(N).length?(L(),B("div",oW,[d("div",lW,[(L(!0),B(De,null,$e(q(N),ue=>(L(),B("label",{key:ue.value,class:Xe(["radio-btn icon-btn",{active:q(A).providerView===ue.value}]),title:xe(ue.value)},[Ne(d("input",{type:"radio","onUpdate:modelValue":he[4]||(he[4]=be=>q(A).providerView=be),value:ue.value,onChange:he[5]||(he[5]=(...be)=>q(k)&&q(k)(...be))},null,40,uW),[[Ss,q(A).providerView]]),ue.value==="all_iep"?(L(),Jt(q(zl),{key:0,size:16})):ue.value==="case_manager"?(L(),Jt(q(Vv),{key:1,size:16})):ue.value==="service_provider"||ue.value==="teacher"?(L(),Jt(q(hB),{key:2,size:16})):ue.value==="all"||ue.value==="iep_504_all"?(L(),Jt(q(nB),{key:3,size:16})):_e("",!0)],10,cW))),128))])])):_e("",!0),d("div",dW,[d("div",fW,[d("label",{class:Xe(["radio-btn icon-btn",{active:q(A).viewMode==="list"}]),title:"List view"},[d("input",{type:"radio",value:"list",checked:q(A).viewMode==="list",onChange:he[6]||(he[6]=ue=>q(R)("list"))},null,40,hW),Pe(q(lB),{size:16})],2),d("label",{class:Xe(["radio-btn icon-btn",{active:q(A).viewMode==="class",disabled:q(P)}]),title:"Class-period view"},[d("input",{type:"radio",value:"class",checked:q(A).viewMode==="class",onChange:he[7]||(he[7]=ue=>q(R)("class")),disabled:q(P)},null,40,pW),Pe(q(Z7),{size:16,class:Xe({strikethrough:q(P)})},null,8,["class"]),q(P)?(L(),B("span",mW,"🚫")):_e("",!0)],2),q(C)?(L(),B("label",{key:0,class:Xe(["radio-btn icon-btn",{active:q(A).viewMode==="testing"}]),title:"Separate Setting For Testing"},[d("input",{type:"radio",value:"testing",checked:q(A).viewMode==="testing",onChange:he[8]||(he[8]=ue=>q(R)("testing"))},null,40,gW),Pe(q(Bv),{size:16})],2)):_e("",!0)])]),q(W)?(L(),B("button",{key:1,onClick:he[9]||(he[9]=(...ue)=>q(D)&&q(D)(...ue)),class:Xe(["radio-btn icon-btn filter-toggle-btn",{active:q(v)}]),title:"Toggle filters"},[Pe(q(rB),{size:16})],2)):_e("",!0)])]),ae.value?(L(),B("div",vW,Z(ae.value),1)):_e("",!0),q(v)?(L(),B("div",yW,[d("div",xW,[d("div",EW,[he[28]||(he[28]=d("label",null,"Case Manager",-1)),Ne(d("select",{"onUpdate:modelValue":he[10]||(he[10]=ue=>q(A).cm=ue),onChange:he[11]||(he[11]=ue=>q(k)()),class:"filter-select"},[he[27]||(he[27]=d("option",{value:"all"},"All Case Managers",-1)),(L(!0),B(De,null,$e(q(c),ue=>(L(),B("option",{key:ue.id,value:ue.id},Z(ue.displayName||ue.name||ue.email||ue.id),9,_W))),128))],544),[[sr,q(A).cm]])]),d("div",bW,[he[30]||(he[30]=d("label",null,"Teacher",-1)),Ne(d("select",{"onUpdate:modelValue":he[12]||(he[12]=ue=>q(A).teacher=ue),onChange:he[13]||(he[13]=ue=>q(k)()),class:"filter-select"},[he[29]||(he[29]=d("option",{value:"all"},"All Teachers",-1)),(L(!0),B(De,null,$e(q(u),ue=>(L(),B("option",{key:ue.id,value:ue.id},Z(ue.name||ue.email||ue.id),9,SW))),128))],544),[[sr,q(A).teacher]])]),d("div",AW,[he[32]||(he[32]=d("label",null,"Paraeducator",-1)),Ne(d("select",{"onUpdate:modelValue":he[14]||(he[14]=ue=>q(A).paraeducator=ue),onChange:he[15]||(he[15]=ue=>q(k)()),class:"filter-select"},[he[31]||(he[31]=d("option",{value:"all"},"All Paraeducators",-1)),(L(!0),B(De,null,$e(q(p),ue=>(L(),B("option",{key:ue.id,value:ue.id},Z(ue.name||ue.email||ue.id),9,TW))),128))],544),[[sr,q(A).paraeducator]])]),d("div",wW,[he[34]||(he[34]=d("label",null,"Plan Type",-1)),Ne(d("select",{"onUpdate:modelValue":he[16]||(he[16]=ue=>q(A).plan=ue),onChange:he[17]||(he[17]=ue=>q(k)()),class:"filter-select"},he[33]||(he[33]=[d("option",{value:"all"},"All Plans",-1),d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),544),[[sr,q(A).plan]])]),d("div",CW,[he[36]||(he[36]=d("label",null,"Service Provider",-1)),Ne(d("select",{"onUpdate:modelValue":he[18]||(he[18]=ue=>q(A).serviceProvider=ue),onChange:he[19]||(he[19]=ue=>q(k)()),class:"filter-select"},[he[35]||(he[35]=d("option",{value:"all"},"All Service Providers",-1)),(L(!0),B(De,null,$e(q(g),ue=>(L(),B("option",{key:ue.id,value:ue.id},Z(ue.name||ue.email||ue.id),9,IW))),128))],544),[[sr,q(A).serviceProvider]])])])])):_e("",!0),d("div",kW,[d("div",DW,Z(((Ce=q(e).currentUser)==null?void 0:Ce.name)||((Te=q(e).currentUser)==null?void 0:Te.email)||((Ge=q(e).currentUser)==null?void 0:Ge.displayName)||((Ie=q(y))==null?void 0:Ie.name)||((Ve=q(y))==null?void 0:Ve.email)||"System User"),1),q(O)==="list"?(L(),B("div",PW,[Pe(Kf,{students:q(x),"user-map":q(o),"current-user":q(y),"student-data":q(r),"can-edit-all":q(m),"can-edit-own":q(S),"can-view-all":q(I),"can-access-testing":q(C),"can-access-testing-partial":q(F),"aide-schedule":((Ue=q(y))==null?void 0:Ue.role)==="paraeducator"?q(h):{},onEdit:q(J),onEmail:q(Q),onTeacherFeedback:q(ve)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):q(O)==="class"?(L(),B("div",RW,[q(z).length>0?(L(),B("div",FW,[he[37]||(he[37]=d("h3",{class:"group-header direct-assignment-header"},"Direct Assignment",-1)),Pe(Kf,{students:q(z),"user-map":q(o),"current-user":q(y),"student-data":q(r),"can-edit-all":q(m),"can-edit-own":q(S),"can-view-all":q(I),"can-access-testing":q(C),"can-access-testing-partial":q(F),"aide-schedule":((ze=q(y))==null?void 0:ze.role)==="paraeducator"?q(h):{},onEdit:q(J),onEmail:q(Q),onTeacherFeedback:q(ve)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):_e("",!0),(L(!0),B(De,null,$e(q(G),(ue,be)=>{var Ae;return L(),B("div",{key:be,class:"group-section"},[d("h3",NW,"Period "+Z(be),1),Pe(Kf,{students:ue,"user-map":q(o),"current-user":q(y),"student-data":q(r),"can-edit-all":q(m),"can-edit-own":q(S),"can-view-all":q(I),"can-access-testing":q(C),"can-access-testing-partial":q(F),"aide-schedule":((Ae=q(y))==null?void 0:Ae.role)==="paraeducator"?q(h):{},onEdit:q(J),onEmail:q(Q),onTeacherFeedback:q(ve)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])}),128))])):q(O)==="testing"?(L(),B("div",OW,[Pe(Kf,{students:q(j),"user-map":q(o),"current-user":q(y),"student-data":q(r),"can-edit-all":q(m),"can-edit-own":q(S),"can-view-all":q(I),"can-access-testing":q(C),"can-access-testing-partial":q(F),"testing-view":!0,"aide-schedule":((Ke=q(y))==null?void 0:Ke.role)==="paraeducator"?q(h):{},onEdit:q(J),onEmail:q(Q),onTeacherFeedback:q(ve)},null,8,["students","user-map","current-user","student-data","can-edit-all","can-edit-own","can-view-all","can-access-testing","can-access-testing-partial","aide-schedule","onEdit","onEmail","onTeacherFeedback"])])):_e("",!0)]),q(H)?(L(),Jt(_j,{key:2,"student-id":q(H),users:{userRoles:q(f)},onClose:he[20]||(he[20]=ue=>H.value=null),onSaved:q(Y)},null,8,["student-id","users","onSaved"])):_e("",!0),q(V)?(L(),Jt(zj,{key:3,student:q(_)(q(V)),"user-map":q(o),"current-user":q(y),onClose:he[21]||(he[21]=ue=>V.value=null)},null,8,["student","user-map","current-user"])):_e("",!0),q(te)?(L(),Jt(sG,{key:4,students:q(a),"user-map":q(o),onClose:he[22]||(he[22]=ue=>te.value=!1)},null,8,["students","user-map"])):_e("",!0),q(oe)?(L(),Jt(sx,{key:5,users:{userRoles:q(f)},onClose:he[23]||(he[23]=ue=>oe.value=!1),onSaved:q(K)},null,8,["users","onSaved"])):_e("",!0),q(ne)?(L(),Jt(eW,{key:6,student:q(_)(q(le)),"current-user":q(y),"user-map":q(o),onClose:he[24]||(he[24]=ue=>ne.value=!1),onFormSent:q(ee)},null,8,["student","current-user","user-map","onFormSent"])):_e("",!0)])}}},LW={class:"login-container"},BW={__name:"LoginView",setup(t){const e=ki(),r=async()=>{try{const{user:n}=await J1(Et,V4),s=Ze(qe,"users",n.uid);(await qt(s)).exists()||await jt(s,{name:n.displayName||"",email:n.email,role:"admin"}),e.push({name:"Home"})}catch(n){console.error("Login failed:",n),alert("Login failed: "+n.message)}};return(n,s)=>(L(),B("div",LW,[s[0]||(s[0]=d("h1",null,"Case Manager Portal",-1)),s[1]||(s[1]=d("p",null,"Please sign in with your Google account:",-1)),d("button",{onClick:r,class:"primary-btn"}," Sign in with Google ")]))}},UW=St(BW,[["__scopeId","data-v-d9b5a53b"]]),$W={name:"TabBar",props:{tabs:{type:Array,required:!0,default:()=>[]},activeTab:{type:String,required:!0}},emits:["tab-change"],methods:{getStatusIcon(t){switch(t){case"not-active":return"⭐";case"not-working":return"❌";default:return""}},getStatusTooltip(t){switch(t){case"not-active":return"⭐ = Not active";case"not-working":return"❌ = Not working";default:return""}}}},VW={class:"admin-tab-bar"},HW=["onClick","title"];function jW(t,e,r,n,s,i){return L(),B("div",VW,[(L(!0),B(De,null,$e(r.tabs,a=>(L(),B("button",{key:a.key,class:Xe({active:r.activeTab===a.key}),onClick:o=>t.$emit("tab-change",a.key),title:i.getStatusTooltip(a.status)},[we(Z(a.label)+" ",1),a.status?(L(),B("span",{key:0,class:Xe(["status-indicator",a.status])},Z(i.getStatusIcon(a.status)),3)):_e("",!0)],10,HW))),128))])}const GW=St($W,[["render",jW],["__scopeId","data-v-7e596834"]]),WW={name:"UserAddForm",setup(){const t=Ra($4,"addUserWithRole"),e=xo(),r=As({name:"",email:"",role:"",provider:"",aeriesId:"",rm:"",ext:""}),n=se(null),s=se(""),i=se(!1),a=se(null),o=Ko,{appSettings:l,loadAppSettings:c}=Ms(),u=Se(()=>[...Ko].sort()),f=Se(()=>{if(l&&l.value&&l.value.serviceProviders){const A=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}];return l.value.serviceProviders.map(D=>A.find(k=>k.abbreviation===D)||{name:D,abbreviation:D}).sort((D,k)=>D.name.localeCompare(k.name))}return[]}),h=(A,D=!1)=>{s.value=A,i.value=D,setTimeout(()=>{s.value="",i.value=!1},5e3)},p=async(A,D,k,T,x,m,S)=>{try{const I={name:A,email:D,role:k,provider:T,aeriesId:x,rm:m,ext:S,createdAt:new Date,status:"active"},C=await p4(At(e,"users"),I);return await sn.logUserManagement(C.id,"create",{userData:{name:A,email:D,role:k,provider:T,aeriesId:x,rm:m,ext:S},method:"firestore_direct"}),{success:!0,userId:C.id}}catch(I){throw await sn.logUserManagement("unknown","create_failed",{error:I.message,attemptedData:{name:A,email:D,role:k,provider:T,aeriesId:x,rm:m,ext:S},method:"firestore_direct"}),I}},g=async(A,D,k,T,x,m,S)=>{var I,C;try{try{return await t({name:A,email:D,role:k,provider:T,aeriesId:x,rm:m,ext:S}),await sn.logUserManagement("cloud_function_user","create",{userData:{name:A,email:D,role:k,provider:T,aeriesId:x,rm:m,ext:S},method:"cloud_function"}),{success:!0,method:"cloud-function"}}catch(F){return F.code==="functions/already-exists"||(I=F.message)!=null&&I.includes("409")||(C=F.message)!=null&&C.includes("already exists")?(console.log(`User ${D} already exists in Firebase Auth, skipping...`),await sn.logUserManagement("existing_user","create_skipped",{userData:{name:A,email:D,role:k,provider:T,aeriesId:x,rm:m,ext:S},reason:"user_already_exists",method:"cloud_function"}),{success:!0,method:"already-exists",message:"User already exists"}):(await p(A,D,k,T,x,m,S),{success:!0,method:"firestore"})}}catch(F){return await sn.logUserManagement("unknown","create_failed",{error:F.message,attemptedData:{name:A,email:D,role:k,provider:T,aeriesId:x,rm:m,ext:S},method:"addUserToFirestore"}),{success:!1,error:F.message}}},y=async()=>{if(!Rs("addUser",5,6e4).allowed){h("Too many requests. Please wait before adding another user.",!0);return}const D=GB(r),k=jB(D);if(!k.isValid){h(`Please fix the following errors:
${k.errors.join(`
`)}`,!0);return}const T=["name","email","aeriesId","rm","ext"];for(const m of T)if(D[m]){const S=Hr(D[m]);if(!S.isSafe){h(`Security threat detected in ${m}: ${S.threats.join(", ")}`,!0);return}}Object.assign(r,D);const x=await g(r.name,r.email,r.role,r.provider,r.aeriesId,r.rm,r.ext);x.success?(h(`User ${r.name} added successfully!`),r.name="",r.email="",r.role="",r.provider="",r.aeriesId="",r.rm="",r.ext=""):h(`Error adding user: ${x.error}`,!0)},E=A=>{const D=A.target.files[0];if(D){const k=ol(D,{allowedTypes:["csv","excel"],maxSize:5242880,fieldName:"User Import File"});if(!k.isValid){h(k.error,!0),A.target.value="";return}const T=Hr(D.name);if(!T.isSafe){h(`File name contains potentially dangerous content: ${T.threats.join(", ")}`,!0),A.target.value="";return}n.value=D}},b=async()=>{if(!n.value){h("Please select a file first",!0);return}const A=n.value.name.toLowerCase();if(!(A.endsWith(".csv")||A.endsWith(".xls")||A.endsWith(".xlsx"))){h("Unsupported file type. Please upload a .csv, .xls, or .xlsx file.",!0);return}h("Processing file...");try{A.endsWith(".csv")?await _(n.value):await v(n.value)}catch(D){h(`Error processing file: ${D.message}`,!0),console.error("Bulk upload error:",D)}},_=async A=>new Promise((D,k)=>{const T=new FileReader;T.onload=async x=>{try{const S=x.target.result.trim().split(/\r?\n/);if(S.length===0){k(new Error("The CSV file is empty."));return}const I=O=>{const G=[];let z="",j=!1;for(let H=0;H<O.length;H++){const V=O[H];V==='"'?j=!j:V===","&&!j?(G.push(z.trim()),z=""):z+=V}return G.push(z.trim()),G};let C=0;const F={name:0,email:1,role:2,provider:3,aeriesId:4,rm:5,ext:6},W=I(S[0]);W.map(O=>O.toLowerCase()).some(O=>O.includes("name")||O.includes("email")||O.includes("role"))&&(W.forEach((O,G)=>{const z=O.trim().toLowerCase();(z==="name"||z==="displayname")&&(F.name=G),z==="email"&&(F.email=G),z==="role"&&(F.role=G),(z==="provider"||z==="providertype")&&(F.provider=G),(z==="aeriesid"||z==="aeries_id"||z==="teacherid")&&(F.aeriesId=G),(z==="rm"||z==="room")&&(F.rm=G),(z==="ext"||z==="extension")&&(F.ext=G)}),C=1);let R=0;const N=[];for(let O=C;O<S.length;O++){const G=S[O].trim();if(!G)continue;const z=I(G),j=(z[F.name]||"").trim(),H=(z[F.email]||"").trim(),V=(z[F.role]||"").trim(),te=(z[F.provider]||"").trim(),oe=(z[F.aeriesId]||"").trim(),ne=(z[F.rm]||"").trim(),le=(z[F.ext]||"").trim(),J=j.replace(/^"|"$/g,""),Q=H.replace(/^"|"$/g,""),ve=V.replace(/^"|"$/g,""),ee=te.replace(/^"|"$/g,""),K=oe.replace(/^"|"$/g,""),Y=ne.replace(/^"|"$/g,""),pe=le.replace(/^"|"$/g,"");if(!J||!Q||!ve){N.push(`Line ${O+1}: Missing name, email, or role.`);continue}if(!$_(ve)){N.push(`Line ${O+1}: Invalid role "${ve}".`);continue}const xe=await g(J,Q,ve,ee,K,Y,pe);xe.success?(R++,xe.method==="already-exists"&&console.log(`Line ${O+1}: User ${Q} already exists, skipped`)):N.push(`Line ${O+1}: ${xe.error}`)}let M=`${R} users added successfully.`;N.length>0&&(M+=`
${N.length} errors:
`+N.join(`
`)),h(M,N.length>0),n.value=null,a.value&&(a.value.value=""),D()}catch(m){k(new Error(`Error processing CSV file: ${m.message}`))}},T.onerror=()=>k(new Error("Failed to read the CSV file.")),T.readAsText(A)}),v=async A=>new Promise((D,k)=>{const T=new FileReader;T.onload=async x=>{try{if(typeof XLSX>"u"){k(new Error("Excel upload requires SheetJS (XLSX) library. Please include it in your page."));return}const m=new Uint8Array(x.target.result),S=XLSX.read(m,{type:"array"}),I=S.SheetNames[0],C=S.Sheets[I],F=XLSX.utils.sheet_to_json(C,{defval:""});if(F.length===0){k(new Error("The Excel file is empty or unrecognized."));return}let W=0;const P=[];for(let N=0;N<F.length;N++){const M=F[N];let O="",G="",z="",j="",H="",V="",te="";for(const le in M){const J=le.toLowerCase(),Q=(""+M[le]).trim();(J==="name"||J==="displayname")&&!O?O=Q:J==="email"&&!G?G=Q:J==="role"&&!z?z=Q:(J==="provider"||J==="providertype")&&!j?j=Q:(J==="aeriesid"||J==="aeries_id"||J==="teacherid")&&!H?H=Q:(J==="rm"||J==="room")&&!V?V=Q:(J==="ext"||J==="extension")&&!te&&(te=Q)}const oe=Object.values(M).map(le=>(""+le).trim());if(!O&&oe[0]&&(O=oe[0]),!G&&oe[1]&&(G=oe[1]),!z&&oe[2]&&(z=oe[2]),!j&&oe[3]&&(j=oe[3]),!H&&oe[4]&&(H=oe[4]),!V&&oe[5]&&(V=oe[5]),!te&&oe[6]&&(te=oe[6]),!O||!G||!z){P.push(`Row ${N+1}: Missing name, email, or role.`);continue}if(!$_(z)){P.push(`Row ${N+1}: Invalid role "${z}".`);continue}const ne=await g(O,G,z,j,H,V,te);ne.success?(W++,ne.method==="already-exists"&&console.log(`Row ${N+1}: User ${G} already exists, skipped`)):P.push(`Row ${N+1}: ${ne.error}`)}let R=`${W} users added successfully.`;P.length>0&&(R+=`
${P.length} errors:
`+P.join(`
`)),h(R,P.length>0),n.value=null,a.value&&(a.value.value=""),D()}catch(m){k(new Error(`Error processing Excel file: ${m.message}`))}},T.onerror=()=>k(new Error("Failed to read the Excel file.")),T.readAsArrayBuffer(A)});return Gt(async()=>{await c()}),{singleUser:r,validRoles:o,sortedValidRoles:u,providerOptions:f,addSingleUser:y,selectedFile:n,statusMessage:s,isError:i,bulkFileInput:a,handleFileSelect:E,uploadBulkUsers:b,appSettings:l}}},zW={class:"add-user-wrapper"},KW={class:"add-single"},qW=["value"],XW={key:0},YW=["value"],QW={class:"add-bulk"},JW=["disabled"];function ZW(t,e,r,n,s,i){return L(),B("div",zW,[d("div",KW,[e[20]||(e[20]=d("h3",null,"Add Single User",-1)),d("form",{onSubmit:e[7]||(e[7]=Yr((...a)=>n.addSingleUser&&n.addSingleUser(...a),["prevent"])),class:"form-grid"},[d("div",null,[d("label",null,[e[10]||(e[10]=we(" Name: ")),Ne(d("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>n.singleUser.name=a),required:"",autocomplete:"off","data-lpignore":"true"},null,512),[[ft,n.singleUser.name]])])]),d("div",null,[d("label",null,[e[11]||(e[11]=we(" Email: ")),Ne(d("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=a=>n.singleUser.email=a),required:"",autocomplete:"off","data-lpignore":"true"},null,512),[[ft,n.singleUser.email]])])]),d("div",null,[d("label",null,[e[13]||(e[13]=we(" Role: ")),Ne(d("select",{"onUpdate:modelValue":e[2]||(e[2]=a=>n.singleUser.role=a),required:""},[e[12]||(e[12]=d("option",{value:"",disabled:""},"Select role...",-1)),(L(!0),B(De,null,$e(n.sortedValidRoles,a=>(L(),B("option",{key:a,value:a},Z(a),9,qW))),128))],512),[[sr,n.singleUser.role]])])]),n.providerOptions.length>0?(L(),B("div",XW,[d("label",null,[e[15]||(e[15]=we(" Provider Type: ")),Ne(d("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>n.singleUser.provider=a)},[e[14]||(e[14]=d("option",{value:""},"None",-1)),(L(!0),B(De,null,$e(n.providerOptions,a=>(L(),B("option",{key:a.abbreviation,value:a.abbreviation},Z(a.name)+" ("+Z(a.abbreviation)+") ",9,YW))),128))],512),[[sr,n.singleUser.provider]])])])):_e("",!0),d("div",null,[d("label",null,[e[16]||(e[16]=we(" Aeries ID: ")),Ne(d("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=a=>n.singleUser.aeriesId=a),placeholder:"Optional Aeries Teacher ID"},null,512),[[ft,n.singleUser.aeriesId]])])]),d("div",null,[d("label",null,[e[17]||(e[17]=we(" Room: ")),Ne(d("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=a=>n.singleUser.rm=a),placeholder:"Room number (e.g., 101, A-23)"},null,512),[[ft,n.singleUser.rm]])])]),d("div",null,[d("label",null,[e[18]||(e[18]=we(" Extension: ")),Ne(d("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=a=>n.singleUser.ext=a),placeholder:"Phone extension (e.g., 1234)"},null,512),[[ft,n.singleUser.ext]])])]),e[19]||(e[19]=d("button",{type:"submit"},"Add User",-1))],32)]),d("div",QW,[e[21]||(e[21]=d("h3",null,"Bulk Upload Users",-1)),d("div",null,[d("input",{type:"file",ref:"bulkFileInput",accept:".csv, .xls, .xlsx",onChange:e[8]||(e[8]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[9]||(e[9]=(...a)=>n.uploadBulkUsers&&n.uploadBulkUsers(...a)),disabled:!n.selectedFile}," Upload Users ",8,JW)]),e[22]||(e[22]=Rn('<h4 data-v-fc29f360>📋 Import Format &amp; Requirements</h4><div class="format-info" data-v-fc29f360><p data-v-fc29f360><strong data-v-fc29f360>📁 File Format:</strong> CSV, Excel (.xls, .xlsx) - First row must contain column headers</p><p data-v-fc29f360><strong data-v-fc29f360>⚠️ Important:</strong> Column order matters! Headers must match exactly or use standard order</p></div><div class="spreadsheet-example" data-v-fc29f360><h5 data-v-fc29f360>📊 Example Spreadsheet Layout</h5><div class="table-container" data-v-fc29f360><table class="example-table" data-v-fc29f360><thead data-v-fc29f360><tr data-v-fc29f360><th data-v-fc29f360>Name</th><th data-v-fc29f360>Email</th><th data-v-fc29f360>Role</th><th data-v-fc29f360>Provider</th><th data-v-fc29f360>AeriesID</th><th data-v-fc29f360>Room</th><th data-v-fc29f360>Extension</th></tr></thead><tbody data-v-fc29f360><tr data-v-fc29f360><td data-v-fc29f360>John Smith</td><td data-v-fc29f360>john.smith@school.org</td><td data-v-fc29f360><span class="role-badge teacher" data-v-fc29f360>teacher</span></td><td data-v-fc29f360></td><td data-v-fc29f360>123456</td><td data-v-fc29f360>A-101</td><td data-v-fc29f360>1234</td></tr><tr data-v-fc29f360><td data-v-fc29f360>Jane Doe</td><td data-v-fc29f360>jane.doe@school.org</td><td data-v-fc29f360><span class="role-badge service-provider" data-v-fc29f360>service_provider</span></td><td data-v-fc29f360><span class="provider-badge" data-v-fc29f360>SLP</span></td><td data-v-fc29f360></td><td data-v-fc29f360>B-205</td><td data-v-fc29f360>5678</td></tr><tr data-v-fc29f360><td data-v-fc29f360>Bob Johnson</td><td data-v-fc29f360>bob.johnson@school.org</td><td data-v-fc29f360><span class="role-badge case-manager" data-v-fc29f360>case_manager</span></td><td data-v-fc29f360></td><td data-v-fc29f360>789012</td><td data-v-fc29f360>C-150</td><td data-v-fc29f360>9101</td></tr></tbody></table></div></div><div class="reference-cards" data-v-fc29f360><div class="reference-card roles-card" data-v-fc29f360><div class="card-header roles-header" data-v-fc29f360><h5 data-v-fc29f360>👥 Available Roles</h5><span class="card-count" data-v-fc29f360>10 roles</span></div><div class="card-content" data-v-fc29f360><div class="compact-grid" data-v-fc29f360><div class="compact-item" data-v-fc29f360><span class="role-badge admin" data-v-fc29f360>admin</span><span class="compact-desc" data-v-fc29f360>Full system access</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge school-admin" data-v-fc29f360>school_admin</span><span class="compact-desc" data-v-fc29f360>School-level admin</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge staff-view" data-v-fc29f360>staff_view</span><span class="compact-desc" data-v-fc29f360>View-only access</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge staff-edit" data-v-fc29f360>staff_edit</span><span class="compact-desc" data-v-fc29f360>Edit students, no admin panel</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge admin-504" data-v-fc29f360>admin_504</span><span class="compact-desc" data-v-fc29f360>504-specific admin</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge sped-chair" data-v-fc29f360>sped_chair</span><span class="compact-desc" data-v-fc29f360>SPED chair access</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge case-manager" data-v-fc29f360>case_manager</span><span class="compact-desc" data-v-fc29f360>Case manager access</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge teacher" data-v-fc29f360>teacher</span><span class="compact-desc" data-v-fc29f360>Teacher access</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge service-provider" data-v-fc29f360>service_provider</span><span class="compact-desc" data-v-fc29f360>Service provider access</span></div><div class="compact-item" data-v-fc29f360><span class="role-badge paraeducator" data-v-fc29f360>paraeducator</span><span class="compact-desc" data-v-fc29f360>Paraeducator access</span></div></div></div></div><div class="reference-card providers-card" data-v-fc29f360><div class="card-header providers-header" data-v-fc29f360><h5 data-v-fc29f360>🏥 Service Providers</h5><span class="card-count" data-v-fc29f360>14 types</span></div><div class="card-content" data-v-fc29f360><p class="card-note" data-v-fc29f360><strong data-v-fc29f360>📝 Note:</strong> Use abbreviation only in import file</p><div class="compact-grid" data-v-fc29f360><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>SLP</span><span class="compact-desc" data-v-fc29f360>Speech-Language Therapy</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>OT</span><span class="compact-desc" data-v-fc29f360>Occupational Therapy</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>PT</span><span class="compact-desc" data-v-fc29f360>Physical Therapy</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>SC</span><span class="compact-desc" data-v-fc29f360>School Counseling</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>MH</span><span class="compact-desc" data-v-fc29f360>School-Based Mental Health</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>TR</span><span class="compact-desc" data-v-fc29f360>Transportation</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>AUD</span><span class="compact-desc" data-v-fc29f360>Audiology Services</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>VI</span><span class="compact-desc" data-v-fc29f360>Vision Services</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>AT</span><span class="compact-desc" data-v-fc29f360>Assistive Technology</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>DHH</span><span class="compact-desc" data-v-fc29f360>Deaf and Hard of Hearing</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>O&amp;M</span><span class="compact-desc" data-v-fc29f360>Orientation and Mobility</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>BIS</span><span class="compact-desc" data-v-fc29f360>Behavioral Intervention</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>HN</span><span class="compact-desc" data-v-fc29f360>Health/Nursing Services</span></div><div class="compact-item" data-v-fc29f360><span class="provider-badge" data-v-fc29f360>SW</span><span class="compact-desc" data-v-fc29f360>Social Work Services</span></div></div></div></div><div class="reference-card aeries-card" data-v-fc29f360><div class="card-header aeries-header" data-v-fc29f360><h5 data-v-fc29f360>🆔 Aeries ID / SIS ID</h5><span class="card-count" data-v-fc29f360>6-digit numeric</span></div><div class="card-content" data-v-fc29f360><div class="aeries-info" data-v-fc29f360><div class="info-item" data-v-fc29f360><span class="info-label" data-v-fc29f360>Purpose:</span><span class="info-value" data-v-fc29f360>Links teachers to classes in Aeries/SIS systems</span></div><div class="info-item" data-v-fc29f360><span class="info-label" data-v-fc29f360>Format:</span><span class="info-value" data-v-fc29f360>123456 (6-digit numeric)</span></div><div class="info-item" data-v-fc29f360><span class="info-label" data-v-fc29f360>Required for:</span><span class="info-value" data-v-fc29f360>Teachers &amp; service providers who teach classes</span></div><div class="info-item" data-v-fc29f360><span class="info-label" data-v-fc29f360>Optional for:</span><span class="info-value" data-v-fc29f360>Admin roles, case managers, paraeducators</span></div></div></div></div></div><div class="troubleshooting-notes" data-v-fc29f360><h5 data-v-fc29f360>🔧 Troubleshooting Tips</h5><div class="tips-grid" data-v-fc29f360><div class="tip-item" data-v-fc29f360><strong data-v-fc29f360>📋 Column Headers:</strong><ul data-v-fc29f360><li data-v-fc29f360>Use exact header names: Name, Email, Role, Provider, AeriesID</li><li data-v-fc29f360>Or use standard order: Name (1st), Email (2nd), Role (3rd), Provider (4th), AeriesID (5th)</li></ul></div><div class="tip-item" data-v-fc29f360><strong data-v-fc29f360>✅ Validation:</strong><ul data-v-fc29f360><li data-v-fc29f360>All emails must be valid format</li><li data-v-fc29f360>Roles must match exactly (case-sensitive)</li><li data-v-fc29f360>Provider types only for service_provider role</li><li data-v-fc29f360>Use provider abbreviations only (SLP, OT, PT, etc.)</li></ul></div><div class="tip-item" data-v-fc29f360><strong data-v-fc29f360>⚠️ Common Issues:</strong><ul data-v-fc29f360><li data-v-fc29f360>Extra spaces in role names</li><li data-v-fc29f360>Missing quotes around values with commas</li><li data-v-fc29f360>Invalid email formats</li><li data-v-fc29f360>Non-numeric Aeries IDs</li><li data-v-fc29f360>Using full provider names instead of abbreviations</li></ul></div></div></div>',5))]),n.statusMessage?(L(),B("div",{key:0,class:Xe(["status-msg",{error:n.isError}])},Z(n.statusMessage),3)):_e("",!0)])}const ez=St(WW,[["render",ZW],["__scopeId","data-v-fc29f360"]]),Ja=se({}),qf=se(!1),dg=se(!1);function bI(){const t=on(),e=Se(()=>t.currentUser),r=async()=>{if(qf.value||dg.value)return Ja.value;qf.value=!0;try{const o=Ze(qe,"app_settings","admin_panel_permissions"),l=await qt(o);return l.exists()?Ja.value=l.data():Ja.value={},dg.value=!0,Ja.value}catch(o){return console.error("Error loading admin panel permissions:",o),Ja.value={},Ja.value}finally{qf.value=!1}},n=Se(()=>o=>{var c,u;if(!((c=e.value)!=null&&c.role)||!Ja.value[o])return!1;const l=e.value.role;return l==="admin"?!0:((u=Ja.value[o])==null?void 0:u[l])===!0}),s=Se(()=>n.value("delete-all-users")),i=Se(()=>n.value("delete-all-students"));return{permissions:Ja,isLoading:qf,hasPermission:n,canDeleteAllUsers:s,canDeleteAllStudents:i,loadPermissions:r,initializeIfNeeded:async()=>{dg.value||await r()}}}const tz={class:"admin-form-row"},rz={class:"search-type-radios"},nz={class:"user-admin-table striped"},sz={key:0},az=["data-userid"],iz=["value","disabled","onInput"],oz=["value","disabled","onInput"],lz=["disabled","value","onChange"],cz=["value"],uz={key:0},dz={key:0},fz={key:1},hz=["value","onChange"],pz=["value"],mz={key:1},gz={class:"admin-action-btns"},vz=["onClick"],yz=["onClick"],xz=["onClick"],Ez={class:"admin-pagination"},_z=["disabled"],bz=["disabled"],du=20,Sz={__name:"UserTable",setup(t){const e=xo(),r=se([]),n=se(1),s=se("name"),i=se(""),a=se(null),o=se(""),l=se(!1),c=se(!1),u=se([]),f=se(null),h=Ko,p=Ms(),g=p.appSettings,y=p.loadAppSettings,{canDeleteAllUsers:E,initializeIfNeeded:b}=bI();let _=null;const v=()=>{_&&clearTimeout(_),_=setTimeout(()=>{T()},300)},A=Se(()=>{var M;return Array.isArray((M=g.value)==null?void 0:M.serviceProviders)&&g.value.serviceProviders.length>0}),D=Se(()=>{var M;return((M=g.value)==null?void 0:M.serviceProviders)||[]}),k=(M,O=!1)=>{o.value=M,l.value=O,M&&setTimeout(()=>{o.value="",l.value=!1},5e3)},T=()=>{n.value=1,x()},x=async(M="first")=>{const O=At(e,"users");let G;if(i.value&&s.value==="name"){const H=(await zt(cr(O,vn("name"),la(1e3)))).docs.map(V=>({id:V.id,...V.data()})).filter(V=>(V.name||"").toLowerCase().includes(i.value.toLowerCase()));a.value=null,r.value=H,c.value=!1;return}i.value&&s.value==="email"?G=cr(O,vn("email"),Ur("email",">=",i.value),Ur("email","<=",i.value+""),la(du)):i.value?G=cr(O,vn("name"),Ur("name",">=",i.value),Ur("name","<=",i.value+""),la(du)):G=cr(O,vn("name"),la(du)),M==="next"&&u.value.length&&(G=cr(O,vn(s.value),gh(u.value[u.value.length-1]),la(du)));const z=await zt(G);u.value=z.docs,a.value=null,r.value=u.value.map(j=>({id:j.id,...j.data()})),c.value=z.size===du},m=M=>{a.value||(a.value=M,f.value={...r.value.find(O=>O.id===M)})},S=()=>{a.value=null,f.value=null,x()},I=(M,O,G)=>{f.value&&f.value.id===M&&(f.value[O]=G)},C=async M=>{var O,G;if(!(!f.value||f.value.id!==M))try{const z=r.value.find(H=>H.id===M),j={};f.value.name!==void 0&&(j.name=((O=f.value.name)==null?void 0:O.trim())||null),f.value.title!==void 0&&(j.title=((G=f.value.title)==null?void 0:G.trim())||null),f.value.role!==void 0&&(j.role=f.value.role),f.value.provider!==void 0&&(j.provider=f.value.provider||null),await Fp(Ze(e,"users",M),j),await sn.logUserManagement(M,"update",{originalData:{name:z==null?void 0:z.name,title:z==null?void 0:z.title,role:z==null?void 0:z.role,provider:z==null?void 0:z.provider},updatedData:j,changedFields:Object.keys(j)}),k("✅ User updated."),a.value=null,f.value=null,x()}catch(z){console.error("Error updating user:",z),k(`❌ Error updating user: ${z.message}`,!0),await sn.logUserManagement(M,"update_failed",{error:z.message,attemptedData:updateData})}},F=async M=>{if(confirm("Are you sure you want to delete this user?"))try{const O=r.value.find(G=>G.id===M);await mo(Ze(e,"users",M)),await sn.logUserManagement(M,"delete",{deletedUser:{name:O==null?void 0:O.name,email:O==null?void 0:O.email,role:O==null?void 0:O.role,provider:O==null?void 0:O.provider}}),k("✅ User deleted."),a.value=null,f.value=null,x()}catch(O){console.error("Error deleting user:",O),k(`❌ Error deleting user: ${O.message}`,!0),await sn.logUserManagement(M,"delete_failed",{error:O.message})}},W=async()=>{if(prompt("Type DELETE ALL USERS to confirm:")==="DELETE ALL USERS")try{const O=await zt(At(e,"users"));await Promise.all(O.docs.map(G=>mo(Ze(e,"users",G.id)))),k("✅ All users deleted."),n.value=1,x()}catch(O){console.error("Error deleting all users:",O),k(`❌ Error deleting all users: ${O.message}`,!0)}},P=()=>{n.value++,x("next")},R=()=>{n.value>1&&(n.value--,x())},N=M=>{var H;if(!M)return"";const G=(((H=g.value)==null?void 0:H.customServiceProviders)||[]).find(V=>V.abbreviation===M);if(G)return`${G.name} (${G.abbreviation})`;const j=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}].find(V=>V.abbreviation===M);return j?`${j.name} (${j.abbreviation})`:M};return Gt(async()=>{await y(),await b(),x()}),ja(()=>{_&&clearTimeout(_)}),(M,O)=>(L(),B("div",null,[O[12]||(O[12]=d("h2",null,"Edit Users",-1)),d("div",tz,[Ne(d("input",{type:"text","onUpdate:modelValue":O[0]||(O[0]=G=>i.value=G),placeholder:"Search by name or email",class:"admin-search-input",onInput:v},null,544),[[ft,i.value]]),d("div",rz,[d("label",null,[Ne(d("input",{type:"radio","onUpdate:modelValue":O[1]||(O[1]=G=>s.value=G),value:"name",onChange:T},null,544),[[Ss,s.value]]),O[3]||(O[3]=we(" Name "))]),d("label",null,[Ne(d("input",{type:"radio","onUpdate:modelValue":O[2]||(O[2]=G=>s.value=G),value:"email",onChange:T},null,544),[[Ss,s.value]]),O[4]||(O[4]=we(" Email "))])]),q(E)?(L(),B("button",{key:0,onClick:W,class:"delete-all-btn"},[Pe(q(qo),{size:16}),O[5]||(O[5]=we(" Delete All Users "))])):_e("",!0)]),o.value?(L(),B("div",{key:0,class:Xe(["admin-status-msg",{error:l.value}])},Z(o.value),3)):_e("",!0),d("div",null,[d("table",nz,[O[9]||(O[9]=d("thead",null,[d("tr",null,[d("th",null,"Name"),d("th",null,"Title"),d("th",null,"Email"),d("th",null,"Role"),d("th",null,"Provider Type"),d("th",{style:{"text-align":"center"}},"Actions")])],-1)),d("tbody",null,[r.value.length===0?(L(),B("tr",sz,O[6]||(O[6]=[d("td",{colspan:"5"},"No users found.",-1)]))):_e("",!0),(L(!0),B(De,null,$e(r.value,G=>(L(),B("tr",{key:G.id,class:Xe({"active-row":a.value===G.id}),"data-userid":G.id},[d("td",null,[d("input",{type:"text",value:G.name||"",class:"editable-input",disabled:a.value!==G.id,onInput:z=>I(G.id,"name",z.target.value)},null,40,iz)]),d("td",null,[d("input",{type:"text",value:G.title||"",class:"editable-input",disabled:a.value!==G.id,onInput:z=>I(G.id,"title",z.target.value)},null,40,oz)]),d("td",null,Z(G.email),1),d("td",null,[d("select",{class:"editable-select",disabled:a.value!==G.id,value:a.value===G.id?f.value.role:G.role,onChange:z=>I(G.id,"role",z.target.value)},[(L(!0),B(De,null,$e(q(h),z=>(L(),B("option",{key:z,value:z},Z(z.replace(/_/g," ")),9,cz))),128))],40,lz)]),A.value?(L(),B("td",uz,[a.value!==G.id?(L(),B("span",dz,Z(N(G.provider)||"—"),1)):(L(),B("span",fz,[d("select",{value:f.value.provider||"",onChange:z=>I(G.id,"provider",z.target.value)},[O[7]||(O[7]=d("option",{value:""},"None",-1)),(L(!0),B(De,null,$e(D.value,z=>(L(),B("option",{key:z,value:z},Z(N(z)),9,pz))),128))],40,hz)]))])):(L(),B("td",mz,O[8]||(O[8]=[d("span",null,"Loading...",-1)]))),d("td",gz,[a.value!==G.id?(L(),B("button",{key:0,onClick:z=>m(G.id),class:"admin-action-btn edit",title:"Edit"},[Pe(q(Qy),{size:16})],8,vz)):(L(),B(De,{key:1},[d("button",{onClick:z=>C(G.id),class:"admin-action-btn save",title:"Save"},[Pe(q(iI),{size:16})],8,yz),d("button",{onClick:S,class:"admin-action-btn cancel",title:"Cancel"},[Pe(q(dI),{size:16})]),d("button",{onClick:z=>F(G.id),class:"admin-action-btn delete red",title:"Delete User"},[Pe(q(qo),{size:16})],8,xz)],64))])],10,az))),128))])])]),d("div",Ez,[d("button",{onClick:R,disabled:n.value===1,class:"admin-btn"},[Pe(q(nI),{size:16}),O[10]||(O[10]=we(" Previous "))],8,_z),d("span",null,"Page "+Z(n.value),1),d("button",{onClick:P,disabled:!c.value,class:"admin-btn"},[O[11]||(O[11]=we(" Next ")),Pe(q(rI),{size:16})],8,bz)])]))}},Az=St(Sz,[["__scopeId","data-v-59ee6066"]]),Tz={class:"admin-students"},wz={class:"admin-form-row"},Cz={class:"student-admin-table striped"},Iz={key:0},kz=["data-id"],Dz={style:{display:"none"}},Pz=["value","disabled","onInput"],Rz=["value","disabled","onInput"],Fz=["value","disabled","onInput"],Nz=["value","disabled","onChange"],Oz=["value","disabled","onChange"],Mz=["value"],Lz=["title"],Bz={class:"admin-action-btns"},Uz=["onClick"],$z=["onClick"],Vz=["onClick"],Hz={class:"admin-pagination"},jz=["disabled"],Gz=["disabled"],fg=50,Wz={__name:"AdminStudents",setup(t){const e=xo(),{students:r,fetchStudents:n,deleteStudent:s}=Di(),{caseManagers:i,fetchUsers:a}=ba(),{canDeleteAllStudents:o,initializeIfNeeded:l}=bI(),c=se(""),u=se([]),f=se(1),h=se(null),p=se({}),g=se(""),y=se(!1);let E=null;const b=()=>{E&&clearTimeout(E),E=setTimeout(()=>{D()},300)},_=Se(()=>{const N=(f.value-1)*fg,M=N+fg;return u.value.slice(N,M)}),v=Se(()=>Math.ceil(u.value.length/fg)),A=(N,M=!1)=>{g.value=N,y.value=M,setTimeout(()=>{g.value="",y.value=!1},5e3)},D=()=>{if(!Rs("studentSearch",20,6e4).allowed){A("Too many search requests. Please wait before searching again.",!0);return}const M=qr(c.value,100),O=Hr(M);if(!O.isSafe){A(`Security threat detected in search: ${O.threats.join(", ")}`,!0),c.value=M;return}M!==c.value&&(c.value=M);const G=M.toLowerCase();G?u.value=r.value.filter(z=>{const j=it(z,"firstName")||"",H=it(z,"lastName")||"";return`${j} ${H}`.toLowerCase().includes(G)}):u.value=r.value,f.value=1},k=N=>{var O;if(console.log("🚀 ADMIN EDIT DEBUG - Starting edit:",{studentId:N,activeEditId:h.value,studentExists:!!r.value.find(G=>G.id===N)}),h.value)return;const M=r.value.find(G=>G.id===N);M?(console.log("🚀 ADMIN EDIT DEBUG - Student found:",{id:M.id,hasApp:!!M.app,appStudentData:(O=M.app)==null?void 0:O.studentData,keys:Object.keys(M)}),h.value=N,p.value=JSON.parse(JSON.stringify(M)),console.log("🚀 ADMIN EDIT DEBUG - Edit state set:",{activeEditId:h.value,editingStudentId:p.value.id})):console.error("🚀 ADMIN EDIT DEBUG - Student not found!")},T=()=>{h.value=null,p.value={}},x=(N,M,O)=>{if(p.value.id===N){console.log("🚀 ADMIN UPDATE DEBUG - Updating field:",{studentId:N,field:M,value:O,currentValue:it(p.value,M)});let G=O;if(M==="caseManagerId")G=O;else if(typeof O=="string"){G=qr(O,M==="grade"?10:100);const z=Hr(G);if(!z.isSafe){A(`Security threat detected in ${M}: ${z.threats.join(", ")}`,!0);return}const j=Cd(G,M,0,M==="grade"?10:100);if(!j.isValid){A(j.error,!0);return}}["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(M)?(p.value.app||(p.value.app={}),p.value.app.studentData||(p.value.app.studentData={}),p.value.app.studentData[M]=G):p.value[M]=G,console.log("🚀 ADMIN UPDATE DEBUG - Updated field:",{field:M,newValue:G,updatedPath:["firstName","lastName","grade","plan","ssid","caseManagerId"].includes(M)?`app.studentData.${M}`:M})}},m=async N=>{var M,O,G,z,j;try{console.log("🚀 ADMIN SAVE DEBUG - Starting saveStudent:",{studentId:N,editingStudentId:p.value.id,editingStudentKeys:Object.keys(p.value),hasStudentInList:!!r.value.find(Y=>Y.id===N)});const H=on(),V=Se(()=>H.currentUser);if(console.log("🔐 PERMISSION DEBUG:",{currentUser:V.value,userRole:(M=V.value)==null?void 0:M.role,userEmail:(O=V.value)==null?void 0:O.email,userId:(G=V.value)==null?void 0:G.uid}),!Rs("saveStudent",10,6e4).allowed){A("Too many save requests. Please wait before saving again.",!0);return}const oe={},ne=r.value.find(Y=>Y.id===N),le=["firstName","lastName","grade","plan","ssid","caseManagerId"];let J={},Q=!1;if(le.forEach(Y=>{const pe=it(p.value,Y),xe=it(ne,Y);pe!==xe&&(J[Y]=pe,Q=!0,console.log(`✅ CHANGE DETECTED - ${Y}: "${xe}" → "${pe}"`))}),Q&&(oe.app={studentData:{...(z=ne.app)==null?void 0:z.studentData,...J}}),Object.keys(p.value).forEach(Y=>{Y!=="id"&&Y!=="app"&&p.value[Y]!==ne[Y]&&(oe[Y]=p.value[Y])}),console.log("🚀 ADMIN SAVE DEBUG - Updates prepared:",oe),Object.keys(oe).length===0){T();return}const ve=pI(oe),ee=hI(ve,{isNew:!1});if(!ee.isValid){A(`Validation failed: ${ee.errors.join(", ")}`,!0);return}ve.updatedAt=Dn(),ve.updatedBy=((j=V.value)==null?void 0:j.uid)||null,Object.assign(p.value,ve),console.log("🚀 ADMIN SAVE DEBUG - Calling setDoc with merge:",{studentId:N,sanitizedUpdates:ve}),await jt(Ze(e,"students",N),ve,{merge:!0}),console.log("🚀 ADMIN SAVE DEBUG - updateStudent completed successfully");const K=r.value.findIndex(Y=>Y.id===N);if(K!==-1){const Y={...r.value[K]};Object.keys(ve).forEach(pe=>{pe==="app.studentData"?(Y.app||(Y.app={}),Y.app.studentData={...Y.app.studentData,...ve[pe]}):Y[pe]=ve[pe]}),r.value[K]=Y}console.log("🚀 ADMIN SAVE DEBUG - Local state updated"),A("✅ Student updated.")}catch(H){console.error("🚀 ADMIN SAVE DEBUG - Save failed:",H),A("❌ Update failed.",!0),console.error("Update error:",H)}finally{T()}},S=async N=>{if(!Rs("deleteStudent",5,3e5).allowed){A("Too many delete requests. Please wait before deleting again.",!0);return}if(confirm("Are you sure you want to delete this student? This action cannot be undone."))try{await s(N),A("✅ Student deleted.");const O=r.value.findIndex(G=>G.id===N);O!==-1&&r.value.splice(O,1),D()}catch(O){A("❌ Delete failed.",!0),console.error("Delete error:",O)}},I=async()=>{if(!Rs("deleteAllStudents",1,36e5).allowed){A("Delete all operation rate limited. Please wait before trying again.",!0);return}const M=`Are you sure you want to delete ALL ${r.value.length} students? 

This action cannot be undone and will permanently remove all student data.

Type "DELETE ALL STUDENTS" to confirm:`;if(prompt(M)!=="DELETE ALL STUDENTS"){A("Delete all operation cancelled.",!1);return}try{A("Deleting all students...");const G=Ly(e);let z=0;for(const j of r.value)G.delete(Ze(e,"students",j.id)),z++,z>=500&&(await G.commit(),z=0);z>0&&await G.commit(),r.value=[],u.value=[],A("✅ All students deleted.")}catch(G){A("❌ Failed to delete all students.",!0),console.error("Delete all error:",G)}},C=N=>{if(!N)return"N/A";try{if(N&&typeof N.toDate=="function")return N.toDate().toLocaleDateString();const M=new Date(N);return isNaN(M.getTime())?"Invalid Date":M.toLocaleDateString()}catch{return"Invalid Date"}},F=N=>{var M;return((M=N.app)==null?void 0:M.staffIds)&&Array.isArray(N.app.staffIds)&&N.app.staffIds.length>0},W=N=>F(N)?`Staff ID Array present (${N.app.staffIds.length} staff members)`:"Staff ID Array missing or empty",P=()=>{f.value<v.value&&f.value++},R=()=>{f.value>1&&f.value--};return Gt(async()=>{try{await Promise.all([n(),a(),l()]),u.value=r.value,console.log("🚀 ADMIN DEBUG - Case managers loaded:",i.value.length)}catch(N){A("Failed to load data.",!0),console.error("Load data error:",N)}}),ja(()=>{E&&clearTimeout(E)}),(N,M)=>(L(),B("div",Tz,[M[8]||(M[8]=d("h2",null,"Edit Students",-1)),d("div",wz,[Ne(d("input",{type:"text","onUpdate:modelValue":M[0]||(M[0]=O=>c.value=O),onInput:b,placeholder:"Search by name",class:"admin-search-input"},null,544),[[ft,c.value]]),q(o)?(L(),B("button",{key:0,onClick:I,class:"delete-all-btn"},[Pe(q(qo),{size:16}),M[1]||(M[1]=we(" Delete All Students "))])):_e("",!0)]),g.value?(L(),B("div",{key:0,class:Xe(["admin-status-msg",{error:y.value}])},Z(g.value),3)):_e("",!0),d("table",Cz,[M[5]||(M[5]=d("thead",null,[d("tr",null,[d("th",null,"SSID"),d("th",{style:{display:"none"}},"Student ID"),d("th",null,"First Name"),d("th",null,"Last Name"),d("th",null,"Grade"),d("th",null,"Plan"),d("th",null,"Case Manager"),d("th",{title:"Staff ID Array present"},"staffIdArr"),d("th",null,"Date Added"),d("th",{style:{"text-align":"center"}},"Actions")])],-1)),d("tbody",null,[_.value.length?_e("",!0):(L(),B("tr",Iz,M[2]||(M[2]=[d("td",{colspan:"10"},"No students found.",-1)]))),(L(!0),B(De,null,$e(_.value,O=>(L(),B("tr",{key:O.id,class:Xe({"active-row":h.value===O.id}),"data-id":O.id},[d("td",null,Z(q(it)(O,"ssid")||O.id),1),d("td",Dz,Z(O.id),1),d("td",null,[d("input",{class:"editable-input","data-field":"firstName",value:q(it)(O,"firstName")||"",disabled:h.value!==O.id,onInput:G=>x(O.id,"firstName",G.target.value)},null,40,Pz)]),d("td",null,[d("input",{class:"editable-input","data-field":"lastName",value:q(it)(O,"lastName")||"",disabled:h.value!==O.id,onInput:G=>x(O.id,"lastName",G.target.value)},null,40,Rz)]),d("td",null,[d("input",{class:"editable-input","data-field":"grade",value:q(it)(O,"grade")||"",disabled:h.value!==O.id,onInput:G=>x(O.id,"grade",G.target.value)},null,40,Fz)]),d("td",null,[d("select",{class:"editable-select","data-field":"plan",value:q(it)(O,"plan")||"",disabled:h.value!==O.id,onChange:G=>x(O.id,"plan",G.target.value)},M[3]||(M[3]=[d("option",{value:""},"Select Plan",-1),d("option",{value:"IEP"},"IEP",-1),d("option",{value:"504"},"504",-1)]),40,Nz)]),d("td",null,[d("select",{class:"editable-select","data-field":"caseManagerId",value:q(it)(O,"caseManagerId")||"",disabled:h.value!==O.id,onChange:G=>x(O.id,"caseManagerId",G.target.value)},[M[4]||(M[4]=d("option",{value:""},"-- Select Case Manager --",-1)),(L(!0),B(De,null,$e(q(i),G=>(L(),B("option",{key:G.id,value:G.id},Z(G.name||G.email||G.id),9,Mz))),128))],40,Oz)]),d("td",{class:"staff-id-status",title:W(O)},[d("span",{class:Xe(["status-icon",F(O)?"present":"missing"])},Z(F(O)?"✓":"✗"),3)],8,Lz),d("td",null,Z(C(O.created_at)),1),d("td",Bz,[h.value===O.id?(L(),B(De,{key:0},[d("button",{onClick:G=>m(O.id),class:"admin-action-btn save",title:"Save"},[Pe(q(iI),{size:16})],8,Uz),d("button",{onClick:T,class:"admin-action-btn cancel",title:"Cancel"},[Pe(q(dI),{size:16})]),d("button",{onClick:G=>S(O.id),class:"admin-action-btn delete red",title:"Delete Student"},[Pe(q(qo),{size:16})],8,$z)],64)):(L(),B("button",{key:1,onClick:G=>k(O.id),class:"admin-action-btn edit",title:"Edit"},[Pe(q(Qy),{size:16})],8,Vz))])],10,kz))),128))])]),d("div",Hz,[d("button",{onClick:R,disabled:f.value===1,class:"admin-btn"},[Pe(q(nI),{size:16}),M[6]||(M[6]=we(" Prev "))],8,jz),d("span",null,"Page "+Z(f.value)+" of "+Z(v.value),1),d("button",{onClick:P,disabled:f.value===v.value,class:"admin-btn"},[M[7]||(M[7]=we(" Next ")),Pe(q(rI),{size:16})],8,Gz)])]))}},zz=St(Wz,[["__scopeId","data-v-7d623798"]]),Kz={class:"bulk-importer"},qz={key:0,class:"step-container"},Xz={class:"file-upload-section"},Yz={class:"file-input-wrapper"},Qz={for:"csv-file",class:"file-label"},Jz={class:"file-text"},Zz={key:0,class:"error-message"},eK={key:1,class:"file-info"},tK={key:0},rK={class:"step-actions"},nK=["disabled"],sK={key:1,class:"step-container"},aK={class:"field-mapping-section"},iK={class:"mapping-grid"},oK={class:"csv-column"},lK={class:"app-field"},cK=["onUpdate:modelValue"],uK={class:"sample-data"},dK={key:0,class:"validation-errors"},fK={class:"step-actions"},hK=["disabled"],pK={key:2,class:"step-container"},mK={class:"preview-section"},gK={class:"preview-stats"},vK={class:"stat-item"},yK={class:"stat-value"},xK={class:"stat-item"},EK={class:"stat-value valid"},_K={class:"stat-item"},bK={class:"stat-value invalid"},SK={class:"preview-table-container"},AK={class:"preview-table"},TK={key:0,class:"error-list"},wK={key:1,class:"no-errors"},CK={class:"import-options"},IK={class:"options-grid"},kK={class:"option-item"},DK={class:"option-item"},PK={class:"option-item"},RK={class:"step-actions"},FK=["disabled"],NK={key:3,class:"step-container"},OK={class:"results-section"},MK={class:"results-stats"},LK={class:"stat-item success"},BK={class:"stat-value"},UK={class:"stat-item error"},$K={class:"stat-value"},VK={class:"stat-item"},HK={class:"stat-value"},jK={key:0,class:"import-errors"},GK={class:"results-actions"},WK={key:4,class:"loading-overlay"},zK={class:"loading-content"},KK={class:"progress-bar"},qK={__name:"StudentBulkImporter",emits:["close","imported"],setup(t,{emit:e}){const r=e,{users:n,fetchUsers:s}=ba(),i=se(1),a=se(""),o=se(""),l=se([]),c=se([]),u=se({}),f=se(""),h=se([]),p=se([]),g=se("valid-only"),y=se(!1),E=se(!1),b=se(0),_=se({successful:0,failed:0,errors:[],processingTime:0}),v=se(null),A=Se(()=>{const J=["app.studentData.firstName","app.studentData.lastName","app.studentData.grade"],Q=Object.values(u.value).filter(ee=>ee),ve=Q.includes("app.studentData.ssid");return J.every(ee=>Q.includes(ee))&&ve}),D=Se(()=>p.value.filter(J=>J.errors.length===0)),k=Se(()=>p.value.filter(J=>J.errors.length>0));Gt(async()=>{console.log("🚀 StudentBulkImporter component mounted!");try{await s(),console.log("✅ Users loaded successfully:",Object.keys(n.value).length,"users"),console.log("First few users:",Object.values(n.value).slice(0,3).map(J=>({id:J.id,name:J.name,role:J.role})))}catch(J){console.error("❌ Failed to load users:",J)}});const T=async J=>{const Q=J.target.files[0];if(Q){if(!Q.name.toLowerCase().endsWith(".csv")&&Q.type!=="text/csv"){f.value="File must be a CSV file (.csv extension)";return}if(Q.size>10*1024*1024){f.value="File must be smaller than 10MB";return}f.value="",a.value=Q.name,o.value=G(Q.size);try{const ve=await Q.text();x(ve)}catch(ve){f.value="Failed to read CSV file: "+ve.message}}},x=J=>{try{const Q=J.trim().split(`
`);if(Q.length<2)throw new Error("CSV must have at least a header row and one data row");const ve=Q[0].split(",").map(K=>K.trim().replace(/"/g,""));c.value=ve;const ee=[];for(let K=1;K<Q.length;K++){const Y={};let pe="",xe=!1,ae=0;for(let de=0;de<Q[K].length;de++){const Ee=Q[K][de];Ee==='"'?xe=!xe:Ee===","&&!xe?(Y[ve[ae]]=pe.trim().replace(/^"|"$/g,""),pe="",ae++):pe+=Ee}ae<ve.length&&(Y[ve[ae]]=pe.trim().replace(/^"|"$/g,"")),ee.push(Y)}l.value=ee,console.log("Parsed CSV data:",ee.length,"records")}catch(Q){f.value="Failed to parse CSV: "+Q.message}},m=()=>{console.log("🔧 DEBUG: Auto-mapping started"),console.log("🔧 DEBUG: csvHeaders.value:",c.value);const J={SSID:"app.studentData.ssid",FirstName:"app.studentData.firstName",LastName:"app.studentData.lastName",Grade:"app.studentData.grade",Plan:"app.studentData.plan",CaseManagerId:"app.studentData.caseManagerId",ReviewDate:"app.dates.reviewDate",ReevalDate:"app.dates.reevalDate",MeetingDate:"app.dates.meetingDate",Period1Teacher:"app.schedule.periods.1",Period2Teacher:"app.schedule.periods.2",Period3Teacher:"app.schedule.periods.3",Period4Teacher:"app.schedule.periods.4",Period5Teacher:"app.schedule.periods.5",Period6Teacher:"app.schedule.periods.6",Period7Teacher:"app.schedule.periods.7",ClassServices:"app.schedule.classServices",SpeechProvider:"app.providers.speechId",OTProvider:"app.providers.otId",PTProvider:"app.providers.ptId",ATProvider:"app.providers.atId",Audiologist:"app.providers.audId",BISProvider:"app.providers.bisId",DHHProvider:"app.providers.dhhId",HNProvider:"app.providers.hnId",MHProvider:"app.providers.mhId",OMProvider:"app.providers.omId",SCProvider:"app.providers.scId",SWProvider:"app.providers.swId",TRProvider:"app.providers.trId",VIProvider:"app.providers.viId",Flag1:"app.flags.flag1",Flag2:"app.flags.flag2",BIPPdfUrl:"app.documents.bipPdfUrl",AtAGlancePdfUrl:"app.documents.ataglancePdfUrl",Assessment:"app.accommodations.assessment",Instruction:"app.accommodations.instruction"};console.log("🔧 DEBUG: commonMappings keys:",Object.keys(J));let Q=0;c.value.forEach(ve=>{J[ve]?(u.value[ve]=J[ve],Q++,console.log(`🔧 DEBUG: Mapped ${ve} -> ${J[ve]}`)):console.log(`🔧 DEBUG: No mapping for header: "${ve}"`)}),console.log(`🔧 DEBUG: Auto-mapping complete. Mapped ${Q} fields.`),console.log("🔧 DEBUG: fieldMapping.value:",u.value)},S=()=>{u.value={}},I=J=>{const Q=l.value[0];if(!Q)return"";const ve=Q[J];return ve?J==="ClassServices"&&ve.includes(",")?`"${ve}"`:ve:""},C=()=>{h.value=[];const J=["app.studentData.firstName","app.studentData.lastName","app.studentData.grade"],Q=Object.values(u.value).filter(K=>K),ve=Q.includes("app.studentData.ssid");J.forEach(K=>{if(!Q.includes(K)){const Y=K.split(".").pop();h.value.push(`Required field "${Y}" is not mapped`)}}),ve||h.value.push("SSID (State Student ID) must be mapped to app.studentData.ssid");const ee=Q.filter((K,Y)=>Q.indexOf(K)!==Y);ee.length>0&&h.value.push(`Duplicate field mappings: ${ee.join(", ")}`)},F=()=>{p.value=l.value.map(J=>{const Q=W(J),ve=R(Q);return console.log("Row mapping:",{original:J,mapped:Q,errors:ve}),{data:Q,errors:ve}})},W=J=>{const Q={app:{studentData:{},dates:{},providers:{},accommodations:{},flags:{},schedule:{periods:{},classServices:[]},documents:{}}};return Object.entries(u.value).forEach(([ve,ee])=>{if(!ee||!J[ve])return;let K=J[ve].trim();if(!K)return;if(ee==="app.schedule.classServices"){K.startsWith('"')&&K.endsWith('"')&&(K=K.slice(1,-1)),Q.app.schedule.classServices=K.split(",").map(xe=>xe.trim()).filter(Boolean);return}if(ee.startsWith("app.schedule.periods.")){const xe=ee.split(".").pop(),ae=K.trim();if(ae){const de=V(ae);console.log(`Mapping Period ${xe} teacher:`,ae,"→",de),Q.app.schedule.periods[xe]=de}return}if(ee.startsWith("app.providers.")){const xe=ee.split(".").pop(),ae=K.trim();if(ae){const de=te(ae);console.log(`Mapping ${xe} provider:`,ae,"→",de),Q.app.providers[xe]=de}return}if(ee==="app.accommodations.assessment"||ee==="app.accommodations.instruction"){const xe=ee.split(".").pop();Q.app.accommodations[xe]=K;return}if(ee.startsWith("app.flags.")){const xe=ee.split(".").pop();Q.app.flags[xe]=["true","1","yes","y"].includes(K.toLowerCase());return}if(ee.includes("Date")){const[xe,ae,de]=ee.split(".");Q[xe][ae]||(Q[xe][ae]={}),Q[xe][ae][de]=M(K);return}const Y=ee.split(".");let pe=Q;for(let xe=0;xe<Y.length-1;xe++){const ae=Y[xe];pe[ae]||(pe[ae]={}),pe=pe[ae]}pe[Y[Y.length-1]]=K}),Q},P=J=>{const Q=Object.values(n.value).find(ve=>ve.id===J||ve.name===J||ve.email===J||ve.aeriesId===J);return console.log("Mapping case manager:",J,"to Firebase ID:",Q==null?void 0:Q.id),Q?Q.id:J},R=J=>{var ee,K,Y,pe,xe,ae,de,Ee,he,Ce,Te,Ge,Ie,Ve,Ue,ze,Ke,ue;const Q=[],ve=J.ssid||((K=(ee=J.app)==null?void 0:ee.studentData)==null?void 0:K.ssid);return ve||Q.push("SSID is required (either top-level or in app.studentData)"),(pe=(Y=J.app)==null?void 0:Y.studentData)!=null&&pe.firstName||Q.push("First name is required"),(ae=(xe=J.app)==null?void 0:xe.studentData)!=null&&ae.lastName||Q.push("Last name is required"),(Ee=(de=J.app)==null?void 0:de.studentData)!=null&&Ee.grade||Q.push("Grade is required"),ve&&!/^\d{9,10}$/.test(ve)&&Q.push("SSID must be 9-10 digits"),(Ce=(he=J.app)==null?void 0:he.studentData)!=null&&Ce.grade&&!["K","1","2","3","4","5","6","7","8","9","10","11","12"].includes(J.app.studentData.grade)&&Q.push("Grade must be K-12"),(Ge=(Te=J.app)==null?void 0:Te.studentData)!=null&&Ge.plan&&!["IEP","504"].includes(J.app.studentData.plan)&&Q.push("Plan must be IEP or 504"),(Ve=(Ie=J.app)==null?void 0:Ie.dates)!=null&&Ve.reviewDate&&!N(J.app.dates.reviewDate)&&Q.push("Invalid review date format (use YYYY-MM-DD)"),(ze=(Ue=J.app)==null?void 0:Ue.dates)!=null&&ze.reevalDate&&!N(J.app.dates.reevalDate)&&Q.push("Invalid reevaluation date format (use YYYY-MM-DD)"),(ue=(Ke=J.app)==null?void 0:Ke.dates)!=null&&ue.meetingDate&&!N(J.app.dates.meetingDate)&&Q.push("Invalid meeting date format (use YYYY-MM-DD)"),Q},N=J=>{if(!J)return!0;const Q=new Date(J);return!isNaN(Q.getTime())&&J.match(/^\d{4}-\d{2}-\d{2}$/)},M=J=>{if(!J)return"";try{const Q=new Date(J);return isNaN(Q.getTime())?"":Q.toISOString().split("T")[0]}catch{return""}},O=J=>{var ee,K,Y,pe;const Q=((K=(ee=J.app)==null?void 0:ee.studentData)==null?void 0:K.firstName)||"",ve=((pe=(Y=J.app)==null?void 0:Y.studentData)==null?void 0:pe.lastName)||"";return`${Q} ${ve}`.trim()||"Missing Name"},G=J=>{if(J===0)return"0 Bytes";const Q=1024,ve=["Bytes","KB","MB","GB"],ee=Math.floor(Math.log(J)/Math.log(Q));return parseFloat((J/Math.pow(Q,ee)).toFixed(2))+" "+ve[ee]},z=()=>{if(i.value===2){if(C(),h.value.length>0)return;F()}i.value++},j=()=>{i.value--},H=async()=>{E.value=!0,b.value=0;const J=Date.now(),Q=g.value==="valid-only"?D.value:p.value;let ve=0,ee=0;const K=[];try{for(let Y=0;Y<Q.length;Y++){const pe=Q[Y];try{await ne(pe.data),ve++}catch(xe){ee++,K.push(`Row ${Y+1}: ${xe.message}`)}b.value=Math.round((Y+1)/Q.length*100)}_.value={successful:ve,failed:ee,errors:K,processingTime:Date.now()-J},i.value=4,r("imported",{successful:ve,failed:ee})}catch(Y){console.error("Import failed:",Y),K.push("Import process failed: "+Y.message),_.value={successful:ve,failed:ee,errors:K,processingTime:Date.now()-J},i.value=4}finally{E.value=!1}},V=J=>{if(!J)return"";console.log("🔍 Mapping teacher ID:",J),console.log("📚 Available users:",Object.values(n.value).map(ee=>({name:ee.name,aeriesId:ee.aeriesId,id:ee.id})));const Q=Object.values(n.value).find(ee=>{const K=String(ee.aeriesId)===String(J);return K&&console.log("✅ Found exact Aeries ID match:",{teacherId:J,user:{name:ee.name,aeriesId:ee.aeriesId,id:ee.id}}),K});if(Q)return console.log("✅ Using Aeries ID match:",J,"→",Q.id,"(",Q.name,")"),Q.id;const ve=Object.values(n.value).find(ee=>ee.id===J);return ve?(console.log("✅ Using Firebase ID match:",J,"→",ve.id,"(",ve.name,")"),ve.id):(console.warn("❌ No user found for teacher ID:",J),J)},te=J=>{if(!J)return"";console.log("🔍 Mapping provider ID:",J),console.log("📚 Available users:",Object.values(n.value).map(ee=>({name:ee.name,aeriesId:ee.aeriesId,id:ee.id})));const Q=Object.values(n.value).find(ee=>{const K=String(ee.aeriesId)===String(J);return K&&console.log("✅ Found exact Aeries ID match:",{providerId:J,user:{name:ee.name,aeriesId:ee.aeriesId,id:ee.id}}),K});if(Q)return console.log("✅ Using Aeries ID match:",J,"→",Q.id,"(",Q.name,")"),Q.id;const ve=Object.values(n.value).find(ee=>ee.id===J);return ve?(console.log("✅ Using Firebase ID match:",J,"→",ve.id,"(",ve.name,")"),ve.id):(console.warn("❌ No user found for provider ID:",J),J)},oe=J=>{try{return J.app&&J.app.studentData&&J.app.studentData.ssid&&J.app.studentData.firstName&&J.app.studentData.lastName&&J.app.studentData.grade&&J.app.schedule&&Array.isArray(J.app.schedule.classServices)}catch{return!1}},ne=async J=>{try{const Q=J.app.studentData.ssid,ve=At(qe,"students"),ee=cr(ve,Ur("app.studentData.ssid","==",Q)),K=await zt(ee);if(!K.empty&&!y.value)throw new Error(`Student with SSID ${Q} already exists`);const Y={createdAt:Dn(),updatedAt:Dn(),app:{studentData:{firstName:J.app.studentData.firstName||"",lastName:J.app.studentData.lastName||"",grade:J.app.studentData.grade||"",plan:J.app.studentData.plan||"",caseManagerId:P(J.app.studentData.caseManagerId)||"",ssid:Q},dates:{reviewDate:J.app.dates.reviewDate||"",reevalDate:J.app.dates.reevalDate||"",meetingDate:J.app.dates.meetingDate||""},schedule:{periods:J.app.schedule.periods||{1:"",2:"",3:"",4:"",5:"",6:"",7:""},classServices:Array.isArray(J.app.schedule.classServices)?J.app.schedule.classServices:[]},providers:J.app.providers||{speechId:"",otId:"",ptId:"",atId:"",audId:"",bisId:"",dhhId:"",hnId:"",mhId:"",omId:"",scId:"",swId:"",trId:"",viId:""},accommodations:{assessment:J.app.accommodations.assessment||"",instruction:J.app.accommodations.instruction||""},flags:{flag1:!!J.app.flags.flag1,flag2:!!J.app.flags.flag2},documents:{bipPdfUrl:J.app.documents.bipPdfUrl||null,ataglancePdfUrl:J.app.documents.ataglancePdfUrl||null}}};if(console.log("Saving student data:",{ssid:Y.app.studentData.ssid,schedule:Y.app.schedule.periods,providers:Y.app.providers}),!oe(Y))throw new Error("Invalid student data structure");if(!K.empty&&y.value){const pe=K.docs[0];await jt(Ze(qe,"students",pe.id),Y,{merge:!0})}else{const pe=Ze(At(qe,"students"));await jt(pe,Y)}}catch(Q){throw console.error("Error importing student:",Q),Q}},le=()=>{i.value=1,a.value="",o.value="",l.value=[],c.value=[],u.value={},f.value="",h.value=[],p.value=[],_.value={successful:0,failed:0,errors:[],processingTime:0},v.value&&(v.value.value="")};return(J,Q)=>(L(),B("div",Kz,[Q[30]||(Q[30]=d("div",{style:{background:"#e8f5e8",border:"2px solid #4caf50",padding:"10px","margin-bottom":"20px","border-radius":"4px","text-align":"center"}},[d("strong",null,"✅ StudentBulkImporter Component Loaded Successfully")],-1)),Q[31]||(Q[31]=d("div",{class:"importer-header"},[d("h2",null,"Add Students - Bulk Import"),d("p",{class:"description"}," Import multiple students from a CSV file. The system will map CSV fields to the app's database structure and allow you to preview and validate the data before importing. ")],-1)),i.value===1?(L(),B("div",qz,[Q[8]||(Q[8]=d("div",{class:"step-header"},[d("h3",null,"Step 1: Upload CSV File"),d("p",null,"Select a CSV file containing student data. The first row should contain column headers.")],-1)),d("div",Xz,[d("div",Yz,[d("input",{type:"file",ref_key:"fileInput",ref:v,onChange:T,accept:".csv",class:"file-input",id:"csv-file"},null,544),d("label",Qz,[Q[4]||(Q[4]=d("span",{class:"file-icon"},"📁",-1)),d("span",Jz,Z(a.value||"Choose CSV File"),1)])]),f.value?(L(),B("div",Zz,Z(f.value),1)):_e("",!0),a.value?(L(),B("div",eK,[d("p",null,[Q[5]||(Q[5]=d("strong",null,"File:",-1)),we(" "+Z(a.value),1)]),d("p",null,[Q[6]||(Q[6]=d("strong",null,"Size:",-1)),we(" "+Z(o.value),1)]),l.value.length>0?(L(),B("p",tK,[Q[7]||(Q[7]=d("strong",null,"Records:",-1)),we(" "+Z(l.value.length),1)])):_e("",!0)])):_e("",!0)]),Q[9]||(Q[9]=Rn('<div class="sample-format" data-v-4b3a12b7><h4 data-v-4b3a12b7>Expected CSV Format:</h4><div class="format-example" data-v-4b3a12b7><code data-v-4b3a12b7> SSID,FirstName,LastName,Grade,Plan,CaseManagerId,ReviewDate,ReevalDate,MeetingDate,Period1Teacher,Period2Teacher,Period3Teacher,Period4Teacher,Period5Teacher,Period6Teacher,SHTeacher,ClassServices,SpeechProvider,OTProvider,PTProvider,ATProvider,Audiologist,BISProvider,DHHProvider,HNProvider,MHProvider,OMProvider,SCProvider,SWProvider,TRProvider,VIProvider,Flag1,Flag2,BIPPdfUrl,AtAGlancePdfUrl,Assessment,Instruction<br data-v-4b3a12b7> 123456789,John,Doe,9,IEP,user003,2025-07-15,2025-12-15,2025-07-10,user007,user008,user009,user010,user011,user012,user013,&quot;SDC: English,RSP: Math&quot;,user020,user021,user022,user023,user024,user025,user026,user027,user028,user029,user030,user031,user032,user033,true,false,https://example.com/bip.pdf,https://example.com/ataglance.pdf,&quot;Allow for test re-takes if the score is below average...&quot;,Divide larger projects or assignments into manageable parts... </code></div><p class="format-note" data-v-4b3a12b7><strong data-v-4b3a12b7>Required fields:</strong> SSID, FirstName, LastName, Grade<br data-v-4b3a12b7><strong data-v-4b3a12b7>App Structure:</strong> All fields map to the app data structure in your database<br data-v-4b3a12b7><strong data-v-4b3a12b7>Schedule fields:</strong> Period1Teacher through Period6Teacher and SHTeacher (Firebase user IDs like user001, user002, etc.)<br data-v-4b3a12b7><strong data-v-4b3a12b7>Provider fields:</strong> All service provider fields (Firebase user IDs like user020, user021, etc.)<br data-v-4b3a12b7><strong data-v-4b3a12b7>Class Services:</strong> Comma-separated list (e.g., &quot;SDC: English,RSP: Math,Co-teach: Science&quot;)<br data-v-4b3a12b7><strong data-v-4b3a12b7>Dates:</strong> Use YYYY-MM-DD format (e.g., 2025-07-15)<br data-v-4b3a12b7><strong data-v-4b3a12b7>Flags:</strong> Use true/false or 1/0<br data-v-4b3a12b7><strong data-v-4b3a12b7>Accommodations:</strong> Text fields for assessment and instruction<br data-v-4b3a12b7><strong data-v-4b3a12b7>Note:</strong> Teacher and provider IDs will be automatically mapped from names, emails, or Aeries IDs if user lookup is available </p></div>',1)),d("div",rK,[d("button",{onClick:z,disabled:!l.value.length,class:"btn btn-primary"}," Next: Map Fields ",8,nK)])])):_e("",!0),i.value===2?(L(),B("div",sK,[Q[15]||(Q[15]=d("div",{class:"step-header"},[d("h3",null,"Step 2: Map CSV Fields"),d("p",null,"Map your CSV columns to the app's database fields. Required fields are marked with *")],-1)),d("div",aK,[d("div",iK,[Q[12]||(Q[12]=Rn('<div class="mapping-header" data-v-4b3a12b7><div class="csv-column" data-v-4b3a12b7>CSV Column</div><div class="arrow" data-v-4b3a12b7>→</div><div class="app-field" data-v-4b3a12b7>App Database Field</div><div class="sample-data" data-v-4b3a12b7>Sample Data</div></div>',1)),(L(!0),B(De,null,$e(c.value,(ve,ee)=>(L(),B("div",{key:ee,class:"mapping-row"},[d("div",oK,[d("strong",null,Z(ve),1)]),Q[11]||(Q[11]=d("div",{class:"arrow"},"→",-1)),d("div",lK,[Ne(d("select",{"onUpdate:modelValue":K=>u.value[ve]=K,class:"field-select"},Q[10]||(Q[10]=[Rn('<option value="" data-v-4b3a12b7>-- Skip this field --</option><optgroup label="Required Fields" data-v-4b3a12b7><option value="app.studentData.ssid" data-v-4b3a12b7>SSID (State Student ID) *</option><option value="app.studentData.firstName" data-v-4b3a12b7>First Name *</option><option value="app.studentData.lastName" data-v-4b3a12b7>Last Name *</option><option value="app.studentData.grade" data-v-4b3a12b7>Grade *</option></optgroup><optgroup label="Student Information" data-v-4b3a12b7><option value="app.studentData.plan" data-v-4b3a12b7>Plan Type (IEP/504/RTI/None)</option><option value="app.studentData.caseManagerId" data-v-4b3a12b7>Case Manager ID</option></optgroup><optgroup label="Important Dates" data-v-4b3a12b7><option value="app.dates.reviewDate" data-v-4b3a12b7>Review Date</option><option value="app.dates.reevalDate" data-v-4b3a12b7>Reevaluation Date</option><option value="app.dates.meetingDate" data-v-4b3a12b7>Meeting Date</option></optgroup><optgroup label="Class Schedule" data-v-4b3a12b7><option value="app.schedule.periods.1" data-v-4b3a12b7>Period 1 Teacher ID</option><option value="app.schedule.periods.2" data-v-4b3a12b7>Period 2 Teacher ID</option><option value="app.schedule.periods.3" data-v-4b3a12b7>Period 3 Teacher ID</option><option value="app.schedule.periods.4" data-v-4b3a12b7>Period 4 Teacher ID</option><option value="app.schedule.periods.5" data-v-4b3a12b7>Period 5 Teacher ID</option><option value="app.schedule.periods.6" data-v-4b3a12b7>Period 6 Teacher ID</option><option value="app.schedule.periods.7" data-v-4b3a12b7>Period 7 Teacher ID</option><option value="app.schedule.classServices" data-v-4b3a12b7>Class Services (Comma-separated)</option></optgroup><optgroup label="Service Providers" data-v-4b3a12b7><option value="app.providers.speechId" data-v-4b3a12b7>Speech Provider ID</option><option value="app.providers.otId" data-v-4b3a12b7>OT Provider ID</option><option value="app.providers.ptId" data-v-4b3a12b7>PT Provider ID</option><option value="app.providers.atId" data-v-4b3a12b7>AT Provider ID</option><option value="app.providers.audId" data-v-4b3a12b7>Audiologist ID</option><option value="app.providers.bisId" data-v-4b3a12b7>BIS Provider ID</option><option value="app.providers.dhhId" data-v-4b3a12b7>DHH Provider ID</option><option value="app.providers.hnId" data-v-4b3a12b7>HN Provider ID</option><option value="app.providers.mhId" data-v-4b3a12b7>MH Provider ID</option><option value="app.providers.omId" data-v-4b3a12b7>OM Provider ID</option><option value="app.providers.scId" data-v-4b3a12b7>SC Provider ID</option><option value="app.providers.swId" data-v-4b3a12b7>SW Provider ID</option><option value="app.providers.trId" data-v-4b3a12b7>TR Provider ID</option><option value="app.providers.viId" data-v-4b3a12b7>VI Provider ID</option></optgroup><optgroup label="Flags" data-v-4b3a12b7><option value="app.flags.flag1" data-v-4b3a12b7>Flag 1 (Boolean)</option><option value="app.flags.flag2" data-v-4b3a12b7>Flag 2 (Boolean)</option></optgroup><optgroup label="Documents" data-v-4b3a12b7><option value="app.documents.bipPdfUrl" data-v-4b3a12b7>BIP PDF URL</option><option value="app.documents.ataglancePdfUrl" data-v-4b3a12b7>At-A-Glance PDF URL</option></optgroup><optgroup label="Accommodations" data-v-4b3a12b7><option value="app.accommodations.assessment" data-v-4b3a12b7>Assessment Accommodations</option><option value="app.accommodations.instruction" data-v-4b3a12b7>Instructional Accommodations</option></optgroup>',9)]),8,cK),[[sr,u.value[ve]]])]),d("div",uK,[d("code",null,Z(I(ve)),1)])]))),128))]),d("div",{class:"auto-mapping-section"},[Q[13]||(Q[13]=d("h4",null,"Quick Mapping Options:",-1)),d("div",{class:"quick-actions"},[d("button",{onClick:m,class:"btn btn-secondary"}," Auto-map Common Fields "),d("button",{onClick:S,class:"btn btn-secondary"}," Clear All Mappings ")])]),h.value.length>0?(L(),B("div",dK,[Q[14]||(Q[14]=d("h4",null,"Mapping Issues:",-1)),d("ul",null,[(L(!0),B(De,null,$e(h.value,ve=>(L(),B("li",{key:ve,class:"error-item"},Z(ve),1))),128))])])):_e("",!0)]),d("div",fK,[d("button",{onClick:j,class:"btn btn-secondary"}," Back "),d("button",{onClick:z,disabled:!A.value,class:"btn btn-primary"}," Next: Preview Data ",8,hK)])])):_e("",!0),i.value===3?(L(),B("div",pK,[Q[23]||(Q[23]=d("div",{class:"step-header"},[d("h3",null,"Step 3: Preview and Validate"),d("p",null,"Review the mapped data before importing. Check for any validation errors.")],-1)),d("div",mK,[d("div",gK,[d("div",vK,[Q[16]||(Q[16]=d("span",{class:"stat-label"},"Total Records:",-1)),d("span",yK,Z(l.value.length),1)]),d("div",xK,[Q[17]||(Q[17]=d("span",{class:"stat-label"},"Valid Records:",-1)),d("span",EK,Z(D.value.length),1)]),d("div",_K,[Q[18]||(Q[18]=d("span",{class:"stat-label"},"Invalid Records:",-1)),d("span",bK,Z(k.value.length),1)])]),d("div",SK,[d("table",AK,[Q[19]||(Q[19]=d("thead",null,[d("tr",null,[d("th",null,"Status"),d("th",null,"SSID"),d("th",null,"Name"),d("th",null,"Grade"),d("th",null,"Plan"),d("th",null,"Case Manager"),d("th",null,"Issues")])],-1)),d("tbody",null,[(L(!0),B(De,null,$e(p.value,(ve,ee)=>{var K,Y,pe,xe,ae,de,Ee,he;return L(),B("tr",{key:ee,class:Xe({"invalid-row":ve.errors.length>0})},[d("td",null,[d("span",{class:Xe(["status-badge",ve.errors.length>0?"error":"valid"])},Z(ve.errors.length>0?"Error":"Valid"),3)]),d("td",null,Z(ve.data.ssid||((Y=(K=ve.data.app)==null?void 0:K.studentData)==null?void 0:Y.ssid)||"Missing"),1),d("td",null,Z(O(ve.data)),1),d("td",null,Z(((xe=(pe=ve.data.app)==null?void 0:pe.studentData)==null?void 0:xe.grade)||"Missing"),1),d("td",null,Z(((de=(ae=ve.data.app)==null?void 0:ae.studentData)==null?void 0:de.plan)||"Not set"),1),d("td",null,Z(((he=(Ee=ve.data.app)==null?void 0:Ee.studentData)==null?void 0:he.caseManagerId)||"Not set"),1),d("td",null,[ve.errors.length>0?(L(),B("ul",TK,[(L(!0),B(De,null,$e(ve.errors,Ce=>(L(),B("li",{key:Ce,class:"error-item"},Z(Ce),1))),128))])):(L(),B("span",wK,"No issues"))])],2)}),128))])])]),d("div",CK,[Q[22]||(Q[22]=d("h4",null,"Import Options:",-1)),d("div",IK,[d("label",kK,[Ne(d("input",{type:"radio","onUpdate:modelValue":Q[0]||(Q[0]=ve=>g.value=ve),value:"valid-only"},null,512),[[Ss,g.value]]),d("span",null,"Import only valid records ("+Z(D.value.length)+" records)",1)]),d("label",DK,[Ne(d("input",{type:"radio","onUpdate:modelValue":Q[1]||(Q[1]=ve=>g.value=ve),value:"all"},null,512),[[Ss,g.value]]),Q[20]||(Q[20]=d("span",null,"Import all records (may cause errors for invalid data)",-1))]),d("label",PK,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":Q[2]||(Q[2]=ve=>y.value=ve)},null,512),[[bt,y.value]]),Q[21]||(Q[21]=d("span",null,"Update existing students if SSID already exists",-1))])])])]),d("div",RK,[d("button",{onClick:j,class:"btn btn-secondary"}," Back "),d("button",{onClick:H,disabled:E.value||g.value==="valid-only"&&D.value.length===0,class:"btn btn-primary"},Z(E.value?"Importing...":`Import ${g.value==="valid-only"?D.value.length:l.value.length} Students`),9,FK)])])):_e("",!0),i.value===4?(L(),B("div",NK,[Q[28]||(Q[28]=d("div",{class:"step-header"},[d("h3",null,"Step 4: Import Complete"),d("p",null,"Your bulk import has been completed. Review the results below.")],-1)),d("div",OK,[d("div",MK,[d("div",LK,[Q[24]||(Q[24]=d("span",{class:"stat-label"},"Successfully Imported:",-1)),d("span",BK,Z(_.value.successful),1)]),d("div",UK,[Q[25]||(Q[25]=d("span",{class:"stat-label"},"Failed to Import:",-1)),d("span",$K,Z(_.value.failed),1)]),d("div",VK,[Q[26]||(Q[26]=d("span",{class:"stat-label"},"Total Processing Time:",-1)),d("span",HK,Z(_.value.processingTime)+"ms",1)])]),_.value.errors.length>0?(L(),B("div",jK,[Q[27]||(Q[27]=d("h4",null,"Import Errors:",-1)),d("ul",null,[(L(!0),B(De,null,$e(_.value.errors,ve=>(L(),B("li",{key:ve,class:"error-item"},Z(ve),1))),128))])])):_e("",!0),d("div",GK,[d("button",{onClick:le,class:"btn btn-secondary"}," Import More Students "),d("button",{onClick:Q[3]||(Q[3]=ve=>J.$emit("close")),class:"btn btn-primary"}," Close ")])])])):_e("",!0),E.value?(L(),B("div",WK,[d("div",zK,[Q[29]||(Q[29]=d("div",{class:"loading-spinner"},null,-1)),d("p",null,"Importing students... "+Z(b.value)+"%",1),d("div",KK,[d("div",{class:"progress-fill",style:Nr({width:b.value+"%"})},null,4)])])])):_e("",!0)]))}},XK=St(qK,[["__scopeId","data-v-4b3a12b7"]]),YK={class:"permissions-overview"},QK={class:"roles-summary"},JK={class:"role-icon"},ZK={class:"role-info"},eq={class:"role-stats"},tq={class:"stat"},rq={class:"stat-number"},nq={class:"stat"},sq={class:"stat-number"},aq={class:"stat"},iq={class:"stat-number"},oq={class:"permissions-matrix"},lq={class:"matrix-table-container"},cq={class:"matrix-table"},uq=["data-role"],dq={class:"permission-info"},fq={class:"permission-name"},hq={class:"permission-description"},pq={class:"permission-firebase"},mq={class:"admin-panel-access"},gq={class:"access-grid"},vq={class:"access-header"},yq={class:"access-icon"},xq={class:"role-name"},Eq={key:0,class:"access-details"},_q={class:"access-level"},bq={class:"access-description"},Sq={key:1,class:"no-access"},Aq={__name:"PermissionsOverview",setup(t){const e=tI,r=Se(()=>Ko.slice().sort((l,c)=>{var h,p;const u=((h=e[l])==null?void 0:h.length)||0;return(((p=e[c])==null?void 0:p.length)||0)-u})),n={admin:gB,school_admin:cI,staff_view:EB,staff_edit:$v,admin_504:oI,sped_chair:k0,case_manager:uI,teacher:Vv,paraeducator:Q7,service_provider:lI},s=Se(()=>r.value.map(l=>{const c=e[l]||[],u=c.some(y=>y.includes("admin_panel"));let f="No Access",h="No admin panel access";c.includes("admin_panel_full")?(f="Full Access",h="All admin panel features including permissions management"):c.includes("admin_panel_school")?(f="School Access",h="School operations, users, aides, and students"):c.includes("admin_panel_limited")?(f="Limited Access",h="Student management, aide management, and 504-related functions"):c.includes("admin_panel_sped")&&(f="SPED Access",h="SPED program management and aide oversight");let p="Viewer";c.includes(at.EDIT_STUDENT_ALL)?l==="admin"||l==="school_admin"?p="Admin":l==="staff_edit"?p="Editor":(l==="sped_chair"||l==="admin_504")&&(p="Admin/CM"):c.includes(at.EDIT_STUDENT_CM)&&(l==="admin_504"?p="Admin/CM":p="CM");const g=l==="admin_504"?"504 Coordinator":l==="sped_chair"?"SPED Chair":l==="school_admin"?"School Administrator":l==="staff_view"?"Staff Viewer":l==="staff_edit"?"Staff Editor":l==="case_manager"?"Case Manager":l==="service_provider"?"Service Provider":l.charAt(0).toUpperCase()+l.slice(1);return{key:l,name:g,icon:n[l]||Vv,description:x7[l]||`${g} role`,adminAccess:u,adminLevel:f,adminDescription:h,studentAccessLevel:p,permissions:c}})),i=Se(()=>[{key:at.VIEW_USERS,name:"View Users",description:"Can view user accounts and basic information",firebaseRule:"All authenticated users"},{key:at.EDIT_USER,name:"Edit Users",description:"Can modify user accounts and profiles",firebaseRule:"Admin, School Admin, 504 Coordinator, SPED Chair"},{key:at.DELETE_USER,name:"Delete Users",description:"Can remove user accounts",firebaseRule:"Admin, School Admin, 504 Coordinator, SPED Chair"},{key:at.MANAGE_TEACHER_FEEDBACK,name:"Manage Teacher Feedback",description:"Can create and manage teacher feedback forms",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager"},{key:at.MANAGE_IMPORTS,name:"Manage Data Imports",description:"Can import data from SEIS, Aeries, and other sources",firebaseRule:"Admin, School Admin"},{key:at.MANAGE_BACKUPS,name:"Manage Backups",description:"Can create, restore, and manage database backups",firebaseRule:"Admin, School Admin"},{key:at.VIEW_STUDENTS,name:"View Students",description:"Can view student records (role-filtered)",firebaseRule:"All authenticated users"},{key:at.EDIT_STUDENT_CM,name:"Edit Own Caseload",description:"Can modify students on own caseload",firebaseRule:"Case Manager, Service Provider"},{key:at.EDIT_STUDENT_ALL,name:"Edit All Students",description:"Can modify any student record",firebaseRule:"Admin, School Admin, Staff Edit, 504 Coordinator, SPED Chair"},{key:at.ACCESS_ADMIN_PANEL,name:"Admin Panel Access",description:"Can access administrative functions",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator"},{key:at.MANAGE_AIDES,name:"Aide Management",description:"Can manage aide assignments and schedules",firebaseRule:"Admin, School Admin, SPED Chair, 504 Coordinator"},{key:at.MANAGE_SYSTEM_SETTINGS,name:"System Settings",description:"Can modify system-level configuration",firebaseRule:"Admin only"}].sort((c,u)=>{const f=Ko.filter(p=>{var g;return(g=e[p])==null?void 0:g.includes(c.key)}).length;return Ko.filter(p=>{var g;return(g=e[p])==null?void 0:g.includes(u.key)}).length-f})),a=(l,c)=>{var u;return((u=e[l])==null?void 0:u.includes(c))||!1},o=l=>({admin:"Admin",school_admin:"School Admin",staff_view:"Staff View",staff_edit:"Staff Edit",admin_504:"504 Coord",sped_chair:"SPED Chair",case_manager:"Case Mgr",teacher:"Teacher",service_provider:"Service",paraeducator:"Para"})[l]||l;return(l,c)=>(L(),B("div",YK,[c[7]||(c[7]=d("div",{class:"overview-header"},[d("h2",null,"📋 Permissions Overview"),d("p",{class:"overview-description"}," This a summary of the role-based permissions These permissions are hard-coded for consistency and security. ")],-1)),d("div",QK,[(L(!0),B(De,null,$e(s.value,u=>(L(),B("div",{class:"summary-card",key:u.key},[d("div",{class:Xe(["role-header",u.key])},[d("div",JK,[(L(),Jt(T1(u.icon),{class:"w-6 h-6"}))]),d("div",ZK,[d("h3",null,Z(u.name),1),d("p",null,Z(u.description),1)])],2),d("div",eq,[d("div",tq,[d("span",rq,Z(u.permissions.length),1),c[0]||(c[0]=d("span",{class:"stat-label"},"Permissions",-1))]),d("div",nq,[d("span",sq,Z(u.adminAccess?"Yes":"No"),1),c[1]||(c[1]=d("span",{class:"stat-label"},"Admin Panel",-1))]),d("div",aq,[d("span",iq,Z(u.studentAccessLevel),1),c[2]||(c[2]=d("span",{class:"stat-label"},"Student Access",-1))])])]))),128))]),d("div",oq,[c[4]||(c[4]=d("h3",null,"🔐 Detailed Permissions Matrix",-1)),c[5]||(c[5]=d("div",{class:"matrix-note"},[d("strong",null,"Note:"),we(" These permissions are synchronized with Firebase security rules and cannot be modified. They ensure consistent security across your application. ")],-1)),d("div",lq,[d("table",cq,[d("thead",null,[d("tr",null,[c[3]||(c[3]=d("th",{class:"permission-column"},"Permission",-1)),(L(!0),B(De,null,$e(r.value,u=>(L(),B("th",{key:u,class:Xe(`role-header ${u}`),"data-role":o(u)},null,10,uq))),128))])]),d("tbody",null,[(L(!0),B(De,null,$e(i.value,u=>(L(),B("tr",{key:u.key,class:"permission-row"},[d("td",dq,[d("div",fq,Z(u.name),1),d("div",hq,Z(u.description),1),d("div",pq,Z(u.firebaseRule),1)]),(L(!0),B(De,null,$e(r.value,f=>(L(),B("td",{key:f,class:"permission-cell"},[d("span",{class:Xe(["permission-indicator",{granted:a(f,u.key)}])},Z(a(f,u.key)?"✅":"❌"),3)]))),128))]))),128))])])])]),d("div",mq,[c[6]||(c[6]=d("h3",null,"⚙️ Admin Panel Access",-1)),d("div",gq,[(L(!0),B(De,null,$e(s.value,u=>(L(),B("div",{key:u.key,class:Xe(["access-card",{"has-access":u.adminAccess}])},[d("div",vq,[d("span",yq,Z(u.adminAccess?"✅":"❌"),1),d("span",xq,Z(u.name),1)]),u.adminAccess?(L(),B("div",Eq,[d("div",_q,Z(u.adminLevel),1),d("div",bq,Z(u.adminDescription),1)])):(L(),B("div",Sq," No admin panel access "))],2))),128))])]),c[8]||(c[8]=Rn('<div class="firebase-rules" data-v-88586d63><h3 data-v-88586d63>🔥 Firebase Security Rules Summary</h3><div class="rules-grid" data-v-88586d63><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>👥 Users Collection</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin, 504 Coordinator, SPED Chair</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, 504 Coordinator, SPED Chair</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>🎓 Students Collection</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users (role-filtered)</li><li data-v-88586d63><strong data-v-88586d63>Write (All):</strong> Admin, School Admin, Staff Edit, 504 Coordinator, SPED Chair</li><li data-v-88586d63><strong data-v-88586d63>Write (Own Caseload):</strong> Case Manager, Service Provider</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, SPED Chair, 504 Coordinator</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>⚙️ App Settings</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> All authenticated users</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>📝 Audit Logs</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> Admin, School Admin</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> All authenticated users (own actions)</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>📝 Feedback Forms</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read:</strong> Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager</li><li data-v-88586d63><strong data-v-88586d63>Write:</strong> Admin, School Admin, SPED Chair, 504 Coordinator, Case Manager</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin, SPED Chair, 504 Coordinator</li></ul></div><div class="rule-card" data-v-88586d63><h4 data-v-88586d63>💾 Backups</h4><ul data-v-88586d63><li data-v-88586d63><strong data-v-88586d63>Read/Write:</strong> Admin, School Admin</li><li data-v-88586d63><strong data-v-88586d63>Delete:</strong> Admin, School Admin</li></ul></div></div></div>',1))]))}},Tq=St(Aq,[["__scopeId","data-v-88586d63"]]),wq={class:"admin-permissions"},Cq={__name:"AdminPermissions",setup(t){return(e,r)=>(L(),B("div",wq,[Pe(Tq)]))}},Iq=St(Cq,[["__scopeId","data-v-699444ca"]]);var SI={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/(function(t,e){((r,n)=>{t.exports=n()})(Vt,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},s,i=!n.document&&!!n.postMessage,a=n.IS_PAPA_WORKER||!1,o={},l=0,c={};function u(x){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(m){var S=D(m);S.chunkSize=parseInt(S.chunkSize),m.step||m.chunk||(S.chunkSize=null),this._handle=new y(S),(this._handle.streamer=this)._config=S}).call(this,x),this.parseChunk=function(m,S){var I=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<I){let F=this._config.newline;F||(C=this._config.quoteChar||'"',F=this._handle.guessLineEndings(m,C)),m=[...m.split(F).slice(I)].join(F)}this.isFirstChunk&&T(this._config.beforeFirstChunk)&&(C=this._config.beforeFirstChunk(m))!==void 0&&(m=C),this.isFirstChunk=!1,this._halted=!1;var I=this._partialLine+m,C=(this._partialLine="",this._handle.parse(I,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(m=C.meta.cursor,I=(this._finished||(this._partialLine=I.substring(m-this._baseIndex),this._baseIndex=m),C&&C.data&&(this._rowCount+=C.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),a)n.postMessage({results:C,workerId:c.WORKER_ID,finished:I});else if(T(this._config.chunk)&&!S){if(this._config.chunk(C,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=C=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(C.data),this._completeResults.errors=this._completeResults.errors.concat(C.errors),this._completeResults.meta=C.meta),this._completed||!I||!T(this._config.complete)||C&&C.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),I||C&&C.meta.paused||this._nextChunk(),C}this._halted=!0},this._sendError=function(m){T(this._config.error)?this._config.error(m):a&&this._config.error&&n.postMessage({workerId:c.WORKER_ID,error:m,finished:!1})}}function f(x){var m;(x=x||{}).chunkSize||(x.chunkSize=c.RemoteChunkSize),u.call(this,x),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(S){this._input=S,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(m=new XMLHttpRequest,this._config.withCredentials&&(m.withCredentials=this._config.withCredentials),i||(m.onload=k(this._chunkLoaded,this),m.onerror=k(this._chunkError,this)),m.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var S,I=this._config.downloadRequestHeaders;for(S in I)m.setRequestHeader(S,I[S])}var C;this._config.chunkSize&&(C=this._start+this._config.chunkSize-1,m.setRequestHeader("Range","bytes="+this._start+"-"+C));try{m.send(this._config.downloadRequestBody)}catch(F){this._chunkError(F.message)}i&&m.status===0&&this._chunkError()}},this._chunkLoaded=function(){m.readyState===4&&(m.status<200||400<=m.status?this._chunkError():(this._start+=this._config.chunkSize||m.responseText.length,this._finished=!this._config.chunkSize||this._start>=(S=>(S=S.getResponseHeader("Content-Range"))!==null?parseInt(S.substring(S.lastIndexOf("/")+1)):-1)(m),this.parseChunk(m.responseText)))},this._chunkError=function(S){S=m.statusText||S,this._sendError(new Error(S))}}function h(x){(x=x||{}).chunkSize||(x.chunkSize=c.LocalChunkSize),u.call(this,x);var m,S,I=typeof FileReader<"u";this.stream=function(C){this._input=C,S=C.slice||C.webkitSlice||C.mozSlice,I?((m=new FileReader).onload=k(this._chunkLoaded,this),m.onerror=k(this._chunkError,this)):m=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var C=this._input,F=(this._config.chunkSize&&(F=Math.min(this._start+this._config.chunkSize,this._input.size),C=S.call(C,this._start,F)),m.readAsText(C,this._config.encoding));I||this._chunkLoaded({target:{result:F}})},this._chunkLoaded=function(C){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(C.target.result)},this._chunkError=function(){this._sendError(m.error)}}function p(x){var m;u.call(this,x=x||{}),this.stream=function(S){return m=S,this._nextChunk()},this._nextChunk=function(){var S,I;if(!this._finished)return S=this._config.chunkSize,m=S?(I=m.substring(0,S),m.substring(S)):(I=m,""),this._finished=!m,this.parseChunk(I)}}function g(x){u.call(this,x=x||{});var m=[],S=!0,I=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(C){this._input=C,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){I&&m.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),m.length?this.parseChunk(m.shift()):S=!0},this._streamData=k(function(C){try{m.push(typeof C=="string"?C:C.toString(this._config.encoding)),S&&(S=!1,this._checkIsFinished(),this.parseChunk(m.shift()))}catch(F){this._streamError(F)}},this),this._streamError=k(function(C){this._streamCleanUp(),this._sendError(C)},this),this._streamEnd=k(function(){this._streamCleanUp(),I=!0,this._streamData("")},this),this._streamCleanUp=k(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function y(x){var m,S,I,C,F=Math.pow(2,53),W=-F,P=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,R=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,N=this,M=0,O=0,G=!1,z=!1,j=[],H={data:[],errors:[],meta:{}};function V(le){return x.skipEmptyLines==="greedy"?le.join("").trim()==="":le.length===1&&le[0].length===0}function te(){if(H&&I&&(ne("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),I=!1),x.skipEmptyLines&&(H.data=H.data.filter(function(ee){return!V(ee)})),oe()){let ee=function(K,Y){T(x.transformHeader)&&(K=x.transformHeader(K,Y)),j.push(K)};var ve=ee;if(H)if(Array.isArray(H.data[0])){for(var le=0;oe()&&le<H.data.length;le++)H.data[le].forEach(ee);H.data.splice(0,1)}else H.data.forEach(ee)}function J(ee,K){for(var Y=x.header?{}:[],pe=0;pe<ee.length;pe++){var xe=pe,ae=ee[pe],ae=((de,Ee)=>(he=>(x.dynamicTypingFunction&&x.dynamicTyping[he]===void 0&&(x.dynamicTyping[he]=x.dynamicTypingFunction(he)),(x.dynamicTyping[he]||x.dynamicTyping)===!0))(de)?Ee==="true"||Ee==="TRUE"||Ee!=="false"&&Ee!=="FALSE"&&((he=>{if(P.test(he)&&(he=parseFloat(he),W<he&&he<F))return 1})(Ee)?parseFloat(Ee):R.test(Ee)?new Date(Ee):Ee===""?null:Ee):Ee)(xe=x.header?pe>=j.length?"__parsed_extra":j[pe]:xe,ae=x.transform?x.transform(ae,xe):ae);xe==="__parsed_extra"?(Y[xe]=Y[xe]||[],Y[xe].push(ae)):Y[xe]=ae}return x.header&&(pe>j.length?ne("FieldMismatch","TooManyFields","Too many fields: expected "+j.length+" fields but parsed "+pe,O+K):pe<j.length&&ne("FieldMismatch","TooFewFields","Too few fields: expected "+j.length+" fields but parsed "+pe,O+K)),Y}var Q;H&&(x.header||x.dynamicTyping||x.transform)&&(Q=1,!H.data.length||Array.isArray(H.data[0])?(H.data=H.data.map(J),Q=H.data.length):H.data=J(H.data,0),x.header&&H.meta&&(H.meta.fields=j),O+=Q)}function oe(){return x.header&&j.length===0}function ne(le,J,Q,ve){le={type:le,code:J,message:Q},ve!==void 0&&(le.row=ve),H.errors.push(le)}T(x.step)&&(C=x.step,x.step=function(le){H=le,oe()?te():(te(),H.data.length!==0&&(M+=le.data.length,x.preview&&M>x.preview?S.abort():(H.data=H.data[0],C(H,N))))}),this.parse=function(le,J,Q){var ve=x.quoteChar||'"',ve=(x.newline||(x.newline=this.guessLineEndings(le,ve)),I=!1,x.delimiter?T(x.delimiter)&&(x.delimiter=x.delimiter(le),H.meta.delimiter=x.delimiter):((ve=((ee,K,Y,pe,xe)=>{var ae,de,Ee,he;xe=xe||[",","	","|",";",c.RECORD_SEP,c.UNIT_SEP];for(var Ce=0;Ce<xe.length;Ce++){for(var Te,Ge=xe[Ce],Ie=0,Ve=0,Ue=0,ze=(Ee=void 0,new b({comments:pe,delimiter:Ge,newline:K,preview:10}).parse(ee)),Ke=0;Ke<ze.data.length;Ke++)Y&&V(ze.data[Ke])?Ue++:(Te=ze.data[Ke].length,Ve+=Te,Ee===void 0?Ee=Te:0<Te&&(Ie+=Math.abs(Te-Ee),Ee=Te));0<ze.data.length&&(Ve/=ze.data.length-Ue),(de===void 0||Ie<=de)&&(he===void 0||he<Ve)&&1.99<Ve&&(de=Ie,ae=Ge,he=Ve)}return{successful:!!(x.delimiter=ae),bestDelimiter:ae}})(le,x.newline,x.skipEmptyLines,x.comments,x.delimitersToGuess)).successful?x.delimiter=ve.bestDelimiter:(I=!0,x.delimiter=c.DefaultDelimiter),H.meta.delimiter=x.delimiter),D(x));return x.preview&&x.header&&ve.preview++,m=le,S=new b(ve),H=S.parse(m,J,Q),te(),G?{meta:{paused:!0}}:H||{meta:{paused:!1}}},this.paused=function(){return G},this.pause=function(){G=!0,S.abort(),m=T(x.chunk)?"":m.substring(S.getCharIndex())},this.resume=function(){N.streamer._halted?(G=!1,N.streamer.parseChunk(m,!0)):setTimeout(N.resume,3)},this.aborted=function(){return z},this.abort=function(){z=!0,S.abort(),H.meta.aborted=!0,T(x.complete)&&x.complete(H),m=""},this.guessLineEndings=function(ee,ve){ee=ee.substring(0,1048576);var ve=new RegExp(E(ve)+"([^]*?)"+E(ve),"gm"),Q=(ee=ee.replace(ve,"")).split("\r"),ve=ee.split(`
`),ee=1<ve.length&&ve[0].length<Q[0].length;if(Q.length===1||ee)return`
`;for(var K=0,Y=0;Y<Q.length;Y++)Q[Y][0]===`
`&&K++;return K>=Q.length/2?`\r
`:"\r"}}function E(x){return x.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function b(x){var m=(x=x||{}).delimiter,S=x.newline,I=x.comments,C=x.step,F=x.preview,W=x.fastMode,P=null,R=!1,N=x.quoteChar==null?'"':x.quoteChar,M=N;if(x.escapeChar!==void 0&&(M=x.escapeChar),(typeof m!="string"||-1<c.BAD_DELIMITERS.indexOf(m))&&(m=","),I===m)throw new Error("Comment character same as delimiter");I===!0?I="#":(typeof I!="string"||-1<c.BAD_DELIMITERS.indexOf(I))&&(I=!1),S!==`
`&&S!=="\r"&&S!==`\r
`&&(S=`
`);var O=0,G=!1;this.parse=function(z,j,H){if(typeof z!="string")throw new Error("Input must be a string");var V=z.length,te=m.length,oe=S.length,ne=I.length,le=T(C),J=[],Q=[],ve=[],ee=O=0;if(!z)return Ie();if(W||W!==!1&&z.indexOf(N)===-1){for(var K=z.split(S),Y=0;Y<K.length;Y++){if(ve=K[Y],O+=ve.length,Y!==K.length-1)O+=S.length;else if(H)return Ie();if(!I||ve.substring(0,ne)!==I){if(le){if(J=[],he(ve.split(m)),Ve(),G)return Ie()}else he(ve.split(m));if(F&&F<=Y)return J=J.slice(0,F),Ie(!0)}}return Ie()}for(var pe=z.indexOf(m,O),xe=z.indexOf(S,O),ae=new RegExp(E(M)+E(N),"g"),de=z.indexOf(N,O);;)if(z[O]===N)for(de=O,O++;;){if((de=z.indexOf(N,de+1))===-1)return H||Q.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:J.length,index:O}),Te();if(de===V-1)return Te(z.substring(O,de).replace(ae,N));if(N===M&&z[de+1]===M)de++;else if(N===M||de===0||z[de-1]!==M){pe!==-1&&pe<de+1&&(pe=z.indexOf(m,de+1));var Ee=Ce((xe=xe!==-1&&xe<de+1?z.indexOf(S,de+1):xe)===-1?pe:Math.min(pe,xe));if(z.substr(de+1+Ee,te)===m){ve.push(z.substring(O,de).replace(ae,N)),z[O=de+1+Ee+te]!==N&&(de=z.indexOf(N,O)),pe=z.indexOf(m,O),xe=z.indexOf(S,O);break}if(Ee=Ce(xe),z.substring(de+1+Ee,de+1+Ee+oe)===S){if(ve.push(z.substring(O,de).replace(ae,N)),Ge(de+1+Ee+oe),pe=z.indexOf(m,O),de=z.indexOf(N,O),le&&(Ve(),G))return Ie();if(F&&J.length>=F)return Ie(!0);break}Q.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:J.length,index:O}),de++}}else if(I&&ve.length===0&&z.substring(O,O+ne)===I){if(xe===-1)return Ie();O=xe+oe,xe=z.indexOf(S,O),pe=z.indexOf(m,O)}else if(pe!==-1&&(pe<xe||xe===-1))ve.push(z.substring(O,pe)),O=pe+te,pe=z.indexOf(m,O);else{if(xe===-1)break;if(ve.push(z.substring(O,xe)),Ge(xe+oe),le&&(Ve(),G))return Ie();if(F&&J.length>=F)return Ie(!0)}return Te();function he(Ue){J.push(Ue),ee=O}function Ce(Ue){var ze=0;return ze=Ue!==-1&&(Ue=z.substring(de+1,Ue))&&Ue.trim()===""?Ue.length:ze}function Te(Ue){return H||(Ue===void 0&&(Ue=z.substring(O)),ve.push(Ue),O=V,he(ve),le&&Ve()),Ie()}function Ge(Ue){O=Ue,he(ve),ve=[],xe=z.indexOf(S,O)}function Ie(Ue){if(x.header&&!j&&J.length&&!R){var ze=J[0],Ke=Object.create(null),ue=new Set(ze);let be=!1;for(let Ae=0;Ae<ze.length;Ae++){let Me=ze[Ae];if(Ke[Me=T(x.transformHeader)?x.transformHeader(Me,Ae):Me]){let We,lt=Ke[Me];for(;We=Me+"_"+lt,lt++,ue.has(We););ue.add(We),ze[Ae]=We,Ke[Me]++,be=!0,(P=P===null?{}:P)[We]=Me}else Ke[Me]=1,ze[Ae]=Me;ue.add(Me)}be&&console.warn("Duplicate headers found and renamed."),R=!0}return{data:J,errors:Q,meta:{delimiter:m,linebreak:S,aborted:G,truncated:!!Ue,cursor:ee+(j||0),renamedHeaders:P}}}function Ve(){C(Ie()),J=[],Q=[]}},this.abort=function(){G=!0},this.getCharIndex=function(){return O}}function _(x){var m=x.data,S=o[m.workerId],I=!1;if(m.error)S.userError(m.error,m.file);else if(m.results&&m.results.data){var C={abort:function(){I=!0,v(m.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:A,resume:A};if(T(S.userStep)){for(var F=0;F<m.results.data.length&&(S.userStep({data:m.results.data[F],errors:m.results.errors,meta:m.results.meta},C),!I);F++);delete m.results}else T(S.userChunk)&&(S.userChunk(m.results,C,m.file),delete m.results)}m.finished&&!I&&v(m.workerId,m.results)}function v(x,m){var S=o[x];T(S.userComplete)&&S.userComplete(m),S.terminate(),delete o[x]}function A(){throw new Error("Not implemented.")}function D(x){if(typeof x!="object"||x===null)return x;var m,S=Array.isArray(x)?[]:{};for(m in x)S[m]=D(x[m]);return S}function k(x,m){return function(){x.apply(m,arguments)}}function T(x){return typeof x=="function"}return c.parse=function(x,m){var S=(m=m||{}).dynamicTyping||!1;if(T(S)&&(m.dynamicTypingFunction=S,S={}),m.dynamicTyping=S,m.transform=!!T(m.transform)&&m.transform,!m.worker||!c.WORKERS_SUPPORTED)return S=null,c.NODE_STREAM_INPUT,typeof x=="string"?(x=(I=>I.charCodeAt(0)!==65279?I:I.slice(1))(x),S=new(m.download?f:p)(m)):x.readable===!0&&T(x.read)&&T(x.on)?S=new g(m):(n.File&&x instanceof File||x instanceof Object)&&(S=new h(m)),S.stream(x);(S=(()=>{var I;return!!c.WORKERS_SUPPORTED&&(I=(()=>{var C=n.URL||n.webkitURL||null,F=r.toString();return c.BLOB_URL||(c.BLOB_URL=C.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",F,")();"],{type:"text/javascript"})))})(),(I=new n.Worker(I)).onmessage=_,I.id=l++,o[I.id]=I)})()).userStep=m.step,S.userChunk=m.chunk,S.userComplete=m.complete,S.userError=m.error,m.step=T(m.step),m.chunk=T(m.chunk),m.complete=T(m.complete),m.error=T(m.error),delete m.worker,S.postMessage({input:x,config:m,workerId:S.id})},c.unparse=function(x,m){var S=!1,I=!0,C=",",F=`\r
`,W='"',P=W+W,R=!1,N=null,M=!1,O=((()=>{if(typeof m=="object"){if(typeof m.delimiter!="string"||c.BAD_DELIMITERS.filter(function(j){return m.delimiter.indexOf(j)!==-1}).length||(C=m.delimiter),typeof m.quotes!="boolean"&&typeof m.quotes!="function"&&!Array.isArray(m.quotes)||(S=m.quotes),typeof m.skipEmptyLines!="boolean"&&typeof m.skipEmptyLines!="string"||(R=m.skipEmptyLines),typeof m.newline=="string"&&(F=m.newline),typeof m.quoteChar=="string"&&(W=m.quoteChar),typeof m.header=="boolean"&&(I=m.header),Array.isArray(m.columns)){if(m.columns.length===0)throw new Error("Option columns is empty");N=m.columns}m.escapeChar!==void 0&&(P=m.escapeChar+W),m.escapeFormulae instanceof RegExp?M=m.escapeFormulae:typeof m.escapeFormulae=="boolean"&&m.escapeFormulae&&(M=/^[=+\-@\t\r].*$/)}})(),new RegExp(E(W),"g"));if(typeof x=="string"&&(x=JSON.parse(x)),Array.isArray(x)){if(!x.length||Array.isArray(x[0]))return G(null,x,R);if(typeof x[0]=="object")return G(N||Object.keys(x[0]),x,R)}else if(typeof x=="object")return typeof x.data=="string"&&(x.data=JSON.parse(x.data)),Array.isArray(x.data)&&(x.fields||(x.fields=x.meta&&x.meta.fields||N),x.fields||(x.fields=Array.isArray(x.data[0])?x.fields:typeof x.data[0]=="object"?Object.keys(x.data[0]):[]),Array.isArray(x.data[0])||typeof x.data[0]=="object"||(x.data=[x.data])),G(x.fields||[],x.data||[],R);throw new Error("Unable to serialize unrecognized input");function G(j,H,V){var te="",oe=(typeof j=="string"&&(j=JSON.parse(j)),typeof H=="string"&&(H=JSON.parse(H)),Array.isArray(j)&&0<j.length),ne=!Array.isArray(H[0]);if(oe&&I){for(var le=0;le<j.length;le++)0<le&&(te+=C),te+=z(j[le],le);0<H.length&&(te+=F)}for(var J=0;J<H.length;J++){var Q=(oe?j:H[J]).length,ve=!1,ee=oe?Object.keys(H[J]).length===0:H[J].length===0;if(V&&!oe&&(ve=V==="greedy"?H[J].join("").trim()==="":H[J].length===1&&H[J][0].length===0),V==="greedy"&&oe){for(var K=[],Y=0;Y<Q;Y++){var pe=ne?j[Y]:Y;K.push(H[J][pe])}ve=K.join("").trim()===""}if(!ve){for(var xe=0;xe<Q;xe++){0<xe&&!ee&&(te+=C);var ae=oe&&ne?j[xe]:xe;te+=z(H[J][ae],xe)}J<H.length-1&&(!V||0<Q&&!ee)&&(te+=F)}}return te}function z(j,H){var V,te;return j==null?"":j.constructor===Date?JSON.stringify(j).slice(1,25):(te=!1,M&&typeof j=="string"&&M.test(j)&&(j="'"+j,te=!0),V=j.toString().replace(O,P),(te=te||S===!0||typeof S=="function"&&S(j,H)||Array.isArray(S)&&S[H]||((oe,ne)=>{for(var le=0;le<ne.length;le++)if(-1<oe.indexOf(ne[le]))return!0;return!1})(V,c.BAD_DELIMITERS)||-1<V.indexOf(C)||V.charAt(0)===" "||V.charAt(V.length-1)===" ")?W+V+W:V)}},c.RECORD_SEP="",c.UNIT_SEP="",c.BYTE_ORDER_MARK="\uFEFF",c.BAD_DELIMITERS=["\r",`
`,'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!i&&!!n.Worker,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=b,c.ParserHandle=y,c.NetworkStreamer=f,c.FileStreamer=h,c.StringStreamer=p,c.ReadableStreamStreamer=g,n.jQuery&&((s=n.jQuery).fn.parse=function(x){var m=x.config||{},S=[];return this.each(function(F){if(!(s(this).prop("tagName").toUpperCase()==="INPUT"&&s(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var W=0;W<this.files.length;W++)S.push({file:this.files[W],inputElem:this,instanceConfig:s.extend({},m)})}),I(),this;function I(){if(S.length===0)T(x.complete)&&x.complete();else{var F,W,P,R,N=S[0];if(T(x.before)){var M=x.before(N.file,N.inputElem);if(typeof M=="object"){if(M.action==="abort")return F="AbortError",W=N.file,P=N.inputElem,R=M.reason,void(T(x.error)&&x.error({name:F},W,P,R));if(M.action==="skip")return void C();typeof M.config=="object"&&(N.instanceConfig=s.extend(N.instanceConfig,M.config))}else if(M==="skip")return void C()}var O=N.instanceConfig.complete;N.instanceConfig.complete=function(G){T(O)&&O(G,N.file,N.inputElem),C()},c.parse(N.file,N.instanceConfig)}}function C(){S.splice(0,1),I()}}),a&&(n.onmessage=function(x){x=x.data,c.WORKER_ID===void 0&&x&&(c.WORKER_ID=x.workerId),typeof x.input=="string"?n.postMessage({workerId:c.WORKER_ID,results:c.parse(x.input,x.config),finished:!0}):(n.File&&x.input instanceof File||x.input instanceof Object)&&(x=c.parse(x.input,x.config))&&n.postMessage({workerId:c.WORKER_ID,results:x,finished:!0})}),(f.prototype=Object.create(u.prototype)).constructor=f,(h.prototype=Object.create(u.prototype)).constructor=h,(p.prototype=Object.create(p.prototype)).constructor=p,(g.prototype=Object.create(u.prototype)).constructor=g,c})})(SI);var kq=SI.exports;const AI=yI(kq),Uo=xo();function TI(t){return t.toLowerCase().replace(/[^a-zA-Z0-9]+(.)/g,(e,r)=>r.toUpperCase()).replace(/^[A-Z]/,e=>e.toLowerCase())}async function Dq(t,e){if(!t)return null;const r=Object.values(e).find(n=>{var s;return n.aeriesId===t||n.aeriesId===parseInt(t)||((s=n.aeriesId)==null?void 0:s.toString())===(t==null?void 0:t.toString())});return r?r.id:(console.warn(`No Firebase user found for Aeries teacher ID: ${t}`),null)}function Hv(t){return{sourcedId:"stateId",SSID:"stateId",StateStudentID:"stateId",StudentNumber:"localId",givenName:"firstName",FirstName:"firstName",familyName:"lastName",LastName:"lastName",middleName:"middleName",MiddleName:"middleName",email:"email",Email:"email",phone:"phone",Phone:"phone",dateOfBirth:"birthDate",DOB:"birthDate",sex:"gender",Gender:"gender",grade:"grade",Grade:"grade",Address:"address",City:"city",State:"state",ZipCode:"zipCode",ParentName:"parentName",ParentPhone:"parentPhone",ParentEmail:"parentEmail",AttendanceRate:"attendanceRate",attendanceRate:"attendanceRate",Period1TeacherId:"schedule.periods.1",period1TeacherId:"schedule.periods.1",Period2TeacherId:"schedule.periods.2",period2TeacherId:"schedule.periods.2",Period3TeacherId:"schedule.periods.3",period3TeacherId:"schedule.periods.3",Period4TeacherId:"schedule.periods.4",period4TeacherId:"schedule.periods.4",Period5TeacherId:"schedule.periods.5",period5TeacherId:"schedule.periods.5",Period6TeacherId:"schedule.periods.6",period6TeacherId:"schedule.periods.6",Period7TeacherId:"schedule.periods.7",period7TeacherId:"schedule.periods.7",SHTeacherId:"schedule.periods.SH",shTeacherId:"schedule.periods.SH"}[t]||TI(t)}function jv(t){return{SSID:"ssid",FirstName:"firstName",LastName:"lastName",MiddleName:"middleName",Grade:"grade",DOB:"dob",Gender:"gender",Ethnicity:"ethnicity",School:"school",Address:"address",City:"city",State:"state",ZipCode:"zipCode",Phone:"phone",ParentName:"parentName",ParentPhone:"parentPhone",ParentEmail:"parentEmail",ELL:"ell",504:"504",IEP:"iep",CaseManager:"caseManager",Disability:"disability",ServiceMinutes:"serviceMinutes",Goals:"goals",Notes:"notes",Plan:"plan",ReviewDate:"reviewDate",ReevalDate:"reevalDate",MeetingDate:"meetingDate",SpeechProvider:"speechProvider",MHProvider:"mhProvider",OTProvider:"otProvider",ProgramAccommodations:"programAccommodations",Accommodations:"programAccommodations",IEP_Services:"iepServices"}[t]||TI(t)}async function Pq(t){return new Promise((e,r)=>{AI.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{const s=n.data;if(!s||!s.length)return r(new Error("No data rows found in the CSV."));const i=Object.keys(s[0]).map(o=>o.trim().toLowerCase());if(!(i.includes("sourcedid")||i.includes("ssid")||i.includes("statestudentid")))return r(new Error("Missing required 'sourcedId' or 'SSID' column."));e(s)},error:n=>r(new Error("Failed to parse CSV: "+n.message))})})}async function Rq(t,e){var a;let r=0;const n=At(Uo,"users"),s=await zt(n),i={};s.forEach(o=>{i[o.id]={id:o.id,...o.data()}}),console.log(`Loaded ${Object.keys(i).length} users for teacher ID mapping`);for(const o of t){const l=(a=o.sourcedId||o.SSID||o.ssid||o.StateStudentID||o.stateStudentId)==null?void 0:a.trim();if(!l){console.warn("Skipping row with missing SSID:",o);continue}const c={firstName:"",lastName:"",grade:"",birthDate:"",gender:"",address:"",city:"",state:"",zipCode:"",phone:"",email:"",parentName:"",parentPhone:"",parentEmail:"",attendanceRate:"",schedule:{periods:{}}};for(const u of e){const f=Hv(u),h=o[u],p=h!=null&&typeof h=="string"?h.trim():h!=null?String(h):null;if(f.startsWith("schedule.periods.")){const g=f.split(".")[2];if(p){const y=await Dq(p,i);y?(c.schedule.periods[g]=y,console.log(`Mapped Aeries teacher ID ${p} to Firebase user ID ${y} for period ${g}`)):console.warn(`Could not map Aeries teacher ID ${p} for period ${g}`)}}else c[f]=p}c.lastAeriesImport=new Date().toISOString(),console.log("Final aeriesData.schedule structure:",JSON.stringify(c.schedule,null,2));try{const u=At(Uo,"students"),f=cr(u,Ur("app.studentData.ssid","==",l)),h=await zt(f);if(h.empty){const p=Ze(At(Uo,"students")),g={app:{studentData:{ssid:l}},aeries:c,createdAt:Dn()};await jt(p,g),console.log(`Created new student ${p.id} with Aeries data for SSID ${l}`)}else{const p=h.docs[0];await jt(Ze(Uo,"students",p.id),{aeries:c},{merge:!0}),console.log(`Updated existing student ${p.id} with Aeries data for SSID ${l}`)}r++}catch(u){console.error(`Failed to import Aeries data for SSID ${l}:`,u)}}return r}async function Fq(t){return new Promise((e,r)=>{AI.parse(t,{header:!0,skipEmptyLines:!0,complete:n=>{const s=n.data;if(!s||!s.length)return r(new Error("No data rows found in the CSV."));if(!Object.keys(s[0]).some(a=>a.trim().toLowerCase()==="ssid"))return r(new Error("Missing required 'SSID' column."));e(s)},error:n=>r(new Error("Failed to parse CSV: "+n.message))})})}async function Nq(t,e){var n,s,i,a;let r=0;for(const o of t){const l=((n=o.SSID)==null?void 0:n.trim())||((s=o.ssid)==null?void 0:s.trim());if(!l){console.warn("Skipping row with missing SSID:",o);continue}const c={};for(const u of e){const f=jv(u);u==="IEP_Services"||u==="iep_services"?c[f]=((i=o[u])==null?void 0:i.split(";").map(h=>h.trim()))||[]:u==="ProgramAccommodations"||u==="Accommodations"?c[f]=((a=o[u])==null?void 0:a.split(";").map(h=>h.trim()))||[]:c[f]=o[u]}c.lastSeisImport=new Date().toISOString();try{const u=At(Uo,"students"),f=cr(u,Ur("app.studentData.ssid","==",l)),h=await zt(f);if(h.empty){const p=Ze(At(Uo,"students")),g={app:{studentData:{ssid:l}},seis:c,createdAt:Dn()};await jt(p,g),console.log(`Created new student ${p.id} with SEIS data for SSID ${l}`)}else{const p=h.docs[0];await jt(Ze(Uo,"students",p.id),{seis:c},{merge:!0}),console.log(`Updated existing student ${p.id} with SEIS data for SSID ${l}`)}r++}catch(u){console.error(`Failed to import SEIS data for SSID ${l}:`,u)}}return r}const Oq={name:"SeisImport",setup(){const t=se(null),e=se(null),r=se([]),n=se([]),s=se([]),i=se([]),a=se(""),o=se(!1),l=Se(()=>r.value.length>0&&s.value.length>0),c=(p,g=!1)=>{a.value=p,o.value=g,setTimeout(()=>{a.value="",o.value=!1},5e3)};return{fileInput:t,selectedFile:e,parsedData:r,fieldOptions:n,selectedFields:s,previewData:i,statusMessage:a,isError:o,canImport:l,handleFileSelect:p=>{const g=p.target.files[0];if(g){const y=ol(g,{allowedTypes:["csv"],maxSize:10485760,fieldName:"SEIS Import File"});if(!y.isValid){c(y.error,!0),p.target.value="";return}const E=Hr(g.name);if(!E.isSafe){c(`File name contains potentially dangerous content: ${E.threats.join(", ")}`,!0),p.target.value="";return}e.value=g}},previewFile:async()=>{const p=e.value;if(!p){c("❌ Please select a CSV file.",!0);return}if(!Rs("seisPreview",5,3e5).allowed){c("Too many preview requests. Please wait before previewing again.",!0);return}c("Parsing file..."),i.value=[],n.value=[],s.value=[];try{const E=(await Fq(p)).map(_=>{const v={};return Object.entries(_).forEach(([A,D])=>{const k=qr(A,{trim:!0,maxLength:100,removeDangerous:!0});let T=D;if(typeof D=="string"){T=qr(D,{trim:!0,maxLength:500,removeDangerous:!0});const x=Hr(T);x.isSafe||(console.warn(`Security threat detected in SEIS data: ${x.threats.join(", ")}`),T="")}v[k]=T}),v});r.value=E,c(`✅ Loaded ${r.value.length} rows.`);const b=Object.keys(r.value[0]||{}).filter(_=>_.length>0);n.value=b,s.value=[...b],i.value=r.value.slice(0,5)}catch(y){c(`❌ Error: ${y.message}`,!0),console.error("SEIS Parse Error:",y)}},importData:async()=>{if(!l.value){c("❌ Cannot import: No data or fields selected.",!0);return}if(!Rs("seisImport",2,6e5).allowed){c("Too many import requests. Please wait before importing again.",!0);return}if(confirm(`Import ${r.value.length} SEIS records? This will update existing students with matching SSIDs.`)){c("Importing data...");try{const g=r.value.map(E=>{const b={};return s.value.forEach(_=>{E[_]!==void 0&&(b[_]=E[_])}),b}),y=g.filter(E=>Object.values(E).some(_=>_&&typeof _=="string"&&_.trim().length>0));if(y.length===0){c("❌ No valid records found to import.",!0);return}if(y.length!==g.length){const E=g.length-y.length;c(`⚠️ Skipping ${E} invalid records. Importing ${y.length} valid records.`)}await Nq(y,s.value),c(`✅ Successfully imported ${y.length} SEIS records.`),e.value=null,r.value=[],n.value=[],s.value=[],i.value=[],t.value&&(t.value.value="")}catch(g){c(`❌ Import failed: ${g.message}`,!0),console.error("SEIS Import Error:",g)}}}}}},Mq={class:"seis-import"},Lq=["disabled"],Bq={key:0,id:"seis-field-options"},Uq=["value"],$q={key:1,id:"seis-preview-container",style:{"margin-top":"1rem"}},Vq={border:"1",cellpadding:"4"},Hq=["disabled"];function jq(t,e,r,n,s,i){return L(),B("div",Mq,[e[5]||(e[5]=d("h3",null,"Upload SEIS CSV",-1)),d("input",{type:"file",ref:"fileInput",accept:".csv",onChange:e[0]||(e[0]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[1]||(e[1]=(...a)=>n.previewFile&&n.previewFile(...a)),disabled:!n.selectedFile},"Preview",8,Lq),n.fieldOptions.length>0?(L(),B("div",Bq,[e[4]||(e[4]=d("h4",null,"Select fields to import:",-1)),(L(!0),B(De,null,$e(n.fieldOptions,a=>(L(),B("label",{key:a},[Ne(d("input",{type:"checkbox",value:a,"onUpdate:modelValue":e[2]||(e[2]=o=>n.selectedFields=o),checked:""},null,8,Uq),[[bt,n.selectedFields]]),we(" "+Z(a),1)]))),128))])):_e("",!0),n.previewData.length>0?(L(),B("div",$q,[d("table",Vq,[d("thead",null,[d("tr",null,[(L(!0),B(De,null,$e(n.fieldOptions,a=>(L(),B("th",{key:a},Z(a),1))),128))])]),d("tbody",null,[(L(!0),B(De,null,$e(n.previewData,(a,o)=>(L(),B("tr",{key:o},[(L(!0),B(De,null,$e(n.fieldOptions,l=>(L(),B("td",{key:l},Z(a[l]||""),1))),128))]))),128))])]),d("p",null,"Showing first "+Z(n.previewData.length)+" of "+Z(n.parsedData.length)+" rows.",1)])):_e("",!0),d("button",{onClick:e[3]||(e[3]=(...a)=>n.importData&&n.importData(...a)),disabled:!n.canImport},"Import to Firestore",8,Hq),d("p",{class:Xe(["status-msg",{error:n.isError}])},Z(n.statusMessage),3)])}const Gq=St(Oq,[["render",jq],["__scopeId","data-v-15b6b1af"]]),Wq={name:"AeriesImport",setup(){const t=se(null),e=se(null),r=se([]),n=se([]),s=se([]),i=se([]),a=se(""),o=se(!1),l=Se(()=>r.value.length>0&&s.value.length>0),c=(p,g=!1)=>{a.value=p,o.value=g,setTimeout(()=>{a.value="",o.value=!1},5e3)};return{fileInput:t,selectedFile:e,parsedData:r,fieldOptions:n,selectedFields:s,previewData:i,statusMessage:a,isError:o,canImport:l,handleFileSelect:p=>{const g=p.target.files[0];if(g){const y=ol(g,{allowedTypes:["csv"],maxSize:10485760,fieldName:"Aeries Import File"});if(!y.isValid){c(y.error,!0),p.target.value="";return}const E=Hr(g.name);if(!E.isSafe){c(`File name contains potentially dangerous content: ${E.threats.join(", ")}`,!0),p.target.value="";return}e.value=g}},previewFile:async()=>{const p=e.value;if(!p){c("❌ Please select a CSV file.",!0);return}if(!Rs("aeriesPreview",5,3e5).allowed){c("Too many preview requests. Please wait before previewing again.",!0);return}c("Parsing file..."),i.value=[],n.value=[],s.value=[];try{const E=(await Pq(p)).map(_=>{const v={};return Object.entries(_).forEach(([A,D])=>{const k=qr(A,{trim:!0,maxLength:100,removeDangerous:!0});let T=D;if(typeof D=="string"){T=qr(D,{trim:!0,maxLength:500,removeDangerous:!0});const x=Hr(T);x.isSafe||(console.warn(`Security threat detected in Aeries data: ${x.threats.join(", ")}`),T="")}v[k]=T}),v});r.value=E,c(`✅ Loaded ${r.value.length} rows.`);const b=Object.keys(r.value[0]||{}).filter(_=>_.length>0);n.value=b,s.value=[...b],i.value=r.value.slice(0,5)}catch(y){c(`❌ Error: ${y.message}`,!0),console.error("Aeries Parse Error:",y)}},importData:async()=>{if(!l.value){c("❌ Cannot import: No data or fields selected.",!0);return}if(!Rs("aeriesImport",2,6e5).allowed){c("Too many import requests. Please wait before importing again.",!0);return}if(confirm(`Import ${r.value.length} Aeries records? This will update existing students with matching SSIDs.`)){c("Importing data...");try{const g=r.value.map(E=>{const b={};return s.value.forEach(_=>{E[_]!==void 0&&(b[_]=E[_])}),b}),y=g.filter(E=>Object.values(E).some(_=>_&&typeof _=="string"&&_.trim().length>0));if(y.length===0){c("❌ No valid records found to import.",!0);return}if(y.length!==g.length){const E=g.length-y.length;c(`⚠️ Skipping ${E} invalid records. Importing ${y.length} valid records.`)}await Rq(y,s.value),c(`✅ Successfully imported ${y.length} Aeries records.`),e.value=null,r.value=[],n.value=[],s.value=[],i.value=[],t.value&&(t.value.value="")}catch(g){c(`❌ Import failed: ${g.message}`,!0),console.error("Aeries Import Error:",g)}}}}}},zq={class:"aeries-import"},Kq=["disabled"],qq={key:0,id:"aeries-field-options"},Xq=["value"],Yq={key:1,id:"aeries-preview-container",style:{"margin-top":"1rem"}},Qq={border:"1",cellpadding:"4"},Jq=["disabled"];function Zq(t,e,r,n,s,i){return L(),B("div",zq,[e[5]||(e[5]=d("h3",null,"Upload Aeries CSV",-1)),d("input",{type:"file",ref:"fileInput",accept:".csv",onChange:e[0]||(e[0]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a))},null,544),d("button",{onClick:e[1]||(e[1]=(...a)=>n.previewFile&&n.previewFile(...a)),disabled:!n.selectedFile},"Preview",8,Kq),n.fieldOptions.length>0?(L(),B("div",qq,[e[4]||(e[4]=d("h4",null,"Select fields to import:",-1)),(L(!0),B(De,null,$e(n.fieldOptions,a=>(L(),B("label",{key:a},[Ne(d("input",{type:"checkbox",value:a,"onUpdate:modelValue":e[2]||(e[2]=o=>n.selectedFields=o),checked:""},null,8,Xq),[[bt,n.selectedFields]]),we(" "+Z(a),1)]))),128))])):_e("",!0),n.previewData.length>0?(L(),B("div",Yq,[d("table",Qq,[d("thead",null,[d("tr",null,[(L(!0),B(De,null,$e(n.fieldOptions,a=>(L(),B("th",{key:a},Z(a),1))),128))])]),d("tbody",null,[(L(!0),B(De,null,$e(n.previewData,(a,o)=>(L(),B("tr",{key:o},[(L(!0),B(De,null,$e(n.fieldOptions,l=>(L(),B("td",{key:l},Z(a[l]||""),1))),128))]))),128))])]),d("p",null,"Showing first "+Z(n.previewData.length)+" of "+Z(n.parsedData.length)+" rows.",1)])):_e("",!0),d("button",{onClick:e[3]||(e[3]=(...a)=>n.importData&&n.importData(...a)),disabled:!n.canImport},"Import to Firestore",8,Jq),d("p",{class:Xe(["status-msg",{error:n.isError}])},Z(n.statusMessage),3)])}const eX=St(Wq,[["render",Zq],["__scopeId","data-v-f01de2a5"]]);function tX(){const t=fc(zd()),e=se(!1),r=se(!1),n=se(""),s=se(""),i=se(!1),a=As({baseUrl:"encrypted",clientId:"encrypted",clientSecret:"encrypted",selectedSchoolId:"school123",selectedClassIds:["class1","class2"],selectedApiTypes:{oneroster:!0,nativeAeries:!0},selectedEndpoints:["/schools","/students","/api/special-education/students"]}),o=se([{path:"/orgs",name:"Organizations",description:"District information"},{path:"/schools",name:"Schools",description:"School sites"},{path:"/academicSessions",name:"Academic Sessions",description:"Terms/semesters"},{path:"/grades",name:"Grades",description:"Grade levels"},{path:"/courses",name:"Courses",description:"Course catalog"},{path:"/classes",name:"Classes",description:"Sections (MST table)"},{path:"/teachers",name:"Teachers",description:"Teacher roster"},{path:"/students",name:"Students",description:"Student roster"},{path:"/enrollments",name:"Enrollments",description:"Student-to-class links"},{path:"/api/special-education/students",name:"SPED Students",description:"Students with IEP/504 plans"},{path:"/api/special-education/ieps",name:"IEP Records",description:"IEP documents and data"},{path:"/api/special-education/504-plans",name:"504 Plans",description:"504 plan records"},{path:"/api/special-education/accommodations",name:"Accommodations",description:"Student accommodations"},{path:"/api/special-education/services",name:"Services",description:"Related services"},{path:"/api/special-education/case-managers",name:"Case Managers",description:"Case manager assignments"},{path:"/api/students/special-education",name:"SPED Students Alt",description:"Alternative SPED endpoint"},{path:"/api/iep/students",name:"IEP Students",description:"IEP student data"},{path:"/api/504/students",name:"504 Students",description:"504 student data"}]),l=(I,C=!1)=>{s.value=I,i.value=C,setTimeout(()=>{s.value="",i.value=!1},5e3)},c=()=>{a.baseUrl="https://demo.aeries.net/aeries",a.clientId="1279e5c6b747b6d62b7c76db3a205d40eb7458e678a90493d537d5af6b953550",a.clientSecret="68019dbf8d8ba82980dd148eecc3977ac0d7f1f040d444225874c88eb80b9c1a",l("Demo credentials loaded. Click Connect to test.")},u=async()=>{if(!a.baseUrl||!a.clientId||!a.clientSecret)return l("Please fill in all connection fields.",!0),!1;r.value=!0,l("Connecting to Aeries API...");try{const F=(await Ra(t,"getAeriesToken")({baseUrl:a.baseUrl,clientId:a.clientId,clientSecret:a.clientSecret})).data;if(F.success&&F.access_token)return n.value=F.access_token,e.value=!0,l("✅ Successfully connected to Aeries API!"),!0;throw new Error("No access token received")}catch(I){const C=I.message||"Connection failed";return l(`❌ Connection failed: ${C}`,!0),console.error("Aeries API Connection Error:",I),!1}finally{r.value=!1}},f=()=>{e.value=!1,n.value="",l("Disconnected from Aeries API.")},h=async I=>{if(!e.value||!n.value)return l("Not connected to Aeries API.",!0),null;try{const W=(await Ra(t,"testAeriesEndpoint")({baseUrl:a.baseUrl,endpoint:I,accessToken:n.value})).data;if(W.success)return l(`✅ Successfully fetched data from ${I}`),{data:W.data,responseTime:W.responseTime};throw new Error(W.error||"API call failed")}catch(C){const F=C.message||"API call failed";return l(`❌ API call failed: ${F}`,!0),console.error("Aeries API Test Error:",C),{error:F}}},p=async I=>{if(!e.value||!n.value)return l("Not connected to Aeries API.",!0),null;try{const W=(await Ra(t,"testCustomAeriesEndpoint")({baseUrl:a.baseUrl,endpoint:I,accessToken:n.value})).data;return W.success?(l(`✅ Successfully fetched data from ${I}`),{data:W.data,responseTime:W.responseTime}):{error:W.error||"API call failed"}}catch(C){const F=C.message||"API call failed";return l(`❌ API call failed: ${F}`,!0),console.error("Custom Aeries API Test Error:",C),{error:F}}},g=async()=>await h("/students"),y=async()=>await h("/teachers"),E=async()=>{const I=["/api/special-education/students","/api/students/special-education","/api/iep/students","/api/504/students"];for(const C of I){const F=await p(C);if(F&&!F.error)return F}return{error:"No special education endpoints found"}},b=async()=>await p("/api/special-education/ieps"),_=async()=>await p("/api/special-education/504-plans"),v=async()=>await p("/api/special-education/accommodations"),A=async()=>await p("/api/special-education/services"),D=async()=>await p("/api/special-education/case-managers"),k=async()=>{const I={},C=o.value.filter(F=>F.path.includes("special-education")||F.path.includes("iep")||F.path.includes("504"));for(const F of C)I[F.path]=await p(F.path);return I},T=async()=>{var C;const I=await h("/students");if(I&&!I.error&&I.data){const F=((C=I.data.students)==null?void 0:C[0])||I.data[0],W=F&&(F.specialEducation||F.iep||F.plan504||F.disabilities||F.accommodations);return{success:!0,hasSpecialEdFields:W,sampleStudent:F,message:W?"OneRoster includes special education data!":"OneRoster does not include special education data"}}return I},x=async()=>{const I=["?filter=specialEducation=true","?filter=iep=true","?filter=plan504=true","?filter=disabilities=*","?filter=accommodations=*"],C={};for(const F of I)C[F]=await h(`/students${F}`);return C};async function m({baseUrl:I,accessToken:C}){const F=fc(),R=await Ra(F,"testAeriesEndpoint")({baseUrl:I,endpoint:"/schools",accessToken:C});return R.data.data.orgs||R.data.data.schools||R.data.data||[]}async function S({baseUrl:I,accessToken:C,schoolId:F}){const W=fc(),P=Ra(W,"testAeriesEndpoint"),R=`/classes?filter=school.sourcedId='${F}'`,N=await P({baseUrl:I,endpoint:R,accessToken:C});return N.data.data.classes||N.data.data||[]}return{isConnected:e,isConnecting:r,accessToken:n,connectionStatus:s,isError:i,connectionConfig:a,availableEndpoints:o,showStatus:l,loadDemoCredentials:c,connect:u,disconnect:f,testEndpoint:h,testCustomEndpoint:p,fetchStudents:g,fetchTeachers:y,fetchSpecialEducationStudents:E,fetchIEPRecords:b,fetch504Plans:_,fetchAccommodations:v,fetchServices:A,fetchCaseManagers:D,testAllSpecialEducationEndpoints:k,testOneRosterForSpecialEd:T,testStudentsWithSpecialEd:x,fetchSchools:m,fetchClasses:S}}const hg=(t,e)=>{let r="";for(let n=0;n<t.length;n++)r+=String.fromCharCode(t.charCodeAt(n)^e.charCodeAt(n%e.length));return btoa(r)},pg=(t,e)=>{const r=atob(t);let n="";for(let s=0;s<r.length;s++)n+=String.fromCharCode(r.charCodeAt(s)^e.charCodeAt(s%e.length));return n};function rX(){const t=xo(),e=uo(),r=se(!1),n=se(null),s=()=>{const c=e.currentUser;if(!c)throw new Error("User not authenticated");return c.uid+"_aeries_config_key"};return{isLoading:r,error:n,saveAeriesConfig:async c=>{if(!e.currentUser)throw new Error("User must be authenticated to save configuration");r.value=!0,n.value=null;try{const u=e.currentUser,f=s(),h={baseUrl:hg(c.baseUrl,f),clientId:hg(c.clientId,f),clientSecret:hg(c.clientSecret,f),selectedSchoolId:c.selectedSchoolId||"",selectedClassIds:c.selectedClassIds||[],manualClassInput:c.manualClassInput||"",savedAt:new Date().toISOString(),userId:u.uid},p=Ze(t,"users",u.uid,"aeries_config","current");return await jt(p,h),{success:!0,message:"Configuration saved securely"}}catch(u){throw n.value=u.message,console.error("Failed to save Aeries configuration:",u),u}finally{r.value=!1}},loadAeriesConfig:async()=>{if(!e.currentUser)throw new Error("User must be authenticated to load configuration");r.value=!0,n.value=null;try{const c=e.currentUser,u=s(),f=Ze(t,"users",c.uid,"aeries_config","current"),h=await qt(f);if(!h.exists())return null;const p=h.data();if(p.userId!==c.uid)throw new Error("Configuration security check failed");return{baseUrl:pg(p.baseUrl,u),clientId:pg(p.clientId,u),clientSecret:pg(p.clientSecret,u),selectedSchoolId:p.selectedSchoolId||"",selectedClassIds:p.selectedClassIds||[],manualClassInput:p.manualClassInput||"",savedAt:p.savedAt}}catch(c){throw n.value=c.message,console.error("Failed to load Aeries configuration:",c),c}finally{r.value=!1}},deleteAeriesConfig:async()=>{if(!e.currentUser)throw new Error("User must be authenticated to delete configuration");r.value=!0,n.value=null;try{const c=e.currentUser,u=Ze(t,"users",c.uid,"aeries_config","current");return await mo(u),{success:!0,message:"Configuration deleted securely"}}catch(c){throw n.value=c.message,console.error("Failed to delete Aeries configuration:",c),c}finally{r.value=!1}},hasSavedConfig:async()=>{if(!e.currentUser)return!1;try{const c=e.currentUser,u=Ze(t,"users",c.uid,"aeries_config","current");return(await qt(u)).exists()}catch(c){return console.error("Failed to check for saved configuration:",c),!1}}}}const nX={name:"AeriesAPIConnector",setup(){const{isConnected:t,isConnecting:e,accessToken:r,connectionStatus:n,isError:s,connectionConfig:i,availableEndpoints:a,showStatus:o,loadDemoCredentials:l,connect:c,disconnect:u,testEndpoint:f,testAllSpecialEducationEndpoints:h,testOneRosterForSpecialEd:p,testStudentsWithSpecialEd:g,fetchSchools:y,fetchClasses:E}=tX(),{isLoading:b,error:_,saveAeriesConfig:v,loadAeriesConfig:A,deleteAeriesConfig:D,hasSavedConfig:k}=rX(),T=se(!1),x=se(null),m=se(""),S=se(null),I=se([]),C=se(""),F=se([]),W=se([]),P=se(!1),R=se(""),N=se(""),M=se(!1),O=se({oneroster:!1,nativeAeries:!1}),G=se([]),z=se([{path:"/orgs",name:"Organizations",description:"District information"},{path:"/schools",name:"Schools",description:"School sites"},{path:"/academicSessions",name:"Academic Sessions",description:"Terms/semesters"},{path:"/grades",name:"Grades",description:"Grade levels"},{path:"/courses",name:"Courses",description:"Course catalog"},{path:"/classes",name:"Classes",description:"Sections (MST table)"},{path:"/teachers",name:"Teachers",description:"Teacher roster"},{path:"/students",name:"Students",description:"Student roster"},{path:"/enrollments",name:"Enrollments",description:"Student-to-class links"}]),j=se([{path:"/api/special-education/students",name:"SPED Students",description:"Students with IEP/504 plans"},{path:"/api/special-education/ieps",name:"IEP Records",description:"IEP documents and data"},{path:"/api/special-education/504-plans",name:"504 Plans",description:"504 plan records"},{path:"/api/special-education/accommodations",name:"Accommodations",description:"Student accommodations"},{path:"/api/special-education/services",name:"Services",description:"Related services"},{path:"/api/special-education/case-managers",name:"Case Managers",description:"Case manager assignments"},{path:"/api/students/special-education",name:"SPED Students Alt",description:"Alternative SPED endpoint"},{path:"/api/iep/students",name:"IEP Students",description:"IEP student data"},{path:"/api/504/students",name:"504 Students",description:"504 student data"}]),H=Se(()=>i.baseUrl&&i.clientId&&i.clientSecret),V=async()=>{if(await c())try{T.value=!0;const de=await y({baseUrl:i.baseUrl,accessToken:r.value});I.value=de||[],C.value=""}catch(de){console.error("Failed to fetch schools:",de),o("Failed to fetch schools",!0),I.value=[]}finally{T.value=!1}},te=async ae=>{T.value=!0,m.value=ae,x.value=null,S.value=null;const de=await f(ae);de&&!de.error?(x.value=de.data,S.value=de.responseTime):de&&de.error&&(x.value={error:de.error}),T.value=!1},oe=async()=>{T.value=!0,await h(),T.value=!1},ne=async()=>{T.value=!0,m.value="/students (SPED check)",x.value=null,S.value=null;const ae=await p();ae&&!ae.error?(x.value=ae,o(ae.message)):ae&&ae.error&&(x.value={error:ae.error},o(`❌ OneRoster test failed: ${ae.error}`,!0)),T.value=!1},le=async()=>{T.value=!0,m.value="/students (SPED filters)",x.value=null,S.value=null;const ae=await g();ae&&(x.value=ae,o("OneRoster SPED filter tests completed")),T.value=!1};Ht(C,async ae=>{if(!ae){F.value=[],W.value=[];return}P.value=!1,R.value="",T.value=!0;try{F.value=await E({baseUrl:i.baseUrl,accessToken:r.value,schoolId:ae}),W.value=[]}catch{P.value=!0,F.value=[],W.value=[]}finally{T.value=!1}});const J=Se(()=>t.value&&I.value.length>0),Q=Se(()=>J.value&&C.value),ve=Se(()=>O.value.oneroster||O.value.nativeAeries),ee=()=>{const ae=[];O.value.oneroster&&ae.push(...z.value),O.value.nativeAeries&&ae.push(...j.value),a.value=ae},K=(ae,de=!1)=>{N.value=ae,M.value=de,setTimeout(()=>{N.value="",M.value=!1},5e3)},Y=async()=>{try{const ae={baseUrl:i.baseUrl,clientId:i.clientId,clientSecret:i.clientSecret,selectedSchoolId:C.value,selectedClassIds:W.value,manualClassInput:R.value,selectedApiTypes:O.value,selectedEndpoints:G.value};await v(ae),K("✅ Configuration saved securely to Firebase!")}catch(ae){console.error("Failed to save configuration:",ae),K(`❌ Failed to save configuration: ${ae.message}`,!0)}},pe=async()=>{try{const ae=await A();if(!ae){K("❌ No saved configuration found",!0);return}i.baseUrl=ae.baseUrl||"",i.clientId=ae.clientId||"",i.clientSecret=ae.clientSecret||"",C.value=ae.selectedSchoolId||"",W.value=ae.selectedClassIds||[],R.value=ae.manualClassInput||"",ae.selectedApiTypes&&(O.value=ae.selectedApiTypes),ae.selectedEndpoints&&(G.value=ae.selectedEndpoints),ee();const de=ae.savedAt?new Date(ae.savedAt).toLocaleString():"Unknown";K(`✅ Configuration loaded securely (saved: ${de})`)}catch(ae){console.error("Failed to load configuration:",ae),K(`❌ Failed to load configuration: ${ae.message}`,!0)}},xe=async()=>{if(confirm("Are you sure you want to permanently delete the saved configuration? This action cannot be undone."))try{await D(),K("✅ Configuration permanently deleted from Firebase!")}catch(ae){console.error("Failed to clear configuration:",ae),K(`❌ Failed to clear configuration: ${ae.message}`,!0)}};return Gt(async()=>{try{if(await k()){const de=await A();de&&(i.baseUrl=de.baseUrl||"",i.clientId=de.clientId||"",i.clientSecret=de.clientSecret||"",de.selectedApiTypes&&(O.value=de.selectedApiTypes),de.selectedEndpoints&&(G.value=de.selectedEndpoints),ee(),K("✅ Configuration auto-loaded securely from Firebase"))}}catch(ae){console.error("Failed to auto-load configuration:",ae)}}),{connectionConfig:i,isConnected:t,isConnecting:e,isLoading:T,connectionStatus:n,isError:s,apiResults:x,currentEndpoint:m,responseTime:S,availableEndpoints:a,canConnect:H,loadDemoCredentials:l,connect:V,disconnect:u,testEndpoint:te,handleTestSpecialEd:oe,handleTestOneRosterSpecialEd:ne,handleTestStudentsWithSpecialEd:le,schools:I,selectedSchoolId:C,classes:F,selectedClassIds:W,classesFetchError:P,manualClassInput:R,canShowSchoolDropdown:J,canShowClasses:Q,configStatus:N,configError:M,storageLoading:b,storageError:_,saveConfiguration:Y,loadConfiguration:pe,clearConfiguration:xe,selectedApiTypes:O,selectedEndpoints:G,onerosterEndpoints:z,nativeAeriesEndpoints:j,hasSelectedApiTypes:ve,updateAvailableEndpoints:ee}}},sX={class:"aeries-api-connector"},aX={class:"connection-form"},iX={class:"form-group"},oX=["disabled"],lX={class:"form-group"},cX=["disabled"],uX={class:"form-group"},dX=["disabled"],fX={class:"button-group"},hX=["disabled"],pX=["disabled"],mX={class:"api-type-selection"},gX={class:"api-type-options"},vX={class:"api-type-option"},yX={class:"checkbox-label"},xX={class:"api-type-option"},EX={class:"checkbox-label"},_X={key:0,class:"endpoint-selection"},bX={class:"endpoint-categories"},SX={key:0,class:"endpoint-category"},AX={class:"endpoint-checkboxes"},TX=["value"],wX={class:"endpoint-name"},CX={class:"endpoint-path-small"},IX={key:1,class:"endpoint-category"},kX={class:"endpoint-checkboxes"},DX=["value"],PX={class:"endpoint-name"},RX={class:"endpoint-path-small"},FX={class:"config-management"},NX={class:"config-buttons"},OX=["disabled"],MX=["disabled"],LX=["disabled"],BX={key:1,class:"api-testing"},UX={class:"special-ed-section"},$X={class:"quick-test-buttons"},VX=["disabled"],HX=["disabled"],jX=["disabled"],GX=["disabled"],WX=["disabled"],zX=["disabled"],KX={class:"endpoint-grid"},qX={class:"endpoint-path"},XX={class:"endpoint-description"},YX=["onClick","disabled"],QX={key:0,class:"api-results"},JX={class:"results-header"},ZX={class:"endpoint-tested"},eY={key:0,class:"response-time"},tY={class:"results-content"},rY={key:2,class:"form-group"},nY=["value"],sY={key:3,class:"form-group"},aY={key:0},iY=["value"],oY={key:1};function lY(t,e,r,n,s,i){return L(),B("div",sX,[e[48]||(e[48]=Rn('<h3 data-v-0f37c4fc>Aeries API Connection</h3><div class="api-info-section" data-v-0f37c4fc><h4 data-v-0f37c4fc>Getting Students with IEP/504 Plans</h4><div class="info-grid" data-v-0f37c4fc><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc>🔍 OneRoster API (Limited)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> All students, basic info</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Cannot filter:</strong> Students with IEP/504 plans</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> You&#39;d get ALL students, not just SPED</p></div><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc>🎯 Custom Aeries API (Recommended)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> Only students with IEP/504 plans</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Includes:</strong> Accommodations, services, case managers</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> Perfect for your use case</p></div><div class="info-card" data-v-0f37c4fc><h5 data-v-0f37c4fc>📋 CSV Import (Fallback)</h5><p data-v-0f37c4fc><strong data-v-0f37c4fc>Can get:</strong> Filtered data from Aeries export</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Process:</strong> Export SPED students → Import CSV</p><p data-v-0f37c4fc><strong data-v-0f37c4fc>Result:</strong> Works but requires manual steps</p></div></div><div class="testing-note" data-v-0f37c4fc><p data-v-0f37c4fc><strong data-v-0f37c4fc>Test the buttons below to see what your Aeries instance supports!</strong></p></div></div>',2)),d("div",aX,[d("div",iX,[e[24]||(e[24]=d("label",{for:"baseUrl"},"Base URL:",-1)),Ne(d("input",{id:"baseUrl","onUpdate:modelValue":e[0]||(e[0]=a=>n.connectionConfig.baseUrl=a),type:"url",placeholder:"https://demo.aeries.net/aeries",disabled:n.isConnected},null,8,oX),[[ft,n.connectionConfig.baseUrl]])]),d("div",lX,[e[25]||(e[25]=d("label",{for:"clientId"},"Client ID:",-1)),Ne(d("input",{id:"clientId","onUpdate:modelValue":e[1]||(e[1]=a=>n.connectionConfig.clientId=a),type:"text",placeholder:"Enter your Client ID",disabled:n.isConnected},null,8,cX),[[ft,n.connectionConfig.clientId]])]),d("div",uX,[e[26]||(e[26]=d("label",{for:"clientSecret"},"Client Secret:",-1)),Ne(d("input",{id:"clientSecret","onUpdate:modelValue":e[2]||(e[2]=a=>n.connectionConfig.clientSecret=a),type:"password",placeholder:"Enter your Client Secret",disabled:n.isConnected},null,8,dX),[[ft,n.connectionConfig.clientSecret]])]),d("div",fX,[d("button",{onClick:e[3]||(e[3]=(...a)=>n.connect&&n.connect(...a)),disabled:!n.canConnect||n.isConnecting,class:"btn-primary"},Z(n.isConnecting?"Connecting...":"Connect"),9,hX),n.isConnected?(L(),B("button",{key:0,onClick:e[4]||(e[4]=(...a)=>n.disconnect&&n.disconnect(...a)),class:"btn-secondary"}," Disconnect ")):_e("",!0),d("button",{onClick:e[5]||(e[5]=(...a)=>n.loadDemoCredentials&&n.loadDemoCredentials(...a)),disabled:n.isConnected,class:"btn-demo"}," Load Demo Credentials ",8,pX)]),d("div",mX,[e[37]||(e[37]=d("h4",null,"Select API Types",-1)),e[38]||(e[38]=d("p",{class:"api-type-description"},"Choose which Aeries API types you want to use. This determines which endpoints will be available for testing and data import.",-1)),d("div",gX,[d("div",vX,[d("label",yX,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>n.selectedApiTypes.oneroster=a),onChange:e[7]||(e[7]=(...a)=>n.updateAvailableEndpoints&&n.updateAvailableEndpoints(...a))},null,544),[[bt,n.selectedApiTypes.oneroster]]),e[27]||(e[27]=d("span",{class:"checkmark"},null,-1)),e[28]||(e[28]=d("strong",null,"OneRoster API",-1))]),e[29]||(e[29]=d("p",{class:"api-type-desc"},"Standard OneRoster endpoints for basic student, teacher, and class data",-1))]),d("div",xX,[d("label",EX,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=a=>n.selectedApiTypes.nativeAeries=a),onChange:e[9]||(e[9]=(...a)=>n.updateAvailableEndpoints&&n.updateAvailableEndpoints(...a))},null,544),[[bt,n.selectedApiTypes.nativeAeries]]),e[30]||(e[30]=d("span",{class:"checkmark"},null,-1)),e[31]||(e[31]=d("strong",null,"Native Aeries v5 API",-1))]),e[32]||(e[32]=d("p",{class:"api-type-desc"},"Aeries-specific endpoints for special education, IEP, and 504 plan data",-1))])]),n.hasSelectedApiTypes?(L(),B("div",_X,[e[35]||(e[35]=d("h5",null,"Select Endpoints to Use",-1)),e[36]||(e[36]=d("p",{class:"endpoint-description"},"Check the endpoints you want to enable for data import and testing.",-1)),d("div",bX,[n.selectedApiTypes.oneroster?(L(),B("div",SX,[e[33]||(e[33]=d("h6",null,"OneRoster Endpoints",-1)),d("div",AX,[(L(!0),B(De,null,$e(n.onerosterEndpoints,a=>(L(),B("label",{key:a.path,class:"endpoint-checkbox"},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=o=>n.selectedEndpoints=o),value:a.path},null,8,TX),[[bt,n.selectedEndpoints]]),d("span",wX,Z(a.name),1),d("span",CX,Z(a.path),1)]))),128))])])):_e("",!0),n.selectedApiTypes.nativeAeries?(L(),B("div",IX,[e[34]||(e[34]=d("h6",null,"Native Aeries v5 Endpoints",-1)),d("div",kX,[(L(!0),B(De,null,$e(n.nativeAeriesEndpoints,a=>(L(),B("label",{key:a.path,class:"endpoint-checkbox"},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=o=>n.selectedEndpoints=o),value:a.path},null,8,DX),[[bt,n.selectedEndpoints]]),d("span",PX,Z(a.name),1),d("span",RX,Z(a.path),1)]))),128))])])):_e("",!0)])])):_e("",!0)]),d("div",FX,[e[39]||(e[39]=d("h4",null,"Save/Load Configuration",-1)),e[40]||(e[40]=d("div",{class:"security-note"},[d("p",null,[d("strong",null,"🔒 Security:"),we(" Your API credentials are encrypted and stored securely in Firebase. Only you can access your saved configuration.")])],-1)),d("div",NX,[d("button",{onClick:e[12]||(e[12]=(...a)=>n.saveConfiguration&&n.saveConfiguration(...a)),disabled:!n.canConnect||n.storageLoading,class:"btn-save"},Z(n.storageLoading?"⏳ Saving...":"💾 Save Configuration"),9,OX),d("button",{onClick:e[13]||(e[13]=(...a)=>n.loadConfiguration&&n.loadConfiguration(...a)),disabled:n.storageLoading,class:"btn-load"},Z(n.storageLoading?"⏳ Loading...":"📂 Load Saved Configuration"),9,MX),d("button",{onClick:e[14]||(e[14]=(...a)=>n.clearConfiguration&&n.clearConfiguration(...a)),disabled:n.storageLoading,class:"btn-clear"},Z(n.storageLoading?"⏳ Deleting...":"🗑️ Clear Saved Configuration"),9,LX)]),n.configStatus?(L(),B("div",{key:0,class:Xe(["config-status",{error:n.configError}])},Z(n.configStatus),3)):_e("",!0)])]),n.connectionStatus?(L(),B("div",{key:0,class:Xe(["status-message",{error:n.isError}])},Z(n.connectionStatus),3)):_e("",!0),n.isConnected?(L(),B("div",BX,[e[43]||(e[43]=d("h4",null,"Test API Endpoints",-1)),d("div",UX,[e[41]||(e[41]=d("h5",null,"Special Education Data (IEP/504)",-1)),d("div",$X,[d("button",{onClick:e[15]||(e[15]=(...a)=>n.handleTestSpecialEd&&n.handleTestSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-special"},Z(n.isLoading?"Testing...":"Test All SPED Endpoints"),9,VX),d("button",{onClick:e[16]||(e[16]=(...a)=>n.handleTestOneRosterSpecialEd&&n.handleTestOneRosterSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-oneroster"}," Test OneRoster for SPED Data ",8,HX),d("button",{onClick:e[17]||(e[17]=(...a)=>n.handleTestStudentsWithSpecialEd&&n.handleTestStudentsWithSpecialEd(...a)),disabled:n.isLoading,class:"btn-test-oneroster"}," Test OneRoster SPED Filters ",8,jX),d("button",{onClick:e[18]||(e[18]=a=>t.handleTestEndpoint("/api/special-education/students")),disabled:n.isLoading,class:"btn-test-special"}," SPED Students ",8,GX),d("button",{onClick:e[19]||(e[19]=a=>t.handleTestEndpoint("/api/special-education/ieps")),disabled:n.isLoading,class:"btn-test-special"}," IEP Records ",8,WX),d("button",{onClick:e[20]||(e[20]=a=>t.handleTestEndpoint("/api/special-education/504-plans")),disabled:n.isLoading,class:"btn-test-special"}," 504 Plans ",8,zX)])]),d("div",KX,[(L(!0),B(De,null,$e(n.availableEndpoints,a=>(L(),B("div",{key:a.path,class:"endpoint-card"},[d("h5",null,Z(a.name),1),d("p",qX,Z(a.path),1),d("p",XX,Z(a.description),1),d("button",{onClick:o=>n.testEndpoint(a.path),disabled:n.isLoading,class:"btn-test"},Z(n.isLoading&&n.currentEndpoint===a.path?"Testing...":"Test"),9,YX)]))),128))]),n.apiResults?(L(),B("div",QX,[e[42]||(e[42]=d("h4",null,"API Response",-1)),d("div",JX,[d("span",ZX,"Endpoint: "+Z(n.currentEndpoint),1),n.responseTime?(L(),B("span",eY,"Response time: "+Z(n.responseTime)+"ms",1)):_e("",!0)]),d("div",tY,[d("pre",null,Z(JSON.stringify(n.apiResults,null,2)),1)])])):_e("",!0)])):_e("",!0),n.canShowSchoolDropdown?(L(),B("div",rY,[e[45]||(e[45]=d("label",null,"School",-1)),Ne(d("select",{"onUpdate:modelValue":e[21]||(e[21]=a=>n.selectedSchoolId=a)},[e[44]||(e[44]=d("option",{value:"",disabled:""},"Select a school",-1)),(L(!0),B(De,null,$e(n.schools,a=>(L(),B("option",{key:a.sourcedId||a.id||a.schoolId,value:a.sourcedId||a.id||a.schoolId},Z(a.name||a.title||a.schoolName),9,nY))),128))],512),[[sr,n.selectedSchoolId]])])):_e("",!0),n.canShowClasses?(L(),B("div",sY,[e[47]||(e[47]=d("label",null,"Case Manager Classes",-1)),n.classesFetchError?(L(),B("div",oY,[e[46]||(e[46]=d("p",{class:"error"},"Could not fetch classes. Enter class names manually (comma separated):",-1)),Ne(d("input",{"onUpdate:modelValue":e[23]||(e[23]=a=>n.manualClassInput=a),type:"text",placeholder:"Class1, Class2, ..."},null,512),[[ft,n.manualClassInput]])])):(L(),B("div",aY,[Ne(d("select",{"onUpdate:modelValue":e[22]||(e[22]=a=>n.selectedClassIds=a),multiple:""},[(L(!0),B(De,null,$e(n.classes,a=>(L(),B("option",{key:a.sourcedId||a.id||a.classId,value:a.sourcedId||a.id||a.classId},Z(a.title||a.name||a.className),9,iY))),128))],512),[[sr,n.selectedClassIds]])]))])):_e("",!0)])}const cY=St(nX,[["render",lY],["__scopeId","data-v-0f37c4fc"]]),uY={key:0,class:"app-settings-panel"},dY={class:"settings-section"},fY={class:"grades-checkboxes"},hY=["checked"],pY=["value"],mY={class:"settings-section"},gY={key:0,class:"class-service-fieldset"},vY={class:"checkbox-inline-group"},yY=["value"],xY={key:1,class:"class-service-fieldset"},EY={class:"checkbox-inline-group"},_Y=["value"],bY={key:2,class:"class-service-fieldset"},SY={class:"checkbox-inline-group"},AY=["value"],TY={key:3,class:"class-service-fieldset"},wY={class:"checkbox-inline-group"},CY=["value"],IY=["onClick"],kY={class:"checkbox-inline-group"},DY=["onClick"],PY=["onClick"],RY={class:"add-class-service"},FY={class:"custom-chips"},NY=["onClick"],OY={class:"settings-section"},MY={class:"service-providers-defaults"},LY=["value"],BY={class:"service-providers-custom"},UY={class:"custom-provider-inputs"},$Y={class:"custom-chips"},VY=["onClick"],HY={class:"settings-section"},jY={class:"periods-controls"},GY={class:"period-number-control"},WY=["value"],zY={key:0,class:"period-labels"},KY={class:"period-labels-grid"},qY=["onUpdate:modelValue","placeholder"],XY={key:1,class:"period-preview"},YY={class:"settings-section"},QY={class:"gmail-api-settings"},JY={class:"gmail-api-status"},ZY={class:"status-indicators"},eQ={class:"status-item"},tQ={class:"status-item"},rQ={class:"status-item"},nQ={key:0,class:"status-message"},sQ={key:1,class:"last-check"},aQ={class:"gmail-api-actions"},iQ=["disabled"],oQ={class:"settings-section"},lQ={class:"admin-action-btns"},cQ=["disabled"],uQ=["disabled"],dQ=["disabled"],fQ={key:1,class:"not-admin"},hQ={__name:"AppSettings",setup(t){const{loadAppSettings:e,saveAppSettings:r,checkGmailApiStatus:n}=Ms(),s=on(),i=Se(()=>s.currentUser),a=Se(()=>{var H;return((H=i.value)==null?void 0:H.role)||null}),o=Se(()=>["admin","school_admin","admin_504","sped_chair"].includes(a.value)),l=[{value:"K",label:"K"},...Array.from({length:12},(H,V)=>({value:(V+1).toString(),label:(V+1).toString()}))],c=["English","Math","History","Science"],u=[{name:"Speech-Language Therapy",abbreviation:"SLP"},{name:"Occupational Therapy",abbreviation:"OT"},{name:"Physical Therapy",abbreviation:"PT"},{name:"School Counseling",abbreviation:"SC"},{name:"School-Based Mental Health Services",abbreviation:"MH"},{name:"Transportation",abbreviation:"TR"},{name:"Audiology Services",abbreviation:"AUD"},{name:"Vision Services",abbreviation:"VI"},{name:"Assistive Technology",abbreviation:"AT"},{name:"Deaf and Hard of Hearing Services",abbreviation:"DHH"},{name:"Orientation and Mobility",abbreviation:"O&M"},{name:"Behavioral Intervention Services",abbreviation:"BIS"},{name:"Health/Nursing Services",abbreviation:"HN"},{name:"Social Work Services",abbreviation:"SW"}],f=se(!1),h=se(!1),p=se(!1),g=se(""),y=se(!1),E=se(""),b=se(""),_=se(""),v=se(""),A=se([]),D=se({grades:["7","8"],classServices:[{name:"SDC",subcategories:[...c],enabledSubcategories:[...c]},{name:"Co-teach",subcategories:[...c],enabledSubcategories:[...c]},{name:"RSP",subcategories:[...c],enabledSubcategories:[...c]},{name:"Other",subcategories:["FA","Directed Studies","DS: Reading Intv"],enabledSubcategories:["FA","Directed Studies","DS: Reading Intv"]}],serviceProviders:["SLP","OT","MH"],serviceProvidersDetails:u,customServiceProviders:[],numPeriods:7,periodLabels:["1","2","3","4","5","6","sh"]}),k=H=>{const V=z_(H.numPeriods,{min:1,max:15,decimals:0});if(V===null)return C("Invalid number of periods. Must be between 1 and 15.",!0),!1;H.numPeriods=V,H.numPeriods<=0&&(console.log("🔧 Preventing save of invalid numPeriods, setting to 7"),H.numPeriods=7);for(let te=0;te<H.numPeriods;te++){H.periodLabels[te]||(H.periodLabels[te]=`Per${te+1}`);const oe=qr(H.periodLabels[te],{trim:!0,maxLength:3,removeDangerous:!0}),ne=Hr(oe);if(!ne.isSafe)return C(`Security threat detected in period ${te+1} label: ${ne.threats.join(", ")}`,!0),!1;const le=Cd(oe,{max:3,fieldName:`Period ${te+1} label`});if(!le.isValid)return C(le.error,!0),!1;H.periodLabels[te]=oe}if(H.customServiceProviders)for(let te=0;te<H.customServiceProviders.length;te++){const oe=H.customServiceProviders[te];if(oe.name){const ne=qr(oe.name,{trim:!0,maxLength:100,removeDangerous:!0}),le=Hr(ne);if(!le.isSafe)return C(`Security threat detected in custom provider ${te+1}: ${le.threats.join(", ")}`,!0),!1;oe.name=ne}if(oe.abbreviation){const ne=qr(oe.abbreviation,{trim:!0,maxLength:10,removeDangerous:!0}),le=Hr(ne);if(!le.isSafe)return C(`Security threat detected in custom provider abbreviation ${te+1}: ${le.threats.join(", ")}`,!0),!1;oe.abbreviation=ne}}return!0},T=Se(()=>u),x=Se(()=>l.every(H=>D.value.grades.includes(H.value))),m=H=>{H.target.checked?D.value.grades=l.map(V=>V.value):D.value.grades=[]},S=()=>{if(!E.value.trim()||!b.value.trim()){C("Both name and abbreviation are required for custom service providers",!0);return}if(D.value.customServiceProviders.some(V=>V.abbreviation.toLowerCase()===b.value.toLowerCase())){C("A service provider with this abbreviation already exists",!0);return}D.value.customServiceProviders.push({name:E.value.trim(),abbreviation:b.value.trim()}),E.value="",b.value="",C("Custom service provider added successfully")},I=H=>{D.value.customServiceProviders.splice(H,1)};Ht(()=>D.value.numPeriods,(H,V)=>{if(h.value||p.value||f.value||H===V)return;const te=z_(H,{min:1,max:15,decimals:0});if(te!==null&&te!==H){p.value=!0,D.value.numPeriods=te,setTimeout(()=>{p.value=!1},50);return}if(te!==null&&te>0){const oe=["1","2","3","4","5","6","sh"],ne=[...D.value.periodLabels||[]];if(p.value=!0,ne.length<te){for(let le=ne.length;le<te;le++)ne.push(oe[le]||`${le+1}`);D.value.periodLabels=ne}else ne.length>te&&(D.value.periodLabels=ne.slice(0,te));setTimeout(()=>{p.value=!1},50)}}),Ht(()=>D.value.periodLabels,(H,V)=>{if(h.value||p.value||f.value||!H||!Array.isArray(H))return;let te=!1;const oe=[...H];H.forEach((ne,le)=>{ne&&typeof ne=="string"&&ne.length>3&&(oe[le]=ne.substring(0,3),te=!0)}),te&&(p.value=!0,D.value.periodLabels=oe,setTimeout(()=>{p.value=!1},50))},{deep:!0});const C=(H,V=!1)=>{g.value=H,y.value=V,setTimeout(()=>{g.value="",y.value=!1},5e3)},F=async(H=!1)=>{f.value=!0;try{const V=await e();if(V){if(p.value=!0,D.value={...D.value,...V},(isNaN(D.value.numPeriods)||D.value.numPeriods===null||D.value.numPeriods===void 0||D.value.numPeriods<=0)&&(console.log("🔧 Fixing invalid numPeriods, setting to 7"),D.value.numPeriods=7),Array.isArray(D.value.periodLabels)||(D.value.periodLabels=[]),!D.value.periodLabels||D.value.periodLabels.length<D.value.numPeriods){const te=["1","2","3","4","5","6","sh"],oe=D.value.periodLabels||[],ne=[];for(let le=0;le<D.value.numPeriods;le++)ne[le]=oe[le]||te[le]||`${le+1}`;D.value.periodLabels=ne}setTimeout(()=>{p.value=!1},100),H&&C("Settings loaded successfully")}}catch(V){console.error("Load settings error:",V),C("Error loading settings",!0)}finally{f.value=!1}},W=async()=>{if(console.log("🔧 STEP 1: Starting save operation..."),!Rs("saveAppSettings",10,6e4).allowed){console.log("❌ STEP 1 FAILED: Rate limit exceeded"),C("Too many save requests. Please wait before saving again.",!0);return}console.log("✅ STEP 1 COMPLETE: Rate limit check passed"),console.log("🔧 STEP 2: Preventing watchers and preparing settings..."),p.value=!0,h.value=!0;try{console.log("🔧 STEP 3: Creating non-reactive copy for validation...");const V=JSON.parse(JSON.stringify(D.value));if(console.log("🔧 STEP 4: Validating settings copy..."),!k(V)){console.log("❌ STEP 4 FAILED: Validation failed"),p.value=!1,h.value=!1;return}console.log("✅ STEP 4 COMPLETE: Validation passed"),console.log("🔧 STEP 5: Calling saveAppSettings..."),await r(V),console.log("✅ STEP 5 COMPLETE: saveAppSettings returned successfully"),C("Settings saved successfully"),console.log("✅ SAVE OPERATION COMPLETED SUCCESSFULLY")}catch(V){console.error("❌ SAVE OPERATION FAILED at some step"),console.error("❌ Error:",V),console.error("❌ Error message:",V.message),console.error("❌ Error stack:",V.stack),V.message==="Save operation timed out"?C("Save operation timed out. Please try again.",!0):V.message&&V.message.includes("quota")?C("Storage quota exceeded. Please contact administrator.",!0):V.message&&V.message.includes("permission")?C("Permission denied. Please check your access rights.",!0):C("Error saving settings: "+(V.message||"Unknown error"),!0)}finally{console.log("👉 saveSettings: before cleanup"),console.log("🔧 STEP 7: Cleaning up - setting saveLoading to false"),h.value=!1,setTimeout(()=>{p.value=!1},100),console.log("👉 saveSettings: after cleanup"),console.log("✅ STEP 7 COMPLETE: Cleanup finished")}},P=()=>{confirm("Are you sure you want to reset all settings to defaults? This cannot be undone.")&&(D.value={grades:["7","8"],classServices:[{name:"SDC",subcategories:[...c],enabledSubcategories:[...c]},{name:"Co-teach",subcategories:[...c],enabledSubcategories:[...c]},{name:"RSP",subcategories:[...c],enabledSubcategories:[...c]},{name:"Other",subcategories:["FA","Directed Studies","DS: Reading Intv"],enabledSubcategories:["FA","Directed Studies","DS: Reading Intv"]}],serviceProviders:["SLP","OT","MH"],serviceProvidersDetails:u,customServiceProviders:[],numPeriods:7,periodLabels:["1","2","3","4","5","6","sh"]},C("Settings reset to defaults"))},R=H=>{const V=prompt("Enter new subcategory name:");if(V&&V.trim()){const te=qr(V.trim(),{maxLength:18,removeDangerous:!0});te&&(D.value.classServices[H]||(D.value.classServices[H]={name:"",subcategories:[],enabledSubcategories:[]}),D.value.classServices[H].subcategories.includes(te)?C("Subcategory already exists",!0):(D.value.classServices[H].subcategories.push(te),D.value.classServices[H].enabledSubcategories.push(te),C("Subcategory added successfully")))}},N=(H,V)=>{if(confirm("Are you sure you want to remove this subcategory?")){const te=D.value.classServices[H],oe=te.subcategories[V];te.subcategories.splice(V,1);const ne=te.enabledSubcategories.indexOf(oe);ne>-1&&te.enabledSubcategories.splice(ne,1),C("Subcategory removed successfully")}},M=()=>{if(v.value&&v.value.trim()){const H=qr(v.value.trim(),{maxLength:18,removeDangerous:!0});H&&!A.value.includes(H)?(A.value.push(H),v.value=""):A.value.includes(H)&&C("Subcategory already added",!0)}},O=H=>{A.value.splice(H,1)},G=()=>{if(!_.value||!_.value.trim()){C("Please enter a service name",!0);return}if(A.value.length===0){C("Please add at least one subcategory",!0);return}const H=qr(_.value.trim(),{maxLength:18,removeDangerous:!0});if(H){if(D.value.classServices.find(oe=>oe.name===H)){C("Service with this name already exists",!0);return}const te={name:H,subcategories:[...A.value],enabledSubcategories:[...A.value]};D.value.classServices.push(te),_.value="",v.value="",A.value=[],C("Class service added successfully")}},z=H=>{confirm("Are you sure you want to remove this class service?")&&(D.value.classServices.splice(H,1),C("Class service removed successfully"))},j=async()=>{f.value=!0;try{const H=await n();H.enabled?C("Gmail API is enabled and ready to use!"):C(`Gmail API status: Workspace: ${H.isWorkspace?"Yes":"No"}, Internal OAuth: ${H.isInternalOAuth?"Yes":"No"}`,!0)}catch(H){C("Failed to check Gmail API status: "+H.message,!0)}finally{f.value=!1}};return Gt(()=>{F()}),(H,V)=>{var te,oe,ne,le,J,Q,ve,ee;return o.value?(L(),B("div",uY,[V[32]||(V[32]=d("h2",null,"App Settings",-1)),d("form",{onSubmit:Yr(W,["prevent"])},[d("section",dY,[d("fieldset",null,[V[13]||(V[13]=d("legend",null,"Grades",-1)),d("div",fY,[d("label",null,[d("input",{type:"checkbox",checked:x.value,onChange:m},null,40,hY),V[12]||(V[12]=d("span",null,"Select All",-1))]),(L(),B(De,null,$e(l,K=>d("label",{key:K.value},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":V[0]||(V[0]=Y=>D.value.grades=Y),value:K.value},null,8,pY),[[bt,D.value.grades]]),d("span",null,Z(K.label),1)])),64))])])]),d("section",mY,[V[19]||(V[19]=d("h3",null,"Class Services",-1)),D.value.classServices[0]&&D.value.classServices[0].enabledSubcategories?(L(),B("div",gY,[d("fieldset",null,[V[14]||(V[14]=d("legend",null,"SDC",-1)),d("div",vY,[(L(),B(De,null,$e(c,K=>d("label",{key:K},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":V[1]||(V[1]=Y=>D.value.classServices[0].enabledSubcategories=Y),value:K},null,8,yY),[[bt,D.value.classServices[0].enabledSubcategories]]),we(" "+Z(K),1)])),64))])])])):_e("",!0),D.value.classServices[1]&&D.value.classServices[1].enabledSubcategories?(L(),B("div",xY,[d("fieldset",null,[V[15]||(V[15]=d("legend",null,"Co-teach",-1)),d("div",EY,[(L(),B(De,null,$e(c,K=>d("label",{key:K},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":V[2]||(V[2]=Y=>D.value.classServices[1].enabledSubcategories=Y),value:K},null,8,_Y),[[bt,D.value.classServices[1].enabledSubcategories]]),we(" "+Z(K),1)])),64))])])])):_e("",!0),D.value.classServices[2]&&D.value.classServices[2].enabledSubcategories?(L(),B("div",bY,[d("fieldset",null,[V[16]||(V[16]=d("legend",null,"RSP",-1)),d("div",SY,[(L(),B(De,null,$e(c,K=>d("label",{key:K},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":V[3]||(V[3]=Y=>D.value.classServices[2].enabledSubcategories=Y),value:K},null,8,AY),[[bt,D.value.classServices[2].enabledSubcategories]]),we(" "+Z(K),1)])),64))])])])):_e("",!0),D.value.classServices[3]&&D.value.classServices[3].enabledSubcategories?(L(),B("div",TY,[d("fieldset",null,[V[17]||(V[17]=d("legend",null,"Other",-1)),d("div",wY,[(L(),B(De,null,$e(["FA","Directed Studies","DS: Reading Intv"],K=>d("label",{key:K},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":V[4]||(V[4]=Y=>D.value.classServices[3].enabledSubcategories=Y),value:K},null,8,CY),[[bt,D.value.classServices[3].enabledSubcategories]]),we(" "+Z(K),1)])),64))])])])):_e("",!0),(L(!0),B(De,null,$e(D.value.classServices.slice(4),(K,Y)=>(L(),B("div",{key:K.name,class:"class-service-fieldset"},[d("fieldset",null,[d("legend",null,[we(Z(K.name)+" ",1),d("button",{type:"button",onClick:pe=>z(Y+4),title:"Remove Service"},"×",8,IY)]),d("div",kY,[(L(!0),B(De,null,$e(K.subcategories,(pe,xe)=>(L(),B("label",{key:pe},[V[18]||(V[18]=d("input",{type:"checkbox",checked:!0,disabled:""},null,-1)),we(" "+Z(pe)+" ",1),d("button",{type:"button",onClick:ae=>N(Y+4,xe),title:"Remove Subcategory"},"×",8,DY)]))),128)),d("button",{type:"button",onClick:pe=>R(Y+4)},"+ Add Subcategory",8,PY)])])]))),128)),d("div",RY,[Ne(d("input",{type:"text","onUpdate:modelValue":V[5]||(V[5]=K=>_.value=K),placeholder:"New Service Name",maxlength:"18"},null,512),[[ft,_.value]]),Ne(d("input",{type:"text","onUpdate:modelValue":V[6]||(V[6]=K=>v.value=K),placeholder:"Add Subcategory",maxlength:"18",onKeyup:F1(M,["enter"])},null,544),[[ft,v.value]]),d("button",{type:"button",onClick:M},"+ Add Subcategory"),d("div",FY,[(L(!0),B(De,null,$e(A.value,(K,Y)=>(L(),B("span",{key:K,class:"chip"},[we(Z(K)+" ",1),d("button",{type:"button",onClick:pe=>O(Y)},"×",8,NY)]))),128))]),d("button",{type:"button",onClick:G},"+ Add Class Service")])]),d("section",OY,[d("fieldset",null,[V[21]||(V[21]=d("legend",null,"Service Providers",-1)),d("div",MY,[(L(!0),B(De,null,$e(T.value,K=>(L(),B("label",{key:K.abbreviation},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":V[7]||(V[7]=Y=>D.value.serviceProviders=Y),value:K.abbreviation},null,8,LY),[[bt,D.value.serviceProviders]]),d("span",null,Z(K.name)+" ("+Z(K.abbreviation)+")",1)]))),128))]),d("div",BY,[V[20]||(V[20]=d("label",null,"Add Custom Service Provider:",-1)),d("div",UY,[Ne(d("input",{type:"text","onUpdate:modelValue":V[8]||(V[8]=K=>E.value=K),placeholder:"Full Name",maxlength:"100"},null,512),[[ft,E.value]]),Ne(d("input",{type:"text","onUpdate:modelValue":V[9]||(V[9]=K=>b.value=K),placeholder:"Abbreviation",maxlength:"10"},null,512),[[ft,b.value]]),d("button",{type:"button",onClick:S},"Add")]),d("div",$Y,[(L(!0),B(De,null,$e(D.value.customServiceProviders,(K,Y)=>(L(),B("span",{key:Y,class:"chip"},[we(Z(K.name)+" ("+Z(K.abbreviation)+") ",1),d("button",{type:"button",onClick:pe=>I(Y)},"×",8,VY)]))),128))])])])]),d("section",HY,[d("fieldset",null,[V[25]||(V[25]=d("legend",null,"Periods",-1)),d("div",jY,[d("div",GY,[d("label",null,[V[22]||(V[22]=we(" Number of Periods: ")),Ne(d("select",{"onUpdate:modelValue":V[10]||(V[10]=K=>D.value.numPeriods=K),class:"period-number-select"},[(L(),B(De,null,$e(15,K=>d("option",{key:K,value:K},Z(K),9,WY)),64))],512),[[sr,D.value.numPeriods]])])]),D.value.numPeriods>0?(L(),B("div",zY,[V[23]||(V[23]=d("h4",null,"Period Labels (3 chars max each):",-1)),d("div",KY,[(L(!0),B(De,null,$e(D.value.numPeriods,K=>(L(),B("div",{key:K,class:"period-label-item"},[d("label",null,[we(" Period "+Z(K)+": ",1),Ne(d("input",{type:"text","onUpdate:modelValue":Y=>D.value.periodLabels[K-1]=Y,maxlength:"3",placeholder:`Per${K}`,class:"period-label-input"},null,8,qY),[[ft,D.value.periodLabels[K-1]]])])]))),128))])])):_e("",!0),D.value.numPeriods>0?(L(),B("div",XY,[V[24]||(V[24]=d("strong",null,"Preview:",-1)),(L(!0),B(De,null,$e(D.value.numPeriods,K=>(L(),B("span",{key:K,class:"period-preview-item"},Z(D.value.periodLabels[K-1]||`Per${K}`),1))),128))])):_e("",!0)])])]),d("section",YY,[d("fieldset",null,[V[31]||(V[31]=d("legend",null,"Gmail API Settings",-1)),d("div",QY,[d("div",JY,[V[30]||(V[30]=d("h4",null,"Status:",-1)),d("div",ZY,[d("div",eQ,[V[26]||(V[26]=d("span",{class:"status-label"},"Google Workspace:",-1)),d("span",{class:Xe(["status-value",(te=D.value.gmailApi)!=null&&te.isWorkspace?"enabled":"disabled"])},Z((oe=D.value.gmailApi)!=null&&oe.isWorkspace?"Yes":"No"),3)]),d("div",tQ,[V[27]||(V[27]=d("span",{class:"status-label"},"Internal OAuth:",-1)),d("span",{class:Xe(["status-value",(ne=D.value.gmailApi)!=null&&ne.isInternalOAuth?"enabled":"disabled"])},Z((le=D.value.gmailApi)!=null&&le.isInternalOAuth?"Yes":"No"),3)]),d("div",rQ,[V[28]||(V[28]=d("span",{class:"status-label"},"Gmail API:",-1)),d("span",{class:Xe(["status-value",(J=D.value.gmailApi)!=null&&J.enabled?"enabled":"disabled"])},Z((Q=D.value.gmailApi)!=null&&Q.enabled?"Enabled":"Disabled"),3)])]),(ve=D.value.gmailApi)!=null&&ve.enabled?_e("",!0):(L(),B("div",nQ,V[29]||(V[29]=[d("p",null,"Gmail API features are currently disabled. To enable them, you need:",-1),d("ul",null,[d("li",null,"A Google Workspace organization (not a personal Gmail account)"),d("li",null,'OAuth consent screen set to "Internal" in Google Cloud Console')],-1),d("p",null,"Contact your Google Workspace administrator to configure these settings.",-1)]))),(ee=D.value.gmailApi)!=null&&ee.lastCheck?(L(),B("div",sQ," Last checked: "+Z(new Date(D.value.gmailApi.lastCheck).toLocaleString()),1)):_e("",!0)]),d("div",aQ,[d("button",{type:"button",onClick:j,disabled:f.value}," Check Gmail API Status ",8,iQ)])])])]),d("section",oQ,[d("div",lQ,[d("button",{type:"submit",disabled:h.value||f.value,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},"💾 Save Settings",8,cQ),d("button",{type:"button",onClick:V[11]||(V[11]=()=>F(!0)),disabled:f.value,class:"admin-action-btn info",style:{"min-width":"100px","max-width":"100px"}},"📂 Load",8,uQ),d("button",{type:"button",onClick:P,disabled:f.value,class:"admin-action-btn warning",style:{"min-width":"100px","max-width":"100px"}},"↩️ Reset",8,dQ)]),g.value?(L(),B("div",{key:0,class:Xe(["status-message",{error:y.value,success:!y.value}])},Z(g.value),3)):_e("",!0)])],32)])):(L(),B("div",fQ,V[33]||(V[33]=[d("h2",null,"App Settings",-1),d("p",null,"Access denied. You must be an admin to view this page.",-1)])))}}},pQ=St(hQ,[["__scopeId","data-v-01d825d5"]]),mQ={class:"admin-aide-assignment"},gQ={class:"header"},vQ={class:"header-actions"},yQ=["disabled"],xQ={key:0},EQ={key:1},_Q={class:"content"},bQ={key:0,class:"error-message"},SQ={key:1,class:"error-message"},AQ={key:2,class:"loading"},TQ={key:3,class:"schedule-container"},wQ={class:"aide-schedule-table"},CQ={class:"aide-name"},IQ=["value","onChange"],kQ=["value"],DQ={class:"assignment-buttons"},PQ=["onClick"],RQ=["onClick"],FQ={class:"direct-assignment-cell"},NQ=["value","onChange"],OQ=["value"],MQ={class:"assignment-buttons"},LQ=["onClick"],BQ=["onClick"],UQ={__name:"AdminAideAssignment",setup(t){const e=ki(),{userList:r,fetchUsers:n}=ba(),{students:s,fetchStudents:i}=Di(),a=on(),{aideAssignment:o,loadAideAssignments:l,saveAllAideAssignments:c}=Jy(),{appSettings:u,loadAppSettings:f}=Ms(),h=se(!0),p=se(!1),g=Se(()=>{var R;const P=(R=a.currentUser)==null?void 0:R.role;return["admin","school_admin","admin_504","sped_chair"].includes(P)}),y=Se(()=>{var P;return((P=r.value)==null?void 0:P.filter(R=>R.role==="paraeducator"))||[]}),E=Se(()=>{var P;return((P=r.value)==null?void 0:P.filter(R=>R.role==="teacher"))||[]}),b=Se(()=>{var R;const P=((R=u.value)==null?void 0:R.numPeriods)||7;return Array.from({length:P},(N,M)=>M+1)});function _(P){return P.id}function v(P){return P.id}function A(P,R){if(!o.value[P])return[""];o.value[P].classAssignment||(o.value[P].classAssignment={});let N=o.value[P].classAssignment[R];return Array.isArray(N)?N.length?N:[""]:typeof N=="string"&&N!==""?[N]:[""]}function D(P){if(!o.value[P])return[""];let R=o.value[P].directAssignment;return Array.isArray(R)?R.length?R:[""]:typeof R=="string"&&R!==""?[R]:[""]}function k(P,R,N,M){o.value[P]||(o.value[P]={classAssignment:{},directAssignment:[]}),o.value[P].classAssignment||(o.value[P].classAssignment={});let O=A(P,R);for(O[N]=M;O.length>1&&O[O.length-1]==="";)O.pop();o.value[P].classAssignment[R]=[...O]}function T(P,R,N){o.value[P]||(o.value[P]={classAssignment:{},directAssignment:[]});let M=D(P);for(M[R]=N;M.length>1&&M[M.length-1]==="";)M.pop();o.value[P].directAssignment=[...M]}function x(P,R){o.value[P]||(o.value[P]={classAssignment:{},directAssignment:[]}),o.value[P].classAssignment||(o.value[P].classAssignment={});let N=A(P,R);N.push(""),o.value[P].classAssignment[R]=[...N]}function m(P,R,N){if(!o.value[P]||!o.value[P].classAssignment)return;let M=A(P,R);M.length<=1||(M.splice(N,1),o.value[P].classAssignment[R]=[...M])}function S(P){o.value[P]||(o.value[P]={classAssignment:{},directAssignment:[]});let R=D(P);R.push(""),o.value[P].directAssignment=[...R]}function I(P,R){if(!o.value[P])return;let N=D(P);N.length<=1||(N.splice(R,1),o.value[P].directAssignment=[...N])}async function C(){try{h.value=!0,await Promise.all([n(),i(),l(),f()]),h.value=!1}catch(P){console.error("Error loading data:",P),h.value=!1}}async function F(){try{p.value=!0,await c(),p.value=!1}catch(P){console.error("Error saving aide assignments:",P),p.value=!1}}function W(){e.push("/admin")}return Gt(C),(P,R)=>(L(),B("div",mQ,[d("div",gQ,[R[3]||(R[3]=d("h1",null,"Aide Assignment Management",-1)),d("div",vQ,[d("button",{onClick:F,class:"btn btn-primary",disabled:p.value},[p.value?(L(),B("span",xQ,"💾")):(L(),B("span",EQ,"💾")),we(" "+Z(p.value?"Saving...":"Save Assignments"),1)],8,yQ),d("button",{onClick:W,class:"btn btn-secondary"},R[2]||(R[2]=[d("span",null,"←",-1),we(" Back ")]))])]),d("div",_Q,[q(a).currentUser?g.value?h.value?(L(),B("div",AQ," Loading aide assignments... ")):(L(),B("div",TQ,[d("table",wQ,[d("thead",null,[d("tr",null,[R[8]||(R[8]=d("th",null,"Aide Name",-1)),(L(!0),B(De,null,$e(b.value,N=>(L(),B("th",{key:N,class:"period-header"}," Period "+Z(N),1))),128)),R[9]||(R[9]=d("th",null,"Direct Assignment",-1))])]),d("tbody",null,[(L(!0),B(De,null,$e(y.value,N=>(L(),B("tr",{key:N.id,class:"aide-row"},[d("td",CQ,Z(N.name||N.email),1),(L(!0),B(De,null,$e(b.value,M=>(L(),B("td",{key:M,class:"period-cell"},[(L(!0),B(De,null,$e(A(_(N),M),(O,G)=>(L(),B("div",{key:"t-"+G,class:"assignment-row"},[d("select",{value:O,onChange:z=>k(_(N),M,G,z.target.value),class:"teacher-select"},[R[10]||(R[10]=d("option",{value:""},"No Assignment",-1)),(L(!0),B(De,null,$e(E.value,z=>(L(),B("option",{key:v(z),value:v(z)},Z(z.name||z.email),9,kQ))),128))],40,IQ),d("div",DQ,[A(_(N),M).length>1?(L(),B("button",{key:0,onClick:z=>m(_(N),M,G),class:"btn btn-small btn-danger assignment-remove",title:"Remove assignment",type:"button"},"–",8,PQ)):_e("",!0),G===A(_(N),M).length-1?(L(),B("button",{key:1,onClick:z=>x(_(N),M),class:"btn btn-small btn-secondary assignment-add",title:"Add assignment",type:"button"},"+",8,RQ)):_e("",!0)])]))),128))]))),128)),d("td",FQ,[(L(!0),B(De,null,$e(D(_(N)),(M,O)=>(L(),B("div",{key:"d-"+O,class:"assignment-row"},[d("select",{value:M,onChange:G=>T(_(N),O,G.target.value),class:"student-select"},[R[11]||(R[11]=d("option",{value:""},"No Assignment",-1)),(L(!0),B(De,null,$e(q(s),G=>(L(),B("option",{key:G.id,value:G.id},Z(q(it)(G,"firstName"))+" "+Z(q(it)(G,"lastName")),9,OQ))),128))],40,NQ),d("div",MQ,[D(_(N)).length>1?(L(),B("button",{key:0,onClick:G=>I(_(N),O),class:"btn btn-small btn-danger assignment-remove",title:"Remove assignment",type:"button"},"–",8,LQ)):_e("",!0),O===D(_(N)).length-1?(L(),B("button",{key:1,onClick:G=>S(_(N)),class:"btn btn-small btn-secondary assignment-add",title:"Add assignment",type:"button"},"+",8,BQ)):_e("",!0)])]))),128))])]))),128))])])])):(L(),B("div",SQ,[R[6]||(R[6]=d("h2",null,"Access Denied",-1)),R[7]||(R[7]=d("p",null,"You do not have permission to access this page.",-1)),d("button",{onClick:R[1]||(R[1]=N=>q(e).push("/")),class:"btn btn-primary"},"Go Home")])):(L(),B("div",bQ,[R[4]||(R[4]=d("h2",null,"Authentication Required",-1)),R[5]||(R[5]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:R[0]||(R[0]=N=>q(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])]))}},wI=St(UQ,[["__scopeId","data-v-bd60dfde"]]);/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var CI=1252,$Q=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],ax={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ix=function(t){$Q.indexOf(t)!=-1&&(CI=ax[0]=t)};function VQ(){ix(1252)}var da=function(t){ix(t)};function II(){da(1200),VQ()}function Fb(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function HQ(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function kI(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var bu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?HQ(t.slice(2)):e==254&&r==255?kI(t.slice(2)):e==65279?t.slice(1):t},Xf=function(e){return String.fromCharCode(e)},Nb=function(e){return String.fromCharCode(e)},Id,Ji="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ob(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0,c=0;c<t.length;)r=t.charCodeAt(c++),i=r>>2,n=t.charCodeAt(c++),a=(r&3)<<4|n>>4,s=t.charCodeAt(c++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=Ji.charAt(i)+Ji.charAt(a)+Ji.charAt(o)+Ji.charAt(l);return e}function Os(t){var e="",r=0,n=0,s=0,i=0,a=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<t.length;)i=Ji.indexOf(t.charAt(c++)),a=Ji.indexOf(t.charAt(c++)),r=i<<2|a>>4,e+=String.fromCharCode(r),o=Ji.indexOf(t.charAt(c++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=Ji.indexOf(t.charAt(c++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var er=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),El=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function go(t){return er?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Mb(t){return er?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var ca=function(e){return er?El(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function _l(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function ox(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return ox(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Xi=er?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:El(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function jQ(t){for(var e=[],r=0,n=t.length+250,s=go(t.length+255),i=0;i<t.length;++i){var a=t.charCodeAt(i);if(a<128)s[r++]=a;else if(a<2048)s[r++]=192|a>>6&31,s[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++i)&1023;s[r++]=240|a>>8&7,s[r++]=128|a>>2&63,s[r++]=128|o>>6&15|(a&3)<<4,s[r++]=128|o&63}else s[r++]=224|a>>12&15,s[r++]=128|a>>6&63,s[r++]=128|a&63;r>n&&(e.push(s.slice(0,r)),r=0,s=go(65535),n=65530)}return e.push(s.slice(0,r)),Xi(e)}var hs=/\u0000/g,Su=/[\u0001-\u0006]/g;function pc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function fa(t,e){var r=""+t;return r.length>=e?r:Vr("0",e-r.length)+r}function lx(t,e){var r=""+t;return r.length>=e?r:Vr(" ",e-r.length)+r}function bh(t,e){var r=""+t;return r.length>=e?r:r+Vr(" ",e-r.length)}function GQ(t,e){var r=""+Math.round(t);return r.length>=e?r:Vr("0",e-r.length)+r}function WQ(t,e){var r=""+t;return r.length>=e?r:Vr("0",e-r.length)+r}var Lb=Math.pow(2,32);function Ml(t,e){if(t>Lb||t<-Lb)return GQ(t,e);var r=Math.round(t);return WQ(r,e)}function Sh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Bb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],mg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function zQ(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Ut={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Ub={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},KQ={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ah(t,e,r){for(var n=t<0?-1:1,s=t*n,i=0,a=1,o=0,l=1,c=0,u=0,f=Math.floor(s);c<e&&(f=Math.floor(s),o=f*a+i,u=f*c+l,!(s-f<5e-8));)s=1/(s-f),i=a,a=o,l=c,c=u;if(u>e&&(c>e?(u=l,o=i):(u=c,o=a)),!r)return[0,n*o,u];var h=Math.floor(n*o/u);return[h,n*o-h*u,u]}function $o(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),i=0,a=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=ZQ(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=i,o}var DI=new Date(1899,11,31,0,0,0),qQ=DI.getTime(),XQ=new Date(1900,2,1,0,0,0);function PI(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=XQ&&(r+=24*60*60*1e3),(r-(qQ+(t.getTimezoneOffset()-DI.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function cx(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function YQ(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function QQ(t){var e=t<0?12:11,r=cx(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function JQ(t){var e=cx(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function kd(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=QQ(t):e===10?r=t.toFixed(10).substr(0,12):r=JQ(t),cx(YQ(r.toUpperCase()))}function ll(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):kd(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ks(14,PI(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function ZQ(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function eJ(t,e,r,n){var s="",i=0,a=0,o=r.y,l,c=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,c=e.length;break;case 3:return mg[r.m-1][1];case 5:return mg[r.m-1][0];default:return mg[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,c=e.length;break;case 3:return Bb[r.q][0];default:return Bb[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,c=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,c=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,c=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?fa(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,i=Math.round(a*(r.S+r.u)),i>=60*a&&(i=0),e==="s"?i===0?"0":""+i/a:(s=fa(i,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}c=e.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?fa(l,c):"";return u}function Zi(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var RI=/%/g;function tJ(t,e,r){var n=e.replace(RI,""),s=e.length-n.length;return pi(t,n,r*Math.pow(10,2*s))+Vr("%",s)}function rJ(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function FI(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+FI(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var NI=/# (\?+)( ?)\/( ?)(\d+)/;function nJ(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),i=Math.floor(s/n),a=s-i*n,o=n;return r+(i===0?"":""+i)+" "+(a===0?Vr(" ",t[1].length+1+t[4].length):lx(a,t[1].length)+t[2]+"/"+t[3]+fa(o,t[4].length))}function sJ(t,e,r){return r+(e===0?"":""+e)+Vr(" ",t[1].length+2+t[4].length)}var OI=/^#*0*\.([0#]+)/,MI=/\).*[0#]/,LI=/\(###\) ###\\?-####/;function os(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function $b(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Vb(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function aJ(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function iJ(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function $s(t,e,r){if(t.charCodeAt(0)===40&&!e.match(MI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?$s("n",n,r):"("+$s("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return rJ(t,e,r);if(e.indexOf("%")!==-1)return tJ(t,e,r);if(e.indexOf("E")!==-1)return FI(e,r);if(e.charCodeAt(0)===36)return"$"+$s(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+Ml(l,e.length);if(e.match(/^[#?]+$/))return s=Ml(r,0),s==="0"&&(s=""),s.length>e.length?s:os(e.substr(0,e.length-s.length))+s;if(i=e.match(NI))return nJ(i,l,c);if(e.match(/^#+0+$/))return c+Ml(l,e.length-e.indexOf("0"));if(i=e.match(OI))return s=$b(r,i[1].length).replace(/^([^\.]+)$/,"$1."+os(i[1])).replace(/\.$/,"."+os(i[1])).replace(/\.(\d*)$/,function(g,y){return"."+y+Vr("0",os(i[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+$b(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Zi(Ml(l,0));if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+$s(t,e,-r):Zi(""+(Math.floor(r)+aJ(r,i[1].length)))+"."+fa(Vb(r,i[1].length),i[1].length);if(i=e.match(/^#,#*,#0/))return $s(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=pc($s(t,e.replace(/[\\-]/g,""),r)),a=0,pc(pc(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(LI))return s=$s(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Ah(l,Math.pow(10,a)-1,!1),s=""+c,u=pi("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=bh(o[2],a),u.length<i[4].length&&(u=os(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Ah(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?lx(o[1],a)+i[2]+"/"+i[3]+bh(o[2],a):Vr(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=Ml(r,0),e.length<=s.length?s:os(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,h=e.length-s.length-f;return os(e.substr(0,f)+s+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return a=Vb(r,i[1].length),r<0?"-"+$s(t,e,-r):Zi(iJ(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?fa(0,3-g.length):"")+g})+"."+fa(a,i[1].length);switch(e){case"###,##0.00":return $s(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Zi(Ml(l,0));return p!=="0"?c+p:"";case"###,###.00":return $s(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return $s(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function oJ(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function lJ(t,e,r){var n=e.replace(RI,""),s=e.length-n.length;return pi(t,n,r*Math.pow(10,2*s))+Vr("%",s)}function BI(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+BI(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var i=Math.floor(Math.log(e)*Math.LOG10E)%s;if(i<0&&(i+=s),r=(e/Math.pow(10,i)).toPrecision(n+1+(s+i)%s),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+i):r+="E+"+(a-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(s+i)%s)+"."+u.substr(i)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ia(t,e,r){if(t.charCodeAt(0)===40&&!e.match(MI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ia("n",n,r):"("+Ia("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return oJ(t,e,r);if(e.indexOf("%")!==-1)return lJ(t,e,r);if(e.indexOf("E")!==-1)return BI(e,r);if(e.charCodeAt(0)===36)return"$"+Ia(t,e.substr(e.charAt(1)==" "?2:1),r);var s,i,a,o,l=Math.abs(r),c=r<0?"-":"";if(e.match(/^00+$/))return c+fa(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:os(e.substr(0,e.length-s.length))+s;if(i=e.match(NI))return sJ(i,l,c);if(e.match(/^#+0+$/))return c+fa(l,e.length-e.indexOf("0"));if(i=e.match(OI))return s=(""+r).replace(/^([^\.]+)$/,"$1."+os(i[1])).replace(/\.$/,"."+os(i[1])),s=s.replace(/\.(\d*)$/,function(g,y){return"."+y+Vr("0",os(i[1]).length-y.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),i=e.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=e.match(/^#{1,3},##0(\.?)$/))return c+Zi(""+l);if(i=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ia(t,e,-r):Zi(""+r)+"."+Vr("0",i[1].length);if(i=e.match(/^#,#*,#0/))return Ia(t,e.replace(/^#,#*,/,""),r);if(i=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=pc(Ia(t,e.replace(/[\\-]/g,""),r)),a=0,pc(pc(e.replace(/\\/g,"")).replace(/[0#]/g,function(g){return a<s.length?s.charAt(a++):g==="0"?"0":""}));if(e.match(LI))return s=Ia(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(i=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(i[4].length,7),o=Ah(l,Math.pow(10,a)-1,!1),s=""+c,u=pi("n",i[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+i[2]+"/"+i[3],u=bh(o[2],a),u.length<i[4].length&&(u=os(i[4].substr(i[4].length-u.length))+u),s+=u,s;if(i=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(i[1].length,i[4].length),7),o=Ah(l,Math.pow(10,a)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?lx(o[1],a)+i[2]+"/"+i[3]+bh(o[2],a):Vr(" ",2*a+1+i[2].length+i[3].length));if(i=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:os(e.substr(0,e.length-s.length))+s;if(i=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),a=s.indexOf(".");var f=e.indexOf(".")-a,h=e.length-s.length-f;return os(e.substr(0,f)+s+e.substr(e.length-h))}if(i=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ia(t,e,-r):Zi(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?fa(0,3-g.length):"")+g})+"."+fa(0,i[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=Zi(""+l);return p!=="0"?c+p:"";default:if(e.match(/\.[0#?]*$/))return Ia(t,e.slice(0,e.lastIndexOf(".")),r)+os(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function pi(t,e,r){return(r|0)===r?Ia(t,e,r):$s(t,e,r)}function cJ(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var UI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Wc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Sh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(UI))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function uJ(t,e,r,n){for(var s=[],i="",a=0,o="",l="t",c,u,f,h="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!Sh(t,a))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},a+=7;break;case'"':for(i="";(f=t.charCodeAt(++a))!==34&&a<t.length;)i+=String.fromCharCode(f);s[s.length]={t:"t",v:i},++a;break;case"\\":var p=t.charAt(++a),g=p==="("||p===")"?p:"t";s[s.length]={t:g,v:p},++a;break;case"_":s[s.length]={t:"t",v:" "},a+=2;break;case"@":s[s.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(c==null&&(c=$o(e,r,t.charAt(a+1)==="2"),c==null))return"";s[s.length]={t:"X",v:t.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||c==null&&(c=$o(e,r),c==null))return"";for(i=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:i},l=o;break;case"A":case"a":case"上":var y={t:o,v:o};if(c==null&&(c=$o(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(c!=null&&(y.v=c.H>=12?"P":"A"),y.t="T",h="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(c!=null&&(y.v=c.H>=12?"PM":"AM"),y.t="T",a+=5,h="h"):t.substr(a,5).toUpperCase()==="上午/下午"?(c!=null&&(y.v=c.H>=12?"下午":"上午"),y.t="T",a+=5,h="h"):(y.t="t",++a),c==null&&y.t==="T")return"";s[s.length]=y,l=o;break;case"[":for(i=o;t.charAt(a++)!=="]"&&a<t.length;)i+=t.charAt(a);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(UI)){if(c==null&&(c=$o(e,r),c==null))return"";s[s.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Wc(t)||(s[s.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++a<t.length&&(o=t.charAt(a))==="0";)i+=o;s[s.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)i+=o;s[s.length]={t:"n",v:i};break;case"?":for(i=o;t.charAt(++a)===o;)i+=o;s[s.length]={t:o,v:i},l=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)i+=t.charAt(a);s[s.length]={t:"D",v:i};break;case" ":s[s.length]={t:o,v:o},++a;break;case"$":s[s.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++a;break}var E=0,b=0,_;for(a=s.length-1,l="t";a>=0;--a)switch(s[a].t){case"h":case"H":s[a].t=h,l="h",E<1&&(E=1);break;case"s":(_=s[a].v.match(/\.0+$/))&&(b=Math.max(b,_[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":l=s[a].t;break;case"m":l==="s"&&(s[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&s[a].v.match(/[Hh]/)&&(E=1),E<2&&s[a].v.match(/[Mm]/)&&(E=2),E<3&&s[a].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var v="",A;for(a=0;a<s.length;++a)switch(s[a].t){case"t":case"T":case" ":case"D":break;case"X":s[a].v="",s[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[a].v=eJ(s[a].t.charCodeAt(0),s[a].v,c,b),s[a].t="t";break;case"n":case"?":for(A=a+1;s[A]!=null&&((o=s[A].t)==="?"||o==="D"||(o===" "||o==="t")&&s[A+1]!=null&&(s[A+1].t==="?"||s[A+1].t==="t"&&s[A+1].v==="/")||s[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[A].v==="/"||s[A].v===" "&&s[A+1]!=null&&s[A+1].t=="?"));)s[a].v+=s[A].v,s[A]={v:"",t:";"},++A;v+=s[a].v,a=A-1;break;case"G":s[a].t="t",s[a].v=ll(e,r);break}var D="",k,T;if(v.length>0){v.charCodeAt(0)==40?(k=e<0&&v.charCodeAt(0)===45?-e:e,T=pi("n",v,k)):(k=e<0&&n>1?-e:e,T=pi("n",v,k),k<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),A=T.length-1;var x=s.length;for(a=0;a<s.length;++a)if(s[a]!=null&&s[a].t!="t"&&s[a].v.indexOf(".")>-1){x=a;break}var m=s.length;if(x===s.length&&T.indexOf("E")===-1){for(a=s.length-1;a>=0;--a)s[a]==null||"n?".indexOf(s[a].t)===-1||(A>=s[a].v.length-1?(A-=s[a].v.length,s[a].v=T.substr(A+1,s[a].v.length)):A<0?s[a].v="":(s[a].v=T.substr(0,A+1),A=-1),s[a].t="t",m=a);A>=0&&m<s.length&&(s[m].v=T.substr(0,A+1)+s[m].v)}else if(x!==s.length&&T.indexOf("E")===-1){for(A=T.indexOf(".")-1,a=x;a>=0;--a)if(!(s[a]==null||"n?".indexOf(s[a].t)===-1)){for(u=s[a].v.indexOf(".")>-1&&a===x?s[a].v.indexOf(".")-1:s[a].v.length-1,D=s[a].v.substr(u+1);u>=0;--u)A>=0&&(s[a].v.charAt(u)==="0"||s[a].v.charAt(u)==="#")&&(D=T.charAt(A--)+D);s[a].v=D,s[a].t="t",m=a}for(A>=0&&m<s.length&&(s[m].v=T.substr(0,A+1)+s[m].v),A=T.indexOf(".")+1,a=x;a<s.length;++a)if(!(s[a]==null||"n?(".indexOf(s[a].t)===-1&&a!==x)){for(u=s[a].v.indexOf(".")>-1&&a===x?s[a].v.indexOf(".")+1:0,D=s[a].v.substr(0,u);u<s[a].v.length;++u)A<T.length&&(D+=T.charAt(A++));s[a].v=D,s[a].t="t",m=a}}}for(a=0;a<s.length;++a)s[a]!=null&&"n?".indexOf(s[a].t)>-1&&(k=n>1&&e<0&&a>0&&s[a-1].v==="-"?-e:e,s[a].v=pi(s[a].t,s[a].v,k),s[a].t="t");var S="";for(a=0;a!==s.length;++a)s[a]!=null&&(S+=s[a].v);return S}var Hb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function jb(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function dJ(t,e){var r=cJ(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Hb),o=r[1].match(Hb);return jb(e,a)?[n,r[0]]:jb(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,i]}function Ks(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ut)[t],n==null&&(n=r.table&&r.table[Ub[t]]||Ut[Ub[t]]),n==null&&(n=KQ[t]||"General");break}if(Sh(n,0))return ll(e,r);e instanceof Date&&(e=PI(e,r.date1904));var s=dJ(n,e);if(Sh(s[1]))return ll(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return uJ(s[1],e,r,s[0])}function Xo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Ut[r]==null){e<0&&(e=r);continue}if(Ut[r]==t){e=r;break}}e<0&&(e=391)}return Ut[e]=t,e}function $I(){Ut=zQ()}var fJ={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},VI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function hJ(t){var e=typeof t=="number"?Ut[t]:t;return e=e.replace(VI,"(\\d+)"),new RegExp("^"+e+"$")}function pJ(t,e,r){var n=-1,s=-1,i=-1,a=-1,o=-1,l=-1;(e.match(VI)||[]).forEach(function(f,h){var p=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":i=p;break;case"h":a=p;break;case"s":l=p;break;case"m":a>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?c:n==-1&&s==-1&&i==-1?u:c+"T"+u}var mJ=function(){var t={};t.version="1.2.0";function e(){for(var T=0,x=new Array(256),m=0;m!=256;++m)T=m,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,x[m]=T;return typeof Int32Array<"u"?new Int32Array(x):x}var r=e();function n(T){var x=0,m=0,S=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(S=0;S!=256;++S)I[S]=T[S];for(S=0;S!=256;++S)for(m=T[S],x=256+S;x<4096;x+=256)m=I[x]=m>>>8^T[m&255];var C=[];for(S=1;S!=16;++S)C[S-1]=typeof Int32Array<"u"?I.subarray(S*256,S*256+256):I.slice(S*256,S*256+256);return C}var s=n(r),i=s[0],a=s[1],o=s[2],l=s[3],c=s[4],u=s[5],f=s[6],h=s[7],p=s[8],g=s[9],y=s[10],E=s[11],b=s[12],_=s[13],v=s[14];function A(T,x){for(var m=x^-1,S=0,I=T.length;S<I;)m=m>>>8^r[(m^T.charCodeAt(S++))&255];return~m}function D(T,x){for(var m=x^-1,S=T.length-15,I=0;I<S;)m=v[T[I++]^m&255]^_[T[I++]^m>>8&255]^b[T[I++]^m>>16&255]^E[T[I++]^m>>>24]^y[T[I++]]^g[T[I++]]^p[T[I++]]^h[T[I++]]^f[T[I++]]^u[T[I++]]^c[T[I++]]^l[T[I++]]^o[T[I++]]^a[T[I++]]^i[T[I++]]^r[T[I++]];for(S+=15;I<S;)m=m>>>8^r[(m^T[I++])&255];return~m}function k(T,x){for(var m=x^-1,S=0,I=T.length,C=0,F=0;S<I;)C=T.charCodeAt(S++),C<128?m=m>>>8^r[(m^C)&255]:C<2048?(m=m>>>8^r[(m^(192|C>>6&31))&255],m=m>>>8^r[(m^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,F=T.charCodeAt(S++)&1023,m=m>>>8^r[(m^(240|C>>8&7))&255],m=m>>>8^r[(m^(128|C>>2&63))&255],m=m>>>8^r[(m^(128|F>>6&15|(C&3)<<4))&255],m=m>>>8^r[(m^(128|F&63))&255]):(m=m>>>8^r[(m^(224|C>>12&15))&255],m=m>>>8^r[(m^(128|C>>6&63))&255],m=m>>>8^r[(m^(128|C&63))&255]);return~m}return t.table=r,t.bstr=A,t.buf=D,t.str=k,t}(),nr=function(){var e={};e.version="1.2.1";function r(re,me){for(var ce=re.split("/"),fe=me.split("/"),ge=0,ye=0,Re=Math.min(ce.length,fe.length);ge<Re;++ge){if(ye=ce[ge].length-fe[ge].length)return ye;if(ce[ge]!=fe[ge])return ce[ge]<fe[ge]?-1:1}return ce.length-fe.length}function n(re){if(re.charAt(re.length-1)=="/")return re.slice(0,-1).indexOf("/")===-1?re:n(re.slice(0,-1));var me=re.lastIndexOf("/");return me===-1?re:re.slice(0,me+1)}function s(re){if(re.charAt(re.length-1)=="/")return s(re.slice(0,-1));var me=re.lastIndexOf("/");return me===-1?re:re.slice(me+1)}function i(re,me){typeof me=="string"&&(me=new Date(me));var ce=me.getHours();ce=ce<<6|me.getMinutes(),ce=ce<<5|me.getSeconds()>>>1,re.write_shift(2,ce);var fe=me.getFullYear()-1980;fe=fe<<4|me.getMonth()+1,fe=fe<<5|me.getDate(),re.write_shift(2,fe)}function a(re){var me=re.read_shift(2)&65535,ce=re.read_shift(2)&65535,fe=new Date,ge=ce&31;ce>>>=5;var ye=ce&15;ce>>>=4,fe.setMilliseconds(0),fe.setFullYear(ce+1980),fe.setMonth(ye-1),fe.setDate(ge);var Re=me&31;me>>>=5;var He=me&63;return me>>>=6,fe.setHours(me),fe.setMinutes(He),fe.setSeconds(Re<<1),fe}function o(re){In(re,0);for(var me={},ce=0;re.l<=re.length-4;){var fe=re.read_shift(2),ge=re.read_shift(2),ye=re.l+ge,Re={};switch(fe){case 21589:ce=re.read_shift(1),ce&1&&(Re.mtime=re.read_shift(4)),ge>5&&(ce&2&&(Re.atime=re.read_shift(4)),ce&4&&(Re.ctime=re.read_shift(4))),Re.mtime&&(Re.mt=new Date(Re.mtime*1e3));break}re.l=ye,me[fe]=Re}return me}var l;function c(){return l||(l={})}function u(re,me){if(re[0]==80&&re[1]==75)return pt(re,me);if((re[0]|32)==109&&(re[1]|32)==105)return So(re,me);if(re.length<512)throw new Error("CFB file size "+re.length+" < 512");var ce=3,fe=512,ge=0,ye=0,Re=0,He=0,Fe=0,Oe=[],Le=re.slice(0,512);In(Le,0);var Qe=f(Le);switch(ce=Qe[0],ce){case 3:fe=512;break;case 4:fe=4096;break;case 0:if(Qe[1]==0)return pt(re,me);default:throw new Error("Major Version: Expected 3 or 4 saw "+ce)}fe!==512&&(Le=re.slice(0,fe),In(Le,28));var et=re.slice(0,fe);h(Le,ce);var ut=Le.read_shift(4,"i");if(ce===3&&ut!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ut);Le.l+=4,Re=Le.read_shift(4,"i"),Le.l+=4,Le.chk("00100000","Mini Stream Cutoff Size: "),He=Le.read_shift(4,"i"),ge=Le.read_shift(4,"i"),Fe=Le.read_shift(4,"i"),ye=Le.read_shift(4,"i");for(var Je=-1,st=0;st<109&&(Je=Le.read_shift(4,"i"),!(Je<0));++st)Oe[st]=Je;var kt=p(re,fe);E(Fe,ye,kt,fe,Oe);var vr=_(kt,Re,Oe,fe);vr[Re].name="!Directory",ge>0&&He!==F&&(vr[He].name="!MiniFAT"),vr[Oe[0]].name="!FAT",vr.fat_addrs=Oe,vr.ssz=fe;var hr={},Ir=[],Ka=[],To=[];v(Re,vr,kt,Ir,ge,hr,Ka,He),g(Ka,To,Ir),Ir.shift();var Fi={FileIndex:Ka,FullPaths:To};return me&&me.raw&&(Fi.raw={header:et,sectors:kt}),Fi}function f(re){if(re[re.l]==80&&re[re.l+1]==75)return[0,0];re.chk(W,"Header Signature: "),re.l+=16;var me=re.read_shift(2,"u");return[re.read_shift(2,"u"),me]}function h(re,me){var ce=9;switch(re.l+=2,ce=re.read_shift(2)){case 9:if(me!=3)throw new Error("Sector Shift: Expected 9 saw "+ce);break;case 12:if(me!=4)throw new Error("Sector Shift: Expected 12 saw "+ce);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ce)}re.chk("0600","Mini Sector Shift: "),re.chk("000000000000","Reserved: ")}function p(re,me){for(var ce=Math.ceil(re.length/me)-1,fe=[],ge=1;ge<ce;++ge)fe[ge-1]=re.slice(ge*me,(ge+1)*me);return fe[ce-1]=re.slice(ce*me),fe}function g(re,me,ce){for(var fe=0,ge=0,ye=0,Re=0,He=0,Fe=ce.length,Oe=[],Le=[];fe<Fe;++fe)Oe[fe]=Le[fe]=fe,me[fe]=ce[fe];for(;He<Le.length;++He)fe=Le[He],ge=re[fe].L,ye=re[fe].R,Re=re[fe].C,Oe[fe]===fe&&(ge!==-1&&Oe[ge]!==ge&&(Oe[fe]=Oe[ge]),ye!==-1&&Oe[ye]!==ye&&(Oe[fe]=Oe[ye])),Re!==-1&&(Oe[Re]=fe),ge!==-1&&fe!=Oe[fe]&&(Oe[ge]=Oe[fe],Le.lastIndexOf(ge)<He&&Le.push(ge)),ye!==-1&&fe!=Oe[fe]&&(Oe[ye]=Oe[fe],Le.lastIndexOf(ye)<He&&Le.push(ye));for(fe=1;fe<Fe;++fe)Oe[fe]===fe&&(ye!==-1&&Oe[ye]!==ye?Oe[fe]=Oe[ye]:ge!==-1&&Oe[ge]!==ge&&(Oe[fe]=Oe[ge]));for(fe=1;fe<Fe;++fe)if(re[fe].type!==0){if(He=fe,He!=Oe[He])do He=Oe[He],me[fe]=me[He]+"/"+me[fe];while(He!==0&&Oe[He]!==-1&&He!=Oe[He]);Oe[fe]=-1}for(me[0]+="/",fe=1;fe<Fe;++fe)re[fe].type!==2&&(me[fe]+="/")}function y(re,me,ce){for(var fe=re.start,ge=re.size,ye=[],Re=fe;ce&&ge>0&&Re>=0;)ye.push(me.slice(Re*C,Re*C+C)),ge-=C,Re=Mo(ce,Re*4);return ye.length===0?un(0):Xi(ye).slice(0,re.size)}function E(re,me,ce,fe,ge){var ye=F;if(re===F){if(me!==0)throw new Error("DIFAT chain shorter than expected")}else if(re!==-1){var Re=ce[re],He=(fe>>>2)-1;if(!Re)return;for(var Fe=0;Fe<He&&(ye=Mo(Re,Fe*4))!==F;++Fe)ge.push(ye);E(Mo(Re,fe-4),me-1,ce,fe,ge)}}function b(re,me,ce,fe,ge){var ye=[],Re=[];ge||(ge=[]);var He=fe-1,Fe=0,Oe=0;for(Fe=me;Fe>=0;){ge[Fe]=!0,ye[ye.length]=Fe,Re.push(re[Fe]);var Le=ce[Math.floor(Fe*4/fe)];if(Oe=Fe*4&He,fe<4+Oe)throw new Error("FAT boundary crossed: "+Fe+" 4 "+fe);if(!re[Le])break;Fe=Mo(re[Le],Oe)}return{nodes:ye,data:Zb([Re])}}function _(re,me,ce,fe){var ge=re.length,ye=[],Re=[],He=[],Fe=[],Oe=fe-1,Le=0,Qe=0,et=0,ut=0;for(Le=0;Le<ge;++Le)if(He=[],et=Le+me,et>=ge&&(et-=ge),!Re[et]){Fe=[];var Je=[];for(Qe=et;Qe>=0;){Je[Qe]=!0,Re[Qe]=!0,He[He.length]=Qe,Fe.push(re[Qe]);var st=ce[Math.floor(Qe*4/fe)];if(ut=Qe*4&Oe,fe<4+ut)throw new Error("FAT boundary crossed: "+Qe+" 4 "+fe);if(!re[st]||(Qe=Mo(re[st],ut),Je[Qe]))break}ye[et]={nodes:He,data:Zb([Fe])}}return ye}function v(re,me,ce,fe,ge,ye,Re,He){for(var Fe=0,Oe=fe.length?2:0,Le=me[re].data,Qe=0,et=0,ut;Qe<Le.length;Qe+=128){var Je=Le.slice(Qe,Qe+128);In(Je,64),et=Je.read_shift(2),ut=px(Je,0,et-Oe),fe.push(ut);var st={name:ut,type:Je.read_shift(1),color:Je.read_shift(1),L:Je.read_shift(4,"i"),R:Je.read_shift(4,"i"),C:Je.read_shift(4,"i"),clsid:Je.read_shift(16),state:Je.read_shift(4,"i"),start:0,size:0},kt=Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2);kt!==0&&(st.ct=A(Je,Je.l-8));var vr=Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2)+Je.read_shift(2);vr!==0&&(st.mt=A(Je,Je.l-8)),st.start=Je.read_shift(4,"i"),st.size=Je.read_shift(4,"i"),st.size<0&&st.start<0&&(st.size=st.type=0,st.start=F,st.name=""),st.type===5?(Fe=st.start,ge>0&&Fe!==F&&(me[Fe].name="!StreamData")):st.size>=4096?(st.storage="fat",me[st.start]===void 0&&(me[st.start]=b(ce,st.start,me.fat_addrs,me.ssz)),me[st.start].name=st.name,st.content=me[st.start].data.slice(0,st.size)):(st.storage="minifat",st.size<0?st.size=0:Fe!==F&&st.start!==F&&me[Fe]&&(st.content=y(st,me[Fe].data,(me[He]||{}).data))),st.content&&In(st.content,0),ye[ut]=st,Re.push(st)}}function A(re,me){return new Date((ks(re,me+4)/1e7*Math.pow(2,32)+ks(re,me)/1e7-11644473600)*1e3)}function D(re,me){return c(),u(l.readFileSync(re),me)}function k(re,me){var ce=me&&me.type;switch(ce||er&&Buffer.isBuffer(re)&&(ce="buffer"),ce||"base64"){case"file":return D(re,me);case"base64":return u(ca(Os(re)),me);case"binary":return u(ca(re),me)}return u(re,me)}function T(re,me){var ce=me||{},fe=ce.root||"Root Entry";if(re.FullPaths||(re.FullPaths=[]),re.FileIndex||(re.FileIndex=[]),re.FullPaths.length!==re.FileIndex.length)throw new Error("inconsistent CFB structure");re.FullPaths.length===0&&(re.FullPaths[0]=fe+"/",re.FileIndex[0]={name:fe,type:5}),ce.CLSID&&(re.FileIndex[0].clsid=ce.CLSID),x(re)}function x(re){var me="Sh33tJ5";if(!nr.find(re,"/"+me)){var ce=un(4);ce[0]=55,ce[1]=ce[3]=50,ce[2]=54,re.FileIndex.push({name:me,type:2,content:ce,size:4,L:69,R:69,C:69}),re.FullPaths.push(re.FullPaths[0]+me),m(re)}}function m(re,me){T(re);for(var ce=!1,fe=!1,ge=re.FullPaths.length-1;ge>=0;--ge){var ye=re.FileIndex[ge];switch(ye.type){case 0:fe?ce=!0:(re.FileIndex.pop(),re.FullPaths.pop());break;case 1:case 2:case 5:fe=!0,isNaN(ye.R*ye.L*ye.C)&&(ce=!0),ye.R>-1&&ye.L>-1&&ye.R==ye.L&&(ce=!0);break;default:ce=!0;break}}if(!(!ce&&!me)){var Re=new Date(1987,1,19),He=0,Fe=Object.create?Object.create(null):{},Oe=[];for(ge=0;ge<re.FullPaths.length;++ge)Fe[re.FullPaths[ge]]=!0,re.FileIndex[ge].type!==0&&Oe.push([re.FullPaths[ge],re.FileIndex[ge]]);for(ge=0;ge<Oe.length;++ge){var Le=n(Oe[ge][0]);fe=Fe[Le],fe||(Oe.push([Le,{name:s(Le).replace("/",""),type:1,clsid:R,ct:Re,mt:Re,content:null}]),Fe[Le]=!0)}for(Oe.sort(function(ut,Je){return r(ut[0],Je[0])}),re.FullPaths=[],re.FileIndex=[],ge=0;ge<Oe.length;++ge)re.FullPaths[ge]=Oe[ge][0],re.FileIndex[ge]=Oe[ge][1];for(ge=0;ge<Oe.length;++ge){var Qe=re.FileIndex[ge],et=re.FullPaths[ge];if(Qe.name=s(et).replace("/",""),Qe.L=Qe.R=Qe.C=-(Qe.color=1),Qe.size=Qe.content?Qe.content.length:0,Qe.start=0,Qe.clsid=Qe.clsid||R,ge===0)Qe.C=Oe.length>1?1:-1,Qe.size=0,Qe.type=5;else if(et.slice(-1)=="/"){for(He=ge+1;He<Oe.length&&n(re.FullPaths[He])!=et;++He);for(Qe.C=He>=Oe.length?-1:He,He=ge+1;He<Oe.length&&n(re.FullPaths[He])!=n(et);++He);Qe.R=He>=Oe.length?-1:He,Qe.type=1}else n(re.FullPaths[ge+1]||"")==n(et)&&(Qe.R=ge+1),Qe.type=2}}}function S(re,me){var ce=me||{};if(ce.fileType=="mad")return ln(re,ce);switch(m(re),ce.fileType){case"zip":return Rt(re,ce)}var fe=function(ut){for(var Je=0,st=0,kt=0;kt<ut.FileIndex.length;++kt){var vr=ut.FileIndex[kt];if(vr.content){var hr=vr.content.length;hr>0&&(hr<4096?Je+=hr+63>>6:st+=hr+511>>9)}}for(var Ir=ut.FullPaths.length+3>>2,Ka=Je+7>>3,To=Je+127>>7,Fi=Ka+st+Ir+To,Sa=Fi+127>>7,Il=Sa<=109?0:Math.ceil((Sa-109)/127);Fi+Sa+Il+127>>7>Sa;)Il=++Sa<=109?0:Math.ceil((Sa-109)/127);var Ts=[1,Il,Sa,To,Ir,st,Je,0];return ut.FileIndex[0].size=Je<<6,Ts[7]=(ut.FileIndex[0].start=Ts[0]+Ts[1]+Ts[2]+Ts[3]+Ts[4]+Ts[5])+(Ts[6]+7>>3),Ts}(re),ge=un(fe[7]<<9),ye=0,Re=0;{for(ye=0;ye<8;++ye)ge.write_shift(1,P[ye]);for(ye=0;ye<8;++ye)ge.write_shift(2,0);for(ge.write_shift(2,62),ge.write_shift(2,3),ge.write_shift(2,65534),ge.write_shift(2,9),ge.write_shift(2,6),ye=0;ye<3;++ye)ge.write_shift(2,0);for(ge.write_shift(4,0),ge.write_shift(4,fe[2]),ge.write_shift(4,fe[0]+fe[1]+fe[2]+fe[3]-1),ge.write_shift(4,0),ge.write_shift(4,4096),ge.write_shift(4,fe[3]?fe[0]+fe[1]+fe[2]-1:F),ge.write_shift(4,fe[3]),ge.write_shift(-4,fe[1]?fe[0]-1:F),ge.write_shift(4,fe[1]),ye=0;ye<109;++ye)ge.write_shift(-4,ye<fe[2]?fe[1]+ye:-1)}if(fe[1])for(Re=0;Re<fe[1];++Re){for(;ye<236+Re*127;++ye)ge.write_shift(-4,ye<fe[2]?fe[1]+ye:-1);ge.write_shift(-4,Re===fe[1]-1?F:Re+1)}var He=function(ut){for(Re+=ut;ye<Re-1;++ye)ge.write_shift(-4,ye+1);ut&&(++ye,ge.write_shift(-4,F))};for(Re=ye=0,Re+=fe[1];ye<Re;++ye)ge.write_shift(-4,N.DIFSECT);for(Re+=fe[2];ye<Re;++ye)ge.write_shift(-4,N.FATSECT);He(fe[3]),He(fe[4]);for(var Fe=0,Oe=0,Le=re.FileIndex[0];Fe<re.FileIndex.length;++Fe)Le=re.FileIndex[Fe],Le.content&&(Oe=Le.content.length,!(Oe<4096)&&(Le.start=Re,He(Oe+511>>9)));for(He(fe[6]+7>>3);ge.l&511;)ge.write_shift(-4,N.ENDOFCHAIN);for(Re=ye=0,Fe=0;Fe<re.FileIndex.length;++Fe)Le=re.FileIndex[Fe],Le.content&&(Oe=Le.content.length,!(!Oe||Oe>=4096)&&(Le.start=Re,He(Oe+63>>6)));for(;ge.l&511;)ge.write_shift(-4,N.ENDOFCHAIN);for(ye=0;ye<fe[4]<<2;++ye){var Qe=re.FullPaths[ye];if(!Qe||Qe.length===0){for(Fe=0;Fe<17;++Fe)ge.write_shift(4,0);for(Fe=0;Fe<3;++Fe)ge.write_shift(4,-1);for(Fe=0;Fe<12;++Fe)ge.write_shift(4,0);continue}Le=re.FileIndex[ye],ye===0&&(Le.start=Le.size?Le.start-1:F);var et=ye===0&&ce.root||Le.name;if(Oe=2*(et.length+1),ge.write_shift(64,et,"utf16le"),ge.write_shift(2,Oe),ge.write_shift(1,Le.type),ge.write_shift(1,Le.color),ge.write_shift(-4,Le.L),ge.write_shift(-4,Le.R),ge.write_shift(-4,Le.C),Le.clsid)ge.write_shift(16,Le.clsid,"hex");else for(Fe=0;Fe<4;++Fe)ge.write_shift(4,0);ge.write_shift(4,Le.state||0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,0),ge.write_shift(4,Le.start),ge.write_shift(4,Le.size),ge.write_shift(4,0)}for(ye=1;ye<re.FileIndex.length;++ye)if(Le=re.FileIndex[ye],Le.size>=4096)if(ge.l=Le.start+1<<9,er&&Buffer.isBuffer(Le.content))Le.content.copy(ge,ge.l,0,Le.size),ge.l+=Le.size+511&-512;else{for(Fe=0;Fe<Le.size;++Fe)ge.write_shift(1,Le.content[Fe]);for(;Fe&511;++Fe)ge.write_shift(1,0)}for(ye=1;ye<re.FileIndex.length;++ye)if(Le=re.FileIndex[ye],Le.size>0&&Le.size<4096)if(er&&Buffer.isBuffer(Le.content))Le.content.copy(ge,ge.l,0,Le.size),ge.l+=Le.size+63&-64;else{for(Fe=0;Fe<Le.size;++Fe)ge.write_shift(1,Le.content[Fe]);for(;Fe&63;++Fe)ge.write_shift(1,0)}if(er)ge.l=ge.length;else for(;ge.l<ge.length;)ge.write_shift(1,0);return ge}function I(re,me){var ce=re.FullPaths.map(function(Fe){return Fe.toUpperCase()}),fe=ce.map(function(Fe){var Oe=Fe.split("/");return Oe[Oe.length-(Fe.slice(-1)=="/"?2:1)]}),ge=!1;me.charCodeAt(0)===47?(ge=!0,me=ce[0].slice(0,-1)+me):ge=me.indexOf("/")!==-1;var ye=me.toUpperCase(),Re=ge===!0?ce.indexOf(ye):fe.indexOf(ye);if(Re!==-1)return re.FileIndex[Re];var He=!ye.match(Su);for(ye=ye.replace(hs,""),He&&(ye=ye.replace(Su,"!")),Re=0;Re<ce.length;++Re)if((He?ce[Re].replace(Su,"!"):ce[Re]).replace(hs,"")==ye||(He?fe[Re].replace(Su,"!"):fe[Re]).replace(hs,"")==ye)return re.FileIndex[Re];return null}var C=64,F=-2,W="d0cf11e0a1b11ae1",P=[208,207,17,224,161,177,26,225],R="00000000000000000000000000000000",N={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:W,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:R,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function M(re,me,ce){c();var fe=S(re,ce);l.writeFileSync(me,fe)}function O(re){for(var me=new Array(re.length),ce=0;ce<re.length;++ce)me[ce]=String.fromCharCode(re[ce]);return me.join("")}function G(re,me){var ce=S(re,me);switch(me&&me.type||"buffer"){case"file":return c(),l.writeFileSync(me.filename,ce),ce;case"binary":return typeof ce=="string"?ce:O(ce);case"base64":return Ob(typeof ce=="string"?ce:O(ce));case"buffer":if(er)return Buffer.isBuffer(ce)?ce:El(ce);case"array":return typeof ce=="string"?ca(ce):ce}return ce}var z;function j(re){try{var me=re.InflateRaw,ce=new me;if(ce._processChunk(new Uint8Array([3,0]),ce._finishFlushFlag),ce.bytesRead)z=re;else throw new Error("zlib does not expose bytesRead")}catch(fe){console.error("cannot use native zlib: "+(fe.message||fe))}}function H(re,me){if(!z)return ht(re,me);var ce=z.InflateRaw,fe=new ce,ge=fe._processChunk(re.slice(re.l),fe._finishFlushFlag);return re.l+=fe.bytesRead,ge}function V(re){return z?z.deflateRawSync(re):be(re)}var te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(re){var me=(re<<1|re<<11)&139536|(re<<5|re<<15)&558144;return(me>>16|me>>8|me)&255}for(var J=typeof Uint8Array<"u",Q=J?new Uint8Array(256):[],ve=0;ve<256;++ve)Q[ve]=le(ve);function ee(re,me){var ce=Q[re&255];return me<=8?ce>>>8-me:(ce=ce<<8|Q[re>>8&255],me<=16?ce>>>16-me:(ce=ce<<8|Q[re>>16&255],ce>>>24-me))}function K(re,me){var ce=me&7,fe=me>>>3;return(re[fe]|(ce<=6?0:re[fe+1]<<8))>>>ce&3}function Y(re,me){var ce=me&7,fe=me>>>3;return(re[fe]|(ce<=5?0:re[fe+1]<<8))>>>ce&7}function pe(re,me){var ce=me&7,fe=me>>>3;return(re[fe]|(ce<=4?0:re[fe+1]<<8))>>>ce&15}function xe(re,me){var ce=me&7,fe=me>>>3;return(re[fe]|(ce<=3?0:re[fe+1]<<8))>>>ce&31}function ae(re,me){var ce=me&7,fe=me>>>3;return(re[fe]|(ce<=1?0:re[fe+1]<<8))>>>ce&127}function de(re,me,ce){var fe=me&7,ge=me>>>3,ye=(1<<ce)-1,Re=re[ge]>>>fe;return ce<8-fe||(Re|=re[ge+1]<<8-fe,ce<16-fe)||(Re|=re[ge+2]<<16-fe,ce<24-fe)||(Re|=re[ge+3]<<24-fe),Re&ye}function Ee(re,me,ce){var fe=me&7,ge=me>>>3;return fe<=5?re[ge]|=(ce&7)<<fe:(re[ge]|=ce<<fe&255,re[ge+1]=(ce&7)>>8-fe),me+3}function he(re,me,ce){var fe=me&7,ge=me>>>3;return ce=(ce&1)<<fe,re[ge]|=ce,me+1}function Ce(re,me,ce){var fe=me&7,ge=me>>>3;return ce<<=fe,re[ge]|=ce&255,ce>>>=8,re[ge+1]=ce,me+8}function Te(re,me,ce){var fe=me&7,ge=me>>>3;return ce<<=fe,re[ge]|=ce&255,ce>>>=8,re[ge+1]=ce&255,re[ge+2]=ce>>>8,me+16}function Ge(re,me){var ce=re.length,fe=2*ce>me?2*ce:me+5,ge=0;if(ce>=me)return re;if(er){var ye=Mb(fe);if(re.copy)re.copy(ye);else for(;ge<re.length;++ge)ye[ge]=re[ge];return ye}else if(J){var Re=new Uint8Array(fe);if(Re.set)Re.set(re);else for(;ge<ce;++ge)Re[ge]=re[ge];return Re}return re.length=fe,re}function Ie(re){for(var me=new Array(re),ce=0;ce<re;++ce)me[ce]=0;return me}function Ve(re,me,ce){var fe=1,ge=0,ye=0,Re=0,He=0,Fe=re.length,Oe=J?new Uint16Array(32):Ie(32);for(ye=0;ye<32;++ye)Oe[ye]=0;for(ye=Fe;ye<ce;++ye)re[ye]=0;Fe=re.length;var Le=J?new Uint16Array(Fe):Ie(Fe);for(ye=0;ye<Fe;++ye)Oe[ge=re[ye]]++,fe<ge&&(fe=ge),Le[ye]=0;for(Oe[0]=0,ye=1;ye<=fe;++ye)Oe[ye+16]=He=He+Oe[ye-1]<<1;for(ye=0;ye<Fe;++ye)He=re[ye],He!=0&&(Le[ye]=Oe[He+16]++);var Qe=0;for(ye=0;ye<Fe;++ye)if(Qe=re[ye],Qe!=0)for(He=ee(Le[ye],fe)>>fe-Qe,Re=(1<<fe+4-Qe)-1;Re>=0;--Re)me[He|Re<<Qe]=Qe&15|ye<<4;return fe}var Ue=J?new Uint16Array(512):Ie(512),ze=J?new Uint16Array(32):Ie(32);if(!J){for(var Ke=0;Ke<512;++Ke)Ue[Ke]=0;for(Ke=0;Ke<32;++Ke)ze[Ke]=0}(function(){for(var re=[],me=0;me<32;me++)re.push(5);Ve(re,ze,32);var ce=[];for(me=0;me<=143;me++)ce.push(8);for(;me<=255;me++)ce.push(9);for(;me<=279;me++)ce.push(7);for(;me<=287;me++)ce.push(8);Ve(ce,Ue,288)})();var ue=function(){for(var me=J?new Uint8Array(32768):[],ce=0,fe=0;ce<ne.length-1;++ce)for(;fe<ne[ce+1];++fe)me[fe]=ce;for(;fe<32768;++fe)me[fe]=29;var ge=J?new Uint8Array(259):[];for(ce=0,fe=0;ce<oe.length-1;++ce)for(;fe<oe[ce+1];++fe)ge[fe]=ce;function ye(He,Fe){for(var Oe=0;Oe<He.length;){var Le=Math.min(65535,He.length-Oe),Qe=Oe+Le==He.length;for(Fe.write_shift(1,+Qe),Fe.write_shift(2,Le),Fe.write_shift(2,~Le&65535);Le-- >0;)Fe[Fe.l++]=He[Oe++]}return Fe.l}function Re(He,Fe){for(var Oe=0,Le=0,Qe=J?new Uint16Array(32768):[];Le<He.length;){var et=Math.min(65535,He.length-Le);if(et<10){for(Oe=Ee(Fe,Oe,+(Le+et==He.length)),Oe&7&&(Oe+=8-(Oe&7)),Fe.l=Oe/8|0,Fe.write_shift(2,et),Fe.write_shift(2,~et&65535);et-- >0;)Fe[Fe.l++]=He[Le++];Oe=Fe.l*8;continue}Oe=Ee(Fe,Oe,+(Le+et==He.length)+2);for(var ut=0;et-- >0;){var Je=He[Le];ut=(ut<<5^Je)&32767;var st=-1,kt=0;if((st=Qe[ut])&&(st|=Le&-32768,st>Le&&(st-=32768),st<Le))for(;He[st+kt]==He[Le+kt]&&kt<250;)++kt;if(kt>2){Je=ge[kt],Je<=22?Oe=Ce(Fe,Oe,Q[Je+1]>>1)-1:(Ce(Fe,Oe,3),Oe+=5,Ce(Fe,Oe,Q[Je-23]>>5),Oe+=3);var vr=Je<8?0:Je-4>>2;vr>0&&(Te(Fe,Oe,kt-oe[Je]),Oe+=vr),Je=me[Le-st],Oe=Ce(Fe,Oe,Q[Je]>>3),Oe-=3;var hr=Je<4?0:Je-2>>1;hr>0&&(Te(Fe,Oe,Le-st-ne[Je]),Oe+=hr);for(var Ir=0;Ir<kt;++Ir)Qe[ut]=Le&32767,ut=(ut<<5^He[Le])&32767,++Le;et-=kt-1}else Je<=143?Je=Je+48:Oe=he(Fe,Oe,1),Oe=Ce(Fe,Oe,Q[Je]),Qe[ut]=Le&32767,++Le}Oe=Ce(Fe,Oe,0)-1}return Fe.l=(Oe+7)/8|0,Fe.l}return function(Fe,Oe){return Fe.length<8?ye(Fe,Oe):Re(Fe,Oe)}}();function be(re){var me=un(50+Math.floor(re.length*1.1)),ce=ue(re,me);return me.slice(0,ce)}var Ae=J?new Uint16Array(32768):Ie(32768),Me=J?new Uint16Array(32768):Ie(32768),We=J?new Uint16Array(128):Ie(128),lt=1,yt=1;function _t(re,me){var ce=xe(re,me)+257;me+=5;var fe=xe(re,me)+1;me+=5;var ge=pe(re,me)+4;me+=4;for(var ye=0,Re=J?new Uint8Array(19):Ie(19),He=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Fe=1,Oe=J?new Uint8Array(8):Ie(8),Le=J?new Uint8Array(8):Ie(8),Qe=Re.length,et=0;et<ge;++et)Re[te[et]]=ye=Y(re,me),Fe<ye&&(Fe=ye),Oe[ye]++,me+=3;var ut=0;for(Oe[0]=0,et=1;et<=Fe;++et)Le[et]=ut=ut+Oe[et-1]<<1;for(et=0;et<Qe;++et)(ut=Re[et])!=0&&(He[et]=Le[ut]++);var Je=0;for(et=0;et<Qe;++et)if(Je=Re[et],Je!=0){ut=Q[He[et]]>>8-Je;for(var st=(1<<7-Je)-1;st>=0;--st)We[ut|st<<Je]=Je&7|et<<3}var kt=[];for(Fe=1;kt.length<ce+fe;)switch(ut=We[ae(re,me)],me+=ut&7,ut>>>=3){case 16:for(ye=3+K(re,me),me+=2,ut=kt[kt.length-1];ye-- >0;)kt.push(ut);break;case 17:for(ye=3+Y(re,me),me+=3;ye-- >0;)kt.push(0);break;case 18:for(ye=11+ae(re,me),me+=7;ye-- >0;)kt.push(0);break;default:kt.push(ut),Fe<ut&&(Fe=ut);break}var vr=kt.slice(0,ce),hr=kt.slice(ce);for(et=ce;et<286;++et)vr[et]=0;for(et=fe;et<30;++et)hr[et]=0;return lt=Ve(vr,Ae,286),yt=Ve(hr,Me,30),me}function $t(re,me){if(re[0]==3&&!(re[1]&3))return[go(me),2];for(var ce=0,fe=0,ge=Mb(me||1<<18),ye=0,Re=ge.length>>>0,He=0,Fe=0;!(fe&1);){if(fe=Y(re,ce),ce+=3,fe>>>1)fe>>1==1?(He=9,Fe=5):(ce=_t(re,ce),He=lt,Fe=yt);else{ce&7&&(ce+=8-(ce&7));var Oe=re[ce>>>3]|re[(ce>>>3)+1]<<8;if(ce+=32,Oe>0)for(!me&&Re<ye+Oe&&(ge=Ge(ge,ye+Oe),Re=ge.length);Oe-- >0;)ge[ye++]=re[ce>>>3],ce+=8;continue}for(;;){!me&&Re<ye+32767&&(ge=Ge(ge,ye+32767),Re=ge.length);var Le=de(re,ce,He),Qe=fe>>>1==1?Ue[Le]:Ae[Le];if(ce+=Qe&15,Qe>>>=4,!(Qe>>>8&255))ge[ye++]=Qe;else{if(Qe==256)break;Qe-=257;var et=Qe<8?0:Qe-4>>2;et>5&&(et=0);var ut=ye+oe[Qe];et>0&&(ut+=de(re,ce,et),ce+=et),Le=de(re,ce,Fe),Qe=fe>>>1==1?ze[Le]:Me[Le],ce+=Qe&15,Qe>>>=4;var Je=Qe<4?0:Qe-2>>1,st=ne[Qe];for(Je>0&&(st+=de(re,ce,Je),ce+=Je),!me&&Re<ut&&(ge=Ge(ge,ut+100),Re=ge.length);ye<ut;)ge[ye]=ge[ye-st],++ye}}}return me?[ge,ce+7>>>3]:[ge.slice(0,ye),ce+7>>>3]}function ht(re,me){var ce=re.slice(re.l||0),fe=$t(ce,me);return re.l+=fe[1],fe[0]}function ct(re,me){if(re)typeof console<"u"&&console.error(me);else throw new Error(me)}function pt(re,me){var ce=re;In(ce,0);var fe=[],ge=[],ye={FileIndex:fe,FullPaths:ge};T(ye,{root:me.root});for(var Re=ce.length-4;(ce[Re]!=80||ce[Re+1]!=75||ce[Re+2]!=5||ce[Re+3]!=6)&&Re>=0;)--Re;ce.l=Re+4,ce.l+=4;var He=ce.read_shift(2);ce.l+=6;var Fe=ce.read_shift(4);for(ce.l=Fe,Re=0;Re<He;++Re){ce.l+=20;var Oe=ce.read_shift(4),Le=ce.read_shift(4),Qe=ce.read_shift(2),et=ce.read_shift(2),ut=ce.read_shift(2);ce.l+=8;var Je=ce.read_shift(4),st=o(ce.slice(ce.l+Qe,ce.l+Qe+et));ce.l+=Qe+et+ut;var kt=ce.l;ce.l=Je+4,Ct(ce,Oe,Le,ye,st),ce.l=kt}return ye}function Ct(re,me,ce,fe,ge){re.l+=2;var ye=re.read_shift(2),Re=re.read_shift(2),He=a(re);if(ye&8257)throw new Error("Unsupported ZIP encryption");for(var Fe=re.read_shift(4),Oe=re.read_shift(4),Le=re.read_shift(4),Qe=re.read_shift(2),et=re.read_shift(2),ut="",Je=0;Je<Qe;++Je)ut+=String.fromCharCode(re[re.l++]);if(et){var st=o(re.slice(re.l,re.l+et));(st[21589]||{}).mt&&(He=st[21589].mt),((ge||{})[21589]||{}).mt&&(He=ge[21589].mt)}re.l+=et;var kt=re.slice(re.l,re.l+Oe);switch(Re){case 8:kt=H(re,Le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Re)}var vr=!1;ye&8&&(Fe=re.read_shift(4),Fe==134695760&&(Fe=re.read_shift(4),vr=!0),Oe=re.read_shift(4),Le=re.read_shift(4)),Oe!=me&&ct(vr,"Bad compressed size: "+me+" != "+Oe),Le!=ce&&ct(vr,"Bad uncompressed size: "+ce+" != "+Le),Rr(fe,ut,kt,{unsafe:!0,mt:He})}function Rt(re,me){var ce=me||{},fe=[],ge=[],ye=un(1),Re=ce.compression?8:0,He=0,Fe=0,Oe=0,Le=0,Qe=0,et=re.FullPaths[0],ut=et,Je=re.FileIndex[0],st=[],kt=0;for(Fe=1;Fe<re.FullPaths.length;++Fe)if(ut=re.FullPaths[Fe].slice(et.length),Je=re.FileIndex[Fe],!(!Je.size||!Je.content||ut=="Sh33tJ5")){var vr=Le,hr=un(ut.length);for(Oe=0;Oe<ut.length;++Oe)hr.write_shift(1,ut.charCodeAt(Oe)&127);hr=hr.slice(0,hr.l),st[Qe]=mJ.buf(Je.content,0);var Ir=Je.content;Re==8&&(Ir=V(Ir)),ye=un(30),ye.write_shift(4,67324752),ye.write_shift(2,20),ye.write_shift(2,He),ye.write_shift(2,Re),Je.mt?i(ye,Je.mt):ye.write_shift(4,0),ye.write_shift(-4,st[Qe]),ye.write_shift(4,Ir.length),ye.write_shift(4,Je.content.length),ye.write_shift(2,hr.length),ye.write_shift(2,0),Le+=ye.length,fe.push(ye),Le+=hr.length,fe.push(hr),Le+=Ir.length,fe.push(Ir),ye=un(46),ye.write_shift(4,33639248),ye.write_shift(2,0),ye.write_shift(2,20),ye.write_shift(2,He),ye.write_shift(2,Re),ye.write_shift(4,0),ye.write_shift(-4,st[Qe]),ye.write_shift(4,Ir.length),ye.write_shift(4,Je.content.length),ye.write_shift(2,hr.length),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(4,0),ye.write_shift(4,vr),kt+=ye.l,ge.push(ye),kt+=hr.length,ge.push(hr),++Qe}return ye=un(22),ye.write_shift(4,101010256),ye.write_shift(2,0),ye.write_shift(2,0),ye.write_shift(2,Qe),ye.write_shift(2,Qe),ye.write_shift(4,kt),ye.write_shift(4,Le),ye.write_shift(2,0),Xi([Xi(fe),Xi(ge),ye])}var mr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function mn(re,me){if(re.ctype)return re.ctype;var ce=re.name||"",fe=ce.match(/\.([^\.]+)$/);return fe&&mr[fe[1]]||me&&(fe=(ce=me).match(/[\.\\]([^\.\\])+$/),fe&&mr[fe[1]])?mr[fe[1]]:"application/octet-stream"}function Qs(re){for(var me=Ob(re),ce=[],fe=0;fe<me.length;fe+=76)ce.push(me.slice(fe,fe+76));return ce.join(`\r
`)+`\r
`}function ms(re){var me=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Oe){var Le=Oe.charCodeAt(0).toString(16).toUpperCase();return"="+(Le.length==1?"0"+Le:Le)});me=me.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),me.charAt(0)==`
`&&(me="=0D"+me.slice(1)),me=me.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ce=[],fe=me.split(`\r
`),ge=0;ge<fe.length;++ge){var ye=fe[ge];if(ye.length==0){ce.push("");continue}for(var Re=0;Re<ye.length;){var He=76,Fe=ye.slice(Re,Re+He);Fe.charAt(He-1)=="="?He--:Fe.charAt(He-2)=="="?He-=2:Fe.charAt(He-3)=="="&&(He-=3),Fe=ye.slice(Re,Re+He),Re+=He,Re<ye.length&&(Fe+="="),ce.push(Fe)}}return ce.join(`\r
`)}function wl(re){for(var me=[],ce=0;ce<re.length;++ce){for(var fe=re[ce];ce<=re.length&&fe.charAt(fe.length-1)=="=";)fe=fe.slice(0,fe.length-1)+re[++ce];me.push(fe)}for(var ge=0;ge<me.length;++ge)me[ge]=me[ge].replace(/[=][0-9A-Fa-f]{2}/g,function(ye){return String.fromCharCode(parseInt(ye.slice(1),16))});return ca(me.join(`\r
`))}function za(re,me,ce){for(var fe="",ge="",ye="",Re,He=0;He<10;++He){var Fe=me[He];if(!Fe||Fe.match(/^\s*$/))break;var Oe=Fe.match(/^(.*?):\s*([^\s].*)$/);if(Oe)switch(Oe[1].toLowerCase()){case"content-location":fe=Oe[2].trim();break;case"content-type":ye=Oe[2].trim();break;case"content-transfer-encoding":ge=Oe[2].trim();break}}switch(++He,ge.toLowerCase()){case"base64":Re=ca(Os(me.slice(He).join("")));break;case"quoted-printable":Re=wl(me.slice(He));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ge)}var Le=Rr(re,fe.slice(ce.length),Re,{unsafe:!0});ye&&(Le.ctype=ye)}function So(re,me){if(O(re.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ce=me&&me.root||"",fe=(er&&Buffer.isBuffer(re)?re.toString("binary"):O(re)).split(`\r
`),ge=0,ye="";for(ge=0;ge<fe.length;++ge)if(ye=fe[ge],!!/^Content-Location:/i.test(ye)&&(ye=ye.slice(ye.indexOf("file")),ce||(ce=ye.slice(0,ye.lastIndexOf("/")+1)),ye.slice(0,ce.length)!=ce))for(;ce.length>0&&(ce=ce.slice(0,ce.length-1),ce=ce.slice(0,ce.lastIndexOf("/")+1),ye.slice(0,ce.length)!=ce););var Re=(fe[1]||"").match(/boundary="(.*?)"/);if(!Re)throw new Error("MAD cannot find boundary");var He="--"+(Re[1]||""),Fe=[],Oe=[],Le={FileIndex:Fe,FullPaths:Oe};T(Le);var Qe,et=0;for(ge=0;ge<fe.length;++ge){var ut=fe[ge];ut!==He&&ut!==He+"--"||(et++&&za(Le,fe.slice(Qe,ge),ce),Qe=ge)}return Le}function ln(re,me){var ce=me||{},fe=ce.boundary||"SheetJS";fe="------="+fe;for(var ge=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+fe.slice(2)+'"',"","",""],ye=re.FullPaths[0],Re=ye,He=re.FileIndex[0],Fe=1;Fe<re.FullPaths.length;++Fe)if(Re=re.FullPaths[Fe].slice(ye.length),He=re.FileIndex[Fe],!(!He.size||!He.content||Re=="Sh33tJ5")){Re=Re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(kt){return"_x"+kt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(kt){return"_u"+kt.charCodeAt(0).toString(16)+"_"});for(var Oe=He.content,Le=er&&Buffer.isBuffer(Oe)?Oe.toString("binary"):O(Oe),Qe=0,et=Math.min(1024,Le.length),ut=0,Je=0;Je<=et;++Je)(ut=Le.charCodeAt(Je))>=32&&ut<128&&++Qe;var st=Qe>=et*4/5;ge.push(fe),ge.push("Content-Location: "+(ce.root||"file:///C:/SheetJS/")+Re),ge.push("Content-Transfer-Encoding: "+(st?"quoted-printable":"base64")),ge.push("Content-Type: "+mn(He,Re)),ge.push(""),ge.push(st?ms(Le):Qs(Le))}return ge.push(fe+`--\r
`),ge.join(`\r
`)}function Ao(re){var me={};return T(me,re),me}function Rr(re,me,ce,fe){var ge=fe&&fe.unsafe;ge||T(re);var ye=!ge&&nr.find(re,me);if(!ye){var Re=re.FullPaths[0];me.slice(0,Re.length)==Re?Re=me:(Re.slice(-1)!="/"&&(Re+="/"),Re=(Re+me).replace("//","/")),ye={name:s(me),type:2},re.FileIndex.push(ye),re.FullPaths.push(Re),ge||nr.utils.cfb_gc(re)}return ye.content=ce,ye.size=ce?ce.length:0,fe&&(fe.CLSID&&(ye.clsid=fe.CLSID),fe.mt&&(ye.mt=fe.mt),fe.ct&&(ye.ct=fe.ct)),ye}function Ln(re,me){T(re);var ce=nr.find(re,me);if(ce){for(var fe=0;fe<re.FileIndex.length;++fe)if(re.FileIndex[fe]==ce)return re.FileIndex.splice(fe,1),re.FullPaths.splice(fe,1),!0}return!1}function Cl(re,me,ce){T(re);var fe=nr.find(re,me);if(fe){for(var ge=0;ge<re.FileIndex.length;++ge)if(re.FileIndex[ge]==fe)return re.FileIndex[ge].name=s(ce),re.FullPaths[ge]=ce,!0}return!1}function qc(re){m(re,!0)}return e.find=I,e.read=k,e.parse=u,e.write=G,e.writeFile=M,e.utils={cfb_new:Ao,cfb_add:Rr,cfb_del:Ln,cfb_mov:Cl,cfb_gc:qc,ReadShift:qu,CheckField:ck,prep_blob:In,bconcat:Xi,use_zlib:j,_deflateRaw:be,_inflateRaw:ht,consts:N},e}();function gJ(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Va(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function ux(t){for(var e=[],r=Va(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var Th=new Date(1899,11,30,0,0,0);function ps(t,e){var r=t.getTime(),n=Th.getTime()+(t.getTimezoneOffset()-Th.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var HI=new Date,vJ=Th.getTime()+(HI.getTimezoneOffset()-Th.getTimezoneOffset())*6e4,Gb=HI.getTimezoneOffset();function $p(t){var e=new Date;return e.setTime(t*24*60*60*1e3+vJ),e.getTimezoneOffset()!==Gb&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Gb)*6e4),e}function yJ(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var i=1;i!=s.length;++i)if(s[i]){switch(r=1,i>3&&(n=!0),s[i].slice(s[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[i].slice(s[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[i],10)}return e}var Wb=new Date("2017-02-19T19:06:09.000Z"),jI=isNaN(Wb.getFullYear())?new Date("2/19/17"):Wb,xJ=jI.getFullYear()==2017;function En(t,e){var r=new Date(t);if(xJ)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(jI.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function cl(t,e){if(er&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Tu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Tu(kI(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Tu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Tu(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return r[i]||i})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function On(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=On(t[r]));return e}function Vr(t,e){for(var r="";r.length<e;)r+=t;return r}function ma(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,i){return r=-r,i}),!isNaN(e=Number(n)))?e/r:e}var EJ=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),i=e.getDate();if(isNaN(i))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&EJ.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||i>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var _J=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var i=r.split(n),a=[i[0]],o=1;o<i.length;++o)a.push(s),a.push(i[o]);return a}}();function GI(t){return t?t.content&&t.type?cl(t.content,!0):t.data?bu(t.data):t.asNodeBuffer&&er?bu(t.asNodeBuffer().toString("binary")):t.asBinary?bu(t.asBinary()):t._data&&t._data.getContent?bu(cl(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function WI(t){if(!t)return null;if(t.data)return Fb(t.data);if(t.asNodeBuffer&&er)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Fb(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function bJ(t){return t&&t.name.slice(-4)===".bin"?WI(t):GI(t)}function Vs(t,e){for(var r=t.FullPaths||Va(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var a=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||s==a)return t.files?t.files[r[i]]:t.FileIndex[i]}return null}function dx(t,e){var r=Vs(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function tn(t,e,r){if(!r)return bJ(dx(t,e));if(!e)return null;try{return tn(t,e)}catch{return null}}function Ds(t,e,r){if(!r)return GI(dx(t,e));if(!e)return null;try{return Ds(t,e)}catch{return null}}function SJ(t,e,r){return WI(dx(t,e))}function zb(t){for(var e=t.FullPaths||Va(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function AJ(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return er?n=El(r):n=jQ(r),nr.utils.cfb_add(t,e,n)}nr.utils.cfb_add(t,e,r)}else t.file(e,r)}function zI(t,e){switch(e.type){case"base64":return nr.read(t,{type:"base64"});case"binary":return nr.read(t,{type:"binary"});case"buffer":case"array":return nr.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Au(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var KI=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,TJ=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Kb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,wJ=/<[^>]*>/g,ns=KI.match(Kb)?Kb:wJ,CJ=/<\w*:/,IJ=/<(\/?)\w+:/;function It(t,e,r){for(var n={},s=0,i=0;s!==t.length&&!((i=t.charCodeAt(s))===32||i===10||i===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var a=t.match(TJ),o=0,l="",c=0,u="",f="",h=1;if(a)for(c=0;c!=a.length;++c){for(f=a[c],i=0;i!=f.length&&f.charCodeAt(i)!==61;++i);for(u=f.slice(0,i).trim();f.charCodeAt(i+1)==32;)++i;for(h=(s=f.charCodeAt(i+1))==34||s==39?1:0,l=f.slice(i+1+h,f.length-h),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var p=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[p]&&u.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ga(t){return t.replace(IJ,"<$1")}var qI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},kJ=ux(qI),ir=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",i=s.indexOf("<![CDATA[");if(i==-1)return s.replace(t,function(o,l){return qI[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=s.indexOf("]]>");return r(s.slice(0,i))+s.slice(i+9,a)+r(s.slice(a+3))}}(),DJ=/[&<>'"]/g,PJ=/[\u0000-\u001f]/g;function fx(t){var e=t+"";return e.replace(DJ,function(r){return kJ[r]}).replace(/\n/g,"<br/>").replace(PJ,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var qb=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function Dr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function gg(t){for(var e="",r=0,n=0,s=0,i=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=s&63,e+=String.fromCharCode(a);continue}if(i=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|i&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(i&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Xb(t){var e=go(2*t.length),r,n,s=1,i=0,a=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[i++]=a&255,e[i++]=a>>>8,a=0),e[i++]=r%256,e[i++]=r>>>8;return e.slice(0,i).toString("ucs2")}function Yb(t){return El(t,"binary").toString("utf8")}var Yf="foo bar bazâð£",Ar=er&&(Yb(Yf)==gg(Yf)&&Yb||Xb(Yf)==gg(Yf)&&Xb)||gg,Tu=er?function(t){return El(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Dd=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),XI=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),RJ=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),FJ=/<\/?(?:vt:)?variant>/g,NJ=/<(?:vt:)([^>]*)>([\s\S]*)</;function Qb(t,e){var r=It(t),n=t.match(RJ(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(i){var a=i.replace(FJ,"").match(NJ);a&&s.push({v:Ar(a[2]),t:a[1]})}),s}var OJ=/(^\s|\s$|\n)/;function MJ(t){return Va(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function LJ(t,e,r){return"<"+t+(r!=null?MJ(r):"")+(e!=null?(e.match(OJ)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function hx(t){if(er&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Ar(_l(ox(t)));throw new Error("Bad input format: expected Buffer or string")}var Pd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,BJ={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},UJ=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function $J(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,i=5;i>=0;--i)s=s*256+t[e+i];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function VJ(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,i=0,a=n?-e:e;isFinite(a)?a==0?s=i=0:(s=Math.floor(Math.log(a)/Math.LN2),i=a*Math.pow(2,52-s),s<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?s=-1022:(i-=Math.pow(2,52),s+=1023)):(s=2047,i=isNaN(e)?26985:0);for(var o=0;o<=5;++o,i/=256)t[r+o]=i&255;t[r+6]=(s&15)<<4|i&15,t[r+7]=s>>4|n}var Jb=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,i=t[0][n].length;s<i;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},Zb=er?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:El(e)})):Jb(t)}:Jb,eS=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(di(t,s)));return n.join("").replace(hs,"")},px=er?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(hs,""):eS(t,e,r)}:eS,tS=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},YI=er?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):tS(t,e,r)}:tS,rS=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Kl(t,s)));return n.join("")},of=er?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):rS(e,r,n)}:rS,QI=function(t,e){var r=ks(t,e);return r>0?of(t,e+4,e+4+r-1):""},JI=QI,ZI=function(t,e){var r=ks(t,e);return r>0?of(t,e+4,e+4+r-1):""},ek=ZI,tk=function(t,e){var r=2*ks(t,e);return r>0?of(t,e+4,e+4+r-1):""},rk=tk,nk=function(e,r){var n=ks(e,r);return n>0?px(e,r+4,r+4+n):""},sk=nk,ak=function(t,e){var r=ks(t,e);return r>0?of(t,e+4,e+4+r):""},ik=ak,ok=function(t,e){return $J(t,e)},wh=ok,lk=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};er&&(JI=function(e,r){if(!Buffer.isBuffer(e))return QI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},ek=function(e,r){if(!Buffer.isBuffer(e))return ZI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},rk=function(e,r){if(!Buffer.isBuffer(e))return tk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},sk=function(e,r){if(!Buffer.isBuffer(e))return nk(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},ik=function(e,r){if(!Buffer.isBuffer(e))return ak(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},wh=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):ok(e,r)},lk=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Kl=function(t,e){return t[e]},di=function(t,e){return t[e+1]*256+t[e]},HJ=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ks=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Mo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},jJ=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function qu(t,e){var r="",n,s,i=[],a,o,l,c;switch(e){case"dbcs":if(c=this.l,er&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(di(this,c)),c+=2;t*=2;break;case"utf8":r=of(this,this.l,this.l+t);break;case"utf16le":t*=2,r=px(this,this.l,this.l+t);break;case"wstr":return qu.call(this,t,"dbcs");case"lpstr-ansi":r=JI(this,this.l),t=4+ks(this,this.l);break;case"lpstr-cp":r=ek(this,this.l),t=4+ks(this,this.l);break;case"lpwstr":r=rk(this,this.l),t=4+2*ks(this,this.l);break;case"lpp4":t=4+ks(this,this.l),r=sk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ks(this,this.l),r=ik(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Kl(this,this.l+t++))!==0;)i.push(Xf(a));r=i.join("");break;case"_wstr":for(t=0,r="";(a=di(this,this.l+t))!==0;)i.push(Xf(a)),t+=2;t+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Kl(this,c),this.l=c+1,o=qu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Xf(di(this,c))),c+=2}r=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return a=Kl(this,c),this.l=c+1,o=qu.call(this,t-l,a?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(Xf(Kl(this,c))),c+=1}r=i.join("");break;default:switch(t){case 1:return n=Kl(this,this.l),this.l++,n;case 2:return n=(e==="i"?HJ:di)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?Mo:jJ)(this,this.l),this.l+=4,n):(s=ks(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=wh(this,this.l):s=wh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=YI(this,this.l,t);break}}return this.l+=t,r}var GJ=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},WJ=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},zJ=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function KJ(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)zJ(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var a=e.charCodeAt(s);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,GJ(this,e,this.l);break;case 8:if(n=8,r==="f"){VJ(this,e,this.l);break}case 16:break;case-4:n=4,WJ(this,e,this.l);break}return this.l+=n,this}function ck(t,e){var r=YI(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function In(t,e){t.l=e,t.read_shift=qu,t.chk=ck,t.write_shift=KJ}function rs(t,e){t.l+=e}function un(t){var e=go(t);return In(e,0),e}function Pi(t,e,r){if(t){var n,s,i;In(t,t.l||0);for(var a=t.length,o=0,l=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var c=Rh[o]||Rh[65535];for(n=t.read_shift(1),i=n&127,s=1;s<4&&n&128;++s)i+=((n=t.read_shift(1))&127)<<7*s;l=t.l+i;var u=c.f&&c.f(t,i,r);if(t.l=l,e(u,c,o))return}}}function Gv(){var t=[],e=er?256:2048,r=function(c){var u=un(c);return In(u,0),u},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(s(),n=r(Math.max(c+1,e)))},a=function(){return s(),Xi(t)},o=function(c){s(),n=c,n.l==null&&(n.l=n.length),i(e)};return{next:i,push:o,end:a,_bufs:t}}function Xu(t,e,r){var n=On(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function nS(t,e,r){var n=On(t);return n.s=Xu(n.s,e.s,r),n.e=Xu(n.e,e.s,r),n}function Yu(t,e){if(t.cRel&&t.c<0)for(t=On(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=On(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Mt(t);return!t.cRel&&t.cRel!=null&&(r=YJ(r)),!t.rRel&&t.rRel!=null&&(r=qJ(r)),r}function vg(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+hn(t.s.c)+":"+(t.e.cRel?"":"$")+hn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Mn(t.s.r)+":"+(t.e.rRel?"":"$")+Mn(t.e.r):Yu(t.s,e.biff)+":"+Yu(t.e,e.biff)}function mx(t){return parseInt(XJ(t),10)-1}function Mn(t){return""+(t+1)}function qJ(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function XJ(t){return t.replace(/\$(\d+)$/,"$1")}function gx(t){for(var e=QJ(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function hn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function YJ(t){return t.replace(/^([A-Z])/,"$$$1")}function QJ(t){return t.replace(/^\$([A-Z])/,"$1")}function JJ(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ds(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Mt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function zc(t){var e=t.indexOf(":");return e==-1?{s:ds(t),e:ds(t)}:{s:ds(t.slice(0,e)),e:ds(t.slice(e+1))}}function ar(t,e){return typeof e>"u"||typeof e=="number"?ar(t.s,t.e):(typeof t!="string"&&(t=Mt(t)),typeof e!="string"&&(e=Mt(e)),t==e?t:t+":"+e)}function Gr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,i=t.length;for(r=0;n<i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===i||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=i&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=i&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function sS(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ks(t.z,r?ps(e):e)}catch{}try{return t.w=Ks((t.XF||{}).numFmtId||(r?14:0),r?ps(e):e)}catch{return""+e}}function Ci(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Al[t.v]||t.v:e==null?sS(t,t.v):sS(t,e))}function bo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function uk(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,i=t||(s?[]:{}),a=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ds(n.origin):n.origin;a=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var u=Gr(i["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),a==-1&&(c.e.r=a=u.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[f].length;++h)if(!(typeof e[f][h]>"u")){var p={v:e[f][h]},g=a+f,y=o+h;if(c.s.r>g&&(c.s.r=g),c.s.c>y&&(c.s.c=y),c.e.r<g&&(c.e.r=g),c.e.c<y&&(c.e.c=y),e[f][h]&&typeof e[f][h]=="object"&&!Array.isArray(e[f][h])&&!(e[f][h]instanceof Date))p=e[f][h];else if(Array.isArray(p.v)&&(p.f=e[f][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Ut[14],n.cellDates?(p.t="d",p.w=Ks(p.z,ps(p.v))):(p.t="n",p.v=ps(p.v),p.w=Ks(p.z,p.v))):p.t="s";if(s)i[g]||(i[g]=[]),i[g][y]&&i[g][y].z&&(p.z=i[g][y].z),i[g][y]=p;else{var E=Mt({c:y,r:g});i[E]&&i[E].z&&(p.z=i[E].z),i[E]=p}}}return c.s.c<1e7&&(i["!ref"]=ar(c)),i}function Kc(t,e){return uk(null,t,e)}function ZJ(t){return t.read_shift(4,"i")}function es(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function eZ(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function vx(t,e){var r=t.l,n=t.read_shift(1),s=es(t),i=[],a={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)i.push(eZ(t));a.r=i}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}var tZ=vx;function Ys(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function bl(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var rZ=es;function yx(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var nZ=es,Wv=yx;function xx(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?wh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Mo(e,0)>>2;return r?s/100:s}function dk(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Sl=dk;function qn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function sZ(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),i=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var c=Yo[s];c&&(e.rgb=Fd(c));break;case 2:e.rgb=Fd([a,o,l]);break;case 3:e.theme=s;break}return i!=0&&(e.tint=i>0?i/32767:i/32768),e}function aZ(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function fk(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function iZ(t){return fk(t,1)}function oZ(t){return fk(t,2)}var Ex=2,xs=3,Qf=11,aS=12,Ch=19,Jf=64,lZ=65,cZ=71,uZ=4108,dZ=4126,yn=80,hk=81,fZ=[yn,hk],hZ={1:{n:"CodePage",t:Ex},2:{n:"Category",t:yn},3:{n:"PresentationFormat",t:yn},4:{n:"ByteCount",t:xs},5:{n:"LineCount",t:xs},6:{n:"ParagraphCount",t:xs},7:{n:"SlideCount",t:xs},8:{n:"NoteCount",t:xs},9:{n:"HiddenCount",t:xs},10:{n:"MultimediaClipCount",t:xs},11:{n:"ScaleCrop",t:Qf},12:{n:"HeadingPairs",t:uZ},13:{n:"TitlesOfParts",t:dZ},14:{n:"Manager",t:yn},15:{n:"Company",t:yn},16:{n:"LinksUpToDate",t:Qf},17:{n:"CharacterCount",t:xs},19:{n:"SharedDoc",t:Qf},22:{n:"HyperlinksChanged",t:Qf},23:{n:"AppVersion",t:xs,p:"version"},24:{n:"DigSig",t:lZ},26:{n:"ContentType",t:yn},27:{n:"ContentStatus",t:yn},28:{n:"Language",t:yn},29:{n:"Version",t:yn},255:{},2147483648:{n:"Locale",t:Ch},2147483651:{n:"Behavior",t:Ch},1919054434:{}},pZ={1:{n:"CodePage",t:Ex},2:{n:"Title",t:yn},3:{n:"Subject",t:yn},4:{n:"Author",t:yn},5:{n:"Keywords",t:yn},6:{n:"Comments",t:yn},7:{n:"Template",t:yn},8:{n:"LastAuthor",t:yn},9:{n:"RevNumber",t:yn},10:{n:"EditTime",t:Jf},11:{n:"LastPrinted",t:Jf},12:{n:"CreatedDate",t:Jf},13:{n:"ModifiedDate",t:Jf},14:{n:"PageCount",t:xs},15:{n:"WordCount",t:xs},16:{n:"CharCount",t:xs},17:{n:"Thumbnail",t:cZ},18:{n:"Application",t:yn},19:{n:"DocSecurity",t:xs},255:{},2147483648:{n:"Locale",t:Ch},2147483651:{n:"Behavior",t:Ch},1919054434:{}},iS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},mZ=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function gZ(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var vZ=gZ([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Yo=On(vZ),Al={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},pk={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},oS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function yZ(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function xZ(t){var e=yZ();if(!t||!t.match)return e;var r={};if((t.match(ns)||[]).forEach(function(n){var s=It(n);switch(s[0].replace(CJ,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[oS[s.ContentType]]!==void 0&&e[oS[s.ContentType]].push(s.PartName);break}}),e.xmlns!==BJ.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Ql={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function zv(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Qu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ns)||[]).forEach(function(s){var i=It(s);if(i[0]==="<Relationship"){var a={};a.Type=i.Type,a.Target=i.Target,a.Id=i.Id,i.TargetMode&&(a.TargetMode=i.TargetMode);var o=i.TargetMode==="External"?i.Target:Au(i.Target,e);r[o]=a,n[i.Id]=a}}),r["!id"]=n,r}var EZ="application/vnd.oasis.opendocument.spreadsheet";function _Z(t,e){for(var r=hx(t),n,s;n=Pd.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=It(n[0],!1),s.path=="/"&&s.type!==EZ)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Ju=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],bZ=function(){for(var t=new Array(Ju.length),e=0;e<Ju.length;++e){var r=Ju[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function mk(t){var e={};t=Ar(t);for(var r=0;r<Ju.length;++r){var n=Ju[r],s=t.match(bZ[r]);s!=null&&s.length>0&&(e[n[1]]=ir(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=En(e[n[1]]))}return e}var SZ=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function gk(t,e,r,n){var s=[];if(typeof t=="string")s=Qb(t,n);else for(var i=0;i<t.length;++i)s=s.concat(t[i].map(function(u){return{v:u}}));var a=typeof e=="string"?Qb(e,n).map(function(u){return u.v}):e,o=0,l=0;if(a.length>0)for(var c=0;c!==s.length;c+=2){switch(l=+s[c+1].v,s[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(o,o+l);break}o+=l}}function AZ(t,e,r){var n={};return e||(e={}),t=Ar(t),SZ.forEach(function(s){var i=(t.match(Dd(s[0]))||[])[1];switch(s[2]){case"string":i&&(e[s[1]]=ir(i));break;case"bool":e[s[1]]=i==="true";break;case"raw":var a=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));a&&a.length>0&&(n[s[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&gk(n.HeadingPairs,n.TitlesOfParts,e,r),e}var TZ=/<[^>]+>[^<]*/g;function wZ(t,e){var r={},n="",s=t.match(TZ);if(s)for(var i=0;i!=s.length;++i){var a=s[i],o=It(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ir(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ir(u);break;case"bool":r[n]=Dr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=En(u);break;case"cy":case"error":r[n]=ir(u);break;default:if(c.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,c,l)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}var CZ={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},yg;function IZ(t,e,r){yg||(yg=ux(CZ)),e=yg[e]||e,t[e]=r}function _x(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function vk(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function yk(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function xk(t,e,r){return e===31?yk(t):vk(t,e,r)}function Kv(t,e,r){return xk(t,e,r===!1?0:4)}function kZ(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return xk(t,e,0)}function DZ(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(hs,""),t.l-s&2&&(t.l+=2)}return r}function PZ(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(hs,"");return r}function RZ(t){var e=t.l,r=Ih(t,hk);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Ih(t,xs);return[r,n]}function FZ(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(RZ(t));return r}function lS(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var i=t.read_shift(4),a=t.read_shift(4);n[i]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(hs,"").replace(Su,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function Ek(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function NZ(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Ih(t,e,r){var n=t.read_shift(2),s,i=r||{};if(t.l+=2,e!==aS&&n!==e&&fZ.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===aS?n:e){case 2:return s=t.read_shift(2,"i"),i.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return vk(t,n,4).replace(hs,"");case 31:return yk(t);case 64:return _x(t);case 65:return Ek(t);case 71:return NZ(t);case 80:return Kv(t,n,!i.raw).replace(hs,"");case 81:return kZ(t,n).replace(hs,"");case 4108:return FZ(t);case 4126:case 4127:return n==4127?DZ(t):PZ(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function cS(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0,o=0,l=-1,c={};for(a=0;a!=s;++a){var u=t.read_shift(4),f=t.read_shift(4);i[a]=[u,f+r]}i.sort(function(_,v){return _[1]-v[1]});var h={};for(a=0;a!=s;++a){if(t.l!==i[a][1]){var p=!0;if(a>0&&e)switch(e[i[a-1][0]].t){case 2:t.l+2===i[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break;case 4108:t.l<=i[a][1]&&(t.l=i[a][1],p=!1);break}if((!e||a==0)&&t.l<=i[a][1]&&(p=!1,t.l=i[a][1]),p)throw new Error("Read Error: Expected address "+i[a][1]+" at "+t.l+" :"+a)}if(e){var g=e[i[a][0]];if(h[g.n]=Ih(t,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:da(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(i[a][0]===1){if(o=h.CodePage=Ih(t,Ex),da(o),l!==-1){var y=t.l;t.l=i[l][1],c=lS(t,o),t.l=y}}else if(i[a][0]===0){if(o===0){l=a,t.l=i[a+1][1];continue}c=lS(t,o)}else{var E=c[i[a][0]],b;switch(t[t.l]){case 65:t.l+=4,b=Ek(t);break;case 30:t.l+=4,b=Kv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,b=Kv(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,b=t.read_shift(4,"i");break;case 19:t.l+=4,b=t.read_shift(4);break;case 5:t.l+=4,b=t.read_shift(8,"f");break;case 11:t.l+=4,b=zr(t,4);break;case 64:t.l+=4,b=En(_x(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[E]=b}}return t.l=r+n,h}function uS(t,e,r){var n=t.content;if(!n)return{};In(n,0);var s,i,a,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==nr.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(i=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(a=n.read_shift(16),l=n.read_shift(4));var f=cS(n,e),h={SystemIdentifier:c};for(var p in f)h[p]=f[p];if(h.FMTID=i,s===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var g;try{g=cS(n,null)}catch{}for(p in g)h[p]=g[p];return h.FMTID=[i,a],h}function Ui(t,e){return t.read_shift(e),null}function OZ(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function zr(t,e){return t.read_shift(e)===1}function rn(t){return t.read_shift(2,"u")}function _k(t,e){return OZ(t,e,rn)}function MZ(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function lf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=t.read_shift(1);i&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var a=n?t.read_shift(n,s):"";return a}function LZ(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,i=1+(r&1),a=0,o,l={};s&&(a=t.read_shift(2)),n&&(o=t.read_shift(4));var c=i==2?"dbcs-cont":"sbcs-cont",u=e===0?"":t.read_shift(e,c);return s&&(t.l+=4*a),n&&(t.l+=o),l.t=u,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ul(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function cf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):ul(t,n,r)}function Tl(t,e,r){if(r.biff>5)return cf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function BZ(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function UZ(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(hs,"");return n&&(t.l+=24),s}function $Z(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var i=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(i>>1,"utf16le").replace(hs,"");return r+a}function VZ(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return UZ(t);case"0303000000000000c000000000000046":return $Z(t);default:throw new Error("Unsupported Moniker "+r)}}function Zf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(hs,""):"";return r}function HZ(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var i,a,o,l,c="",u,f;s&16&&(i=Zf(t,r-t.l)),s&128&&(a=Zf(t,r-t.l)),(s&257)===257&&(o=Zf(t,r-t.l)),(s&257)===1&&(l=VZ(t,r-t.l)),s&8&&(c=Zf(t,r-t.l)),s&32&&(u=t.read_shift(16)),s&64&&(f=_x(t)),t.l=r;var h=a||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return u&&(p.guid=u),f&&(p.time=f),i&&(p.Tooltip=i),p}function bk(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function Sk(t,e){var r=bk(t);return r[3]=0,r}function Wa(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function jZ(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function GZ(t,e,r){return e===0?"":Tl(t,e,r)}function WZ(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),i=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[s,i,a]}function Ak(t){var e=t.read_shift(2),r=xx(t);return[e,r]}function zZ(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=lf(t,e,r),i=t.read_shift(2);if(n-=t.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return t.l+=i,s}function Vp(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function Tk(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var KZ=Tk;function wk(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function qZ(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function XZ(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Vn(t){t.l+=2,t.l+=t.read_shift(2)}var YZ={0:Vn,4:Vn,5:Vn,6:Vn,7:XZ,8:Vn,9:Vn,10:Vn,11:Vn,12:Vn,13:qZ,14:Vn,15:Vn,16:Vn,17:Vn,18:Vn,19:Vn,20:Vn,21:wk};function QZ(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(YZ[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function e0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function JZ(t,e){return e===0||t.read_shift(2),1200}function ZZ(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Tl(t,0,r);return t.read_shift(e+n-t.l),s}function eee(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function tee(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,i=t.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var a=lf(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:s,dt:i,name:a}}function ree(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),i=[],a=0;a!=s&&t.l<r;++a)i.push(LZ(t));return i.Count=n,i.Unique=s,i}function nee(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function see(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function aee(t){var e=jZ(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function iee(t){return t.read_shift(2),t.read_shift(4)}function dS(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,s]}function oee(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),c=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:i,CurTab:a,FirstTab:o,Selected:l,TabRatio:c}}function lee(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function cee(){}function uee(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=lf(t,0,r),n}function dee(t){var e=Wa(t);return e.isst=t.read_shift(4),e}function fee(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Wa(t);r.biff==2&&t.l++;var i=cf(t,n-t.l,r);return s.val=i,s}function hee(t,e,r){var n=t.read_shift(2),s=Tl(t,0,r);return[n,s]}var pee=Tl;function fS(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,i=t.read_shift(s),a=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:i,c:o},e:{r:a,c:l}}}function mee(t){var e=t.read_shift(2),r=t.read_shift(2),n=Ak(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function gee(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(Ak(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:a,rkrec:i}}function vee(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),i=[];t.l<r;)i.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(i.length!=a-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:a,ixfe:i}}function yee(t,e,r,n){var s={},i=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=mZ[o>>26],n.cellStyles&&(s.alc=i&7,s.fWrap=i>>3&1,s.alcV=i>>4&7,s.fJustLast=i>>7&1,s.trot=i>>8&255,s.cIndent=i>>16&15,s.fShrinkToFit=i>>20&1,s.iReadOrder=i>>22&2,s.fAtrNum=i>>26&1,s.fAtrFnt=i>>27&1,s.fAtrAlc=i>>28&1,s.fAtrBdr=i>>29&1,s.fAtrPat=i>>30&1,s.fAtrProt=i>>31&1,s.dgLeft=a&15,s.dgRight=a>>4&15,s.dgTop=a>>8&15,s.dgBottom=a>>12&15,s.icvLeft=a>>16&127,s.icvRight=a>>23&127,s.grbitDiag=a>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function xee(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=yee(t,e,n.fStyle,r),n}function Eee(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function hS(t,e,r){var n=Wa(t);(r.biff==2||e==9)&&++t.l;var s=MZ(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function _ee(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Wa(t),s=qn(t);return n.val=s,n}var pS=GZ;function bee(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,s];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var a=ul(t,i),o=[];n>t.l;)o.push(cf(t));return[i,s,a,o]}function mS(t,e,r){var n=t.read_shift(2),s,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=zZ(t,e-2,r)),i.body=s||t.read_shift(e-2),typeof s=="string"&&(i.Name=s),i}var See=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function gS(t,e,r){var n=t.l+e,s=t.read_shift(2),i=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var c=ul(t,a,r);s&32&&(c=See[c.charCodeAt(0)]);var u=n-t.l;r&&r.biff==2&&--u;var f=n==t.l||o===0||!(u>0)?[]:sse(t,u,r,o);return{chKey:i,Name:c,itab:l,rgce:f}}function Ck(t,e,r){if(r.biff<8)return Aee(t,e,r);for(var n=[],s=t.l+e,i=t.read_shift(r.biff>8?4:2);i--!==0;)n.push(WZ(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function Aee(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=lf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Tee(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),i=ul(t,n,r),a=ul(t,s,r);return[i,a]}function wee(t,e,r){var n=Tk(t);t.l++;var s=t.read_shift(1);return e-=8,[ase(t,e,r),s,n]}function vS(t,e,r){var n=KZ(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,rse(t,e,r)]}function Cee(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Iee(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=Tl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,a,i]}}function kee(t,e,r){return Iee(t,e,r)}function Dee(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Vp(t));return r}function Pee(t,e,r){if(r&&r.biff<8)return Fee(t,e,r);var n=wk(t),s=QZ(t,e-22,n[1]);return{cmo:n,ft:s}}var Ree={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function Fee(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),i=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((Ree[n]||rs)(t,e,r)),{cmo:[s,n,i],ft:a}}function Nee(t,e,r){var n=t.l,s="";try{t.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(i)==-1?t.l+=6:a=BZ(t,6,r);var o=t.read_shift(2);t.read_shift(2),rn(t,2);var l=t.read_shift(2);t.l+=l;for(var c=1;c<t.lens.length-1;++c){if(t.l-n!=t.lens[c])throw new Error("TxO: bad continue record");var u=t[t.l],f=ul(t,t.lens[c+1]-t.lens[c]-1);if(s+=f,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function Oee(t,e){var r=Vp(t);t.l+=16;var n=HZ(t,e-24);return[r,n]}function Mee(t,e){t.read_shift(2);var r=Vp(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(hs,""),[r,n]}function Lee(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=iS[r]||r,r=t.read_shift(2),e[1]=iS[r]||r,e}function Bee(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Sk(t));return r}function Uee(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(Sk(t));return r}function $ee(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function Ik(t,e,r){if(!r.cellStyles)return rs(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var c={s,e:i,w:a,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function Vee(t,e){var r={};return e<32||(t.l+=16,r.header=qn(t),r.footer=qn(t),t.l+=2),r}function Hee(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}var jee=Wa,Gee=_k,Wee=cf;function zee(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function Kee(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Wa(t);++t.l;var s=Tl(t,e-7,r);return n.t="str",n.val=s,n}function qee(t){var e=Wa(t);++t.l;var r=qn(t);return e.t="n",e.val=r,e}function Xee(t){var e=Wa(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function Yee(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function Qee(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function Jee(t,e,r){var n=t.l+e,s=Wa(t),i=t.read_shift(2),a=ul(t,i,r);return t.l=n,s.t="str",s.val=a,s}var Zee=[2,3,48,49,131,139,140,245],yS=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=ux({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=go(1);switch(l.type){case"base64":u=ca(Os(o));break;case"binary":u=ca(o);break;case"buffer":case"array":u=o;break}In(u,0);var f=u.read_shift(1),h=!!(f&136),p=!1,g=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var y=0,E=521;f==2&&(y=u.read_shift(2)),u.l+=3,f!=2&&(y=u.read_shift(4)),y>1048576&&(y=1e6),f!=2&&(E=u.read_shift(2));var b=u.read_shift(2),_=l.codepage||1252;f!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(_=t[u[u.l]]),u.l+=1,u.l+=2),g&&(u.l+=36);for(var v=[],A={},D=Math.min(u.length,f==2?521:E-10-(p?264:0)),k=g?32:11;u.l<D&&u[u.l]!=13;)switch(A={},A.name=Id.utils.decode(_,u.slice(u.l,u.l+k)).replace(/[\u0000\r\n].*$/g,""),u.l+=k,A.type=String.fromCharCode(u.read_shift(1)),f!=2&&!g&&(A.offset=u.read_shift(4)),A.len=u.read_shift(1),f==2&&(A.offset=u.read_shift(2)),A.dec=u.read_shift(1),A.name.length&&v.push(A),f!=2&&(u.l+=g?13:14),A.type){case"B":(!p||A.len!=8)&&l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(u[u.l]!==13&&(u.l=E-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=E;var T=0,x=0;for(c[0]=[],x=0;x!=v.length;++x)c[0][x]=v[x].name;for(;y-- >0;){if(u[u.l]===42){u.l+=b;continue}for(++u.l,c[++T]=[],x=0,x=0;x!=v.length;++x){var m=u.slice(u.l,u.l+v[x].len);u.l+=v[x].len,In(m,0);var S=Id.utils.decode(_,m);switch(v[x].type){case"C":S.trim().length&&(c[T][x]=S.replace(/\s+$/,""));break;case"D":S.length===8?c[T][x]=new Date(+S.slice(0,4),+S.slice(4,6)-1,+S.slice(6,8)):c[T][x]=S;break;case"F":c[T][x]=parseFloat(S.trim());break;case"+":case"I":c[T][x]=g?m.read_shift(-4,"i")^2147483648:m.read_shift(4,"i");break;case"L":switch(S.trim().toUpperCase()){case"Y":case"T":c[T][x]=!0;break;case"N":case"F":c[T][x]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+S+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));c[T][x]="##MEMO##"+(g?parseInt(S.trim(),10):m.read_shift(4));break;case"N":S=S.replace(/\u0000/g,"").trim(),S&&S!="."&&(c[T][x]=+S||0);break;case"@":c[T][x]=new Date(m.read_shift(-8,"f")-621356832e5);break;case"T":c[T][x]=new Date((m.read_shift(4)-2440588)*864e5+m.read_shift(4));break;case"Y":c[T][x]=m.read_shift(4,"i")/1e4+m.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[T][x]=-m.read_shift(-8,"f");break;case"B":if(p&&v[x].len==8){c[T][x]=m.read_shift(8,"f");break}case"G":case"P":m.l+=v[x].len;break;case"0":if(v[x].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[x].type)}}}if(f!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=v,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=Kc(r(o,c),c);return u["!cols"]=c.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete c.DBF,u}function s(o,l){try{return bo(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var c=l||{};if(+c.codepage>=0&&da(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Gv(),f=Zv(o,{header:1,raw:!0,cellDates:!0}),h=f[0],p=f.slice(1),g=o["!cols"]||[],y=0,E=0,b=0,_=1;for(y=0;y<h.length;++y){if(((g[y]||{}).DBF||{}).name){h[y]=g[y].DBF.name,++b;continue}if(h[y]!=null){if(++b,typeof h[y]=="number"&&(h[y]=h[y].toString(10)),typeof h[y]!="string")throw new Error("DBF Invalid column name "+h[y]+" |"+typeof h[y]+"|");if(h.indexOf(h[y])!==y){for(E=0;E<1024;++E)if(h.indexOf(h[y]+"_"+E)==-1){h[y]+="_"+E;break}}}}var v=Gr(o["!ref"]),A=[],D=[],k=[];for(y=0;y<=v.e.c-v.s.c;++y){var T="",x="",m=0,S=[];for(E=0;E<p.length;++E)p[E][y]!=null&&S.push(p[E][y]);if(S.length==0||h[y]==null){A[y]="?";continue}for(E=0;E<S.length;++E){switch(typeof S[E]){case"number":x="B";break;case"string":x="C";break;case"boolean":x="L";break;case"object":x=S[E]instanceof Date?"D":"C";break;default:x="C"}m=Math.max(m,String(S[E]).length),T=T&&T!=x?"C":x}m>250&&(m=250),x=((g[y]||{}).DBF||{}).type,x=="C"&&g[y].DBF.len>m&&(m=g[y].DBF.len),T=="B"&&x=="N"&&(T="N",k[y]=g[y].DBF.dec,m=g[y].DBF.len),D[y]=T=="C"||x=="N"?m:i[T]||0,_+=D[y],A[y]=T}var I=u.next(32);for(I.write_shift(4,318902576),I.write_shift(4,p.length),I.write_shift(2,296+32*b),I.write_shift(2,_),y=0;y<4;++y)I.write_shift(4,0);for(I.write_shift(4,0|(+e[CI]||3)<<8),y=0,E=0;y<h.length;++y)if(h[y]!=null){var C=u.next(32),F=(h[y].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,F,"sbcs"),C.write_shift(1,A[y]=="?"?"C":A[y],"sbcs"),C.write_shift(4,E),C.write_shift(1,D[y]||i[A[y]]||0),C.write_shift(1,k[y]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),E+=D[y]||i[A[y]]||0}var W=u.next(264);for(W.write_shift(4,13),y=0;y<65;++y)W.write_shift(4,0);for(y=0;y<p.length;++y){var P=u.next(_);for(P.write_shift(1,0),E=0;E<h.length;++E)if(h[E]!=null)switch(A[E]){case"L":P.write_shift(1,p[y][E]==null?63:p[y][E]?84:70);break;case"B":P.write_shift(8,p[y][E]||0,"f");break;case"N":var R="0";for(typeof p[y][E]=="number"&&(R=p[y][E].toFixed(k[E]||0)),b=0;b<D[E]-R.length;++b)P.write_shift(1,32);P.write_shift(1,R,"sbcs");break;case"D":p[y][E]?(P.write_shift(4,("0000"+p[y][E].getFullYear()).slice(-4),"sbcs"),P.write_shift(2,("00"+(p[y][E].getMonth()+1)).slice(-2),"sbcs"),P.write_shift(2,("00"+p[y][E].getDate()).slice(-2),"sbcs")):P.write_shift(8,"00000000","sbcs");break;case"C":var N=String(p[y][E]!=null?p[y][E]:"").slice(0,D[E]);for(P.write_shift(1,N,"sbcs"),b=0;b<D[E]-N.length;++b)P.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:a}}(),ete=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Va(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var g=t[p];return typeof g=="number"?Nb(g):g},n=function(h,p,g){var y=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return y==59?h:Nb(y)};t["|"]=254;function s(h,p){switch(p.type){case"base64":return i(Os(h),p);case"binary":return i(h,p);case"buffer":return i(er&&Buffer.isBuffer(h)?h.toString("binary"):_l(h),p);case"array":return i(cl(h),p)}throw new Error("Unrecognized type "+p.type)}function i(h,p){var g=h.split(/[\n\r]+/),y=-1,E=-1,b=0,_=0,v=[],A=[],D=null,k={},T=[],x=[],m=[],S=0,I;for(+p.codepage>=0&&da(+p.codepage);b!==g.length;++b){S=0;var C=g[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=C.replace(/;;/g,"\0").split(";").map(function(te){return te.replace(/\u0000/g,";")}),W=F[0],P;if(C.length>0)switch(W){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&A.push(C.slice(3).replace(/;;/g,";"));break;case"C":var R=!1,N=!1,M=!1,O=!1,G=-1,z=-1;for(_=1;_<F.length;++_)switch(F[_].charAt(0)){case"A":break;case"X":E=parseInt(F[_].slice(1))-1,N=!0;break;case"Y":for(y=parseInt(F[_].slice(1))-1,N||(E=0),I=v.length;I<=y;++I)v[I]=[];break;case"K":P=F[_].slice(1),P.charAt(0)==='"'?P=P.slice(1,P.length-1):P==="TRUE"?P=!0:P==="FALSE"?P=!1:isNaN(ma(P))?isNaN(Rc(P).getDate())||(P=En(P)):(P=ma(P),D!==null&&Wc(D)&&(P=$p(P))),R=!0;break;case"E":O=!0;var j=mc(F[_].slice(1),{r:y,c:E});v[y][E]=[v[y][E],j];break;case"S":M=!0,v[y][E]=[v[y][E],"S5S"];break;case"G":break;case"R":G=parseInt(F[_].slice(1))-1;break;case"C":z=parseInt(F[_].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}if(R&&(v[y][E]&&v[y][E].length==2?v[y][E][0]=P:v[y][E]=P,D=null),M){if(O)throw new Error("SYLK shared formula cannot have own formula");var H=G>-1&&v[G][z];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");v[y][E][1]=Bk(H[1],{r:y-G,c:E-z})}break;case"F":var V=0;for(_=1;_<F.length;++_)switch(F[_].charAt(0)){case"X":E=parseInt(F[_].slice(1))-1,++V;break;case"Y":for(y=parseInt(F[_].slice(1))-1,I=v.length;I<=y;++I)v[I]=[];break;case"M":S=parseInt(F[_].slice(1))/20;break;case"F":break;case"G":break;case"P":D=A[parseInt(F[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(m=F[_].slice(1).split(" "),I=parseInt(m[0],10);I<=parseInt(m[1],10);++I)S=parseInt(m[2],10),x[I-1]=S===0?{hidden:!0}:{wch:S},Fc(x[I-1]);break;case"C":E=parseInt(F[_].slice(1))-1,x[E]||(x[E]={});break;case"R":y=parseInt(F[_].slice(1))-1,T[y]||(T[y]={}),S>0?(T[y].hpt=S,T[y].hpx=Nd(S)):S===0&&(T[y].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}V<1&&(D=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}}return T.length>0&&(k["!rows"]=T),x.length>0&&(k["!cols"]=x),p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),[v,k]}function a(h,p){var g=s(h,p),y=g[0],E=g[1],b=Kc(y,p);return Va(E).forEach(function(_){b[_]=E[_]}),b}function o(h,p){return bo(a(h,p),p)}function l(h,p,g,y){var E="C;Y"+(g+1)+";X"+(y+1)+";K";switch(h.t){case"n":E+=h.v||0,h.f&&!h.F&&(E+=";E"+$re(h.f,{r:g,c:y}));break;case"b":E+=h.v?"TRUE":"FALSE";break;case"e":E+=h.w||h.v;break;case"d":E+='"'+(h.w||h.v)+'"';break;case"s":E+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function c(h,p){p.forEach(function(g,y){var E="F;W"+(y+1)+" "+(y+1)+" ";g.hidden?E+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Dh(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Ph(g.wpx)),typeof g.wch=="number"&&(E+=Math.round(g.wch))),E.charAt(E.length-1)!=" "&&h.push(E)})}function u(h,p){p.forEach(function(g,y){var E="F;";g.hidden?E+="M0;":g.hpt?E+="M"+20*g.hpt+";":g.hpx&&(E+="M"+20*Ok(g.hpx)+";"),E.length>2&&h.push(E+"R"+(y+1))})}function f(h,p){var g=["ID;PWXL;N;E"],y=[],E=Gr(h["!ref"]),b,_=Array.isArray(h),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&c(g,h["!cols"]),h["!rows"]&&u(g,h["!rows"]),g.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var A=E.s.r;A<=E.e.r;++A)for(var D=E.s.c;D<=E.e.c;++D){var k=Mt({r:A,c:D});b=_?(h[A]||[])[D]:h[k],!(!b||b.v==null&&(!b.f||b.F))&&y.push(l(b,h,A,D))}return g.join(v)+v+y.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),tte=function(){function t(i,a){switch(a.type){case"base64":return e(Os(i),a);case"binary":return e(i,a);case"buffer":return e(er&&Buffer.isBuffer(i)?i.toString("binary"):_l(i),a);case"array":return e(cl(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){for(var o=i.split(`
`),l=-1,c=-1,u=0,f=[];u!==o.length;++u){if(o[u].trim()==="BOT"){f[++l]=[],c=0;continue}if(!(l<0)){var h=o[u].trim().split(","),p=h[0],g=h[1];++u;for(var y=o[u]||"";(y.match(/["]/g)||[]).length&1&&u<o.length-1;)y+=`
`+o[++u];switch(y=y.trim(),+p){case-1:if(y==="BOT"){f[++l]=[],c=0;continue}else if(y!=="EOD")throw new Error("Unrecognized DIF special command "+y);break;case 0:y==="TRUE"?f[l][c]=!0:y==="FALSE"?f[l][c]=!1:isNaN(ma(g))?isNaN(Rc(g).getDate())?f[l][c]=g:f[l][c]=En(g):f[l][c]=ma(g),++c;break;case 1:y=y.slice(1,y.length-1),y=y.replace(/""/g,'"'),y&&y.match(/^=".*"$/)&&(y=y.slice(2,-1)),f[l][c++]=y!==""?y:null;break}if(y==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(i,a){return Kc(t(i,a),a)}function n(i,a){return bo(r(i,a),a)}var s=function(){var i=function(l,c,u,f,h){l.push(c),l.push(u+","+f),l.push('"'+h.replace(/"/g,'""')+'"')},a=function(l,c,u,f){l.push(c+","+u),l.push(c==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var c=[],u=Gr(l["!ref"]),f,h=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,u.e.r-u.s.r+1,""),i(c,"TUPLES",0,u.e.c-u.s.c+1,""),i(c,"DATA",0,0,"");for(var p=u.s.r;p<=u.e.r;++p){a(c,-1,0,"BOT");for(var g=u.s.c;g<=u.e.c;++g){var y=Mt({r:p,c:g});if(f=h?(l[p]||[])[g]:l[y],!f){a(c,1,0,"");continue}switch(f.t){case"n":var E=f.w;!E&&f.v!=null&&(E=f.v),E==null?f.f&&!f.F?a(c,1,0,"="+f.f):a(c,1,0,""):a(c,0,E,"V");break;case"b":a(c,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(c,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Ks(f.z||Ut[14],ps(En(f.v)))),a(c,0,f.w,"V");break;default:a(c,1,0,"")}}}a(c,-1,0,"EOD");var b=`\r
`,_=c.join(b);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),rte=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var p=f.split(`
`),g=-1,y=-1,E=0,b=[];E!==p.length;++E){var _=p[E].trim().split(":");if(_[0]==="cell"){var v=ds(_[1]);if(b.length<=v.r)for(g=b.length;g<=v.r;++g)b[g]||(b[g]=[]);switch(g=v.r,y=v.c,_[2]){case"t":b[g][y]=t(_[3]);break;case"v":b[g][y]=+_[3];break;case"vtf":var A=_[_.length-1];case"vtc":switch(_[3]){case"nl":b[g][y]=!!+_[4];break;default:b[g][y]=+_[4];break}_[2]=="vtf"&&(b[g][y]=[b[g][y],A])}}}return h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),b}function n(f,h){return Kc(r(f,h),h)}function s(f,h){return bo(n(f,h),h)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(f){if(!f||!f["!ref"])return"";for(var h=[],p=[],g,y="",E=zc(f["!ref"]),b=Array.isArray(f),_=E.s.r;_<=E.e.r;++_)for(var v=E.s.c;v<=E.e.c;++v)if(y=Mt({r:_,c:v}),g=b?(f[_]||[])[v]:f[y],!(!g||g.v==null||g.t==="z")){switch(p=["cell",y,"t"],g.t){case"s":case"str":p.push(e(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=e(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=e(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var A=ps(En(g.v));p[2]="vtc",p[3]="nd",p[4]=""+A,p[5]=g.w||Ks(g.z||Ut[14],A);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function u(f){return[i,a,o,a,c(f),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),Rd=function(){function t(u,f,h,p,g){g.raw?f[h][p]=u:u===""||(u==="TRUE"?f[h][p]=!0:u==="FALSE"?f[h][p]=!1:isNaN(ma(u))?isNaN(Rc(u).getDate())?f[h][p]=u:f[h][p]=En(u):f[h][p]=ma(u))}function e(u,f){var h=f||{},p=[];if(!u||u.length===0)return p;for(var g=u.split(/[\r\n]/),y=g.length-1;y>=0&&g[y].length===0;)--y;for(var E=10,b=0,_=0;_<=y;++_)b=g[_].indexOf(" "),b==-1?b=g[_].length:b++,E=Math.max(E,b);for(_=0;_<=y;++_){p[_]=[];var v=0;for(t(g[_].slice(0,E).trim(),p,_,v,h),v=1;v<=(g[_].length-E)/10+1;++v)t(g[_].slice(E+(v-1)*10,E+v*10).trim(),p,_,v,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var f={},h=!1,p=0,g=0;p<u.length;++p)(g=u.charCodeAt(p))==34?h=!h:!h&&g in r&&(f[g]=(f[g]||0)+1);g=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p]);if(!g.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&g.push([f[p],p])}return g.sort(function(y,E){return y[0]-E[0]||n[y[1]]-n[E[1]]}),r[g.pop()[1]]||44}function i(u,f){var h=f||{},p="",g=h.dense?[]:{},y={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(p=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(p=u.charAt(4),u=u.slice(6)):p=s(u.slice(0,1024)):h&&h.FS?p=h.FS:p=s(u.slice(0,1024));var E=0,b=0,_=0,v=0,A=0,D=p.charCodeAt(0),k=!1,T=0,x=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var m=h.dateNF!=null?hJ(h.dateNF):null;function S(){var I=u.slice(v,A),C={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)C.t="z";else if(h.raw)C.t="s",C.v=I;else if(I.trim().length===0)C.t="s",C.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(C.t="s",C.v=I.slice(2,-1).replace(/""/g,'"')):Hre(I)?(C.t="n",C.f=I.slice(1)):(C.t="s",C.v=I);else if(I=="TRUE")C.t="b",C.v=!0;else if(I=="FALSE")C.t="b",C.v=!1;else if(!isNaN(_=ma(I)))C.t="n",h.cellText!==!1&&(C.w=I),C.v=_;else if(!isNaN(Rc(I).getDate())||m&&I.match(m)){C.z=h.dateNF||Ut[14];var F=0;m&&I.match(m)&&(I=pJ(I,h.dateNF,I.match(m)||[]),F=1),h.cellDates?(C.t="d",C.v=En(I,F)):(C.t="n",C.v=ps(En(I,F))),h.cellText!==!1&&(C.w=Ks(C.z,C.v instanceof Date?ps(C.v):C.v)),h.cellNF||delete C.z}else C.t="s",C.v=I;if(C.t=="z"||(h.dense?(g[E]||(g[E]=[]),g[E][b]=C):g[Mt({c:b,r:E})]=C),v=A+1,x=u.charCodeAt(v),y.e.c<b&&(y.e.c=b),y.e.r<E&&(y.e.r=E),T==D)++b;else if(b=0,++E,h.sheetRows&&h.sheetRows<=E)return!0}e:for(;A<u.length;++A)switch(T=u.charCodeAt(A)){case 34:x===34&&(k=!k);break;case D:case 10:case 13:if(!k&&S())break e;break}return A-v>0&&S(),g["!ref"]=ar(y),g}function a(u,f){return!(f&&f.PRN)||f.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?i(u,f):Kc(e(u,f),f)}function o(u,f){var h="",p=f.type=="string"?[0,0,0,0]:kx(u,f);switch(f.type){case"base64":h=Os(u);break;case"binary":h=u;break;case"buffer":f.codepage==65001?h=u.toString("utf8"):f.codepage&&typeof Id<"u"||(h=er&&Buffer.isBuffer(u)?u.toString("binary"):_l(u));break;case"array":h=cl(u);break;case"string":h=u;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Ar(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=Ar(h):f.type=="binary"&&typeof Id<"u",h.slice(0,19)=="socialcalc:version:"?rte.to_sheet(f.type=="string"?h:Ar(h),f):a(h,f)}function l(u,f){return bo(o(u,f),f)}function c(u){for(var f=[],h=Gr(u["!ref"]),p,g=Array.isArray(u),y=h.s.r;y<=h.e.r;++y){for(var E=[],b=h.s.c;b<=h.e.c;++b){var _=Mt({r:y,c:b});if(p=g?(u[y]||[])[b]:u[_],!p||p.v==null){E.push("          ");continue}for(var v=(p.w||(Ci(p),p.w)||"").slice(0,10);v.length<10;)v+=" ";E.push(v+(b===0?" ":""))}f.push(E.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function nte(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=ete.to_workbook(t,r);return r.WTF=n,s}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Rd.to_workbook(t,e)}}var Zu=function(){function t(j,H,V){if(j){In(j,j.l||0);for(var te=V.Enum||G;j.l<j.length;){var oe=j.read_shift(2),ne=te[oe]||te[65535],le=j.read_shift(2),J=j.l+le,Q=ne.f&&ne.f(j,le,V);if(j.l=J,H(Q,ne,oe))return}}}function e(j,H){switch(H.type){case"base64":return r(ca(Os(j)),H);case"binary":return r(ca(j),H);case"buffer":case"array":return r(j,H)}throw"Unsupported type "+H.type}function r(j,H){if(!j)return j;var V=H||{},te=V.dense?[]:{},oe="Sheet1",ne="",le=0,J={},Q=[],ve=[],ee={s:{r:0,c:0},e:{r:0,c:0}},K=V.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)V.Enum=G,t(j,function(ae,de,Ee){switch(Ee){case 0:V.vers=ae,ae>=4096&&(V.qpro=!0);break;case 6:ee=ae;break;case 204:ae&&(ne=ae);break;case 222:ne=ae;break;case 15:case 51:V.qpro||(ae[1].v=ae[1].v.slice(1));case 13:case 14:case 16:Ee==14&&(ae[2]&112)==112&&(ae[2]&15)>1&&(ae[2]&15)<15&&(ae[1].z=V.dateNF||Ut[14],V.cellDates&&(ae[1].t="d",ae[1].v=$p(ae[1].v))),V.qpro&&ae[3]>le&&(te["!ref"]=ar(ee),J[oe]=te,Q.push(oe),te=V.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},le=ae[3],oe=ne||"Sheet"+(le+1),ne="");var he=V.dense?(te[ae[0].r]||[])[ae[0].c]:te[Mt(ae[0])];if(he){he.t=ae[1].t,he.v=ae[1].v,ae[1].z!=null&&(he.z=ae[1].z),ae[1].f!=null&&(he.f=ae[1].f);break}V.dense?(te[ae[0].r]||(te[ae[0].r]=[]),te[ae[0].r][ae[0].c]=ae[1]):te[Mt(ae[0])]=ae[1];break}},V);else if(j[2]==26||j[2]==14)V.Enum=z,j[2]==14&&(V.qpro=!0,j.l=0),t(j,function(ae,de,Ee){switch(Ee){case 204:oe=ae;break;case 22:ae[1].v=ae[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ae[3]>le&&(te["!ref"]=ar(ee),J[oe]=te,Q.push(oe),te=V.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},le=ae[3],oe="Sheet"+(le+1)),K>0&&ae[0].r>=K)break;V.dense?(te[ae[0].r]||(te[ae[0].r]=[]),te[ae[0].r][ae[0].c]=ae[1]):te[Mt(ae[0])]=ae[1],ee.e.c<ae[0].c&&(ee.e.c=ae[0].c),ee.e.r<ae[0].r&&(ee.e.r=ae[0].r);break;case 27:ae[14e3]&&(ve[ae[14e3][0]]=ae[14e3][1]);break;case 1537:ve[ae[0]]=ae[1],ae[0]==le&&(oe=ae[1]);break}},V);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(te["!ref"]=ar(ee),J[ne||oe]=te,Q.push(ne||oe),!ve.length)return{SheetNames:Q,Sheets:J};for(var Y={},pe=[],xe=0;xe<ve.length;++xe)J[Q[xe]]?(pe.push(ve[xe]||Q[xe]),Y[ve[xe]]=J[ve[xe]]||J[Q[xe]]):(pe.push(ve[xe]),Y[ve[xe]]={"!ref":"A1"});return{SheetNames:pe,Sheets:Y}}function n(j,H){var V=H||{};if(+V.codepage>=0&&da(+V.codepage),V.type=="string")throw new Error("Cannot write WK1 to JS string");var te=Gv(),oe=Gr(j["!ref"]),ne=Array.isArray(j),le=[];ra(te,0,i(1030)),ra(te,6,l(oe));for(var J=Math.min(oe.e.r,8191),Q=oe.s.r;Q<=J;++Q)for(var ve=Mn(Q),ee=oe.s.c;ee<=oe.e.c;++ee){Q===oe.s.r&&(le[ee]=hn(ee));var K=le[ee]+ve,Y=ne?(j[Q]||[])[ee]:j[K];if(!(!Y||Y.t=="z"))if(Y.t=="n")(Y.v|0)==Y.v&&Y.v>=-32768&&Y.v<=32767?ra(te,13,p(Q,ee,Y.v)):ra(te,14,y(Q,ee,Y.v));else{var pe=Ci(Y);ra(te,15,f(Q,ee,pe.slice(0,239)))}}return ra(te,1),te.end()}function s(j,H){var V=H||{};if(+V.codepage>=0&&da(+V.codepage),V.type=="string")throw new Error("Cannot write WK3 to JS string");var te=Gv();ra(te,0,a(j));for(var oe=0,ne=0;oe<j.SheetNames.length;++oe)(j.Sheets[j.SheetNames[oe]]||{})["!ref"]&&ra(te,27,O(j.SheetNames[oe],ne++));var le=0;for(oe=0;oe<j.SheetNames.length;++oe){var J=j.Sheets[j.SheetNames[oe]];if(!(!J||!J["!ref"])){for(var Q=Gr(J["!ref"]),ve=Array.isArray(J),ee=[],K=Math.min(Q.e.r,8191),Y=Q.s.r;Y<=K;++Y)for(var pe=Mn(Y),xe=Q.s.c;xe<=Q.e.c;++xe){Y===Q.s.r&&(ee[xe]=hn(xe));var ae=ee[xe]+pe,de=ve?(J[Y]||[])[xe]:J[ae];if(!(!de||de.t=="z"))if(de.t=="n")ra(te,23,S(Y,xe,le,de.v));else{var Ee=Ci(de);ra(te,22,T(Y,xe,le,Ee.slice(0,239)))}}++le}}return ra(te,1),te.end()}function i(j){var H=un(2);return H.write_shift(2,j),H}function a(j){var H=un(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var V=0,te=0,oe=0,ne=0;ne<j.SheetNames.length;++ne){var le=j.SheetNames[ne],J=j.Sheets[le];if(!(!J||!J["!ref"])){++oe;var Q=zc(J["!ref"]);V<Q.e.r&&(V=Q.e.r),te<Q.e.c&&(te=Q.e.c)}}return V>8191&&(V=8191),H.write_shift(2,V),H.write_shift(1,oe),H.write_shift(1,te),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(j,H,V){var te={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&V.qpro?(te.s.c=j.read_shift(1),j.l++,te.s.r=j.read_shift(2),te.e.c=j.read_shift(1),j.l++,te.e.r=j.read_shift(2),te):(te.s.c=j.read_shift(2),te.s.r=j.read_shift(2),H==12&&V.qpro&&(j.l+=2),te.e.c=j.read_shift(2),te.e.r=j.read_shift(2),H==12&&V.qpro&&(j.l+=2),te.s.c==65535&&(te.s.c=te.e.c=te.s.r=te.e.r=0),te)}function l(j){var H=un(8);return H.write_shift(2,j.s.c),H.write_shift(2,j.s.r),H.write_shift(2,j.e.c),H.write_shift(2,j.e.r),H}function c(j,H,V){var te=[{c:0,r:0},{t:"n",v:0},0,0];return V.qpro&&V.vers!=20768?(te[0].c=j.read_shift(1),te[3]=j.read_shift(1),te[0].r=j.read_shift(2),j.l+=2):(te[2]=j.read_shift(1),te[0].c=j.read_shift(2),te[0].r=j.read_shift(2)),te}function u(j,H,V){var te=j.l+H,oe=c(j,H,V);if(oe[1].t="s",V.vers==20768){j.l++;var ne=j.read_shift(1);return oe[1].v=j.read_shift(ne,"utf8"),oe}return V.qpro&&j.l++,oe[1].v=j.read_shift(te-j.l,"cstr"),oe}function f(j,H,V){var te=un(7+V.length);te.write_shift(1,255),te.write_shift(2,H),te.write_shift(2,j),te.write_shift(1,39);for(var oe=0;oe<te.length;++oe){var ne=V.charCodeAt(oe);te.write_shift(1,ne>=128?95:ne)}return te.write_shift(1,0),te}function h(j,H,V){var te=c(j,H,V);return te[1].v=j.read_shift(2,"i"),te}function p(j,H,V){var te=un(7);return te.write_shift(1,255),te.write_shift(2,H),te.write_shift(2,j),te.write_shift(2,V,"i"),te}function g(j,H,V){var te=c(j,H,V);return te[1].v=j.read_shift(8,"f"),te}function y(j,H,V){var te=un(13);return te.write_shift(1,255),te.write_shift(2,H),te.write_shift(2,j),te.write_shift(8,V,"f"),te}function E(j,H,V){var te=j.l+H,oe=c(j,H,V);if(oe[1].v=j.read_shift(8,"f"),V.qpro)j.l=te;else{var ne=j.read_shift(2);A(j.slice(j.l,j.l+ne),oe),j.l+=ne}return oe}function b(j,H,V){var te=H&32768;return H&=-32769,H=(te?j:0)+(H>=8192?H-16384:H),(te?"":"$")+(V?hn(H):Mn(H))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(j,H){In(j,0);for(var V=[],te=0,oe="",ne="",le="",J="";j.l<j.length;){var Q=j[j.l++];switch(Q){case 0:V.push(j.read_shift(8,"f"));break;case 1:ne=b(H[0].c,j.read_shift(2),!0),oe=b(H[0].r,j.read_shift(2),!1),V.push(ne+oe);break;case 2:{var ve=b(H[0].c,j.read_shift(2),!0),ee=b(H[0].r,j.read_shift(2),!1);ne=b(H[0].c,j.read_shift(2),!0),oe=b(H[0].r,j.read_shift(2),!1),V.push(ve+ee+":"+ne+oe)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:V.push("("+V.pop()+")");break;case 5:V.push(j.read_shift(2));break;case 6:{for(var K="";Q=j[j.l++];)K+=String.fromCharCode(Q);V.push('"'+K.replace(/"/g,'""')+'"')}break;case 8:V.push("-"+V.pop());break;case 23:V.push("+"+V.pop());break;case 22:V.push("NOT("+V.pop()+")");break;case 20:case 21:J=V.pop(),le=V.pop(),V.push(["AND","OR"][Q-20]+"("+le+","+J+")");break;default:if(Q<32&&v[Q])J=V.pop(),le=V.pop(),V.push(le+v[Q]+J);else if(_[Q]){if(te=_[Q][1],te==69&&(te=j[j.l++]),te>V.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+V.join("|")+"|");return}var Y=V.slice(-te);V.length-=te,V.push(_[Q][0]+"("+Y.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}V.length==1?H[1].f=""+V[0]:console.error("WK1 bad formula parse |"+V.join("|")+"|")}function D(j){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=j.read_shift(2),H[3]=j[j.l++],H[0].c=j[j.l++],H}function k(j,H){var V=D(j);return V[1].t="s",V[1].v=j.read_shift(H-4,"cstr"),V}function T(j,H,V,te){var oe=un(6+te.length);oe.write_shift(2,j),oe.write_shift(1,V),oe.write_shift(1,H),oe.write_shift(1,39);for(var ne=0;ne<te.length;++ne){var le=te.charCodeAt(ne);oe.write_shift(1,le>=128?95:le)}return oe.write_shift(1,0),oe}function x(j,H){var V=D(j);V[1].v=j.read_shift(2);var te=V[1].v>>1;if(V[1].v&1)switch(te&7){case 0:te=(te>>3)*5e3;break;case 1:te=(te>>3)*500;break;case 2:te=(te>>3)/20;break;case 3:te=(te>>3)/200;break;case 4:te=(te>>3)/2e3;break;case 5:te=(te>>3)/2e4;break;case 6:te=(te>>3)/16;break;case 7:te=(te>>3)/64;break}return V[1].v=te,V}function m(j,H){var V=D(j),te=j.read_shift(4),oe=j.read_shift(4),ne=j.read_shift(2);if(ne==65535)return te===0&&oe===3221225472?(V[1].t="e",V[1].v=15):te===0&&oe===3489660928?(V[1].t="e",V[1].v=42):V[1].v=0,V;var le=ne&32768;return ne=(ne&32767)-16446,V[1].v=(1-le*2)*(oe*Math.pow(2,ne+32)+te*Math.pow(2,ne)),V}function S(j,H,V,te){var oe=un(14);if(oe.write_shift(2,j),oe.write_shift(1,V),oe.write_shift(1,H),te==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var ne=0,le=0,J=0,Q=0;return te<0&&(ne=1,te=-te),le=Math.log2(te)|0,te/=Math.pow(2,le-31),Q=te>>>0,Q&2147483648||(te/=2,++le,Q=te>>>0),te-=Q,Q|=2147483648,Q>>>=0,te*=Math.pow(2,32),J=te>>>0,oe.write_shift(4,J),oe.write_shift(4,Q),le+=16383+(ne?32768:0),oe.write_shift(2,le),oe}function I(j,H){var V=m(j);return j.l+=H-14,V}function C(j,H){var V=D(j),te=j.read_shift(4);return V[1].v=te>>6,V}function F(j,H){var V=D(j),te=j.read_shift(8,"f");return V[1].v=te,V}function W(j,H){var V=F(j);return j.l+=H-10,V}function P(j,H){return j[j.l+H-1]==0?j.read_shift(H,"cstr"):""}function R(j,H){var V=j[j.l++];V>H-1&&(V=H-1);for(var te="";te.length<V;)te+=String.fromCharCode(j[j.l++]);return te}function N(j,H,V){if(!(!V.qpro||H<21)){var te=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var oe=j.read_shift(H-21,"cstr");return[te,oe]}}function M(j,H){for(var V={},te=j.l+H;j.l<te;){var oe=j.read_shift(2);if(oe==14e3){for(V[oe]=[0,""],V[oe][0]=j.read_shift(2);j[j.l];)V[oe][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return V}function O(j,H){var V=un(5+j.length);V.write_shift(2,14e3),V.write_shift(2,H);for(var te=0;te<j.length;++te){var oe=j.charCodeAt(te);V[V.l++]=oe>127?95:oe}return V[V.l++]=0,V}var G={0:{n:"BOF",f:rn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:P},222:{n:"SHEETNAMELP",f:R},65535:{n:""}},z={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:m},24:{n:"NUMBER18",f:x},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:M},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:W},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:P},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:N},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function ste(t){var e={},r=t.match(ns),n=0,s=!1;if(r)for(;n!=r.length;++n){var i=It(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;e.cp=ax[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=i.val;break;case"<sz":e.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":i.rgb&&(e.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(i[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+i[0])}}return e}var ate=function(){var t=Dd("t"),e=Dd("rPr");function r(i){var a=i.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:ir(a[1])},l=i.match(e);return l&&(o.s=ste(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),ite=function(){var e=/(\r\n|\n)/g;function r(s,i,a){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),i.push('<span style="'+o.join("")+'">'),s.b&&(i.push("<b>"),a.push("</b>")),s.i&&(i.push("<i>"),a.push("</i>")),s.strike&&(i.push("<s>"),a.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(i.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),s}function n(s){var i=[[],s.v,[]];return s.v?(s.s&&r(s.s,i[0],i[2]),i[0].join("")+i[1].replace(e,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}}(),ote=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,lte=/<(?:\w+:)?r>/,cte=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function bx(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ir(Ar(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ar(t),r&&(n.h=fx(n.t))):t.match(lte)&&(n.r=Ar(t),n.t=ir(Ar((t.replace(cte,"").match(ote)||[]).join("").replace(ns,""))),r&&(n.h=ite(ate(n.r)))),n):{t:""}}var ute=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,dte=/<(?:\w+:)?(?:si|sstItem)>/g,fte=/<\/(?:\w+:)?(?:si|sstItem)>/;function hte(t,e){var r=[],n="";if(!t)return r;var s=t.match(ute);if(s){n=s[2].replace(dte,"").split(fte);for(var i=0;i!=n.length;++i){var a=bx(n[i].trim(),e);a!=null&&(r[r.length]=a)}s=It(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function pte(t){return[t.read_shift(4),t.read_shift(4)]}function mte(t,e){var r=[],n=!1;return Pi(t,function(i,a,o){switch(o){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function kk(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function mi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function gte(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=mi(t,4),e.U=mi(t,4),e.W=mi(t,4),e}function vte(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),i=[];s-- >0;)i.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=i,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function yte(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(vte(t));return e}function xte(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Ete(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=mi(t,4),e.U=mi(t,4),e.W=mi(t,4),e}function _te(t){var e=Ete(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function Dk(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function Pk(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function bte(t){var e=mi(t);switch(e.Minor){case 2:return[e.Minor,Ste(t)];case 3:return[e.Minor,Ate()];case 4:return[e.Minor,Tte(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Ste(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=Dk(t,r),s=Pk(t,t.length-t.l);return{t:"Std",h:n,v:s}}function Ate(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Tte(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ns,function(i){var a=It(i);switch(Ga(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function wte(t,e){var r={},n=r.EncryptionVersionInfo=mi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=Dk(t,s),e-=s,r.EncryptionVerifier=Pk(t,e),r}function Cte(t){var e={},r=e.EncryptionVersionInfo=mi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Ite(t){var e=0,r,n=kk(t),s=n.length+1,i,a,o,l,c;for(r=go(s),r[0]=n.length,i=1;i!=s;++i)r[i]=n[i-1];for(i=s-1;i>=0;--i)a=r[i],o=e&16384?1:0,l=e<<1&32767,c=o|l,e=c^a;return e^52811}var Rk=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},s=function(a,o){return n(a^o)},i=function(a){for(var o=e[a.length-1],l=104,c=a.length-1;c>=0;--c)for(var u=a[c],f=0;f!=7;++f)u&64&&(o^=r[l]),u*=2,--l;return o};return function(a){for(var o=kk(a),l=i(o),c=o.length,u=go(16),f=0;f!=16;++f)u[f]=0;var h,p,g;for((c&1)===1&&(h=l>>8,u[c]=s(t[0],h),--c,h=l&255,p=o[o.length-1],u[c]=s(p,h));c>0;)--c,h=l>>8,u[c]=s(o[c],h),--c,h=l&255,u[c]=s(o[c],h);for(c=15,g=15-o.length;g>0;)h=l>>8,u[c]=s(t[g],h),--c,--g,h=l&255,u[c]=s(o[c],h),--c,--g;return u}}(),kte=function(t,e,r,n,s){s||(s=e),n||(n=Rk(t));var i,a;for(i=0;i!=e.length;++i)a=e[i],a^=n[r],a=(a>>5|a<<3)&255,s[i]=a,++r;return[s,r,n]},Dte=function(t){var e=0,r=Rk(t);return function(n){var s=kte("",n,e,r);return e=s[1],s[0]}};function Pte(t,e,r,n){var s={key:rn(t),verificationBytes:rn(t)};return r.password&&(s.verifier=Ite(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Dte(r.password)),s}function Rte(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Cte(t):n.Data=wte(t,e),n}function Fte(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Rte(t,e-2,n):Pte(t,r.biff>=8?e:e-2,r,n),n}var Nte=function(){function t(s,i){switch(i.type){case"base64":return e(Os(s),i);case"binary":return e(s,i);case"buffer":return e(er&&Buffer.isBuffer(s)?s.toString("binary"):_l(s),i);case"array":return e(cl(s),i)}throw new Error("Unrecognized type "+i.type)}function e(s,i){var a=i||{},o=a.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,p=0,g,y=-1;g=h.exec(u);){switch(g[0]){case"\\cell":var E=u.slice(p,h.lastIndex-g[0].length);if(E[0]==" "&&(E=E.slice(1)),++y,E.length){var b={v:E,t:"s"};Array.isArray(o)?o[f][y]=b:o[Mt({r:f,c:y})]=b}break}p=h.lastIndex}y>c.e.c&&(c.e.c=y)}),o["!ref"]=ar(c),o}function r(s,i){return bo(t(s,i),i)}function n(s){for(var i=["{\\rtf1\\ansi"],a=Gr(s["!ref"]),o,l=Array.isArray(s),c=a.s.r;c<=a.e.r;++c){i.push("\\trowd\\trautofit1");for(var u=a.s.c;u<=a.e.c;++u)i.push("\\cellx"+(u+1));for(i.push("\\pard\\intbl"),u=a.s.c;u<=a.e.c;++u){var f=Mt({r:c,c:u});o=l?(s[c]||[])[u]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Ci(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Ote(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Fd(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Mte(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),i=Math.min(e,r,n),a=s-i;if(a===0)return[0,0,e];var o=0,l=0,c=s+i;switch(l=a/(c>1?2-c:c),s){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,l,c/2]}function Lte(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),i=n-s/2,a=[i,i,i],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,a[0]+=s,a[1]+=l;break;case 1:l=s*(2-o),a[0]+=l,a[1]+=s;break;case 2:l=s*(o-2),a[1]+=s,a[2]+=l;break;case 3:l=s*(4-o),a[1]+=l,a[2]+=s;break;case 4:l=s*(o-4),a[2]+=s,a[0]+=l;break;case 5:l=s*(6-o),a[2]+=l,a[0]+=s;break}for(var c=0;c!=3;++c)a[c]=Math.round(a[c]*255);return a}function kh(t,e){if(e===0)return t;var r=Mte(Ote(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Fd(Lte(r))}var Fk=6,Bte=15,Ute=1,us=Fk;function Dh(t){return Math.floor((t+Math.round(128/us)/256)*us)}function Ph(t){return Math.floor((t-5)/us*100+.5)/100}function qv(t){return Math.round((t*us+5)/us*256)/256}function xg(t){return qv(Ph(Dh(t)))}function Sx(t){var e=Math.abs(t-xg(t)),r=us;if(e>.005)for(us=Ute;us<Bte;++us)Math.abs(t-xg(t))<=e&&(e=Math.abs(t-xg(t)),r=us);us=r}function Fc(t){t.width?(t.wpx=Dh(t.width),t.wch=Ph(t.wpx),t.MDW=us):t.wpx?(t.wch=Ph(t.wpx),t.width=qv(t.wch),t.MDW=us):typeof t.wch=="number"&&(t.width=qv(t.wch),t.wpx=Dh(t.width),t.MDW=us),t.customWidth&&delete t.customWidth}var $te=96,Nk=$te;function Ok(t){return t*96/Nk}function Nd(t){return t*Nk/96}var Vte={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Hte(t,e,r,n){e.Borders=[];var s={},i=!1;(t[0].match(ns)||[]).forEach(function(a){var o=It(a);switch(Ga(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Dr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Dr(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in borders")}})}function jte(t,e,r,n){e.Fills=[];var s={},i=!1;(t[0].match(ns)||[]).forEach(function(a){var o=It(a);switch(Ga(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fills")}})}function Gte(t,e,r,n){e.Fonts=[];var s={},i=!1;(t[0].match(ns)||[]).forEach(function(a){var o=It(a);switch(Ga(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Ar(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Dr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Dr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Dr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Dr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Dr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Dr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Dr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=ax[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Dr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Yo[s.color.index];s.color.index==81&&(l=Yo[1]),l||(l=Yo[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=kh(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Wte(t,e,r){e.NumberFmt=[];for(var n=Va(Ut),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Ut[n[s]];var i=t[0].match(ns);if(i)for(s=0;s<i.length;++s){var a=It(i[s]);switch(Ga(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ir(Ar(a.formatCode)),l=parseInt(a.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}Xo(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}var t0=["numFmtId","fillId","fontId","borderId","xfId"],r0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function zte(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(ns)||[]).forEach(function(i){var a=It(i),o=0;switch(Ga(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<t0.length;++o)n[t0[o]]&&(n[t0[o]]=parseInt(n[t0[o]],10));for(o=0;o<r0.length;++o)n[r0[o]]&&(n[r0[o]]=Dr(n[r0[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=Dr(a.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}var Kte=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(e))&&Wte(f,u,c),(f=o.match(s))&&Gte(f,u,l,c),(f=o.match(n))&&jte(f,u,l,c),(f=o.match(i))&&Hte(f,u,l,c),(f=o.match(r))&&zte(f,u,c),u}}();function qte(t,e){var r=t.read_shift(2),n=es(t);return[r,n]}function Xte(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=aZ(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var i=t.read_shift(2);switch(i===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=sZ(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=es(t),n}var Yte=rs;function Qte(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}var Jte=rs;function Zte(t,e,r){var n={};n.NumberFmt=[];for(var s in Ut)n.NumberFmt[s]=Ut[s];n.CellXf=[],n.Fonts=[];var i=[],a=!1;return Pi(t,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],Xo(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=kh(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:i.push(u),a=!0;break;case 38:i.pop(),a=!1;break;default:if(c.T>0)i.push(u);else if(c.T<0)i.pop();else if(!a||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var ere=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function tre(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ns)||[]).forEach(function(s){var i=It(s);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(e.themeElements.clrScheme[ere.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function rre(){}function nre(){}var sre=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,are=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ire=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function ore(t,e,r){e.themeElements={};var n;[["clrScheme",sre,tre],["fontScheme",are,rre],["fmtScheme",ire,nre]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var lre=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Mk(t,e){(!t||t.length===0)&&(t=cre());var r,n={};if(!(r=t.match(lre)))throw new Error("themeElements not found in theme");return ore(r[0],n,e),n.raw=t,n}function cre(t,e){var r=[KI];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function ure(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var i=t.slice(t.l);t.l=n;var a;try{a=zI(i,{type:"array"})}catch{return}var o=Ds(a,"theme/theme/theme1.xml",!0);if(o)return Mk(o,r)}}function dre(t){return t.read_shift(4)}function fre(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=hre(t,4);break;case 2:e.xclrValue=bk(t);break;case 3:e.xclrValue=dre(t);break;case 4:t.l+=4;break}return t.l+=8,e}function hre(t,e){return rs(t,e)}function pre(t,e){return rs(t,e)}function mre(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=fre(t);break;case 6:n[1]=pre(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function gre(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),i=[];s-- >0;)i.push(mre(t,r-t.l));return{ixfe:n,ext:i}}function vre(t,e){e.forEach(function(r){switch(r[0]){}})}function yre(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:es(t)}}function xre(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Ere(t){return t.l+=4,t.read_shift(4)!=0}function _re(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},i=[],a=!1,o=2;return Pi(t,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:i.push(u),a=!0;break;case 36:i.pop(),a=!1;break;default:if(!c.T){if(!a||s.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function bre(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,i=2,a;return t.replace(ns,function(o){var l=It(o);switch(Ga(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(a=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):i==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Sre(t){var e=[];if(!t)return e;var r=1;return(t.match(ns)||[]).forEach(function(n){var s=It(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function Are(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Mt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function Tre(t,e,r){var n=[];return Pi(t,function(i,a,o){switch(o){case 63:n.push(i);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function wre(t,e,r,n){if(!t)return t;var s=n||{},i=!1;Pi(t,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!l.T){if(!i||s.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},s)}function Cre(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function xS(t,e,r,n){var s=Array.isArray(t),i;e.forEach(function(a){var o=ds(a.ref);if(s?(t[o.r]||(t[o.r]=[]),i=t[o.r][o.c]):i=t[a.ref],!i){i={t:"z"},s?t[o.r][o.c]=i:t[a.ref]=i;var l=Gr(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=ar(l);c!==t["!ref"]&&(t["!ref"]=c)}i.c||(i.c=[]);var u={a:a.author,t:a.t,r:a.r,T:r};a.h&&(u.h=a.h);for(var f=i.c.length-1;f>=0;--f){if(!r&&i.c[f].T)return;r&&!i.c[f].T&&i.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(u.a==n[f].id){u.a=n[f].name||u.a;break}}i.c.push(u)})}function Ire(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var i=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=It(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=ds(l.ref);if(!(e.sheetRows&&e.sheetRows<=u.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&bx(f[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function kre(t,e){var r=[],n=!1,s={},i=0;return t.replace(ns,function(o,l){var c=It(o);switch(Ga(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":i=l+o.length;break;case"</text>":s.t=t.slice(i,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Dre(t,e){var r=[],n=!1;return t.replace(ns,function(i){var a=It(i);switch(Ga(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return i}),r}function Pre(t){var e={};e.iauthor=t.read_shift(4);var r=Sl(t);return e.rfx=r.s,e.ref=Mt(r.s),t.l+=16,e}var Rre=es;function Fre(t,e){var r=[],n=[],s={},i=!1;return Pi(t,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!i||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var Nre="application/vnd.ms-office.vbaProject";function Ore(t){var e=nr.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");nr.utils.cfb_add(e,s,t.FileIndex[n].content)}}),nr.write(e)}function Mre(){return{"!type":"dialog"}}function Lre(){return{"!type":"dialog"}}function Bre(){return{"!type":"macro"}}function Ure(){return{"!type":"macro"}}var mc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,i,a){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,u=a.length>0?parseInt(a,10)|0:0;return o?u+=e.c:--u,l?c+=e.r:--c,s+(o?"":"$")+hn(u)+(l?"":"$")+Mn(c)}return function(s,i){return e=i,s.replace(t,r)}}(),Lk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,$re=function(){return function(e,r){return e.replace(Lk,function(n,s,i,a,o,l){var c=gx(a)-(i?0:r.c),u=mx(l)-(o?0:r.r),f=u==0?"":o?u+1:"["+u+"]",h=c==0?"":i?c+1:"["+c+"]";return s+"R"+f+"C"+h})}}();function Bk(t,e){return t.replace(Lk,function(r,n,s,i,a,o){return n+(s=="$"?s+i:hn(gx(i)+e.c))+(a=="$"?a+o:Mn(mx(o)+e.r))})}function Vre(t,e,r){var n=zc(e),s=n.s,i=ds(r),a={r:i.r-s.r,c:i.c-s.c};return Bk(t,a)}function Hre(t){return t.length!=1}function ES(t){return t.replace(/_xlfn\./g,"")}function Qr(t){t.l+=1}function vo(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function Uk(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return $k(t);r.biff==12&&(n=4)}var s=t.read_shift(n),i=t.read_shift(n),a=vo(t),o=vo(t);return{s:{r:s,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function $k(t){var e=vo(t),r=vo(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function jre(t,e,r){if(r.biff<8)return $k(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),i=vo(t),a=vo(t);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function Vk(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Gre(t);var n=t.read_shift(r&&r.biff==12?4:2),s=vo(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Gre(t){var e=vo(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Wre(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function zre(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Kre(t);var s=t.read_shift(n>=12?4:2),i=t.read_shift(2),a=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;s>524287;)s-=1048576;if(a==1)for(;i>8191;)i=i-16384;return{r:s,c:i,cRel:a,rRel:o}}function Kre(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function qre(t,e,r){var n=(t[t.l++]&96)>>5,s=Uk(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Xre(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var a=Uk(t,i,r);return[n,s,a]}function Yre(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Qre(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=8;if(r)switch(r.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[n,s]}function Jre(t,e,r){var n=(t[t.l++]&96)>>5,s=jre(t,e-1,r);return[n,s]}function Zre(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function _S(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function ene(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],i=0;i<=n;++i)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function tne(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function rne(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function nne(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function sne(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Hk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function ane(t){return t.read_shift(2),Hk(t)}function ine(t){return t.read_shift(2),Hk(t)}function one(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Vk(t,0,r);return[n,s]}function lne(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=zre(t,0,r);return[n,s]}function cne(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var i=Vk(t,0,r);return[n,s,i]}function une(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[dse[s],Wk[s],n]}function dne(t,e,r){var n=t[t.l++],s=t.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:fne(t);return[s,(i[0]===0?Wk:use)[i[1]]]}function fne(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function hne(t,e,r){t.l+=r&&r.biff==2?3:4}function pne(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function mne(t){return t.l++,Al[t.read_shift(1)]}function gne(t){return t.l++,t.read_shift(2)}function vne(t){return t.l++,t.read_shift(1)!==0}function yne(t){return t.l++,qn(t)}function xne(t,e,r){return t.l++,lf(t,e-1,r)}function Ene(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=zr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Al[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=qn(t);break;case 2:r[1]=Tl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function _ne(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],i=0;i!=n;++i)s.push((r.biff==12?Sl:Vp)(t));return s}function bne(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var i=0,a=[];i!=n&&(a[i]=[]);++i)for(var o=0;o!=s;++o)a[i][o]=Ene(t,r.biff);return a}function Sne(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,i=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,i]}function Ane(t,e,r){if(r.biff==5)return Tne(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),i=t.read_shift(4);return[n,s,i]}function Tne(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function wne(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Cne(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function Ine(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function kne(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[n,s]}var Dne=rs,Pne=rs,Rne=rs;function uf(t,e,r){return t.l+=2,[Wre(t)]}function Ax(t){return t.l+=6,[]}var Fne=uf,Nne=Ax,One=Ax,Mne=uf;function jk(t){return t.l+=2,[rn(t),t.read_shift(2)&1]}var Lne=uf,Bne=jk,Une=Ax,$ne=uf,Vne=uf,Hne=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jne(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),i=t.read_shift(2),a=Hne[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:s,C:i}}function Gne(t){return t.l+=2,[t.read_shift(4)]}function Wne(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function zne(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Kne(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function qne(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Xne(t){return t.l+=4,[0,0]}var bS={1:{n:"PtgExp",f:pne},2:{n:"PtgTbl",f:Rne},3:{n:"PtgAdd",f:Qr},4:{n:"PtgSub",f:Qr},5:{n:"PtgMul",f:Qr},6:{n:"PtgDiv",f:Qr},7:{n:"PtgPower",f:Qr},8:{n:"PtgConcat",f:Qr},9:{n:"PtgLt",f:Qr},10:{n:"PtgLe",f:Qr},11:{n:"PtgEq",f:Qr},12:{n:"PtgGe",f:Qr},13:{n:"PtgGt",f:Qr},14:{n:"PtgNe",f:Qr},15:{n:"PtgIsect",f:Qr},16:{n:"PtgUnion",f:Qr},17:{n:"PtgRange",f:Qr},18:{n:"PtgUplus",f:Qr},19:{n:"PtgUminus",f:Qr},20:{n:"PtgPercent",f:Qr},21:{n:"PtgParen",f:Qr},22:{n:"PtgMissArg",f:Qr},23:{n:"PtgStr",f:xne},26:{n:"PtgSheet",f:Wne},27:{n:"PtgEndSheet",f:zne},28:{n:"PtgErr",f:mne},29:{n:"PtgBool",f:vne},30:{n:"PtgInt",f:gne},31:{n:"PtgNum",f:yne},32:{n:"PtgArray",f:Zre},33:{n:"PtgFunc",f:une},34:{n:"PtgFuncVar",f:dne},35:{n:"PtgName",f:Sne},36:{n:"PtgRef",f:one},37:{n:"PtgArea",f:qre},38:{n:"PtgMemArea",f:wne},39:{n:"PtgMemErr",f:Dne},40:{n:"PtgMemNoMem",f:Pne},41:{n:"PtgMemFunc",f:Cne},42:{n:"PtgRefErr",f:Ine},43:{n:"PtgAreaErr",f:Yre},44:{n:"PtgRefN",f:lne},45:{n:"PtgAreaN",f:Jre},46:{n:"PtgMemAreaN",f:Kne},47:{n:"PtgMemNoMemN",f:qne},57:{n:"PtgNameX",f:Ane},58:{n:"PtgRef3d",f:cne},59:{n:"PtgArea3d",f:Xre},60:{n:"PtgRefErr3d",f:kne},61:{n:"PtgAreaErr3d",f:Qre},255:{}},Yne={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Qne={1:{n:"PtgElfLel",f:jk},2:{n:"PtgElfRw",f:$ne},3:{n:"PtgElfCol",f:Fne},6:{n:"PtgElfRwV",f:Vne},7:{n:"PtgElfColV",f:Mne},10:{n:"PtgElfRadical",f:Lne},11:{n:"PtgElfRadicalS",f:Une},13:{n:"PtgElfColS",f:Nne},15:{n:"PtgElfColSV",f:One},16:{n:"PtgElfRadicalLel",f:Bne},25:{n:"PtgList",f:jne},29:{n:"PtgSxName",f:Gne},255:{}},Jne={0:{n:"PtgAttrNoop",f:Xne},1:{n:"PtgAttrSemi",f:sne},2:{n:"PtgAttrIf",f:rne},4:{n:"PtgAttrChoose",f:ene},8:{n:"PtgAttrGoto",f:tne},16:{n:"PtgAttrSum",f:hne},32:{n:"PtgAttrBaxcel",f:_S},33:{n:"PtgAttrBaxcel",f:_S},64:{n:"PtgAttrSpace",f:ane},65:{n:"PtgAttrSpaceSemi",f:ine},128:{n:"PtgAttrIfError",f:nne},255:{}};function df(t,e,r,n){if(n.biff<8)return rs(t,e);for(var s=t.l+e,i=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=bne(t,0,n),i.push(r[a][1]);break;case"PtgMemArea":r[a][2]=_ne(t,r[a][1],n),i.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),i.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return e=s-t.l,e!==0&&i.push(rs(t,e)),i}function ff(t,e,r){for(var n=t.l+e,s,i,a=[];n!=t.l;)e=n-t.l,i=t[t.l],s=bS[i]||bS[Yne[i]],(i===24||i===25)&&(s=(i===24?Qne:Jne)[t[t.l+1]]),!s||!s.f?rs(t,e):a.push([s.n,s.f(t,e,r)]);return a}function Zne(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],i=0;i<n.length;++i){var a=n[i];if(a)switch(a[0]){case 2:s.push('"'+a[1].replace(/"/g,'""')+'"');break;default:s.push(a[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var ese={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tse(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Gk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function SS(t,e,r){var n=Gk(t,e,r);return n=="#REF"?n:tse(n,r)}function Wn(t,e,r,n,s){var i=s&&s.biff||8,a={s:{c:0,r:0}},o=[],l,c,u,f=0,h=0,p,g="";if(!t[0]||!t[0][0])return"";for(var y=-1,E="",b=0,_=t[0].length;b<_;++b){var v=t[0][b];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),y>=0){switch(t[0][y][1][0]){case 0:E=Vr(" ",t[0][y][1][1]);break;case 1:E=Vr("\r",t[0][y][1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}c=c+E,y=-1}o.push(c+ese[v[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Xu(v[1][1],a,s),o.push(Yu(u,i));break;case"PtgRefN":u=r?Xu(v[1][1],r,s):v[1][1],o.push(Yu(u,i));break;case"PtgRef3d":f=v[1][1],u=Xu(v[1][2],a,s),g=SS(n,f,s),o.push(g+"!"+Yu(u,i));break;case"PtgFunc":case"PtgFuncVar":var A=v[1][0],D=v[1][1];A||(A=0),A&=127;var k=A==0?[]:o.slice(-A);o.length-=A,D==="User"&&(D=k.shift()),o.push(D+"("+k.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":p=nS(v[1][1],r?{s:r}:a,s),o.push(vg(p,s));break;case"PtgArea":p=nS(v[1][1],a,s),o.push(vg(p,s));break;case"PtgArea3d":f=v[1][1],p=v[1][2],g=SS(n,f,s),o.push(g+"!"+vg(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var T=(n.names||[])[h-1]||(n[0]||[])[h],x=T?T.Name:"SH33TJSNAME"+String(h);x&&x.slice(0,6)=="_xlfn."&&!s.xlfn&&(x=x.slice(6)),o.push(x);break;case"PtgNameX":var m=v[1][1];h=v[1][2];var S;if(s.biff<=5)m<0&&(m=-m),n[m]&&(S=n[m][h]);else{var I="";if(((n[m]||[])[0]||[])[0]==14849||(((n[m]||[])[0]||[])[0]==1025?n[m][h]&&n[m][h].itab>0&&(I=n.SheetNames[n[m][h].itab-1]+"!"):I=n.SheetNames[h-1]+"!"),n[m]&&n[m][h])I+=n[m][h].Name;else if(n[0]&&n[0][h])I+=n[0][h].Name;else{var C=(Gk(n,m,s)||"").split(";;");C[h-1]?I=C[h-1]:I+="SH33TJSERRX"}o.push(I);break}S||(S={Name:"SH33TJSERRY"}),o.push(S.Name);break;case"PtgParen":var F="(",W=")";if(y>=0){switch(E="",t[0][y][1][0]){case 2:F=Vr(" ",t[0][y][1][1])+F;break;case 3:F=Vr("\r",t[0][y][1][1])+F;break;case 4:W=Vr(" ",t[0][y][1][1])+W;break;case 5:W=Vr("\r",t[0][y][1][1])+W;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][y][1][0])}y=-1}o.push(F+o.pop()+W);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:v[1][1],r:v[1][0]};var P={c:r.c,r:r.r};if(n.sharedf[Mt(u)]){var R=n.sharedf[Mt(u)];o.push(Wn(R,a,P,n,s))}else{var N=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(Wn(c[1],a,P,n,s)),N=!0;break}N||o.push(v[1])}break;case"PtgArray":o.push("{"+Zne(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":y=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var M=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&y>=0&&M.indexOf(t[0][b][0])==-1){v=t[0][y];var O=!0;switch(v[1][0]){case 4:O=!1;case 0:E=Vr(" ",v[1][1]);break;case 5:O=!1;case 1:E=Vr("\r",v[1][1]);break;default:if(E="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((O?E:"")+o.pop()+(O?"":E)),y=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function rse(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],rs(t,e-2)];var o=ff(t,a,r);return e!==a+s&&(i=df(t,e-a-s,o,r)),t.l=n,[o,i]}function nse(t,e,r){var n=t.l+e,s=r.biff==2?1:2,i,a=t.read_shift(s);if(a==65535)return[[],rs(t,e-2)];var o=ff(t,a,r);return e!==a+s&&(i=df(t,e-a-s,o,r)),t.l=n,[o,i]}function sse(t,e,r,n){var s=t.l+e,i=ff(t,n,r),a;return s!==t.l&&(a=df(t,s-t.l,i,r)),[i,a]}function ase(t,e,r){var n=t.l+e,s,i=t.read_shift(2),a=ff(t,i,r);return i==65535?[[],rs(t,e-2)]:(e!==i+2&&(s=df(t,n-i-2,a,r)),[a,s])}function ise(t){var e;if(di(t,t.l+6)!==65535)return[qn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Eg(t,e,r){var n=t.l+e,s=Wa(t);r.biff==2&&++t.l;var i=ise(t),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=nse(t,n-t.l,r);return{cell:s,val:i[0],formula:o,shared:a>>3&1,tt:i[1]}}function Hp(t,e,r){var n=t.read_shift(4),s=ff(t,n,r),i=t.read_shift(4),a=i>0?df(t,i,s,r):null;return[s,a]}var ose=Hp,jp=Hp,lse=Hp,cse=Hp,use={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Wk={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},dse={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function AS(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function _g(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var ed={},gc={};function td(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function zk(t,e,r,n,s,i){try{n.cellNF&&(t.z=Ut[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=En(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Ut[e]==null&&Xo(fJ[e]||"General",e),t.t==="e")t.w=t.w||Al[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=kd(t.v);else if(t.t==="d"){var a=ps(t.v);(a|0)===a?t.w=a.toString(10):t.w=kd(a)}else{if(t.v===void 0)return"";t.w=ll(t.v,gc)}else t.t==="d"?t.w=Ks(e,ps(t.v),gc):t.w=Ks(e,t.v,gc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=i.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=kh(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=kh(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&i.Fills)throw o}}}function fse(t,e){var r=Gr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=ar(r))}var hse=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,pse=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,mse=/<(?:\w:)?hyperlink [^>]*>/mg,gse=/"(\w*:\w*)"/,vse=/<(?:\w:)?col\b[^>]*[\/]?>/g,yse=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,xse=/<(?:\w:)?pageMargins[^>]*\/>/g,Kk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ese=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,_se=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function bse(t,e,r,n,s,i,a){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",f=t.match(pse);f?(c=t.slice(0,f.index),u=t.slice(f.index+f[0].length)):c=u=t;var h=c.match(Kk);h?Tx(h[0],o,s,r):(h=c.match(Ese))&&Sse(h[0],h[1]||"",o,s,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=c.slice(p,p+50).match(gse);g&&fse(o,g[1])}var y=c.match(_se);y&&y[1]&&kse(y[1],s);var E=[];if(e.cellStyles){var b=c.match(vse);b&&wse(E,b)}f&&Dse(f[1],o,e,l,i,a);var _=u.match(yse);_&&(o["!autofilter"]=Cse(_[0]));var v=[],A=u.match(hse);if(A)for(p=0;p!=A.length;++p)v[p]=Gr(A[p].slice(A[p].indexOf('"')+1));var D=u.match(mse);D&&Ase(o,D,n);var k=u.match(xse);if(k&&(o["!margins"]=Tse(It(k[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=ar(l)),e.sheetRows>0&&o["!ref"]){var T=Gr(o["!ref"]);e.sheetRows<=+T.e.r&&(T.e.r=e.sheetRows-1,T.e.r>l.e.r&&(T.e.r=l.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>l.e.c&&(T.e.c=l.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ar(T))}return E.length>0&&(o["!cols"]=E),v.length>0&&(o["!merges"]=v),o}function Tx(t,e,r,n){var s=It(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=ir(Ar(s.codeName)))}function Sse(t,e,r,n,s){Tx(t.slice(0,t.indexOf(">")),r,n,s)}function Ase(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var i=It(Ar(e[s]),!0);if(!i.ref)return;var a=((r||{})["!id"]||[])[i.id];a?(i.Target=a.Target,i.location&&(i.Target+="#"+ir(i.location))):(i.Target="#"+ir(i.location),a={Target:i.Target,TargetMode:"Internal"}),i.Rel=a,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var o=Gr(i.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var u=Mt({c,r:l});n?(t[l]||(t[l]=[]),t[l][c]||(t[l][c]={t:"z",v:void 0}),t[l][c].l=i):(t[u]||(t[u]={t:"z",v:void 0}),t[u].l=i)}}}function Tse(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function wse(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=It(e[n],!0);s.hidden&&(s.hidden=Dr(s.hidden));var i=parseInt(s.min,10)-1,a=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Sx(s.width)),Fc(s);i<=a;)t[i++]=On(s)}}function Cse(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var Ise=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function kse(t,e){e.Views||(e.Views=[{}]),(t.match(Ise)||[]).forEach(function(r,n){var s=It(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Dr(s.rightToLeft)&&(e.Views[n].RTL=!0)})}var Dse=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,i=Dd("v"),a=Dd("f");return function(l,c,u,f,h,p){for(var g=0,y="",E=[],b=[],_=0,v=0,A=0,D="",k,T,x=0,m=0,S,I,C=0,F=0,W=Array.isArray(p.CellXf),P,R=[],N=[],M=Array.isArray(c),O=[],G={},z=!1,j=!!u.sheetStubs,H=l.split(e),V=0,te=H.length;V!=te;++V){y=H[V].trim();var oe=y.length;if(oe!==0){var ne=0;e:for(g=0;g<oe;++g)switch(y[g]){case">":if(y[g-1]!="/"){++g;break e}if(u&&u.cellStyles){if(T=It(y.slice(ne,g),!0),x=T.r!=null?parseInt(T.r,10):x+1,m=-1,u.sheetRows&&u.sheetRows<x)continue;G={},z=!1,T.ht&&(z=!0,G.hpt=parseFloat(T.ht),G.hpx=Nd(G.hpt)),T.hidden=="1"&&(z=!0,G.hidden=!0),T.outlineLevel!=null&&(z=!0,G.level=+T.outlineLevel),z&&(O[x-1]=G)}break;case"<":ne=g;break}if(ne>=g)break;if(T=It(y.slice(ne,g),!0),x=T.r!=null?parseInt(T.r,10):x+1,m=-1,!(u.sheetRows&&u.sheetRows<x)){f.s.r>x-1&&(f.s.r=x-1),f.e.r<x-1&&(f.e.r=x-1),u&&u.cellStyles&&(G={},z=!1,T.ht&&(z=!0,G.hpt=parseFloat(T.ht),G.hpx=Nd(G.hpt)),T.hidden=="1"&&(z=!0,G.hidden=!0),T.outlineLevel!=null&&(z=!0,G.level=+T.outlineLevel),z&&(O[x-1]=G)),E=y.slice(g).split(t);for(var le=0;le!=E.length&&E[le].trim().charAt(0)=="<";++le);for(E=E.slice(le),g=0;g!=E.length;++g)if(y=E[g].trim(),y.length!==0){if(b=y.match(r),_=g,v=0,A=0,y="<c "+(y.slice(0,1)=="<"?">":"")+y,b!=null&&b.length===2){for(_=0,D=b[1],v=0;v!=D.length&&!((A=D.charCodeAt(v)-64)<1||A>26);++v)_=26*_+A;--_,m=_}else++m;for(v=0;v!=y.length&&y.charCodeAt(v)!==62;++v);if(++v,T=It(y.slice(0,v),!0),T.r||(T.r=Mt({r:x-1,c:m})),D=y.slice(v),k={t:""},(b=D.match(i))!=null&&b[1]!==""&&(k.v=ir(b[1])),u.cellFormula){if((b=D.match(a))!=null&&b[1]!==""){if(k.f=ir(Ar(b[1])).replace(/\r\n/g,`
`),u.xlfn||(k.f=ES(k.f)),b[0].indexOf('t="array"')>-1)k.F=(D.match(s)||[])[1],k.F.indexOf(":")>-1&&R.push([Gr(k.F),k.F]);else if(b[0].indexOf('t="shared"')>-1){I=It(b[0]);var J=ir(Ar(b[1]));u.xlfn||(J=ES(J)),N[parseInt(I.si,10)]=[I,J,T.r]}}else(b=D.match(/<f[^>]*\/>/))&&(I=It(b[0]),N[I.si]&&(k.f=Vre(N[I.si][1],N[I.si][2],T.r)));var Q=ds(T.r);for(v=0;v<R.length;++v)Q.r>=R[v][0].s.r&&Q.r<=R[v][0].e.r&&Q.c>=R[v][0].s.c&&Q.c<=R[v][0].e.c&&(k.F=R[v][1])}if(T.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(j)k.t="z";else continue;else k.t=T.t||"n";switch(f.s.c>m&&(f.s.c=m),f.e.c<m&&(f.e.c=m),k.t){case"n":if(k.v==""||k.v==null){if(!j)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!j)continue;k.t="z"}else S=ed[parseInt(k.v,10)],k.v=S.t,k.r=S.r,u.cellHTML&&(k.h=S.h);break;case"str":k.t="s",k.v=k.v!=null?Ar(k.v):"",u.cellHTML&&(k.h=fx(k.v));break;case"inlineStr":b=D.match(n),k.t="s",b!=null&&(S=bx(b[1]))?(k.v=S.t,u.cellHTML&&(k.h=S.h)):k.v="";break;case"b":k.v=Dr(k.v);break;case"d":u.cellDates?k.v=En(k.v,1):(k.v=ps(En(k.v,1)),k.t="n");break;case"e":(!u||u.cellText!==!1)&&(k.w=k.v),k.v=pk[k.v];break}if(C=F=0,P=null,W&&T.s!==void 0&&(P=p.CellXf[T.s],P!=null&&(P.numFmtId!=null&&(C=P.numFmtId),u.cellStyles&&P.fillId!=null&&(F=P.fillId))),zk(k,C,F,u,h,p),u.cellDates&&W&&k.t=="n"&&Wc(Ut[C])&&(k.t="d",k.v=$p(k.v)),T.cm&&u.xlmeta){var ve=(u.xlmeta.Cell||[])[+T.cm-1];ve&&ve.type=="XLDAPR"&&(k.D=!0)}if(M){var ee=ds(T.r);c[ee.r]||(c[ee.r]=[]),c[ee.r][ee.c]=k}else c[T.r]=k}}}}O.length>0&&(c["!rows"]=O)}}();function Pse(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=s/20),r}var Rse=Sl;function Fse(){}function Nse(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=rZ(t),r}function Ose(t){var e=Ys(t);return[e]}function Mse(t){var e=bl(t);return[e]}function Lse(t){var e=Ys(t),r=t.read_shift(1);return[e,r,"b"]}function Bse(t){var e=bl(t),r=t.read_shift(1);return[e,r,"b"]}function Use(t){var e=Ys(t),r=t.read_shift(1);return[e,r,"e"]}function $se(t){var e=bl(t),r=t.read_shift(1);return[e,r,"e"]}function Vse(t){var e=Ys(t),r=t.read_shift(4);return[e,r,"s"]}function Hse(t){var e=bl(t),r=t.read_shift(4);return[e,r,"s"]}function jse(t){var e=Ys(t),r=qn(t);return[e,r,"n"]}function qk(t){var e=bl(t),r=qn(t);return[e,r,"n"]}function Gse(t){var e=Ys(t),r=xx(t);return[e,r,"n"]}function Wse(t){var e=bl(t),r=xx(t);return[e,r,"n"]}function zse(t){var e=Ys(t),r=vx(t);return[e,r,"is"]}function Kse(t){var e=Ys(t),r=es(t);return[e,r,"str"]}function qse(t){var e=bl(t),r=es(t);return[e,r,"str"]}function Xse(t,e,r){var n=t.l+e,s=Ys(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"b"];if(r.cellFormula){t.l+=2;var o=jp(t,n-t.l,r);a[3]=Wn(o,null,s,r.supbooks,r)}else t.l=n;return a}function Yse(t,e,r){var n=t.l+e,s=Ys(t);s.r=r["!row"];var i=t.read_shift(1),a=[s,i,"e"];if(r.cellFormula){t.l+=2;var o=jp(t,n-t.l,r);a[3]=Wn(o,null,s,r.supbooks,r)}else t.l=n;return a}function Qse(t,e,r){var n=t.l+e,s=Ys(t);s.r=r["!row"];var i=qn(t),a=[s,i,"n"];if(r.cellFormula){t.l+=2;var o=jp(t,n-t.l,r);a[3]=Wn(o,null,s,r.supbooks,r)}else t.l=n;return a}function Jse(t,e,r){var n=t.l+e,s=Ys(t);s.r=r["!row"];var i=es(t),a=[s,i,"str"];if(r.cellFormula){t.l+=2;var o=jp(t,n-t.l,r);a[3]=Wn(o,null,s,r.supbooks,r)}else t.l=n;return a}var Zse=Sl;function eae(t,e){var r=t.l+e,n=Sl(t),s=yx(t),i=es(t),a=es(t),o=es(t);t.l=r;var l={rfx:n,relId:s,loc:i,display:o};return a&&(l.Tooltip=a),l}function tae(){}function rae(t,e,r){var n=t.l+e,s=dk(t),i=t.read_shift(1),a=[s];if(a[2]=i,r.cellFormula){var o=ose(t,n-t.l,r);a[1]=o}else t.l=n;return a}function nae(t,e,r){var n=t.l+e,s=Sl(t),i=[s];if(r.cellFormula){var a=cse(t,n-t.l,r);i[1]=a,t.l=n}else t.l=n;return i}var sae=["left","right","top","bottom","header","footer"];function aae(t){var e={};return sae.forEach(function(r){e[r]=qn(t)}),e}function iae(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function oae(){}function lae(){}function cae(t,e,r,n,s,i,a){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,p,g,y,E,b,_,v,A,D,k=[];o.biff=12,o["!row"]=0;var T=0,x=!1,m=[],S={},I=o.supbooks||s.supbooks||[[]];if(I.sharedf=S,I.arrayf=m,I.SheetNames=s.SheetNames||s.Sheets.map(function(M){return M.name}),!o.supbooks&&(o.supbooks=I,s.Names))for(var C=0;C<s.Names.length;++C)I[0][C+1]=s.Names[C];var F=[],W=[],P=!1;Rh[16]={n:"BrtShortReal",f:qk};var R;if(Pi(t,function(O,G,z){if(!h)switch(z){case 148:c=O;break;case 0:p=O,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),A=Mn(E=p.r),o["!row"]=p.r,(O.hidden||O.hpt||O.level!=null)&&(O.hpt&&(O.hpx=Nd(O.hpt)),W[O.r]=O);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:O[2]},O[2]){case"n":g.v=O[1];break;case"s":v=ed[O[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!O[1];break;case"e":g.v=O[1],o.cellText!==!1&&(g.w=Al[g.v]);break;case"str":g.t="s",g.v=O[1];break;case"is":g.t="s",g.v=O[1].t;break}if((y=a.CellXf[O[0].iStyleRef])&&zk(g,y.numFmtId,null,o,i,a),b=O[0].c==-1?b+1:O[0].c,o.dense?(l[E]||(l[E]=[]),l[E][b]=g):l[hn(b)+A]=g,o.cellFormula){for(x=!1,T=0;T<m.length;++T){var j=m[T];p.r>=j[0].s.r&&p.r<=j[0].e.r&&b>=j[0].s.c&&b<=j[0].e.c&&(g.F=ar(j[0]),x=!0)}!x&&O.length>3&&(g.f=O[3])}if(u.s.r>p.r&&(u.s.r=p.r),u.s.c>b&&(u.s.c=b),u.e.r<p.r&&(u.e.r=p.r),u.e.c<b&&(u.e.c=b),o.cellDates&&y&&g.t=="n"&&Wc(Ut[y.numFmtId])){var H=$o(g.v);H&&(g.t="d",g.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}R&&(R.type=="XLDAPR"&&(g.D=!0),R=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;g={t:"z",v:void 0},b=O[0].c==-1?b+1:O[0].c,o.dense?(l[E]||(l[E]=[]),l[E][b]=g):l[hn(b)+A]=g,u.s.r>p.r&&(u.s.r=p.r),u.s.c>b&&(u.s.c=b),u.e.r<p.r&&(u.e.r=p.r),u.e.c<b&&(u.e.c=b),R&&(R.type=="XLDAPR"&&(g.D=!0),R=void 0);break;case 176:k.push(O);break;case 49:R=((o.xlmeta||{}).Cell||[])[O-1];break;case 494:var V=n["!id"][O.relId];for(V?(O.Target=V.Target,O.loc&&(O.Target+="#"+O.loc),O.Rel=V):O.relId==""&&(O.Target="#"+O.loc),E=O.rfx.s.r;E<=O.rfx.e.r;++E)for(b=O.rfx.s.c;b<=O.rfx.e.c;++b)o.dense?(l[E]||(l[E]=[]),l[E][b]||(l[E][b]={t:"z",v:void 0}),l[E][b].l=O):(_=Mt({c:b,r:E}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=O);break;case 426:if(!o.cellFormula)break;m.push(O),D=o.dense?l[E][b]:l[hn(b)+A],D.f=Wn(O[1],u,{r:p.r,c:b},I,o),D.F=ar(O[0]);break;case 427:if(!o.cellFormula)break;S[Mt(O[0].s)]=O[1],D=o.dense?l[E][b]:l[hn(b)+A],D.f=Wn(O[1],u,{r:p.r,c:b},I,o);break;case 60:if(!o.cellStyles)break;for(;O.e>=O.s;)F[O.e--]={width:O.w/256,hidden:!!(O.flags&1),level:O.level},P||(P=!0,Sx(O.w/256)),Fc(F[O.e+1]);break;case 161:l["!autofilter"]={ref:ar(O)};break;case 476:l["!margins"]=O;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),O.name&&(s.Sheets[r].CodeName=O.name),(O.above||O.left)&&(l["!outline"]={above:O.above,left:O.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),O.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!G.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+z.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=ar(c||u)),o.sheetRows&&l["!ref"]){var N=Gr(l["!ref"]);o.sheetRows<=+N.e.r&&(N.e.r=o.sheetRows-1,N.e.r>u.e.r&&(N.e.r=u.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>u.e.c&&(N.e.c=u.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ar(N))}return k.length>0&&(l["!merges"]=k),F.length>0&&(l["!cols"]=F),W.length>0&&(l["!rows"]=W),l}function uae(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var a=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var s=ir((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[e,s,n]}function dae(t,e,r,n,s,i){var a=i||{"!type":"chart"};if(!t)return i;var o=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=uae(f);u.s.r=u.s.c=0,u.e.c=o,c=hn(o),h[0].forEach(function(p,g){a[c+Mn(g)]={t:"n",v:p,z:h[1]},l=g}),u.e.r<l&&(u.e.r=l),++o}),o>0&&(a["!ref"]=ar(u)),a}function fae(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(Kk);return o&&Tx(o[0],i,s,r),(a=t.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=a[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function hae(t,e){t.l+=10;var r=es(t);return{name:r}}function pae(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},a=!1;return Pi(t,function(l,c,u){switch(u){case 550:i["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},e),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var Xk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],mae=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],gae=[],vae=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function TS(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var i=e[s];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Dr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function wS(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Dr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Yk(t){wS(t.WBProps,Xk),wS(t.CalcPr,vae),TS(t.WBView,mae),TS(t.Sheets,gae),gc.date1904=Dr(t.WBProps.date1904)}var yae="][*?/\\".split("");function xae(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yae.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Eae=/<\w+:workbook/;function _ae(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",i={},a=0;if(t.replace(ns,function(l,c){var u=It(l);switch(Ga(u[0])){case"<?xml":break;case"<workbook":l.match(Eae)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Xk.forEach(function(f){if(u[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Dr(u[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(u[f[0]],10);break;default:r.WBProps[f[0]]=u[f[0]]}}),u.codeName&&(r.WBProps.CodeName=Ar(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ir(Ar(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Ar(u.name),u.comment&&(i.Comment=u.comment),u.localSheetId&&(i.Sheet=+u.localSheetId),Dr(u.hidden||"0")&&(i.Hidden=!0),a=c+l.length;break;case"</definedName>":i.Ref=ir(Ar(t.slice(a,c))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),UJ.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Yk(r),r}function bae(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Wv(t),r.name=es(t),r}function Sae(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?es(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Aae(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function Tae(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),i=nZ(t),a=lse(t,0,r),o=yx(t);t.l=n;var l={Name:i,Ptg:a};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function wae(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var i=[],a=[[]];return a.SheetNames=[],a.XTI=[],Rh[16]={n:"BrtFRTArchID$",f:Aae},Pi(t,function(l,c,u){switch(u){case 156:a.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=Wn(l.Ptg,null,null,a,e),delete e.SID,delete l.Ptg,i.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([u,l]):a[0]=[u,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!c.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},e),Yk(r),r.Names=i,r.supbooks=a,r}function Cae(t,e,r){return e.slice(-4)===".bin"?wae(t,r):_ae(t,r)}function Iae(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?cae(t,n,r,s,i,a,o):bse(t,n,r,s,i,a,o)}function kae(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?pae(t,n,r,s,i):fae(t,n,r,s,i)}function Dae(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Bre():Ure()}function Pae(t,e,r,n,s,i,a,o){return e.slice(-4)===".bin"?Mre():Lre()}function Rae(t,e,r,n){return e.slice(-4)===".bin"?Zte(t,r,n):Kte(t,r,n)}function Fae(t,e,r){return Mk(t,r)}function Nae(t,e,r){return e.slice(-4)===".bin"?mte(t,r):hte(t,r)}function Oae(t,e,r){return e.slice(-4)===".bin"?Fre(t,r):Ire(t,r)}function Mae(t,e,r){return e.slice(-4)===".bin"?Tre(t):Sre(t)}function Lae(t,e,r,n){return r.slice(-4)===".bin"?wre(t,e,r,n):void 0}function Bae(t,e,r){return e.slice(-4)===".bin"?_re(t,e,r):bre(t,e,r)}var Qk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Jk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ta(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(Qk),i,a,o,l;if(s)for(l=0;l!=s.length;++l)i=s[l].match(Jk),(a=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),n[o]=i[2].slice(1,i[2].length-1));return n}function Uae(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Qk),s,i,a,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(Jk),(i=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(i+1),r[a]=s[2].slice(1,s[2].length-1));return r}var rd;function $ae(t,e){var r=rd[t]||ir(t);return r==="General"?ll(e):Ks(r,e)}function Vae(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Dr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=En(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ir(e)]=s}function Hae(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Al[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=kd(t.v):t.w=ll(t.v):t.w=$ae(e||"General",t.v)}catch(i){if(r.WTF)throw i}try{var n=rd[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Wc(n)){var s=$o(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(i){if(r.WTF)throw i}}}function jae(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=Vte[n.Pattern]||n.Pattern)}t[e.ID]=e}function Gae(t,e,r,n,s,i,a,o,l,c){var u="General",f=n.StyleID,h={};c=c||{};var p=[],g=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);i[f]!==void 0&&(i[f].nf&&(u=i[f].nf),i[f].Interior&&p.push(i[f].Interior),!!i[f].Parent);)f=i[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Dr(t);break;case"String":n.t="s",n.r=qb(ir(t)),n.v=t.indexOf("<")>-1?ir(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(En(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ir(t):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=pk[t],c.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=qb(e||t));break}if(Hae(n,u,c),c.cellFormula!==!1)if(n.Formula){var y=ir(n.Formula);y.charCodeAt(0)==61&&(y=y.slice(1)),n.f=mc(y,s),delete n.Formula,n.ArrayRange=="RC"?n.F=mc("RC:RC",s):n.ArrayRange&&(n.F=mc(n.ArrayRange,s),l.push([Gr(n.F),n.F]))}else for(g=0;g<l.length;++g)s.r>=l[g][0].s.r&&s.r<=l[g][0].e.r&&s.c>=l[g][0].s.c&&s.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(p.forEach(function(E){!h.patternType&&E.patternType&&(h.patternType=E.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Wae(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function bg(t,e){var r=e||{};$I();var n=bu(hx(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ar(n));var s=n.slice(0,1024).toLowerCase(),i=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var a=On(r);return a.type="string",Rd.to_workbook(n,a)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(de){s.indexOf("<"+de)>=0&&(i=!0)}),i)return eie(n,r);rd={"General Number":"General","General Date":Ut[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ut[15],"Short Date":Ut[14],"Long Time":Ut[19],"Medium Time":Ut[18],"Short Time":Ut[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ut[2],Standard:Ut[4],Percent:Ut[10],Scientific:Ut[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,u={},f=[],h=r.dense?[]:{},p="",g={},y={},E=ta('<Data ss:Type="String">'),b=0,_=0,v=0,A={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},k={},T="",x=0,m=[],S={},I={},C=0,F=[],W=[],P={},R=[],N,M=!1,O=[],G=[],z={},j=0,H=0,V={Sheets:[],WBProps:{date1904:!1}},te={};Pd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";o=Pd.exec(n);)switch(o[3]=(oe=o[3]).toLowerCase()){case"data":if(oe=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?Gae(n.slice(b,o.index),T,E,l[l.length-1][0]=="comment"?P:g,{c:_,r:v},D,R[_],y,O,r):(T="",E=ta(o[0]),b=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(W.length>0&&(g.c=W),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][_]=g):h[hn(_)+Mn(v)]=g),g.HRef&&(g.l={Target:ir(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(j=_+(parseInt(g.MergeAcross,10)|0),H=v+(parseInt(g.MergeDown,10)|0),m.push({s:{c:_,r:v},e:{c:j,r:H}})),!r.sheetStubs)g.MergeAcross?_=j+1:++_;else if(g.MergeAcross||g.MergeDown){for(var ne=_;ne<=j;++ne)for(var le=v;le<=H;++le)(ne>_||le>v)&&(r.dense?(h[le]||(h[le]=[]),h[le][ne]={t:"z"}):h[hn(ne)+Mn(le)]={t:"z"});_=j+1}else++_;else g=Uae(o[0]),g.Index&&(_=+g.Index-1),_<A.s.c&&(A.s.c=_),_>A.e.c&&(A.e.c=_),o[0].slice(-2)==="/>"&&++_,W=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<A.s.r&&(A.s.r=v),v>A.e.r&&(A.e.r=v),o[0].slice(-2)==="/>"&&(y=ta(o[0]),y.Index&&(v=+y.Index-1)),_=0,++v):(y=ta(o[0]),y.Index&&(v=+y.Index-1),z={},(y.AutoFitHeight=="0"||y.Height)&&(z.hpx=parseInt(y.Height,10),z.hpt=Ok(z.hpx),G[v]=z),y.Hidden=="1"&&(z.hidden=!0,G[v]=z));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));f.push(p),A.s.r<=A.e.r&&A.s.c<=A.e.c&&(h["!ref"]=ar(A),r.sheetRows&&r.sheetRows<=A.e.r&&(h["!fullref"]=h["!ref"],A.e.r=r.sheetRows-1,h["!ref"]=ar(A))),m.length&&(h["!merges"]=m),R.length>0&&(h["!cols"]=R),G.length>0&&(h["!rows"]=G),u[p]=h}else A={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=_=0,l.push([o[3],!1]),c=ta(o[0]),p=ir(c.Name),h=r.dense?[]:{},m=[],O=[],G=[],te={name:p,Hidden:0},V.Sheets.push(te);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),R=[],M=!1}break;case"style":o[1]==="/"?jae(D,k,r):k=ta(o[0]);break;case"numberformat":k.nf=ir(ta(o[0]).Format||"General"),rd[k.nf]&&(k.nf=rd[k.nf]);for(var J=0;J!=392&&Ut[J]!=k.nf;++J);if(J==392){for(J=57;J!=392;++J)if(Ut[J]==null){Xo(k.nf,J);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(N=ta(o[0]),N.Hidden&&(N.hidden=!0,delete N.Hidden),N.Width&&(N.wpx=parseInt(N.Width,10)),!M&&N.wpx>10){M=!0,us=Fk;for(var Q=0;Q<R.length;++Q)R[Q]&&Fc(R[Q])}M&&Fc(N),R[N.Index-1||R.length]=N;for(var ve=0;ve<+N.Span;++ve)R[R.length]=On(N);break;case"namedrange":if(o[1]==="/")break;V.Names||(V.Names=[]);var ee=It(o[0]),K={Name:ee.Name,Ref:mc(ee.RefersTo.slice(1),{r:0,c:0})};V.Sheets.length>0&&(K.Sheet=V.Sheets.length-1),V.Names.push(K);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(x,o.index):x=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=ta(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?IZ(S,oe,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));Wae(P),W.push(P)}else l.push([o[3],!1]),c=ta(o[0]),P={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Y=ta(o[0]);h["!autofilter"]={ref:mc(Y.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return RS(n,r);var pe=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:pe=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:pe=!1}break;case"excelworkbook":switch(o[3]){case"date1904":V.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:pe=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:pe=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":te.Hidden=1;break;case"SheetVeryHidden":te.Hidden=2;break}else C=o.index+o[0].length;break;case"header":h["!margins"]||td(h["!margins"]={},"xlml"),isNaN(+It(o[0]).Margin)||(h["!margins"].header=+It(o[0]).Margin);break;case"footer":h["!margins"]||td(h["!margins"]={},"xlml"),isNaN(+It(o[0]).Margin)||(h["!margins"].footer=+It(o[0]).Margin);break;case"pagemargins":var xe=It(o[0]);h["!margins"]||td(h["!margins"]={},"xlml"),isNaN(+xe.Top)||(h["!margins"].top=+xe.Top),isNaN(+xe.Left)||(h["!margins"].left=+xe.Left),isNaN(+xe.Right)||(h["!margins"].right=+xe.Right),isNaN(+xe.Bottom)||(h["!margins"].bottom=+xe.Bottom);break;case"displayrighttoleft":V.Views||(V.Views=[]),V.Views[0]||(V.Views[0]={}),V.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:pe=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:pe=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:pe=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:pe=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:pe=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:pe=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:pe=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:pe=!1}break;case"smarttags":break;default:pe=!1;break}if(pe||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Vae(I,oe,F,n.slice(C,o.index)):(F=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var ae={};return!r.bookSheets&&!r.bookProps&&(ae.Sheets=u),ae.SheetNames=f,ae.Workbook=V,ae.SSF=On(Ut),ae.Props=S,ae.Custprops=I,ae}function Xv(t,e){switch(Ix(e=e||{}),e.type||"base64"){case"base64":return bg(Os(t),e);case"binary":case"buffer":case"file":return bg(t,e);case"array":return bg(_l(t),e)}}function zae(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=iZ(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=oZ(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Kae=[60,1084,2066,2165,2175];function qae(t,e,r,n,s){var i=n,a=[],o=r.slice(r.l,r.l+i);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}a.push(o),r.l+=i;for(var l=di(r,r.l),c=Yv[l],u=0;c!=null&&Kae.indexOf(l)>-1;)i=di(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),o=r.slice(u,r.l+4+i),a.push(o),r.l+=4+i,c=Yv[l=di(r,r.l)];var f=Xi(a);In(f,0);var h=0;f.lens=[];for(var p=0;p<a.length;++p)f.lens.push(h),h+=a[p].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,s)}function wa(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Ut[n])}catch(i){if(e.WTF)throw i}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Al[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=kd(t.v):t.w=ll(t.v):t.w=Ks(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(i){if(e.WTF)throw i}if(e.cellDates&&n&&t.t=="n"&&Wc(Ut[n]||String(n))){var s=$o(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function n0(t,e,r){return{v:t,ixfe:e,t:r}}function Xae(t,e){var r={opts:{}},n={},s=e.dense?[]:{},i={},a={},o=null,l=[],c="",u={},f,h="",p,g,y,E,b={},_=[],v,A,D=[],k=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},x={},m=function(be){return be<8?Yo[be]:be<64&&k[be-8]||Yo[be]},S=function(be,Ae,Me){var We=Ae.XF.data;if(!(!We||!We.patternType||!Me||!Me.cellStyles)){Ae.s={},Ae.s.patternType=We.patternType;var lt;(lt=Fd(m(We.icvFore)))&&(Ae.s.fgColor={rgb:lt}),(lt=Fd(m(We.icvBack)))&&(Ae.s.bgColor={rgb:lt})}},I=function(be,Ae,Me){if(!(z>1)&&!(Me.sheetRows&&be.r>=Me.sheetRows)){if(Me.cellStyles&&Ae.XF&&Ae.XF.data&&S(be,Ae,Me),delete Ae.ixfe,delete Ae.XF,f=be,h=Mt(be),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),be.r<a.s.r&&(a.s.r=be.r),be.c<a.s.c&&(a.s.c=be.c),be.r+1>a.e.r&&(a.e.r=be.r+1),be.c+1>a.e.c&&(a.e.c=be.c+1),Me.cellFormula&&Ae.f){for(var We=0;We<_.length;++We)if(!(_[We][0].s.c>be.c||_[We][0].s.r>be.r)&&!(_[We][0].e.c<be.c||_[We][0].e.r<be.r)){Ae.F=ar(_[We][0]),(_[We][0].s.c!=be.c||_[We][0].s.r!=be.r)&&delete Ae.f,Ae.f&&(Ae.f=""+Wn(_[We][1],a,be,O,C));break}}Me.dense?(s[be.r]||(s[be.r]=[]),s[be.r][be.c]=Ae):s[h]=Ae}},C={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(C.password=e.password);var F,W=[],P=[],R=[],N=[],M=!1,O=[];O.SheetNames=C.snames,O.sharedf=C.sharedf,O.arrayf=C.arrayf,O.names=[],O.XTI=[];var G=0,z=0,j=0,H=[],V=[],te;C.codepage=1200,da(1200);for(var oe=!1;t.l<t.length-1;){var ne=t.l,le=t.read_shift(2);if(le===0&&G===10)break;var J=t.l===t.length?0:t.read_shift(2),Q=Yv[le];if(Q&&Q.f){if(e.bookSheets&&G===133&&le!==133)break;if(G=le,Q.r===2||Q.r==12){var ve=t.read_shift(2);if(J-=2,!C.enc&&ve!==le&&((ve&255)<<8|ve>>8)!==le)throw new Error("rt mismatch: "+ve+"!="+le);Q.r==12&&(t.l+=10,J-=10)}var ee={};if(le===10?ee=Q.f(t,J,C):ee=qae(le,Q,t,J,C),z==0&&[9,521,1033,2057].indexOf(G)===-1)continue;switch(le){case 34:r.opts.Date1904=T.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(t.l=0),C.enc=ee,!e.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=ee;break;case 66:var K=Number(ee);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252;break}da(C.codepage=K),oe=!0;break;case 317:C.rrtabid=ee;break;case 25:C.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:C.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(s["!type"]="dialog"),ee.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ee.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:D.push(ee);break;case 430:O.push([ee]),O[O.length-1].XTI=[];break;case 35:case 547:O[O.length-1].push(ee);break;case 24:case 536:te={Name:ee.Name,Ref:Wn(ee.rgce,a,null,O,C)},ee.itab>0&&(te.Sheet=ee.itab-1),O.names.push(te),O[0]||(O[0]=[],O[0].XTI=[]),O[O.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(V[ee.itab-1]={ref:ar(ee.rgce[0][0][1][2])});break;case 22:C.ExternCount=ee;break;case 23:O.length==0&&(O[0]=[],O[0].XTI=[]),O[O.length-1].XTI=O[O.length-1].XTI.concat(ee),O.XTI=O.XTI.concat(ee);break;case 2196:if(C.biff<8)break;te!=null&&(te.Comment=ee[1]);break;case 18:s["!protect"]=ee;break;case 19:ee!==0&&C.WTF&&console.error("Password verifier: "+ee);break;case 133:i[ee.pos]=ee,C.snames.push(ee.name);break;case 10:{if(--z)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,s["!ref"]=ar(a),e.sheetRows&&e.sheetRows<=a.e.r){var Y=a.e.r;a.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=ar(a),a.e.r=Y}a.e.r++,a.e.c++}W.length>0&&(s["!merges"]=W),P.length>0&&(s["!objects"]=P),R.length>0&&(s["!cols"]=R),N.length>0&&(s["!rows"]=N),T.Sheets.push(x)}c===""?u=s:n[c]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),C.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(C.biff=5,oe=!0,da(C.codepage=28591)),C.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(C.biff=2),z++)break;if(s=e.dense?[]:{},C.biff<8&&!oe&&(oe=!0,da(C.codepage=e.codepage||1252)),C.biff<5||ee.BIFFVer==0&&ee.dt==4096){c===""&&(c="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var pe={pos:t.l-J,name:c};i[pe.pos]=pe,C.snames.push(c)}else c=(i[ne]||{name:""}).name;ee.dt==32&&(s["!type"]="chart"),ee.dt==64&&(s["!type"]="macro"),W=[],P=[],C.arrayf=_=[],R=[],N=[],M=!1,x={Hidden:(i[ne]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[ee.r]||[])[ee.c]:s[Mt({c:ee.c,r:ee.r})])&&++ee.c,v={ixfe:ee.ixfe,XF:D[ee.ixfe]||{},v:ee.val,t:"n"},j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:ee.c,r:ee.r},v,e);break;case 5:case 517:v={ixfe:ee.ixfe,XF:D[ee.ixfe],v:ee.val,t:ee.t},j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:ee.c,r:ee.r},v,e);break;case 638:v={ixfe:ee.ixfe,XF:D[ee.ixfe],v:ee.rknum,t:"n"},j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:ee.c,r:ee.r},v,e);break;case 189:for(var xe=ee.c;xe<=ee.C;++xe){var ae=ee.rkrec[xe-ee.c][0];v={ixfe:ae,XF:D[ae],v:ee.rkrec[xe-ee.c][1],t:"n"},j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:xe,r:ee.r},v,e)}break;case 6:case 518:case 1030:{if(ee.val=="String"){o=ee;break}if(v=n0(ee.val,ee.cell.ixfe,ee.tt),v.XF=D[v.ixfe],e.cellFormula){var de=ee.formula;if(de&&de[0]&&de[0][0]&&de[0][0][0]=="PtgExp"){var Ee=de[0][0][1][0],he=de[0][0][1][1],Ce=Mt({r:Ee,c:he});b[Ce]?v.f=""+Wn(ee.formula,a,ee.cell,O,C):v.F=((e.dense?(s[Ee]||[])[he]:s[Ce])||{}).F}else v.f=""+Wn(ee.formula,a,ee.cell,O,C)}j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I(ee.cell,v,e),o=ee}break;case 7:case 519:if(o)o.val=ee,v=n0(ee,o.cell.ixfe,"s"),v.XF=D[v.ixfe],e.cellFormula&&(v.f=""+Wn(o.formula,a,o.cell,O,C)),j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I(o.cell,v,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(ee);var Te=Mt(ee[0].s);if(p=e.dense?(s[ee[0].s.r]||[])[ee[0].s.c]:s[Te],e.cellFormula&&p){if(!o||!Te||!p)break;p.f=""+Wn(ee[1],a,ee[0],O,C),p.F=ar(ee[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!o)break;b[Mt(o.cell)]=ee[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Mt(o.cell)],(p||{}).f=""+Wn(ee[0],a,f,O,C)}}break;case 253:v=n0(l[ee.isst].t,ee.ixfe,"s"),l[ee.isst].h&&(v.h=l[ee.isst].h),v.XF=D[v.ixfe],j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:ee.c,r:ee.r},v,e);break;case 513:e.sheetStubs&&(v={ixfe:ee.ixfe,XF:D[ee.ixfe],t:"z"},j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:ee.c,r:ee.r},v,e));break;case 190:if(e.sheetStubs)for(var Ge=ee.c;Ge<=ee.C;++Ge){var Ie=ee.ixfe[Ge-ee.c];v={ixfe:Ie,XF:D[Ie],t:"z"},j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:Ge,r:ee.r},v,e)}break;case 214:case 516:case 4:v=n0(ee.val,ee.ixfe,"s"),v.XF=D[v.ixfe],j>0&&(v.z=H[v.ixfe>>8&63]),wa(v,e,r.opts.Date1904),I({c:ee.c,r:ee.r},v,e);break;case 0:case 512:z===1&&(a=ee);break;case 252:l=ee;break;case 1054:if(C.biff==4){H[j++]=ee[1];for(var Ve=0;Ve<j+163&&Ut[Ve]!=ee[1];++Ve);Ve>=163&&Xo(ee[1],j+163)}else Xo(ee[1],ee[0]);break;case 30:{H[j++]=ee;for(var Ue=0;Ue<j+163&&Ut[Ue]!=ee;++Ue);Ue>=163&&Xo(ee,j+163)}break;case 229:W=W.concat(ee);break;case 93:P[ee.cmo[0]]=C.lastobj=ee;break;case 438:C.lastobj.TxO=ee;break;case 127:C.lastobj.ImData=ee;break;case 440:for(E=ee[0].s.r;E<=ee[0].e.r;++E)for(y=ee[0].s.c;y<=ee[0].e.c;++y)p=e.dense?(s[E]||[])[y]:s[Mt({c:y,r:E})],p&&(p.l=ee[1]);break;case 2048:for(E=ee[0].s.r;E<=ee[0].e.r;++E)for(y=ee[0].s.c;y<=ee[0].e.c;++y)p=e.dense?(s[E]||[])[y]:s[Mt({c:y,r:E})],p&&p.l&&(p.l.Tooltip=ee[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;p=e.dense?(s[ee[0].r]||[])[ee[0].c]:s[Mt(ee[0])];var ze=P[ee[2]];p||(e.dense?(s[ee[0].r]||(s[ee[0].r]=[]),p=s[ee[0].r][ee[0].c]={t:"z"}):p=s[Mt(ee[0])]={t:"z"},a.e.r=Math.max(a.e.r,ee[0].r),a.s.r=Math.min(a.s.r,ee[0].r),a.e.c=Math.max(a.e.c,ee[0].c),a.s.c=Math.min(a.s.c,ee[0].c)),p.c||(p.c=[]),g={a:ee[1],t:ze.TxO.t},p.c.push(g)}break;case 2173:vre(D[ee.ixfe],ee.ext);break;case 125:{if(!C.cellStyles)break;for(;ee.e>=ee.s;)R[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},M||(M=!0,Sx(ee.w/256)),Fc(R[ee.e+1])}break;case 520:{var Ke={};ee.level!=null&&(N[ee.r]=Ke,Ke.level=ee.level),ee.hidden&&(N[ee.r]=Ke,Ke.hidden=!0),ee.hpt&&(N[ee.r]=Ke,Ke.hpt=ee.hpt,Ke.hpx=Nd(ee.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||td(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=ee;break;case 161:s["!margins"]||td(s["!margins"]={}),s["!margins"].header=ee.header,s["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(T.Views[0].RTL=!0);break;case 146:k=ee;break;case 2198:F=ee;break;case 140:A=ee;break;case 442:c?x.CodeName=ee||x.name:T.WBProps.CodeName=ee||"ThisWorkbook";break}}else Q||console.error("Missing Info for XLS Record 0x"+le.toString(16)),t.l+=J}return r.SheetNames=Va(i).sort(function(ue,be){return Number(ue)-Number(be)}).map(function(ue){return i[ue].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&V.forEach(function(ue,be){r.Sheets[r.SheetNames[be]]["!autofilter"]=ue}),r.Strings=l,r.SSF=On(Ut),C.enc&&(r.Encryption=C.enc),F&&(r.Themes=F),r.Metadata={},A!==void 0&&(r.Metadata.Country=A),O.names.length>0&&(T.Names=O.names),r.Workbook=T,r}var CS={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Yae(t,e,r){var n=nr.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=uS(n,hZ,CS.DSI);for(var i in s)e[i]=s[i]}catch(c){if(r.WTF)throw c}var a=nr.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=uS(a,pZ,CS.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(c){if(r.WTF)throw c}e.HeadingPairs&&e.TitlesOfParts&&(gk(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function Zk(t,e){e||(e={}),Ix(e),II(),e.codepage&&ix(e.codepage);var r,n;if(t.FullPaths){if(nr.find(t,"/encryption"))throw new Error("File is password-protected");r=nr.find(t,"!CompObj"),n=nr.find(t,"/Workbook")||nr.find(t,"/Book")}else{switch(e.type){case"base64":t=ca(Os(t));break;case"binary":t=ca(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}In(t,0),n={content:t}}var s,i;if(r&&zae(r),e.bookProps&&!e.bookSheets)s={};else{var a=er?"buffer":"array";if(n&&n.content)s=Xae(n.content,e);else if((i=nr.find(t,"PerfectOffice_MAIN"))&&i.content)s=Zu.to_workbook(i.content,(e.type=a,e));else if((i=nr.find(t,"NativeContent_MAIN"))&&i.content)s=Zu.to_workbook(i.content,(e.type=a,e));else throw(i=nr.find(t,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&nr.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=Ore(t))}var o={};return t.FullPaths&&Yae(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}var Rh={0:{f:Pse},1:{f:Ose},2:{f:Gse},3:{f:Use},4:{f:Lse},5:{f:jse},6:{f:Kse},7:{f:Vse},8:{f:Jse},9:{f:Qse},10:{f:Xse},11:{f:Yse},12:{f:Mse},13:{f:Wse},14:{f:$se},15:{f:Bse},16:{f:qk},17:{f:qse},18:{f:Hse},19:{f:vx},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Tae},40:{},42:{},43:{f:Xte},44:{f:qte},45:{f:Yte},46:{f:Jte},47:{f:Qte},48:{},49:{f:ZJ},50:{},51:{f:xre},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ik},62:{f:zse},63:{f:Are},64:{f:oae},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:rs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:iae},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Nse},148:{f:Rse,p:16},151:{f:tae},152:{},153:{f:Sae},154:{},155:{},156:{f:bae},157:{},158:{},159:{T:1,f:pte},160:{T:-1},161:{T:1,f:Sl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Zse},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:yre},336:{T:-1},337:{f:Ere,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Wv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ck},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:rae},427:{f:nae},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:aae},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Fse},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eae},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Wv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Rre},633:{T:1},634:{T:-1},635:{T:1,f:Pre},636:{T:-1},637:{f:tZ},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:hae},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:lae},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Yv={6:{f:Eg},10:{f:Ui},12:{f:rn},13:{f:rn},14:{f:zr},15:{f:zr},16:{f:qn},17:{f:zr},18:{f:zr},19:{f:rn},20:{f:pS},21:{f:pS},23:{f:Ck},24:{f:gS},25:{f:zr},26:{},27:{},28:{f:kee},29:{},34:{f:zr},35:{f:mS},38:{f:qn},39:{f:qn},40:{f:qn},41:{f:qn},42:{f:zr},43:{f:zr},47:{f:Fte},49:{f:uee},51:{f:rn},60:{},61:{f:oee},64:{f:zr},65:{f:cee},66:{f:rn},77:{},80:{},81:{},82:{},85:{f:rn},89:{},90:{},91:{},92:{f:ZZ},93:{f:Pee},94:{},95:{f:zr},96:{},97:{},99:{f:zr},125:{f:Ik},128:{f:Eee},129:{f:eee},130:{f:rn},131:{f:zr},132:{f:zr},133:{f:tee},134:{},140:{f:Lee},141:{f:rn},144:{},146:{f:Uee},151:{},152:{},153:{},154:{},155:{},156:{f:rn},157:{},158:{},160:{f:Gee},161:{f:Vee},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:gee},190:{f:vee},193:{f:Ui},197:{},198:{},199:{},200:{},201:{},202:{f:zr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:rn},220:{},221:{f:zr},222:{},224:{f:xee},225:{f:JZ},226:{f:Ui},227:{},229:{f:Dee},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:ree},253:{f:dee},255:{f:nee},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:_k},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:zr},353:{f:Ui},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:bee},431:{f:zr},432:{},433:{},434:{},437:{},438:{f:Nee},439:{f:zr},440:{f:Oee},441:{},442:{f:cf},443:{},444:{f:rn},445:{},446:{},448:{f:Ui},449:{f:iee,r:2},450:{f:Ui},512:{f:fS},513:{f:jee},515:{f:_ee},516:{f:fee},517:{f:hS},519:{f:Wee},520:{f:see},523:{},545:{f:vS},549:{f:dS},566:{},574:{f:lee},638:{f:mee},659:{},1048:{},1054:{f:hee},1084:{},1212:{f:wee},2048:{f:Mee},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:e0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ui},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:$ee,r:12},2173:{f:gre,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:zr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Tee,r:12},2197:{},2198:{f:ure,r:12},2199:{},2200:{},2201:{},2202:{f:Cee,r:12},2203:{f:Ui},2204:{},2205:{},2206:{},2207:{},2211:{f:aee},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:rn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Hee},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Bee},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:fS},1:{},2:{f:Xee},3:{f:qee},4:{f:Kee},5:{f:hS},7:{f:Yee},8:{},9:{f:e0},11:{},22:{f:rn},30:{f:pee},31:{},32:{},33:{f:vS},36:{},37:{f:dS},50:{f:Qee},62:{},52:{},67:{},68:{f:rn},69:{},86:{},126:{},127:{f:zee},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Jee},223:{},234:{},354:{},421:{},518:{f:Eg},521:{f:e0},536:{f:gS},547:{f:mS},561:{},579:{},1030:{f:Eg},1033:{f:e0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ra(t,e,r,n){var s=e;if(!isNaN(s)){var i=(r||[]).length||0,a=t.next(4);a.write_shift(2,s),a.write_shift(2,i),i>0&&lk(r)&&t.push(r)}}function IS(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var i=t.match(/<\/table/i),a=s.index,o=i&&i.index||t.length,l=_J(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,f=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<l.length;++a){var y=l[a].trim(),E=y.slice(0,3).toLowerCase();if(E=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(E!="<td"&&E!="<th")){var b=y.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var _=b[o].trim();if(_.match(/<t[dh]/i)){for(var v=_,A=0;v.charAt(0)=="<"&&(A=v.indexOf(">"))>-1;)v=v.slice(A+1);for(var D=0;D<g.length;++D){var k=g[D];k.s.c==u&&k.s.r<c&&c<=k.e.r&&(u=k.e.c+1,D=-1)}var T=It(_.slice(0,_.indexOf(">")));h=T.colspan?+T.colspan:1,((f=+T.rowspan)>1||h>1)&&g.push({s:{r:c,c:u},e:{r:c+(f||1)-1,c:u+h-1}});var x=T.t||T["data-t"]||"";if(!v.length){u+=h;continue}if(v=XI(v),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>u&&(p.s.c=u),p.e.c<u&&(p.e.c=u),!v.length){u+=h;continue}var m={t:"s",v};r.raw||!v.trim().length||x=="s"||(v==="TRUE"?m={t:"b",v:!0}:v==="FALSE"?m={t:"b",v:!1}:isNaN(ma(v))?isNaN(Rc(v).getDate())||(m={t:"d",v:En(v)},r.cellDates||(m={t:"n",v:ps(m.v)}),m.z=r.dateNF||Ut[14]):m={t:"n",v:ma(v)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=m):n[Mt({r:c,c:u})]=m,u+=h}}}}return n["!ref"]=ar(p),g.length&&(n["!merges"]=g),n}function Qae(t,e,r,n){for(var s=t["!merges"]||[],i=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,l=0,c=0;c<s.length;++c)if(!(s[c].s.r>r||s[c].s.c>a)&&!(s[c].e.r<r||s[c].e.c<a)){if(s[c].s.r<r||s[c].s.c<a){o=-1;break}o=s[c].e.r-s[c].s.r+1,l=s[c].e.c-s[c].s.c+1;break}if(!(o<0)){var u=Mt({r,c:a}),f=n.dense?(t[r]||[])[a]:t[u],h=f&&f.v!=null&&(f.h||fx(f.w||(Ci(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+u,i.push(LJ("td",h,p))}}var g="<tr>";return g+i.join("")+"</tr>"}var Jae='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Zae="</body></html>";function eie(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return bo(IS(r[0],e),e);var n=Dx();return r.forEach(function(s,i){Px(n,IS(s,e),"Sheet"+(i+1))}),n}function tie(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function rie(t,e){var r=e||{},n=r.header!=null?r.header:Jae,s=r.footer!=null?r.footer:Zae,i=[n],a=zc(t["!ref"]);r.dense=Array.isArray(t),i.push(tie(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)i.push(Qae(t,a,o,r));return i.push("</table>"+s),i.join("")}function eD(t,e,r){var n=r||{},s=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var a=typeof n.origin=="string"?ds(n.origin):n.origin;s=a.r,i=a.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:s,c:i}};if(t["!ref"]){var u=zc(t["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),s==-1&&(c.e.r=s=u.e.r+1)}var f=[],h=0,p=t["!rows"]||(t["!rows"]=[]),g=0,y=0,E=0,b=0,_=0,v=0;for(t["!cols"]||(t["!cols"]=[]);g<o.length&&y<l;++g){var A=o[g];if(kS(A)){if(n.display)continue;p[y]={hidden:!0}}var D=A.children;for(E=b=0;E<D.length;++E){var k=D[E];if(!(n.display&&kS(k))){var T=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):XI(k.innerHTML),x=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<f.length;++h){var m=f[h];m.s.c==b+i&&m.s.r<y+s&&y+s<=m.e.r&&(b=m.e.c+1-i,h=-1)}v=+k.getAttribute("colspan")||1,((_=+k.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:y+s,c:b+i},e:{r:y+s+(_||1)-1,c:b+i+(v||1)-1}});var S={t:"s",v:T},I=k.getAttribute("data-t")||k.getAttribute("t")||"";T!=null&&(T.length==0?S.t=I||"z":n.raw||T.trim().length==0||I=="s"||(T==="TRUE"?S={t:"b",v:!0}:T==="FALSE"?S={t:"b",v:!1}:isNaN(ma(T))?isNaN(Rc(T).getDate())||(S={t:"d",v:En(T)},n.cellDates||(S={t:"n",v:ps(S.v)}),S.z=n.dateNF||Ut[14]):S={t:"n",v:ma(T)})),S.z===void 0&&x!=null&&(S.z=x);var C="",F=k.getElementsByTagName("A");if(F&&F.length)for(var W=0;W<F.length&&!(F[W].hasAttribute("href")&&(C=F[W].getAttribute("href"),C.charAt(0)!="#"));++W);C&&C.charAt(0)!="#"&&(S.l={Target:C}),n.dense?(t[y+s]||(t[y+s]=[]),t[y+s][b+i]=S):t[Mt({c:b+i,r:y+s})]=S,c.e.c<b+i&&(c.e.c=b+i),b+=v}}++y}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),c.e.r=Math.max(c.e.r,y-1+s),t["!ref"]=ar(c),y>=l&&(t["!fullref"]=ar((c.e.r=o.length-g+y-1+s,c))),t}function tD(t,e){var r=e||{},n=r.dense?[]:{};return eD(n,t,e)}function nie(t,e){return bo(tD(t,e),e)}function kS(t){var e="",r=sie(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function sie(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function aie(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ir(e.replace(/<[^>]*>/g,""));return[r]}var DS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function rD(t,e){var r=e||{},n=hx(t),s=[],i,a,o={name:""},l="",c=0,u,f,h={},p=[],g=r.dense?[]:{},y,E,b={value:""},_="",v=0,A=[],D=-1,k=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},x=0,m={},S=[],I={},C=0,F=0,W=[],P=1,R=1,N=[],M={Names:[]},O={},G=["",""],z=[],j={},H="",V=0,te=!1,oe=!1,ne=0;for(Pd.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");y=Pd.exec(n);)switch(y[3]=y[3].replace(/_.*$/,"")){case"table":case"工作表":y[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?g["!ref"]=ar(T):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(g["!fullref"]=g["!ref"],T.e.r=r.sheetRows-1,g["!ref"]=ar(T)),S.length&&(g["!merges"]=S),W.length&&(g["!rows"]=W),u.name=u.名称||u.name,typeof JSON<"u"&&JSON.stringify(u),p.push(u.name),h[u.name]=g,oe=!1):y[0].charAt(y[0].length-2)!=="/"&&(u=It(y[0],!1),D=k=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,g=r.dense?[]:{},S=[],W=[],oe=!0);break;case"table-row-group":y[1]==="/"?--x:++x;break;case"table-row":case"行":if(y[1]==="/"){D+=P,P=1;break}if(f=It(y[0],!1),f.行号?D=f.行号-1:D==-1&&(D=0),P=+f["number-rows-repeated"]||1,P<10)for(ne=0;ne<P;++ne)x>0&&(W[D+ne]={level:x});k=-1;break;case"covered-table-cell":y[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(g[D]||(g[D]=[]),g[D][k]={t:"z"}):g[Mt({r:D,c:k})]={t:"z"}),_="",A=[];break;case"table-cell":case"数据":if(y[0].charAt(y[0].length-2)==="/")++k,b=It(y[0],!1),R=parseInt(b["number-columns-repeated"]||"1",10),E={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(E.f=AS(ir(b.formula))),(b.数据类型||b["value-type"])=="string"&&(E.t="s",E.v=ir(b["string-value"]||""),r.dense?(g[D]||(g[D]=[]),g[D][k]=E):g[Mt({r:D,c:k})]=E),k+=R-1;else if(y[1]!=="/"){++k,_="",v=0,A=[],R=1;var le=P?D+P-1:D;if(k>T.e.c&&(T.e.c=k),k<T.s.c&&(T.s.c=k),D<T.s.r&&(T.s.r=D),le>T.e.r&&(T.e.r=le),b=It(y[0],!1),z=[],j={},E={t:b.数据类型||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=ir(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(C=parseInt(b["number-matrix-rows-spanned"],10)||0,F=parseInt(b["number-matrix-columns-spanned"],10)||0,I={s:{r:D,c:k},e:{r:D+C-1,c:k+F-1}},E.F=ar(I),N.push([I,E.F])),b.formula)E.f=AS(b.formula);else for(ne=0;ne<N.length;++ne)D>=N[ne][0].s.r&&D<=N[ne][0].e.r&&k>=N[ne][0].s.c&&k<=N[ne][0].e.c&&(E.F=N[ne][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(C=parseInt(b["number-rows-spanned"],10)||0,F=parseInt(b["number-columns-spanned"],10)||0,I={s:{r:D,c:k},e:{r:D+C-1,c:k+F-1}},S.push(I)),b["number-columns-repeated"]&&(R=parseInt(b["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Dr(b["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(b.value);break;case"percentage":E.t="n",E.v=parseFloat(b.value);break;case"currency":E.t="n",E.v=parseFloat(b.value);break;case"date":E.t="d",E.v=En(b["date-value"]),r.cellDates||(E.t="n",E.v=ps(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=yJ(b["time-value"])/86400,r.cellDates&&(E.t="d",E.v=$p(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(b.数据数值);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",b["string-value"]!=null&&(_=ir(b["string-value"]),A=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(te=!1,E.t==="s"&&(E.v=_||"",A.length&&(E.R=A),te=v==0),O.Target&&(E.l=O),z.length>0&&(E.c=z,z=[]),_&&r.cellText!==!1&&(E.w=_),te&&(E.t="z",delete E.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var J=0;J<P;++J){if(R=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(g[D+J]||(g[D+J]=[]),g[D+J][k]=J==0?E:On(E);--R>0;)g[D+J][k+R]=On(E);else for(g[Mt({r:D+J,c:k})]=E;--R>0;)g[Mt({r:D+J,c:k+R})]=On(E);T.e.c<=k&&(T.e.c=k)}R=parseInt(b["number-columns-repeated"]||"1",10),k+=R-1,R=0,E={},_="",A=[]}O={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!0]);break;case"annotation":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i;j.t=_,A.length&&(j.R=A),j.a=H,z.push(j)}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);H="",V=0,_="",v=0,A=[];break;case"creator":y[1]==="/"?H=n.slice(V,y.index):V=y.index+y[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(y[1]==="/"){if((i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&s.push([y[3],!1]);_="",v=0,A=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(y[1]==="/"){if(m[o.name]=l,(i=s.pop())[0]!==y[3])throw"Bad state: "+i}else y[0].charAt(y[0].length-2)!=="/"&&(l="",o=It(y[0],!1),s.push([y[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":a=It(y[0],!1),l+=DS[y[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":a=It(y[0],!1),l+=DS[y[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(y[0].slice(-2)==="/>")break;if(y[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,y.index);break}else c=y.index+y[0].length;break;case"named-range":a=It(y[0],!1),G=_g(a["cell-range-address"]);var Q={Name:a.name,Ref:G[0]+"!"+G[1]};oe&&(Q.Sheet=p.length),M.Names.push(Q);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(y[1]==="/"&&(!b||!b["string-value"])){var ve=aie(n.slice(v,y.index));_=(_.length>0?_+`
`:"")+ve[0]}else It(y[0],!1),v=y.index+y[0].length;break;case"s":break;case"database-range":if(y[1]==="/")break;try{G=_g(It(y[0])["target-range-address"]),h[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(y[1]!=="/"){if(O=It(y[0],!1),!O.href)break;O.Target=ir(O.href),delete O.href,O.Target.charAt(0)=="#"&&O.Target.indexOf(".")>-1?(G=_g(O.Target.slice(1)),O.Target="#"+G[0]+"!"+G[1]):O.Target.match(/^\.\.[\\\/]/)&&(O.Target=O.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(y[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(y)}}var ee={Sheets:h,SheetNames:p,Workbook:M};return r.bookSheets&&delete ee.Sheets,ee}function PS(t,e){e=e||{},Vs(t,"META-INF/manifest.xml")&&_Z(tn(t,"META-INF/manifest.xml"),e);var r=Ds(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=rD(Ar(r),e);return Vs(t,"meta.xml")&&(n.Props=mk(tn(t,"meta.xml"))),n}function RS(t,e){return rD(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function wx(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Qv(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Ar(_l(t))}function Jv(t){var e=t.reduce(function(s,i){return s+i.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function FS(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function iie(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function Od(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function pn(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Jn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Od(t,r),i=s&7;s=Math.floor(s/8);var a=0,o;if(s==0)break;switch(i){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=Od(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(n))}var c={data:o,type:i};e[s]==null?e[s]=[c]:e[s].push(c)}return e}function Cx(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function oie(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Od(t,n),i=Jn(t.slice(n[0],n[0]+s));n[0]+=s;var a={id:pn(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=Jn(o.data),c=pn(l[3][0].data);a.messages.push({meta:l,data:t.slice(n[0],n[0]+c)}),n[0]+=c}),(e=i[3])!=null&&e[0]&&(a.merge=pn(i[3][0].data)>>>0>0),r.push(a)}return r}function lie(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Od(e,r),s=[];r[0]<e.length;){var i=e[r[0]]&3;if(i==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}s.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var l=0,c=0;if(i==1?(c=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(c=(e[r[0]++]>>2)+1,i==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Jv(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(s.push(s[0].slice(-l)),c-=l;c>=s[s.length-1].length;)s.push(s[s.length-1]),c-=s[s.length-1].length;s.push(s[0].slice(-l,-l+c))}}var u=Jv(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function cie(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(lie(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Jv(e)}function uie(t,e,r,n){var s=wx(t),i=s.getUint32(4,!0),a=(n>1?12:8)+FS(i&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,u=new Date(2001,0,1);i&512&&(o=s.getUint32(a,!0),a+=4),a+=FS(i&(n>1?12288:4096))*4,i&16&&(l=s.getUint32(a,!0),a+=4),i&32&&(c=s.getFloat64(a,!0),a+=8),i&64&&(u.setTime(u.getTime()+s.getFloat64(a,!0)*1e3),a+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[l]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:e[l]};else if(!isNaN(c))f={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function die(t,e,r){var n=wx(t),s=n.getUint32(8,!0),i=12,a=-1,o=-1,l=NaN,c=NaN,u=new Date(2001,0,1);s&1&&(l=iie(t,i),i+=16),s&2&&(c=n.getFloat64(i,!0),i+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(i,!0)*1e3),i+=8),s&8&&(o=n.getUint32(i,!0),i+=4),s&16&&(a=n.getUint32(i,!0),i+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:e[o]};break;case 5:f={t:"d",v:u};break;case 6:f={t:"b",v:c>0};break;case 7:f={t:"n",v:c/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return f}function fie(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return uie(t,e,r,t[0]);case 5:return die(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function ao(t){var e=Jn(t);return Od(e[1][0].data)}function NS(t,e){var r=Jn(e.data),n=pn(r[1][0].data),s=r[3],i=[];return(s||[]).forEach(function(a){var o=Jn(a.data),l=pn(o[1][0].data)>>>0;switch(n){case 1:i[l]=Qv(o[3][0].data);break;case 8:{var c=t[ao(o[9][0].data)][0],u=Jn(c.data),f=t[ao(u[1][0].data)][0],h=pn(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Jn(f.data);i[l]=p[3].map(function(g){return Qv(g.data)}).join("")}break}}),i}function hie(t,e){var r,n,s,i,a,o,l,c,u,f,h,p,g,y,E=Jn(t),b=pn(E[1][0].data)>>>0,_=pn(E[2][0].data)>>>0,v=((n=(r=E[8])==null?void 0:r[0])==null?void 0:n.data)&&pn(E[8][0].data)>0||!1,A,D;if((i=(s=E[7])==null?void 0:s[0])!=null&&i.data&&e!=0)A=(o=(a=E[7])==null?void 0:a[0])==null?void 0:o.data,D=(c=(l=E[6])==null?void 0:l[0])==null?void 0:c.data;else if((f=(u=E[4])==null?void 0:u[0])!=null&&f.data&&e!=1)A=(p=(h=E[4])==null?void 0:h[0])==null?void 0:p.data,D=(y=(g=E[3])==null?void 0:g[0])==null?void 0:y.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var k=v?4:1,T=wx(A),x=[],m=0;m<A.length/2;++m){var S=T.getUint16(m*2,!0);S<65535&&x.push([m,S])}if(x.length!=_)throw"Expected ".concat(_," cells, found ").concat(x.length);var I=[];for(m=0;m<x.length-1;++m)I[x[m][0]]=D.subarray(x[m][1]*k,x[m+1][1]*k);return x.length>=1&&(I[x[x.length-1][0]]=D.subarray(x[x.length-1][1]*k)),{R:b,cells:I}}function pie(t,e){var r,n=Jn(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?pn(n[7][0].data)>>>0>0?1:0:-1,i=Cx(n[5],function(a){return hie(a,s)});return{nrows:pn(n[4][0].data)>>>0,data:i.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,c){if(a[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));a[o.R][c]=l}),a},[])}}function mie(t,e,r){var n,s=Jn(e.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(pn(s[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(i.e.c=(pn(s[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=ar(i);var a=Jn(s[4][0].data),o=NS(t,t[ao(a[4][0].data)][0]),l=(n=a[17])!=null&&n[0]?NS(t,t[ao(a[17][0].data)][0]):[],c=Jn(a[3][0].data),u=0;c[1].forEach(function(f){var h=Jn(f.data),p=t[ao(h[2][0].data)][0],g=pn(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var y=pie(t,p);y.data.forEach(function(E,b){E.forEach(function(_,v){var A=Mt({r:u+b,c:v}),D=fie(_,o,l);D&&(r[A]=D)})}),u+=y.nrows})}function gie(t,e){var r=Jn(e.data),n={"!ref":"A1"},s=t[ao(r[2][0].data)],i=pn(s[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return mie(t,s[0],n),n}function vie(t,e){var r,n=Jn(e.data),s={name:(r=n[1])!=null&&r[0]?Qv(n[1][0].data):"",sheets:[]},i=Cx(n[2],ao);return i.forEach(function(a){t[a].forEach(function(o){var l=pn(o.meta[1][0].data);l==6e3&&s.sheets.push(gie(t,o))})}),s}function yie(t,e){var r=Dx(),n=Jn(e.data),s=Cx(n[1],ao);if(s.forEach(function(i){t[i].forEach(function(a){var o=pn(a.meta[1][0].data);if(o==2){var l=vie(t,a);l.sheets.forEach(function(c,u){Px(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Sg(t){var e,r,n,s,i={},a=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=cie(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var u;try{u=oie(c)}catch(f){return console.log("## "+(f.message||f))}u.forEach(function(f){i[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=i==null?void 0:i[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&pn(i[1][0].meta[1][0].data)==1&&i[1][0];if(o||a.forEach(function(l){i[l].forEach(function(c){var u=pn(c.meta[1][0].data)>>>0;if(u==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return yie(i,o)}function xie(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Ix(t){xie([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function Eie(t){return Ql.WS.indexOf(t)>-1?"sheet":t==Ql.CS?"chart":t==Ql.DS?"dialog":t==Ql.MS?"macro":t&&t.length?t:"sheet"}function _ie(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Eie(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function bie(t,e,r,n,s,i,a,o,l,c,u,f){try{i[n]=Qu(Ds(t,r,!0),e);var h=tn(t,e),p;switch(o){case"sheet":p=Iae(h,e,s,l,i[n],c,u,f);break;case"chart":if(p=kae(h,e,s,l,i[n],c,u,f),!p||!p["!drawel"])break;var g=Au(p["!drawel"].Target,e),y=zv(g),E=Cre(Ds(t,g,!0),Qu(Ds(t,y,!0),g)),b=Au(E,g),_=zv(b);p=dae(Ds(t,b,!0),b,l,Qu(Ds(t,_,!0),b),c,p);break;case"macro":p=Dae(h,e,s,l,i[n],c,u,f);break;case"dialog":p=Pae(h,e,s,l,i[n],c,u,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var v=[];i&&i[n]&&Va(i[n]).forEach(function(A){var D="";if(i[n][A].Type==Ql.CMNT){D=Au(i[n][A].Target,e);var k=Oae(tn(t,D,!0),D,l);if(!k||!k.length)return;xS(p,k,!1)}i[n][A].Type==Ql.TCMNT&&(D=Au(i[n][A].Target,e),v=v.concat(kre(tn(t,D,!0),l)))}),v&&v.length&&xS(p,v,!0,l.people||[])}catch(A){if(l.WTF)throw A}}function Bs(t){return t.charAt(0)=="/"?t.slice(1):t}function Sie(t,e){if($I(),e=e||{},Ix(e),Vs(t,"META-INF/manifest.xml")||Vs(t,"objectdata.xml"))return PS(t,e);if(Vs(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sg<"u"){if(t.FileIndex)return Sg(t);var r=nr.utils.cfb_new();return zb(t).forEach(function(W){AJ(r,W,SJ(t,W))}),Sg(r)}throw new Error("Unsupported NUMBERS file")}if(!Vs(t,"[Content_Types].xml"))throw Vs(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Vs(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zb(t),s=xZ(Ds(t,"[Content_Types].xml")),i=!1,a,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",tn(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!tn(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),i=!0}s.workbooks[0].slice(-3)=="bin"&&(i=!0);var l={},c={};if(!e.bookSheets&&!e.bookProps){if(ed=[],s.sst)try{ed=Nae(tn(t,Bs(s.sst)),s.sst,e)}catch(W){if(e.WTF)throw W}e.cellStyles&&s.themes.length&&(l=Fae(Ds(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(c=Rae(tn(t,Bs(s.style)),s.style,l,e))}s.links.map(function(W){try{var P=Qu(Ds(t,zv(Bs(W))),W);return Lae(tn(t,Bs(W)),P,W,e)}catch{}});var u=Cae(tn(t,Bs(s.workbooks[0])),s.workbooks[0],e),f={},h="";s.coreprops.length&&(h=tn(t,Bs(s.coreprops[0]),!0),h&&(f=mk(h)),s.extprops.length!==0&&(h=tn(t,Bs(s.extprops[0]),!0),h&&AZ(h,f,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(h=Ds(t,Bs(s.custprops[0]),!0),h&&(p=wZ(h,e)));var g={};if((e.bookSheets||e.bookProps)&&(u.Sheets?a=u.Sheets.map(function(P){return P.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),e.bookProps&&(g.Props=f,g.Custprops=p),e.bookSheets&&typeof a<"u"&&(g.SheetNames=a),e.bookSheets?g.SheetNames:e.bookProps))return g;a={};var y={};e.bookDeps&&s.calcchain&&(y=Mae(tn(t,Bs(s.calcchain)),s.calcchain));var E=0,b={},_,v;{var A=u.Sheets;f.Worksheets=A.length,f.SheetNames=[];for(var D=0;D!=A.length;++D)f.SheetNames[D]=A[D].name}var k=i?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),x=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Vs(t,x)||(x="xl/_rels/workbook."+k+".rels");var m=Qu(Ds(t,x,!0),x.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=Bae(tn(t,Bs(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=Dre(tn(t,Bs(s.people[0])),e)),m&&(m=_ie(m,u.Sheets));var S=tn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=f.Worksheets;++E){var I="sheet";if(m&&m[E]?(_="xl/"+m[E][1].replace(/[\/]?xl\//,""),Vs(t,_)||(_=m[E][1]),Vs(t,_)||(_=x.replace(/_rels\/.*$/,"")+m[E][1]),I=m[E][2]):(_="xl/worksheets/sheet"+(E+1-S)+"."+k,_=_.replace(/sheet0\./,"sheet.")),v=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(E!=e.sheets)continue e;break;case"string":if(f.SheetNames[E].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var C=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==E&&(C=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==f.SheetNames[E].toLowerCase()&&(C=1);if(!C)continue e}}bie(t,_,v,f.SheetNames[E],E,b,a,I,e,u,l,c)}return g={Directory:s,Workbook:u,Props:f,Custprops:p,Deps:y,Sheets:a,SheetNames:f.SheetNames,Strings:ed,Styles:c,Themes:l,SSF:On(Ut)},e&&e.bookFiles&&(t.files?(g.keys=n,g.files=t.files):(g.keys=[],g.files={},t.FullPaths.forEach(function(W,P){W=W.replace(/^Root Entry[\/]/,""),g.keys.push(W),g.files[W]=t.FileIndex[P]}))),e&&e.bookVBA&&(s.vba.length>0?g.vbaraw=tn(t,Bs(s.vba[0]),!0):s.defaults&&s.defaults.bin===Nre&&(g.vbaraw=tn(t,"xl/vbaProject.bin",!0))),g}function Aie(t,e){var r=e||{},n="Workbook",s=nr.find(t,n);try{if(n="/!DataSpaces/Version",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(gte(s.content),n="/!DataSpaces/DataSpaceMap",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=yte(s.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=xte(s.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);_te(s.content)}catch{}if(n="/EncryptionInfo",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=bte(s.content);if(n="/EncryptedPackage",s=nr.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function kx(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Os(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Tie(t,e){return nr.find(t,"EncryptedPackage")?Aie(t,e):Zk(t,e)}function wie(t,e){var r,n=t,s=e||{};return s.type||(s.type=er&&Buffer.isBuffer(t)?"buffer":"base64"),r=zI(n,s),Sie(r,s)}function nD(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Xv(t.slice(r),e);default:break e}return Rd.to_workbook(t,e)}function Cie(t,e){var r="",n=kx(t,e);switch(e.type){case"base64":r=Os(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=cl(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ar(r)),e.type="binary",nD(r,e)}function Iie(t,e){var r=t;return e.type=="base64"&&(r=Os(r)),r=Id.utils.decode(1200,r.slice(2),"str"),e.type="binary",nD(r,e)}function kie(t){return t.match(/[^\x00-\x7F]/)?Tu(t):t}function Ag(t,e,r,n){return n?(r.type="string",Rd.to_workbook(t,r)):Rd.to_workbook(e,r)}function Fh(t,e){II();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Fh(new Uint8Array(t),(r=On(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),gc={},r.dateNF&&(gc.dateNF=r.dateNF),r.type||(r.type=er&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=er?"buffer":"binary",n=gJ(t),typeof Uint8Array<"u"&&!er&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=kie(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=On(r),r.type="array",Fh(ox(n),r)}switch((s=kx(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Tie(nr.read(n,r),r);break;case 9:if(s[1]<=8)return Zk(n,r);break;case 60:return Xv(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return nte(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return tte.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?wie(n,r):Ag(t,n,r,i);case 239:return s[3]===60?Xv(n,r):Ag(t,n,r,i);case 255:if(s[1]===254)return Iie(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Zu.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Zu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return yS.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return Nte.to_workbook(n,r);break;case 10:case 13:case 32:return Cie(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Zee.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?yS.to_workbook(n,r):Ag(t,n,r,i)}function Die(t,e,r,n,s,i,a,o){var l=Mn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var g=a?t[r][p]:t[n[p]+l];if(g===void 0||g.t===void 0){if(c===void 0)continue;i[p]!=null&&(h[i[p]]=c);continue}var y=g.v;switch(g.t){case"z":if(y==null)break;continue;case"e":y=y==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(i[p]!=null){if(y==null)if(g.t=="e"&&y===null)h[i[p]]=null;else if(c!==void 0)h[i[p]]=c;else if(u&&y===null)h[i[p]]=null;else continue;else h[i[p]]=u&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?y:Ci(g,y,o);y!=null&&(f=!1)}}return{row:h,isempty:f}}function Zv(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,i=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=e||{},u=c.range!=null?c.range:t["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Gr(u);break;case"number":l=Gr(t["!ref"]),l.s.r=u;break;default:l=u}n>0&&(s=0);var f=Mn(l.s.r),h=[],p=[],g=0,y=0,E=Array.isArray(t),b=l.s.r,_=0,v={};E&&!t[b]&&(t[b]=[]);var A=c.skipHidden&&t["!cols"]||[],D=c.skipHidden&&t["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(A[_]||{}).hidden)switch(h[_]=hn(_),r=E?t[b][_]:t[h[_]+f],n){case 1:i[_]=_-l.s.c;break;case 2:i[_]=h[_];break;case 3:i[_]=c.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Ci(r,null,c),y=v[a]||0,!y)v[a]=1;else{do o=a+"_"+y++;while(v[o]);v[a]=y,v[o]=1}i[_]=o}for(b=l.s.r+s;b<=l.e.r;++b)if(!(D[b]||{}).hidden){var k=Die(t,l,b,h,n,i,E,c);(k.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[g++]=k.row)}return p.length=g,p}var OS=/"/g;function Pie(t,e,r,n,s,i,a,o){for(var l=!0,c=[],u="",f=Mn(r),h=e.s.c;h<=e.e.c;++h)if(n[h]){var p=o.dense?(t[r]||[])[h]:t[n[h]+f];if(p==null)u="";else if(p.v!=null){l=!1,u=""+(o.rawNumbers&&p.t=="n"?p.v:Ci(p,null,o));for(var g=0,y=0;g!==u.length;++g)if((y=u.charCodeAt(g))===s||y===i||y===34||o.forceQuotes){u='"'+u.replace(OS,'""')+'"';break}u=="ID"&&(u='"ID"')}else p.f!=null&&!p.F?(l=!1,u="="+p.f,u.indexOf(",")>=0&&(u='"'+u.replace(OS,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(a)}function sD(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=Gr(t["!ref"]),i=n.FS!==void 0?n.FS:",",a=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),u="",f=[];n.dense=Array.isArray(t);for(var h=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(f[g]=hn(g));for(var y=0,E=s.s.r;E<=s.e.r;++E)(p[E]||{}).hidden||(u=Pie(t,s,E,f,a,l,i,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((y++?o:"")+u)));return delete n.dense,r.join("")}function Rie(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=sD(t,e);return r}function Fie(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=Gr(t["!ref"]),i="",a=[],o,l=[],c=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)a[o]=hn(o);for(var u=s.s.r;u<=s.e.r;++u)for(i=Mn(u),o=s.s.c;o<=s.e.c;++o)if(e=a[o]+i,r=c?(t[u]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function aD(t,e,r){var n=r||{},s=+!n.skipHeader,i=t||{},a=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?ds(n.origin):n.origin;a=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:a+e.length-1+s}};if(i["!ref"]){var f=Gr(i["!ref"]);u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),a==-1&&(a=f.e.r+1,u.e.r=a+e.length-1+s)}else a==-1&&(a=0,u.e.r=e.length-1+s);var h=n.header||[],p=0;e.forEach(function(y,E){Va(y).forEach(function(b){(p=h.indexOf(b))==-1&&(h[p=h.length]=b);var _=y[b],v="z",A="",D=Mt({c:o+p,r:a+E+s});c=Md(i,D),_&&typeof _=="object"&&!(_ instanceof Date)?i[D]=_:(typeof _=="number"?v="n":typeof _=="boolean"?v="b":typeof _=="string"?v="s":_ instanceof Date?(v="d",n.cellDates||(v="n",_=ps(_)),A=n.dateNF||Ut[14]):_===null&&n.nullError&&(v="e",_=0),c?(c.t=v,c.v=_,delete c.w,delete c.R,A&&(c.z=A)):i[D]=c={t:v,v:_},A&&(c.z=A))})}),u.e.c=Math.max(u.e.c,o+h.length-1);var g=Mn(a);if(s)for(p=0;p<h.length;++p)i[hn(p+o)+g]={t:"s",v:h[p]};return i["!ref"]=ar(u),i}function Nie(t,e){return aD(null,t,e)}function Md(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ds(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Md(t,Mt(e)):Md(t,Mt({r:e,c:r||0}))}function Oie(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Dx(){return{SheetNames:[],Sheets:{}}}function Px(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);s=i&&+i[2]||0;var a=i&&i[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=a+s)!=-1;++s);}if(xae(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function Mie(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=Oie(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Lie(t,e){return t.z=e,t}function iD(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function Bie(t,e,r){return iD(t,"#"+e,r)}function Uie(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function $ie(t,e,r,n){for(var s=typeof e!="string"?e:Gr(e),i=typeof e=="string"?e:ar(e),a=s.s.r;a<=s.e.r;++a)for(var o=s.s.c;o<=s.e.c;++o){var l=Md(t,a,o);l.t="n",l.F=i,delete l.v,a==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Vie={encode_col:hn,encode_row:Mn,encode_cell:Mt,encode_range:ar,decode_col:gx,decode_row:mx,split_cell:JJ,decode_cell:ds,decode_range:zc,format_cell:Ci,sheet_add_aoa:uk,sheet_add_json:aD,sheet_add_dom:eD,aoa_to_sheet:Kc,json_to_sheet:Nie,table_to_sheet:tD,table_to_book:nie,sheet_to_csv:sD,sheet_to_txt:Rie,sheet_to_json:Zv,sheet_to_html:rie,sheet_to_formulae:Fie,sheet_to_row_object_array:Zv,sheet_get_cell:Md,book_new:Dx,book_append_sheet:Px,book_set_sheet_visibility:Mie,cell_set_number_format:Lie,cell_set_hyperlink:iD,cell_set_internal_link:Bie,cell_add_comment:Uie,sheet_set_array_formula:$ie,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Hie={class:"admin-time-table"},jie={class:"header"},Gie={class:"admin-action-btns"},Wie=["disabled"],zie={class:"import-section"},Kie={key:0,class:"import-preview"},qie={class:"import-options"},Xie={class:"import-option-group"},Yie=["disabled"],Qie=["value"],Jie={class:"import-option-group"},Zie=["disabled"],eoe={class:"import-actions"},toe=["disabled"],roe={class:"content"},noe={key:0,class:"loading"},soe={key:1,class:"time-tables-container"},aoe={key:0,class:"empty-state"},ioe={key:1,class:"time-tables-list"},ooe={class:"time-table-header"},loe={class:"time-table-info"},coe={class:"time-table-days"},uoe={class:"admin-action-btns"},doe=["onClick"],foe=["onClick"],hoe={class:"time-table-schedule"},poe={class:"schedule-item-info"},moe={class:"item-name"},goe={class:"item-time"},voe={class:"schedule-item-type"},yoe={class:"dialog-header"},xoe={class:"dialog-content"},Eoe={class:"form-group"},_oe={class:"form-group"},boe={class:"days-checkboxes"},Soe=["value"],Aoe={class:"form-group"},Toe={class:"schedule-items"},woe={class:"item-row"},Coe=["onUpdate:modelValue"],Ioe=["onUpdate:modelValue"],koe=["onUpdate:modelValue"],Doe=["onUpdate:modelValue"],Poe=["onClick"],Roe={__name:"AdminTimeTable",setup(t){const{saveAppSettings:e}=Ms(),r=se(!0),n=se(!1),s=se([]),i=se(!1),a=se(-1),o=se({name:"",days:[],schedule:[]}),l=[{value:"monday",label:"Monday"},{value:"tuesday",label:"Tuesday"},{value:"wednesday",label:"Wednesday"},{value:"thursday",label:"Thursday"},{value:"friday",label:"Friday"},{value:"saturday",label:"Saturday"},{value:"sunday",label:"Sunday"}],c=se(null),u=se([]),f=se([]),h=se("overwrite"),p=se(""),g=se(""),y=Se(()=>h.value==="overwrite"?p.value!=="":g.value.trim()!==""),E=()=>{const N=qr(o.value.name,{trim:!0,maxLength:100,removeDangerous:!0}),M=Hr(N);if(!M.isSafe)return alert(`Security threat detected in time table name: ${M.threats.join(", ")}`),!1;if(o.value.name=N,!o.value.name.trim())return alert("Please enter a time table name"),!1;if(o.value.days.length===0)return alert("Please select at least one day"),!1;if(o.value.schedule.length===0)return alert("Please add at least one schedule item"),!1;for(let O=0;O<o.value.schedule.length;O++){const G=o.value.schedule[O],z=qr(G.name,{trim:!0,maxLength:50,removeDangerous:!0}),j=Hr(z);if(!j.isSafe)return alert(`Security threat detected in schedule item ${O+1}: ${j.threats.join(", ")}`),!1;if(G.name=z,!G.name.trim())return alert(`Please enter a name for schedule item ${O+1}`),!1;if(!G.startTime||!G.endTime)return alert(`Please enter start and end times for ${G.name}`),!1;if(G.startTime>=G.endTime)return alert(`${G.name}: Start time must be before end time`),!1}return!0},b=N=>{const M=qr(N,{trim:!0,maxLength:100,removeDangerous:!0}),O=Hr(M);return O.isSafe?M:(alert(`Security threat detected in import name: ${O.threats.join(", ")}`),null)};async function _(){try{console.log("Loading time tables..."),r.value=!0;const N=await qt(Ze(qe,"app_settings","global"));if(N.exists()){const M=N.data();s.value=M.timeTables||[],console.log("Loaded time tables:",s.value)}else s.value=[],console.log("No time tables found, starting with empty array");r.value=!1}catch(N){console.error("Error loading time tables:",N),r.value=!1}}function v(){a.value=-1,o.value={name:"",days:[],schedule:[]},i.value=!0}function A(N){a.value=N,o.value=JSON.parse(JSON.stringify(s.value[N])),i.value=!0}function D(N){confirm("Are you sure you want to delete this time table?")&&s.value.splice(N,1)}function k(){o.value.schedule.push({name:"",type:"period",startTime:"",endTime:""})}function T(N){o.value.schedule.splice(N,1)}function x(){if(!E())return;if(!Rs("saveTimeTable",10,6e4).allowed){alert("Too many save requests. Please wait before saving again.");return}a.value===-1?s.value.push(JSON.parse(JSON.stringify(o.value))):s.value[a.value]=JSON.parse(JSON.stringify(o.value)),m()}function m(){i.value=!1,a.value=-1,o.value={name:"",days:[],schedule:[]}}async function S(){try{if(!Rs("saveAllTimeTables",5,3e5).allowed){alert("Too many save all requests. Please wait before saving again.");return}n.value=!0,console.log("Saving time tables:",s.value);const M=await qt(Ze(qe,"app_settings","global")),G={...M.exists()?M.data():{},timeTables:s.value};await e(G),n.value=!1,console.log("Time tables saved successfully")}catch(N){console.error("Error saving time tables:",N),n.value=!1}}function I(N){return N.length===0?"No days selected":N.length===7?"Every day":N.length===5&&N.includes("monday")&&N.includes("friday")?"Weekdays":N.map(M=>{const O=l.find(G=>G.value===M);return O?O.label:M}).join(", ")}function C(N){if(!N)return"";const[M,O]=N.split(":"),G=parseInt(M),z=G>=12?"PM":"AM";return`${G===0?12:G>12?G-12:G}:${O} ${z}`}function F(){c.value&&c.value.click()}function W(N){const M=N.target.files[0];if(!M)return;const O=ol(M,{allowedTypes:["csv","excel"],maxSize:5*1024*1024,fieldName:"Time Table Import File"});if(!O.isValid){alert(O.error),N.target.value="";return}const G=Hr(M.name);if(!G.isSafe){alert(`File name contains potentially dangerous content: ${G.threats.join(", ")}`),N.target.value="";return}const z=new FileReader;z.onload=j=>{try{let H=j.target.result,V;M.name.endsWith(".csv")?V=Fh(H,{type:"binary"}):V=Fh(H,{type:"binary"});const te=V.SheetNames[0],oe=V.Sheets[te],le=Vie.sheet_to_json(oe,{defval:""}).map(J=>{const Q={};return Object.entries(J).forEach(([ve,ee])=>{const K=qr(ve,{trim:!0,maxLength:50,removeDangerous:!0}),Y=qr(String(ee),{trim:!0,maxLength:100,removeDangerous:!0});Q[K]=Y}),Q});u.value=le,f.value=le.length?Object.keys(le[0]):[]}catch(H){alert("Error parsing file. Please check the file format and try again."),console.error("File parsing error:",H)}},z.readAsBinaryString(M)}function P(){try{if(!Rs("importTimeTable",3,3e5).allowed){alert("Too many import requests. Please wait before importing again.");return}const M=u.value.map(O=>{const G=O.name||O.Name||O.period||O.Period||O.item||O.Item||"Unknown",z=O.startTime||O["Start Time"]||O.start||O.Start||"08:00",j=O.endTime||O["End Time"]||O.end||O.End||"08:55",H=qr(G,{trim:!0,maxLength:50,removeDangerous:!0}),V=Hr(H);if(!V.isSafe)return console.warn(`Security threat detected in imported item: ${V.threats.join(", ")}`),null;let te="period";const oe=O.type||O.Type||"",ne=H.toLowerCase();return oe.toLowerCase().includes("lunch")||ne.includes("lunch")?te="lunch":oe.toLowerCase().includes("break")||ne.includes("break")?te="break":(oe.toLowerCase().includes("other")||ne.includes("other"))&&(te="other"),{name:H,type:te,startTime:z,endTime:j}}).filter(O=>O&&O.name&&O.name!=="Unknown");if(M.length===0){alert("No valid schedule items found in the imported data. Please check your file format.");return}if(h.value==="overwrite"){if(p.value===""){alert("Please select a time table to overwrite");return}const O=parseInt(p.value);s.value[O]={...s.value[O],schedule:M}}else{const O=b(g.value);if(!O)return;const G={name:O,days:["monday","tuesday","wednesday","thursday","friday"],schedule:M};s.value.push(G)}u.value=[],f.value=[],h.value="overwrite",p.value="",g.value="",alert("Time table imported successfully!")}catch(N){console.error("Error importing time table:",N),alert("Error importing time table. Please check your file format and try again.")}}function R(){u.value=[],f.value=[],h.value="overwrite",p.value="",g.value=""}return Gt(_),(N,M)=>(L(),B("div",Hie,[d("div",jie,[M[7]||(M[7]=d("h1",null,"Time Table Management",-1)),d("div",Gie,[d("button",{onClick:S,class:"admin-action-btn primary",disabled:n.value,style:{"min-width":"160px","max-width":"160px"}},Z(n.value?"Saving...":"Save Time Tables"),9,Wie),d("button",{onClick:v,class:"admin-action-btn secondary",style:{"min-width":"140px","max-width":"140px"}}," Add Time Table ")])]),d("div",zie,[d("button",{onClick:F,class:"admin-action-btn info",style:{"min-width":"150px","max-width":"150px"}},"Import CSV/XLSX"),d("input",{ref_key:"fileInput",ref:c,type:"file",accept:".csv,.xlsx,.xls",style:{display:"none"},onChange:W},null,544),M[8]||(M[8]=d("div",{class:"import-note"}," You can export from Google Sheets or Excel as CSV, or upload your Excel file directly. ",-1))]),u.value.length?(L(),B("div",Kie,[M[13]||(M[13]=d("h3",null,"Preview Imported Time Table",-1)),d("table",null,[d("thead",null,[d("tr",null,[(L(!0),B(De,null,$e(f.value,O=>(L(),B("th",{key:O},Z(O),1))),128))])]),d("tbody",null,[(L(!0),B(De,null,$e(u.value,(O,G)=>(L(),B("tr",{key:G},[(L(!0),B(De,null,$e(f.value,z=>(L(),B("td",{key:z},Z(O[z]),1))),128))]))),128))])]),d("div",qie,[M[12]||(M[12]=d("h4",null,"Import Options",-1)),d("div",Xie,[d("label",null,[Ne(d("input",{type:"radio","onUpdate:modelValue":M[0]||(M[0]=O=>h.value=O),value:"overwrite"},null,512),[[Ss,h.value]]),M[9]||(M[9]=we(" Overwrite existing time table: "))]),Ne(d("select",{"onUpdate:modelValue":M[1]||(M[1]=O=>p.value=O),disabled:h.value!=="overwrite",class:"form-select"},[M[10]||(M[10]=d("option",{value:""},"Select a time table...",-1)),(L(!0),B(De,null,$e(s.value,(O,G)=>(L(),B("option",{key:G,value:G},Z(O.name),9,Qie))),128))],8,Yie),[[sr,p.value]])]),d("div",Jie,[d("label",null,[Ne(d("input",{type:"radio","onUpdate:modelValue":M[2]||(M[2]=O=>h.value=O),value:"create"},null,512),[[Ss,h.value]]),M[11]||(M[11]=we(" Create new time table: "))]),Ne(d("input",{"onUpdate:modelValue":M[3]||(M[3]=O=>g.value=O),type:"text",placeholder:"Enter time table name...",disabled:h.value!=="create",class:"form-input"},null,8,Zie),[[ft,g.value]])])]),d("div",eoe,[d("button",{onClick:P,class:"btn btn-primary",disabled:!y.value},Z(h.value==="overwrite"?"Overwrite Time Table":"Create New Time Table"),9,toe),d("button",{onClick:R,class:"btn btn-secondary"},"Cancel")])])):_e("",!0),d("div",roe,[r.value?(L(),B("div",noe," Loading time tables... ")):(L(),B("div",soe,[s.value.length===0?(L(),B("div",aoe,[M[14]||(M[14]=d("h3",null,"No Time Tables Created",-1)),M[15]||(M[15]=d("p",null,"Create your first time table to get started.",-1)),d("button",{onClick:v,class:"btn btn-primary"},"Create Time Table")])):(L(),B("div",ioe,[(L(!0),B(De,null,$e(s.value,(O,G)=>(L(),B("div",{key:G,class:"time-table-card"},[d("div",ooe,[d("div",loe,[d("h3",null,Z(O.name),1),d("p",coe,Z(I(O.days)),1)]),d("div",uoe,[d("button",{onClick:z=>A(G),class:"admin-action-btn edit"}," Edit ",8,doe),d("button",{onClick:z=>D(G),class:"admin-action-btn delete"}," Delete ",8,foe)])]),d("div",hoe,[(L(!0),B(De,null,$e(O.schedule,(z,j)=>(L(),B("div",{key:j,class:"schedule-item"},[d("div",poe,[d("span",moe,Z(z.name),1),d("span",goe,Z(C(z.startTime))+" - "+Z(C(z.endTime)),1)]),d("div",voe,[d("span",{class:Xe(["type-badge",z.type])},Z(z.type),3)])]))),128))])]))),128))]))]))]),i.value?(L(),B("div",{key:1,class:"edit-dialog-overlay",onClick:m},[d("div",{class:"edit-dialog",onClick:M[6]||(M[6]=Yr(()=>{},["stop"]))},[d("div",yoe,[d("h2",null,Z(a.value===-1?"Create Time Table":"Edit Time Table"),1),d("button",{onClick:m,class:"btn-close"},"×")]),d("div",xoe,[d("div",Eoe,[M[16]||(M[16]=d("label",{for:"timeTableName"},"Time Table Name",-1)),Ne(d("input",{id:"timeTableName","onUpdate:modelValue":M[4]||(M[4]=O=>o.value.name=O),type:"text",placeholder:"e.g., Regular Schedule, Rally Day, Minimum Day",class:"form-input"},null,512),[[ft,o.value.name]])]),d("div",_oe,[M[17]||(M[17]=d("label",null,"Days This Schedule Applies",-1)),d("div",boe,[(L(),B(De,null,$e(l,O=>d("label",{key:O.value,class:"day-checkbox"},[Ne(d("input",{type:"checkbox",value:O.value,"onUpdate:modelValue":M[5]||(M[5]=G=>o.value.days=G)},null,8,Soe),[[bt,o.value.days]]),we(" "+Z(O.label),1)])),64))])]),d("div",Aoe,[M[20]||(M[20]=d("label",null,"Schedule Items",-1)),d("div",Toe,[(L(!0),B(De,null,$e(o.value.schedule,(O,G)=>(L(),B("div",{key:G,class:"schedule-item-edit"},[d("div",woe,[Ne(d("input",{"onUpdate:modelValue":z=>O.name=z,type:"text",placeholder:"Period 1, Lunch, Break, etc.",class:"form-input item-name-input"},null,8,Coe),[[ft,O.name]]),Ne(d("select",{"onUpdate:modelValue":z=>O.type=z,class:"form-select item-type-select"},M[18]||(M[18]=[d("option",{value:"period"},"Period",-1),d("option",{value:"break"},"Break",-1),d("option",{value:"lunch"},"Lunch",-1),d("option",{value:"other"},"Other",-1)]),8,Ioe),[[sr,O.type]]),Ne(d("input",{"onUpdate:modelValue":z=>O.startTime=z,type:"time",class:"form-input time-input"},null,8,koe),[[ft,O.startTime]]),M[19]||(M[19]=d("span",{class:"time-separator"},"to",-1)),Ne(d("input",{"onUpdate:modelValue":z=>O.endTime=z,type:"time",class:"form-input time-input"},null,8,Doe),[[ft,O.endTime]]),d("button",{onClick:z=>T(G),class:"admin-action-btn delete"}," Delete ",8,Poe)])]))),128)),d("button",{onClick:k,class:"admin-action-btn secondary",style:{"min-width":"150px","max-width":"150px"}}," Add Schedule Item ")])])]),d("div",{class:"admin-action-btns"},[d("button",{onClick:m,class:"admin-action-btn cancel",style:{"min-width":"100px","max-width":"100px"}},"Cancel"),d("button",{onClick:x,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},"Save Time Table")])])])):_e("",!0)]))}},oD=St(Roe,[["__scopeId","data-v-428c8e72"]]);function Foe(){const t=se({}),e=se(!1);async function r(){e.value=!0;try{const f=await zt(At(qe,"aideSchedules")),h={};f.forEach(p=>{h[p.id]=p.data()}),t.value=h}catch(f){console.error("Error loading aide schedules:",f),t.value={}}finally{e.value=!1}}async function n(f){e.value=!0;try{const h=await qt(Ze(qe,"aideSchedules",f));h.exists()?t.value[f]=h.data():t.value[f]={schedule:{},directAssignment:[]}}catch(h){console.error("Error loading aide schedule:",h),t.value[f]={schedule:{},directAssignment:[]}}finally{e.value=!1}}async function s(f,h,p=!0){try{const g=JSON.parse(JSON.stringify(h));p?await jt(Ze(qe,"aideSchedules",f),g,{merge:!0}):await jt(Ze(qe,"aideSchedules",f),g),t.value[f]=g}catch(g){throw console.error("Error saving aide schedule:",g),g}}async function i(){try{const f=Object.entries(t.value);for(const[h,p]of f){const g=JSON.parse(JSON.stringify(p));await jt(Ze(qe,"aideSchedules",h),g,{merge:!0})}}catch(f){throw console.error("Error saving all aide schedules:",f),f}}function a(f,h){const p=[];return Object.entries(t.value).forEach(([g,y])=>{y.schedule&&y.schedule[h]&&(Array.isArray(y.schedule[h])?y.schedule[h]:[y.schedule[h]]).includes(f)&&p.push(g)}),p}function o(f){var p;const h=(p=t.value[f])==null?void 0:p.directAssignment;return Array.isArray(h)?h.length>0?h[0]:null:h||null}function l(f){return Object.keys(t.value).find(p=>{var y;const g=(y=t.value[p])==null?void 0:y.directAssignment;return Array.isArray(g)?g.includes(f):g===f})||null}function c(f,h,p){const g=[],y=t.value[f];return y&&((Array.isArray(y.directAssignment)?y.directAssignment:y.directAssignment?[y.directAssignment]:[]).forEach(b=>{if(b){const _=h.find(v=>v.id===b);_&&g.push({..._,assignmentType:"direct"})}}),Object.entries(y.schedule||{}).forEach(([b,_])=>{_&&(Array.isArray(_)?_:[_]).forEach(A=>{A&&h.forEach(D=>{if(D.schedule&&D.schedule[b]===A){const k=g.findIndex(T=>T.id===D.id);k===-1?g.push({...D,assignmentType:"class",period:b,teacherId:A}):(g[k].assignmentType="both",g[k].period=b,g[k].teacherId=A)}})})})),g}function u(f,h,p,g){if(!f||!h||!p||!g)return!1;const y=p.find(A=>A.id===h);if(!y)return!1;const E=t.value[f];if(!E)return!1;if((Array.isArray(E.directAssignment)?E.directAssignment:E.directAssignment?[E.directAssignment]:[]).includes(h))return!0;if(!y.schedule)return!1;const _=E.schedule||{};return Object.entries(y.schedule).some(([A,D])=>{const k=_[A];return k?(Array.isArray(k)?k:[k]).includes(D):!1})}return{aideSchedule:Se(()=>t.value),loading:Se(()=>e.value),loadAideSchedules:r,loadAideSchedule:n,saveAideSchedule:s,saveAllAideSchedules:i,getAidesForTeacher:a,getDirectStudentForAide:o,getAideForStudent:l,getStudentsForAide:c,shouldAideSeeStudent:u}}var Noe={exports:{}};const Ooe=ex(vF);/**!
 * Sortable 1.14.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function MS(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Ha(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?MS(Object(r),!0).forEach(function(n){Moe(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):MS(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function R0(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R0=function(e){return typeof e}:R0=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R0(t)}function Moe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qs(){return qs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qs.apply(this,arguments)}function Loe(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,i;for(i=0;i<n.length;i++)s=n[i],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function Boe(t,e){if(t==null)return{};var r=Loe(t,e),n,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)n=i[s],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Uoe(t){return $oe(t)||Voe(t)||Hoe(t)||joe()}function $oe(t){if(Array.isArray(t))return e1(t)}function Voe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Hoe(t,e){if(t){if(typeof t=="string")return e1(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e1(t,e)}}function e1(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function joe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Goe="1.14.0";function gi(t){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(t)}var Ri=gi(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),hf=gi(/Edge/i),LS=gi(/firefox/i),nd=gi(/safari/i)&&!gi(/chrome/i)&&!gi(/android/i),lD=gi(/iP(ad|od|hone)/i),Woe=gi(/chrome/i)&&gi(/android/i),cD={capture:!1,passive:!1};function Kt(t,e,r){t.addEventListener(e,r,!Ri&&cD)}function Wt(t,e,r){t.removeEventListener(e,r,!Ri&&cD)}function Nh(t,e){if(e){if(e[0]===">"&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch{return!1}return!1}}function zoe(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function aa(t,e,r,n){if(t){r=r||document;do{if(e!=null&&(e[0]===">"?t.parentNode===r&&Nh(t,e):Nh(t,e))||n&&t===r)return t;if(t===r)break}while(t=zoe(t))}return null}var BS=/\s+/g;function Fr(t,e,r){if(t&&e)if(t.classList)t.classList[r?"add":"remove"](e);else{var n=(" "+t.className+" ").replace(BS," ").replace(" "+e+" "," ");t.className=(n+(r?" "+e:"")).replace(BS," ")}}function gt(t,e,r){var n=t&&t.style;if(n){if(r===void 0)return document.defaultView&&document.defaultView.getComputedStyle?r=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(r=t.currentStyle),e===void 0?r:r[e];!(e in n)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),n[e]=r+(typeof r=="string"?"":"px")}}function Qo(t,e){var r="";if(typeof t=="string")r=t;else do{var n=gt(t,"transform");n&&n!=="none"&&(r=n+" "+r)}while(!e&&(t=t.parentNode));var s=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return s&&new s(r)}function uD(t,e,r){if(t){var n=t.getElementsByTagName(e),s=0,i=n.length;if(r)for(;s<i;s++)r(n[s],s);return n}return[]}function La(){var t=document.scrollingElement;return t||document.documentElement}function Pr(t,e,r,n,s){if(!(!t.getBoundingClientRect&&t!==window)){var i,a,o,l,c,u,f;if(t!==window&&t.parentNode&&t!==La()?(i=t.getBoundingClientRect(),a=i.top,o=i.left,l=i.bottom,c=i.right,u=i.height,f=i.width):(a=0,o=0,l=window.innerHeight,c=window.innerWidth,u=window.innerHeight,f=window.innerWidth),(e||r)&&t!==window&&(s=s||t.parentNode,!Ri))do if(s&&s.getBoundingClientRect&&(gt(s,"transform")!=="none"||r&&gt(s,"position")!=="static")){var h=s.getBoundingClientRect();a-=h.top+parseInt(gt(s,"border-top-width")),o-=h.left+parseInt(gt(s,"border-left-width")),l=a+i.height,c=o+i.width;break}while(s=s.parentNode);if(n&&t!==window){var p=Qo(s||t),g=p&&p.a,y=p&&p.d;p&&(a/=y,o/=g,f/=g,u/=y,l=a+u,c=o+f)}return{top:a,left:o,bottom:l,right:c,width:f,height:u}}}function US(t,e,r){for(var n=eo(t,!0),s=Pr(t)[e];n;){var i=Pr(n)[r],a=void 0;if(a=s>=i,!a)return n;if(n===La())break;n=eo(n,!1)}return!1}function Nc(t,e,r,n){for(var s=0,i=0,a=t.children;i<a.length;){if(a[i].style.display!=="none"&&a[i]!==wt.ghost&&(n||a[i]!==wt.dragged)&&aa(a[i],r.draggable,t,!1)){if(s===e)return a[i];s++}i++}return null}function Rx(t,e){for(var r=t.lastElementChild;r&&(r===wt.ghost||gt(r,"display")==="none"||e&&!Nh(r,e));)r=r.previousElementSibling;return r||null}function $r(t,e){var r=0;if(!t||!t.parentNode)return-1;for(;t=t.previousElementSibling;)t.nodeName.toUpperCase()!=="TEMPLATE"&&t!==wt.clone&&(!e||Nh(t,e))&&r++;return r}function $S(t){var e=0,r=0,n=La();if(t)do{var s=Qo(t),i=s.a,a=s.d;e+=t.scrollLeft*i,r+=t.scrollTop*a}while(t!==n&&(t=t.parentNode));return[e,r]}function Koe(t,e){for(var r in t)if(t.hasOwnProperty(r)){for(var n in e)if(e.hasOwnProperty(n)&&e[n]===t[r][n])return Number(r)}return-1}function eo(t,e){if(!t||!t.getBoundingClientRect)return La();var r=t,n=!1;do if(r.clientWidth<r.scrollWidth||r.clientHeight<r.scrollHeight){var s=gt(r);if(r.clientWidth<r.scrollWidth&&(s.overflowX=="auto"||s.overflowX=="scroll")||r.clientHeight<r.scrollHeight&&(s.overflowY=="auto"||s.overflowY=="scroll")){if(!r.getBoundingClientRect||r===document.body)return La();if(n||e)return r;n=!0}}while(r=r.parentNode);return La()}function qoe(t,e){if(t&&e)for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function Tg(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}var sd;function dD(t,e){return function(){if(!sd){var r=arguments,n=this;r.length===1?t.call(n,r[0]):t.apply(n,r),sd=setTimeout(function(){sd=void 0},e)}}}function Xoe(){clearTimeout(sd),sd=void 0}function fD(t,e,r){t.scrollLeft+=e,t.scrollTop+=r}function Fx(t){var e=window.Polymer,r=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):r?r(t).clone(!0)[0]:t.cloneNode(!0)}function VS(t,e){gt(t,"position","absolute"),gt(t,"top",e.top),gt(t,"left",e.left),gt(t,"width",e.width),gt(t,"height",e.height)}function wg(t){gt(t,"position",""),gt(t,"top",""),gt(t,"left",""),gt(t,"width",""),gt(t,"height","")}var Xn="Sortable"+new Date().getTime();function Yoe(){var t=[],e;return{captureAnimationState:function(){if(t=[],!!this.options.animation){var n=[].slice.call(this.el.children);n.forEach(function(s){if(!(gt(s,"display")==="none"||s===wt.ghost)){t.push({target:s,rect:Pr(s)});var i=Ha({},t[t.length-1].rect);if(s.thisAnimationDuration){var a=Qo(s,!0);a&&(i.top-=a.f,i.left-=a.e)}s.fromRect=i}})}},addAnimationState:function(n){t.push(n)},removeAnimationState:function(n){t.splice(Koe(t,{target:n}),1)},animateAll:function(n){var s=this;if(!this.options.animation){clearTimeout(e),typeof n=="function"&&n();return}var i=!1,a=0;t.forEach(function(o){var l=0,c=o.target,u=c.fromRect,f=Pr(c),h=c.prevFromRect,p=c.prevToRect,g=o.rect,y=Qo(c,!0);y&&(f.top-=y.f,f.left-=y.e),c.toRect=f,c.thisAnimationDuration&&Tg(h,f)&&!Tg(u,f)&&(g.top-f.top)/(g.left-f.left)===(u.top-f.top)/(u.left-f.left)&&(l=Joe(g,h,p,s.options)),Tg(f,u)||(c.prevFromRect=u,c.prevToRect=f,l||(l=s.options.animation),s.animate(c,g,f,l)),l&&(i=!0,a=Math.max(a,l),clearTimeout(c.animationResetTimer),c.animationResetTimer=setTimeout(function(){c.animationTime=0,c.prevFromRect=null,c.fromRect=null,c.prevToRect=null,c.thisAnimationDuration=null},l),c.thisAnimationDuration=l)}),clearTimeout(e),i?e=setTimeout(function(){typeof n=="function"&&n()},a):typeof n=="function"&&n(),t=[]},animate:function(n,s,i,a){if(a){gt(n,"transition",""),gt(n,"transform","");var o=Qo(this.el),l=o&&o.a,c=o&&o.d,u=(s.left-i.left)/(l||1),f=(s.top-i.top)/(c||1);n.animatingX=!!u,n.animatingY=!!f,gt(n,"transform","translate3d("+u+"px,"+f+"px,0)"),this.forRepaintDummy=Qoe(n),gt(n,"transition","transform "+a+"ms"+(this.options.easing?" "+this.options.easing:"")),gt(n,"transform","translate3d(0,0,0)"),typeof n.animated=="number"&&clearTimeout(n.animated),n.animated=setTimeout(function(){gt(n,"transition",""),gt(n,"transform",""),n.animated=!1,n.animatingX=!1,n.animatingY=!1},a)}}}}function Qoe(t){return t.offsetWidth}function Joe(t,e,r,n){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-r.top,2)+Math.pow(e.left-r.left,2))*n.animation}var Ll=[],Cg={initializeByDefault:!0},pf={mount:function(e){for(var r in Cg)Cg.hasOwnProperty(r)&&!(r in e)&&(e[r]=Cg[r]);Ll.forEach(function(n){if(n.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Ll.push(e)},pluginEvent:function(e,r,n){var s=this;this.eventCanceled=!1,n.cancel=function(){s.eventCanceled=!0};var i=e+"Global";Ll.forEach(function(a){r[a.pluginName]&&(r[a.pluginName][i]&&r[a.pluginName][i](Ha({sortable:r},n)),r.options[a.pluginName]&&r[a.pluginName][e]&&r[a.pluginName][e](Ha({sortable:r},n)))})},initializePlugins:function(e,r,n,s){Ll.forEach(function(o){var l=o.pluginName;if(!(!e.options[l]&&!o.initializeByDefault)){var c=new o(e,r,e.options);c.sortable=e,c.options=e.options,e[l]=c,qs(n,c.defaults)}});for(var i in e.options)if(e.options.hasOwnProperty(i)){var a=this.modifyOption(e,i,e.options[i]);typeof a<"u"&&(e.options[i]=a)}},getEventProperties:function(e,r){var n={};return Ll.forEach(function(s){typeof s.eventProperties=="function"&&qs(n,s.eventProperties.call(r[s.pluginName],e))}),n},modifyOption:function(e,r,n){var s;return Ll.forEach(function(i){e[i.pluginName]&&i.optionListeners&&typeof i.optionListeners[r]=="function"&&(s=i.optionListeners[r].call(e[i.pluginName],n))}),s}};function wu(t){var e=t.sortable,r=t.rootEl,n=t.name,s=t.targetEl,i=t.cloneEl,a=t.toEl,o=t.fromEl,l=t.oldIndex,c=t.newIndex,u=t.oldDraggableIndex,f=t.newDraggableIndex,h=t.originalEvent,p=t.putSortable,g=t.extraEventProperties;if(e=e||r&&r[Xn],!!e){var y,E=e.options,b="on"+n.charAt(0).toUpperCase()+n.substr(1);window.CustomEvent&&!Ri&&!hf?y=new CustomEvent(n,{bubbles:!0,cancelable:!0}):(y=document.createEvent("Event"),y.initEvent(n,!0,!0)),y.to=a||r,y.from=o||r,y.item=s||r,y.clone=i,y.oldIndex=l,y.newIndex=c,y.oldDraggableIndex=u,y.newDraggableIndex=f,y.originalEvent=h,y.pullMode=p?p.lastPutMode:void 0;var _=Ha(Ha({},g),pf.getEventProperties(n,e));for(var v in _)y[v]=_[v];r&&r.dispatchEvent(y),E[b]&&E[b].call(e,y)}}var Zoe=["evt"],gs=function(e,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=n.evt,i=Boe(n,Zoe);pf.pluginEvent.bind(wt)(e,r,Ha({dragEl:rt,parentEl:Lr,ghostEl:Bt,rootEl:kr,nextEl:Oo,lastDownEl:F0,cloneEl:Br,cloneHidden:Yi,dragStarted:Cu,putSortable:Tn,activeSortable:wt.active,originalEvent:s,oldIndex:Jl,oldDraggableIndex:ad,newIndex:Is,newDraggableIndex:Ki,hideGhostForTarget:gD,unhideGhostForTarget:vD,cloneNowHidden:function(){Yi=!0},cloneNowShown:function(){Yi=!1},dispatchSortableEvent:function(o){is({sortable:r,name:o,originalEvent:s})}},i))};function is(t){wu(Ha({putSortable:Tn,cloneEl:Br,targetEl:rt,rootEl:kr,oldIndex:Jl,oldDraggableIndex:ad,newIndex:Is,newDraggableIndex:Ki},t))}var rt,Lr,Bt,kr,Oo,F0,Br,Yi,Jl,Is,ad,Ki,s0,Tn,ql=!1,Oh=!1,Mh=[],Po,na,Ig,kg,HS,jS,Cu,Bl,id,od=!1,a0=!1,N0,Hn,Dg=[],t1=!1,Lh=[],Gp=typeof document<"u",i0=lD,GS=hf||Ri?"cssFloat":"float",ele=Gp&&!Woe&&!lD&&"draggable"in document.createElement("div"),hD=function(){if(Gp){if(Ri)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto",t.style.pointerEvents==="auto"}}(),pD=function(e,r){var n=gt(e),s=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),i=Nc(e,0,r),a=Nc(e,1,r),o=i&&gt(i),l=a&&gt(a),c=o&&parseInt(o.marginLeft)+parseInt(o.marginRight)+Pr(i).width,u=l&&parseInt(l.marginLeft)+parseInt(l.marginRight)+Pr(a).width;if(n.display==="flex")return n.flexDirection==="column"||n.flexDirection==="column-reverse"?"vertical":"horizontal";if(n.display==="grid")return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(i&&o.float&&o.float!=="none"){var f=o.float==="left"?"left":"right";return a&&(l.clear==="both"||l.clear===f)?"vertical":"horizontal"}return i&&(o.display==="block"||o.display==="flex"||o.display==="table"||o.display==="grid"||c>=s&&n[GS]==="none"||a&&n[GS]==="none"&&c+u>s)?"vertical":"horizontal"},tle=function(e,r,n){var s=n?e.left:e.top,i=n?e.right:e.bottom,a=n?e.width:e.height,o=n?r.left:r.top,l=n?r.right:r.bottom,c=n?r.width:r.height;return s===o||i===l||s+a/2===o+c/2},rle=function(e,r){var n;return Mh.some(function(s){var i=s[Xn].options.emptyInsertThreshold;if(!(!i||Rx(s))){var a=Pr(s),o=e>=a.left-i&&e<=a.right+i,l=r>=a.top-i&&r<=a.bottom+i;if(o&&l)return n=s}}),n},mD=function(e){function r(i,a){return function(o,l,c,u){var f=o.options.group.name&&l.options.group.name&&o.options.group.name===l.options.group.name;if(i==null&&(a||f))return!0;if(i==null||i===!1)return!1;if(a&&i==="clone")return i;if(typeof i=="function")return r(i(o,l,c,u),a)(o,l,c,u);var h=(a?o:l).options.group.name;return i===!0||typeof i=="string"&&i===h||i.join&&i.indexOf(h)>-1}}var n={},s=e.group;(!s||R0(s)!="object")&&(s={name:s}),n.name=s.name,n.checkPull=r(s.pull,!0),n.checkPut=r(s.put),n.revertClone=s.revertClone,e.group=n},gD=function(){!hD&&Bt&&gt(Bt,"display","none")},vD=function(){!hD&&Bt&&gt(Bt,"display","")};Gp&&document.addEventListener("click",function(t){if(Oh)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Oh=!1,!1},!0);var Ro=function(e){if(rt){e=e.touches?e.touches[0]:e;var r=rle(e.clientX,e.clientY);if(r){var n={};for(var s in e)e.hasOwnProperty(s)&&(n[s]=e[s]);n.target=n.rootEl=r,n.preventDefault=void 0,n.stopPropagation=void 0,r[Xn]._onDragOver(n)}}},nle=function(e){rt&&rt.parentNode[Xn]._isOutsideThisEl(e.target)};function wt(t,e){if(!(t&&t.nodeType&&t.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=qs({},e),t[Xn]=this;var r={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return pD(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(a,o){a.setData("Text",o.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:wt.supportPointer!==!1&&"PointerEvent"in window&&!nd,emptyInsertThreshold:5};pf.initializePlugins(this,t,r);for(var n in r)!(n in e)&&(e[n]=r[n]);mD(e);for(var s in this)s.charAt(0)==="_"&&typeof this[s]=="function"&&(this[s]=this[s].bind(this));this.nativeDraggable=e.forceFallback?!1:ele,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?Kt(t,"pointerdown",this._onTapStart):(Kt(t,"mousedown",this._onTapStart),Kt(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(Kt(t,"dragover",this),Kt(t,"dragenter",this)),Mh.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),qs(this,Yoe())}wt.prototype={constructor:wt,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(Bl=null)},_getDirection:function(e,r){return typeof this.options.direction=="function"?this.options.direction.call(this,e,r,rt):this.options.direction},_onTapStart:function(e){if(e.cancelable){var r=this,n=this.el,s=this.options,i=s.preventOnFilter,a=e.type,o=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,l=(o||e).target,c=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||l,u=s.filter;if(dle(n),!rt&&!(/mousedown|pointerdown/.test(a)&&e.button!==0||s.disabled)&&!c.isContentEditable&&!(!this.nativeDraggable&&nd&&l&&l.tagName.toUpperCase()==="SELECT")&&(l=aa(l,s.draggable,n,!1),!(l&&l.animated)&&F0!==l)){if(Jl=$r(l),ad=$r(l,s.draggable),typeof u=="function"){if(u.call(this,e,l,this)){is({sortable:r,rootEl:c,name:"filter",targetEl:l,toEl:n,fromEl:n}),gs("filter",r,{evt:e}),i&&e.cancelable&&e.preventDefault();return}}else if(u&&(u=u.split(",").some(function(f){if(f=aa(c,f.trim(),n,!1),f)return is({sortable:r,rootEl:f,name:"filter",targetEl:l,fromEl:n,toEl:n}),gs("filter",r,{evt:e}),!0}),u)){i&&e.cancelable&&e.preventDefault();return}s.handle&&!aa(c,s.handle,n,!1)||this._prepareDragStart(e,o,l)}}},_prepareDragStart:function(e,r,n){var s=this,i=s.el,a=s.options,o=i.ownerDocument,l;if(n&&!rt&&n.parentNode===i){var c=Pr(n);if(kr=i,rt=n,Lr=rt.parentNode,Oo=rt.nextSibling,F0=n,s0=a.group,wt.dragged=rt,Po={target:rt,clientX:(r||e).clientX,clientY:(r||e).clientY},HS=Po.clientX-c.left,jS=Po.clientY-c.top,this._lastX=(r||e).clientX,this._lastY=(r||e).clientY,rt.style["will-change"]="all",l=function(){if(gs("delayEnded",s,{evt:e}),wt.eventCanceled){s._onDrop();return}s._disableDelayedDragEvents(),!LS&&s.nativeDraggable&&(rt.draggable=!0),s._triggerDragStart(e,r),is({sortable:s,name:"choose",originalEvent:e}),Fr(rt,a.chosenClass,!0)},a.ignore.split(",").forEach(function(u){uD(rt,u.trim(),Pg)}),Kt(o,"dragover",Ro),Kt(o,"mousemove",Ro),Kt(o,"touchmove",Ro),Kt(o,"mouseup",s._onDrop),Kt(o,"touchend",s._onDrop),Kt(o,"touchcancel",s._onDrop),LS&&this.nativeDraggable&&(this.options.touchStartThreshold=4,rt.draggable=!0),gs("delayStart",this,{evt:e}),a.delay&&(!a.delayOnTouchOnly||r)&&(!this.nativeDraggable||!(hf||Ri))){if(wt.eventCanceled){this._onDrop();return}Kt(o,"mouseup",s._disableDelayedDrag),Kt(o,"touchend",s._disableDelayedDrag),Kt(o,"touchcancel",s._disableDelayedDrag),Kt(o,"mousemove",s._delayedDragTouchMoveHandler),Kt(o,"touchmove",s._delayedDragTouchMoveHandler),a.supportPointer&&Kt(o,"pointermove",s._delayedDragTouchMoveHandler),s._dragStartTimer=setTimeout(l,a.delay)}else l()}},_delayedDragTouchMoveHandler:function(e){var r=e.touches?e.touches[0]:e;Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){rt&&Pg(rt),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;Wt(e,"mouseup",this._disableDelayedDrag),Wt(e,"touchend",this._disableDelayedDrag),Wt(e,"touchcancel",this._disableDelayedDrag),Wt(e,"mousemove",this._delayedDragTouchMoveHandler),Wt(e,"touchmove",this._delayedDragTouchMoveHandler),Wt(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,r){r=r||e.pointerType=="touch"&&e,!this.nativeDraggable||r?this.options.supportPointer?Kt(document,"pointermove",this._onTouchMove):r?Kt(document,"touchmove",this._onTouchMove):Kt(document,"mousemove",this._onTouchMove):(Kt(rt,"dragend",this),Kt(kr,"dragstart",this._onDragStart));try{document.selection?O0(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,r){if(ql=!1,kr&&rt){gs("dragStarted",this,{evt:r}),this.nativeDraggable&&Kt(document,"dragover",nle);var n=this.options;!e&&Fr(rt,n.dragClass,!1),Fr(rt,n.ghostClass,!0),wt.active=this,e&&this._appendGhost(),is({sortable:this,name:"start",originalEvent:r})}else this._nulling()},_emulateDragOver:function(){if(na){this._lastX=na.clientX,this._lastY=na.clientY,gD();for(var e=document.elementFromPoint(na.clientX,na.clientY),r=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(na.clientX,na.clientY),e!==r);)r=e;if(rt.parentNode[Xn]._isOutsideThisEl(e),r)do{if(r[Xn]){var n=void 0;if(n=r[Xn]._onDragOver({clientX:na.clientX,clientY:na.clientY,target:e,rootEl:r}),n&&!this.options.dragoverBubble)break}e=r}while(r=r.parentNode);vD()}},_onTouchMove:function(e){if(Po){var r=this.options,n=r.fallbackTolerance,s=r.fallbackOffset,i=e.touches?e.touches[0]:e,a=Bt&&Qo(Bt,!0),o=Bt&&a&&a.a,l=Bt&&a&&a.d,c=i0&&Hn&&$S(Hn),u=(i.clientX-Po.clientX+s.x)/(o||1)+(c?c[0]-Dg[0]:0)/(o||1),f=(i.clientY-Po.clientY+s.y)/(l||1)+(c?c[1]-Dg[1]:0)/(l||1);if(!wt.active&&!ql){if(n&&Math.max(Math.abs(i.clientX-this._lastX),Math.abs(i.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Bt){a?(a.e+=u-(Ig||0),a.f+=f-(kg||0)):a={a:1,b:0,c:0,d:1,e:u,f};var h="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");gt(Bt,"webkitTransform",h),gt(Bt,"mozTransform",h),gt(Bt,"msTransform",h),gt(Bt,"transform",h),Ig=u,kg=f,na=i}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Bt){var e=this.options.fallbackOnBody?document.body:kr,r=Pr(rt,!0,i0,!0,e),n=this.options;if(i0){for(Hn=e;gt(Hn,"position")==="static"&&gt(Hn,"transform")==="none"&&Hn!==document;)Hn=Hn.parentNode;Hn!==document.body&&Hn!==document.documentElement?(Hn===document&&(Hn=La()),r.top+=Hn.scrollTop,r.left+=Hn.scrollLeft):Hn=La(),Dg=$S(Hn)}Bt=rt.cloneNode(!0),Fr(Bt,n.ghostClass,!1),Fr(Bt,n.fallbackClass,!0),Fr(Bt,n.dragClass,!0),gt(Bt,"transition",""),gt(Bt,"transform",""),gt(Bt,"box-sizing","border-box"),gt(Bt,"margin",0),gt(Bt,"top",r.top),gt(Bt,"left",r.left),gt(Bt,"width",r.width),gt(Bt,"height",r.height),gt(Bt,"opacity","0.8"),gt(Bt,"position",i0?"absolute":"fixed"),gt(Bt,"zIndex","100000"),gt(Bt,"pointerEvents","none"),wt.ghost=Bt,e.appendChild(Bt),gt(Bt,"transform-origin",HS/parseInt(Bt.style.width)*100+"% "+jS/parseInt(Bt.style.height)*100+"%")}},_onDragStart:function(e,r){var n=this,s=e.dataTransfer,i=n.options;if(gs("dragStart",this,{evt:e}),wt.eventCanceled){this._onDrop();return}gs("setupClone",this),wt.eventCanceled||(Br=Fx(rt),Br.draggable=!1,Br.style["will-change"]="",this._hideClone(),Fr(Br,this.options.chosenClass,!1),wt.clone=Br),n.cloneId=O0(function(){gs("clone",n),!wt.eventCanceled&&(n.options.removeCloneOnHide||kr.insertBefore(Br,rt),n._hideClone(),is({sortable:n,name:"clone"}))}),!r&&Fr(rt,i.dragClass,!0),r?(Oh=!0,n._loopId=setInterval(n._emulateDragOver,50)):(Wt(document,"mouseup",n._onDrop),Wt(document,"touchend",n._onDrop),Wt(document,"touchcancel",n._onDrop),s&&(s.effectAllowed="move",i.setData&&i.setData.call(n,s,rt)),Kt(document,"drop",n),gt(rt,"transform","translateZ(0)")),ql=!0,n._dragStartId=O0(n._dragStarted.bind(n,r,e)),Kt(document,"selectstart",n),Cu=!0,nd&&gt(document.body,"user-select","none")},_onDragOver:function(e){var r=this.el,n=e.target,s,i,a,o=this.options,l=o.group,c=wt.active,u=s0===l,f=o.sort,h=Tn||c,p,g=this,y=!1;if(t1)return;function E(M,O){gs(M,g,Ha({evt:e,isOwner:u,axis:p?"vertical":"horizontal",revert:a,dragRect:s,targetRect:i,canSort:f,fromSortable:h,target:n,completed:_,onMove:function(z,j){return o0(kr,r,rt,s,z,Pr(z),e,j)},changed:v},O))}function b(){E("dragOverAnimationCapture"),g.captureAnimationState(),g!==h&&h.captureAnimationState()}function _(M){return E("dragOverCompleted",{insertion:M}),M&&(u?c._hideClone():c._showClone(g),g!==h&&(Fr(rt,Tn?Tn.options.ghostClass:c.options.ghostClass,!1),Fr(rt,o.ghostClass,!0)),Tn!==g&&g!==wt.active?Tn=g:g===wt.active&&Tn&&(Tn=null),h===g&&(g._ignoreWhileAnimating=n),g.animateAll(function(){E("dragOverAnimationComplete"),g._ignoreWhileAnimating=null}),g!==h&&(h.animateAll(),h._ignoreWhileAnimating=null)),(n===rt&&!rt.animated||n===r&&!n.animated)&&(Bl=null),!o.dragoverBubble&&!e.rootEl&&n!==document&&(rt.parentNode[Xn]._isOutsideThisEl(e.target),!M&&Ro(e)),!o.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),y=!0}function v(){Is=$r(rt),Ki=$r(rt,o.draggable),is({sortable:g,name:"change",toEl:r,newIndex:Is,newDraggableIndex:Ki,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),n=aa(n,o.draggable,r,!0),E("dragOver"),wt.eventCanceled)return y;if(rt.contains(e.target)||n.animated&&n.animatingX&&n.animatingY||g._ignoreWhileAnimating===n)return _(!1);if(Oh=!1,c&&!o.disabled&&(u?f||(a=Lr!==kr):Tn===this||(this.lastPutMode=s0.checkPull(this,c,rt,e))&&l.checkPut(this,c,rt,e))){if(p=this._getDirection(e,n)==="vertical",s=Pr(rt),E("dragOverValid"),wt.eventCanceled)return y;if(a)return Lr=kr,b(),this._hideClone(),E("revert"),wt.eventCanceled||(Oo?kr.insertBefore(rt,Oo):kr.appendChild(rt)),_(!0);var A=Rx(r,o.draggable);if(!A||ole(e,p,this)&&!A.animated){if(A===rt)return _(!1);if(A&&r===e.target&&(n=A),n&&(i=Pr(n)),o0(kr,r,rt,s,n,i,e,!!n)!==!1)return b(),r.appendChild(rt),Lr=r,v(),_(!0)}else if(A&&ile(e,p,this)){var D=Nc(r,0,o,!0);if(D===rt)return _(!1);if(n=D,i=Pr(n),o0(kr,r,rt,s,n,i,e,!1)!==!1)return b(),r.insertBefore(rt,D),Lr=r,v(),_(!0)}else if(n.parentNode===r){i=Pr(n);var k=0,T,x=rt.parentNode!==r,m=!tle(rt.animated&&rt.toRect||s,n.animated&&n.toRect||i,p),S=p?"top":"left",I=US(n,"top","top")||US(rt,"top","top"),C=I?I.scrollTop:void 0;Bl!==n&&(T=i[S],od=!1,a0=!m&&o.invertSwap||x),k=lle(e,n,i,p,m?1:o.swapThreshold,o.invertedSwapThreshold==null?o.swapThreshold:o.invertedSwapThreshold,a0,Bl===n);var F;if(k!==0){var W=$r(rt);do W-=k,F=Lr.children[W];while(F&&(gt(F,"display")==="none"||F===Bt))}if(k===0||F===n)return _(!1);Bl=n,id=k;var P=n.nextElementSibling,R=!1;R=k===1;var N=o0(kr,r,rt,s,n,i,e,R);if(N!==!1)return(N===1||N===-1)&&(R=N===1),t1=!0,setTimeout(ale,30),b(),R&&!P?r.appendChild(rt):n.parentNode.insertBefore(rt,R?P:n),I&&fD(I,0,C-I.scrollTop),Lr=rt.parentNode,T!==void 0&&!a0&&(N0=Math.abs(T-Pr(n)[S])),v(),_(!0)}if(r.contains(rt))return _(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Wt(document,"mousemove",this._onTouchMove),Wt(document,"touchmove",this._onTouchMove),Wt(document,"pointermove",this._onTouchMove),Wt(document,"dragover",Ro),Wt(document,"mousemove",Ro),Wt(document,"touchmove",Ro)},_offUpEvents:function(){var e=this.el.ownerDocument;Wt(e,"mouseup",this._onDrop),Wt(e,"touchend",this._onDrop),Wt(e,"pointerup",this._onDrop),Wt(e,"touchcancel",this._onDrop),Wt(document,"selectstart",this)},_onDrop:function(e){var r=this.el,n=this.options;if(Is=$r(rt),Ki=$r(rt,n.draggable),gs("drop",this,{evt:e}),Lr=rt&&rt.parentNode,Is=$r(rt),Ki=$r(rt,n.draggable),wt.eventCanceled){this._nulling();return}ql=!1,a0=!1,od=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),r1(this.cloneId),r1(this._dragStartId),this.nativeDraggable&&(Wt(document,"drop",this),Wt(r,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),nd&&gt(document.body,"user-select",""),gt(rt,"transform",""),e&&(Cu&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Bt&&Bt.parentNode&&Bt.parentNode.removeChild(Bt),(kr===Lr||Tn&&Tn.lastPutMode!=="clone")&&Br&&Br.parentNode&&Br.parentNode.removeChild(Br),rt&&(this.nativeDraggable&&Wt(rt,"dragend",this),Pg(rt),rt.style["will-change"]="",Cu&&!ql&&Fr(rt,Tn?Tn.options.ghostClass:this.options.ghostClass,!1),Fr(rt,this.options.chosenClass,!1),is({sortable:this,name:"unchoose",toEl:Lr,newIndex:null,newDraggableIndex:null,originalEvent:e}),kr!==Lr?(Is>=0&&(is({rootEl:Lr,name:"add",toEl:Lr,fromEl:kr,originalEvent:e}),is({sortable:this,name:"remove",toEl:Lr,originalEvent:e}),is({rootEl:Lr,name:"sort",toEl:Lr,fromEl:kr,originalEvent:e}),is({sortable:this,name:"sort",toEl:Lr,originalEvent:e})),Tn&&Tn.save()):Is!==Jl&&Is>=0&&(is({sortable:this,name:"update",toEl:Lr,originalEvent:e}),is({sortable:this,name:"sort",toEl:Lr,originalEvent:e})),wt.active&&((Is==null||Is===-1)&&(Is=Jl,Ki=ad),is({sortable:this,name:"end",toEl:Lr,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){gs("nulling",this),kr=rt=Lr=Bt=Oo=Br=F0=Yi=Po=na=Cu=Is=Ki=Jl=ad=Bl=id=Tn=s0=wt.dragged=wt.ghost=wt.clone=wt.active=null,Lh.forEach(function(e){e.checked=!0}),Lh.length=Ig=kg=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":rt&&(this._onDragOver(e),sle(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],r,n=this.el.children,s=0,i=n.length,a=this.options;s<i;s++)r=n[s],aa(r,a.draggable,this.el,!1)&&e.push(r.getAttribute(a.dataIdAttr)||ule(r));return e},sort:function(e,r){var n={},s=this.el;this.toArray().forEach(function(i,a){var o=s.children[a];aa(o,this.options.draggable,s,!1)&&(n[i]=o)},this),r&&this.captureAnimationState(),e.forEach(function(i){n[i]&&(s.removeChild(n[i]),s.appendChild(n[i]))}),r&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,r){return aa(e,r||this.options.draggable,this.el,!1)},option:function(e,r){var n=this.options;if(r===void 0)return n[e];var s=pf.modifyOption(this,e,r);typeof s<"u"?n[e]=s:n[e]=r,e==="group"&&mD(n)},destroy:function(){gs("destroy",this);var e=this.el;e[Xn]=null,Wt(e,"mousedown",this._onTapStart),Wt(e,"touchstart",this._onTapStart),Wt(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(Wt(e,"dragover",this),Wt(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(r){r.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Mh.splice(Mh.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Yi){if(gs("hideClone",this),wt.eventCanceled)return;gt(Br,"display","none"),this.options.removeCloneOnHide&&Br.parentNode&&Br.parentNode.removeChild(Br),Yi=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Yi){if(gs("showClone",this),wt.eventCanceled)return;rt.parentNode==kr&&!this.options.group.revertClone?kr.insertBefore(Br,rt):Oo?kr.insertBefore(Br,Oo):kr.appendChild(Br),this.options.group.revertClone&&this.animate(rt,Br),gt(Br,"display",""),Yi=!1}}};function sle(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function o0(t,e,r,n,s,i,a,o){var l,c=t[Xn],u=c.options.onMove,f;return window.CustomEvent&&!Ri&&!hf?l=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(l=document.createEvent("Event"),l.initEvent("move",!0,!0)),l.to=e,l.from=t,l.dragged=r,l.draggedRect=n,l.related=s||e,l.relatedRect=i||Pr(e),l.willInsertAfter=o,l.originalEvent=a,t.dispatchEvent(l),u&&(f=u.call(c,l,a)),f}function Pg(t){t.draggable=!1}function ale(){t1=!1}function ile(t,e,r){var n=Pr(Nc(r.el,0,r.options,!0)),s=10;return e?t.clientX<n.left-s||t.clientY<n.top&&t.clientX<n.right:t.clientY<n.top-s||t.clientY<n.bottom&&t.clientX<n.left}function ole(t,e,r){var n=Pr(Rx(r.el,r.options.draggable)),s=10;return e?t.clientX>n.right+s||t.clientX<=n.right&&t.clientY>n.bottom&&t.clientX>=n.left:t.clientX>n.right&&t.clientY>n.top||t.clientX<=n.right&&t.clientY>n.bottom+s}function lle(t,e,r,n,s,i,a,o){var l=n?t.clientY:t.clientX,c=n?r.height:r.width,u=n?r.top:r.left,f=n?r.bottom:r.right,h=!1;if(!a){if(o&&N0<c*s){if(!od&&(id===1?l>u+c*i/2:l<f-c*i/2)&&(od=!0),od)h=!0;else if(id===1?l<u+N0:l>f-N0)return-id}else if(l>u+c*(1-s)/2&&l<f-c*(1-s)/2)return cle(e)}return h=h||a,h&&(l<u+c*i/2||l>f-c*i/2)?l>u+c/2?1:-1:0}function cle(t){return $r(rt)<$r(t)?1:-1}function ule(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,r=e.length,n=0;r--;)n+=e.charCodeAt(r);return n.toString(36)}function dle(t){Lh.length=0;for(var e=t.getElementsByTagName("input"),r=e.length;r--;){var n=e[r];n.checked&&Lh.push(n)}}function O0(t){return setTimeout(t,0)}function r1(t){return clearTimeout(t)}Gp&&Kt(document,"touchmove",function(t){(wt.active||ql)&&t.cancelable&&t.preventDefault()});wt.utils={on:Kt,off:Wt,css:gt,find:uD,is:function(e,r){return!!aa(e,r,e,!1)},extend:qoe,throttle:dD,closest:aa,toggleClass:Fr,clone:Fx,index:$r,nextTick:O0,cancelNextTick:r1,detectDirection:pD,getChild:Nc};wt.get=function(t){return t[Xn]};wt.mount=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];e[0].constructor===Array&&(e=e[0]),e.forEach(function(n){if(!n.prototype||!n.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(n));n.utils&&(wt.utils=Ha(Ha({},wt.utils),n.utils)),pf.mount(n)})};wt.create=function(t,e){return new wt(t,e)};wt.version=Goe;var Zr=[],Iu,n1,s1=!1,Rg,Fg,Bh,ku;function fle(){function t(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return t.prototype={dragStarted:function(r){var n=r.originalEvent;this.sortable.nativeDraggable?Kt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?Kt(document,"pointermove",this._handleFallbackAutoScroll):n.touches?Kt(document,"touchmove",this._handleFallbackAutoScroll):Kt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(r){var n=r.originalEvent;!this.options.dragOverBubble&&!n.rootEl&&this._handleAutoScroll(n)},drop:function(){this.sortable.nativeDraggable?Wt(document,"dragover",this._handleAutoScroll):(Wt(document,"pointermove",this._handleFallbackAutoScroll),Wt(document,"touchmove",this._handleFallbackAutoScroll),Wt(document,"mousemove",this._handleFallbackAutoScroll)),WS(),M0(),Xoe()},nulling:function(){Bh=n1=Iu=s1=ku=Rg=Fg=null,Zr.length=0},_handleFallbackAutoScroll:function(r){this._handleAutoScroll(r,!0)},_handleAutoScroll:function(r,n){var s=this,i=(r.touches?r.touches[0]:r).clientX,a=(r.touches?r.touches[0]:r).clientY,o=document.elementFromPoint(i,a);if(Bh=r,n||this.options.forceAutoScrollFallback||hf||Ri||nd){Ng(r,this.options,o,n);var l=eo(o,!0);s1&&(!ku||i!==Rg||a!==Fg)&&(ku&&WS(),ku=setInterval(function(){var c=eo(document.elementFromPoint(i,a),!0);c!==l&&(l=c,M0()),Ng(r,s.options,c,n)},10),Rg=i,Fg=a)}else{if(!this.options.bubbleScroll||eo(o,!0)===La()){M0();return}Ng(r,this.options,eo(o,!1),!1)}}},qs(t,{pluginName:"scroll",initializeByDefault:!0})}function M0(){Zr.forEach(function(t){clearInterval(t.pid)}),Zr=[]}function WS(){clearInterval(ku)}var Ng=dD(function(t,e,r,n){if(e.scroll){var s=(t.touches?t.touches[0]:t).clientX,i=(t.touches?t.touches[0]:t).clientY,a=e.scrollSensitivity,o=e.scrollSpeed,l=La(),c=!1,u;n1!==r&&(n1=r,M0(),Iu=e.scroll,u=e.scrollFn,Iu===!0&&(Iu=eo(r,!0)));var f=0,h=Iu;do{var p=h,g=Pr(p),y=g.top,E=g.bottom,b=g.left,_=g.right,v=g.width,A=g.height,D=void 0,k=void 0,T=p.scrollWidth,x=p.scrollHeight,m=gt(p),S=p.scrollLeft,I=p.scrollTop;p===l?(D=v<T&&(m.overflowX==="auto"||m.overflowX==="scroll"||m.overflowX==="visible"),k=A<x&&(m.overflowY==="auto"||m.overflowY==="scroll"||m.overflowY==="visible")):(D=v<T&&(m.overflowX==="auto"||m.overflowX==="scroll"),k=A<x&&(m.overflowY==="auto"||m.overflowY==="scroll"));var C=D&&(Math.abs(_-s)<=a&&S+v<T)-(Math.abs(b-s)<=a&&!!S),F=k&&(Math.abs(E-i)<=a&&I+A<x)-(Math.abs(y-i)<=a&&!!I);if(!Zr[f])for(var W=0;W<=f;W++)Zr[W]||(Zr[W]={});(Zr[f].vx!=C||Zr[f].vy!=F||Zr[f].el!==p)&&(Zr[f].el=p,Zr[f].vx=C,Zr[f].vy=F,clearInterval(Zr[f].pid),(C!=0||F!=0)&&(c=!0,Zr[f].pid=setInterval((function(){n&&this.layer===0&&wt.active._onTouchMove(Bh);var P=Zr[this.layer].vy?Zr[this.layer].vy*o:0,R=Zr[this.layer].vx?Zr[this.layer].vx*o:0;typeof u=="function"&&u.call(wt.dragged.parentNode[Xn],R,P,t,Bh,Zr[this.layer].el)!=="continue"||fD(Zr[this.layer].el,R,P)}).bind({layer:f}),24))),f++}while(e.bubbleScroll&&h!==l&&(h=eo(h,!1)));s1=c}},30),yD=function(e){var r=e.originalEvent,n=e.putSortable,s=e.dragEl,i=e.activeSortable,a=e.dispatchSortableEvent,o=e.hideGhostForTarget,l=e.unhideGhostForTarget;if(r){var c=n||i;o();var u=r.changedTouches&&r.changedTouches.length?r.changedTouches[0]:r,f=document.elementFromPoint(u.clientX,u.clientY);l(),c&&!c.el.contains(f)&&(a("spill"),this.onSpill({dragEl:s,putSortable:n}))}};function Nx(){}Nx.prototype={startIndex:null,dragStart:function(e){var r=e.oldDraggableIndex;this.startIndex=r},onSpill:function(e){var r=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var s=Nc(this.sortable.el,this.startIndex,this.options);s?this.sortable.el.insertBefore(r,s):this.sortable.el.appendChild(r),this.sortable.animateAll(),n&&n.animateAll()},drop:yD};qs(Nx,{pluginName:"revertOnSpill"});function Ox(){}Ox.prototype={onSpill:function(e){var r=e.dragEl,n=e.putSortable,s=n||this.sortable;s.captureAnimationState(),r.parentNode&&r.parentNode.removeChild(r),s.animateAll()},drop:yD};qs(Ox,{pluginName:"removeOnSpill"});var Us;function hle(){function t(){this.defaults={swapClass:"sortable-swap-highlight"}}return t.prototype={dragStart:function(r){var n=r.dragEl;Us=n},dragOverValid:function(r){var n=r.completed,s=r.target,i=r.onMove,a=r.activeSortable,o=r.changed,l=r.cancel;if(a.options.swap){var c=this.sortable.el,u=this.options;if(s&&s!==c){var f=Us;i(s)!==!1?(Fr(s,u.swapClass,!0),Us=s):Us=null,f&&f!==Us&&Fr(f,u.swapClass,!1)}o(),n(!0),l()}},drop:function(r){var n=r.activeSortable,s=r.putSortable,i=r.dragEl,a=s||this.sortable,o=this.options;Us&&Fr(Us,o.swapClass,!1),Us&&(o.swap||s&&s.options.swap)&&i!==Us&&(a.captureAnimationState(),a!==n&&n.captureAnimationState(),ple(i,Us),a.animateAll(),a!==n&&n.animateAll())},nulling:function(){Us=null}},qs(t,{pluginName:"swap",eventProperties:function(){return{swapItem:Us}}})}function ple(t,e){var r=t.parentNode,n=e.parentNode,s,i;!r||!n||r.isEqualNode(e)||n.isEqualNode(t)||(s=$r(t),i=$r(e),r.isEqualNode(n)&&s<i&&i++,r.insertBefore(e,r.children[s]),n.insertBefore(t,n.children[i]))}var Nt=[],Cs=[],fu,sa,hu=!1,vs=!1,Ul=!1,Er,pu,l0;function mle(){function t(e){for(var r in this)r.charAt(0)==="_"&&typeof this[r]=="function"&&(this[r]=this[r].bind(this));e.options.supportPointer?Kt(document,"pointerup",this._deselectMultiDrag):(Kt(document,"mouseup",this._deselectMultiDrag),Kt(document,"touchend",this._deselectMultiDrag)),Kt(document,"keydown",this._checkKeyDown),Kt(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(s,i){var a="";Nt.length&&sa===e?Nt.forEach(function(o,l){a+=(l?", ":"")+o.textContent}):a=i.textContent,s.setData("Text",a)}}}return t.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(r){var n=r.dragEl;Er=n},delayEnded:function(){this.isMultiDrag=~Nt.indexOf(Er)},setupClone:function(r){var n=r.sortable,s=r.cancel;if(this.isMultiDrag){for(var i=0;i<Nt.length;i++)Cs.push(Fx(Nt[i])),Cs[i].sortableIndex=Nt[i].sortableIndex,Cs[i].draggable=!1,Cs[i].style["will-change"]="",Fr(Cs[i],this.options.selectedClass,!1),Nt[i]===Er&&Fr(Cs[i],this.options.chosenClass,!1);n._hideClone(),s()}},clone:function(r){var n=r.sortable,s=r.rootEl,i=r.dispatchSortableEvent,a=r.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||Nt.length&&sa===n&&(zS(!0,s),i("clone"),a()))},showClone:function(r){var n=r.cloneNowShown,s=r.rootEl,i=r.cancel;this.isMultiDrag&&(zS(!1,s),Cs.forEach(function(a){gt(a,"display","")}),n(),l0=!1,i())},hideClone:function(r){var n=this;r.sortable;var s=r.cloneNowHidden,i=r.cancel;this.isMultiDrag&&(Cs.forEach(function(a){gt(a,"display","none"),n.options.removeCloneOnHide&&a.parentNode&&a.parentNode.removeChild(a)}),s(),l0=!0,i())},dragStartGlobal:function(r){r.sortable,!this.isMultiDrag&&sa&&sa.multiDrag._deselectMultiDrag(),Nt.forEach(function(n){n.sortableIndex=$r(n)}),Nt=Nt.sort(function(n,s){return n.sortableIndex-s.sortableIndex}),Ul=!0},dragStarted:function(r){var n=this,s=r.sortable;if(this.isMultiDrag){if(this.options.sort&&(s.captureAnimationState(),this.options.animation)){Nt.forEach(function(a){a!==Er&&gt(a,"position","absolute")});var i=Pr(Er,!1,!0,!0);Nt.forEach(function(a){a!==Er&&VS(a,i)}),vs=!0,hu=!0}s.animateAll(function(){vs=!1,hu=!1,n.options.animation&&Nt.forEach(function(a){wg(a)}),n.options.sort&&c0()})}},dragOver:function(r){var n=r.target,s=r.completed,i=r.cancel;vs&&~Nt.indexOf(n)&&(s(!1),i())},revert:function(r){var n=r.fromSortable,s=r.rootEl,i=r.sortable,a=r.dragRect;Nt.length>1&&(Nt.forEach(function(o){i.addAnimationState({target:o,rect:vs?Pr(o):a}),wg(o),o.fromRect=a,n.removeAnimationState(o)}),vs=!1,gle(!this.options.removeCloneOnHide,s))},dragOverCompleted:function(r){var n=r.sortable,s=r.isOwner,i=r.insertion,a=r.activeSortable,o=r.parentEl,l=r.putSortable,c=this.options;if(i){if(s&&a._hideClone(),hu=!1,c.animation&&Nt.length>1&&(vs||!s&&!a.options.sort&&!l)){var u=Pr(Er,!1,!0,!0);Nt.forEach(function(h){h!==Er&&(VS(h,u),o.appendChild(h))}),vs=!0}if(!s)if(vs||c0(),Nt.length>1){var f=l0;a._showClone(n),a.options.animation&&!l0&&f&&Cs.forEach(function(h){a.addAnimationState({target:h,rect:pu}),h.fromRect=pu,h.thisAnimationDuration=null})}else a._showClone(n)}},dragOverAnimationCapture:function(r){var n=r.dragRect,s=r.isOwner,i=r.activeSortable;if(Nt.forEach(function(o){o.thisAnimationDuration=null}),i.options.animation&&!s&&i.multiDrag.isMultiDrag){pu=qs({},n);var a=Qo(Er,!0);pu.top-=a.f,pu.left-=a.e}},dragOverAnimationComplete:function(){vs&&(vs=!1,c0())},drop:function(r){var n=r.originalEvent,s=r.rootEl,i=r.parentEl,a=r.sortable,o=r.dispatchSortableEvent,l=r.oldIndex,c=r.putSortable,u=c||this.sortable;if(n){var f=this.options,h=i.children;if(!Ul)if(f.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),Fr(Er,f.selectedClass,!~Nt.indexOf(Er)),~Nt.indexOf(Er))Nt.splice(Nt.indexOf(Er),1),fu=null,wu({sortable:a,rootEl:s,name:"deselect",targetEl:Er});else{if(Nt.push(Er),wu({sortable:a,rootEl:s,name:"select",targetEl:Er}),n.shiftKey&&fu&&a.el.contains(fu)){var p=$r(fu),g=$r(Er);if(~p&&~g&&p!==g){var y,E;for(g>p?(E=p,y=g):(E=g,y=p+1);E<y;E++)~Nt.indexOf(h[E])||(Fr(h[E],f.selectedClass,!0),Nt.push(h[E]),wu({sortable:a,rootEl:s,name:"select",targetEl:h[E]}))}}else fu=Er;sa=u}if(Ul&&this.isMultiDrag){if(vs=!1,(i[Xn].options.sort||i!==s)&&Nt.length>1){var b=Pr(Er),_=$r(Er,":not(."+this.options.selectedClass+")");if(!hu&&f.animation&&(Er.thisAnimationDuration=null),u.captureAnimationState(),!hu&&(f.animation&&(Er.fromRect=b,Nt.forEach(function(A){if(A.thisAnimationDuration=null,A!==Er){var D=vs?Pr(A):b;A.fromRect=D,u.addAnimationState({target:A,rect:D})}})),c0(),Nt.forEach(function(A){h[_]?i.insertBefore(A,h[_]):i.appendChild(A),_++}),l===$r(Er))){var v=!1;Nt.forEach(function(A){if(A.sortableIndex!==$r(A)){v=!0;return}}),v&&o("update")}Nt.forEach(function(A){wg(A)}),u.animateAll()}sa=u}(s===i||c&&c.lastPutMode!=="clone")&&Cs.forEach(function(A){A.parentNode&&A.parentNode.removeChild(A)})}},nullingGlobal:function(){this.isMultiDrag=Ul=!1,Cs.length=0},destroyGlobal:function(){this._deselectMultiDrag(),Wt(document,"pointerup",this._deselectMultiDrag),Wt(document,"mouseup",this._deselectMultiDrag),Wt(document,"touchend",this._deselectMultiDrag),Wt(document,"keydown",this._checkKeyDown),Wt(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(r){if(!(typeof Ul<"u"&&Ul)&&sa===this.sortable&&!(r&&aa(r.target,this.options.draggable,this.sortable.el,!1))&&!(r&&r.button!==0))for(;Nt.length;){var n=Nt[0];Fr(n,this.options.selectedClass,!1),Nt.shift(),wu({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:n})}},_checkKeyDown:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(r){r.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},qs(t,{pluginName:"multiDrag",utils:{select:function(r){var n=r.parentNode[Xn];!n||!n.options.multiDrag||~Nt.indexOf(r)||(sa&&sa!==n&&(sa.multiDrag._deselectMultiDrag(),sa=n),Fr(r,n.options.selectedClass,!0),Nt.push(r))},deselect:function(r){var n=r.parentNode[Xn],s=Nt.indexOf(r);!n||!n.options.multiDrag||!~s||(Fr(r,n.options.selectedClass,!1),Nt.splice(s,1))}},eventProperties:function(){var r=this,n=[],s=[];return Nt.forEach(function(i){n.push({multiDragElement:i,index:i.sortableIndex});var a;vs&&i!==Er?a=-1:vs?a=$r(i,":not(."+r.options.selectedClass+")"):a=$r(i),s.push({multiDragElement:i,index:a})}),{items:Uoe(Nt),clones:[].concat(Cs),oldIndicies:n,newIndicies:s}},optionListeners:{multiDragKey:function(r){return r=r.toLowerCase(),r==="ctrl"?r="Control":r.length>1&&(r=r.charAt(0).toUpperCase()+r.substr(1)),r}}})}function gle(t,e){Nt.forEach(function(r,n){var s=e.children[r.sortableIndex+(t?Number(n):0)];s?e.insertBefore(r,s):e.appendChild(r)})}function zS(t,e){Cs.forEach(function(r,n){var s=e.children[r.sortableIndex+(t?Number(n):0)];s?e.insertBefore(r,s):e.appendChild(r)})}function c0(){Nt.forEach(function(t){t!==Er&&t.parentNode&&t.parentNode.removeChild(t)})}wt.mount(new fle);wt.mount(Ox,Nx);const vle=Object.freeze(Object.defineProperty({__proto__:null,MultiDrag:mle,Sortable:wt,Swap:hle,default:wt},Symbol.toStringTag,{value:"Module"})),yle=ex(vle);(function(t,e){(function(n,s){t.exports=s(Ooe,yle)})(typeof self<"u"?self:Vt,function(r,n){return function(s){var i={};function a(o){if(i[o])return i[o].exports;var l=i[o]={i:o,l:!1,exports:{}};return s[o].call(l.exports,l,l.exports,a),l.l=!0,l.exports}return a.m=s,a.c=i,a.d=function(o,l,c){a.o(o,l)||Object.defineProperty(o,l,{enumerable:!0,get:c})},a.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},a.t=function(o,l){if(l&1&&(o=a(o)),l&8||l&4&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(a.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),l&2&&typeof o!="string")for(var u in o)a.d(c,u,(function(f){return o[f]}).bind(null,u));return c},a.n=function(o){var l=o&&o.__esModule?function(){return o.default}:function(){return o};return a.d(l,"a",l),l},a.o=function(o,l){return Object.prototype.hasOwnProperty.call(o,l)},a.p="",a(a.s="fb15")}({"00ee":function(s,i,a){var o=a("b622"),l=o("toStringTag"),c={};c[l]="z",s.exports=String(c)==="[object z]"},"0366":function(s,i,a){var o=a("1c0b");s.exports=function(l,c,u){if(o(l),c===void 0)return l;switch(u){case 0:return function(){return l.call(c)};case 1:return function(f){return l.call(c,f)};case 2:return function(f,h){return l.call(c,f,h)};case 3:return function(f,h,p){return l.call(c,f,h,p)}}return function(){return l.apply(c,arguments)}}},"057f":function(s,i,a){var o=a("fc6a"),l=a("241c").f,c={}.toString,u=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],f=function(h){try{return l(h)}catch{return u.slice()}};s.exports.f=function(p){return u&&c.call(p)=="[object Window]"?f(p):l(o(p))}},"06cf":function(s,i,a){var o=a("83ab"),l=a("d1e7"),c=a("5c6c"),u=a("fc6a"),f=a("c04e"),h=a("5135"),p=a("0cfb"),g=Object.getOwnPropertyDescriptor;i.f=o?g:function(E,b){if(E=u(E),b=f(b,!0),p)try{return g(E,b)}catch{}if(h(E,b))return c(!l.f.call(E,b),E[b])}},"0cfb":function(s,i,a){var o=a("83ab"),l=a("d039"),c=a("cc12");s.exports=!o&&!l(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!=7})},"13d5":function(s,i,a){var o=a("23e7"),l=a("d58f").left,c=a("a640"),u=a("ae40"),f=c("reduce"),h=u("reduce",{1:0});o({target:"Array",proto:!0,forced:!f||!h},{reduce:function(g){return l(this,g,arguments.length,arguments.length>1?arguments[1]:void 0)}})},"14c3":function(s,i,a){var o=a("c6b6"),l=a("9263");s.exports=function(c,u){var f=c.exec;if(typeof f=="function"){var h=f.call(c,u);if(typeof h!="object")throw TypeError("RegExp exec method returned something other than an Object or null");return h}if(o(c)!=="RegExp")throw TypeError("RegExp#exec called on incompatible receiver");return l.call(c,u)}},"159b":function(s,i,a){var o=a("da84"),l=a("fdbc"),c=a("17c2"),u=a("9112");for(var f in l){var h=o[f],p=h&&h.prototype;if(p&&p.forEach!==c)try{u(p,"forEach",c)}catch{p.forEach=c}}},"17c2":function(s,i,a){var o=a("b727").forEach,l=a("a640"),c=a("ae40"),u=l("forEach"),f=c("forEach");s.exports=!u||!f?function(p){return o(this,p,arguments.length>1?arguments[1]:void 0)}:[].forEach},"1be4":function(s,i,a){var o=a("d066");s.exports=o("document","documentElement")},"1c0b":function(s,i){s.exports=function(a){if(typeof a!="function")throw TypeError(String(a)+" is not a function");return a}},"1c7e":function(s,i,a){var o=a("b622"),l=o("iterator"),c=!1;try{var u=0,f={next:function(){return{done:!!u++}},return:function(){c=!0}};f[l]=function(){return this},Array.from(f,function(){throw 2})}catch{}s.exports=function(h,p){if(!p&&!c)return!1;var g=!1;try{var y={};y[l]=function(){return{next:function(){return{done:g=!0}}}},h(y)}catch{}return g}},"1d80":function(s,i){s.exports=function(a){if(a==null)throw TypeError("Can't call method on "+a);return a}},"1dde":function(s,i,a){var o=a("d039"),l=a("b622"),c=a("2d00"),u=l("species");s.exports=function(f){return c>=51||!o(function(){var h=[],p=h.constructor={};return p[u]=function(){return{foo:1}},h[f](Boolean).foo!==1})}},"23cb":function(s,i,a){var o=a("a691"),l=Math.max,c=Math.min;s.exports=function(u,f){var h=o(u);return h<0?l(h+f,0):c(h,f)}},"23e7":function(s,i,a){var o=a("da84"),l=a("06cf").f,c=a("9112"),u=a("6eeb"),f=a("ce4e"),h=a("e893"),p=a("94ca");s.exports=function(g,y){var E=g.target,b=g.global,_=g.stat,v,A,D,k,T,x;if(b?A=o:_?A=o[E]||f(E,{}):A=(o[E]||{}).prototype,A)for(D in y){if(T=y[D],g.noTargetGet?(x=l(A,D),k=x&&x.value):k=A[D],v=p(b?D:E+(_?".":"#")+D,g.forced),!v&&k!==void 0){if(typeof T==typeof k)continue;h(T,k)}(g.sham||k&&k.sham)&&c(T,"sham",!0),u(A,D,T,g)}}},"241c":function(s,i,a){var o=a("ca84"),l=a("7839"),c=l.concat("length","prototype");i.f=Object.getOwnPropertyNames||function(f){return o(f,c)}},"25f0":function(s,i,a){var o=a("6eeb"),l=a("825a"),c=a("d039"),u=a("ad6d"),f="toString",h=RegExp.prototype,p=h[f],g=c(function(){return p.call({source:"a",flags:"b"})!="/a/b"}),y=p.name!=f;(g||y)&&o(RegExp.prototype,f,function(){var b=l(this),_=String(b.source),v=b.flags,A=String(v===void 0&&b instanceof RegExp&&!("flags"in h)?u.call(b):v);return"/"+_+"/"+A},{unsafe:!0})},"2ca0":function(s,i,a){var o=a("23e7"),l=a("06cf").f,c=a("50c4"),u=a("5a34"),f=a("1d80"),h=a("ab13"),p=a("c430"),g="".startsWith,y=Math.min,E=h("startsWith"),b=!p&&!E&&!!function(){var _=l(String.prototype,"startsWith");return _&&!_.writable}();o({target:"String",proto:!0,forced:!b&&!E},{startsWith:function(v){var A=String(f(this));u(v);var D=c(y(arguments.length>1?arguments[1]:void 0,A.length)),k=String(v);return g?g.call(A,k,D):A.slice(D,D+k.length)===k}})},"2d00":function(s,i,a){var o=a("da84"),l=a("342f"),c=o.process,u=c&&c.versions,f=u&&u.v8,h,p;f?(h=f.split("."),p=h[0]+h[1]):l&&(h=l.match(/Edge\/(\d+)/),(!h||h[1]>=74)&&(h=l.match(/Chrome\/(\d+)/),h&&(p=h[1]))),s.exports=p&&+p},"342f":function(s,i,a){var o=a("d066");s.exports=o("navigator","userAgent")||""},"35a1":function(s,i,a){var o=a("f5df"),l=a("3f8c"),c=a("b622"),u=c("iterator");s.exports=function(f){if(f!=null)return f[u]||f["@@iterator"]||l[o(f)]}},"37e8":function(s,i,a){var o=a("83ab"),l=a("9bf2"),c=a("825a"),u=a("df75");s.exports=o?Object.defineProperties:function(h,p){c(h);for(var g=u(p),y=g.length,E=0,b;y>E;)l.f(h,b=g[E++],p[b]);return h}},"3bbe":function(s,i,a){var o=a("861d");s.exports=function(l){if(!o(l)&&l!==null)throw TypeError("Can't set "+String(l)+" as a prototype");return l}},"3ca3":function(s,i,a){var o=a("6547").charAt,l=a("69f3"),c=a("7dd0"),u="String Iterator",f=l.set,h=l.getterFor(u);c(String,"String",function(p){f(this,{type:u,string:String(p),index:0})},function(){var g=h(this),y=g.string,E=g.index,b;return E>=y.length?{value:void 0,done:!0}:(b=o(y,E),g.index+=b.length,{value:b,done:!1})})},"3f8c":function(s,i){s.exports={}},4160:function(s,i,a){var o=a("23e7"),l=a("17c2");o({target:"Array",proto:!0,forced:[].forEach!=l},{forEach:l})},"428f":function(s,i,a){var o=a("da84");s.exports=o},"44ad":function(s,i,a){var o=a("d039"),l=a("c6b6"),c="".split;s.exports=o(function(){return!Object("z").propertyIsEnumerable(0)})?function(u){return l(u)=="String"?c.call(u,""):Object(u)}:Object},"44d2":function(s,i,a){var o=a("b622"),l=a("7c73"),c=a("9bf2"),u=o("unscopables"),f=Array.prototype;f[u]==null&&c.f(f,u,{configurable:!0,value:l(null)}),s.exports=function(h){f[u][h]=!0}},"44e7":function(s,i,a){var o=a("861d"),l=a("c6b6"),c=a("b622"),u=c("match");s.exports=function(f){var h;return o(f)&&((h=f[u])!==void 0?!!h:l(f)=="RegExp")}},4930:function(s,i,a){var o=a("d039");s.exports=!!Object.getOwnPropertySymbols&&!o(function(){return!String(Symbol())})},"4d64":function(s,i,a){var o=a("fc6a"),l=a("50c4"),c=a("23cb"),u=function(f){return function(h,p,g){var y=o(h),E=l(y.length),b=c(g,E),_;if(f&&p!=p){for(;E>b;)if(_=y[b++],_!=_)return!0}else for(;E>b;b++)if((f||b in y)&&y[b]===p)return f||b||0;return!f&&-1}};s.exports={includes:u(!0),indexOf:u(!1)}},"4de4":function(s,i,a){var o=a("23e7"),l=a("b727").filter,c=a("1dde"),u=a("ae40"),f=c("filter"),h=u("filter");o({target:"Array",proto:!0,forced:!f||!h},{filter:function(g){return l(this,g,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(s,i,a){var o=a("0366"),l=a("7b0b"),c=a("9bdd"),u=a("e95a"),f=a("50c4"),h=a("8418"),p=a("35a1");s.exports=function(y){var E=l(y),b=typeof this=="function"?this:Array,_=arguments.length,v=_>1?arguments[1]:void 0,A=v!==void 0,D=p(E),k=0,T,x,m,S,I,C;if(A&&(v=o(v,_>2?arguments[2]:void 0,2)),D!=null&&!(b==Array&&u(D)))for(S=D.call(E),I=S.next,x=new b;!(m=I.call(S)).done;k++)C=A?c(S,v,[m.value,k],!0):m.value,h(x,k,C);else for(T=f(E.length),x=new b(T);T>k;k++)C=A?v(E[k],k):E[k],h(x,k,C);return x.length=k,x}},"4fad":function(s,i,a){var o=a("23e7"),l=a("6f53").entries;o({target:"Object",stat:!0},{entries:function(u){return l(u)}})},"50c4":function(s,i,a){var o=a("a691"),l=Math.min;s.exports=function(c){return c>0?l(o(c),9007199254740991):0}},5135:function(s,i){var a={}.hasOwnProperty;s.exports=function(o,l){return a.call(o,l)}},5319:function(s,i,a){var o=a("d784"),l=a("825a"),c=a("7b0b"),u=a("50c4"),f=a("a691"),h=a("1d80"),p=a("8aa5"),g=a("14c3"),y=Math.max,E=Math.min,b=Math.floor,_=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g,A=function(D){return D===void 0?D:String(D)};o("replace",2,function(D,k,T,x){var m=x.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,S=x.REPLACE_KEEPS_$0,I=m?"$":"$0";return[function(W,P){var R=h(this),N=W==null?void 0:W[D];return N!==void 0?N.call(W,R,P):k.call(String(R),W,P)},function(F,W){if(!m&&S||typeof W=="string"&&W.indexOf(I)===-1){var P=T(k,F,this,W);if(P.done)return P.value}var R=l(F),N=String(this),M=typeof W=="function";M||(W=String(W));var O=R.global;if(O){var G=R.unicode;R.lastIndex=0}for(var z=[];;){var j=g(R,N);if(j===null||(z.push(j),!O))break;var H=String(j[0]);H===""&&(R.lastIndex=p(N,u(R.lastIndex),G))}for(var V="",te=0,oe=0;oe<z.length;oe++){j=z[oe];for(var ne=String(j[0]),le=y(E(f(j.index),N.length),0),J=[],Q=1;Q<j.length;Q++)J.push(A(j[Q]));var ve=j.groups;if(M){var ee=[ne].concat(J,le,N);ve!==void 0&&ee.push(ve);var K=String(W.apply(void 0,ee))}else K=C(ne,N,le,J,ve,W);le>=te&&(V+=N.slice(te,le)+K,te=le+ne.length)}return V+N.slice(te)}];function C(F,W,P,R,N,M){var O=P+F.length,G=R.length,z=v;return N!==void 0&&(N=c(N),z=_),k.call(M,z,function(j,H){var V;switch(H.charAt(0)){case"$":return"$";case"&":return F;case"`":return W.slice(0,P);case"'":return W.slice(O);case"<":V=N[H.slice(1,-1)];break;default:var te=+H;if(te===0)return j;if(te>G){var oe=b(te/10);return oe===0?j:oe<=G?R[oe-1]===void 0?H.charAt(1):R[oe-1]+H.charAt(1):j}V=R[te-1]}return V===void 0?"":V})}})},5692:function(s,i,a){var o=a("c430"),l=a("c6cd");(s.exports=function(c,u){return l[c]||(l[c]=u!==void 0?u:{})})("versions",[]).push({version:"3.6.5",mode:o?"pure":"global",copyright:"© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(s,i,a){var o=a("d066"),l=a("241c"),c=a("7418"),u=a("825a");s.exports=o("Reflect","ownKeys")||function(h){var p=l.f(u(h)),g=c.f;return g?p.concat(g(h)):p}},"5a34":function(s,i,a){var o=a("44e7");s.exports=function(l){if(o(l))throw TypeError("The method doesn't accept regular expressions");return l}},"5c6c":function(s,i){s.exports=function(a,o){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:o}}},"5db7":function(s,i,a){var o=a("23e7"),l=a("a2bf"),c=a("7b0b"),u=a("50c4"),f=a("1c0b"),h=a("65f0");o({target:"Array",proto:!0},{flatMap:function(g){var y=c(this),E=u(y.length),b;return f(g),b=h(y,0),b.length=l(b,y,y,E,0,1,g,arguments.length>1?arguments[1]:void 0),b}})},6547:function(s,i,a){var o=a("a691"),l=a("1d80"),c=function(u){return function(f,h){var p=String(l(f)),g=o(h),y=p.length,E,b;return g<0||g>=y?u?"":void 0:(E=p.charCodeAt(g),E<55296||E>56319||g+1===y||(b=p.charCodeAt(g+1))<56320||b>57343?u?p.charAt(g):E:u?p.slice(g,g+2):(E-55296<<10)+(b-56320)+65536)}};s.exports={codeAt:c(!1),charAt:c(!0)}},"65f0":function(s,i,a){var o=a("861d"),l=a("e8b5"),c=a("b622"),u=c("species");s.exports=function(f,h){var p;return l(f)&&(p=f.constructor,typeof p=="function"&&(p===Array||l(p.prototype))?p=void 0:o(p)&&(p=p[u],p===null&&(p=void 0))),new(p===void 0?Array:p)(h===0?0:h)}},"69f3":function(s,i,a){var o=a("7f9a"),l=a("da84"),c=a("861d"),u=a("9112"),f=a("5135"),h=a("f772"),p=a("d012"),g=l.WeakMap,y,E,b,_=function(m){return b(m)?E(m):y(m,{})},v=function(m){return function(S){var I;if(!c(S)||(I=E(S)).type!==m)throw TypeError("Incompatible receiver, "+m+" required");return I}};if(o){var A=new g,D=A.get,k=A.has,T=A.set;y=function(m,S){return T.call(A,m,S),S},E=function(m){return D.call(A,m)||{}},b=function(m){return k.call(A,m)}}else{var x=h("state");p[x]=!0,y=function(m,S){return u(m,x,S),S},E=function(m){return f(m,x)?m[x]:{}},b=function(m){return f(m,x)}}s.exports={set:y,get:E,has:b,enforce:_,getterFor:v}},"6eeb":function(s,i,a){var o=a("da84"),l=a("9112"),c=a("5135"),u=a("ce4e"),f=a("8925"),h=a("69f3"),p=h.get,g=h.enforce,y=String(String).split("String");(s.exports=function(E,b,_,v){var A=v?!!v.unsafe:!1,D=v?!!v.enumerable:!1,k=v?!!v.noTargetGet:!1;if(typeof _=="function"&&(typeof b=="string"&&!c(_,"name")&&l(_,"name",b),g(_).source=y.join(typeof b=="string"?b:"")),E===o){D?E[b]=_:u(b,_);return}else A?!k&&E[b]&&(D=!0):delete E[b];D?E[b]=_:l(E,b,_)})(Function.prototype,"toString",function(){return typeof this=="function"&&p(this).source||f(this)})},"6f53":function(s,i,a){var o=a("83ab"),l=a("df75"),c=a("fc6a"),u=a("d1e7").f,f=function(h){return function(p){for(var g=c(p),y=l(g),E=y.length,b=0,_=[],v;E>b;)v=y[b++],(!o||u.call(g,v))&&_.push(h?[v,g[v]]:g[v]);return _}};s.exports={entries:f(!0),values:f(!1)}},"73d9":function(s,i,a){var o=a("44d2");o("flatMap")},7418:function(s,i){i.f=Object.getOwnPropertySymbols},"746f":function(s,i,a){var o=a("428f"),l=a("5135"),c=a("e538"),u=a("9bf2").f;s.exports=function(f){var h=o.Symbol||(o.Symbol={});l(h,f)||u(h,f,{value:c.f(f)})}},7839:function(s,i){s.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(s,i,a){var o=a("1d80");s.exports=function(l){return Object(o(l))}},"7c73":function(s,i,a){var o=a("825a"),l=a("37e8"),c=a("7839"),u=a("d012"),f=a("1be4"),h=a("cc12"),p=a("f772"),g=">",y="<",E="prototype",b="script",_=p("IE_PROTO"),v=function(){},A=function(m){return y+b+g+m+y+"/"+b+g},D=function(m){m.write(A("")),m.close();var S=m.parentWindow.Object;return m=null,S},k=function(){var m=h("iframe"),S="java"+b+":",I;return m.style.display="none",f.appendChild(m),m.src=String(S),I=m.contentWindow.document,I.open(),I.write(A("document.F=Object")),I.close(),I.F},T,x=function(){try{T=document.domain&&new ActiveXObject("htmlfile")}catch{}x=T?D(T):k();for(var m=c.length;m--;)delete x[E][c[m]];return x()};u[_]=!0,s.exports=Object.create||function(S,I){var C;return S!==null?(v[E]=o(S),C=new v,v[E]=null,C[_]=S):C=x(),I===void 0?C:l(C,I)}},"7dd0":function(s,i,a){var o=a("23e7"),l=a("9ed3"),c=a("e163"),u=a("d2bb"),f=a("d44e"),h=a("9112"),p=a("6eeb"),g=a("b622"),y=a("c430"),E=a("3f8c"),b=a("ae93"),_=b.IteratorPrototype,v=b.BUGGY_SAFARI_ITERATORS,A=g("iterator"),D="keys",k="values",T="entries",x=function(){return this};s.exports=function(m,S,I,C,F,W,P){l(I,S,C);var R=function(oe){if(oe===F&&z)return z;if(!v&&oe in O)return O[oe];switch(oe){case D:return function(){return new I(this,oe)};case k:return function(){return new I(this,oe)};case T:return function(){return new I(this,oe)}}return function(){return new I(this)}},N=S+" Iterator",M=!1,O=m.prototype,G=O[A]||O["@@iterator"]||F&&O[F],z=!v&&G||R(F),j=S=="Array"&&O.entries||G,H,V,te;if(j&&(H=c(j.call(new m)),_!==Object.prototype&&H.next&&(!y&&c(H)!==_&&(u?u(H,_):typeof H[A]!="function"&&h(H,A,x)),f(H,N,!0,!0),y&&(E[N]=x))),F==k&&G&&G.name!==k&&(M=!0,z=function(){return G.call(this)}),(!y||P)&&O[A]!==z&&h(O,A,z),E[S]=z,F)if(V={values:R(k),keys:W?z:R(D),entries:R(T)},P)for(te in V)(v||M||!(te in O))&&p(O,te,V[te]);else o({target:S,proto:!0,forced:v||M},V);return V}},"7f9a":function(s,i,a){var o=a("da84"),l=a("8925"),c=o.WeakMap;s.exports=typeof c=="function"&&/native code/.test(l(c))},"825a":function(s,i,a){var o=a("861d");s.exports=function(l){if(!o(l))throw TypeError(String(l)+" is not an object");return l}},"83ab":function(s,i,a){var o=a("d039");s.exports=!o(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7})},8418:function(s,i,a){var o=a("c04e"),l=a("9bf2"),c=a("5c6c");s.exports=function(u,f,h){var p=o(f);p in u?l.f(u,p,c(0,h)):u[p]=h}},"861d":function(s,i){s.exports=function(a){return typeof a=="object"?a!==null:typeof a=="function"}},8875:function(s,i,a){var o,l,c;(function(u,f){l=[],o=f,c=typeof o=="function"?o.apply(i,l):o,c!==void 0&&(s.exports=c)})(typeof self<"u"?self:this,function(){function u(){var f=Object.getOwnPropertyDescriptor(document,"currentScript");if(!f&&"currentScript"in document&&document.currentScript||f&&f.get!==u&&document.currentScript)return document.currentScript;try{throw new Error}catch(T){var h=/.*at [^(]*\((.*):(.+):(.+)\)$/ig,p=/@([^@]*):(\d+):(\d+)\s*$/ig,g=h.exec(T.stack)||p.exec(T.stack),y=g&&g[1]||!1,E=g&&g[2]||!1,b=document.location.href.replace(document.location.hash,""),_,v,A,D=document.getElementsByTagName("script");y===b&&(_=document.documentElement.outerHTML,v=new RegExp("(?:[^\\n]+?\\n){0,"+(E-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),A=_.replace(v,"$1").trim());for(var k=0;k<D.length;k++)if(D[k].readyState==="interactive"||D[k].src===y||y===b&&D[k].innerHTML&&D[k].innerHTML.trim()===A)return D[k];return null}}return u})},8925:function(s,i,a){var o=a("c6cd"),l=Function.toString;typeof o.inspectSource!="function"&&(o.inspectSource=function(c){return l.call(c)}),s.exports=o.inspectSource},"8aa5":function(s,i,a){var o=a("6547").charAt;s.exports=function(l,c,u){return c+(u?o(l,c).length:1)}},"8bbf":function(s,i){s.exports=r},"90e3":function(s,i){var a=0,o=Math.random();s.exports=function(l){return"Symbol("+String(l===void 0?"":l)+")_"+(++a+o).toString(36)}},9112:function(s,i,a){var o=a("83ab"),l=a("9bf2"),c=a("5c6c");s.exports=o?function(u,f,h){return l.f(u,f,c(1,h))}:function(u,f,h){return u[f]=h,u}},9263:function(s,i,a){var o=a("ad6d"),l=a("9f7f"),c=RegExp.prototype.exec,u=String.prototype.replace,f=c,h=function(){var E=/a/,b=/b*/g;return c.call(E,"a"),c.call(b,"a"),E.lastIndex!==0||b.lastIndex!==0}(),p=l.UNSUPPORTED_Y||l.BROKEN_CARET,g=/()??/.exec("")[1]!==void 0,y=h||g||p;y&&(f=function(b){var _=this,v,A,D,k,T=p&&_.sticky,x=o.call(_),m=_.source,S=0,I=b;return T&&(x=x.replace("y",""),x.indexOf("g")===-1&&(x+="g"),I=String(b).slice(_.lastIndex),_.lastIndex>0&&(!_.multiline||_.multiline&&b[_.lastIndex-1]!==`
`)&&(m="(?: "+m+")",I=" "+I,S++),A=new RegExp("^(?:"+m+")",x)),g&&(A=new RegExp("^"+m+"$(?!\\s)",x)),h&&(v=_.lastIndex),D=c.call(T?A:_,I),T?D?(D.input=D.input.slice(S),D[0]=D[0].slice(S),D.index=_.lastIndex,_.lastIndex+=D[0].length):_.lastIndex=0:h&&D&&(_.lastIndex=_.global?D.index+D[0].length:v),g&&D&&D.length>1&&u.call(D[0],A,function(){for(k=1;k<arguments.length-2;k++)arguments[k]===void 0&&(D[k]=void 0)}),D}),s.exports=f},"94ca":function(s,i,a){var o=a("d039"),l=/#|\.prototype\./,c=function(g,y){var E=f[u(g)];return E==p?!0:E==h?!1:typeof y=="function"?o(y):!!y},u=c.normalize=function(g){return String(g).replace(l,".").toLowerCase()},f=c.data={},h=c.NATIVE="N",p=c.POLYFILL="P";s.exports=c},"99af":function(s,i,a){var o=a("23e7"),l=a("d039"),c=a("e8b5"),u=a("861d"),f=a("7b0b"),h=a("50c4"),p=a("8418"),g=a("65f0"),y=a("1dde"),E=a("b622"),b=a("2d00"),_=E("isConcatSpreadable"),v=9007199254740991,A="Maximum allowed index exceeded",D=b>=51||!l(function(){var m=[];return m[_]=!1,m.concat()[0]!==m}),k=y("concat"),T=function(m){if(!u(m))return!1;var S=m[_];return S!==void 0?!!S:c(m)},x=!D||!k;o({target:"Array",proto:!0,forced:x},{concat:function(S){var I=f(this),C=g(I,0),F=0,W,P,R,N,M;for(W=-1,R=arguments.length;W<R;W++)if(M=W===-1?I:arguments[W],T(M)){if(N=h(M.length),F+N>v)throw TypeError(A);for(P=0;P<N;P++,F++)P in M&&p(C,F,M[P])}else{if(F>=v)throw TypeError(A);p(C,F++,M)}return C.length=F,C}})},"9bdd":function(s,i,a){var o=a("825a");s.exports=function(l,c,u,f){try{return f?c(o(u)[0],u[1]):c(u)}catch(p){var h=l.return;throw h!==void 0&&o(h.call(l)),p}}},"9bf2":function(s,i,a){var o=a("83ab"),l=a("0cfb"),c=a("825a"),u=a("c04e"),f=Object.defineProperty;i.f=o?f:function(p,g,y){if(c(p),g=u(g,!0),c(y),l)try{return f(p,g,y)}catch{}if("get"in y||"set"in y)throw TypeError("Accessors not supported");return"value"in y&&(p[g]=y.value),p}},"9ed3":function(s,i,a){var o=a("ae93").IteratorPrototype,l=a("7c73"),c=a("5c6c"),u=a("d44e"),f=a("3f8c"),h=function(){return this};s.exports=function(p,g,y){var E=g+" Iterator";return p.prototype=l(o,{next:c(1,y)}),u(p,E,!1,!0),f[E]=h,p}},"9f7f":function(s,i,a){var o=a("d039");function l(c,u){return RegExp(c,u)}i.UNSUPPORTED_Y=o(function(){var c=l("a","y");return c.lastIndex=2,c.exec("abcd")!=null}),i.BROKEN_CARET=o(function(){var c=l("^r","gy");return c.lastIndex=2,c.exec("str")!=null})},a2bf:function(s,i,a){var o=a("e8b5"),l=a("50c4"),c=a("0366"),u=function(f,h,p,g,y,E,b,_){for(var v=y,A=0,D=b?c(b,_,3):!1,k;A<g;){if(A in p){if(k=D?D(p[A],A,h):p[A],E>0&&o(k))v=u(f,h,k,l(k.length),v,E-1)-1;else{if(v>=9007199254740991)throw TypeError("Exceed the acceptable array length");f[v]=k}v++}A++}return v};s.exports=u},a352:function(s,i){s.exports=n},a434:function(s,i,a){var o=a("23e7"),l=a("23cb"),c=a("a691"),u=a("50c4"),f=a("7b0b"),h=a("65f0"),p=a("8418"),g=a("1dde"),y=a("ae40"),E=g("splice"),b=y("splice",{ACCESSORS:!0,0:0,1:2}),_=Math.max,v=Math.min,A=9007199254740991,D="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!E||!b},{splice:function(T,x){var m=f(this),S=u(m.length),I=l(T,S),C=arguments.length,F,W,P,R,N,M;if(C===0?F=W=0:C===1?(F=0,W=S-I):(F=C-2,W=v(_(c(x),0),S-I)),S+F-W>A)throw TypeError(D);for(P=h(m,W),R=0;R<W;R++)N=I+R,N in m&&p(P,R,m[N]);if(P.length=W,F<W){for(R=I;R<S-W;R++)N=R+W,M=R+F,N in m?m[M]=m[N]:delete m[M];for(R=S;R>S-W+F;R--)delete m[R-1]}else if(F>W)for(R=S-W;R>I;R--)N=R+W-1,M=R+F-1,N in m?m[M]=m[N]:delete m[M];for(R=0;R<F;R++)m[R+I]=arguments[R+2];return m.length=S-W+F,P}})},a4d3:function(s,i,a){var o=a("23e7"),l=a("da84"),c=a("d066"),u=a("c430"),f=a("83ab"),h=a("4930"),p=a("fdbf"),g=a("d039"),y=a("5135"),E=a("e8b5"),b=a("861d"),_=a("825a"),v=a("7b0b"),A=a("fc6a"),D=a("c04e"),k=a("5c6c"),T=a("7c73"),x=a("df75"),m=a("241c"),S=a("057f"),I=a("7418"),C=a("06cf"),F=a("9bf2"),W=a("d1e7"),P=a("9112"),R=a("6eeb"),N=a("5692"),M=a("f772"),O=a("d012"),G=a("90e3"),z=a("b622"),j=a("e538"),H=a("746f"),V=a("d44e"),te=a("69f3"),oe=a("b727").forEach,ne=M("hidden"),le="Symbol",J="prototype",Q=z("toPrimitive"),ve=te.set,ee=te.getterFor(le),K=Object[J],Y=l.Symbol,pe=c("JSON","stringify"),xe=C.f,ae=F.f,de=S.f,Ee=W.f,he=N("symbols"),Ce=N("op-symbols"),Te=N("string-to-symbol-registry"),Ge=N("symbol-to-string-registry"),Ie=N("wks"),Ve=l.QObject,Ue=!Ve||!Ve[J]||!Ve[J].findChild,ze=f&&g(function(){return T(ae({},"a",{get:function(){return ae(this,"a",{value:7}).a}})).a!=7})?function(ht,ct,pt){var Ct=xe(K,ct);Ct&&delete K[ct],ae(ht,ct,pt),Ct&&ht!==K&&ae(K,ct,Ct)}:ae,Ke=function(ht,ct){var pt=he[ht]=T(Y[J]);return ve(pt,{type:le,tag:ht,description:ct}),f||(pt.description=ct),pt},ue=p?function(ht){return typeof ht=="symbol"}:function(ht){return Object(ht)instanceof Y},be=function(ct,pt,Ct){ct===K&&be(Ce,pt,Ct),_(ct);var Rt=D(pt,!0);return _(Ct),y(he,Rt)?(Ct.enumerable?(y(ct,ne)&&ct[ne][Rt]&&(ct[ne][Rt]=!1),Ct=T(Ct,{enumerable:k(0,!1)})):(y(ct,ne)||ae(ct,ne,k(1,{})),ct[ne][Rt]=!0),ze(ct,Rt,Ct)):ae(ct,Rt,Ct)},Ae=function(ct,pt){_(ct);var Ct=A(pt),Rt=x(Ct).concat(_t(Ct));return oe(Rt,function(mr){(!f||We.call(Ct,mr))&&be(ct,mr,Ct[mr])}),ct},Me=function(ct,pt){return pt===void 0?T(ct):Ae(T(ct),pt)},We=function(ct){var pt=D(ct,!0),Ct=Ee.call(this,pt);return this===K&&y(he,pt)&&!y(Ce,pt)?!1:Ct||!y(this,pt)||!y(he,pt)||y(this,ne)&&this[ne][pt]?Ct:!0},lt=function(ct,pt){var Ct=A(ct),Rt=D(pt,!0);if(!(Ct===K&&y(he,Rt)&&!y(Ce,Rt))){var mr=xe(Ct,Rt);return mr&&y(he,Rt)&&!(y(Ct,ne)&&Ct[ne][Rt])&&(mr.enumerable=!0),mr}},yt=function(ct){var pt=de(A(ct)),Ct=[];return oe(pt,function(Rt){!y(he,Rt)&&!y(O,Rt)&&Ct.push(Rt)}),Ct},_t=function(ct){var pt=ct===K,Ct=de(pt?Ce:A(ct)),Rt=[];return oe(Ct,function(mr){y(he,mr)&&(!pt||y(K,mr))&&Rt.push(he[mr])}),Rt};if(h||(Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor");var ct=!arguments.length||arguments[0]===void 0?void 0:String(arguments[0]),pt=G(ct),Ct=function(Rt){this===K&&Ct.call(Ce,Rt),y(this,ne)&&y(this[ne],pt)&&(this[ne][pt]=!1),ze(this,pt,k(1,Rt))};return f&&Ue&&ze(K,pt,{configurable:!0,set:Ct}),Ke(pt,ct)},R(Y[J],"toString",function(){return ee(this).tag}),R(Y,"withoutSetter",function(ht){return Ke(G(ht),ht)}),W.f=We,F.f=be,C.f=lt,m.f=S.f=yt,I.f=_t,j.f=function(ht){return Ke(z(ht),ht)},f&&(ae(Y[J],"description",{configurable:!0,get:function(){return ee(this).description}}),u||R(K,"propertyIsEnumerable",We,{unsafe:!0}))),o({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:Y}),oe(x(Ie),function(ht){H(ht)}),o({target:le,stat:!0,forced:!h},{for:function(ht){var ct=String(ht);if(y(Te,ct))return Te[ct];var pt=Y(ct);return Te[ct]=pt,Ge[pt]=ct,pt},keyFor:function(ct){if(!ue(ct))throw TypeError(ct+" is not a symbol");if(y(Ge,ct))return Ge[ct]},useSetter:function(){Ue=!0},useSimple:function(){Ue=!1}}),o({target:"Object",stat:!0,forced:!h,sham:!f},{create:Me,defineProperty:be,defineProperties:Ae,getOwnPropertyDescriptor:lt}),o({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:yt,getOwnPropertySymbols:_t}),o({target:"Object",stat:!0,forced:g(function(){I.f(1)})},{getOwnPropertySymbols:function(ct){return I.f(v(ct))}}),pe){var $t=!h||g(function(){var ht=Y();return pe([ht])!="[null]"||pe({a:ht})!="{}"||pe(Object(ht))!="{}"});o({target:"JSON",stat:!0,forced:$t},{stringify:function(ct,pt,Ct){for(var Rt=[ct],mr=1,mn;arguments.length>mr;)Rt.push(arguments[mr++]);if(mn=pt,!(!b(pt)&&ct===void 0||ue(ct)))return E(pt)||(pt=function(Qs,ms){if(typeof mn=="function"&&(ms=mn.call(this,Qs,ms)),!ue(ms))return ms}),Rt[1]=pt,pe.apply(null,Rt)}})}Y[J][Q]||P(Y[J],Q,Y[J].valueOf),V(Y,le),O[ne]=!0},a630:function(s,i,a){var o=a("23e7"),l=a("4df4"),c=a("1c7e"),u=!c(function(f){Array.from(f)});o({target:"Array",stat:!0,forced:u},{from:l})},a640:function(s,i,a){var o=a("d039");s.exports=function(l,c){var u=[][l];return!!u&&o(function(){u.call(null,c||function(){throw 1},1)})}},a691:function(s,i){var a=Math.ceil,o=Math.floor;s.exports=function(l){return isNaN(l=+l)?0:(l>0?o:a)(l)}},ab13:function(s,i,a){var o=a("b622"),l=o("match");s.exports=function(c){var u=/./;try{"/./"[c](u)}catch{try{return u[l]=!1,"/./"[c](u)}catch{}}return!1}},ac1f:function(s,i,a){var o=a("23e7"),l=a("9263");o({target:"RegExp",proto:!0,forced:/./.exec!==l},{exec:l})},ad6d:function(s,i,a){var o=a("825a");s.exports=function(){var l=o(this),c="";return l.global&&(c+="g"),l.ignoreCase&&(c+="i"),l.multiline&&(c+="m"),l.dotAll&&(c+="s"),l.unicode&&(c+="u"),l.sticky&&(c+="y"),c}},ae40:function(s,i,a){var o=a("83ab"),l=a("d039"),c=a("5135"),u=Object.defineProperty,f={},h=function(p){throw p};s.exports=function(p,g){if(c(f,p))return f[p];g||(g={});var y=[][p],E=c(g,"ACCESSORS")?g.ACCESSORS:!1,b=c(g,0)?g[0]:h,_=c(g,1)?g[1]:void 0;return f[p]=!!y&&!l(function(){if(E&&!o)return!0;var v={length:-1};E?u(v,1,{enumerable:!0,get:h}):v[1]=1,y.call(v,b,_)})}},ae93:function(s,i,a){var o=a("e163"),l=a("9112"),c=a("5135"),u=a("b622"),f=a("c430"),h=u("iterator"),p=!1,g=function(){return this},y,E,b;[].keys&&(b=[].keys(),"next"in b?(E=o(o(b)),E!==Object.prototype&&(y=E)):p=!0),y==null&&(y={}),!f&&!c(y,h)&&l(y,h,g),s.exports={IteratorPrototype:y,BUGGY_SAFARI_ITERATORS:p}},b041:function(s,i,a){var o=a("00ee"),l=a("f5df");s.exports=o?{}.toString:function(){return"[object "+l(this)+"]"}},b0c0:function(s,i,a){var o=a("83ab"),l=a("9bf2").f,c=Function.prototype,u=c.toString,f=/^\s*function ([^ (]*)/,h="name";o&&!(h in c)&&l(c,h,{configurable:!0,get:function(){try{return u.call(this).match(f)[1]}catch{return""}}})},b622:function(s,i,a){var o=a("da84"),l=a("5692"),c=a("5135"),u=a("90e3"),f=a("4930"),h=a("fdbf"),p=l("wks"),g=o.Symbol,y=h?g:g&&g.withoutSetter||u;s.exports=function(E){return c(p,E)||(f&&c(g,E)?p[E]=g[E]:p[E]=y("Symbol."+E)),p[E]}},b64b:function(s,i,a){var o=a("23e7"),l=a("7b0b"),c=a("df75"),u=a("d039"),f=u(function(){c(1)});o({target:"Object",stat:!0,forced:f},{keys:function(p){return c(l(p))}})},b727:function(s,i,a){var o=a("0366"),l=a("44ad"),c=a("7b0b"),u=a("50c4"),f=a("65f0"),h=[].push,p=function(g){var y=g==1,E=g==2,b=g==3,_=g==4,v=g==6,A=g==5||v;return function(D,k,T,x){for(var m=c(D),S=l(m),I=o(k,T,3),C=u(S.length),F=0,W=x||f,P=y?W(D,C):E?W(D,0):void 0,R,N;C>F;F++)if((A||F in S)&&(R=S[F],N=I(R,F,m),g)){if(y)P[F]=N;else if(N)switch(g){case 3:return!0;case 5:return R;case 6:return F;case 2:h.call(P,R)}else if(_)return!1}return v?-1:b||_?_:P}};s.exports={forEach:p(0),map:p(1),filter:p(2),some:p(3),every:p(4),find:p(5),findIndex:p(6)}},c04e:function(s,i,a){var o=a("861d");s.exports=function(l,c){if(!o(l))return l;var u,f;if(c&&typeof(u=l.toString)=="function"&&!o(f=u.call(l))||typeof(u=l.valueOf)=="function"&&!o(f=u.call(l))||!c&&typeof(u=l.toString)=="function"&&!o(f=u.call(l)))return f;throw TypeError("Can't convert object to primitive value")}},c430:function(s,i){s.exports=!1},c6b6:function(s,i){var a={}.toString;s.exports=function(o){return a.call(o).slice(8,-1)}},c6cd:function(s,i,a){var o=a("da84"),l=a("ce4e"),c="__core-js_shared__",u=o[c]||l(c,{});s.exports=u},c740:function(s,i,a){var o=a("23e7"),l=a("b727").findIndex,c=a("44d2"),u=a("ae40"),f="findIndex",h=!0,p=u(f);f in[]&&Array(1)[f](function(){h=!1}),o({target:"Array",proto:!0,forced:h||!p},{findIndex:function(y){return l(this,y,arguments.length>1?arguments[1]:void 0)}}),c(f)},c8ba:function(s,i){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch{typeof window=="object"&&(a=window)}s.exports=a},c975:function(s,i,a){var o=a("23e7"),l=a("4d64").indexOf,c=a("a640"),u=a("ae40"),f=[].indexOf,h=!!f&&1/[1].indexOf(1,-0)<0,p=c("indexOf"),g=u("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:h||!p||!g},{indexOf:function(E){return h?f.apply(this,arguments)||0:l(this,E,arguments.length>1?arguments[1]:void 0)}})},ca84:function(s,i,a){var o=a("5135"),l=a("fc6a"),c=a("4d64").indexOf,u=a("d012");s.exports=function(f,h){var p=l(f),g=0,y=[],E;for(E in p)!o(u,E)&&o(p,E)&&y.push(E);for(;h.length>g;)o(p,E=h[g++])&&(~c(y,E)||y.push(E));return y}},caad:function(s,i,a){var o=a("23e7"),l=a("4d64").includes,c=a("44d2"),u=a("ae40"),f=u("indexOf",{ACCESSORS:!0,1:0});o({target:"Array",proto:!0,forced:!f},{includes:function(p){return l(this,p,arguments.length>1?arguments[1]:void 0)}}),c("includes")},cc12:function(s,i,a){var o=a("da84"),l=a("861d"),c=o.document,u=l(c)&&l(c.createElement);s.exports=function(f){return u?c.createElement(f):{}}},ce4e:function(s,i,a){var o=a("da84"),l=a("9112");s.exports=function(c,u){try{l(o,c,u)}catch{o[c]=u}return u}},d012:function(s,i){s.exports={}},d039:function(s,i){s.exports=function(a){try{return!!a()}catch{return!0}}},d066:function(s,i,a){var o=a("428f"),l=a("da84"),c=function(u){return typeof u=="function"?u:void 0};s.exports=function(u,f){return arguments.length<2?c(o[u])||c(l[u]):o[u]&&o[u][f]||l[u]&&l[u][f]}},d1e7:function(s,i,a){var o={}.propertyIsEnumerable,l=Object.getOwnPropertyDescriptor,c=l&&!o.call({1:2},1);i.f=c?function(f){var h=l(this,f);return!!h&&h.enumerable}:o},d28b:function(s,i,a){var o=a("746f");o("iterator")},d2bb:function(s,i,a){var o=a("825a"),l=a("3bbe");s.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var c=!1,u={},f;try{f=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set,f.call(u,[]),c=u instanceof Array}catch{}return function(p,g){return o(p),l(g),c?f.call(p,g):p.__proto__=g,p}}():void 0)},d3b7:function(s,i,a){var o=a("00ee"),l=a("6eeb"),c=a("b041");o||l(Object.prototype,"toString",c,{unsafe:!0})},d44e:function(s,i,a){var o=a("9bf2").f,l=a("5135"),c=a("b622"),u=c("toStringTag");s.exports=function(f,h,p){f&&!l(f=p?f:f.prototype,u)&&o(f,u,{configurable:!0,value:h})}},d58f:function(s,i,a){var o=a("1c0b"),l=a("7b0b"),c=a("44ad"),u=a("50c4"),f=function(h){return function(p,g,y,E){o(g);var b=l(p),_=c(b),v=u(b.length),A=h?v-1:0,D=h?-1:1;if(y<2)for(;;){if(A in _){E=_[A],A+=D;break}if(A+=D,h?A<0:v<=A)throw TypeError("Reduce of empty array with no initial value")}for(;h?A>=0:v>A;A+=D)A in _&&(E=g(E,_[A],A,b));return E}};s.exports={left:f(!1),right:f(!0)}},d784:function(s,i,a){a("ac1f");var o=a("6eeb"),l=a("d039"),c=a("b622"),u=a("9263"),f=a("9112"),h=c("species"),p=!l(function(){var _=/./;return _.exec=function(){var v=[];return v.groups={a:"7"},v},"".replace(_,"$<a>")!=="7"}),g=function(){return"a".replace(/./,"$0")==="$0"}(),y=c("replace"),E=function(){return/./[y]?/./[y]("a","$0")==="":!1}(),b=!l(function(){var _=/(?:)/,v=_.exec;_.exec=function(){return v.apply(this,arguments)};var A="ab".split(_);return A.length!==2||A[0]!=="a"||A[1]!=="b"});s.exports=function(_,v,A,D){var k=c(_),T=!l(function(){var F={};return F[k]=function(){return 7},""[_](F)!=7}),x=T&&!l(function(){var F=!1,W=/a/;return _==="split"&&(W={},W.constructor={},W.constructor[h]=function(){return W},W.flags="",W[k]=/./[k]),W.exec=function(){return F=!0,null},W[k](""),!F});if(!T||!x||_==="replace"&&!(p&&g&&!E)||_==="split"&&!b){var m=/./[k],S=A(k,""[_],function(F,W,P,R,N){return W.exec===u?T&&!N?{done:!0,value:m.call(W,P,R)}:{done:!0,value:F.call(P,W,R)}:{done:!1}},{REPLACE_KEEPS_$0:g,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:E}),I=S[0],C=S[1];o(String.prototype,_,I),o(RegExp.prototype,k,v==2?function(F,W){return C.call(F,this,W)}:function(F){return C.call(F,this)})}D&&f(RegExp.prototype[k],"sham",!0)}},d81d:function(s,i,a){var o=a("23e7"),l=a("b727").map,c=a("1dde"),u=a("ae40"),f=c("map"),h=u("map");o({target:"Array",proto:!0,forced:!f||!h},{map:function(g){return l(this,g,arguments.length>1?arguments[1]:void 0)}})},da84:function(s,i,a){(function(o){var l=function(c){return c&&c.Math==Math&&c};s.exports=l(typeof globalThis=="object"&&globalThis)||l(typeof window=="object"&&window)||l(typeof self=="object"&&self)||l(typeof o=="object"&&o)||Function("return this")()}).call(this,a("c8ba"))},dbb4:function(s,i,a){var o=a("23e7"),l=a("83ab"),c=a("56ef"),u=a("fc6a"),f=a("06cf"),h=a("8418");o({target:"Object",stat:!0,sham:!l},{getOwnPropertyDescriptors:function(g){for(var y=u(g),E=f.f,b=c(y),_={},v=0,A,D;b.length>v;)D=E(y,A=b[v++]),D!==void 0&&h(_,A,D);return _}})},dbf1:function(s,i,a){(function(o){a.d(i,"a",function(){return c});function l(){return typeof window<"u"?window.console:o.console}var c=l()}).call(this,a("c8ba"))},ddb0:function(s,i,a){var o=a("da84"),l=a("fdbc"),c=a("e260"),u=a("9112"),f=a("b622"),h=f("iterator"),p=f("toStringTag"),g=c.values;for(var y in l){var E=o[y],b=E&&E.prototype;if(b){if(b[h]!==g)try{u(b,h,g)}catch{b[h]=g}if(b[p]||u(b,p,y),l[y]){for(var _ in c)if(b[_]!==c[_])try{u(b,_,c[_])}catch{b[_]=c[_]}}}}},df75:function(s,i,a){var o=a("ca84"),l=a("7839");s.exports=Object.keys||function(u){return o(u,l)}},e01a:function(s,i,a){var o=a("23e7"),l=a("83ab"),c=a("da84"),u=a("5135"),f=a("861d"),h=a("9bf2").f,p=a("e893"),g=c.Symbol;if(l&&typeof g=="function"&&(!("description"in g.prototype)||g().description!==void 0)){var y={},E=function(){var k=arguments.length<1||arguments[0]===void 0?void 0:String(arguments[0]),T=this instanceof E?new g(k):k===void 0?g():g(k);return k===""&&(y[T]=!0),T};p(E,g);var b=E.prototype=g.prototype;b.constructor=E;var _=b.toString,v=String(g("test"))=="Symbol(test)",A=/^Symbol\((.*)\)[^)]+$/;h(b,"description",{configurable:!0,get:function(){var k=f(this)?this.valueOf():this,T=_.call(k);if(u(y,k))return"";var x=v?T.slice(7,-1):T.replace(A,"$1");return x===""?void 0:x}}),o({global:!0,forced:!0},{Symbol:E})}},e163:function(s,i,a){var o=a("5135"),l=a("7b0b"),c=a("f772"),u=a("e177"),f=c("IE_PROTO"),h=Object.prototype;s.exports=u?Object.getPrototypeOf:function(p){return p=l(p),o(p,f)?p[f]:typeof p.constructor=="function"&&p instanceof p.constructor?p.constructor.prototype:p instanceof Object?h:null}},e177:function(s,i,a){var o=a("d039");s.exports=!o(function(){function l(){}return l.prototype.constructor=null,Object.getPrototypeOf(new l)!==l.prototype})},e260:function(s,i,a){var o=a("fc6a"),l=a("44d2"),c=a("3f8c"),u=a("69f3"),f=a("7dd0"),h="Array Iterator",p=u.set,g=u.getterFor(h);s.exports=f(Array,"Array",function(y,E){p(this,{type:h,target:o(y),index:0,kind:E})},function(){var y=g(this),E=y.target,b=y.kind,_=y.index++;return!E||_>=E.length?(y.target=void 0,{value:void 0,done:!0}):b=="keys"?{value:_,done:!1}:b=="values"?{value:E[_],done:!1}:{value:[_,E[_]],done:!1}},"values"),c.Arguments=c.Array,l("keys"),l("values"),l("entries")},e439:function(s,i,a){var o=a("23e7"),l=a("d039"),c=a("fc6a"),u=a("06cf").f,f=a("83ab"),h=l(function(){u(1)}),p=!f||h;o({target:"Object",stat:!0,forced:p,sham:!f},{getOwnPropertyDescriptor:function(y,E){return u(c(y),E)}})},e538:function(s,i,a){var o=a("b622");i.f=o},e893:function(s,i,a){var o=a("5135"),l=a("56ef"),c=a("06cf"),u=a("9bf2");s.exports=function(f,h){for(var p=l(h),g=u.f,y=c.f,E=0;E<p.length;E++){var b=p[E];o(f,b)||g(f,b,y(h,b))}}},e8b5:function(s,i,a){var o=a("c6b6");s.exports=Array.isArray||function(c){return o(c)=="Array"}},e95a:function(s,i,a){var o=a("b622"),l=a("3f8c"),c=o("iterator"),u=Array.prototype;s.exports=function(f){return f!==void 0&&(l.Array===f||u[c]===f)}},f5df:function(s,i,a){var o=a("00ee"),l=a("c6b6"),c=a("b622"),u=c("toStringTag"),f=l(function(){return arguments}())=="Arguments",h=function(p,g){try{return p[g]}catch{}};s.exports=o?l:function(p){var g,y,E;return p===void 0?"Undefined":p===null?"Null":typeof(y=h(g=Object(p),u))=="string"?y:f?l(g):(E=l(g))=="Object"&&typeof g.callee=="function"?"Arguments":E}},f772:function(s,i,a){var o=a("5692"),l=a("90e3"),c=o("keys");s.exports=function(u){return c[u]||(c[u]=l(u))}},fb15:function(s,i,a){if(a.r(i),typeof window<"u"){var o=window.document.currentScript;{var l=a("8875");o=l(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:l})}var c=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);c&&(a.p=c[1])}a("99af"),a("4de4"),a("4160"),a("c975"),a("d81d"),a("a434"),a("159b"),a("a4d3"),a("e439"),a("dbb4"),a("b64b");function u(ue,be,Ae){return be in ue?Object.defineProperty(ue,be,{value:Ae,enumerable:!0,configurable:!0,writable:!0}):ue[be]=Ae,ue}function f(ue,be){var Ae=Object.keys(ue);if(Object.getOwnPropertySymbols){var Me=Object.getOwnPropertySymbols(ue);be&&(Me=Me.filter(function(We){return Object.getOwnPropertyDescriptor(ue,We).enumerable})),Ae.push.apply(Ae,Me)}return Ae}function h(ue){for(var be=1;be<arguments.length;be++){var Ae=arguments[be]!=null?arguments[be]:{};be%2?f(Object(Ae),!0).forEach(function(Me){u(ue,Me,Ae[Me])}):Object.getOwnPropertyDescriptors?Object.defineProperties(ue,Object.getOwnPropertyDescriptors(Ae)):f(Object(Ae)).forEach(function(Me){Object.defineProperty(ue,Me,Object.getOwnPropertyDescriptor(Ae,Me))})}return ue}function p(ue){if(Array.isArray(ue))return ue}a("e01a"),a("d28b"),a("e260"),a("d3b7"),a("3ca3"),a("ddb0");function g(ue,be){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(ue)))){var Ae=[],Me=!0,We=!1,lt=void 0;try{for(var yt=ue[Symbol.iterator](),_t;!(Me=(_t=yt.next()).done)&&(Ae.push(_t.value),!(be&&Ae.length===be));Me=!0);}catch($t){We=!0,lt=$t}finally{try{!Me&&yt.return!=null&&yt.return()}finally{if(We)throw lt}}return Ae}}a("a630"),a("fb6a"),a("b0c0"),a("25f0");function y(ue,be){(be==null||be>ue.length)&&(be=ue.length);for(var Ae=0,Me=new Array(be);Ae<be;Ae++)Me[Ae]=ue[Ae];return Me}function E(ue,be){if(ue){if(typeof ue=="string")return y(ue,be);var Ae=Object.prototype.toString.call(ue).slice(8,-1);if(Ae==="Object"&&ue.constructor&&(Ae=ue.constructor.name),Ae==="Map"||Ae==="Set")return Array.from(ue);if(Ae==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Ae))return y(ue,be)}}function b(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _(ue,be){return p(ue)||g(ue,be)||E(ue,be)||b()}function v(ue){if(Array.isArray(ue))return y(ue)}function A(ue){if(typeof Symbol<"u"&&Symbol.iterator in Object(ue))return Array.from(ue)}function D(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function k(ue){return v(ue)||A(ue)||E(ue)||D()}var T=a("a352"),x=a.n(T);function m(ue){ue.parentElement!==null&&ue.parentElement.removeChild(ue)}function S(ue,be,Ae){var Me=Ae===0?ue.children[0]:ue.children[Ae-1].nextSibling;ue.insertBefore(be,Me)}var I=a("dbf1");a("13d5"),a("4fad"),a("ac1f"),a("5319");function C(ue){var be=Object.create(null);return function(Me){var We=be[Me];return We||(be[Me]=ue(Me))}}var F=/-(\w)/g,W=C(function(ue){return ue.replace(F,function(be,Ae){return Ae.toUpperCase()})});a("5db7"),a("73d9");var P=["Start","Add","Remove","Update","End"],R=["Choose","Unchoose","Sort","Filter","Clone"],N=["Move"],M=[N,P,R].flatMap(function(ue){return ue}).map(function(ue){return"on".concat(ue)}),O={manage:N,manageAndEmit:P,emit:R};function G(ue){return M.indexOf(ue)!==-1}a("caad"),a("2ca0");var z=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"];function j(ue){return z.includes(ue)}function H(ue){return["transition-group","TransitionGroup"].includes(ue)}function V(ue){return["id","class","role","style"].includes(ue)||ue.startsWith("data-")||ue.startsWith("aria-")||ue.startsWith("on")}function te(ue){return ue.reduce(function(be,Ae){var Me=_(Ae,2),We=Me[0],lt=Me[1];return be[We]=lt,be},{})}function oe(ue){var be=ue.$attrs,Ae=ue.componentData,Me=Ae===void 0?{}:Ae,We=te(Object.entries(be).filter(function(lt){var yt=_(lt,2),_t=yt[0];return yt[1],V(_t)}));return h(h({},We),Me)}function ne(ue){var be=ue.$attrs,Ae=ue.callBackBuilder,Me=te(le(be));Object.entries(Ae).forEach(function(lt){var yt=_(lt,2),_t=yt[0],$t=yt[1];O[_t].forEach(function(ht){Me["on".concat(ht)]=$t(ht)})});var We="[data-draggable]".concat(Me.draggable||"");return h(h({},Me),{},{draggable:We})}function le(ue){return Object.entries(ue).filter(function(be){var Ae=_(be,2),Me=Ae[0];return Ae[1],!V(Me)}).map(function(be){var Ae=_(be,2),Me=Ae[0],We=Ae[1];return[W(Me),We]}).filter(function(be){var Ae=_(be,2),Me=Ae[0];return Ae[1],!G(Me)})}a("c740");function J(ue,be){if(!(ue instanceof be))throw new TypeError("Cannot call a class as a function")}function Q(ue,be){for(var Ae=0;Ae<be.length;Ae++){var Me=be[Ae];Me.enumerable=Me.enumerable||!1,Me.configurable=!0,"value"in Me&&(Me.writable=!0),Object.defineProperty(ue,Me.key,Me)}}function ve(ue,be,Ae){return be&&Q(ue.prototype,be),ue}var ee=function(be){var Ae=be.el;return Ae},K=function(be,Ae){return be.__draggable_context=Ae},Y=function(be){return be.__draggable_context},pe=function(){function ue(be){var Ae=be.nodes,Me=Ae.header,We=Ae.default,lt=Ae.footer,yt=be.root,_t=be.realList;J(this,ue),this.defaultNodes=We,this.children=[].concat(k(Me),k(We),k(lt)),this.externalComponent=yt.externalComponent,this.rootTransition=yt.transition,this.tag=yt.tag,this.realList=_t}return ve(ue,[{key:"render",value:function(Ae,Me){var We=this.tag,lt=this.children,yt=this._isRootComponent,_t=yt?{default:function(){return lt}}:lt;return Ae(We,Me,_t)}},{key:"updated",value:function(){var Ae=this.defaultNodes,Me=this.realList;Ae.forEach(function(We,lt){K(ee(We),{element:Me[lt],index:lt})})}},{key:"getUnderlyingVm",value:function(Ae){return Y(Ae)}},{key:"getVmIndexFromDomIndex",value:function(Ae,Me){var We=this.defaultNodes,lt=We.length,yt=Me.children,_t=yt.item(Ae);if(_t===null)return lt;var $t=Y(_t);if($t)return $t.index;if(lt===0)return 0;var ht=ee(We[0]),ct=k(yt).findIndex(function(pt){return pt===ht});return Ae<ct?0:lt}},{key:"_isRootComponent",get:function(){return this.externalComponent||this.rootTransition}}]),ue}(),xe=a("8bbf");function ae(ue,be){var Ae=ue[be];return Ae?Ae():[]}function de(ue){var be=ue.$slots,Ae=ue.realList,Me=ue.getKey,We=Ae||[],lt=["header","footer"].map(function(pt){return ae(be,pt)}),yt=_(lt,2),_t=yt[0],$t=yt[1],ht=be.item;if(!ht)throw new Error("draggable element must have an item slot");var ct=We.flatMap(function(pt,Ct){return ht({element:pt,index:Ct}).map(function(Rt){return Rt.key=Me(pt),Rt.props=h(h({},Rt.props||{}),{},{"data-draggable":!0}),Rt})});if(ct.length!==We.length)throw new Error("Item slot must have only one child");return{header:_t,footer:$t,default:ct}}function Ee(ue){var be=H(ue),Ae=!j(ue)&&!be;return{transition:be,externalComponent:Ae,tag:Ae?Object(xe.resolveComponent)(ue):be?xe.TransitionGroup:ue}}function he(ue){var be=ue.$slots,Ae=ue.tag,Me=ue.realList,We=ue.getKey,lt=de({$slots:be,realList:Me,getKey:We}),yt=Ee(Ae);return new pe({nodes:lt,root:yt,realList:Me})}function Ce(ue,be){var Ae=this;Object(xe.nextTick)(function(){return Ae.$emit(ue.toLowerCase(),be)})}function Te(ue){var be=this;return function(Ae,Me){if(be.realList!==null)return be["onDrag".concat(ue)](Ae,Me)}}function Ge(ue){var be=this,Ae=Te.call(this,ue);return function(Me,We){Ae.call(be,Me,We),Ce.call(be,ue,Me)}}var Ie=null,Ve={list:{type:Array,required:!1,default:null},modelValue:{type:Array,required:!1,default:null},itemKey:{type:[String,Function],required:!0},clone:{type:Function,default:function(be){return be}},tag:{type:String,default:"div"},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},Ue=["update:modelValue","change"].concat(k([].concat(k(O.manageAndEmit),k(O.emit)).map(function(ue){return ue.toLowerCase()}))),ze=Object(xe.defineComponent)({name:"draggable",inheritAttrs:!1,props:Ve,emits:Ue,data:function(){return{error:!1}},render:function(){try{this.error=!1;var be=this.$slots,Ae=this.$attrs,Me=this.tag,We=this.componentData,lt=this.realList,yt=this.getKey,_t=he({$slots:be,tag:Me,realList:lt,getKey:yt});this.componentStructure=_t;var $t=oe({$attrs:Ae,componentData:We});return _t.render(xe.h,$t)}catch(ht){return this.error=!0,Object(xe.h)("pre",{style:{color:"red"}},ht.stack)}},created:function(){this.list!==null&&this.modelValue!==null&&I.a.error("modelValue and list props are mutually exclusive! Please set one or another.")},mounted:function(){var be=this;if(!this.error){var Ae=this.$attrs,Me=this.$el,We=this.componentStructure;We.updated();var lt=ne({$attrs:Ae,callBackBuilder:{manageAndEmit:function($t){return Ge.call(be,$t)},emit:function($t){return Ce.bind(be,$t)},manage:function($t){return Te.call(be,$t)}}}),yt=Me.nodeType===1?Me:Me.parentElement;this._sortable=new x.a(yt,lt),this.targetDomElement=yt,yt.__draggable_component__=this}},updated:function(){this.componentStructure.updated()},beforeUnmount:function(){this._sortable!==void 0&&this._sortable.destroy()},computed:{realList:function(){var be=this.list;return be||this.modelValue},getKey:function(){var be=this.itemKey;return typeof be=="function"?be:function(Ae){return Ae[be]}}},watch:{$attrs:{handler:function(be){var Ae=this._sortable;Ae&&le(be).forEach(function(Me){var We=_(Me,2),lt=We[0],yt=We[1];Ae.option(lt,yt)})},deep:!0}},methods:{getUnderlyingVm:function(be){return this.componentStructure.getUnderlyingVm(be)||null},getUnderlyingPotencialDraggableComponent:function(be){return be.__draggable_component__},emitChanges:function(be){var Ae=this;Object(xe.nextTick)(function(){return Ae.$emit("change",be)})},alterList:function(be){if(this.list){be(this.list);return}var Ae=k(this.modelValue);be(Ae),this.$emit("update:modelValue",Ae)},spliceList:function(){var be=arguments,Ae=function(We){return We.splice.apply(We,k(be))};this.alterList(Ae)},updatePosition:function(be,Ae){var Me=function(lt){return lt.splice(Ae,0,lt.splice(be,1)[0])};this.alterList(Me)},getRelatedContextFromMoveEvent:function(be){var Ae=be.to,Me=be.related,We=this.getUnderlyingPotencialDraggableComponent(Ae);if(!We)return{component:We};var lt=We.realList,yt={list:lt,component:We};if(Ae!==Me&&lt){var _t=We.getUnderlyingVm(Me)||{};return h(h({},_t),yt)}return yt},getVmIndexFromDomIndex:function(be){return this.componentStructure.getVmIndexFromDomIndex(be,this.targetDomElement)},onDragStart:function(be){this.context=this.getUnderlyingVm(be.item),be.item._underlying_vm_=this.clone(this.context.element),Ie=be.item},onDragAdd:function(be){var Ae=be.item._underlying_vm_;if(Ae!==void 0){m(be.item);var Me=this.getVmIndexFromDomIndex(be.newIndex);this.spliceList(Me,0,Ae);var We={element:Ae,newIndex:Me};this.emitChanges({added:We})}},onDragRemove:function(be){if(S(this.$el,be.item,be.oldIndex),be.pullMode==="clone"){m(be.clone);return}var Ae=this.context,Me=Ae.index,We=Ae.element;this.spliceList(Me,1);var lt={element:We,oldIndex:Me};this.emitChanges({removed:lt})},onDragUpdate:function(be){m(be.item),S(be.from,be.item,be.oldIndex);var Ae=this.context.index,Me=this.getVmIndexFromDomIndex(be.newIndex);this.updatePosition(Ae,Me);var We={element:this.context.element,oldIndex:Ae,newIndex:Me};this.emitChanges({moved:We})},computeFutureIndex:function(be,Ae){if(!be.element)return 0;var Me=k(Ae.to.children).filter(function(_t){return _t.style.display!=="none"}),We=Me.indexOf(Ae.related),lt=be.component.getVmIndexFromDomIndex(We),yt=Me.indexOf(Ie)!==-1;return yt||!Ae.willInsertAfter?lt:lt+1},onDragMove:function(be,Ae){var Me=this.move,We=this.realList;if(!Me||!We)return!0;var lt=this.getRelatedContextFromMoveEvent(be),yt=this.computeFutureIndex(lt,be),_t=h(h({},this.context),{},{futureIndex:yt}),$t=h(h({},be),{},{relatedContext:lt,draggedContext:_t});return Me($t,Ae)},onDragEnd:function(){Ie=null}}}),Ke=ze;i.default=Ke},fb6a:function(s,i,a){var o=a("23e7"),l=a("861d"),c=a("e8b5"),u=a("23cb"),f=a("50c4"),h=a("fc6a"),p=a("8418"),g=a("b622"),y=a("1dde"),E=a("ae40"),b=y("slice"),_=E("slice",{ACCESSORS:!0,0:0,1:2}),v=g("species"),A=[].slice,D=Math.max;o({target:"Array",proto:!0,forced:!b||!_},{slice:function(T,x){var m=h(this),S=f(m.length),I=u(T,S),C=u(x===void 0?S:x,S),F,W,P;if(c(m)&&(F=m.constructor,typeof F=="function"&&(F===Array||c(F.prototype))?F=void 0:l(F)&&(F=F[v],F===null&&(F=void 0)),F===Array||F===void 0))return A.call(m,I,C);for(W=new(F===void 0?Array:F)(D(C-I,0)),P=0;I<C;I++,P++)I in m&&p(W,P,m[I]);return W.length=P,W}})},fc6a:function(s,i,a){var o=a("44ad"),l=a("1d80");s.exports=function(c){return o(l(c))}},fdbc:function(s,i){s.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(s,i,a){var o=a("4930");s.exports=o&&!Symbol.sham&&typeof Symbol.iterator=="symbol"}}).default})})(Noe);const xle={class:"assignment-dialog-modal"},Ele={class:"form-row"},_le={key:0,class:"form-row"},ble=["value"],Sle={key:1,class:"form-row"},Ale=["value"],Tle={key:2,class:"form-row"},wle={class:"form-row"},Cle={class:"form-row"},Ile={class:"form-row"},kle={class:"dialog-actions"},Dle={__name:"AssignmentDialog",props:{teachers:Array,students:Array,assignment:Object},emits:["save","close"],setup(t,{emit:e}){const r=t,n=e,s=se("lunch"),i=se(""),a=se(""),o=se(""),l=se("12:00"),c=se("12:30"),u=se(""),f=se(""),h=se("");Ht(()=>r.assignment,y=>{y?(f.value=y.id||Date.now().toString(),h.value=y.blockId||f.value||`block-${Date.now()}`,s.value=y.type||"lunch",i.value=y.teacherId||"",a.value=y.studentId||"",o.value=y.type==="other"?y.label:"",l.value=y.start||"12:00",c.value=y.end||"12:30",u.value=y.note||""):(f.value=Date.now().toString(),h.value=`block-${f.value}`,s.value="lunch",i.value="",a.value="",o.value="",l.value="12:00",c.value="12:30",u.value="")},{immediate:!0});const p=Se(()=>{if(s.value==="lunch")return"Lunch";if(s.value==="break")return"Break";if(s.value==="class"){const y=r.teachers.find(E=>E.id===i.value);return y?y.name||y.email||y.id:""}if(s.value==="student"){const y=r.students.find(E=>E.id===a.value);return y?`${y.firstName} ${y.lastName}`:""}return s.value==="other"?o.value:""});function g(){!l.value||!c.value||s.value==="class"&&!i.value||s.value==="student"&&!a.value||s.value==="other"&&!o.value||n("save",{id:f.value,blockId:h.value,type:s.value,label:p.value,start:l.value,end:c.value,note:u.value,teacherId:i.value,studentId:a.value})}return(y,E)=>(L(),B("div",{class:"assignment-dialog-overlay",onClick:E[8]||(E[8]=Yr(b=>y.$emit("close"),["self"]))},[d("div",xle,[E[20]||(E[20]=d("h2",null,"Add Assignment",-1)),d("form",{onSubmit:Yr(g,["prevent"])},[d("div",Ele,[E[10]||(E[10]=d("label",null,"Type:",-1)),Ne(d("select",{"onUpdate:modelValue":E[0]||(E[0]=b=>s.value=b)},E[9]||(E[9]=[Rn('<option value="lunch" data-v-f2af98a0>Lunch</option><option value="break" data-v-f2af98a0>Break</option><option value="class" data-v-f2af98a0>Class</option><option value="student" data-v-f2af98a0>Student</option><option value="other" data-v-f2af98a0>Other</option>',5)]),512),[[sr,s.value]])]),s.value==="class"?(L(),B("div",_le,[E[12]||(E[12]=d("label",null,"Teacher:",-1)),Ne(d("select",{"onUpdate:modelValue":E[1]||(E[1]=b=>i.value=b)},[E[11]||(E[11]=d("option",{value:""},"Select teacher...",-1)),(L(!0),B(De,null,$e(t.teachers,b=>(L(),B("option",{key:b.id,value:b.id},Z(b.name||b.email||b.id),9,ble))),128))],512),[[sr,i.value]])])):_e("",!0),s.value==="student"?(L(),B("div",Sle,[E[14]||(E[14]=d("label",null,"Student:",-1)),Ne(d("select",{"onUpdate:modelValue":E[2]||(E[2]=b=>a.value=b)},[E[13]||(E[13]=d("option",{value:""},"Select student...",-1)),(L(!0),B(De,null,$e(t.students,b=>(L(),B("option",{key:b.id,value:b.id},Z(b.firstName)+" "+Z(b.lastName),9,Ale))),128))],512),[[sr,a.value]])])):_e("",!0),s.value==="other"?(L(),B("div",Tle,[E[15]||(E[15]=d("label",null,"Label:",-1)),Ne(d("input",{"onUpdate:modelValue":E[3]||(E[3]=b=>o.value=b),placeholder:"Custom label"},null,512),[[ft,o.value]])])):_e("",!0),d("div",wle,[E[16]||(E[16]=d("label",null,"Start Time:",-1)),Ne(d("input",{"onUpdate:modelValue":E[4]||(E[4]=b=>l.value=b),type:"time",required:""},null,512),[[ft,l.value]])]),d("div",Cle,[E[17]||(E[17]=d("label",null,"End Time:",-1)),Ne(d("input",{"onUpdate:modelValue":E[5]||(E[5]=b=>c.value=b),type:"time",required:""},null,512),[[ft,c.value]])]),d("div",Ile,[E[18]||(E[18]=d("label",null,"Note:",-1)),Ne(d("input",{"onUpdate:modelValue":E[6]||(E[6]=b=>u.value=b),placeholder:"Optional note"},null,512),[[ft,u.value]])]),d("div",kle,[E[19]||(E[19]=d("button",{type:"submit",class:"btn btn-primary"},"Add",-1)),d("button",{type:"button",class:"btn btn-secondary",onClick:E[7]||(E[7]=b=>y.$emit("close"))},"Cancel")])],32)])]))}},Ple=St(Dle,[["__scopeId","data-v-f2af98a0"]]),Rle={class:"vertical-time-grid-wrapper"},Fle={class:"grid-block-label-time"},Nle=["title"],Ole=["title"],Mle=["onDragstart","onDrag","onDragend"],Lle={class:"assignment-content"},Ble={class:"assignment-label-time"},Ule={class:"assignment-time-label"},$le={class:"assignment-actions"},Vle=["onClick"],Hle=["onClick"],jle=["onMousedown"],KS=24,Gle={__name:"VerticalTimeGrid",props:{assignments:Array,teachers:Array,students:Array,getAssignmentBoxStyle:Function,onAssignmentDragStart:Function,onAssignmentDrag:Function,onAssignmentDragEnd:Function,onResizeStart:Function,blocks:Array},emits:["update:assignments","edit-assignment"],setup(t,{emit:e}){const r=t,n=e,s=se(null);se(!1);const i=se(r.assignments?r.assignments.map(R=>({...R})):[]);Ht(()=>r.assignments,R=>{i.value=R?R.map(N=>({...N})):[]},{immediate:!0});function a(R){const[N,M]=R.split(":").map(Number);return N*60+M}function o(R){const N=Math.floor(R/60),M=R%60;return`${N<10?"0":""}${N}:${M<10?"0":""}${M}`}const l=Se(()=>!r.blocks||r.blocks.length===0?"08:00":r.blocks.reduce((R,N)=>N.startTime<R?N.startTime:R,r.blocks[0].startTime)),c=Se(()=>!r.blocks||r.blocks.length===0?"16:00":r.blocks.reduce((R,N)=>N.endTime>R?N.endTime:R,r.blocks[0].endTime)),u=Se(()=>a(l.value)),f=Se(()=>a(c.value)),h=Se(()=>f.value-u.value),p=Se(()=>h.value*2.5+KS*2);Se(()=>{if(!r.blocks)return[];const R=[];return r.blocks.forEach(N=>{R.includes(N.startTime)||R.push(N.startTime),R.includes(N.endTime)||R.push(N.endTime)}),R.sort((N,M)=>a(N)-a(M))});function g(R){return(a(R)-u.value)*2.5+KS-10}function y(R,N){if(!R||!N)return!1;const M=a(R.startTime),O=a(R.endTime),G=a(N.startTime),z=a(N.endTime);return M<z&&O>G}function E(R){const N=[];for(let O=0;O<R.length;O++){const G=R[O];let z=null;for(let j=0;j<N.length;j++)if(N[j].ids.some(H=>y(G,R.find(V=>V.id===H)))){z=N[j];break}z?(z.ids.push(G.id),z.blocks.push(G)):N.push({ids:[G.id],blocks:[G]})}let M=!0;for(;M;){M=!1;for(let O=0;O<N.length;O++){for(let G=O+1;G<N.length;G++)if(N[O].ids.some(z=>N[G].ids.some(j=>y(R.find(H=>H.id===z),R.find(H=>H.id===j))))){N[O].ids=Array.from(new Set([...N[O].ids,...N[G].ids])),N[O].blocks=Array.from(new Set([...N[O].blocks,...N[G].blocks])),N.splice(G,1),M=!0;break}if(M)break}}return N.map(O=>{const G=O.blocks.sort((H,V)=>H.startTime.localeCompare(V.startTime)||H.id.localeCompare(V.id)),z=G.reduce((H,V)=>V.startTime<H?V.startTime:H,G[0].startTime),j=G.reduce((H,V)=>V.endTime>H?V.endTime:H,G[0].endTime);return{ids:O.ids,startTime:z,endTime:j}})}Se(()=>E(b.value));const b=Se(()=>(r.blocks||[]).map((R,N)=>({...R,id:R.id||`block-${N}`})));function _(R){const N=[];for(let G=0;G<R.length;G++){const z=R[G];let j=null;for(let H=0;H<N.length;H++)if(N[H].some(V=>y(z,R.find(te=>te.id===V)))){j=N[H];break}j?j.push(z.id):N.push([z.id])}let M=!0;for(;M;){M=!1;for(let G=0;G<N.length;G++){for(let z=G+1;z<N.length;z++)if(N[G].some(j=>N[z].some(H=>y(R.find(V=>V.id===j),R.find(V=>V.id===H))))){N[G]=Array.from(new Set([...N[G],...N[z]])),N.splice(z,1),M=!0;break}if(M)break}}const O={};for(const G of N){const z=G.map(j=>R.find(H=>H.id===j)).sort((j,H)=>j.startTime.localeCompare(H.startTime)||j.id.localeCompare(H.id));z.forEach((j,H)=>{O[j.id]={groupSize:z.length,colIndex:H}})}return O}function v(R,N){const M=_(b.value)[R.id]||{groupSize:1,colIndex:0},O=g(R.startTime),G=(a(R.endTime)-a(R.startTime))*2.5,z=100/M.groupSize;return{position:"absolute",left:z*M.colIndex+"%",width:z+"%",top:O+"px",height:G+"px",zIndex:1,opacity:.38,boxSizing:"border-box",overflow:"hidden"}}function A(R,N){const M=i.value.filter((J,Q)=>{if(J.id===R.id)return!1;const ve=a(J.start),ee=a(J.end),K=a(R.start),Y=a(R.end);return ve<Y&&ee>K}),O=M.length+1,z=[R,...M].sort((J,Q)=>J.start.localeCompare(Q.start)||J.id.localeCompare(Q.id)).findIndex(J=>J.id===R.id),j=g(R.start),H=(a(R.end)-a(R.start))*2.5,V=Math.max(H,2.5),te=73,oe=27,ne=te/O;return{position:"absolute",left:oe+ne*z+"%",width:ne+"%",top:j+"px",height:V+"px",zIndex:2,minWidth:"80px",boxSizing:"border-box",padding:"4px",display:"flex",flexDirection:"column",alignItems:"flex-start",justifyContent:"flex-start",cursor:"grab",transition:"top 0.2s, height 0.2s"}}const D=se(null),k=se(0),T=se(0),x=se(null);function m(R,N){D.value=N,k.value=R.clientY,T.value=a(N.start),x.value="move",N.isDragging=!0,R.target.classList.add("background-dragging-div");const O=document.createElement("div");O.className="drag-preview-div",O.style.width="160px",O.style.height="40px",O.style.background="transparent",O.style.border="2px solid #007bff",O.style.position="absolute",O.style.top="-9999px",O.style.left="-9999px",document.body.appendChild(O),R.dataTransfer.setDragImage(O,80,20),R.dataTransfer.effectAllowed="move",R.dataTransfer.setData("text/plain",N.id)}function S(R,N){if(!D.value||R.clientY===0)return;const M=R.clientY-k.value,O=Math.round(M/2.5);if(x.value==="move"){let G=T.value+O,z=G+(a(N.end)-a(N.start));G=Math.max(u.value,Math.min(G,f.value-1)),z=Math.max(G+1,Math.min(z,f.value)),N.start=o(G),N.end=o(z)}}function I(R,N){D.value=null,x.value=null,N.isDragging=!1,n("update:assignments",i.value)}function C(R,N){D.value=N,k.value=R.clientY,T.value=a(N.end),x.value="resize",window.addEventListener("mousemove",F),window.addEventListener("mouseup",W)}function F(R){if(!D.value)return;const N=R.clientY-k.value;let M=T.value+Math.round(N/2.5);const O=a(D.value.start);M=Math.max(O+1,Math.min(M,f.value)),D.value.end=o(M)}function W(R){D.value=null,x.value=null,window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",W)}function P(R){const N=i.value.findIndex(M=>M.id===R);N!==-1&&(i.value.splice(N,1),n("update:assignments",i.value))}return(R,N)=>(L(),B("div",Rle,[d("div",{class:"vertical-time-grid",ref_key:"timeGridRef",ref:s,style:Nr({position:"relative",height:p.value+"px"})},[(L(!0),B(De,null,$e(b.value,(M,O)=>(L(),B("div",{key:M.id,class:Xe(["grid-block-bg",M.type==="period"?"blocktype-period":"blocktype-"+(M.type||"period")]),style:Nr(v(M))},[d("div",Fle,[d("span",{class:"grid-block-label",title:M.name||(M.type==="period"?M.label||M.periodName||M.periodNumber||"Period":M.type?M.type.charAt(0).toUpperCase()+M.type.slice(1):"")},Z(M.name||(M.type==="period"?M.label||M.periodName||M.periodNumber||"Period":M.type?M.type.charAt(0).toUpperCase()+M.type.slice(1):"")),9,Nle),d("span",{class:"grid-block-time",title:M.startTime},Z(M.startTime),9,Ole)])],6))),128)),(L(!0),B(De,null,$e(i.value,(M,O)=>(L(),B("div",{key:M.id,class:Xe(["dialog-assignment-box",["type-"+(M.type||"other"),{dragging:M.isDragging}]]),style:Nr(A(M)),draggable:"true",onDragstart:G=>m(G,M),onDrag:G=>S(G,M),onDragend:G=>I(G,M)},[d("div",Lle,[d("div",Ble,[d("span",Ule,Z(M.start)+"–"+Z(M.end)+" "+Z(M.label),1)])]),d("div",$le,[d("button",{class:"edit-btn",onClick:G=>R.$emit("edit-assignment",M)},"✏️",8,Vle),d("button",{class:"delete-btn",onClick:G=>P(M.id)},"🗑️",8,Hle)]),d("div",{class:"resize-handle",onMousedown:Yr(G=>C(G,M),["stop"]),title:"Drag to resize block"},null,40,jle)],46,Mle))),128))],4)]))}},Wle=St(Gle,[["__scopeId","data-v-8f5880e4"]]),zle={class:"dialog-header"},Kle={class:"dialog-header-actions"},qle={class:"dialog-content"},Xle={style:{display:"flex","align-items":"flex-start"}},Yle={class:"dialog-actions"},Qle=["disabled"],Jle={key:0},Zle={key:1},ece={__name:"AideScheduleEditDialog",props:{aideName:String,timeTicks:Array,isTickInAnyBlock:Function,aideAssignments:Array,getAssignmentBoxStyle:Function,onAssignmentDragStart:Function,onAssignmentDrag:Function,onAssignmentDragEnd:Function,onResizeStart:Function,showAddAssignment:Boolean,addAssignment:Function,onImportAssignments:Function,onSave:Function,onClose:Function,saving:Boolean,blocks:Array,teachers:Array,students:Array},setup(t){const e=t,r=se([]),n=se(!1),s=se(null);Gt(()=>{console.log("DEBUG: AideScheduleEditDialog mounted, blocks:",e.blocks)}),Ht(()=>e.blocks,f=>{console.log("DEBUG: props.blocks in AideScheduleEditDialog",f)});function i(){e.onSave(r.value)}function a(){r.value=e.aideAssignments?JSON.parse(JSON.stringify(e.aideAssignments)):[],n.value=!0}function o(f){r.value=e.aideAssignments?JSON.parse(JSON.stringify(e.aideAssignments)):[],s.value={...f},n.value=!0}function l(f){if(s.value){const h=r.value.findIndex(p=>p.id===f.id);h!==-1&&(r.value[h]={...f}),s.value=null}else r.value=[...r.value,f];n.value=!1}function c(){s.value=null,n.value=!1}function u(f){console.log("handleUpdateAssignments called with:",f),r.value=f}return(f,h)=>(L(),B("div",{class:"dialog-overlay",onClick:h[4]||(h[4]=(...p)=>t.onClose&&t.onClose(...p))},[d("div",{class:"edit-dialog",onClick:h[3]||(h[3]=Yr(()=>{},["stop"]))},[d("div",zle,[d("h2",null,"Edit Schedule: "+Z(t.aideName),1),d("div",Kle,[d("button",{onClick:h[0]||(h[0]=(...p)=>t.onImportAssignments&&t.onImportAssignments(...p)),class:"btn btn-secondary btn-import-assignments"},"Import Aide Assignments"),d("button",{onClick:a,class:"btn btn-primary btn-add-assignment"},"Add Assignment"),d("button",{onClick:h[1]||(h[1]=(...p)=>t.onClose&&t.onClose(...p)),class:"btn btn-secondary close-btn"},"×")])]),d("div",qle,[d("div",Xle,[Pe(Wle,{timeTicks:t.timeTicks,isTickInAnyBlock:t.isTickInAnyBlock,assignments:r.value,getAssignmentBoxStyle:t.getAssignmentBoxStyle,onAssignmentDragStart:t.onAssignmentDragStart,onAssignmentDrag:t.onAssignmentDrag,onAssignmentDragEnd:t.onAssignmentDragEnd,onResizeStart:t.onResizeStart,blocks:t.blocks,onEditAssignment:o,"onUpdate:assignments":u},null,8,["timeTicks","isTickInAnyBlock","assignments","getAssignmentBoxStyle","onAssignmentDragStart","onAssignmentDrag","onAssignmentDragEnd","onResizeStart","blocks"])]),n.value?(L(),Jt(Ple,{key:0,teachers:t.teachers,students:t.students,assignment:s.value,onSave:l,onClose:c},null,8,["teachers","students","assignment"])):_e("",!0)]),d("div",Yle,[d("button",{onClick:i,class:"btn btn-primary",disabled:t.saving},[t.saving?(L(),B("span",Jle,"💾")):(L(),B("span",Zle,"💾")),we(" "+Z(t.saving?"Saving...":"Save Schedule"),1)],8,Qle),d("button",{onClick:h[2]||(h[2]=(...p)=>t.onClose&&t.onClose(...p)),class:"btn btn-secondary"},"Cancel")])])]))}},tce={class:"master-schedule"},rce={key:0,class:"no-time-table"},nce={class:"no-data-message"},sce={key:1,class:"schedule-graph-container"},ace={class:"timeline-header"},ice={class:"block-time"},oce={class:"block-name"},lce={class:"block-time"},cce={class:"aide-header"},uce={class:"aide-name"},dce=["onClick"],fce={class:"time-line-container"},hce={class:"time-blocks-background"},pce={class:"assignment-bars"},mce={class:"assignment-label"},Og=30,gce={__name:"AideScheduleMasterTable",props:{paraeducators:Array,blocks:Array,getAideTimeBlocks:Function,getAideName:Function,currentTimeTable:Object},emits:["editAideAssignment","gotoTimeTableConfig"],setup(t,{emit:e}){const r=t,n=se([]);function s(b){const _=r.getAideTimeBlocks(b).filter(v=>v.assignment).map(v=>({id:v.id,label:v.assignment,type:v.assignmentType,start:v.start||v.displayTime.split(" - ")[0],end:v.end||v.displayTime.split(" - ")[1]}));return i(_)}function i(b){if(b.length===0)return[];const _=[...b].sort((k,T)=>f(k.start)-f(T.start)),v=[];let A=[];for(const k of _)A.length===0?A=[k]:A.some(x=>f(k.start)<f(x.end)&&f(k.end)>f(x.start))?A.push(k):(v.push(A),A=[k]);A.length>0&&v.push(A);const D=[];for(const k of v)k.forEach((T,x)=>{T.overlapIndex=x,T.overlapCount=k.length,D.push(T)});return D}function a(b){if(!b.overlapCount||b.overlapCount<=1)return 10;const _=40;return(60-(b.overlapCount*_+(b.overlapCount-1)*2))/2+b.overlapIndex*(_+2)}function o(b){if(!r.blocks||r.blocks.length===0)return 0;const _=r.blocks[0],v=r.blocks[r.blocks.length-1],A=f(_.startTime),k=f(v.endTime)-A,x=(f(b)-A)/k*100;return Math.max(0,Math.min(95,x))}function l(b,_){if(!r.blocks||r.blocks.length===0)return 10;const v=r.blocks[0],A=r.blocks[r.blocks.length-1],D=f(v.startTime),T=f(A.endTime)-D,x=f(b),S=(f(_)-x)/T*100;return Math.max(5,Math.min(95,S))}function c(b){if(!r.blocks||r.blocks.length===0)return 0;const _=r.blocks[0],v=r.blocks[r.blocks.length-1],A=f(_.startTime),k=f(v.endTime)-A,x=(f(b)-A)/k*100;return Math.max(0,Math.min(95,x))}function u(b,_){if(!r.blocks||r.blocks.length===0)return 10;const v=r.blocks[0],A=r.blocks[r.blocks.length-1],D=f(v.startTime),T=f(A.endTime)-D,x=f(b),S=(f(_)-x)/T*100;return Math.max(5,Math.min(95,S))}function f(b){const[_,v]=b.split(":").map(Number);return _*60+v}function h(b){var v;const _=((v=b.name)==null?void 0:v.toLowerCase())||"";return _.includes("lunch")?"lunch":_.includes("break")||_.includes("recess")?"break":_.includes("period")||_.includes("class")?"period":"other"}function p(b){const _=[...b].sort((D,k)=>f(D.startTime)-f(k.startTime)),v=[];for(const D of _){let k=!1;for(let T=0;T<v.length;T++){const x=v[T];if(!x.some(S=>f(D.startTime)<f(S.endTime)&&f(D.endTime)>f(S.startTime))){x.push(D),D.overlapIndex=T,k=!0;break}}k||(D.overlapIndex=v.length,v.push([D]))}const A=v.length;return _.map(D=>({...D,overlapIndex:D.overlapIndex,overlapCount:A}))}const g=Se(()=>p(r.blocks||[])),y=Se(()=>Math.max(...g.value.map(b=>b.overlapCount||1),1)),E=Se(()=>y.value*Og);return Ht(()=>r.aideAssignments,b=>{n.value=b?JSON.parse(JSON.stringify(b)):[]},{immediate:!0}),(b,_)=>(L(),B("div",tce,[_[4]||(_[4]=d("h2",null,"Master Schedule View",-1)),HA(b.$slots,"tab-bar",{},void 0,!0),!t.currentTimeTable||!t.currentTimeTable.schedule||t.currentTimeTable.schedule.length===0?(L(),B("div",rce,[d("div",nce,[_[1]||(_[1]=d("h3",null,"No Time Table Configured",-1)),_[2]||(_[2]=d("p",null,"You need to configure a time table first before you can create aide assignments.",-1)),d("button",{onClick:_[0]||(_[0]=v=>b.$emit("gotoTimeTableConfig")),class:"btn btn-primary"}," Go to Time Table Configuration ")])])):(L(),B("div",sce,[d("div",ace,[_[3]||(_[3]=d("div",{class:"aide-name-header"},"Aide Name",-1)),d("div",{class:"timeline-container",style:Nr({height:E.value+"px"})},[d("div",{class:"time-blocks-header",style:Nr({height:E.value+"px"})},[(L(!0),B(De,null,$e(g.value,v=>(L(),B("div",{key:v.id+"-"+v.overlapIndex,class:Xe(["time-block-header",h(v)]),style:Nr({left:o(v.startTime)+"%",width:l(v.startTime,v.endTime)+"%",top:v.overlapIndex*Og+"px",height:Og+"px",zIndex:10})},[d("div",ice,Z(v.startTime),1),d("div",oce,Z(v.name||v.type),1),d("div",lce,Z(v.endTime),1)],6))),128))],4)],4)]),(L(!0),B(De,null,$e(t.paraeducators,v=>(L(),B("div",{key:v.id,class:"aide-row"},[d("div",cce,[d("span",uce,Z(t.getAideName(v.id)),1),d("button",{onClick:A=>b.$emit("editAideAssignment",v.id),class:"btn btn-small btn-primary edit-btn"}," Edit ",8,dce)]),d("div",fce,[d("div",hce,[(L(!0),B(De,null,$e(t.blocks,A=>(L(),B("div",{key:A.id,class:Xe(["time-block-bg",h(A)]),style:Nr({left:o(A.startTime)+"%",width:l(A.startTime,A.endTime)+"%"})},null,6))),128)),(L(!0),B(De,null,$e(t.blocks.slice(0,-1),(A,D)=>(L(),B("div",{key:`bg-gap-${A.id}`,class:"time-block-bg-gap",style:Nr({left:o(A.endTime)-.5+"%",width:"1%"})},null,4))),128))]),d("div",pce,[(L(!0),B(De,null,$e(s(v.id),A=>(L(),B("div",{key:A.id,class:Xe(["master-assignment-bar",A.type]),style:Nr({left:c(A.start)+"%",width:u(A.start,A.end)+"%",top:a(A)+"px"})},[d("span",mce,Z(A.label),1)],6))),128))])])]))),128))]))]))}},vce=St(gce,[["__scopeId","data-v-40c5158e"]]);function u0(t){return(t==null?void 0:t.schedule)||[]}function yce(t){let e="23:59",r="00:00";for(const n of t)n.startTime&&n.startTime<e&&(e=n.startTime),n.endTime&&n.endTime>r&&(r=n.endTime);return{min:e,max:r}}function xce(t){return Se(()=>{const{min:e,max:r}=yce(t.value||t),[n,s]=e.split(":").map(Number),[i,a]=r.split(":").map(Number);let o=[],l=n,c=s;for(;l<i||l===i&&c<=a;){const f=l<10?`0${l}`:`${l}`,h=c<10?`0${c}`:`${c}`;o.push({time:`${f}:${h}`}),c+=5,c>=60&&(c=0,l++)}const u=(t.value||t).map(f=>f.startTime);for(const f of u)o.find(h=>h.time===f)||o.push({time:f});return o=Array.from(new Set(o.map(f=>f.time))).sort().map(f=>({time:f})),o})}function Ece(t,e){return e.some(r=>r.startTime<=t&&r.endTime>=t)}const _ce={class:"admin-aide-schedule-detailed"},bce={class:"header"},Sce={class:"header-actions"},Ace=["disabled"],Tce={key:0},wce={key:1},Cce={class:"content"},Ice={key:0,class:"error-message"},kce={key:1,class:"error-message"},Dce={key:2,class:"loading"},Pce={key:3,class:"schedule-container"},Rce={key:0,class:"time-table-tab-bar"},Fce=["onClick"],xD={__name:"AdminAideSchedule",setup(t){const e=ki(),r=on(),{userList:n,fetchUsers:s}=ba(),{students:i,fetchStudents:a}=Di(),{appSettings:o,loadAppSettings:l,saveAppSettings:c}=Ms(),{labels:u}=Eo(),{aideSchedule:f,loadAideSchedules:h,saveAideSchedule:p}=Foe(),{aideAssignment:g}=Jy(),y=se(!0),E=se(!1),b=se(null),_=se({}),v=se({}),A=se(null);se([]);const D=se({}),k=Se(()=>_.value&&Array.isArray(_.value.timeTables)&&_.value.timeTables.length>0?_.value.timeTables.map((de,Ee)=>({id:de.name?de.name.toLowerCase().replace(/\s+/g,"-"):`tt-${Ee}`,label:de.name||`Time Table ${Ee+1}`,...de})):_.value&&_.value.schedule?[{id:"default",label:_.value.label||"Default Schedule",schedule:_.value.schedule}]:[]);Gt(async()=>{console.log("Loaded timeTableData:",_.value),console.log("Computed allTimeTables:",k.value),k.value.length>0&&!A.value&&(A.value=k.value[0].id,console.log("Set selectedTimeTable:",A.value)),await l(),o.value.timeTables&&Array.isArray(o.value.timeTables)?(_.value={timeTables:o.value.timeTables},console.log("Set timeTableData to timeTables array:",_.value)):o.value.schedule&&(_.value={schedule:o.value.schedule},console.log("Set timeTableData to single schedule:",_.value))}),Ht(k,de=>{console.log("allTimeTables changed:",de)}),Ht(A,de=>{console.log("selectedTimeTable changed:",de)});const T=Se(()=>{const de=k.value.find(Ee=>Ee.id===A.value)||k.value[0];return console.log("currentTimeTable:",de),de}),x=Se(()=>u0(T.value)),m=xce(x);function S(de){return Ece(de,x.value)}const I=Se(()=>{var Ee;const de=(Ee=r.currentUser)==null?void 0:Ee.role;return["admin","school_admin","admin_504","sped_chair"].includes(de)}),C=Se(()=>{var de;return((de=n.value)==null?void 0:de.filter(Ee=>Ee.role==="paraeducator"))||[]}),F=Se(()=>{var de;return((de=n.value)==null?void 0:de.filter(Ee=>Ee.role==="teacher"))||[]});Se(()=>u.value);function W(de){if(!x.value)return[];console.log("DEBUG: getAideTimeBlocks called for aide:",de),console.log("DEBUG: aideSchedule.value:",f.value),console.log("DEBUG: aideAssignment.value:",g.value);const he=(f.value[de]||{}).schedule||{};console.log("DEBUG: aideScheduleData:",he);const Ce=Object.values(he).filter(Te=>Te.start&&Te.end&&Te.label).map(Te=>({id:Te.id||Te.blockId||`assignment-${Date.now()}`,assignment:Te.label,assignmentType:Te.type||"custom",displayTime:`${Te.start} - ${Te.end}`,start:Te.start,end:Te.end}));return console.log("DEBUG: individualAssignments:",Ce),Ce.length>0?Ce:(console.log("DEBUG: No individual assignments found, adding test data"),[{id:"test-1",assignment:"Test Class Assignment",assignmentType:"class",displayTime:"08:00 - 09:00",start:"08:00",end:"09:00"},{id:"test-2",assignment:"Test Student Assignment",assignmentType:"student",displayTime:"10:00 - 11:00",start:"10:00",end:"11:00"}])}function P(de){const Ee=C.value.find(he=>he.id===de);return Ee?Ee.name||Ee.email:"Unknown Aide"}function R(de){b.value=de,J.value=!0}function N(){b.value=null}async function M(){try{E.value=!0;const Ee={...await l(),detailedAideSchedule:v.value};await c(Ee),console.log("Detailed aide schedule saved successfully")}catch(de){console.error("Error saving detailed aide schedule:",de)}finally{E.value=!1}}function O(){e.push("/admin")}async function G(){try{y.value=!0,await Promise.all([s(),a(),l()]);const de=await qt(Ze(qe,"app_settings","global"));if(de.exists()){const Ee=de.data();v.value=Ee.detailedAideSchedule||{}}y.value=!1}catch(de){console.error("Error loading aide schedule data:",de),y.value=!1}}Gt(G);function z(de,Ee){return de.assignments&&de.assignments[Ee]||""}function j(){var Te,Ge;if(console.log("DEBUG: handleImportAssignments called"),console.log("DEBUG: editingAideId.value:",b.value),console.log("DEBUG: aideAssignment.value:",g.value),console.log("DEBUG: All aide IDs:",Object.keys(g.value)),console.log("DEBUG: All aide data:",Object.entries(g.value).map(([Ie,Ve])=>({id:Ie,keys:Object.keys(Ve)}))),!b.value||!g.value[b.value]){console.log("DEBUG: No aide data found"),alert("No aide assignment data found for this aide.");return}const de=Y.value.length;if(de>0&&!confirm(`WARNING: This will remove ${de} current assignments and replace them with imported assignments.

Do you want to continue?`))return;const Ee=g.value[b.value];console.log("DEBUG: aideData:",Ee),console.log("DEBUG: aideData.classAssignment:",Ee.classAssignment),console.log("DEBUG: aideData.directAssignment:",Ee.directAssignment),console.log("DEBUG: Object.keys(aideData):",Object.keys(Ee)),console.log("DEBUG: aideData.schedule:",Ee.schedule),console.log("DEBUG: typeof aideData.schedule:",typeof Ee.schedule),console.log("DEBUG: Array.isArray(aideData.schedule):",Array.isArray(Ee.schedule));let he=0;Y.value=[];const Ce=u0(T.value);console.log("DEBUG: timeTableBlocks:",Ce),console.log("DEBUG: timeTableBlocks with period numbers:",Ce.map(Ie=>({name:Ie.name,periodNumber:Ie.periodNumber,type:Ie.type})));for(const Ie of Ce){console.log("DEBUG: Processing block:",Ie),console.log("DEBUG: Block periodNumber:",Ie.periodNumber),console.log("DEBUG: Block name:",Ie.name),console.log("DEBUG: Available classAssignment keys:",Object.keys(Ee.classAssignment||{}));let Ve=Ie.periodNumber;if(!Ve&&Ie.name){const Ke=Ie.name.match(/Period\s*(\d+)/i);Ke&&(Ve=Ke[1],console.log("DEBUG: Extracted periodNumber from name:",Ve))}let Ue="",ze=[];if(Ve&&Ee.classAssignment&&Ee.classAssignment[Ve]){console.log("DEBUG: Found class assignment for periodNumber:",Ve);const Ke=Array.isArray(Ee.classAssignment[Ve])?Ee.classAssignment[Ve]:[Ee.classAssignment[Ve]];ze=Ke.filter(Boolean).map(ue=>{const be=F.value.find(Ae=>Ae.id===ue);return be?be.name||be.email:"Unknown Teacher"}),Ue=Ke.filter(Boolean).map(ue=>`teacher:${ue}`).join(","),console.log("DEBUG: Created assignment for periodNumber:",Ue)}if(!Ue&&Ie.name&&Ee.classAssignment){console.log("DEBUG: Trying to match by block name:",Ie.name);const Ke=Object.keys(Ee.classAssignment).find(ue=>ue.toLowerCase().trim()===Ie.name.toLowerCase().trim());if(Ke){console.log("DEBUG: Found match by block name:",Ke);const ue=Array.isArray(Ee.classAssignment[Ke])?Ee.classAssignment[Ke]:[Ee.classAssignment[Ke]];ze=ue.filter(Boolean).map(be=>{const Ae=F.value.find(Me=>Me.id===be);return Ae?Ae.name||Ae.email:"Unknown Teacher"}),Ue=ue.filter(Boolean).map(be=>`teacher:${be}`).join(","),console.log("DEBUG: Created assignment for block name:",Ue)}}if(Ue){const Ke=Ie.startTime,ue=H(Ie.startTime,30),be=Ue.split(",").map(Me=>Me.replace("teacher:","")).filter(Boolean),Ae={id:`imported-class-${Date.now()}-${he}`,label:ze.join(", "),start:Ke,end:ue,type:"class",blockId:`imported-block-${he}`,teacherId:be[0]||"",note:be.length>1?`Multiple teachers: ${ze.join(", ")}`:""};console.log("DEBUG: Adding new assignment:",Ae),Y.value.push(Ae),he++}}if(console.log("DEBUG: Checking direct assignments..."),console.log("DEBUG: aideData.directAssignment:",Ee.directAssignment),console.log("DEBUG: typeof aideData.directAssignment:",typeof Ee.directAssignment),console.log("DEBUG: Array.isArray(aideData.directAssignment):",Array.isArray(Ee.directAssignment)),Ee.directAssignment){console.log("DEBUG: Found directAssignment:",Ee.directAssignment);const Ie=Array.isArray(Ee.directAssignment)?Ee.directAssignment:[Ee.directAssignment];console.log("DEBUG: directStudentIds:",Ie),console.log("DEBUG: students.value length:",(Te=i.value)==null?void 0:Te.length),console.log("DEBUG: students.value sample:",(Ge=i.value)==null?void 0:Ge.slice(0,3));for(const Ve of Ie)if(console.log("DEBUG: Processing studentId:",Ve),Ve&&Ve!==""){const Ue=i.value.find(ze=>ze.id===Ve);if(console.log("DEBUG: Found student:",Ue),Ue){const ze=`${it(Ue,"firstName")} ${it(Ue,"lastName")}`;console.log("DEBUG: Student name:",ze);const Ke=u0(T.value).find(ue=>ue.type==="period");if(console.log("DEBUG: First period block:",Ke),Ke){const ue=Ke.startTime,be=H(Ke.startTime,30),Ae={id:`imported-direct-${Date.now()}-${he}`,label:ze,start:ue,end:be,type:"student",blockId:`imported-direct-block-${he}`,studentId:Ve};console.log("DEBUG: Adding direct assignment:",Ae),Y.value.push(Ae),he++}}}}else console.log("DEBUG: No directAssignment found");if(console.log("DEBUG: Final importedCount:",he),console.log("DEBUG: Final localAideAssignments:",Y.value),he>0){alert(`Successfully imported ${he} assignments with 30-minute time spans.

Types: Class assignments set to 'class', Direct assignments set to 'student'
Labels: Teacher names for class assignments, Student names for direct assignments
Duration: 30 minutes each`);const Ie=b.value,Ve=f.value[Ie]||{},Ue={};Y.value.forEach(Ke=>{const ue=Ke.blockId||Ke.id||`block-${Date.now()}-${Math.random().toString(36).slice(2)}`;Ue[ue]={id:Ke.id,blockId:ue,type:Ke.type,label:Ke.label,start:Ke.start,end:Ke.end,note:Ke.note,teacherId:Ke.teacherId,studentId:Ke.studentId}});const ze={...Ve,schedule:Ue};p(Ie,ze).then(()=>{h().then(()=>{N(),hl(()=>{R(Ie)})})})}else alert("No matching assignments found in the Aide Assignment data for this schedule.")}function H(de,Ee){const[he,Ce]=de.split(":").map(Number),Te=he*60+Ce+Ee,Ge=Math.floor(Te/60),Ie=Te%60;return`${Ge.toString().padStart(2,"0")}:${Ie.toString().padStart(2,"0")}`}Ht(()=>u0(T.value),de=>{const Ee={};for(const he of de){const Ce=z(he,b.value);Ee[he.id]=Ce?[{id:Ce,value:Ce}]:[]}D.value=Ee},{immediate:!0});function V(de,Ee){Q.value=Ee,ve.value=de.clientY,ee.value=m.value.findIndex(he=>he.time===Ee.start),K.value=0,de.dataTransfer.effectAllowed="move",de.dataTransfer.setData("text/plain",Ee.id)}function te(de,Ee){if(!Q.value||de.clientY===0)return;const he=de.clientY-ve.value;K.value=he,Ee._dragOffset=he}function oe(de,Ee){if(!Q.value)return;const he=24,Ce=m.value.length;let Te=ee.value+Math.round(K.value/he);Te=Math.max(0,Math.min(Ce-2,Te));const Ge=m.value[Te].time,Ie=m.value.findIndex(ze=>ze.time===Ee.end)-ee.value;let Ve=Te+Ie;Ve=Math.max(Te+1,Math.min(Ce-1,Ve));const Ue=m.value[Ve].time;Ee.start=Ge,Ee.end=Ue,Ee._dragOffset=0,Q.value=null,K.value=0}function ne(de){const Ee=m.value.findIndex(Ue=>Ue.time===de.start),he=m.value.findIndex(Ue=>Ue.time===de.end),Ce=24;if(Ee===-1||he===-1)return{display:"none"};const Te=Ee*Ce+(de._dragOffset||0),Ge=Math.max((he-Ee)*Ce,Ce);let Ie,Ve;return de.type==="class"?(Ie="#e8f4fd",Ve="#4a90e2"):de.type==="student"?(Ie="#f0f8e8",Ve="#7cb342"):(Ie="#f5f5f5",Ve="#9e9e9e"),{position:"absolute",left:"20px",top:`${Te}px`,height:`${Ge}px`,width:"200px",minHeight:"24px",background:Ie,borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:"#333",border:`2px solid ${Ve}`,boxShadow:"0 2px 8px rgba(0,0,0,0.1)",cursor:"grab",zIndex:2,transition:Q.value===de?"none":"top 0.2s"}}function le(){const de=x.value&&x.value.length>0?x.value[0].startTime:"08:00",Ee=x.value&&x.value.length>0?x.value[0].endTime:"08:30";Y.value.push({id:`custom:${Date.now()}`,label:"",start:de,end:Ee,blockId:`block-${Date.now()}`})}const J=se(!1);se(null);const Q=se(null),ve=se(0),ee=se(0),K=se(0),Y=se([]);Ht(b,de=>{if(!de){Y.value=[];return}const he=(f.value[de]||{}).schedule||{};Y.value=Object.entries(he).map(([Ce,Te])=>({id:Ce+"-"+(de||""),label:Te.label||"",start:Te.start,end:Te.end,blockId:Ce,type:Te.type||"lunch",teacherId:Te.teacherId||"",studentId:Te.studentId||"",note:Te.note||""}))},{immediate:!0});async function pe(de){if(b.value)try{E.value=!0;const Ee=f.value[b.value]||{},he={};de.forEach(Te=>{const Ge=Te.blockId||Te.id||`block-${Date.now()}-${Math.random().toString(36).slice(2)}`;he[Ge]={id:Te.id,blockId:Ge,type:Te.type,label:Te.label,start:Te.start,end:Te.end,note:Te.note,teacherId:Te.teacherId,studentId:Te.studentId}});const Ce={...Ee,schedule:he};await p(b.value,Ce),await h(),N(),alert("Schedule saved!")}catch(Ee){alert("Failed to save schedule: "+Ee.message)}finally{E.value=!1}}Ht(()=>x,de=>{console.log("DEBUG: blocks",de)},{immediate:!0}),Ht(b,de=>{de&&(console.log("DEBUG: Opening edit dialog for aide",de),console.log("DEBUG: blocks passed to dialog",x.value))});function xe(de,Ee){console.log("Resize start:",Ee)}function ae(){le()}return(de,Ee)=>(L(),B("div",_ce,[d("div",bce,[Ee[4]||(Ee[4]=d("h1",null,"Aide Schedule Management",-1)),d("div",Sce,[d("button",{onClick:M,class:"btn btn-primary",disabled:E.value},[E.value?(L(),B("span",Tce,"💾")):(L(),B("span",wce,"💾")),we(" "+Z(E.value?"Saving...":"Save Schedule"),1)],8,Ace),d("button",{onClick:O,class:"btn btn-secondary"},Ee[3]||(Ee[3]=[d("span",null,"←",-1),we(" Back ")]))])]),d("div",Cce,[q(r).currentUser?I.value?y.value?(L(),B("div",Dce," Loading aide schedules... ")):(L(),B("div",Pce,[Pe(vce,{paraeducators:C.value,blocks:x.value,getAideTimeBlocks:W,getAideName:P,currentTimeTable:T.value,onEditAideAssignment:R,onGotoTimeTableConfig:Ee[2]||(Ee[2]=()=>q(e).push("/admin?tab=time-table"))},{"tab-bar":Qh(()=>[k.value.length>1?(L(),B("div",Rce,[(L(!0),B(De,null,$e(k.value,he=>(L(),B("div",{key:he.id,class:Xe(["tab-btn",{active:A.value===he.id}]),onClick:Ce=>A.value=he.id},Z(he.label),11,Fce))),128))])):_e("",!0)]),_:1},8,["paraeducators","blocks","currentTimeTable"]),b.value?(L(),Jt(ece,{key:0,aideName:P(b.value),timeTicks:q(m),isTickInAnyBlock:S,aideAssignments:Y.value,getAssignmentBoxStyle:ne,onAssignmentDragStart:V,onAssignmentDrag:te,onAssignmentDragEnd:oe,onResizeStart:xe,showAddAssignment:J.value,addAssignment:ae,onImportAssignments:j,onSave:pe,onClose:N,saving:E.value,blocks:x.value,teachers:F.value,students:q(i)},null,8,["aideName","timeTicks","aideAssignments","showAddAssignment","saving","blocks","teachers","students"])):_e("",!0)])):(L(),B("div",kce,[Ee[7]||(Ee[7]=d("h2",null,"Access Denied",-1)),Ee[8]||(Ee[8]=d("p",null,"You do not have permission to access this page.",-1)),d("button",{onClick:Ee[1]||(Ee[1]=he=>q(e).push("/")),class:"btn btn-primary"},"Go Home")])):(L(),B("div",Ice,[Ee[5]||(Ee[5]=d("h2",null,"Authentication Required",-1)),Ee[6]||(Ee[6]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:Ee[0]||(Ee[0]=he=>q(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])]))}},Nce={name:"AdminBackupRestore",setup(){const t=on(),e=se([{id:"users",name:"Users"},{id:"students",name:"Students"},{id:"app_settings",name:"App Settings"},{id:"aideSchedules",name:"Aide Schedules"},{id:"aideAssignments",name:"Aide Assignments"},{id:"feedbackForms",name:"Teacher Feedback Forms"},{id:"config",name:"Configuration"},{id:"backups",name:"Backups Metadata"}]),r=se(["users","students","app_settings"]),n=se(""),s=se(!1),i=se(!1),a=se(null),o=se(null),l=se([]),c=se(""),u=se("info"),f=As({overwrite:!1,validate:!0}),h=se(null),p=async()=>{var k,T,x;try{console.log("🔍 DEBUG: Current user role:",(k=t.user)==null?void 0:k.role),console.log("🔍 DEBUG: Current user:",t.user);const m=At(qe,"backups"),S=cr(m,vn("createdAt","desc"),la(20)),I=await zt(S);l.value=I.docs.map(C=>({id:C.id,...C.data()})),console.log("✅ DEBUG: Successfully loaded",l.value.length,"backups")}catch(m){console.error("❌ DEBUG: Error loading backups:",m),console.error("❌ DEBUG: Error details:",{code:m.code,message:m.message,userRole:(T=t.user)==null?void 0:T.role,userId:(x=t.user)==null?void 0:x.uid}),D("Error loading backups","error")}},g=async()=>{if(r.value.length===0){D("Please select at least one collection","error");return}s.value=!0,D("Creating backup...","info");try{const k={metadata:{version:"1.0",createdAt:new Date().toISOString(),createdBy:"admin",description:n.value||"Manual backup"},collections:{}};for(const m of r.value)if(m==="app_settings"){const S=Ze(qe,"app_settings","global"),I=await qt(S);k.collections[m]=I.exists()?I.data():{}}else{const S=At(qe,m),I=await zt(S);k.collections[m]=I.docs.map(C=>({id:C.id,...C.data()}))}const T=`backup_${Date.now()}`,x=Ze(qe,"backups",T);await jt(x,{name:n.value||`Backup ${new Date().toLocaleDateString()}`,createdAt:new Date().toISOString(),collections:r.value,size:JSON.stringify(k).length,data:k}),n.value="",await p(),D("Backup created successfully!","success")}catch(k){console.error("Error creating backup:",k),D("Error creating backup: "+k.message,"error")}finally{s.value=!1}},y=k=>{const T=k.target.files[0];if(!T)return;a.value=T,o.value=null;const x=new FileReader;x.onload=m=>{try{const S=JSON.parse(m.target.result);S.metadata&&S.collections?(o.value=S,D("Backup file loaded successfully","success")):D("Invalid backup file format","error")}catch{D("Error parsing JSON file","error")}},x.readAsText(T)},E=async()=>{if(!a.value||!o.value){D("Please select a valid backup file","error");return}if(f.overwrite){if(!confirm("This will overwrite existing data. This action cannot be undone. Continue?"))return}else if(!confirm("This will add new data without overwriting existing records. Continue?"))return;i.value=!0,D("Restoring backup...","info");try{for(const[k,T]of Object.entries(o.value.collections))if(k==="app_settings"||k==="appSettings"){const x=Ze(qe,"app_settings","global");await jt(x,T,{merge:!f.overwrite})}else{const x=At(qe,k);if(Array.isArray(T))for(const m of T){const S=Ze(x,m.id);f.overwrite?await jt(S,m):await jt(S,m,{merge:!0})}}D("Backup restored successfully!","success"),a.value=null,o.value=null,h.value&&(h.value.value="")}catch(k){console.error("Error restoring backup:",k),D("Error restoring backup: "+k.message,"error")}finally{i.value=!1}},b=k=>{const T=JSON.stringify(k.data,null,2),x=new Blob([T],{type:"application/json"}),m=URL.createObjectURL(x),S=document.createElement("a");S.href=m,S.download=`${k.name||"backup"}.json`,S.target="_blank",S.rel="noopener noreferrer",document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL(m)},_=async k=>{if(confirm("Are you sure you want to delete this backup?"))try{await mo(Ze(qe,"backups",k)),await p(),D("Backup deleted successfully","success")}catch(x){console.error("Error deleting backup:",x),D("Error deleting backup","error")}},v=k=>{if(k===0)return"0 Bytes";const T=1024,x=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(k)/Math.log(T));return parseFloat((k/Math.pow(T,m)).toFixed(2))+" "+x[m]},A=k=>new Date(k).toLocaleString(),D=(k,T="info")=>{c.value=k,u.value=T,setTimeout(()=>{c.value=""},5e3)};return Gt(()=>{p()}),{collections:e,selectedCollections:r,backupName:n,isBackingUp:s,isRestoring:i,selectedFile:a,backupData:o,backups:l,statusMessage:c,statusType:u,restoreOptions:f,fileInput:h,createBackup:g,handleFileSelect:y,restoreBackup:E,downloadBackup:b,deleteBackup:_,formatFileSize:v,formatDate:A}}},Oce={class:"admin-backup-restore"},Mce={class:"content"},Lce={class:"section"},Bce={class:"backup-options"},Uce={class:"option-group"},$ce={class:"checkbox-group"},Vce=["value","disabled"],Hce={class:"option-group"},jce=["disabled"],Gce=["disabled"],Wce={key:0},zce={key:1},Kce={class:"section"},qce={class:"restore-options"},Xce={class:"file-upload"},Yce=["disabled"],Qce={key:0,class:"file-info"},Jce={key:0,class:"option-group"},Zce={class:"backup-info"},eue={class:"collection-name"},tue={class:"collection-count"},rue={key:1,class:"option-group"},nue={class:"checkbox-group"},sue={class:"checkbox"},aue=["disabled"],iue={class:"checkbox"},oue=["disabled"],lue=["disabled"],cue={key:0},uue={key:1},due={class:"section"},fue={key:0,class:"backup-list"},hue={class:"backup-info"},pue={class:"admin-action-btns"},mue=["onClick"],gue=["onClick"],vue={key:1,class:"no-backups"};function yue(t,e,r,n,s,i){return L(),B("div",Oce,[e[17]||(e[17]=d("h1",null,"🔧 Admin Tools",-1)),e[18]||(e[18]=d("div",{class:"header"},[d("h1",null,"Backup & Restore"),d("p",null,"Manage database backups and restore data from JSON files")],-1)),d("div",Mce,[d("div",Lce,[e[9]||(e[9]=d("h2",null,"Create Backup",-1)),d("div",Bce,[d("div",Uce,[e[7]||(e[7]=d("label",null,"Collections to backup:",-1)),d("div",$ce,[(L(!0),B(De,null,$e(n.collections,a=>(L(),B("label",{key:a.id,class:"checkbox"},[Ne(d("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>n.selectedCollections=o),value:a.id,disabled:n.isBackingUp},null,8,Vce),[[bt,n.selectedCollections]]),we(" "+Z(a.name),1)]))),128))])]),d("div",Hce,[e[8]||(e[8]=d("label",null,"Backup name (optional):",-1)),Ne(d("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>n.backupName=a),placeholder:"e.g., backup-2024-01-15",disabled:n.isBackingUp},null,8,jce),[[ft,n.backupName]])]),d("button",{onClick:e[2]||(e[2]=(...a)=>n.createBackup&&n.createBackup(...a)),disabled:n.isBackingUp||n.selectedCollections.length===0,class:"admin-action-btn primary",style:{"min-width":"140px","max-width":"140px"}},[n.isBackingUp?(L(),B("span",Wce,"Creating Backup...")):(L(),B("span",zce,"Create Backup"))],8,Gce)])]),d("div",Kce,[e[15]||(e[15]=d("h2",null,"Restore from Backup",-1)),d("div",qce,[d("div",Xce,[e[10]||(e[10]=d("label",null,"Select JSON backup file:",-1)),d("input",{type:"file",onChange:e[3]||(e[3]=(...a)=>n.handleFileSelect&&n.handleFileSelect(...a)),accept:".json",disabled:n.isRestoring,ref:"fileInput"},null,40,Yce),n.selectedFile?(L(),B("p",Qce," Selected: "+Z(n.selectedFile.name)+" ("+Z(n.formatFileSize(n.selectedFile.size))+") ",1)):_e("",!0)]),n.backupData?(L(),B("div",Jce,[e[11]||(e[11]=d("label",null,"Collections in backup:",-1)),d("div",Zce,[(L(!0),B(De,null,$e(n.backupData.collections,(a,o)=>(L(),B("div",{key:o,class:"collection-info"},[d("span",eue,Z(o)+":",1),d("span",tue,Z(Array.isArray(a)?a.length:"1")+" items",1)]))),128))])])):_e("",!0),n.backupData?(L(),B("div",rue,[e[14]||(e[14]=d("label",null,"Restore options:",-1)),d("div",nue,[d("label",sue,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=a=>n.restoreOptions.overwrite=a),disabled:n.isRestoring},null,8,aue),[[bt,n.restoreOptions.overwrite]]),e[12]||(e[12]=we(" Overwrite existing data "))]),d("label",iue,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=a=>n.restoreOptions.validate=a),disabled:n.isRestoring},null,8,oue),[[bt,n.restoreOptions.validate]]),e[13]||(e[13]=we(" Validate data before restore "))])])])):_e("",!0),d("button",{onClick:e[6]||(e[6]=(...a)=>n.restoreBackup&&n.restoreBackup(...a)),disabled:n.isRestoring||!n.selectedFile||!n.backupData,class:"admin-action-btn warning",style:{"min-width":"140px","max-width":"140px"}},[n.isRestoring?(L(),B("span",cue,"Restoring...")):(L(),B("span",uue,"Restore Backup"))],8,lue)])]),d("div",due,[e[16]||(e[16]=d("h2",null,"Backup History",-1)),n.backups.length>0?(L(),B("div",fue,[(L(!0),B(De,null,$e(n.backups,a=>(L(),B("div",{key:a.id,class:"backup-item"},[d("div",hue,[d("h3",null,Z(a.name||"Unnamed Backup"),1),d("p",null,"Created: "+Z(n.formatDate(a.createdAt)),1),d("p",null,"Size: "+Z(n.formatFileSize(a.size)),1),d("p",null,"Collections: "+Z(a.collections.join(", ")),1)]),d("div",pue,[d("button",{onClick:o=>n.downloadBackup(a),class:"admin-action-btn secondary"},"Download",8,mue),d("button",{onClick:o=>n.deleteBackup(a.id),class:"admin-action-btn delete"},"Delete",8,gue)])]))),128))])):(L(),B("p",vue,"No backups found"))])]),n.statusMessage?(L(),B("div",{key:0,class:Xe(["status-message",n.statusType])},Z(n.statusMessage),3)):_e("",!0)])}const ED=St(Nce,[["render",yue],["__scopeId","data-v-95273eef"]]),xue={class:"admin-audit-logs"},Eue={class:"log-controls"},_ue={class:"log-filters"},bue=["disabled"],Sue=["disabled"],Aue={class:"logs-container"},Tue={key:0,class:"loading-state"},wue={key:1,class:"logs-table"},Cue={class:"timestamp"},Iue={class:"log-type"},kue={class:"user-info"},Due={class:"user-email"},Pue={class:"user-id"},Rue={class:"action"},Fue={class:"details"},Nue={class:"details-preview"},Oue={class:"actions"},Mue=["onClick"],Lue={key:2,class:"no-logs"},Bue={key:1,class:"pagination"},Uue=["disabled"],$ue={class:"page-info"},Vue=["disabled"],Hue={class:"dialog-content"},jue={class:"log-detail-section"},Gue={class:"detail-grid"},Wue={class:"detail-item"},zue={class:"detail-item"},Kue={class:"detail-item"},que={class:"detail-item"},Xue={class:"detail-item"},Yue={class:"detail-item"},Que={class:"detail-item"},Jue={key:0,class:"log-detail-section"},Zue={class:"detail-grid"},ede={key:0,class:"detail-item"},tde={key:1,class:"detail-item"},rde={key:2,class:"detail-item"},nde={key:1,class:"log-detail-section"},sde={class:"details-content"},ade={key:2,class:"log-detail-section"},ide={class:"detail-grid"},ode={key:0,class:"detail-item"},lde={key:1,class:"detail-item"},d0=25,cde={__name:"AdminAuditLogs",setup(t){const e=xo(),r=se([]),n=se(!1),s=se(""),i=se(!1),a=se(null),o=se("7"),l=se(""),c=se(""),u=se(""),f=se(1),h=Se(()=>{let I=r.value;if(l.value&&(I=I.filter(C=>C.type===l.value)),c.value&&(I=I.filter(C=>C.action===c.value)),u.value){const C=u.value.toLowerCase();I=I.filter(F=>F.userEmail&&F.userEmail.toLowerCase().includes(C)||F.action&&F.action.toLowerCase().includes(C)||F.details&&JSON.stringify(F.details).toLowerCase().includes(C)||F.studentId&&F.studentId.toLowerCase().includes(C))}return I}),p=Se(()=>{const I=(f.value-1)*d0,C=I+d0;return h.value.slice(I,C)}),g=Se(()=>Math.ceil(h.value.length/d0)),y=async()=>{n.value=!0,s.value="";try{const I=new Date;I.setDate(I.getDate()-parseInt(o.value));const C=cr(At(e,"auditLogs"),Ur("timestamp",">=",I),vn("timestamp","desc"),la(500)),F=await zt(C);r.value=F.docs.map(W=>({id:W.id,...W.data()})),f.value=1,x(`Loaded ${r.value.length} audit logs`,!1)}catch(I){console.error("Error loading audit logs:",I),x("Error loading audit logs: "+I.message,!0)}finally{n.value=!1}},E=async()=>{try{const I=b(h.value),C=new Blob([I],{type:"text/csv"}),F=window.URL.createObjectURL(C),W=document.createElement("a");W.href=F,W.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,W.click(),window.URL.revokeObjectURL(F),x("Audit logs exported successfully",!1)}catch(I){console.error("Error exporting logs:",I),x("Error exporting logs: "+I.message,!0)}},b=I=>{const F=[["Timestamp","Type","User Email","User ID","Action","Details","Student ID","Session ID","IP Address"].join(",")];return I.forEach(W=>{const P=[A(W.timestamp),W.type||"",W.userEmail||W.performedByEmail||"",W.userId||W.performedBy||"",W.action||"",JSON.stringify(W.details||"").replace(/"/g,'""'),W.studentId||W.targetUserId||"",W.sessionId||"",W.ipAddress||""];F.push(P.map(R=>`"${R}"`).join(","))}),F.join(`
`)},_=I=>{a.value=I},v=()=>{a.value=null},A=I=>{if(!I)return"N/A";let C;return I.toDate?C=I.toDate():I instanceof Date?C=I:C=new Date(I),C.toLocaleString()},D=I=>({student_access:"Student Access",user_management:"User Management",system_access:"System Access",data_export:"Data Export",session_timeout:"Session Timeout"})[I]||I,k=I=>{if(I.details){const F=typeof I.details=="string"?I.details:JSON.stringify(I.details);return F.length>50?F.substring(0,50)+"...":F}const C=[];return I.studentId&&C.push(`Student: ${I.studentId}`),I.targetUserId&&C.push(`Target: ${I.targetUserId}`),I.exportType&&C.push(`Export: ${I.exportType}`),I.studentCount&&C.push(`Count: ${I.studentCount}`),C.join(", ")||"No additional details"},T=I=>{if(!I)return"No details available";if(typeof I=="string")try{const C=JSON.parse(I);return JSON.stringify(C,null,2)}catch{return I}return JSON.stringify(I,null,2)},x=(I,C=!1)=>{s.value=I,i.value=C,setTimeout(()=>{s.value="",i.value=!1},5e3)};let m=null;const S=()=>{m&&clearTimeout(m),m=setTimeout(()=>{f.value=1},300)};return Gt(()=>{y()}),(I,C)=>(L(),B("div",xue,[C[29]||(C[29]=d("div",{class:"logs-header"},[d("h2",null,"📋 System Audit Logs"),d("p",{class:"logs-description"}," View and search system audit logs for security monitoring and compliance. ")],-1)),d("div",Eue,[d("div",_ue,[Ne(d("select",{"onUpdate:modelValue":C[0]||(C[0]=F=>o.value=F),onChange:y,class:"form-select"},C[7]||(C[7]=[d("option",{value:"1"},"Last 24 hours",-1),d("option",{value:"7"},"Last 7 days",-1),d("option",{value:"30"},"Last 30 days",-1),d("option",{value:"90"},"Last 90 days",-1)]),544),[[sr,o.value]]),Ne(d("select",{"onUpdate:modelValue":C[1]||(C[1]=F=>l.value=F),onChange:y,class:"form-select"},C[8]||(C[8]=[Rn('<option value="" data-v-aacc574e>All Log Types</option><option value="student_access" data-v-aacc574e>Student Access</option><option value="user_management" data-v-aacc574e>User Management</option><option value="system_access" data-v-aacc574e>System Access</option><option value="data_export" data-v-aacc574e>Data Export</option><option value="session_timeout" data-v-aacc574e>Session Timeout</option>',6)]),544),[[sr,l.value]]),Ne(d("select",{"onUpdate:modelValue":C[2]||(C[2]=F=>c.value=F),onChange:y,class:"form-select"},C[9]||(C[9]=[Rn('<option value="" data-v-aacc574e>All Actions</option><option value="login" data-v-aacc574e>Login</option><option value="logout" data-v-aacc574e>Logout</option><option value="create" data-v-aacc574e>Create</option><option value="edit" data-v-aacc574e>Edit</option><option value="delete" data-v-aacc574e>Delete</option><option value="view" data-v-aacc574e>View</option><option value="admin_panel_access" data-v-aacc574e>Admin Access</option>',8)]),544),[[sr,c.value]]),Ne(d("input",{"onUpdate:modelValue":C[3]||(C[3]=F=>u.value=F),onInput:S,type:"text",placeholder:"Search logs...",class:"form-input"},null,544),[[ft,u.value]]),d("button",{onClick:y,class:"btn btn-secondary",disabled:n.value}," 🔄 "+Z(n.value?"Loading...":"Refresh"),9,bue),d("button",{onClick:E,class:"btn btn-primary",disabled:n.value}," 📊 Export Logs ",8,Sue)])]),s.value?(L(),B("div",{key:0,class:Xe(["status-message",{error:i.value}])},Z(s.value),3)):_e("",!0),d("div",Aue,[n.value?(L(),B("div",Tue," Loading audit logs... ")):h.value.length>0?(L(),B("table",wue,[C[10]||(C[10]=d("thead",null,[d("tr",null,[d("th",null,"Timestamp"),d("th",null,"Type"),d("th",null,"User"),d("th",null,"Action"),d("th",null,"Details"),d("th",null,"Actions")])],-1)),d("tbody",null,[(L(!0),B(De,null,$e(p.value,F=>(L(),B("tr",{key:F.id,class:"log-row"},[d("td",Cue,Z(A(F.timestamp)),1),d("td",Iue,[d("span",{class:Xe(["type-badge",F.type])},Z(D(F.type)),3)]),d("td",kue,[d("div",Due,Z(F.userEmail||"Unknown"),1),d("div",Pue,Z(F.userId||F.performedBy||"N/A"),1)]),d("td",Rue,Z(F.action||"N/A"),1),d("td",Fue,[d("div",Nue,Z(k(F)),1)]),d("td",Oue,[d("button",{onClick:W=>_(F),class:"btn btn-sm btn-info",title:"View Details"}," 👁️ View ",8,Mue)])]))),128))])])):(L(),B("div",Lue,C[11]||(C[11]=[d("p",null,"No audit logs found for the selected criteria.",-1)])))]),h.value.length>d0?(L(),B("div",Bue,[d("button",{onClick:C[4]||(C[4]=F=>f.value--),disabled:f.value===1,class:"btn btn-secondary"}," Previous ",8,Uue),d("span",$ue," Page "+Z(f.value)+" of "+Z(g.value)+" ("+Z(h.value.length)+" logs) ",1),d("button",{onClick:C[5]||(C[5]=F=>f.value++),disabled:f.value===g.value,class:"btn btn-secondary"}," Next ",8,Vue)])):_e("",!0),a.value?(L(),B("div",{key:2,class:"log-dialog-overlay",onClick:v},[d("div",{class:"log-dialog",onClick:C[6]||(C[6]=Yr(()=>{},["stop"]))},[d("div",{class:"dialog-header"},[C[12]||(C[12]=d("h3",null,"📋 Audit Log Details",-1)),d("button",{onClick:v,class:"close-btn"},"✕")]),d("div",Hue,[d("div",jue,[C[20]||(C[20]=d("h4",null,"Basic Information",-1)),d("div",Gue,[d("div",Wue,[C[13]||(C[13]=d("label",null,"Timestamp:",-1)),d("span",null,Z(A(a.value.timestamp)),1)]),d("div",zue,[C[14]||(C[14]=d("label",null,"Log Type:",-1)),d("span",{class:Xe(["type-badge",a.value.type])},Z(D(a.value.type)),3)]),d("div",Kue,[C[15]||(C[15]=d("label",null,"Action:",-1)),d("span",null,Z(a.value.action||"N/A"),1)]),d("div",que,[C[16]||(C[16]=d("label",null,"User Email:",-1)),d("span",null,Z(a.value.userEmail||a.value.performedByEmail||"Unknown"),1)]),d("div",Xue,[C[17]||(C[17]=d("label",null,"User ID:",-1)),d("span",null,Z(a.value.userId||a.value.performedBy||"N/A"),1)]),d("div",Yue,[C[18]||(C[18]=d("label",null,"Session ID:",-1)),d("span",null,Z(a.value.sessionId||"N/A"),1)]),d("div",Que,[C[19]||(C[19]=d("label",null,"IP Address:",-1)),d("span",null,Z(a.value.ipAddress||"N/A"),1)])])]),a.value.studentId||a.value.targetUserId?(L(),B("div",Jue,[C[24]||(C[24]=d("h4",null,"Target Information",-1)),d("div",Zue,[a.value.studentId?(L(),B("div",ede,[C[21]||(C[21]=d("label",null,"Student ID:",-1)),d("span",null,Z(a.value.studentId),1)])):_e("",!0),a.value.targetUserId?(L(),B("div",tde,[C[22]||(C[22]=d("label",null,"Target User ID:",-1)),d("span",null,Z(a.value.targetUserId),1)])):_e("",!0),a.value.studentIds?(L(),B("div",rde,[C[23]||(C[23]=d("label",null,"Student IDs:",-1)),d("span",null,Z(Array.isArray(a.value.studentIds)?a.value.studentIds.join(", "):a.value.studentIds),1)])):_e("",!0)])])):_e("",!0),a.value.details?(L(),B("div",nde,[C[25]||(C[25]=d("h4",null,"Additional Details",-1)),d("div",sde,[d("pre",null,Z(T(a.value.details)),1)])])):_e("",!0),a.value.exportType||a.value.studentCount?(L(),B("div",ade,[C[28]||(C[28]=d("h4",null,"Export Information",-1)),d("div",ide,[a.value.exportType?(L(),B("div",ode,[C[26]||(C[26]=d("label",null,"Export Type:",-1)),d("span",null,Z(a.value.exportType),1)])):_e("",!0),a.value.studentCount?(L(),B("div",lde,[C[27]||(C[27]=d("label",null,"Student Count:",-1)),d("span",null,Z(a.value.studentCount),1)])):_e("",!0)])])):_e("",!0)]),d("div",{class:"dialog-actions"},[d("button",{onClick:v,class:"btn btn-secondary"},"Close")])])])):_e("",!0)]))}},ude=St(cde,[["__scopeId","data-v-aacc574e"]]),dde={class:"teacher-feedback-admin"},fde={key:0,class:"status-message loading"},hde={key:1,class:"status-message success"},pde={key:2,class:"status-message error"},mde={class:"quick-actions"},gde=["disabled"],vde={class:"modal-body"},yde={class:"form-group"},xde={class:"form-group"},Ede={class:"form-group"},_de={class:"form-group"},bde={class:"modal-footer"},Sde=["disabled"],Ade={key:0},Tde={key:1},wde={class:"setup-section"},Cde={key:0,class:"loading-state"},Ide={key:1,class:"status-card"},kde={class:"status-header"},Dde={class:"status-indicator"},Pde={key:0,class:"status-badge success"},Rde={key:1,class:"status-badge info"},Fde={class:"status-details"},Nde={key:0},Ode={key:1},Mde={key:0},Lde={key:1,class:"info-note"},Bde={key:0,class:"drive-actions"},Ude=["href"],$de={key:2,class:"setup-options"},Vde={class:"setup-card"},Hde={class:"workspace-setup"},jde={class:"form-group"},Gde=["disabled"],Wde=["disabled"],zde={key:0},Kde={key:1},qde={class:"forms-list"},Xde={key:0,class:"loading"},Yde={key:1,class:"empty-state"},Qde={key:2,class:"forms-grid"},Jde={class:"form-header"},Zde={class:"admin-action-btns"},efe=["onClick"],tfe=["onClick"],rfe=["onClick"],nfe={class:"form-meta"},sfe={key:0},afe=["href"],ife={key:1},ofe=["href"],lfe={key:2,class:"sheet-status pending"},cfe={__name:"AdminTeacherFeedback",setup(t){const{isLoading:e,error:r,successMessage:n,formsLoading:s,activeForms:i,createFeedbackFormWithUserAuth:a,deleteFeedbackForm:o,clearMessages:l}=Zy();ba();const c=on(),u=se(!1),f=se(""),h=se(""),p=se(""),g=se(""),y=se(null),E=se(!0),b=se(""),_=se("info"),v=se(""),A=se(!1),D=Se(()=>f.value.trim()&&p.value.trim()),k=async()=>{if(D.value)try{l();const{GoogleAuthProvider:P,signInWithPopup:R,getAuth:N}=await ua(async()=>{const{GoogleAuthProvider:V,signInWithPopup:te,getAuth:oe}=await Promise.resolve().then(()=>V5);return{GoogleAuthProvider:V,signInWithPopup:te,getAuth:oe}},void 0),M=N(),O=new P;O.addScope("https://www.googleapis.com/auth/drive.file"),O.addScope("https://www.googleapis.com/auth/spreadsheets");let G;try{G=await R(M,O)}catch(V){throw V.code==="auth/popup-closed-by-user"||V.message.includes("Cross-Origin-Opener-Policy")?new Error("❌ Authentication popup was blocked or closed. Please allow popups for this site and try again."):V}const j=P.credentialFromResult(G).accessToken;if(!j)throw new Error("Failed to get Google access token. Please try again.");console.log("✅ Got Google access token for feedback form creation");const H={title:f.value.trim(),description:h.value.trim(),formUrl:p.value.trim(),sheetTemplateUrl:g.value.trim(),createdBy:c.user.uid};await a(H,j),T()}catch(P){console.error("Error adding form:",P),P.code==="auth/popup-closed-by-user"?P.value="❌ Authentication cancelled. Please try again and allow Google Drive access.":P.code==="auth/popup-blocked"?P.value="❌ Popup blocked. Please allow popups for this site and try again.":P.message&&P.message.includes("Cross-Origin-Opener-Policy")?P.value="❌ Browser security policy blocked the authentication popup. Please try again or contact support.":P.value=P.message||"Failed to create feedback form"}},T=()=>{u.value=!1,f.value="",h.value="",p.value="",g.value="",l()},x=P=>{window.open(P.formUrl,"_blank","noopener,noreferrer")},m=async P=>{window.open(P.formUrl,"_blank","noopener,noreferrer")},S=async P=>{if(confirm(`Are you sure you want to delete "${P.title}"?`))try{await o(P.id)}catch(R){console.error("Error deleting form:",R)}},I=P=>P?(P.seconds?new Date(P.seconds*1e3):new Date(P)).toLocaleDateString():"N/A",C=async()=>{try{E.value=!0;const{getFunctions:P,httpsCallable:R}=await ua(async()=>{const{getFunctions:G,httpsCallable:z}=await Promise.resolve().then(()=>C0);return{getFunctions:G,httpsCallable:z}},void 0),N=P(),O=await R(N,"getUserSchool")();O.data.success&&O.data.school?y.value=O.data.school:await F()}catch(P){console.error("Error loading school info:",P),b.value="Error loading Google Drive settings",_.value="error"}finally{E.value=!1}},F=async()=>{try{const{getFunctions:P,httpsCallable:R}=await ua(async()=>{const{getFunctions:G,httpsCallable:z}=await Promise.resolve().then(()=>C0);return{getFunctions:G,httpsCallable:z}},void 0),N=P(),O=await R(N,"getOrCreateSchool")();O.data.success&&(y.value=O.data.school,O.data.school.isNew&&(b.value="Google Drive settings initialized! You can now create feedback forms.",_.value="success"))}catch(P){console.error("Error creating school:",P),b.value="Error initializing Google Drive settings: "+P.message,_.value="error"}},W=async()=>{if(v.value.trim()){A.value=!0,b.value="";try{const{getFunctions:P,httpsCallable:R}=await ua(async()=>{const{getFunctions:G,httpsCallable:z}=await Promise.resolve().then(()=>C0);return{getFunctions:G,httpsCallable:z}},void 0),N=P(),O=await R(N,"createSharedDrive")({schoolId:y.value.schoolId,driveName:v.value.trim()});if(O.data.requiresManualCreation){const G=O.data.instructions,z=O.data.serviceAccountEmail;b.value=`Google Workspace setup requires manual configuration:

1. ${G.join(`
2. `)}

Service Account Email: ${z}`,_.value="info"}else O.data.success?(b.value="Google Workspace setup completed successfully!",_.value="success",await C(),v.value=""):(b.value="Error setting up Google Workspace: "+O.data.error,_.value="error")}catch(P){console.error("Error setting up workspace:",P),b.value="Error setting up Google Workspace: "+P.message,_.value="error"}finally{A.value=!1}}};return Gt(async()=>{await C()}),(P,R)=>{var N;return L(),B("div",dde,[R[35]||(R[35]=d("div",{class:"admin-header"},[d("h2",null,"Teacher Feedback Forms"),d("p",{class:"admin-description"}," Create and manage Google Forms for collecting teacher feedback on students. Each case manager will have their own response sheet automatically created when they first use the form. ")],-1)),q(e)?(L(),B("div",fde," Processing... ")):_e("",!0),q(n)?(L(),B("div",hde,Z(q(n)),1)):_e("",!0),q(r)?(L(),B("div",pde,Z(q(r)),1)):_e("",!0),d("div",mde,[d("button",{onClick:R[0]||(R[0]=M=>u.value=!0),class:"primary-btn",disabled:q(e)},R[7]||(R[7]=[d("span",null,"📝",-1),we(" Add Form ")]),8,gde)]),u.value?(L(),B("div",{key:3,class:"modal-overlay",onClick:T},[d("div",{class:"modal-content",onClick:R[5]||(R[5]=Yr(()=>{},["stop"]))},[d("div",{class:"modal-header"},[R[8]||(R[8]=d("h3",null,"Add Teacher Feedback Form",-1)),d("button",{onClick:T,class:"close-btn"},"×")]),d("div",vde,[d("div",yde,[R[9]||(R[9]=d("label",null,"Form Title:",-1)),Ne(d("input",{type:"text","onUpdate:modelValue":R[1]||(R[1]=M=>f.value=M),placeholder:"Enter a descriptive title for this form",class:"form-input",required:""},null,512),[[ft,f.value]])]),d("div",xde,[R[10]||(R[10]=d("label",null,"Form Description (optional):",-1)),Ne(d("textarea",{"onUpdate:modelValue":R[2]||(R[2]=M=>h.value=M),placeholder:"Brief description of what this form is for",class:"form-textarea",rows:"3"},null,512),[[ft,h.value]])]),d("div",Ede,[R[11]||(R[11]=d("label",null,"Google Form URL:",-1)),Ne(d("input",{type:"url","onUpdate:modelValue":R[3]||(R[3]=M=>p.value=M),placeholder:"https://docs.google.com/forms/d/your-form-id/viewform",class:"form-input",required:""},null,512),[[ft,p.value]]),R[12]||(R[12]=d("small",{class:"form-help"},"Paste the Google Form URL here (viewform link)",-1))]),d("div",_de,[R[13]||(R[13]=d("label",null,"Google Sheet Template URL (optional):",-1)),Ne(d("input",{type:"url","onUpdate:modelValue":R[4]||(R[4]=M=>g.value=M),placeholder:"https://docs.google.com/spreadsheets/d/your-sheet-id/edit",class:"form-input"},null,512),[[ft,g.value]]),R[14]||(R[14]=d("small",{class:"form-help"},"Optional: Provide a Google Sheet template that case managers can duplicate for collecting responses",-1))]),R[15]||(R[15]=d("div",{class:"form-info"},[d("h4",null,"📋 Setup Instructions:"),d("ol",null,[d("li",null,"Create your Google Form manually with the questions you want"),d("li",null,'Make sure to enable "Collect email addresses" in form settings'),d("li",null,"Copy the form's view URL and paste it above"),d("li",null,'Click "Add Form" - a Google Sheet will be automatically created for responses')]),d("p",{class:"info-note"},[d("strong",null,"✅ Automatic:"),we(" A Google Sheet will be created immediately when you add the form. Each case manager will get their own copy of this sheet when they use the form. ")])],-1))]),d("div",bde,[d("button",{onClick:T,class:"secondary-btn"},"Cancel"),d("button",{onClick:k,class:"primary-btn",disabled:!D.value||q(e)},[q(e)?(L(),B("span",Ade,"Adding Form...")):(L(),B("span",Tde,"Add Form"))],8,Sde)])])])):_e("",!0),d("div",wde,[R[25]||(R[25]=d("h3",null,"Google Drive Setup",-1)),R[26]||(R[26]=d("p",{class:"section-description"}," Configure how the system accesses Google Drive for creating feedback forms and response sheets. ",-1)),E.value?(L(),B("div",Cde,R[16]||(R[16]=[d("p",null,"Loading Google Drive settings...",-1)]))):y.value?(L(),B("div",Ide,[d("div",kde,[d("h4",null,Z(y.value.name||"Your School"),1),d("div",Dde,[y.value.sharedDriveId?(L(),B("span",Pde," ✅ Google Workspace Mode ")):(L(),B("span",Rde," 📁 Personal Google Drive Mode "))])]),d("div",Fde,[d("p",null,[R[17]||(R[17]=d("strong",null,"Current Mode:",-1)),y.value.sharedDriveId?(L(),B("span",Nde,"Google Workspace Shared Drive")):(L(),B("span",Ode,"Personal Google Drive"))]),y.value.sharedDriveId?(L(),B("p",Mde,[R[18]||(R[18]=d("strong",null,"Shared Drive:",-1)),we(" "+Z(y.value.sharedDriveName||"CaseManageVue Templates"),1)])):_e("",!0),y.value.sharedDriveId?_e("",!0):(L(),B("p",Lde,R[19]||(R[19]=[d("strong",null,"Note:",-1),we(" Files will be created in your personal Google Drive when you create forms. ")])))]),y.value.sharedDriveId?(L(),B("div",Bde,[d("a",{href:`https://drive.google.com/drive/folders/${y.value.sharedDriveId}`,target:"_blank",class:"secondary-btn"}," 📂 Open Shared Drive ",8,Ude)])):_e("",!0)])):_e("",!0),!E.value&&!((N=y.value)!=null&&N.sharedDriveId)?(L(),B("div",$de,[R[24]||(R[24]=d("div",{class:"setup-card"},[d("h4",null,"📁 Personal Google Drive (Recommended for Testing)"),d("p",{class:"setup-description"}," Use your personal Google account to create forms and sheets. Files will be created in your personal Drive. "),d("div",{class:"setup-note"},[d("strong",null,"✅ Ready to use:"),we(" No additional setup required. When you create forms, you'll be prompted to sign in with your Google account. ")])],-1)),d("div",Vde,[R[22]||(R[22]=d("h4",null,"🌐 Google Workspace (For Organizations)",-1)),R[23]||(R[23]=d("p",{class:"setup-description"}," Use a Google Workspace Shared Drive for organization-wide access and management. ",-1)),d("div",Hde,[d("div",jde,[R[20]||(R[20]=d("label",{for:"workspaceDriveName"},"Shared Drive Name:",-1)),Ne(d("input",{id:"workspaceDriveName","onUpdate:modelValue":R[6]||(R[6]=M=>v.value=M),type:"text",class:"form-input",placeholder:"e.g., CaseManageVue - School Name",disabled:A.value},null,8,Gde),[[ft,v.value]])]),d("button",{onClick:W,class:"primary-btn",disabled:A.value||!v.value.trim()},[A.value?(L(),B("span",zde,"🔄 Setting up...")):(L(),B("span",Kde,"Setup Google Workspace"))],8,Wde),R[21]||(R[21]=d("div",{class:"workspace-note"},[d("strong",null,"Note:"),we(" This requires Google Workspace admin permissions and manual configuration. ")],-1))])])])):_e("",!0),b.value?(L(),B("div",{key:3,class:Xe(["alert",_.value])},Z(b.value),3)):_e("",!0)]),d("div",qde,[R[34]||(R[34]=d("h3",null,"Feedback Forms",-1)),q(s)?(L(),B("div",Xde,"Loading forms...")):q(i).length===0?(L(),B("div",Yde,R[27]||(R[27]=[d("p",null,"No feedback forms added yet.",-1),d("p",null,'Click "Add Form" to get started.',-1)]))):(L(),B("div",Qde,[(L(!0),B(De,null,$e(q(i),M=>(L(),B("div",{key:M.id,class:"form-card"},[d("div",Jde,[d("h4",null,Z(M.title||"Untitled Form"),1),d("div",Zde,[d("button",{onClick:O=>x(M),class:"admin-action-btn info",title:"View Form"}," 👁️ ",8,efe),d("button",{onClick:O=>m(M),class:"admin-action-btn edit",title:"Edit Form"}," ✏️ ",8,tfe),d("button",{onClick:O=>S(M),class:"admin-action-btn delete",title:"Delete Form"}," 🗑️ ",8,rfe)])]),d("div",nfe,[d("p",null,[R[28]||(R[28]=d("strong",null,"Created:",-1)),we(" "+Z(I(M.createdAt)),1)]),M.description?(L(),B("p",sfe,[R[29]||(R[29]=d("strong",null,"Description:",-1)),we(" "+Z(M.description),1)])):_e("",!0),d("p",null,[R[30]||(R[30]=d("strong",null,"Form URL:",-1)),R[31]||(R[31]=we()),d("a",{href:M.formUrl,target:"_blank",class:"form-link"},"Open Form",8,afe)]),M.spreadsheetUrl?(L(),B("p",ife,[R[32]||(R[32]=d("strong",null,"Response Sheet:",-1)),d("a",{href:M.spreadsheetUrl,target:"_blank",class:"form-link"},"View Responses",8,ofe),R[33]||(R[33]=d("span",{class:"sheet-status"},"✅ Auto-created",-1))])):(L(),B("p",lfe,"⏳ Sheet will be created when form is first used"))])]))),128))]))])])}}},ufe=St(cfe,[["__scopeId","data-v-31360789"]]);function dfe(t,e,r){const{getLabel:n}=Eo(),s=Se(()=>{var h;const f=((h=r.value)==null?void 0:h.numPeriods)||7;return Array.from({length:f},(p,g)=>({value:g.toString(),label:n(g+1),periodIndex:g}))}),i=Se(()=>{const f=new Set;return console.log("🔍 Finding teachers from students:",t.value.length),t.value.forEach(h=>{var p,g,y,E,b;(p=h.aeries)!=null&&p.schedule&&Object.values(h.aeries.schedule).forEach(_=>{_&&_.teacherId&&(console.log("🔍 Found teacher ID in aeries.schedule:",_.teacherId),f.add(String(_.teacherId)))}),(y=(g=h.app)==null?void 0:g.schedule)!=null&&y.periods&&Object.values(h.app.schedule.periods).forEach(_=>{_&&(console.log("🔍 Found teacher ID in app.schedule.periods:",_),f.add(String(_)))});for(let _=1;_<=7;_++){const v=`period${_}TeacherId`,A=h[v]||((E=h.aeries)==null?void 0:E[v])||((b=h.app)==null?void 0:b[v]);A&&(console.log("🔍 Found teacher ID in",v,":",A),f.add(String(A)))}}),console.log("🔍 Unique teacher IDs found:",Array.from(f)),console.log("🔍 Users available:",e.value.length),Array.from(f).map(h=>{let p=e.value.find(g=>g.id===h);return!p&&/^\d+$/.test(h)&&(p=e.value.find(g=>g.aeriesId===h)),{id:h,name:p?p.name||`${p.firstName} ${p.lastName}`:`Teacher ${h}`,actualUserId:p?p.id:null}}).sort((h,p)=>h.name.localeCompare(p.name))}),a=(f,h=[])=>{let p=-1;if(/^\d+$/.test(f))p=parseInt(f)-1;else if(f==="SH")p=6;else if(f.startsWith("Per")){const g=f.replace("Per","");/^\d+$/.test(g)&&(p=parseInt(g)-1)}return h.includes(p.toString())};return{availablePeriods:s,availableTeachers:i,getStudentsForTeachers:(f,h=[])=>{console.log("🔍 CUSTOM TAB DEBUG: Filtering students for teachers:",f),console.log("🔍 CUSTOM TAB DEBUG: Total students available:",t.value.length);const p=t.value.filter(g=>{var E,b,_,v,A,D,k,T,x,m,S,I,C,F,W,P,R,N,M,O,G,z,j;const y=((b=(E=g.app)==null?void 0:E.flags)==null?void 0:b.flag2)||((v=(_=g.app)==null?void 0:_.flags)==null?void 0:v.separateSetting)||g.separateSetting||g.flag2||!1;if(console.log("🔍 CUSTOM TAB DEBUG: Student",(D=(A=g.app)==null?void 0:A.studentData)==null?void 0:D.firstName,"hasSeparateSetting:",y,"flags:",(k=g.app)==null?void 0:k.flags),!y)return!1;if(console.log("🔍 CUSTOM TAB DEBUG: Checking schedules for student",(x=(T=g.app)==null?void 0:T.studentData)==null?void 0:x.firstName),console.log("🔍 CUSTOM TAB DEBUG: Student schedule:",(m=g.app)==null?void 0:m.schedule),console.log("🔍 CUSTOM TAB DEBUG: Student aeries schedule:",(S=g.aeries)==null?void 0:S.schedule),(I=g.aeries)!=null&&I.schedule){console.log("🔍 CUSTOM TAB DEBUG: Checking aeries schedule for",(F=(C=g.app)==null?void 0:C.studentData)==null?void 0:F.firstName);const H=Object.entries(g.aeries.schedule);for(let V=0;V<H.length;V++){const[te,oe]=H[V];if(console.log("🔍 CUSTOM TAB DEBUG: Aeries period",te,":",oe),oe&&oe.teacherId&&f.includes(String(oe.teacherId))&&(console.log("🔍 CUSTOM TAB DEBUG: Found matching teacher in aeries schedule!"),!a(te,h)))return!0}}if((W=g.app)!=null&&W.schedule&&typeof g.app.schedule=="object"){console.log("🔍 CUSTOM TAB DEBUG: Checking app.schedule (direct) for",(R=(P=g.app)==null?void 0:P.studentData)==null?void 0:R.firstName);const H=Object.entries(g.app.schedule);for(let V=0;V<H.length;V++){const[te,oe]=H[V],ne=typeof oe=="object"?oe.teacherId:oe;if(console.log("🔍 CUSTOM TAB DEBUG: Direct schedule period",te,":",oe,"actual teacher ID:",ne),ne&&f.includes(String(ne))&&(console.log("🔍 CUSTOM TAB DEBUG: Found matching teacher in direct schedule!"),!a(te,h)))return!0}}if((M=(N=g.app)==null?void 0:N.schedule)!=null&&M.periods){console.log("🔍 CUSTOM TAB DEBUG: Checking app.schedule.periods for",(G=(O=g.app)==null?void 0:O.studentData)==null?void 0:G.firstName);const H=Object.entries(g.app.schedule.periods);for(let V=0;V<H.length;V++){const[te,oe]=H[V];if(console.log("🔍 CUSTOM TAB DEBUG: App schedule period",te,":",oe),oe&&f.includes(String(oe))&&(console.log("🔍 CUSTOM TAB DEBUG: Found matching teacher in app schedule!"),!a(te,h)))return!0}}for(let H=0;H<7;H++){const V=`period${H+1}TeacherId`,te=g[V]||((z=g.aeries)==null?void 0:z[V])||((j=g.app)==null?void 0:j[V]);if(te&&f.includes(String(te))&&!h.includes(H.toString()))return!0}return!1});return console.log("🔍 CUSTOM TAB DEBUG: Filtered students result:",p.length,"students"),p},getStudentTeacherPeriods:(f,h,p=[])=>{var y,E,b,_,v;const g=[];if((y=f.aeries)!=null&&y.schedule){const A=Object.entries(f.aeries.schedule);for(let D=0;D<A.length;D++){const[k,T]=A[D];if(T&&T.teacherId&&h.includes(String(T.teacherId))&&!a(k,p)){let x=e.value.find(S=>S.id===String(T.teacherId));!x&&/^\d+$/.test(T.teacherId)&&(x=e.value.find(S=>S.aeriesId===String(T.teacherId)));const m=n(D+1);g.push({period:m,teacherName:x?x.name||`${x.firstName} ${x.lastName}`:`Teacher ${T.teacherId}`})}}}if((b=(E=f.app)==null?void 0:E.schedule)!=null&&b.periods){const A=Object.entries(f.app.schedule.periods);for(let D=0;D<A.length;D++){const[k,T]=A[D];if(T&&h.includes(String(T))&&!a(k,p)){const x=e.value.find(S=>S.id===String(T)),m=n(parseInt(k));g.push({period:m,teacherName:x?x.name||`${x.firstName} ${x.lastName}`:`Teacher ${T}`})}}}for(let A=0;A<7;A++){const D=`period${A+1}TeacherId`,k=f[D]||((_=f.aeries)==null?void 0:_[D])||((v=f.app)==null?void 0:v[D]);if(k&&h.includes(String(k))&&!p.includes(A.toString())){let T=e.value.find(m=>m.id===String(k));!T&&/^\d+$/.test(k)&&(T=e.value.find(m=>m.aeriesId===String(k)));const x=n(A+1);g.push({period:x,teacherName:T?T.name||`${T.firstName} ${T.lastName}`:`Teacher ${k}`})}}return g},generateCSV:()=>{const f=["Student ID","First Name","Last Name","Grade","Case Manager","Assessment Accommodations","Services"],h=t.value.map(g=>{var D,k,T,x,m;const y=it(g,"firstName")||"",E=it(g,"lastName")||"",b=it(g,"grade")||"",_=g.caseManagerId||((k=(D=g.app)==null?void 0:D.studentData)==null?void 0:k.caseManagerId)||"",v=((x=(T=g.app)==null?void 0:T.accommodations)==null?void 0:x.assessment)||[],A=((m=g.app)==null?void 0:m.classServices)||[];return[g.id||"",y,E,b,_,Array.isArray(v)?v.join("; "):v,Array.isArray(A)?A.map(S=>S.name||S).join("; "):A]});return[f,...h].map(g=>g.map(y=>`"${String(y).replace(/"/g,'""')}"`).join(",")).join(`
`)},downloadCSV:(f,h)=>{const p=new Blob([f],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a");g.href=URL.createObjectURL(p),g.download=h,g.click(),URL.revokeObjectURL(g.href)},isPeriodExcluded:a}}const ffe=()=>Et.app.options,_D=()=>{const t=ffe();return{apiKey:t.apiKey,clientId:`${t.messagingSenderId}-qe35vm8cv3jrdqhut23418a7ghfpafk5.apps.googleusercontent.com`,discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"],scope:"https://www.googleapis.com/auth/spreadsheets",projectId:t.projectId,messagingSenderId:t.messagingSenderId}};console.log("🔑 Google API Config loaded for project:",_D().projectId);const Mg="casemanage_linked_sheet_id",f0="Student Data",h0=_D(),en={isInitialized:se(!1),tokenClient:se(null),accessToken:se(""),tokenResolve:null};function Mx(){const t=se(localStorage.getItem(Mg)||""),e=se(""),r=se(null),n=se("idle"),s=se(""),i=en.isInitialized,a=en.tokenClient,o=en.accessToken,l=()=>new Promise((k,T)=>{var m,S,I;if((S=(m=window.google)==null?void 0:m.accounts)!=null&&S.oauth2&&((I=window.gapi)!=null&&I.client)&&a.value){console.log("🔍 Google Auth already initialized, reusing existing token client"),k();return}const x=document.createElement("script");x.src="https://accounts.google.com/gsi/client",x.onload=()=>{a.value||(a.value=window.google.accounts.oauth2.initTokenClient({client_id:h0.clientId,scope:h0.scope,callback:F=>{F.access_token?(o.value=F.access_token,i.value=!0,window.gapi.client.setToken({access_token:F.access_token}),en.tokenResolve&&(en.tokenResolve(F),en.tokenResolve=null)):(console.error("Failed to get access token"),en.tokenResolve&&(en.tokenResolve(null),en.tokenResolve=null))}}));const C=document.createElement("script");C.src="https://apis.google.com/js/api.js",C.onload=()=>{window.gapi.load("client",async()=>{await window.gapi.client.init({apiKey:h0.apiKey,discoveryDocs:h0.discoveryDocs}),k()})},document.head.appendChild(C)},x.onerror=()=>T(new Error("Failed to load Google Identity Services")),document.head.appendChild(x)}),c=async()=>{if(!a.value)throw new Error("Google auth not initialized");if(o.value)try{return await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:"1BxiMVs0XRA5nFMRigcZ_6g3D6P6dNTMhvBSm1x7kFNg"}),{access_token:o.value}}catch{console.log("Token expired, requesting new one"),o.value=""}return new Promise((k,T)=>{en.tokenResolve=k;const x=setTimeout(()=>{en.tokenResolve=null,T(new Error("Token request timed out"))},3e4),m=a.value.callback;a.value.callback=S=>{clearTimeout(x),a.value.callback=m,S.access_token?(o.value=S.access_token,i.value=!0,window.gapi.client.setToken({access_token:S.access_token}),en.tokenResolve&&(en.tokenResolve(S),en.tokenResolve=null)):(console.error("Failed to get access token:",S),en.tokenResolve&&(en.tokenResolve(null),en.tokenResolve=null))};try{a.value.requestAccessToken()}catch(S){clearTimeout(x),a.value.callback=m,T(S)}})},u=async(k,T=[])=>{var x;try{n.value="syncing",s.value="Creating new Google Sheet...",o.value||await c();const S=((x=uo().currentUser)==null?void 0:x.email)||"",I=await window.gapi.client.sheets.spreadsheets.create({properties:{title:`CaseManage Student Data - ${new Date().toLocaleDateString()}`,locale:"en_US",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone},sheets:[{properties:{title:f0,gridProperties:{rowCount:1e3,columnCount:9,frozenRowCount:1}}}]}),C=I.result.spreadsheetId;t.value=C,e.value=`https://docs.google.com/spreadsheets/d/${C}`,localStorage.setItem(Mg,C),await f(k,T);const F=I.result.sheets[0].properties.sheetId;return await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:C,resource:{requests:[{repeatCell:{range:{sheetId:F,startRowIndex:0,endRowIndex:1},cell:{userEnteredFormat:{backgroundColor:{red:.2,green:.6,blue:.9},textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat)"}},{autoResizeDimensions:{dimensions:{sheetId:F,dimension:"COLUMNS",startIndex:0,endIndex:9}}},{addProtectedRange:{protectedRange:{range:{sheetId:F},description:`Read-only protection for ${f0}`,warningOnly:!1,editors:{users:[],domainUsersCanEdit:!1}}}}]}}),n.value="success",s.value="Sheet created and linked successfully!",r.value=new Date,window.open(e.value,"_blank"),{spreadsheetId:C,url:e.value}}catch(m){throw console.error("Error creating sheet:",m),n.value="error",s.value=`Failed to create sheet: ${m.message}`,m}},f=async(k,T=[])=>{if(!t.value)throw new Error("No linked sheet. Create a sheet first.");try{n.value="syncing",s.value="Updating Google Sheet...",o.value||await c();const x=k.filter(F=>{var P,R;return((R=(P=F.app)==null?void 0:P.flags)==null?void 0:R.flag1)||F.flag1||!1});console.log("🔍 Google Sheets - Original students:",k.length),console.log("🔍 Google Sheets - Filtered students (separate setting only):",x.length),console.log("🔍 Google Sheets - Students data:",x),x&&x.length>0&&console.log("🔍 Google Sheets - First student:",x[0]);const m=["Student ID","First Name","Last Name","Grade","Case Manager","Separate Setting","Assessment Accommodations","Services","Last Updated"],S=x.map(F=>{var W,P,R,N,M,O,G,z,j,H,V,te;return console.log("🔍 Processing student:",F.id,{firstName:F.firstName||((P=(W=F.app)==null?void 0:W.studentData)==null?void 0:P.firstName),lastName:F.lastName||((N=(R=F.app)==null?void 0:R.studentData)==null?void 0:N.lastName),grade:F.grade||((O=(M=F.app)==null?void 0:M.studentData)==null?void 0:O.grade)}),[F.id||"",F.firstName||((z=(G=F.app)==null?void 0:G.studentData)==null?void 0:z.firstName)||"",F.lastName||((H=(j=F.app)==null?void 0:j.studentData)==null?void 0:H.lastName)||"",F.grade||((te=(V=F.app)==null?void 0:V.studentData)==null?void 0:te.grade)||"",p(F,T)||"",E(F)||"",g(F,"assessment")||"",y(F)||"",new Date().toLocaleString()]}),I=[m,...S];console.log("🔍 Google Sheets - Data to write:",I),await window.gapi.client.sheets.spreadsheets.values.clear({spreadsheetId:t.value,range:`${f0}!A:Z`});const C=await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:t.value,range:`${f0}!A1`,valueInputOption:"RAW",resource:{values:I}});console.log("🔍 Google Sheets - Update response:",C),n.value="success",s.value=`Updated ${S.length} students (separate setting only)`,r.value=new Date}catch(x){throw console.error("Error updating sheet:",x),n.value="error",s.value=`Failed to update: ${x.message}`,x.status===401&&(o.value="",await c()),x}},h=()=>{t.value="",e.value="",localStorage.removeItem(Mg),n.value="idle",s.value="",r.value=null},p=(k,T=[])=>{var S,I;const x=k.caseManagerId||((I=(S=k.app)==null?void 0:S.studentData)==null?void 0:I.caseManagerId)||k.casemanager_id;if(!x)return"Not Assigned";const m=T.find(C=>C.id===x);return m&&(m.name||`${m.firstName} ${m.lastName}`||m.email)||x},g=(k,T)=>{var m,S,I;const x=((S=(m=k.app)==null?void 0:m.accommodations)==null?void 0:S[T])||((I=k.accommodations)==null?void 0:I[T])||[];return Array.isArray(x)?x.join(", "):x},y=k=>{var x;const T=((x=k.app)==null?void 0:x.classServices)||k.classServices||[];return Array.isArray(T)?T.map(m=>m.name||m).join(", "):T},E=k=>{var x,m;return((m=(x=k.app)==null?void 0:x.flags)==null?void 0:m.flag1)||k.flag1||!1?"True":"False"},b=async()=>{if(!t.value)return!1;try{return await window.gapi.client.sheets.spreadsheets.get({spreadsheetId:t.value}),!0}catch(k){return k.status===404&&h(),!1}},_=async(k,T,x,m=[],S=[])=>{var I;if(!t.value)throw new Error("No linked sheet. Create a sheet first.");try{o.value||await c();const F=((I=uo().currentUser)==null?void 0:I.email)||"";console.log("🔍 Creating custom tab:",k,"for teachers:",x,"excluding periods:",S);const P=(await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t.value,resource:{requests:[{addSheet:{properties:{title:k,gridProperties:{rowCount:1e3,columnCount:12,frozenRowCount:1}}}}]}})).result.replies[0].addSheet.properties.sheetId;console.log("🔍 Created sheet with ID:",P);const R=T.filter(G=>{var j,H;return((H=(j=G.app)==null?void 0:j.flags)==null?void 0:H.flag1)||G.flag1||!1});console.log("🔍 Custom tab - Original students:",T.length),console.log("🔍 Custom tab - Filtered students (separate setting only):",R.length);const N=["Student ID","First Name","Last Name","Grade","Case Manager","Period","Teacher","Subject","Separate Setting","Assessment Accommodations","Services","Last Updated"],M=[];R.forEach(G=>{const z=v(G,x,m,S);console.log("🔍 Student:",G.id,"Periods found:",z.length,"Excluded periods:",S),z.forEach(j=>{console.log("🔍 Adding row for period:",j.period,"teacher:",j.teacherName,"source:",j.source||"unknown")}),z.forEach(j=>{var H,V,te,oe,ne,le;M.push([G.id||"",G.firstName||((V=(H=G.app)==null?void 0:H.studentData)==null?void 0:V.firstName)||"",G.lastName||((oe=(te=G.app)==null?void 0:te.studentData)==null?void 0:oe.lastName)||"",G.grade||((le=(ne=G.app)==null?void 0:ne.studentData)==null?void 0:le.grade)||"",p(G,m)||"",j.period||"",j.teacherName||"",j.subject||"",E(G)||"",g(G,"assessment")||"",y(G)||"",new Date().toLocaleString()])})});const O=[N,...M];return await window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:t.value,range:`${k}!A1`,valueInputOption:"RAW",resource:{values:O}}),await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t.value,resource:{requests:[{repeatCell:{range:{sheetId:P,startRowIndex:0,endRowIndex:1},cell:{userEnteredFormat:{backgroundColor:{red:.2,green:.6,blue:.9},textFormat:{bold:!0,foregroundColor:{red:1,green:1,blue:1}}}},fields:"userEnteredFormat(backgroundColor,textFormat)"}},{autoResizeDimensions:{dimensions:{sheetId:P,dimension:"COLUMNS",startIndex:0,endIndex:12}}},{addProtectedRange:{protectedRange:{range:{sheetId:P},description:`Read-only protection for ${k}`,warningOnly:!1,editors:{users:[],domainUsersCanEdit:!1}}}}]}}),console.log("🔍 Custom tab created successfully with",M.length,"rows and read-only protection"),{sheetId:P,rowCount:M.length}}catch(C){throw console.error("Error creating custom tab:",C),C}},v=(k,T,x=[],m=[])=>{var C,F,W,P,R;const S=[];console.log("🔍 getStudentPeriodsForTeachers for student:",k.id,"teacherIds:",T,"excludedPeriods:",m,"excludedPeriods array:",JSON.stringify(m));const I=N=>{let M=-1;if(/^\d+$/.test(N))M=parseInt(N)-1;else if(N==="SH")M=6;else if(N.startsWith("Per")){const O=N.replace("Per","");/^\d+$/.test(O)&&(M=parseInt(O)-1)}return console.log("🔍 Period",N,"maps to index",M,"excluded?",m.includes(M.toString())),m.includes(M.toString())};if((C=k.aeries)!=null&&C.schedule){const N=Object.entries(k.aeries.schedule);console.log("🔍 Aeries schedule entries:",N.length);for(let M=0;M<N.length;M++){const[O,G]=N[M],z=I(O);console.log("🔍 Checking aeries period key:",O,"teacherId:",G==null?void 0:G.teacherId,"excluded?",z),G&&G.teacherId&&T.includes(String(G.teacherId))&&(z?console.log("🔍 Excluding aeries period",O):(console.log("🔍 Including aeries period",O),S.push({period:O.replace("period",""),teacherId:G.teacherId,teacherName:A(G.teacherId,x),subject:G.subject||"",source:"aeries"})))}}if((W=(F=k.app)==null?void 0:F.schedule)!=null&&W.periods){const N=Object.entries(k.app.schedule.periods);console.log("🔍 App schedule entries:",N.length);for(let M=0;M<N.length;M++){const[O,G]=N[M],z=I(O);console.log("🔍 Checking app period key:",O,"teacherId:",G,"excluded?",z),G&&T.includes(String(G))&&(z?console.log("🔍 Excluding app period",O):(console.log("🔍 Including app period",O),S.push({period:O,teacherId:G,teacherName:A(G,x),subject:"",source:"app"})))}}for(let N=0;N<7;N++){const M=`period${N+1}TeacherId`,O=k[M]||((P=k.aeries)==null?void 0:P[M])||((R=k.app)==null?void 0:R[M]);if(O&&T.includes(String(O))){const G=m.includes(N.toString());console.log("🔍 Checking CSV period index",N,"field:",M,"teacherId:",O,"excluded?",G),G?console.log("🔍 Excluding CSV period",N):(console.log("🔍 Including CSV period",N),S.push({period:(N+1).toString(),teacherId:O,teacherName:A(O,x),subject:"",source:"csv"}))}}return console.log("🔍 Final periods for student",k.id,":",S.length,S),S},A=(k,T=[])=>{let x=T.find(m=>m.id===k);return!x&&/^\d+$/.test(k)&&(x=T.find(m=>m.aeriesId===k)),x?x.name||`${x.firstName} ${x.lastName}`||`Teacher ${k}`:`Teacher ${k}`};return{isInitialized:i,linkedSheetId:t,linkedSheetUrl:e,lastSyncTime:r,syncStatus:n,syncMessage:s,initializeGoogleAuth:l,requestAccessToken:c,createLinkedSheet:u,updateSheetData:f,createCustomTab:_,deleteCustomTab:async k=>{if(!t.value)throw new Error("No linked sheet.");try{o.value||await c(),await window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:t.value,resource:{requests:[{deleteSheet:{sheetId:k}}]}}),console.log("🔍 Deleted custom tab with sheet ID:",k)}catch(T){throw console.error("Error deleting custom tab:",T),T}},unlinkSheet:h,checkSheetConnection:b}}const hfe=Object.freeze(Object.defineProperty({__proto__:null,globalAuthState:en,useGoogleSheetsRealtime:Mx},Symbol.toStringTag,{value:"Module"}));function pfe(t,e,r){const{generateCSV:n,downloadCSV:s}=r,{linkedSheetId:i,linkedSheetUrl:a,lastSyncTime:o,syncStatus:l,syncMessage:c,initializeGoogleAuth:u,createLinkedSheet:f,updateSheetData:h,createCustomTab:p,deleteCustomTab:g,unlinkSheet:y,checkSheetConnection:E}=Mx();let b=null,_=!1;const v=async()=>{try{const F=localStorage.getItem("casemanage_linked_sheet_id");F&&F.startsWith("1XSL0Sl7")&&(console.log("Clearing old sheet ID that was causing 403 errors"),localStorage.removeItem("casemanage_linked_sheet_id")),await u(),i.value&&await E()&&(en.isInitialized.value&&en.accessToken.value?(await T(),A()):console.log("🔍 Google Auth not fully ready, skipping initial sync"))}catch(F){console.error("Failed to initialize Google Auth:",F)}};Ht(()=>t.value,(F,W)=>{F&&W&&F!==W&&(_=!0,console.log("📝 Student data changed, will sync on next interval")),F!=null&&F.length},{deep:!0});const A=()=>{b&&clearInterval(b),b=setInterval(async()=>{if(i.value&&_&&l.value!=="syncing")try{console.log("🔄 Hourly auto-sync starting..."),await T(),_=!1,console.log("✅ Hourly auto-sync completed")}catch(F){console.error("❌ Hourly auto-sync failed:",F)}},36e5)},D=()=>{b&&clearInterval(b)},k=async()=>{try{await f(t.value,e.value),A()}catch(F){console.error("Failed to create linked sheet:",F),alert("Failed to create Google Sheet. Please make sure you are signed in to Google.")}},T=async()=>{if(!(!i.value||l.value==="syncing"))try{await h(t.value,e.value)}catch(F){console.error("Failed to sync sheet:",F),alert("Failed to sync sheet. Please try again.")}};return{linkedSheetId:i,linkedSheetUrl:a,lastSyncTime:o,syncStatus:l,syncMessage:c,initializeIntegration:v,createLinkedGoogleSheet:k,syncNow:T,openGoogleSheet:()=>{a.value&&(window.open(a.value,"_blank","noopener,noreferrer")||(window.location.href=a.value))},unlinkSheet:y,createCustomTab:p,deleteCustomTab:g,createGoogleSheetWithData:()=>{const F=n();s(F,"student_data.csv"),window.open("https://sheets.new","_blank")},createBlankGoogleSheet:()=>{window.open("https://sheets.new","_blank")},exportToCSV:()=>{const F=n();s(F,"student_data_export.csv")},formatTime:F=>new Date(F).toLocaleString(),setupAutoSync:A,cleanupAutoSync:D}}function mfe(t,e){const{getStudentsForTeachers:r}=t,{createCustomTab:n,deleteCustomTab:s}=e,i=se([]),a=se(!1),o=se(""),l=se([]),c=se([]),u=5,f=Se(()=>l.value.length===0?[]:r(l.value,c.value)),h=async E=>{if(!o.value.trim()||l.value.length===0){alert("Please enter a tab name and select at least one teacher");return}if(i.value.length>=u){alert(`Maximum of ${u} custom tabs allowed`);return}try{const b=r(l.value,c.value),_=await n(o.value.trim(),b,l.value,E,c.value),v={id:Date.now().toString(),name:o.value.trim(),teachers:[...l.value],studentCount:_.rowCount,sheetId:_.sheetId};i.value.push(v),g(),console.log("Custom tab added:",v),alert(`Custom tab "${v.name}" created successfully with ${_.rowCount} student entries!`)}catch(b){console.error("Failed to create custom tab:",b),alert("Failed to create custom tab in Google Sheet. Please try again.")}},p=async E=>{const b=i.value.find(_=>_.id===E);if(b&&confirm(`Are you sure you want to remove the "${b.name}" tab?`))try{b.sheetId&&await s(b.sheetId),i.value=i.value.filter(_=>_.id!==E),console.log("Custom tab removed:",E),alert(`Tab "${b.name}" removed successfully.`)}catch(_){console.error("Failed to delete custom tab:",_),alert("Failed to delete tab from Google Sheet. You may need to delete it manually."),i.value=i.value.filter(v=>v.id!==E)}},g=()=>{o.value="",l.value=[],c.value=[],a.value=!1};return{customTabs:i,showAddTabForm:a,newTabName:o,selectedTeachers:l,selectedExcludedPeriods:c,maxCustomTabs:u,filteredStudentsPreview:f,addCustomTab:h,removeCustomTab:p,resetForm:g,toggleAddTabForm:()=>{a.value=!a.value,a.value||g()}}}const gfe={class:"sheets-section"},vfe={key:0,class:"linked-sheet-status"},yfe={class:"status-card success"},xfe={class:"sync-info"},Efe={key:0},_fe={key:1,class:"syncing"},bfe={key:2,class:"success"},Sfe={key:3,class:"error"},Afe={class:"sheet-actions"},Tfe=["disabled"],wfe={key:1,class:"create-sheet-section"},Cfe={class:"alternative-options"},Ife={class:"button-group"},kfe={__name:"GoogleSheetsConnector",props:{linkedSheetId:String,lastSyncTime:[String,Date],syncStatus:String,syncMessage:String},emits:["openGoogleSheet","syncNow","unlinkSheet","createLinkedGoogleSheet","createGoogleSheetWithData","createBlankGoogleSheet","exportToCSV"],setup(t){const e=r=>new Date(r).toLocaleString();return(r,n)=>(L(),B("div",gfe,[n[12]||(n[12]=d("h4",null,"Google Sheets Integration",-1)),t.linkedSheetId?(L(),B("div",vfe,[d("div",yfe,[n[7]||(n[7]=d("h5",null,"📊 Linked Google Sheet",-1)),n[8]||(n[8]=d("p",null,"Your student data is synced to Google Sheets",-1)),d("button",{onClick:n[0]||(n[0]=s=>r.$emit("openGoogleSheet")),class:"sheet-link"}," Open Google Sheet → "),d("div",xfe,[t.lastSyncTime?(L(),B("span",Efe,"Last synced: "+Z(e(t.lastSyncTime)),1)):_e("",!0),t.syncStatus==="syncing"?(L(),B("span",_fe,"🔄 Syncing...")):t.syncStatus==="success"?(L(),B("span",bfe,"✅ Synced")):t.syncStatus==="error"?(L(),B("span",Sfe,"❌ "+Z(t.syncMessage),1)):_e("",!0)]),n[9]||(n[9]=d("div",{class:"auto-sync-info"},[d("span",{class:"auto-sync-badge"},[d("span",{class:"pulse"}),we(" Auto-sync enabled ")]),d("p",{class:"auto-sync-description"}," Changes to student data, accommodations, and services are automatically synced to your Google Sheet. ")],-1)),d("div",Afe,[d("button",{onClick:n[1]||(n[1]=s=>r.$emit("syncNow")),disabled:t.syncStatus==="syncing",class:"btn-sync"}," Sync Now ",8,Tfe),d("button",{onClick:n[2]||(n[2]=s=>r.$emit("unlinkSheet")),class:"btn-unlink"}," Unlink Sheet ")])])])):(L(),B("div",wfe,[n[10]||(n[10]=Rn('<h5 data-v-ec72cef0>Create a Linked Google Sheet</h5><p data-v-ec72cef0>Link your student data to a Google Sheet that automatically updates when changes are made.</p><div class="features-list" data-v-ec72cef0><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0>🔄</span><span data-v-ec72cef0>Auto-syncs when students are added or updated</span></div><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0>📝</span><span data-v-ec72cef0>Updates accommodations and services in real-time</span></div><div class="feature" data-v-ec72cef0><span class="feature-icon" data-v-ec72cef0>🔗</span><span data-v-ec72cef0>Maintains a live connection to your data</span></div></div>',3)),d("button",{onClick:n[3]||(n[3]=s=>r.$emit("createLinkedGoogleSheet")),class:"btn-primary"}," 🔗 Create & Link Google Sheet ")])),d("div",Cfe,[n[11]||(n[11]=d("h5",null,"Other Export Options",-1)),d("div",Ife,[d("button",{onClick:n[4]||(n[4]=s=>r.$emit("createGoogleSheetWithData")),class:"btn-secondary"}," 📊 Create Google Sheet with Data (One-time) "),d("button",{onClick:n[5]||(n[5]=s=>r.$emit("createBlankGoogleSheet")),class:"btn-secondary"}," 📄 Create Blank Google Sheet "),d("button",{onClick:n[6]||(n[6]=s=>r.$emit("exportToCSV")),class:"btn-secondary"}," 💾 Export to CSV Only ")])])]))}},Dfe=St(kfe,[["__scopeId","data-v-ec72cef0"]]),Pfe={class:"preview-section"},Rfe={class:"preview-table"},Ffe={key:0},Nfe={key:0},Ofe={key:0,class:"preview-note"},Lg=5,Mfe={__name:"StudentPreview",props:{filteredStudents:{type:Array,required:!0},selectedTeachers:{type:Array,required:!0},selectedExcludedPeriods:{type:Array,required:!0},getStudentTeacherPeriods:{type:Function,required:!0}},setup(t){const e=t,r=Se(()=>e.filteredStudents.slice(0,Lg)),n=a=>{const o=it(a,"firstName")||"",l=it(a,"lastName")||"";return`${o} ${l}`.trim()},s=a=>it(a,"grade")||"",i=a=>e.getStudentTeacherPeriods(a,e.selectedTeachers,e.selectedExcludedPeriods);return(a,o)=>(L(),B("div",Pfe,[d("h6",null,"Preview ("+Z(t.filteredStudents.length)+" students)",1),d("div",Rfe,[d("table",null,[o[0]||(o[0]=d("thead",null,[d("tr",null,[d("th",null,"Name"),d("th",null,"Grade"),d("th",null,"Period"),d("th",null,"Teacher")])],-1)),d("tbody",null,[(L(!0),B(De,null,$e(r.value,l=>(L(),B("tr",{key:l.id},[d("td",null,Z(n(l)),1),d("td",null,Z(s(l)),1),d("td",null,[(L(!0),B(De,null,$e(i(l),(c,u)=>(L(),B("span",{key:u},[we(Z(c.period),1),u<i(l).length-1?(L(),B("span",Ffe,", ")):_e("",!0)]))),128))]),d("td",null,[(L(!0),B(De,null,$e(i(l),(c,u)=>(L(),B("span",{key:u},[we(Z(c.teacherName),1),u<i(l).length-1?(L(),B("span",Nfe,", ")):_e("",!0)]))),128))])]))),128))])]),t.filteredStudents.length>Lg?(L(),B("p",Ofe," ... and "+Z(t.filteredStudents.length-Lg)+" more students ",1)):_e("",!0)])]))}},Lfe=St(Mfe,[["__scopeId","data-v-936b1ce9"]]),Bfe={class:"custom-tabs-config"},Ufe={class:"add-tab-controls"},$fe=["disabled"],Vfe={key:0,class:"max-tabs-warning"},Hfe={key:0,class:"add-tab-form"},jfe={class:"form-group"},Gfe=["value"],Wfe={class:"form-group"},zfe={class:"teacher-checkboxes"},Kfe=["value","checked","onChange"],qfe={class:"form-group"},Xfe={class:"period-checkboxes"},Yfe=["value","checked","onChange"],Qfe={class:"form-actions"},Jfe={key:1,class:"existing-tabs"},Zfe={class:"tab-teachers"},e0e=["onClick"],t0e={__name:"CustomTabManager",props:{customTabs:{type:Array,required:!0},showAddTabForm:{type:Boolean,required:!0},newTabName:{type:String,required:!0},selectedTeachers:{type:Array,required:!0},selectedExcludedPeriods:{type:Array,required:!0},maxCustomTabs:{type:Number,required:!0},availableTeachers:{type:Array,required:!0},availablePeriods:{type:Array,required:!0},filteredStudentsPreview:{type:Array,required:!0},getStudentTeacherPeriods:{type:Function,required:!0}},emits:["toggleAddTabForm","update:newTabName","updateSelectedTeachers","updateSelectedExcludedPeriods","addCustomTab","removeCustomTab","resetForm"],setup(t){return(e,r)=>(L(),B("div",Bfe,[r[8]||(r[8]=d("h5",null,"Custom Teacher Tabs",-1)),r[9]||(r[9]=d("p",null,"Create custom tabs with data filtered by specific teachers",-1)),d("div",Ufe,[d("button",{onClick:r[0]||(r[0]=n=>e.$emit("toggleAddTabForm")),disabled:t.customTabs.length>=t.maxCustomTabs,class:"btn-primary"}," + Add Custom Tab ",8,$fe),t.customTabs.length>=t.maxCustomTabs?(L(),B("span",Vfe," Maximum of "+Z(t.maxCustomTabs)+" custom tabs allowed ",1)):_e("",!0)]),t.showAddTabForm?(L(),B("div",Hfe,[d("div",jfe,[r[4]||(r[4]=d("label",null,"Tab Name",-1)),d("input",{value:t.newTabName,onInput:r[1]||(r[1]=n=>e.$emit("update:newTabName",n.target.value)),type:"text",class:"form-input",placeholder:"e.g., Math Teachers",maxlength:"30"},null,40,Gfe)]),d("div",Wfe,[r[5]||(r[5]=d("label",null,"Select Teachers",-1)),d("div",zfe,[(L(!0),B(De,null,$e(t.availableTeachers,n=>(L(),B("label",{key:n.id,class:"checkbox-label"},[d("input",{type:"checkbox",value:n.id,checked:t.selectedTeachers.includes(n.id),onChange:s=>e.$emit("updateSelectedTeachers",n.id,s.target.checked)},null,40,Kfe),we(" "+Z(n.name),1)]))),128))])]),d("div",qfe,[r[6]||(r[6]=d("label",null,"Exclude Periods (Optional)",-1)),d("div",Xfe,[(L(!0),B(De,null,$e(t.availablePeriods,n=>(L(),B("label",{key:n.value,class:"checkbox-label"},[d("input",{type:"checkbox",value:n.value,checked:t.selectedExcludedPeriods.includes(n.value),onChange:s=>e.$emit("updateSelectedExcludedPeriods",n.value,s.target.checked)},null,40,Yfe),we(" "+Z(n.label),1)]))),128))])]),t.selectedTeachers.length>0?(L(),Jt(Lfe,{key:0,"filtered-students":t.filteredStudentsPreview,"selected-teachers":t.selectedTeachers,"selected-excluded-periods":t.selectedExcludedPeriods,"get-student-teacher-periods":t.getStudentTeacherPeriods},null,8,["filtered-students","selected-teachers","selected-excluded-periods","get-student-teacher-periods"])):_e("",!0),d("div",Qfe,[d("button",{onClick:r[2]||(r[2]=n=>e.$emit("addCustomTab")),class:"btn-primary"}," Create Tab "),d("button",{onClick:r[3]||(r[3]=n=>e.$emit("resetForm")),class:"btn-secondary"}," Cancel ")])])):_e("",!0),t.customTabs.length>0?(L(),B("div",Jfe,[r[7]||(r[7]=d("h6",null,"Current Custom Tabs",-1)),(L(!0),B(De,null,$e(t.customTabs,n=>(L(),B("div",{key:n.id,class:"tab-item"},[d("div",null,[d("strong",null,Z(n.name),1),d("span",Zfe,Z(n.teachers.length)+" teacher(s), "+Z(n.studentCount)+" students ",1)]),d("button",{onClick:s=>e.$emit("removeCustomTab",n.id),class:"btn-danger btn-small"}," Remove ",8,e0e)]))),128))])):_e("",!0)]))}},r0e=St(t0e,[["__scopeId","data-v-236484db"]]),n0e={class:"testing-links-container"},s0e={__name:"TestingLinks",setup(t){const{students:e,fetchStudents:r}=Di(),{userList:n,fetchUsers:s}=ba(),{appSettings:i,loadAppSettings:a}=Ms(),o=dfe(e,n,i),{availablePeriods:l,availableTeachers:c,getStudentTeacherPeriods:u}=o,f=pfe(e,n,o),{linkedSheetId:h,lastSyncTime:p,syncStatus:g,syncMessage:y,initializeIntegration:E,createLinkedGoogleSheet:b,syncNow:_,openGoogleSheet:v,unlinkSheet:A,createGoogleSheetWithData:D,createBlankGoogleSheet:k,exportToCSV:T,cleanupAutoSync:x}=f,m=mfe(o,f),{customTabs:S,showAddTabForm:I,newTabName:C,selectedTeachers:F,selectedExcludedPeriods:W,maxCustomTabs:P,filteredStudentsPreview:R,addCustomTab:N,removeCustomTab:M,resetForm:O,toggleAddTabForm:G}=m,z=(V,te)=>{if(te)F.value.includes(V)||F.value.push(V);else{const oe=F.value.indexOf(V);oe>-1&&F.value.splice(oe,1)}},j=(V,te)=>{if(te)W.value.includes(V)||W.value.push(V);else{const oe=W.value.indexOf(V);oe>-1&&W.value.splice(oe,1)}},H=async()=>{await N(n.value)};return Gt(async()=>{try{await Promise.all([r(),s(),a()]),console.log("Students loaded:",e.value.length),console.log("Users loaded:",n.value.length),console.log("App settings loaded:",i.value),await E()}catch(V){console.error("Failed to initialize TestingLinks:",V)}}),ja(()=>{x()}),(V,te)=>(L(),B("div",n0e,[te[1]||(te[1]=d("h3",null,"Testing Links & Google Sheets Integration",-1)),Pe(Dfe,{"linked-sheet-id":q(h),"last-sync-time":q(p),"sync-status":q(g),"sync-message":q(y),onOpenGoogleSheet:q(v),onSyncNow:q(_),onUnlinkSheet:q(A),onCreateLinkedGoogleSheet:q(b),onCreateGoogleSheetWithData:q(D),onCreateBlankGoogleSheet:q(k),onExportToCsv:q(T)},null,8,["linked-sheet-id","last-sync-time","sync-status","sync-message","onOpenGoogleSheet","onSyncNow","onUnlinkSheet","onCreateLinkedGoogleSheet","onCreateGoogleSheetWithData","onCreateBlankGoogleSheet","onExportToCsv"]),q(h)?(L(),Jt(r0e,{key:0,"custom-tabs":q(S),"show-add-tab-form":q(I),"new-tab-name":q(C),"selected-teachers":q(F),"selected-excluded-periods":q(W),"max-custom-tabs":q(P),"available-teachers":q(c),"available-periods":q(l),"filtered-students-preview":q(R),"get-student-teacher-periods":q(u),onToggleAddTabForm:q(G),"onUpdate:newTabName":te[0]||(te[0]=oe=>C.value=oe),onUpdateSelectedTeachers:z,onUpdateSelectedExcludedPeriods:j,onAddCustomTab:H,onRemoveCustomTab:q(M),onResetForm:q(O)},null,8,["custom-tabs","show-add-tab-form","new-tab-name","selected-teachers","selected-excluded-periods","max-custom-tabs","available-teachers","available-periods","filtered-students-preview","get-student-teacher-periods","onToggleAddTabForm","onRemoveCustomTab","onResetForm"])):_e("",!0)]))}},a0e=St(s0e,[["__scopeId","data-v-c213a5d7"]]),i0e={class:"admin-dashboard"},o0e={class:"stats-grid"},l0e={class:"stat-card primary"},c0e={class:"stat-icon"},u0e={class:"stat-content"},d0e={class:"stat-card iep"},f0e={class:"stat-icon"},h0e={class:"stat-content"},p0e={class:"stat-card plan-504"},m0e={class:"stat-icon"},g0e={class:"stat-content"},v0e={class:"stat-card users"},y0e={class:"stat-icon"},x0e={class:"stat-content"},E0e={class:"role-breakdown"},_0e={class:"role-stats-grid"},b0e={class:"role-icon"},S0e={class:"role-info"},A0e={class:"role-count"},T0e={class:"role-name"},w0e={class:"categories-grid"},C0e={class:"category-card"},I0e={class:"category-header"},k0e={class:"category-content"},D0e={class:"feature-list"},P0e={class:"feature-item"},R0e={class:"feature-icon"},F0e={class:"feature-item"},N0e={class:"feature-icon"},O0e={class:"feature-item"},M0e={class:"feature-icon"},L0e={class:"category-card"},B0e={class:"category-header"},U0e={class:"category-content"},$0e={class:"feature-list"},V0e={class:"feature-item"},H0e={class:"feature-icon"},j0e={class:"feature-item"},G0e={class:"feature-icon"},W0e={class:"feature-item"},z0e={class:"feature-icon"},K0e={class:"category-card"},q0e={class:"category-header"},X0e={class:"category-content"},Y0e={class:"feature-list"},Q0e={class:"feature-item"},J0e={class:"feature-icon"},Z0e={class:"feature-item"},ehe={class:"feature-icon"},the={class:"feature-item"},rhe={class:"feature-icon"},nhe={class:"feature-item"},she={class:"feature-icon"},ahe={class:"feature-item"},ihe={class:"feature-icon"},ohe={class:"category-card"},lhe={class:"category-header"},che={class:"category-content"},uhe={class:"feature-list"},dhe={class:"feature-item"},fhe={class:"feature-icon"},hhe={class:"feature-item"},phe={class:"feature-icon"},mhe={class:"feature-item"},ghe={class:"feature-icon"},vhe={class:"system-status"},yhe={class:"status-grid"},xhe={class:"status-card"},Ehe={class:"sync-status"},_he={class:"sync-item"},bhe={key:0,class:"sync-time"},She={class:"sync-item"},Ahe={class:"sync-time"},The={class:"status-card"},whe={class:"user-activity"},Che={class:"activity-item"},Ihe={class:"activity-count"},khe={class:"activity-item"},Dhe={class:"activity-count"},Phe={class:"status-card"},Rhe={class:"health-indicators"},Fhe={class:"health-item"},Nhe={class:"health-status healthy"},Ohe={class:"health-item"},Mhe={class:"health-status healthy"},Lhe={class:"quick-actions"},Bhe={class:"actions-grid"},Uhe={__name:"AdminDashboard",emits:["goToCategory","goToStudents"],setup(t){const{students:e,fetchStudents:r}=Di(),{userList:n,fetchUsers:s}=ba(),{linkedSheetId:i,lastSyncTime:a}=Mx(),o=se(12),l=se(8),c=se(!0),u=se("Connected"),f=Se(()=>{var _;return((_=e.value)==null?void 0:_.length)||0}),h=Se(()=>{var _;return((_=n.value)==null?void 0:_.length)||0}),p=Se(()=>{var _;return((_=e.value)==null?void 0:_.filter(v=>{var D,k;return(((k=(D=v.app)==null?void 0:D.studentData)==null?void 0:k.plan)||v.plan||"").toLowerCase()==="iep"}).length)||0}),g=Se(()=>{var _;return((_=e.value)==null?void 0:_.filter(v=>{var D,k;return(((k=(D=v.app)==null?void 0:D.studentData)==null?void 0:k.plan)||v.plan||"")==="504"}).length)||0}),y=Se(()=>{var A;const _={};(A=n.value)==null||A.forEach(D=>{const k=D.role||"unknown";_[k]||(_[k]=0),_[k]++});const v={admin:{name:"Administrators",icon:Uv},school_admin:{name:"School Admins",icon:mB},teacher:{name:"Teachers",icon:q7},case_manager:{name:"Case Managers",icon:k0},paraeducator:{name:"Paraeducators",icon:Im},service_provider:{name:"Service Providers",icon:lI},sped_chair:{name:"SPED Chairs",icon:X7},admin_504:{name:"504 Admins",icon:Bv},staff_view:{name:"Staff (View)",icon:zl},staff_edit:{name:"Staff (Edit)",icon:$v}};return Object.entries(_).map(([D,k])=>{var T,x;return{name:((T=v[D])==null?void 0:T.name)||D.replace("_"," ").toUpperCase(),count:k,icon:((x=v[D])==null?void 0:x.icon)||zl}}).sort((D,k)=>k.count-D.count).slice(0,8)});Se(()=>i.value?1:0);const E=Se(()=>!!i.value),b=_=>_?new Date(_).toLocaleString():"Never";return Gt(async()=>{try{await Promise.all([r(),s()])}catch(_){console.error("Error loading dashboard data:",_)}}),(_,v)=>(L(),B("div",i0e,[d("div",o0e,[d("div",l0e,[d("div",c0e,[Pe(q(zl),{size:32})]),d("div",u0e,[d("h3",null,Z(f.value),1),v[8]||(v[8]=d("p",null,"Total Students",-1))])]),d("div",d0e,[d("div",f0e,[Pe(q(Ku),{size:32})]),d("div",h0e,[d("h3",null,Z(p.value),1),v[9]||(v[9]=d("p",null,"IEP Students",-1))])]),d("div",p0e,[d("div",m0e,[Pe(q(Bv),{size:32})]),d("div",g0e,[d("h3",null,Z(g.value),1),v[10]||(v[10]=d("p",null,"504 Plan Students",-1))])]),d("div",v0e,[d("div",y0e,[Pe(q(k0),{size:32})]),d("div",x0e,[d("h3",null,Z(h.value),1),v[11]||(v[11]=d("p",null,"System Users",-1))])])]),d("div",E0e,[d("h2",null,[Pe(q(cI),{size:20}),v[12]||(v[12]=we(" Staff Role Distribution"))]),d("div",_0e,[(L(!0),B(De,null,$e(y.value,A=>(L(),B("div",{class:"role-stat",key:A.name},[d("div",b0e,[(L(),Jt(T1(A.icon),{size:24}))]),d("div",S0e,[d("span",A0e,Z(A.count),1),d("span",T0e,Z(A.name),1)])]))),128))])]),d("div",w0e,[d("div",C0e,[d("div",I0e,[d("h2",null,[Pe(q(zl),{size:18}),v[13]||(v[13]=we(" User & Student Management"))]),d("button",{onClick:v[0]||(v[0]=A=>_.$emit("goToCategory","users-students")),class:"category-btn"},[Pe(q(Gf),{size:16}),v[14]||(v[14]=we(" Manage "))])]),d("div",k0e,[d("div",D0e,[d("div",P0e,[d("div",R0e,[Pe(q(uI),{size:18})]),v[15]||(v[15]=d("div",null,[d("h4",null,"Add Users"),d("p",null,"Create new user accounts with role assignments")],-1))]),d("div",F0e,[d("div",N0e,[Pe(q($v),{size:18})]),v[16]||(v[16]=d("div",null,[d("h4",null,"Manage Users"),d("p",null,"Edit existing users, roles, and permissions")],-1))]),d("div",O0e,[d("div",M0e,[Pe(q(sB),{size:18})]),v[17]||(v[17]=d("div",null,[d("h4",null,"Student Administration"),d("p",null,"Comprehensive student data management")],-1))])])])]),d("div",L0e,[d("div",B0e,[d("h2",null,[Pe(q(Im),{size:18}),v[18]||(v[18]=we(" Paraeducator Management"))]),d("button",{onClick:v[1]||(v[1]=A=>_.$emit("goToCategory","aide-management")),class:"category-btn"},[Pe(q(Gf),{size:16}),v[19]||(v[19]=we(" Manage "))])]),d("div",U0e,[d("div",$0e,[d("div",V0e,[d("div",H0e,[Pe(q(J7),{size:18})]),v[20]||(v[20]=d("div",null,[d("h4",null,"Aide Assignment"),d("p",null,"Assign paraeducators to students and periods")],-1))]),d("div",j0e,[d("div",G0e,[Pe(q(Y7),{size:18})]),v[21]||(v[21]=d("div",null,[d("h4",null,"Aide Schedule"),d("p",null,"Manage paraeducator schedules and assignments")],-1))]),d("div",W0e,[d("div",z0e,[Pe(q(sI),{size:18})]),v[22]||(v[22]=d("div",null,[d("h4",null,"Time Table"),d("p",null,"Configure school periods and time slots")],-1))])])])]),d("div",K0e,[d("div",q0e,[d("h2",null,[Pe(q(H_),{size:18}),v[23]||(v[23]=we(" Data & Integration"))]),d("button",{onClick:v[2]||(v[2]=A=>_.$emit("goToCategory","data-integration")),class:"category-btn"},[Pe(q(Gf),{size:16}),v[24]||(v[24]=we(" Manage "))])]),d("div",X0e,[d("div",Y0e,[d("div",Q0e,[d("div",J0e,[Pe(q(eB),{size:18})]),v[25]||(v[25]=d("div",null,[d("h4",null,"SEIS Import"),d("p",null,"Import student data from SEIS system")],-1))]),d("div",Z0e,[d("div",ehe,[Pe(q(oB),{size:18})]),v[26]||(v[26]=d("div",null,[d("h4",null,"Aeries API & Import"),d("p",null,"Connect to Aeries SIS for data synchronization")],-1))]),d("div",the,[d("div",rhe,[Pe(q(vB),{size:18})]),v[27]||(v[27]=d("div",null,[d("h4",null,"Testing Links"),d("p",null,"Google Sheets integration and export tools")],-1))]),d("div",nhe,[d("div",she,[Pe(q(aI),{size:18})]),v[28]||(v[28]=d("div",null,[d("h4",null,"Teacher Feedback"),d("p",null,"Manage teacher feedback forms and responses")],-1))]),d("div",ahe,[d("div",ihe,[Pe(q(aB),{size:18})]),v[29]||(v[29]=d("div",null,[d("h4",null,"Backup & Restore"),d("p",null,"System backup and data restoration tools")],-1))])])])]),d("div",ohe,[d("div",lhe,[d("h2",null,[Pe(q(oI),{size:18}),v[30]||(v[30]=we(" System Configuration"))]),d("button",{onClick:v[3]||(v[3]=A=>_.$emit("goToCategory","system-config")),class:"category-btn"},[Pe(q(Gf),{size:16}),v[31]||(v[31]=we(" Manage "))])]),d("div",che,[d("div",uhe,[d("div",dhe,[d("div",fhe,[Pe(q(Uv),{size:18})]),v[32]||(v[32]=d("div",null,[d("h4",null,"Permissions"),d("p",null,"Role-based access control and permissions matrix")],-1))]),d("div",hhe,[d("div",phe,[Pe(q(_B),{size:18})]),v[33]||(v[33]=d("div",null,[d("h4",null,"App Settings"),d("p",null,"Configure application settings and preferences")],-1))]),d("div",mhe,[d("div",ghe,[Pe(q(fB),{size:18})]),v[34]||(v[34]=d("div",null,[d("h4",null,"Theme Customization"),d("p",null,"Customize student page appearance and colors")],-1))])])])])]),d("div",vhe,[d("h2",null,[Pe(q(yB),{size:20}),v[35]||(v[35]=we(" System Status"))]),d("div",yhe,[d("div",xhe,[d("h3",null,[Pe(q(pB),{size:18}),v[36]||(v[36]=we(" Data Sync Status"))]),d("div",Ehe,[d("div",_he,[d("span",{class:Xe(["sync-indicator",{active:E.value}])},null,2),v[37]||(v[37]=d("span",null,"Google Sheets",-1)),q(a)?(L(),B("span",bhe,Z(b(q(a))),1)):_e("",!0)]),d("div",She,[d("span",{class:Xe(["sync-indicator",{active:c.value}])},null,2),v[38]||(v[38]=d("span",null,"Aeries SIS",-1)),d("span",Ahe,Z(u.value),1)])])]),d("div",The,[d("h3",null,[Pe(q(z7),{size:18}),v[39]||(v[39]=we(" User Activity"))]),d("div",whe,[d("div",Che,[v[40]||(v[40]=d("span",null,"Active Users Today",-1)),d("span",Ihe,Z(o.value),1)]),d("div",khe,[v[41]||(v[41]=d("span",null,"Recent Logins",-1)),d("span",Dhe,Z(l.value),1)])])]),d("div",Phe,[d("h3",null,[Pe(q(dB),{size:18}),v[42]||(v[42]=we(" System Health"))]),d("div",Rhe,[d("div",Fhe,[v[44]||(v[44]=d("span",null,"Database",-1)),d("span",Nhe,[Pe(q(Eh),{size:16}),v[43]||(v[43]=we(" Healthy "))])]),d("div",Ohe,[v[46]||(v[46]=d("span",null,"Functions",-1)),d("span",Mhe,[Pe(q(Eh),{size:16}),v[45]||(v[45]=we(" Operational "))])])])])])]),d("div",Lhe,[d("h2",null,[Pe(q(bB),{size:20}),v[47]||(v[47]=we(" Quick Actions"))]),d("div",Bhe,[d("button",{onClick:v[4]||(v[4]=A=>_.$emit("goToStudents")),class:"admin-action-btn primary"},[Pe(q(zl),{size:20}),v[48]||(v[48]=d("span",null,"View Students",-1))]),d("button",{onClick:v[5]||(v[5]=A=>_.$emit("goToCategory","users-students")),class:"admin-action-btn success"},[Pe(q(k0),{size:20}),v[49]||(v[49]=d("span",null,"Manage Users",-1))]),d("button",{onClick:v[6]||(v[6]=A=>_.$emit("goToCategory","aide-management")),class:"admin-action-btn warning"},[Pe(q(Im),{size:20}),v[50]||(v[50]=d("span",null,"Paraeducators",-1))]),d("button",{onClick:v[7]||(v[7]=A=>_.$emit("goToCategory","data-integration")),class:"admin-action-btn info"},[Pe(q(H_),{size:20}),v[51]||(v[51]=d("span",null,"Data & Integration",-1))])])])]))}},$he=St(Uhe,[["__scopeId","data-v-b32b4e32"]]);var Vhe={};class Hhe{constructor(){this.encryptionKey="default-dev-key-replace-in-production",this.encryptionEnabled=!0,console.log("🔒 IEP Encryption:",this.encryptionEnabled?"Enabled":"Disabled")}setEncryptionEnabled(e){this.encryptionEnabled=e,console.log("🔒 IEP Encryption:",this.encryptionEnabled?"Enabled":"Disabled"),e||console.warn("⚠️ Warning: Encryption disabled in production environment")}encryptSensitiveFields(e){if(!this.encryptionEnabled)return console.log("🔓 Encryption disabled, returning raw data"),e;const r=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],n=JSON.parse(JSON.stringify(e));return r.forEach(s=>{const i=this.getNestedValue(n,s);if(i){const a=this.encryptField(i);this.setNestedValue(n,s,a)}}),n}decryptSensitiveFields(e){if(!this.encryptionEnabled)return console.log("🔓 Encryption disabled, returning raw data"),e;const r=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],n=JSON.parse(JSON.stringify(e));return r.forEach(s=>{const i=this.getNestedValue(n,s);if(i){const a=this.decryptField(i);this.setNestedValue(n,s,a)}}),n}encryptField(e){if(!this.encryptionEnabled)return e;try{const r=typeof e=="object"?JSON.stringify(e):String(e);return qi.AES.encrypt(r,this.encryptionKey).toString()}catch(r){return console.error("Encryption failed:",r),e}}decryptField(e){if(!this.encryptionEnabled)return e;try{const n=qi.AES.decrypt(e,this.encryptionKey).toString(qi.enc.Utf8);try{return JSON.parse(n)}catch{return n}}catch(r){return console.error("Decryption failed:",r),e}}getNestedValue(e,r){return r.split(".").reduce((n,s)=>n&&n[s],e)}setNestedValue(e,r,n){const s=r.split("."),i=s.pop(),a=s.reduce((o,l)=>o[l]=o[l]||{},e);return a[i]=n,e}async logAccess(e,r,n){var s,i;try{const a=Ze(At(qe,"iepAccessLogs"));await jt(a,{studentId:e,userId:(s=Et.currentUser)==null?void 0:s.uid,userEmail:(i=Et.currentUser)==null?void 0:i.email,action:r,fields:n,timestamp:Dn(),userAgent:navigator.userAgent,encryptionEnabled:this.encryptionEnabled})}catch(a){console.error("Failed to log access:",a)}}async verifyAccess(e,r="read"){var n,s,i,a,o,l;if(!Et.currentUser)return!1;try{const u=(await qt(Ze(qe,"users",Et.currentUser.uid))).data();if(["admin","administrator","sped_chair"].includes(u.role))return!0;if(u.role==="case_manager"){const h=((i=(s=(n=(await qt(Ze(qe,"students",e))).data())==null?void 0:n.app)==null?void 0:s.studentData)==null?void 0:i.caseManagerId)===Et.currentUser.uid;return await this.logAccess(e,`access_attempt_${r}`,{success:h,role:"case_manager"}),h}if(u.role==="teacher"&&r==="read"){const h=((l=(o=(a=(await qt(Ze(qe,"students",e))).data())==null?void 0:a.app)==null?void 0:o.schedule)==null?void 0:l.periods)||{},p=Object.values(h).includes(Et.currentUser.uid);return await this.logAccess(e,`access_attempt_${r}`,{success:p,role:"teacher"}),p}return!1}catch(c){return console.error("Access verification failed:",c),!1}}async getAccessHistory(e){try{const r=cr(At(qe,"iepAccessLogs"),Ur("studentId","==",e),Ur("timestamp",">=",new Date(Date.now()-2592e6)));return(await zt(r)).docs.map(s=>({id:s.id,...s.data()}))}catch(r){return console.error("Failed to fetch access history:",r),[]}}maskSensitiveData(e){var n,s,i;const r=JSON.parse(JSON.stringify(e));return(n=r.app)!=null&&n.accommodations&&(r.app.accommodations={assessment:"[RESTRICTED]",instruction:"[RESTRICTED]"}),(i=(s=r.app)==null?void 0:s.schedule)!=null&&i.classServices&&(r.app.schedule.classServices=["[RESTRICTED]"]),r}isEncryptionEnabled(){return this.encryptionEnabled}isValueEncrypted(e){try{return typeof e!="string"?!1:(qi.AES.decrypt(e,this.encryptionKey).toString(qi.enc.Utf8),!0)}catch{return!1}}encryptGmailPassword(e){return this.encryptionEnabled?this.encryptField(e):(console.warn("⚠️ Warning: Encryption is disabled"),e)}decryptGmailPassword(e){return this.encryptionEnabled?this.decryptField(e):e}getEncryptionStatus(){const e="true",r=e!==void 0;return{enabled:this.encryptionEnabled,environment:"production",keyAvailable:!!this.encryptionKey,environmentVariable:Vhe.VUE_APP_ENABLE_ENCRYPTION,viteEncryptionValue:r?e:null,isViteSet:r,viteEncryptionEnabled:this.encryptionEnabled}}}const p0=new Hhe,jhe={class:"debug-encryption"},Ghe={class:"debug-header"},Whe={class:"encryption-status"},zhe={class:"status-row"},Khe={class:"encryption-toggle"},qhe=["checked"],Xhe={key:0,class:"warning"},Yhe={class:"status-details"},Qhe={class:"status-row"},Jhe={class:"status-value"},Zhe={class:"status-row"},epe={class:"status-value"},tpe={class:"status-row"},rpe={class:"status-value"},npe={key:0,class:"env-value-set"},spe={class:"env-guidance"},ape={key:0,class:"dev-guidance"},ipe={key:1,class:"prod-guidance"},ope={key:1,class:"env-value-not-set"},lpe={class:"status-row"},cpe={class:"status-value"},upe={key:0,class:"debug-info"},dpe={class:"field-name"},fpe={class:"field-value"},hpe={class:"value-preview"},ppe={__name:"DebugEncryption",props:{selectedStudent:{type:Object,default:null}},setup(t){const e=t,r=Se(()=>p0.getEncryptionStatus()),n=Se(()=>p0.isEncryptionEnabled()),s=Se(()=>r.value.environment),i=["app.accommodations.assessment","app.accommodations.instruction","app.schedule.classServices","app.studentData.plan"],a=()=>{p0.setEncryptionEnabled(!n.value)},o=(u,f)=>f.split(".").reduce((h,p)=>h&&h[p],u),l=u=>{if(!e.selectedStudent)return!1;const f=o(e.selectedStudent,u);return f?p0.isValueEncrypted(f):!1},c=u=>{if(!e.selectedStudent)return"No data";const f=o(e.selectedStudent,u);if(!f)return"Empty";if(l(u))return f.substring(0,20)+"...";const h=typeof f=="object"?JSON.stringify(f):String(f);return h.length>40?h.substring(0,40)+"...":h};return(u,f)=>(L(),B("div",jhe,[d("div",Ghe,[f[0]||(f[0]=d("h3",null,"🔒 IEP Encryption Control",-1)),d("div",{class:Xe(["environment-badge",s.value])},Z(s.value.toUpperCase()),3)]),d("div",Whe,[d("div",zhe,[f[1]||(f[1]=d("div",{class:"status-label"},"Status:",-1)),d("div",{class:Xe(["status-value",{enabled:n.value}])},Z(n.value?"🔒 Enabled":"🔓 Disabled"),3)]),d("div",Khe,[d("label",null,[d("input",{type:"checkbox",checked:n.value,onChange:a},null,40,qhe),f[2]||(f[2]=we(" Toggle Encryption "))]),s.value==="production"&&!n.value?(L(),B("div",Xhe," ⚠️ Warning: Encryption disabled in production ")):_e("",!0)]),d("div",Yhe,[d("div",Qhe,[f[3]||(f[3]=d("div",{class:"status-label"},"Environment:",-1)),d("div",Jhe,Z(s.value),1)]),d("div",Zhe,[f[4]||(f[4]=d("div",{class:"status-label"},"Encryption Key:",-1)),d("div",epe,Z(r.value.keyAvailable?"✅ Available":"❌ Missing"),1)]),d("div",tpe,[f[6]||(f[6]=d("div",{class:"status-label"},"VITE_ENABLE_ENCRYPTION:",-1)),d("div",rpe,[r.value.isViteSet?(L(),B("div",npe,[d("span",{class:Xe(["env-value",{"true-value":r.value.viteEncryptionValue==="true","false-value":r.value.viteEncryptionValue==="false"}])},Z(r.value.viteEncryptionValue),3),d("div",spe,[r.value.viteEncryptionValue==="true"?(L(),B("span",ape,"🔧 Development mode")):r.value.viteEncryptionValue==="false"?(L(),B("span",ipe,"🚀 Production mode")):_e("",!0)])])):(L(),B("div",ope,f[5]||(f[5]=[d("span",{class:"not-set"},"Not set",-1),d("div",{class:"env-guidance"},[d("span",{class:"default-guidance"},"Defaults to enabled (secure)")],-1)])))])]),d("div",lpe,[f[7]||(f[7]=d("div",{class:"status-label"},"Legacy ENV:",-1)),d("div",cpe,Z(r.value.environmentVariable||"Not set"),1)])])]),t.selectedStudent?(L(),B("div",upe,[f[8]||(f[8]=d("h4",null,"Selected Student Data:",-1)),(L(),B(De,null,$e(i,h=>d("div",{class:"field-status",key:h},[d("div",dpe,Z(h)+":",1),d("div",fpe,[d("div",{class:Xe(["encryption-status",{encrypted:l(h)}])},Z(l(h)?"🔒 Encrypted":"🔓 Plain Text"),3),d("div",hpe,Z(c(h)),1)])])),64))])):_e("",!0)]))}},bD=St(ppe,[["__scopeId","data-v-7902f511"]]),mpe={class:"session-debug"},gpe={class:"debug-info"},vpe={class:"info-row"},ype={class:"info-row"},xpe={class:"info-row"},Epe={class:"info-row"},_pe={key:0,class:"info-row"},bpe={class:"countdown"},Spe={class:"debug-actions"},Ape={class:"timeout-setter"},Tpe={__name:"SessionTimeoutDebug",setup(t){const{isEnabled:e,timeoutMinutes:r,showWarning:n,warningCountdown:s,updateSettings:i,resetTimeout:a}=Yy(),o=on(),l=Se(()=>o.currentUser),c=se(!1),u=se(30),f=se(.17);Gt(()=>{c.value=e.value,u.value=r.value});const h=async()=>{!c.value&&!u.value&&(c.value=e.value,u.value=r.value),await i(!0,f.value),setTimeout(()=>{a()},100)},p=async()=>{await i(c.value,u.value),setTimeout(()=>{a()},100)},g=()=>{document.dispatchEvent(new Event("click"))},y=()=>{console.log("🔒 Session Timeout Debug Info:"),console.log("- Enabled:",e.value),console.log("- Timeout Minutes:",r.value),console.log("- Warning Showing:",n.value),console.log("- Warning Countdown:",s.value),console.log("- User Logged In:",!!l.value),console.log("- Current User:",l.value)};return(E,b)=>(L(),B("div",mpe,[d("h4",null,[Pe(q(Uv),{size:16}),b[1]||(b[1]=we(" Session Timeout Debug"))]),d("div",gpe,[d("div",vpe,[b[2]||(b[2]=d("strong",null,"Timeout Enabled:",-1)),d("span",{class:Xe({"status-active":q(e),"status-inactive":!q(e)})},[q(e)?(L(),Jt(q(Eh),{key:0,size:14})):(L(),Jt(q(Cm),{key:1,size:14})),we(" "+Z(q(e)?"YES":"NO"),1)],2)]),d("div",ype,[b[3]||(b[3]=d("strong",null,"Timeout Minutes:",-1)),d("span",null,Z(q(r))+" minutes",1)]),d("div",xpe,[b[4]||(b[4]=d("strong",null,"User Logged In:",-1)),d("span",{class:Xe({"status-active":!!l.value,"status-inactive":!l.value})},[l.value?(L(),Jt(q(Eh),{key:0,size:14})):(L(),Jt(q(Cm),{key:1,size:14})),we(" "+Z(l.value?"YES":"NO"),1)],2)]),d("div",Epe,[b[5]||(b[5]=d("strong",null,"Warning Showing:",-1)),d("span",{class:Xe({"status-warning":q(n),"status-inactive":!q(n)})},[q(n)?(L(),Jt(q(xB),{key:0,size:14})):(L(),Jt(q(Cm),{key:1,size:14})),we(" "+Z(q(n)?"YES":"NO"),1)],2)]),q(n)?(L(),B("div",_pe,[b[6]||(b[6]=d("strong",null,"Countdown:",-1)),d("span",bpe,Z(q(s))+"s",1)])):_e("",!0)]),d("div",Spe,[d("div",Ape,[d("label",null,[b[8]||(b[8]=we(" Set Test Timeout: ")),Ne(d("select",{"onUpdate:modelValue":b[0]||(b[0]=_=>f.value=_),class:"timeout-select"},b[7]||(b[7]=[Rn('<option value="0.05" data-v-76f71c90>3 seconds</option><option value="0.17" data-v-76f71c90>10 seconds</option><option value="0.5" data-v-76f71c90>30 seconds</option><option value="1" data-v-76f71c90>1 minute</option><option value="2" data-v-76f71c90>2 minutes</option><option value="5" data-v-76f71c90>5 minutes</option>',6)]),512),[[sr,f.value]])]),d("button",{onClick:h,class:"btn btn-warning"}," Apply Test Timeout ")]),d("div",{class:"admin-action-btns"},[d("button",{onClick:g,class:"admin-action-btn",style:{"min-width":"120px","max-width":"120px"}}," Trigger Activity "),d("button",{onClick:y,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Show Console Info "),d("button",{onClick:p,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Reset to Original ")])])]))}},wpe=St(Tpe,[["__scopeId","data-v-76f71c90"]]),Cpe={class:"security-control-center"},Ipe={class:"security-section"},kpe={class:"security-section"},Dpe={class:"setting-group"},Ppe={key:0,class:"setting-group"},Rpe={class:"setting-group"},Fpe={class:"setting-group"},Npe={class:"security-section"},Ope={class:"setting-group"},Mpe={class:"setting-group"},Lpe={class:"security-section"},Bpe={class:"ip-list"},Upe={class:"ip-input"},$pe={key:0,class:"ip-table"},Vpe=["onClick"],Hpe={key:1,class:"no-ips"},jpe={class:"security-section"},Gpe={class:"alert-settings"},Wpe={class:"setting-group"},zpe={class:"setting-group"},Kpe={class:"alert-emails"},qpe={class:"email-input"},Xpe={key:0,class:"email-list"},Ype=["onClick"],Qpe={__name:"SecurityControlCenter",props:{selectedStudent:{type:Object,default:null}},setup(t){const{isEnabled:e,timeoutMinutes:r,updateSettings:n}=Yy(),s=se(!1),i=se(!1),a=se(!0),o=se(!0),l=se([]),c=se(""),u=se({unusualAccess:!0,bulkExport:!0}),f=se([]),h=se(""),p=async()=>{try{await n(e.value,r.value)}catch(x){console.error("Failed to toggle session timeout:",x)}},g=async()=>{try{await n(e.value,r.value)}catch(x){console.error("Failed to update session timeout:",x)}},y=()=>{console.log("Password policy updated:",s.value)},E=()=>{console.log("MFA policy updated:",i.value)},b=()=>{console.log("Export policy updated:",a.value)},_=()=>{console.log("PDF policy updated:",o.value)},v=()=>{c.value&&!l.value.includes(c.value)&&(l.value.push(c.value),c.value="")},A=x=>{l.value=l.value.filter(m=>m!==x)},D=()=>{console.log("Alert settings updated:",u.value)},k=()=>{h.value&&!f.value.includes(h.value)&&(f.value.push(h.value),h.value="")},T=x=>{f.value=f.value.filter(m=>m!==x)};return(x,m)=>(L(),B("div",Cpe,[d("div",Ipe,[m[10]||(m[10]=d("h3",null,"🔒 IEP Data Encryption",-1)),Pe(bD,{"selected-student":t.selectedStudent},null,8,["selected-student"])]),d("div",kpe,[m[17]||(m[17]=d("h3",null,"⏲️ Session Security",-1)),Pe(wpe),d("div",Dpe,[d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":m[0]||(m[0]=S=>Cr(e)?e.value=S:null),onChange:p},null,544),[[bt,q(e)]]),m[11]||(m[11]=we(" Enable Auto Logout Timer "))]),m[12]||(m[12]=d("div",{class:"setting-description"}," Automatically log out users after a period of inactivity ",-1))]),q(e)?(L(),B("div",Ppe,[d("label",null,[m[13]||(m[13]=we(" Auto Logout Timer (minutes): ")),Ne(d("input",{type:"number","onUpdate:modelValue":m[1]||(m[1]=S=>Cr(r)?r.value=S:null),min:"5",max:"120",onChange:g},null,544),[[ft,q(r)]])]),m[14]||(m[14]=d("div",{class:"setting-description"}," Users will be automatically logged out after this period of inactivity ",-1))])):_e("",!0),d("div",Rpe,[d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":m[2]||(m[2]=S=>s.value=S),onChange:y},null,544),[[bt,s.value]]),m[15]||(m[15]=we(" Enforce Password Change Every 90 Days "))])]),d("div",Fpe,[d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":m[3]||(m[3]=S=>i.value=S),onChange:E},null,544),[[bt,i.value]]),m[16]||(m[16]=we(" Require Two-Factor Authentication for Admin Access "))])])]),d("div",Npe,[m[20]||(m[20]=d("h3",null,"🔑 Data Access Controls",-1)),d("div",Ope,[d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":m[4]||(m[4]=S=>a.value=S),onChange:b},null,544),[[bt,a.value]]),m[18]||(m[18]=we(" Restrict Data Export to Admins Only "))])]),d("div",Mpe,[d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":m[5]||(m[5]=S=>o.value=S),onChange:_},null,544),[[bt,o.value]]),m[19]||(m[19]=we(" Add Watermark to Exported PDFs "))])])]),d("div",Lpe,[m[21]||(m[21]=d("h3",null,"🌐 IP Access Control",-1)),d("div",Bpe,[d("div",Upe,[Ne(d("input",{type:"text","onUpdate:modelValue":m[6]||(m[6]=S=>c.value=S),placeholder:"Enter IP address or range"},null,512),[[ft,c.value]]),d("button",{onClick:v,class:"btn btn-primary"}," Add IP ")]),l.value.length?(L(),B("div",$pe,[(L(!0),B(De,null,$e(l.value,S=>(L(),B("div",{key:S,class:"ip-row"},[d("span",null,Z(S),1),d("button",{onClick:I=>A(S),class:"btn btn-danger btn-sm"}," Remove ",8,Vpe)]))),128))])):(L(),B("div",Hpe," No IP restrictions configured "))])]),d("div",jpe,[m[25]||(m[25]=d("h3",null,"🚨 Security Alerts",-1)),d("div",Gpe,[d("div",Wpe,[d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":m[7]||(m[7]=S=>u.value.unusualAccess=S),onChange:D},null,544),[[bt,u.value.unusualAccess]]),m[22]||(m[22]=we(" Alert on Unusual Access Patterns "))])]),d("div",zpe,[d("label",null,[Ne(d("input",{type:"checkbox","onUpdate:modelValue":m[8]||(m[8]=S=>u.value.bulkExport=S),onChange:D},null,544),[[bt,u.value.bulkExport]]),m[23]||(m[23]=we(" Alert on Bulk Data Exports "))])]),d("div",Kpe,[m[24]||(m[24]=d("h4",null,"Alert Recipients:",-1)),d("div",qpe,[Ne(d("input",{type:"email","onUpdate:modelValue":m[9]||(m[9]=S=>h.value=S),placeholder:"Enter email address"},null,512),[[ft,h.value]]),d("button",{onClick:k,class:"btn btn-primary"}," Add ")]),f.value.length?(L(),B("div",Xpe,[(L(!0),B(De,null,$e(f.value,S=>(L(),B("div",{key:S,class:"email-row"},[d("span",null,Z(S),1),d("button",{onClick:I=>T(S),class:"btn btn-danger btn-sm"}," Remove ",8,Ype)]))),128))])):_e("",!0)])])])]))}},Jpe=St(Qpe,[["__scopeId","data-v-1ecfe656"]]),Zpe={class:"card-header"},eme={class:"component-info"},tme={class:"component-name"},rme={class:"component-description"},nme={class:"card-body"},sme={class:"status-details"},ame={class:"detail-row"},ime={key:0,class:"detail-row"},ome={key:1,class:"detail-row"},lme={class:"detail-value"},cme={key:0,class:"errors-section"},ume={class:"errors-list"},dme={class:"card-actions"},fme=["disabled"],hme={key:1,class:"details-section"},pme={class:"details-content"},mme={class:"detail-item"},gme={class:"detail-item"},vme={key:0,class:"detail-item"},yme={class:"detail-item"},xme={key:0,class:"loading-overlay"},Eme={__name:"ComponentHealthCard",props:{component:{type:Object,required:!0}},emits:["test","toggle"],setup(t){const e=t,r=se(!1),n=se(!1);Ht(()=>e.component.status,(u,f)=>{f==="checking"&&u!=="checking"?n.value=!1:u==="checking"&&(n.value=!0)},{immediate:!0});const s=u=>{switch(u){case"operational":return"✅";case"degraded":return"⚠️";case"down":return"❌";case"disabled":return"⏸️";case"checking":return"🔄";default:return"❓"}},i=u=>{switch(u){case"operational":return"Healthy";case"degraded":return"Issues";case"down":return"Failed";case"disabled":return"Disabled";case"checking":return"Testing...";default:return"Unknown"}},a=u=>u<100?"latency-good":u<500?"latency-ok":"latency-poor",o=u=>u?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).format(u):"Never",l=u=>u?new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"numeric",hour12:!0}).format(u):"Never",c=u=>u.toLowerCase().replace(/\s+/g,"-");return(u,f)=>(L(),B("div",{class:Xe(["health-card",[t.component.status,{disabled:!t.component.enabled}]])},[d("div",Zpe,[d("div",eme,[d("h4",tme,Z(t.component.name),1),d("p",rme,Z(t.component.description),1)]),d("div",{class:Xe(["status-indicator",t.component.status])},Z(s(t.component.status)),3)]),d("div",nme,[d("div",sme,[d("div",ame,[f[3]||(f[3]=d("span",{class:"detail-label"},"Status:",-1)),d("span",{class:Xe(["detail-value",t.component.status])},Z(i(t.component.status)),3)]),t.component.latency!==null?(L(),B("div",ime,[f[4]||(f[4]=d("span",{class:"detail-label"},"Latency:",-1)),d("span",{class:Xe(["detail-value",a(t.component.latency)])},Z(t.component.latency)+"ms ",3)])):_e("",!0),t.component.lastCheck?(L(),B("div",ome,[f[5]||(f[5]=d("span",{class:"detail-label"},"Last Check:",-1)),d("span",lme,Z(o(t.component.lastCheck)),1)])):_e("",!0)]),t.component.errors&&t.component.errors.length?(L(),B("div",cme,[f[6]||(f[6]=d("div",{class:"errors-header"},"⚠️ Issues:",-1)),d("ul",ume,[(L(!0),B(De,null,$e(t.component.errors,h=>(L(),B("li",{key:h,class:"error-item"},Z(h),1))),128))])])):_e("",!0),d("div",dme,[d("button",{onClick:f[0]||(f[0]=h=>u.$emit("test",t.component)),disabled:n.value,class:"btn btn-primary btn-sm"},Z(n.value?"🔄":"🧪")+" Test ",9,fme),d("button",{onClick:f[1]||(f[1]=h=>u.$emit("toggle",t.component)),class:Xe(["btn btn-sm",t.component.enabled?"btn-warning":"btn-success"])},Z(t.component.enabled?"⏸️ Disable":"▶️ Enable"),3),d("button",{onClick:f[2]||(f[2]=h=>r.value=!r.value),class:"btn btn-secondary btn-sm"},Z(r.value?"👁️‍🗨️ Less":"👁️ More"),1)]),r.value?(L(),B("div",hme,[d("div",pme,[d("div",mme,[f[7]||(f[7]=d("strong",null,"Test Function:",-1)),we(" "+Z(t.component.testFunction||"N/A"),1)]),d("div",gme,[f[8]||(f[8]=d("strong",null,"Enabled:",-1)),we(" "+Z(t.component.enabled?"Yes":"No"),1)]),t.component.lastCheck?(L(),B("div",vme,[f[9]||(f[9]=d("strong",null,"Last Test:",-1)),we(" "+Z(l(t.component.lastCheck)),1)])):_e("",!0),d("div",yme,[f[10]||(f[10]=d("strong",null,"Component ID:",-1)),we(" "+Z(c(t.component.name)),1)])])])):_e("",!0)]),n.value?(L(),B("div",xme,f[11]||(f[11]=[d("div",{class:"loading-spinner"},"🔄",-1),d("div",{class:"loading-text"},"Testing component...",-1)]))):_e("",!0)],2))}},qS=St(Eme,[["__scopeId","data-v-18cc0437"]]),_me={class:"health-dashboard"},bme={class:"dashboard-header"},Sme={class:"header-controls"},Ame=["disabled"],Tme={key:0,class:"last-update"},wme={class:"status-overview"},Cme={class:"status-icon"},Ime={class:"status-info"},kme={class:"status-details"},Dme={class:"component-categories"},Pme={class:"category-section"},Rme={class:"components-grid"},Fme={class:"category-section"},Nme={class:"components-grid"},Ome={class:"quick-actions"},Mme={class:"admin-action-btns"},Lme=["disabled"],Bme={class:"logs-section"},Ume={class:"logs-container"},$me={class:"log-time"},Vme={class:"log-component"},Hme={class:"log-message"},jme={key:0,class:"no-logs"},Gme={class:"modal-header"},Wme={class:"modal-content"},zme={__name:"ComponentHealthDashboard",setup(t){const e=se(!1),r=se(null),n=se(!1),s=se({}),i=se([]),a=se(!1),o=se([{name:"Firebase Auth",status:"operational",description:"User authentication service",lastCheck:new Date,enabled:!0,latency:150,errors:[]},{name:"Firestore Database",status:"operational",description:"Main database service",lastCheck:new Date,enabled:!0,latency:200,errors:[]},{name:"Firebase Storage",status:"operational",description:"File storage service",lastCheck:new Date,enabled:!0,latency:180,errors:[]},{name:"Cloud Functions",status:"operational",description:"Server-side functions",lastCheck:new Date,enabled:!0,latency:300,errors:[]}]),l=se([{name:"Session Timeout",status:"operational",description:"Automatic user logout system",lastCheck:new Date,enabled:!0,latency:50,errors:[]},{name:"IEP Encryption",status:"operational",description:"Sensitive data encryption",lastCheck:new Date,enabled:!0,latency:80,errors:[]},{name:"Access Control",status:"operational",description:"Role-based permissions",lastCheck:new Date,enabled:!0,latency:120,errors:[]},{name:"Audit Logging",status:"operational",description:"Activity tracking system",lastCheck:new Date,enabled:!0,latency:90,errors:[]}]),c=Se(()=>[...o.value,...l.value]),u=Se(()=>c.value.length),f=Se(()=>c.value.filter(x=>x.status==="operational").length),h=Se(()=>{const x=c.value.map(m=>m.status);return x.every(m=>m==="operational"||m==="disabled")?"operational":x.some(m=>m==="down"||m==="error")?"down":"degraded"}),p=x=>{switch(x){case"operational":return"✅";case"degraded":return"⚠️";case"down":return"❌";case"disabled":return"⏸️";default:return"🔄"}},g=x=>{switch(x){case"operational":return"All systems operational";case"degraded":return"Some issues detected";case"down":return"Critical issues found";case"checking":return"Running diagnostics...";default:return"Unknown status"}},y=x=>x?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!0}).format(x):"",E=(x,m,S="info")=>{i.value.unshift({id:Date.now()+Math.random(),timestamp:new Date,component:x,message:m,type:S}),i.value.length>20&&(i.value=i.value.slice(0,20))},b=async x=>{E(x.name,"Starting component test...","info");try{const m=performance.now();await new Promise(C=>setTimeout(C,Math.random()*1e3+500));const S=Math.round(performance.now()-m),I=c.value.find(C=>C.name===x.name);I&&(I.status=Math.random()>.1?"operational":"degraded",I.latency=S,I.lastCheck=new Date,I.errors=I.status==="degraded"?["Minor performance issue detected"]:[]),E(x.name,`Test completed - ${I.status} (${S}ms)`,I.status==="operational"?"success":"warning"),s.value={component:x.name,data:{status:I.status,latency:`${S}ms`,timestamp:new Date().toISOString(),details:I.status==="operational"?"All checks passed successfully":"Minor performance issues detected"}},n.value=!0}catch(m){E(x.name,`Test failed: ${m.message}`,"error")}},_=x=>{const m=c.value.find(S=>S.name===x.name);m&&(m.enabled=!m.enabled,m.status=m.enabled?"operational":"disabled",E(x.name,`Component ${m.enabled?"enabled":"disabled"}`,"info"))},v=async()=>{if(!e.value){e.value=!0,r.value=new Date,E("System","Starting full system refresh...","info");try{const x=c.value.filter(m=>m.enabled).map(m=>b(m));await Promise.all(x),E("System","Full system refresh completed","success")}catch(x){E("System",`Refresh failed: ${x.message}`,"error")}finally{e.value=!1}}},A=async()=>{a.value=!0,E("System","Starting comprehensive system test...","info");try{await v(),E("System","Comprehensive system test completed","success")}catch(x){E("System",`System test failed: ${x.message}`,"error")}finally{a.value=!1}},D=()=>{const x={timestamp:new Date().toISOString(),overallStatus:h.value,components:c.value.map(C=>({name:C.name,status:C.status,enabled:C.enabled,latency:C.latency,lastCheck:C.lastCheck,errors:C.errors})),logs:i.value.slice(0,10)},m=new Blob([JSON.stringify(x,null,2)],{type:"application/json"}),S=URL.createObjectURL(m),I=document.createElement("a");I.href=S,I.download=`health-report-${Date.now()}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(S),E("System","Health report exported","info")},k=()=>{i.value=[]},T=()=>{n.value=!1,s.value={}};return Gt(()=>{E("System","Component Health Dashboard initialized","success")}),(x,m)=>(L(),B("div",_me,[d("div",bme,[m[1]||(m[1]=d("h2",null,"🔧 Component Health Dashboard",-1)),d("div",Sme,[d("button",{onClick:v,disabled:e.value,class:"btn btn-primary"},Z(e.value?"🔄 Refreshing...":"🔄 Refresh All"),9,Ame),r.value?(L(),B("span",Tme," Last update: "+Z(y(r.value)),1)):_e("",!0)])]),d("div",wme,[d("div",{class:Xe(["status-card overall",h.value])},[d("div",Cme,Z(p(h.value)),1),d("div",Ime,[m[2]||(m[2]=d("h3",null,"System Status",-1)),d("p",null,Z(g(h.value)),1),d("div",kme,Z(f.value)+"/"+Z(u.value)+" components healthy ",1)])],2)]),d("div",Dme,[d("div",Pme,[m[3]||(m[3]=d("h3",null,"🔧 Core Services",-1)),d("div",Rme,[(L(!0),B(De,null,$e(o.value,S=>(L(),Jt(qS,{key:S.name,component:S,onTest:b,onToggle:_},null,8,["component"]))),128))])]),d("div",Fme,[m[4]||(m[4]=d("h3",null,"🔐 Authentication & Security",-1)),d("div",Nme,[(L(!0),B(De,null,$e(l.value,S=>(L(),Jt(qS,{key:S.name,component:S,onTest:b,onToggle:_},null,8,["component"]))),128))])])]),d("div",Ome,[m[5]||(m[5]=d("h3",null,"⚡ Quick Tests",-1)),d("div",Mme,[d("button",{onClick:A,disabled:a.value,class:"admin-action-btn",style:{"min-width":"160px","max-width":"160px"}},Z(a.value?"🧪 Testing...":"🧪 Full System Test"),9,Lme),d("button",{onClick:D,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," 📋 Export Report ")])]),d("div",Bme,[d("div",{class:"logs-header"},[m[6]||(m[6]=d("h3",null,"📝 Component Activity Logs",-1)),d("div",{class:"log-controls"},[d("button",{onClick:k,class:"btn btn-sm btn-secondary"},"Clear")])]),d("div",Ume,[(L(!0),B(De,null,$e(i.value,S=>(L(),B("div",{key:S.id,class:Xe(["log-entry",S.type])},[d("span",$me,Z(y(S.timestamp)),1),d("span",Vme,Z(S.component),1),d("span",Hme,Z(S.message),1)],2))),128)),i.value.length===0?(L(),B("div",jme,' No activity logs yet. Click "Refresh All" to start monitoring. ')):_e("",!0)])]),n.value?(L(),B("div",{key:0,class:"test-modal-overlay",onClick:T},[d("div",{class:"test-modal",onClick:m[0]||(m[0]=Yr(()=>{},["stop"]))},[d("div",Gme,[d("h3",null,Z(s.value.component)+" Test Results",1),d("button",{onClick:T,class:"btn btn-sm btn-secondary"},"✕")]),d("div",Wme,[d("pre",null,Z(JSON.stringify(s.value.data,null,2)),1)])])])):_e("",!0)]))}},Kme=St(zme,[["__scopeId","data-v-106cd980"]]),qme={class:"admin-permissions-matrix"},Xme={class:"matrix-container"},Yme={key:0,class:"loading-state"},Qme={key:1,class:"permissions-table"},Jme={key:0},Zme={key:0,class:"permission-row"},ege={class:"page-info"},tge={class:"page-name"},rge={class:"page-category"},nge={class:"page-description"},sge={class:"permission-cell"},age=["checked","disabled","onChange"],ige={class:"permission-cell"},oge=["checked","disabled","onChange"],lge={class:"permission-cell"},cge=["checked","disabled","onChange"],uge={class:"matrix-actions"},dge={class:"bulk-actions"},fge={class:"bulk-buttons"},hge={key:0,class:"save-status"},pge={__name:"AdminPermissionsMatrix",setup(t){const e=se(null),r=se(!0),n=Se(()=>!r.value&&s.value.length>0&&Object.keys(i).length>0),s=se([{key:"dashboard",label:"Dashboard",category:"Dashboard",description:"Main admin overview and statistics"},{key:"usersAdd",label:"Add Users",category:"User Management",description:"Create new user accounts"},{key:"usersEdit",label:"Manage Users",category:"User Management",description:"Edit existing user accounts"},{key:"students",label:"Students",category:"Student Management",description:"View and manage student records"},{key:"addStudents",label:"Add Students",category:"Student Management",description:"Bulk import student data"},{key:"aide-assignment",label:"Aide Assignment",category:"Aide Management",description:"Assign aides to students"},{key:"aide-schedule",label:"Aide Schedule",category:"Aide Management",description:"Manage aide schedules"},{key:"time-table",label:"Time Table",category:"Aide Management",description:"Configure school time periods"},{key:"seis",label:"SEIS Import",category:"Data Integration",description:"Import SEIS student data"},{key:"aeries",label:"Aeries API & Import",category:"Data Integration",description:"Connect to Aeries SIS"},{key:"testing-links",label:"Testing Links",category:"Data Integration",description:"Google Sheets integration for testing"},{key:"teacher-feedback",label:"Teacher Feedback Forms",category:"Data Integration",description:"Manage teacher feedback system"},{key:"backup-restore",label:"Backup & Restore",category:"Data Integration",description:"Database backup and restore"},{key:"settings",label:"App Settings",category:"Settings",description:"Global application settings"},{key:"delete-all-users",label:"Delete All Users",category:"Bulk Actions",description:"Mass deletion of user accounts (dangerous operation)"},{key:"delete-all-students",label:"Delete All Students",category:"Bulk Actions",description:"Mass deletion of student records (dangerous operation)"},{key:"permissions",label:"Admin Panel Permissions",category:"System",description:"User role and permission management"},{key:"audit-logs",label:"Audit Logs",category:"System",description:"View and search system audit logs"},{key:"iep-security",label:"IEP Security",category:"System",description:"IEP data encryption and security"},{key:"security",label:"Security Controls",category:"System",description:"Security monitoring and controls"},{key:"component-health",label:"Component Debug",category:"System",description:"Component health and debugging"},{key:"app-settings-testing",label:"App Settings Testing",category:"System",description:"App settings testing and debugging tools"}]),i=As({}),a={school_admin:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!0,settings:!0,"delete-all-users":!0,"delete-all-students":!0,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0},admin_504:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!1,settings:!1,"delete-all-users":!1,"delete-all-students":!1,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0},sped_chair:{dashboard:!0,usersAdd:!0,usersEdit:!0,students:!0,addStudents:!0,"aide-assignment":!0,"aide-schedule":!0,"time-table":!0,seis:!1,aeries:!1,"testing-links":!0,"teacher-feedback":!0,"backup-restore":!1,settings:!1,"delete-all-users":!1,"delete-all-students":!1,permissions:!1,"audit-logs":!1,"iep-security":!1,security:!1,"component-health":!1,"app-settings-testing":!0}},o=()=>{if(!s.value||s.value.length===0){console.warn("adminPages not initialized yet");return}s.value.forEach(E=>{E&&E.key&&(i[E.key]={school_admin:a.school_admin[E.key]||!1,admin_504:a.admin_504[E.key]||!1,sped_chair:a.sped_chair[E.key]||!1})})},l=async()=>{try{const E=Ze(qe,"app_settings","admin_panel_permissions"),b=await qt(E);if(b.exists()){const _=b.data();s.value.forEach(v=>{v&&v.key&&_[v.key]&&(i[v.key]={school_admin:_[v.key].school_admin??a.school_admin[v.key],admin_504:_[v.key].admin_504??a.admin_504[v.key],sped_chair:_[v.key].sped_chair??a.sped_chair[v.key]})}),y("Permissions loaded successfully","success")}else o(),y("Using default permissions","info")}catch(E){console.error("Error loading permissions:",E),y("Error loading permissions","error"),o()}finally{r.value=!1}},c=async()=>{try{const E=Ze(qe,"app_settings","admin_panel_permissions");await jt(E,i),y("Permissions saved successfully","success")}catch(E){console.error("Error saving permissions:",E),y("Error saving permissions","error")}},u=async(E,b,_)=>{i[E]&&(i[E][b]=_,await c())},f=async E=>{s.value.forEach(b=>{b&&b.key&&i[b.key]&&(i[b.key][E]=!0)}),await c(),y(`All permissions granted to ${E}`,"success")},h=async()=>{s.value.forEach(E=>{E&&E.key&&i[E.key]&&(i[E.key].school_admin=!1,i[E.key].admin_504=!1,i[E.key].sped_chair=!1)}),await c(),y("All permissions revoked","warning")},p=async()=>{o(),await c(),y("Permissions reset to defaults","info")},g=(E,b)=>["permissions","iep-security","security","component-health"].includes(E)?!0:["delete-all-users","delete-all-students"].includes(E)?b!=="school_admin":b==="admin_504"?["settings"].includes(E):b==="sped_chair"?["settings"].includes(E):!1,y=(E,b)=>{e.value={message:E,type:b},setTimeout(()=>{e.value=null},3e3)};return Gt(async()=>{await l()}),(E,b)=>(L(),B("div",qme,[b[9]||(b[9]=d("div",{class:"matrix-header"},[d("h2",null,"🔐 Admin Panel Permissions Matrix"),d("p",{class:"matrix-description"}," Control which admin panel pages different admin roles can access. Changes are saved automatically. ")],-1)),d("div",Xme,[r.value?(L(),B("div",Yme,b[3]||(b[3]=[d("p",null,"Loading permissions...",-1)]))):(L(),B("table",Qme,[b[7]||(b[7]=d("thead",null,[d("tr",null,[d("th",{class:"page-column"},"Admin Panel Page"),d("th",{class:"role-column"},"School Admin"),d("th",{class:"role-column"},"504 Coordinator"),d("th",{class:"role-column"},"SPED Chair")])],-1)),n.value?(L(),B("tbody",Jme,[(L(!0),B(De,null,$e(s.value,_=>(L(),B(De,{key:(_==null?void 0:_.key)||"unknown"},[_&&_.key&&i[_.key]?(L(),B("tr",Zme,[d("td",ege,[d("div",tge,Z(_.label),1),d("div",rge,Z(_.category),1),d("div",nge,Z(_.description),1)]),d("td",sge,[d("label",{class:Xe(["permission-toggle",{disabled:g(_.key,"school_admin")}])},[d("input",{type:"checkbox",checked:i[_.key]&&i[_.key].school_admin,disabled:g(_.key,"school_admin"),onChange:v=>u(_.key,"school_admin",v.target.checked)},null,40,age),b[4]||(b[4]=d("span",{class:"toggle-slider"},null,-1))],2)]),d("td",ige,[d("label",{class:Xe(["permission-toggle",{disabled:g(_.key,"admin_504")}])},[d("input",{type:"checkbox",checked:i[_.key]&&i[_.key].admin_504,disabled:g(_.key,"admin_504"),onChange:v=>u(_.key,"admin_504",v.target.checked)},null,40,oge),b[5]||(b[5]=d("span",{class:"toggle-slider"},null,-1))],2)]),d("td",lge,[d("label",{class:Xe(["permission-toggle",{disabled:g(_.key,"sped_chair")}])},[d("input",{type:"checkbox",checked:i[_.key]&&i[_.key].sped_chair,disabled:g(_.key,"sped_chair"),onChange:v=>u(_.key,"sped_chair",v.target.checked)},null,40,cge),b[6]||(b[6]=d("span",{class:"toggle-slider"},null,-1))],2)])])):_e("",!0)],64))),128))])):_e("",!0)]))]),d("div",uge,[d("div",dge,[b[8]||(b[8]=d("h3",null,"Bulk Actions",-1)),d("div",fge,[d("button",{onClick:b[0]||(b[0]=_=>f("school_admin")),class:"btn btn-success"}," Grant All to School Admin "),d("button",{onClick:b[1]||(b[1]=_=>f("admin_504")),class:"btn btn-success"}," Grant All to 504 Coordinator "),d("button",{onClick:b[2]||(b[2]=_=>f("sped_chair")),class:"btn btn-success"}," Grant All to SPED Chair "),d("button",{onClick:h,class:"btn btn-warning"}," Revoke All Permissions "),d("button",{onClick:p,class:"btn btn-secondary"}," Reset to Defaults ")])])]),e.value?(L(),B("div",hge,[d("div",{class:Xe(["status-message",e.value.type])},Z(e.value.message),3)])):_e("",!0)]))}},mge=St(pge,[["__scopeId","data-v-be29f1ae"]]),gge={class:"theme-manager"},vge={key:0,class:"loading-state"},yge={key:1,class:"error-state"},xge={class:"error-message"},Ege={key:2,class:"theme-editor"},_ge={class:"default-themes"},bge={class:"theme-presets"},Sge=["onClick"],Age={class:"theme-preview-colors"},Tge={class:"theme-info"},wge={class:"theme-actions"},Cge=["disabled"],Ige=["disabled"],kge={class:"theme-sections"},Dge={class:"theme-section"},Pge={class:"enhanced-color-grid"},Rge={class:"color-input"},Fge={class:"color-picker-wrapper"},Nge={class:"color-input"},Oge={class:"color-picker-wrapper"},Mge={class:"color-input"},Lge={class:"color-picker-wrapper"},Bge={class:"color-input"},Uge={class:"color-picker-wrapper"},$ge={class:"color-input"},Vge={class:"color-picker-wrapper"},Hge={class:"color-input"},jge={class:"color-picker-wrapper"},Gge={class:"theme-section"},Wge={class:"typography-grid"},zge={class:"option-group"},Kge={class:"option-group"},qge={class:"option-group"},Xge={class:"theme-section"},Yge={class:"style-options-grid"},Qge={class:"option-group"},Jge={class:"option-group"},Zge={class:"option-group"},eve={class:"theme-section"},tve={class:"student-preview-container"},rve={class:"mockup-header"},nve={class:"mockup-table"},sve={class:"mockup-table-row"},ave={class:"mockup-cell"},ive={class:"mockup-table-row"},ove={class:"mockup-cell"},lve={__name:"ThemeManager",setup(t){const{currentTheme:e,loading:r,error:n,loadTheme:s,saveTheme:i,resetTheme:a,updateThemeProperty:o,DEFAULT_THEME:l}=fI(),c=[{name:"Professional Blue",description:"Clean, accessible blue theme for professional use",primaryColor:"#1976d2",primaryHover:"#1565c0",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#212529",textSecondary:"#495057",textMuted:"#6c757d",textInverse:"#ffffff",headerTextColor:"#1a202c",accentColor:"#e3f2fd",secondaryColor:"#6c757d",secondaryHover:"#545b62",successColor:"#28a745",warningColor:"#ffc107",errorColor:"#dc3545",infoColor:"#17a2b8",borderColor:"#dee2e6",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"standard",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Inter', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.5"},{name:"Educational Orange",description:"Warm, professional orange theme optimized for readability",primaryColor:"#e65100",primaryHover:"#bf360c",primaryLight:"#fff3e0",primaryDark:"#bf360c",bgPrimary:"#fafafa",bgSecondary:"#ffffff",bgTertiary:"#f5f5f5",textPrimary:"#212121",textSecondary:"#424242",textMuted:"#757575",textInverse:"#ffffff",headerTextColor:"#bf360c",accentColor:"#ffcc80",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#2e7d32",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#e0e0e0",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Source Sans Pro', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Accessible Green",description:"Professional green theme with excellent readability",primaryColor:"#2e7d32",primaryHover:"#1b5e20",primaryLight:"#e8f5e8",primaryDark:"#1b5e20",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#1b5e20",textSecondary:"#2e7d32",textMuted:"#558b2f",textInverse:"#ffffff",headerTextColor:"#1b5e20",accentColor:"#a5d6a7",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#4caf50",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#c8e6c9",borderStyle:"rounded",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Open Sans', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Professional Dark",description:"High-contrast dark theme for reduced eye strain",primaryColor:"#bb86fc",primaryHover:"#9c27b0",primaryLight:"#f3e5f5",primaryDark:"#6a1b9a",bgPrimary:"#121212",bgSecondary:"#1e1e1e",bgTertiary:"#2d2d2d",textPrimary:"#ffffff",textSecondary:"#e0e0e0",textMuted:"#bdbdbd",textInverse:"#000000",headerTextColor:"#bb86fc",accentColor:"#424242",secondaryColor:"#616161",secondaryHover:"#424242",successColor:"#4caf50",warningColor:"#ff9800",errorColor:"#f44336",infoColor:"#2196f3",borderColor:"#424242",borderStyle:"rounded",shadowStyle:"medium",contrastLevel:"maximum",borderRadiusSm:"4px",borderRadiusMd:"6px",borderRadiusLg:"8px",borderRadiusXl:"12px",fontFamilyBase:"'Roboto', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.6"},{name:"Corporate Navy",description:"Professional navy blue theme for corporate environments",primaryColor:"#1565c0",primaryHover:"#0d47a1",primaryLight:"#e3f2fd",primaryDark:"#0d47a1",bgPrimary:"#f8f9fa",bgSecondary:"#ffffff",bgTertiary:"#f1f3f4",textPrimary:"#0d47a1",textSecondary:"#1565c0",textMuted:"#1976d2",textInverse:"#ffffff",headerTextColor:"#0d47a1",accentColor:"#bbdefb",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#2e7d32",warningColor:"#f57c00",errorColor:"#d32f2f",infoColor:"#1976d2",borderColor:"#e1f5fe",borderStyle:"sharp",shadowStyle:"subtle",contrastLevel:"high",borderRadiusSm:"2px",borderRadiusMd:"4px",borderRadiusLg:"6px",borderRadiusXl:"8px",fontFamilyBase:"'Source Sans Pro', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1rem",lineHeight:"1.5"},{name:"High Contrast",description:"Maximum accessibility theme with high contrast ratios",primaryColor:"#000000",primaryHover:"#212121",primaryLight:"#f5f5f5",primaryDark:"#000000",bgPrimary:"#ffffff",bgSecondary:"#ffffff",bgTertiary:"#f8f9fa",textPrimary:"#000000",textSecondary:"#212121",textMuted:"#424242",textInverse:"#ffffff",headerTextColor:"#000000",accentColor:"#e0e0e0",secondaryColor:"#424242",secondaryHover:"#212121",successColor:"#1b5e20",warningColor:"#e65100",errorColor:"#b71c1c",infoColor:"#0d47a1",borderColor:"#000000",borderStyle:"sharp",shadowStyle:"bold",contrastLevel:"maximum",borderRadiusSm:"0px",borderRadiusMd:"2px",borderRadiusLg:"4px",borderRadiusXl:"6px",fontFamilyBase:"'Roboto', 'Segoe UI', 'Arial', sans-serif",fontSizeBase:"1.125rem",lineHeight:"1.7"}],u=As({...l}),f=se(!1),h=se(""),p=se(!1),g=se(null);Ht(e,x=>{Object.assign(u,x)},{deep:!0});const y=(x,m=!1)=>{h.value=x,p.value=m,setTimeout(()=>{h.value="",p.value=!1},5e3)},E=async()=>{f.value=!0;try{await i(u),y("Theme saved successfully!")}catch(x){y("Error saving theme: "+x.message,!0)}finally{f.value=!1}},b=async()=>{if(confirm("Are you sure you want to reset the theme to defaults? This cannot be undone."))try{await a(),y("Theme reset to defaults")}catch(x){y("Error resetting theme: "+x.message,!0)}},_=x=>{Object.assign(u,x),Object.keys(x).forEach(m=>{m!=="name"&&m!=="description"&&o(m,x[m])}),y(`Applied ${x.name} theme`)},v=x=>x.primaryColor===u.primaryColor&&x.bgPrimary===u.bgPrimary&&x.textPrimary===u.textPrimary,A=x=>{const S={rounded:{sm:"4px",md:"6px",lg:"8px",xl:"12px"},sharp:{sm:"2px",md:"4px",lg:"6px",xl:"8px"},"extra-rounded":{sm:"8px",md:"12px",lg:"16px",xl:"20px"}}[x];S&&(o("borderRadiusSm",S.sm),o("borderRadiusMd",S.md),o("borderRadiusLg",S.lg),o("borderRadiusXl",S.xl))},D=x=>{const S={none:{sm:"none",md:"none",lg:"none",xl:"none"},subtle:{sm:"0 1px 2px rgba(0, 0, 0, 0.05)",md:"0 2px 4px rgba(0, 0, 0, 0.1)",lg:"0 4px 6px rgba(0, 0, 0, 0.1)",xl:"0 4px 20px rgba(0, 0, 0, 0.15)"},medium:{sm:"0 2px 4px rgba(0, 0, 0, 0.1)",md:"0 4px 8px rgba(0, 0, 0, 0.15)",lg:"0 6px 12px rgba(0, 0, 0, 0.2)",xl:"0 8px 24px rgba(0, 0, 0, 0.25)"},bold:{sm:"0 4px 8px rgba(0, 0, 0, 0.15)",md:"0 8px 16px rgba(0, 0, 0, 0.2)",lg:"0 12px 24px rgba(0, 0, 0, 0.25)",xl:"0 16px 32px rgba(0, 0, 0, 0.3)"}}[x];S&&(o("shadowSm",S.sm),o("shadowMd",S.md),o("shadowLg",S.lg),o("shadowXl",S.xl))},k=x=>{o("fontSizeBase",x);const m=parseFloat(x),S=x.replace(/[\d.]/g,"");o("fontSizeXs",`${(m*.75).toFixed(3)}${S}`),o("fontSizeSm",`${(m*.875).toFixed(3)}${S}`),o("fontSizeLg",`${(m*1.125).toFixed(3)}${S}`),o("fontSizeXl",`${(m*1.25).toFixed(3)}${S}`),o("fontSizeXxl",`${(m*1.5).toFixed(3)}${S}`)},T=x=>{o("contrastLevel",x),x==="high"?u.textPrimary.includes("#")&&(o("textPrimary","#000000"),o("textSecondary","#212121")):x==="maximum"&&(o("textPrimary","#000000"),o("textSecondary","#000000"),o("bgPrimary","#ffffff"),o("bgSecondary","#ffffff"))};return Gt(async()=>{try{await s()}catch(x){console.error("Error loading theme:",x)}}),(x,m)=>(L(),B("div",gge,[m[72]||(m[72]=d("div",{class:"theme-header"},[d("h2",null,"🎨 Student Page Theme Customization"),d("p",{class:"theme-description"}," Customize the visual appearance of the student page. Changes are applied in real-time and saved to the database. ")],-1)),q(r)?(L(),B("div",vge,m[38]||(m[38]=[d("div",{class:"spinner"},null,-1),d("p",null,"Loading theme settings...",-1)]))):q(n)?(L(),B("div",yge,[d("p",xge,Z(q(n)),1),d("button",{onClick:m[0]||(m[0]=(...S)=>q(s)&&q(s)(...S)),class:"btn btn-primary"},"Retry")])):(L(),B("div",Ege,[d("div",_ge,[m[39]||(m[39]=d("h3",null,"🎯 Quick Theme Selection",-1)),d("div",bge,[(L(),B(De,null,$e(c,S=>d("div",{key:S.name,onClick:I=>_(S),class:Xe(["theme-preset",{active:v(S)}])},[d("div",Age,[d("div",{class:"color-dot",style:Nr({backgroundColor:S.primaryColor})},null,4),d("div",{class:"color-dot",style:Nr({backgroundColor:S.bgPrimary})},null,4),d("div",{class:"color-dot",style:Nr({backgroundColor:S.textPrimary})},null,4)]),d("div",Tge,[d("h4",null,Z(S.name),1),d("p",null,Z(S.description),1)])],10,Sge)),64))])]),d("div",wge,[d("button",{onClick:E,disabled:f.value,class:"btn btn-primary"},Z(f.value?"💾 Saving...":"💾 Save Theme"),9,Cge),d("button",{onClick:b,disabled:f.value,class:"btn btn-warning"}," 🔄 Reset to Default ",8,Ige)]),h.value?(L(),B("div",{key:0,class:Xe(["status-message",{error:p.value,success:!p.value}])},Z(h.value),3)):_e("",!0),d("div",kge,[d("section",Dge,[m[46]||(m[46]=d("h3",null,"🎨 Essential Student Page Colors",-1)),d("div",Pge,[d("div",Rge,[m[40]||(m[40]=d("label",null,"Primary Color (Buttons & Links)",-1)),d("div",Fge,[Ne(d("input",{type:"color","onUpdate:modelValue":m[1]||(m[1]=S=>u.primaryColor=S),onInput:m[2]||(m[2]=S=>q(o)("primaryColor",S.target.value)),class:"color-picker"},null,544),[[ft,u.primaryColor]]),Ne(d("input",{type:"text","onUpdate:modelValue":m[3]||(m[3]=S=>u.primaryColor=S),onInput:m[4]||(m[4]=S=>q(o)("primaryColor",S.target.value)),class:"color-text",placeholder:"#1976d2"},null,544),[[ft,u.primaryColor]])])]),d("div",Nge,[m[41]||(m[41]=d("label",null,"Header Text Color",-1)),d("div",Oge,[Ne(d("input",{type:"color","onUpdate:modelValue":m[5]||(m[5]=S=>u.headerTextColor=S),onInput:m[6]||(m[6]=S=>q(o)("headerTextColor",S.target.value)),class:"color-picker"},null,544),[[ft,u.headerTextColor]]),Ne(d("input",{type:"text","onUpdate:modelValue":m[7]||(m[7]=S=>u.headerTextColor=S),onInput:m[8]||(m[8]=S=>q(o)("headerTextColor",S.target.value)),class:"color-text",placeholder:"#1a1a1a"},null,544),[[ft,u.headerTextColor]])])]),d("div",Mge,[m[42]||(m[42]=d("label",null,"Background Color",-1)),d("div",Lge,[Ne(d("input",{type:"color","onUpdate:modelValue":m[9]||(m[9]=S=>u.bgPrimary=S),onInput:m[10]||(m[10]=S=>q(o)("bgPrimary",S.target.value)),class:"color-picker"},null,544),[[ft,u.bgPrimary]]),Ne(d("input",{type:"text","onUpdate:modelValue":m[11]||(m[11]=S=>u.bgPrimary=S),onInput:m[12]||(m[12]=S=>q(o)("bgPrimary",S.target.value)),class:"color-text",placeholder:"#f4f6f9"},null,544),[[ft,u.bgPrimary]])])]),d("div",Bge,[m[43]||(m[43]=d("label",null,"Text Color",-1)),d("div",Uge,[Ne(d("input",{type:"color","onUpdate:modelValue":m[13]||(m[13]=S=>u.textPrimary=S),onInput:m[14]||(m[14]=S=>q(o)("textPrimary",S.target.value)),class:"color-picker"},null,544),[[ft,u.textPrimary]]),Ne(d("input",{type:"text","onUpdate:modelValue":m[15]||(m[15]=S=>u.textPrimary=S),onInput:m[16]||(m[16]=S=>q(o)("textPrimary",S.target.value)),class:"color-text",placeholder:"#333333"},null,544),[[ft,u.textPrimary]])])]),d("div",$ge,[m[44]||(m[44]=d("label",null,"Accent Color (Service Pills)",-1)),d("div",Vge,[Ne(d("input",{type:"color","onUpdate:modelValue":m[17]||(m[17]=S=>u.accentColor=S),onInput:m[18]||(m[18]=S=>q(o)("accentColor",S.target.value)),class:"color-picker"},null,544),[[ft,u.accentColor]]),Ne(d("input",{type:"text","onUpdate:modelValue":m[19]||(m[19]=S=>u.accentColor=S),onInput:m[20]||(m[20]=S=>q(o)("accentColor",S.target.value)),class:"color-text",placeholder:"#e3f2fd"},null,544),[[ft,u.accentColor]])])]),d("div",Hge,[m[45]||(m[45]=d("label",null,"Card Background",-1)),d("div",jge,[Ne(d("input",{type:"color","onUpdate:modelValue":m[21]||(m[21]=S=>u.bgSecondary=S),onInput:m[22]||(m[22]=S=>q(o)("bgSecondary",S.target.value)),class:"color-picker"},null,544),[[ft,u.bgSecondary]]),Ne(d("input",{type:"text","onUpdate:modelValue":m[23]||(m[23]=S=>u.bgSecondary=S),onInput:m[24]||(m[24]=S=>q(o)("bgSecondary",S.target.value)),class:"color-text",placeholder:"#ffffff"},null,544),[[ft,u.bgSecondary]])])])])]),d("section",Gge,[m[53]||(m[53]=d("h3",null,"📝 Typography & Readability",-1)),d("div",Wge,[d("div",zge,[m[48]||(m[48]=d("label",null,"Font Family",-1)),Ne(d("select",{"onUpdate:modelValue":m[25]||(m[25]=S=>u.fontFamilyBase=S),onChange:m[26]||(m[26]=S=>q(o)("fontFamilyBase",S.target.value)),class:"style-select"},m[47]||(m[47]=[Rn('<option value="&#39;Inter&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Inter (Modern &amp; Clean)</option><option value="&#39;Roboto&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Roboto (Google Standard)</option><option value="&#39;Open Sans&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Open Sans (Friendly)</option><option value="&#39;Source Sans Pro&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Source Sans Pro (Professional)</option><option value="&#39;Lato&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Lato (Humanist)</option><option value="&#39;Nunito Sans&#39;, &#39;Segoe UI&#39;, &#39;Arial&#39;, sans-serif" data-v-5e89749a>Nunito Sans (Rounded)</option><option value="&#39;System UI&#39;, -apple-system, sans-serif" data-v-5e89749a>System Default</option>',7)]),544),[[sr,u.fontFamilyBase]])]),d("div",Kge,[m[50]||(m[50]=d("label",null,"Base Font Size",-1)),Ne(d("select",{"onUpdate:modelValue":m[27]||(m[27]=S=>u.fontSizeBase=S),onChange:m[28]||(m[28]=S=>k(S.target.value)),class:"style-select"},m[49]||(m[49]=[d("option",{value:"0.875rem"},"Small (14px) - Compact",-1),d("option",{value:"1rem"},"Medium (16px) - Standard",-1),d("option",{value:"1.125rem"},"Large (18px) - Comfortable",-1),d("option",{value:"1.25rem"},"Extra Large (20px) - Accessible",-1)]),544),[[sr,u.fontSizeBase]])]),d("div",qge,[m[52]||(m[52]=d("label",null,"Line Height",-1)),Ne(d("select",{"onUpdate:modelValue":m[29]||(m[29]=S=>u.lineHeight=S),onChange:m[30]||(m[30]=S=>q(o)("lineHeight",S.target.value)),class:"style-select"},m[51]||(m[51]=[d("option",{value:"1.4"},"Compact (1.4)",-1),d("option",{value:"1.5"},"Standard (1.5)",-1),d("option",{value:"1.6"},"Comfortable (1.6)",-1),d("option",{value:"1.7"},"Spacious (1.7)",-1)]),544),[[sr,u.lineHeight]])])])]),d("section",Xge,[m[60]||(m[60]=d("h3",null,"🎛️ Visual Style",-1)),d("div",Yge,[d("div",Qge,[m[55]||(m[55]=d("label",null,"Border Radius Style",-1)),Ne(d("select",{"onUpdate:modelValue":m[31]||(m[31]=S=>u.borderStyle=S),onChange:m[32]||(m[32]=S=>A(S.target.value)),class:"style-select"},m[54]||(m[54]=[d("option",{value:"rounded"},"Rounded (Modern)",-1),d("option",{value:"sharp"},"Sharp (Professional)",-1),d("option",{value:"extra-rounded"},"Extra Rounded (Friendly)",-1)]),544),[[sr,u.borderStyle]])]),d("div",Jge,[m[57]||(m[57]=d("label",null,"Shadow Style",-1)),Ne(d("select",{"onUpdate:modelValue":m[33]||(m[33]=S=>u.shadowStyle=S),onChange:m[34]||(m[34]=S=>D(S.target.value)),class:"style-select"},m[56]||(m[56]=[d("option",{value:"subtle"},"Subtle",-1),d("option",{value:"medium"},"Medium",-1),d("option",{value:"bold"},"Bold",-1),d("option",{value:"none"},"No Shadows",-1)]),544),[[sr,u.shadowStyle]])]),d("div",Zge,[m[59]||(m[59]=d("label",null,"Contrast Level",-1)),Ne(d("select",{"onUpdate:modelValue":m[35]||(m[35]=S=>u.contrastLevel=S),onChange:m[36]||(m[36]=S=>T(S.target.value)),class:"style-select"},m[58]||(m[58]=[d("option",{value:"standard"},"Standard Contrast",-1),d("option",{value:"high"},"High Contrast (Accessible)",-1),d("option",{value:"maximum"},"Maximum Contrast",-1)]),544),[[sr,u.contrastLevel]])])])]),d("section",eve,[m[71]||(m[71]=d("h3",null,"👁️ Student Page Preview",-1)),d("div",tve,[d("div",{class:"student-page-mockup",style:Nr({fontFamily:u.fontFamilyBase,fontSize:u.fontSizeBase,lineHeight:u.lineHeight})},[d("div",rve,[d("h2",{style:Nr({color:u.headerTextColor||u.textPrimary,fontFamily:u.fontFamilyBase})},"Student Management",4),m[61]||(m[61]=Rn('<div class="mockup-search" data-v-5e89749a><input type="text" placeholder="Search students..." readonly data-v-5e89749a></div><div class="mockup-controls" data-v-5e89749a><button class="mockup-btn primary" data-v-5e89749a>🔍 Filters</button><select class="mockup-select" data-v-5e89749a><option data-v-5e89749a>First Name</option></select><div class="mockup-radio-group" data-v-5e89749a><label class="active" data-v-5e89749a>List</label><label data-v-5e89749a>Class</label></div></div>',2))]),d("div",nve,[m[70]||(m[70]=Rn('<div class="mockup-table-header" data-v-5e89749a><div class="mockup-cell" data-v-5e89749a>Student Name</div><div class="mockup-cell" data-v-5e89749a>Grade</div><div class="mockup-cell" data-v-5e89749a>Case Manager</div><div class="mockup-cell" data-v-5e89749a>Services</div><div class="mockup-cell" data-v-5e89749a>Actions</div></div>',1)),d("div",sve,[m[62]||(m[62]=d("div",{class:"mockup-cell"},"John Smith",-1)),m[63]||(m[63]=d("div",{class:"mockup-cell"},"9th",-1)),m[64]||(m[64]=d("div",{class:"mockup-cell"},"Ms. Johnson",-1)),d("div",ave,[d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"Speech",4),d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"OT",4)]),m[65]||(m[65]=d("div",{class:"mockup-cell"},[d("button",{class:"mockup-btn primary small"},"Edit")],-1))]),d("div",ive,[m[66]||(m[66]=d("div",{class:"mockup-cell"},"Jane Doe",-1)),m[67]||(m[67]=d("div",{class:"mockup-cell"},"10th",-1)),m[68]||(m[68]=d("div",{class:"mockup-cell"},"Mr. Wilson",-1)),d("div",ove,[d("span",{class:"mockup-service-pill",style:Nr({backgroundColor:u.accentColor||u.primaryLight})},"Resource",4)]),m[69]||(m[69]=d("div",{class:"mockup-cell"},[d("button",{class:"mockup-btn primary small"},"Edit")],-1))])])],4)])])])])),d("input",{ref_key:"fileInput",ref:g,type:"file",accept:".json",style:{display:"none"},onChange:m[37]||(m[37]=(...S)=>x.handleFileImport&&x.handleFileImport(...S))},null,544)]))}},cve=St(lve,[["__scopeId","data-v-5e89749a"]]),uve={class:"secure-pdf-test"},dve={class:"test-section"},fve={class:"status-grid"},hve={class:"status-item"},pve={class:"status-value"},mve={class:"status-item"},gve={class:"status-value"},vve={class:"status-item"},yve={class:"status-value"},xve={class:"status-item"},Eve={class:"status-value"},_ve={class:"test-section"},bve=["disabled"],Sve=["disabled"],Ave={class:"test-section"},Tve=["disabled"],wve={key:0,class:"error-message"},Cve={key:1,class:"success-message"},Ive={key:0,class:"test-section"},kve=["disabled"],Dve={key:0,class:"error-message"},Pve={key:1,class:"success-message"},Rve={class:"test-section"},Fve=["disabled"],Nve={key:0,class:"error-message"},Ove={key:1,class:"success-message"},Mve={class:"test-section"},Lve=["disabled"],Bve={key:0,class:"error-message"},Uve={key:1,class:"success-message"},$ve={__name:"SecurePdfTest",setup(t){const e=se(null),r=se("test-student-123"),n=se(null),s=se(!1),i=se(!1),a=se(!1),o=se(null),l=se(null),c=se(!1),u=se(null),f=se(null),h=se("Checking..."),p=se("Checking..."),g=se("Checking..."),y=se("Checking..."),E=se(null),b=se(null),_=se(null),v=se(null),{uploadPdf:A,downloadPdf:D,isUploading:k,isDownloading:T}=nx();Se(()=>{var R,N,M;return((R=Et.currentUser)==null?void 0:R.role)||((M=(N=Et.currentUser)==null?void 0:N.claims)==null?void 0:M.role)||"unknown"});const x=R=>{const N=R.target.files[0];if(N){if(N.type!=="application/pdf"){alert("Please select a PDF file"),R.target.value="";return}e.value=N,b.value=null,E.value=null,o.value=null,l.value=null}},m=async()=>{var R,N;if(!r.value){alert("Please enter a student ID");return}try{s.value=!0;const M=Et.currentUser;if(M){const z=await M.getIdTokenResult();console.log("🔍 User token result:",z),console.log("🔍 User role from token:",z.claims.role)}const O=Ze(qe,"students",r.value);(await qt(O)).exists()?alert("ℹ️ Test student already exists"):(await jt(O,{app:{studentData:{firstName:"Test",lastName:"Student",grade:"7",plan:"IEP",caseManagerId:((R=Et.currentUser)==null?void 0:R.uid)||"test-case-manager"},staffIds:[((N=Et.currentUser)==null?void 0:N.uid)||"test-user"],schedule:{periods:{},classServices:[]},providers:{},accommodations:{instruction:"",assessment:""},flags:{flag1:!1,flag2:!1}},createdAt:Dn()}),alert("✅ Test student created successfully!"))}catch(M){alert(`❌ Error creating test student: ${M.message}`),console.error("Error creating test student:",M),M.message.includes("permissions")&&alert("⚠️ Admin permissions required. Try using an existing student ID instead.")}finally{s.value=!1}},S=async()=>{var R,N,M,O;try{i.value=!0;const G=At(qe,"students"),z=cr(G,la(5)),j=await zt(z);if(j.empty)alert("❌ No students found in database");else{const H=j.docs.map(te=>({id:te.id,...te.data()}));console.log("📋 Available students:",H);const V=H[0];r.value=V.id,alert(`✅ Found student: ${((N=(R=V.app)==null?void 0:R.studentData)==null?void 0:N.firstName)||"Unknown"} ${((O=(M=V.app)==null?void 0:M.studentData)==null?void 0:O.lastName)||"Student"} (ID: ${V.id})`)}}catch(G){alert(`❌ Error finding student: ${G.message}`),console.error("Error finding student:",G)}finally{i.value=!1}},I=async()=>{if(!e.value||!r.value){alert("Please select a file and enter a student ID");return}try{b.value=null,E.value=null;const R=await A(e.value,r.value);E.value=R,console.log("✅ Test PDF uploaded successfully:",R)}catch(R){b.value=R.message,console.error("❌ Test PDF upload failed:",R)}},C=async()=>{if(!E.value||!r.value){alert("Please upload a PDF first");return}try{_.value=null,v.value=null,await D(E.value,r.value,"test-document.pdf"),v.value=!0,console.log("✅ Test PDF downloaded successfully")}catch(R){_.value=R.message,console.error("❌ Test PDF download failed:",R)}},F=async()=>{if(!e.value){alert("Please select a file first");return}try{a.value=!0,o.value=null,l.value=null;const R=yh(kc,`public/test-${Date.now()}.pdf`);await R4(R,e.value),l.value=!0,console.log("✅ Direct upload successful")}catch(R){o.value=R.message,console.error("❌ Direct upload failed:",R)}finally{a.value=!1}},W=async()=>{if(!r.value){alert("Please enter a student ID first");return}try{c.value=!0,u.value=null,f.value=null;const{getFunctions:R,httpsCallable:N}=await ua(async()=>{const{getFunctions:H,httpsCallable:V}=await Promise.resolve().then(()=>C0);return{getFunctions:H,httpsCallable:V}},void 0),M=R(),O=N(M,"getStudentFileUrl"),G="test-document.pdf";console.log(`🔍 Testing cloud function with studentId: ${r.value}, fileName: ${G}`);const z=await O({studentId:r.value,fileName:G});console.log("✅ Cloud function result:",z.data),f.value=!0;const j=z.data.url;j&&!j.includes("token=")?console.log("✅ URL is private (no download token)"):console.warn("⚠️ URL may not be private")}catch(R){u.value=R.message,console.error("❌ Cloud function test failed:",R)}finally{c.value=!1}},P=async()=>{try{const R=P0.encryptionKey;h.value=R&&R!=="your-dev-key-here"?"✅ Configured":"⚠️ Using default key";try{const N=yh(kc,"public/test-access");await N4(N),p.value="✅ Accessible"}catch(N){N.code==="storage/unauthorized"?p.value="⚠️ Limited access (expected)":p.value="❌ Access denied"}try{const N=Ze(qe,"test","test");await qt(N),g.value="✅ Accessible"}catch{g.value="❌ Access denied"}try{const N=Et.currentUser;if(N){const M=await N.getIdTokenResult();y.value=M.claims.role||"unknown",console.log("🔍 User role detected:",y.value)}else y.value="not authenticated"}catch(N){y.value="error reading role",console.error("Error reading user role:",N)}}catch(R){console.error("Error checking system status:",R)}};return Gt(()=>{P()}),(R,N)=>(L(),B("div",uve,[N[16]||(N[16]=d("h2",null,"🔒 Secure PDF System Test",-1)),d("div",dve,[N[5]||(N[5]=d("h3",null,"System Status",-1)),d("div",fve,[d("div",hve,[N[1]||(N[1]=d("span",{class:"status-label"},"Encryption Key:",-1)),d("span",pve,Z(h.value),1)]),d("div",mve,[N[2]||(N[2]=d("span",{class:"status-label"},"Storage Access:",-1)),d("span",gve,Z(p.value),1)]),d("div",vve,[N[3]||(N[3]=d("span",{class:"status-label"},"Firestore Access:",-1)),d("span",yve,Z(g.value),1)]),d("div",xve,[N[4]||(N[4]=d("span",{class:"status-label"},"User Role:",-1)),d("span",Eve,Z(y.value),1)])])]),d("div",_ve,[N[6]||(N[6]=d("h3",null,"Test Student ID",-1)),Ne(d("input",{"onUpdate:modelValue":N[0]||(N[0]=M=>r.value=M),placeholder:"Enter test student ID",class:"student-id-input"},null,512),[[ft,r.value]]),N[7]||(N[7]=d("p",{class:"help-text"},"Enter a student ID to test with. You can:",-1)),N[8]||(N[8]=d("ul",{class:"help-text"},[d("li",null,"Use an existing student ID from your database"),d("li",null,"Create a new test student (requires admin permissions)"),d("li",null,'Use "test-student-123" for testing')],-1)),d("button",{onClick:m,disabled:s.value,class:"btn btn-secondary"},Z(s.value?"Creating...":"Create Test Student"),9,bve),d("button",{onClick:S,disabled:i.value,class:"btn btn-secondary"},Z(i.value?"Finding...":"Find Existing Student"),9,Sve)]),d("div",Ave,[N[9]||(N[9]=d("h3",null,"Upload Test PDF",-1)),d("input",{type:"file",accept:"application/pdf",onChange:x,ref_key:"fileInput",ref:n},null,544),d("button",{onClick:I,disabled:!e.value||q(k)},Z(q(k)?"🔄 Uploading...":"📤 Upload PDF"),9,Tve),b.value?(L(),B("div",wve,Z(b.value),1)):_e("",!0),E.value?(L(),B("div",Cve," ✅ PDF uploaded successfully! Secure filename: "+Z(E.value),1)):_e("",!0)]),E.value?(L(),B("div",Ive,[N[10]||(N[10]=d("h3",null,"Download Test PDF",-1)),d("button",{onClick:C,disabled:q(T)},Z(q(T)?"🔄 Downloading...":"📥 Download PDF"),9,kve),_.value?(L(),B("div",Dve,Z(_.value),1)):_e("",!0),v.value?(L(),B("div",Pve," ✅ PDF downloaded successfully! ")):_e("",!0)])):_e("",!0),d("div",Rve,[N[11]||(N[11]=d("h3",null,"Alternative Test: Direct Storage Upload",-1)),N[12]||(N[12]=d("p",{class:"help-text"},"This test bypasses the secure PDF system and uploads directly to storage for comparison.",-1)),d("button",{onClick:F,disabled:!e.value||a.value},Z(a.value?"🔄 Uploading...":"📤 Test Direct Upload"),9,Fve),o.value?(L(),B("div",Nve,Z(o.value),1)):_e("",!0),l.value?(L(),B("div",Ove," ✅ Direct upload successful! This confirms storage permissions are working. ")):_e("",!0)]),d("div",Mve,[N[14]||(N[14]=d("h3",null,"Test Cloud Function: Private URL Generation",-1)),N[15]||(N[15]=d("p",{class:"help-text"},"Test if the cloud function can generate private URLs for existing files.",-1)),d("button",{onClick:W,disabled:c.value},Z(c.value?"🔄 Testing...":"🔗 Test Cloud Function"),9,Lve),u.value?(L(),B("div",Bve,Z(u.value),1)):_e("",!0),f.value?(L(),B("div",Uve,N[13]||(N[13]=[we(" ✅ Cloud function working! Private URL generated successfully. "),d("br",null,null,-1),d("small",null,"URL expires in 5 minutes",-1)]))):_e("",!0)])]))}},Vve=St($ve,[["__scopeId","data-v-4c041459"]]);async function Hve(){var t;console.log("Starting student ID migration...");try{const e=At(qe,"students"),r=await zt(e);console.log(`Found ${r.size} students to migrate`);let n=0,s=0;for(const i of r.docs){const a=i.data(),o=i.id;if(!/^\d+$/.test(o)){console.log(`Student ${o} already uses auto-generated ID, skipping`);continue}const l=o;try{const c=Ze(At(qe,"students")),u={...a,app:{...a.app,studentData:{...(t=a.app)==null?void 0:t.studentData,ssid:l}},migratedFrom:o,migratedAt:new Date().toISOString()};await jt(c,u),await mo(Ze(qe,"students",o)),console.log(`✅ Migrated student ${o} → ${c.id}`),n++}catch(c){console.error(`❌ Failed to migrate student ${o}:`,c),s++}}return console.log(`Migration complete: ${n} migrated, ${s} errors`),{migratedCount:n,errorCount:s}}catch(e){throw console.error("Migration failed:",e),e}}async function jve(){var t,e;console.log("Verifying migration...");try{const r=At(qe,"students"),n=await zt(r);let s=0,i=0;for(const a of n.docs){const o=a.data(),l=a.id,c=(e=(t=o.app)==null?void 0:t.studentData)==null?void 0:e.ssid;c?(console.log(`✅ Student ${l} has SSID: ${c}`),s++):(console.warn(`⚠️ Student ${l} missing SSID in app data`),i++)}return console.log(`Verification complete: ${s} verified, ${i} issues`),{verifiedCount:s,issuesCount:i}}catch(r){throw console.error("Verification failed:",r),r}}async function Gve(){var s,i,a,o;console.log("🔄 Starting period label migration...");const{getNumber:t}=Eo();let e=0,r=0,n=[];try{const l=At(qe,"students"),c=await zt(l);e=c.size,console.log(`📊 Found ${e} students to check`);for(const u of c.docs)try{const f=u.data();let h=!1,p={};const g=((i=(s=f.app)==null?void 0:s.schedule)==null?void 0:i.periods)||f.schedule||{};if(Object.entries(g).forEach(([y,E])=>{if(isNaN(parseInt(y))){const b=t(y);if(b)p[b]=E,h=!0,console.log(`🔧 Converting "${y}" → ${b} for student ${u.id}`);else{const _=y.match(/^(?:period|per)(\d+)$/i);_?(p[parseInt(_[1])]=E,h=!0,console.log(`🔧 Converting "${y}" → ${_[1]} for student ${u.id}`)):(console.warn(`⚠️ Could not convert period key "${y}" for student ${u.id}`),p[y]=E)}}else p[y]=E}),h){const y={};(o=(a=f.app)==null?void 0:a.schedule)!=null&&o.periods?y["app.schedule.periods"]=p:f.schedule&&(y.schedule=p),Object.keys(y).length>0&&(await Fp(Ze(qe,"students",u.id),y),r++,console.log(`✅ Updated student ${u.id}`))}}catch(f){console.error(`❌ Error processing student ${u.id}:`,f),n.push({studentId:u.id,error:f.message})}return console.log("🎉 Migration completed!"),console.log("📈 Results:"),console.log(`   - Total students checked: ${e}`),console.log(`   - Students migrated: ${r}`),console.log(`   - Errors: ${n.length}`),n.length>0&&(console.warn("⚠️ Errors encountered:"),n.forEach(({studentId:u,error:f})=>{console.warn(`   - ${u}: ${f}`)})),{success:!0,totalStudents:e,migratedStudents:r,errors:n}}catch(l){return console.error("💥 Migration failed:",l),{success:!1,error:l.message,totalStudents:e,migratedStudents:r,errors:n}}}async function Wve(){var n,s;console.log("👀 Starting migration preview...");const{getNumber:t}=Eo();let e=0,r=[];try{const i=At(qe,"students"),a=await zt(i);e=a.size;for(const o of a.docs){const l=o.data(),c=((s=(n=l.app)==null?void 0:n.schedule)==null?void 0:s.periods)||l.schedule||{};let u=[];Object.keys(c).forEach(f=>{if(isNaN(parseInt(f))){const h=t(f);if(h)u.push({from:f,to:h});else{const p=f.match(/^(?:period|per)(\d+)$/i);p&&u.push({from:f,to:parseInt(p[1])})}}}),u.length>0&&r.push({id:o.id,name:`${l.firstName||""} ${l.lastName||""}`.trim(),changes:u})}return console.log("📋 Migration Preview Results:"),console.log(`   - Total students: ${e}`),console.log(`   - Students needing migration: ${r.length}`),r.length>0&&(console.log("   - Changes needed:"),r.forEach(o=>{console.log(`     📝 ${o.name} (${o.id}):`),o.changes.forEach(l=>{console.log(`        "${l.from}" → ${l.to}`)})})),{totalStudents:e,studentsNeedingMigration:r,changesNeeded:r.length>0}}catch(i){return console.error("💥 Preview failed:",i),{error:i.message,totalStudents:0,studentsNeedingMigration:[],changesNeeded:!1}}}const zve={class:"testing-view"},Kve={class:"test-section"},qve={class:"status-grid"},Xve={class:"status-item"},Yve={class:"status-item"},Qve={class:"status-item"},Jve={key:0,class:"test-section"},Zve={class:"settings-display"},e1e={class:"setting-group"},t1e={class:"setting-values"},r1e={class:"setting-group"},n1e={class:"setting-values"},s1e={class:"setting-group"},a1e={class:"setting-values"},i1e={class:"setting-group"},o1e={class:"setting-values"},l1e={class:"test-section"},c1e={class:"admin-action-btns"},u1e=["disabled"],d1e=["disabled"],f1e={class:"test-section"},h1e={class:"integration-test"},p1e={key:0,class:"test-form-container"},m1e={class:"test-section"},g1e={class:"admin-action-btns"},v1e=["disabled"],y1e=["disabled"],x1e={key:0,class:"migration-result"},E1e={class:"test-section"},_1e={class:"period-migration-controls"},b1e=["disabled"],S1e=["disabled"],A1e={key:0,class:"migration-result"},T1e={class:"test-section"},w1e={class:"ssid-test-controls"},C1e=["disabled"],I1e={key:0,class:"ssid-test-result"},k1e={class:"test-section"},D1e={__name:"TestingView",setup(t){const{appSettings:e,loadAppSettings:r,resetAppSettings:n,loading:s,error:i}=Ms(),{labels:a}=Eo(),o=se(!1),l=se(!1),c=se(!1),u=se(null),f=se(!1),h=se(null),p=se(!1),g=se(null);Gt(async()=>{console.log("TestingView: Component mounted, checking app settings...")});const y=async()=>{try{await r(),console.log("TestingView: Settings reloaded successfully")}catch(x){console.error("TestingView: Error reloading settings:",x)}},E=async()=>{try{await n(),console.log("TestingView: Settings reset successfully")}catch(x){console.error("TestingView: Error resetting settings:",x)}},b=x=>{console.log("TestingView: Test student saved:",x),o.value=!1},_=async()=>{l.value=!0,u.value=null;try{const x=await Hve();u.value=x,console.log("Migration completed:",x)}catch(x){u.value={error:x.message},console.error("Migration failed:",x)}finally{l.value=!1}},v=async()=>{c.value=!0,u.value=null;try{const x=await jve();u.value=x,console.log("Verification completed:",x)}catch(x){u.value={error:x.message},console.error("Verification failed:",x)}finally{c.value=!1}},A=async()=>{f.value=!0,h.value=null;try{const x=[{sourcedId:"123456789",givenName:"John",familyName:"Doe",specialEducation:"true"},{SSID:"987654321",FirstName:"Jane",LastName:"Smith",IEP:"Yes"},{ssid:"555666777",FirstName:"Bob",LastName:"Johnson",iep:"1"},{StateStudentID:"111222333",FirstName:"Alice",LastName:"Brown",504:"true"}],m={aeriesMapping:{},seisMapping:{},ssidExtraction:{},fieldMapping:{}};x.forEach((I,C)=>{const F={};Object.keys(I).forEach(W=>{F[W]=Hv(W)}),m.aeriesMapping[`row_${C}`]=F}),x.forEach((I,C)=>{const F={};Object.keys(I).forEach(W=>{F[W]=jv(W)}),m.seisMapping[`row_${C}`]=F}),x.forEach((I,C)=>{var W;const F=(W=I.sourcedId||I.SSID||I.ssid||I.StateStudentID||I.stateStudentId)==null?void 0:W.trim();m.ssidExtraction[`row_${C}`]={original:I,extractedSSID:F,success:!!F}});const S=["specialEducation","iep","IEP","plan504","504","disabilities","accommodations"];m.fieldMapping={aeries:S.map(I=>({field:I,mapped:Hv(I)})),seis:S.map(I=>({field:I,mapped:jv(I)}))},h.value={success:!0,message:"SSID resolution test completed successfully",results:m},console.log("SSID resolution test completed:",m)}catch(x){h.value={success:!1,error:x.message,message:"SSID resolution test failed"},console.error("SSID resolution test failed:",x)}finally{f.value=!1}},D=()=>{h.value=null},k=async()=>{p.value=!0,g.value=null;try{console.log("Starting period label migration preview...");const x=await Wve();x.error?g.value=`Preview failed: ${x.error}`:x.changesNeeded?g.value=`Preview completed: ${x.studentsNeedingMigration.length} students need migration (see console for details)`:g.value="No migration needed - all students already use numeric period keys"}catch(x){console.error("Period migration preview failed:",x),g.value=`Preview error: ${x.message}`}finally{p.value=!1}},T=async()=>{if(confirm("This will update period keys from labels to numbers for all students. Continue?")){p.value=!0,g.value=null;try{console.log("Starting period label migration...");const x=await Gve();x.success?(g.value=`Migration completed: ${x.migratedStudents}/${x.totalStudents} students updated`,x.errors.length>0&&(g.value+=` (${x.errors.length} errors - see console)`)):g.value=`Migration failed: ${x.error}`}catch(x){console.error("Period migration failed:",x),g.value=`Migration error: ${x.message}`}finally{p.value=!1}}};return(x,m)=>{var S,I,C,F,W,P;return L(),B("div",zve,[m[21]||(m[21]=d("h2",null,"App Settings Testing",-1)),d("div",Kve,[m[5]||(m[5]=d("h3",null,"App Settings Status",-1)),d("div",qve,[d("div",Xve,[m[2]||(m[2]=d("strong",null,"Loading:",-1)),we(" "+Z(q(s)?"Yes":"No"),1)]),d("div",Yve,[m[3]||(m[3]=d("strong",null,"Error:",-1)),we(" "+Z(q(i)||"None"),1)]),d("div",Qve,[m[4]||(m[4]=d("strong",null,"Loaded:",-1)),we(" "+Z(q(e)&&Object.keys(q(e)).length>0?"Yes":"No"),1)])])]),q(e)?(L(),B("div",Jve,[m[10]||(m[10]=d("h3",null,"Current Settings",-1)),d("div",Zve,[d("div",e1e,[d("h4",null,"Grades ("+Z(((S=q(e).grades)==null?void 0:S.length)||0)+")",1),d("div",t1e,Z(((I=q(e).grades)==null?void 0:I.join(", "))||"None configured"),1)]),d("div",r1e,[d("h4",null,"Class Services ("+Z(((C=q(e).classServices)==null?void 0:C.length)||0)+")",1),d("div",n1e,[(L(!0),B(De,null,$e(q(e).classServices,R=>{var N;return L(),B("div",{key:R.name,class:"service-item"},[d("strong",null,Z(R.name)+":",1),we(" "+Z(((N=R.enabledSubcategories)==null?void 0:N.join(", "))||"None enabled"),1)])}),128))])]),d("div",s1e,[d("h4",null,"Service Providers ("+Z(((F=q(e).serviceProviders)==null?void 0:F.length)||0)+")",1),d("div",a1e,Z(((W=q(e).serviceProviders)==null?void 0:W.join(", "))||"None configured"),1)]),d("div",i1e,[m[9]||(m[9]=d("h4",null,"Periods",-1)),d("div",o1e,[m[6]||(m[6]=d("strong",null,"Number:",-1)),we(" "+Z(q(e).numPeriods||0),1),m[7]||(m[7]=d("br",null,null,-1)),m[8]||(m[8]=d("strong",null,"Labels:",-1)),we(" "+Z(((P=q(a))==null?void 0:P.join(", "))||"None"),1)])])])])):_e("",!0),d("div",l1e,[m[11]||(m[11]=d("h3",null,"Test Actions",-1)),d("div",c1e,[d("button",{onClick:y,disabled:q(s),class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},Z(q(s)?"Loading...":"Reload Settings"),9,u1e),d("button",{onClick:E,disabled:q(s),class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}}," Reset to Defaults ",8,d1e)])]),d("div",f1e,[m[13]||(m[13]=d("h3",null,"Component Integration Test",-1)),d("div",h1e,[m[12]||(m[12]=d("p",null,"This section tests if the StudentForm can access app settings:",-1)),d("button",{onClick:m[0]||(m[0]=R=>o.value=!o.value),class:"btn btn-primary"},Z(o.value?"Hide":"Show")+" Test Student Form ",1),o.value?(L(),B("div",p1e,[Pe(sx,{users:{userRoles:{}},mode:"new",onClose:m[1]||(m[1]=R=>o.value=!1),onSaved:b})])):_e("",!0)])]),d("div",m1e,[m[15]||(m[15]=d("h3",null,"Migration Tools",-1)),d("div",g1e,[d("button",{onClick:_,disabled:l.value,class:"admin-action-btn",style:{"min-width":"160px","max-width":"160px"}},Z(l.value?"Migrating...":"Migrate Student IDs"),9,v1e),d("button",{onClick:v,disabled:c.value,class:"admin-action-btn",style:{"min-width":"140px","max-width":"140px"}},Z(c.value?"Verifying...":"Verify Migration"),9,y1e)]),u.value?(L(),B("div",x1e,[m[14]||(m[14]=d("h4",null,"Migration Result:",-1)),d("pre",null,Z(JSON.stringify(u.value,null,2)),1)])):_e("",!0)]),d("div",E1e,[m[17]||(m[17]=d("h3",null,"Period Label Migration",-1)),d("div",_1e,[d("button",{onClick:k,disabled:p.value,class:"btn btn-secondary"},Z(p.value?"Previewing...":"Preview Period Migration"),9,b1e),d("button",{onClick:T,disabled:p.value,class:"btn btn-warning"},Z(p.value?"Migrating...":"Run Period Migration"),9,S1e)]),g.value?(L(),B("div",A1e,[m[16]||(m[16]=d("h4",null,"Period Migration Result:",-1)),d("p",null,Z(g.value),1)])):_e("",!0)]),d("div",T1e,[m[19]||(m[19]=d("h3",null,"SSID Resolution Test",-1)),d("div",w1e,[d("button",{onClick:A,disabled:f.value,class:"btn btn-primary"},Z(f.value?"Testing...":"Test SSID Resolution"),9,C1e),d("button",{onClick:D,class:"btn btn-secondary"}," Clear Results ")]),h.value?(L(),B("div",I1e,[m[18]||(m[18]=d("h4",null,"SSID Resolution Test Result:",-1)),d("pre",null,Z(JSON.stringify(h.value,null,2)),1)])):_e("",!0)]),d("div",k1e,[m[20]||(m[20]=d("h3",null,"🔒 Secure PDF System Test",-1)),Pe(Vve)])])}}},P1e=St(D1e,[["__scopeId","data-v-16ace2fd"]]),Fo=se({}),mu=se(!1);function R1e(){const t=async()=>{try{const s=Ze(qe,"app_settings","admin_panel_permissions"),i=await qt(s);i.exists()?Fo.value=i.data():Fo.value=n(),mu.value=!0,console.log("Admin permissions loaded:",Fo.value)}catch(s){console.error("Error loading admin permissions:",s),Fo.value=n(),mu.value=!0}},e=(s,i)=>!mu.value||!Fo.value[s]?!1:i==="admin"?!0:Fo.value[s][i]===!0,r=(s,i)=>mu.value?s.filter(a=>i==="admin"?!0:e(a.key,i)):[],n=()=>({dashboard:{school_admin:!0,admin_504:!0,sped_chair:!0},usersAdd:{school_admin:!0,admin_504:!0,sped_chair:!1},usersEdit:{school_admin:!0,admin_504:!0,sped_chair:!0},students:{school_admin:!0,admin_504:!0,sped_chair:!0},addStudents:{school_admin:!0,admin_504:!0,sped_chair:!0},"aide-assignment":{school_admin:!0,admin_504:!0,sped_chair:!0},"aide-schedule":{school_admin:!0,admin_504:!0,sped_chair:!0},"time-table":{school_admin:!0,admin_504:!1,sped_chair:!0},seis:{school_admin:!0,admin_504:!0,sped_chair:!0},aeries:{school_admin:!0,admin_504:!0,sped_chair:!0},"testing-links":{school_admin:!0,admin_504:!1,sped_chair:!0},"teacher-feedback":{school_admin:!0,admin_504:!0,sped_chair:!0},"backup-restore":{school_admin:!0,admin_504:!1,sped_chair:!0},settings:{school_admin:!0,admin_504:!0,sped_chair:!0},permissions:{school_admin:!1,admin_504:!1,sped_chair:!1},"iep-security":{school_admin:!1,admin_504:!1,sped_chair:!1},security:{school_admin:!1,admin_504:!1,sped_chair:!1},"component-health":{school_admin:!1,admin_504:!1,sped_chair:!1}});return{adminPermissions:Se(()=>Fo.value),permissionsLoaded:Se(()=>mu.value),loadPermissions:t,hasPermission:e,getPermittedTabs:r}}const F1e={name:"AdminView",components:{TabBar:GW,UserAddForm:ez,UserTable:Az,AdminStudents:zz,StudentBulkImporter:XK,AdminPermissions:Iq,SeisImport:Gq,AeriesImport:eX,AeriesAPIConnector:cY,AppSettings:pQ,AdminAideAssignment:wI,AdminTimeTable:oD,AdminAideSchedule:xD,AdminBackupRestore:ED,AdminAuditLogs:ude,AdminTeacherFeedback:ufe,TestingLinks:a0e,AdminDashboard:$he,DebugEncryption:bD,SecurityControlCenter:Jpe,ComponentHealthDashboard:Kme,AdminPermissionsMatrix:mge,ThemeManager:cve,TestingView:P1e},setup(){const t=ki(),e=m7(),r=se("dashboard"),n=se("dashboard"),{students:s,fetchStudents:i}=Di(),{users:a,fetchUsers:o}=ba(),l=on(),c=Se(()=>l.currentUser),{loadPermissions:u,getPermittedTabs:f,permissionsLoaded:h}=R1e();Gt(async()=>{try{await Promise.all([i(),o(),u()]),c.value&&await sn.logSystemAccess("admin_panel_access",{userRole:c.value.role,accessTime:new Date().toISOString(),initialCategory:e.query.category||"dashboard"});const x=e.query.category;x&&_(x)}catch(x){console.error("Error loading data:",x)}});const p=[{key:"dashboard",label:"Dashboard",category:"dashboard"},{key:"usersAdd",label:"Add Users",category:"users-students"},{key:"usersEdit",label:"Manage Users",category:"users-students"},{key:"students",label:"Students",category:"users-students"},{key:"addStudents",label:"Add Students",category:"users-students"},{key:"aide-assignment",label:"Aide Assignment",category:"aide-management"},{key:"aide-schedule",label:"Aide Schedule",category:"aide-management",status:"not-working"},{key:"time-table",label:"Time Table",category:"aide-management"},{key:"seis",label:"SEIS Import",category:"data-integration",status:"not-active"},{key:"aeries",label:"Aeries API & Import",category:"data-integration",status:"not-active"},{key:"testing-links",label:"Testing Links",category:"data-integration"},{key:"teacher-feedback",label:"Teacher Feedback Forms",category:"data-integration"},{key:"backup-restore",label:"Backup & Restore",category:"data-integration"},{key:"permissions",label:"Permissions",category:"system-config"},{key:"settings",label:"App Settings",category:"system-config"},{key:"theme",label:"Theme Customization",category:"system-config"},{key:"audit-logs",label:"Audit Logs",category:"monitoring"},{key:"security",label:"Security Controls",category:"monitoring"},{key:"component-health",label:"Component Debug",category:"monitoring"},{key:"app-settings-testing",label:"App Settings Testing",category:"monitoring"}],g=[{key:"admin-permissions",label:"Admin Panel Permissions",category:"monitoring"}],y=Se(()=>{var S;const x=(S=c.value)==null?void 0:S.role;if(!h.value)return[];let m=[...p];return x==="admin"&&(m=[...m,...g]),f(m,x)}),E=x=>y.value.filter(m=>m.category===x),b=x=>E(x).length>0,_=async x=>{n.value=x;const m=E(x);m.length>0&&(r.value=m[0].key),c.value&&await sn.logSystemAccess("admin_category_access",{category:x,userRole:c.value.role,availableTabs:m.map(S=>S.key)})};return{activeTab:r,activeCategory:n,getTabsForCategory:E,categoryHasTabs:b,setActiveCategory:_,handleTabChange:async x=>{r.value=x,c.value&&await sn.logSystemAccess("admin_tab_access",{tab:x,category:n.value,userRole:c.value.role})},goToStudents:()=>{t.push("/students")},goToDashboard:()=>{t.push("/admin/dashboard")},handleGoToCategory:x=>{_(x)},handleBulkImporterClose:()=>{r.value="students"},students:s,userMap:a,currentUser:c,permissionsLoaded:h}}},N1e={class:"admin-header"},O1e={class:"admin-nav"},M1e={class:"admin-actions"},L1e={key:0,class:"sub-tab-container"},B1e={class:"admin-section"},U1e={key:0,class:"admin-section"},$1e={key:1,class:"admin-section"},V1e={key:2,class:"admin-section"},H1e={key:3,class:"admin-section"},j1e={key:4,class:"admin-section"},G1e={key:5,class:"admin-section"},W1e={key:6,class:"admin-section"},z1e={key:7,class:"admin-section"},K1e={key:8,class:"admin-section"},q1e={key:9,class:"admin-section"},X1e={key:10,class:"admin-section"},Y1e={key:11,class:"admin-section"},Q1e={key:12,class:"admin-section"},J1e={key:13,class:"admin-section"},Z1e={key:14,class:"admin-section"},eye={key:15,class:"admin-section"},tye={key:16,class:"admin-section"},rye={key:17,class:"admin-section"},nye={key:18,class:"admin-section"},sye={key:19,class:"admin-section"},aye={key:20,class:"admin-section"},iye={key:21,class:"admin-section"};function oye(t,e,r,n,s,i){const a=_r("TabBar"),o=_r("AdminDashboard"),l=_r("UserAddForm"),c=_r("UserTable"),u=_r("AdminStudents"),f=_r("StudentBulkImporter"),h=_r("AdminPermissions"),p=_r("AdminAideAssignment"),g=_r("AdminAideSchedule"),y=_r("AdminTimeTable"),E=_r("SeisImport"),b=_r("AeriesAPIConnector"),_=_r("AeriesImport"),v=_r("AppSettings"),A=_r("ThemeManager"),D=_r("TestingLinks"),k=_r("AdminTeacherFeedback"),T=_r("AdminBackupRestore"),x=_r("AdminAuditLogs"),m=_r("DebugEncryption"),S=_r("SecurityControlCenter"),I=_r("ComponentHealthDashboard"),C=_r("AdminPermissionsMatrix"),F=_r("TestingView");return L(),B("div",null,[d("div",N1e,[e[8]||(e[8]=d("h1",null,"Admin Panel",-1)),d("div",O1e,[n.categoryHasTabs("dashboard")?(L(),B("button",{key:0,onClick:e[0]||(e[0]=W=>n.setActiveCategory("dashboard")),class:Xe([{active:n.activeCategory==="dashboard"},"category-btn"])}," Dashboard ",2)):_e("",!0),n.categoryHasTabs("users-students")?(L(),B("button",{key:1,onClick:e[1]||(e[1]=W=>n.setActiveCategory("users-students")),class:Xe([{active:n.activeCategory==="users-students"},"category-btn"])}," User & Student ",2)):_e("",!0),n.categoryHasTabs("aide-management")?(L(),B("button",{key:2,onClick:e[2]||(e[2]=W=>n.setActiveCategory("aide-management")),class:Xe([{active:n.activeCategory==="aide-management"},"category-btn"])}," Paraprofessionals ",2)):_e("",!0),n.categoryHasTabs("data-integration")?(L(),B("button",{key:3,onClick:e[3]||(e[3]=W=>n.setActiveCategory("data-integration")),class:Xe([{active:n.activeCategory==="data-integration"},"category-btn"])}," Data & Integration ",2)):_e("",!0),n.categoryHasTabs("system-config")?(L(),B("button",{key:4,onClick:e[4]||(e[4]=W=>n.setActiveCategory("system-config")),class:Xe([{active:n.activeCategory==="system-config"},"category-btn"])}," Configuration ",2)):_e("",!0),n.categoryHasTabs("monitoring")?(L(),B("button",{key:5,onClick:e[5]||(e[5]=W=>n.setActiveCategory("monitoring")),class:Xe([{active:n.activeCategory==="monitoring"},"category-btn"])}," System ",2)):_e("",!0)]),d("div",M1e,[d("button",{onClick:e[6]||(e[6]=(...W)=>n.goToStudents&&n.goToStudents(...W)),class:"return-btn"},e[7]||(e[7]=[d("span",null,"←",-1)]))])]),n.activeCategory?(L(),B("div",L1e,[Pe(a,{tabs:n.getTabsForCategory(n.activeCategory),"active-tab":n.activeTab,onTabChange:n.handleTabChange},null,8,["tabs","active-tab","onTabChange"])])):_e("",!0),d("div",B1e,[n.activeTab==="dashboard"?(L(),B("div",U1e,[Pe(o,{onGoToCategory:n.handleGoToCategory,onGoToStudents:n.goToStudents},null,8,["onGoToCategory","onGoToStudents"])])):_e("",!0),n.activeTab==="usersAdd"?(L(),B("div",$1e,[Pe(l)])):_e("",!0),n.activeTab==="usersEdit"?(L(),B("div",V1e,[Pe(c)])):_e("",!0),n.activeTab==="students"?(L(),B("div",H1e,[Pe(u)])):_e("",!0),n.activeTab==="addStudents"?(L(),B("div",j1e,[Pe(f,{onClose:n.handleBulkImporterClose,onImported:t.handleStudentsImported},null,8,["onClose","onImported"])])):_e("",!0),n.activeTab==="permissions"?(L(),B("div",G1e,[Pe(h)])):_e("",!0),n.activeTab==="aide-assignment"?(L(),B("div",W1e,[Pe(p)])):_e("",!0),n.activeTab==="aide-schedule"?(L(),B("div",z1e,[Pe(g)])):_e("",!0),n.activeTab==="time-table"?(L(),B("div",K1e,[Pe(y)])):_e("",!0),n.activeTab==="seis"?(L(),B("div",q1e,[Pe(E)])):_e("",!0),n.activeTab==="aeries"?(L(),B("div",X1e,[Pe(b),e[9]||(e[9]=d("hr",{style:{margin:"2rem 0",border:"1px solid #ddd"}},null,-1)),Pe(_)])):_e("",!0),n.activeTab==="settings"?(L(),B("div",Y1e,[Pe(v)])):_e("",!0),n.activeTab==="theme"?(L(),B("div",Q1e,[Pe(A)])):_e("",!0),n.activeTab==="testing-links"?(L(),B("div",J1e,[Pe(D,{students:n.students,userMap:n.userMap},null,8,["students","userMap"])])):_e("",!0),n.activeTab==="teacher-feedback"?(L(),B("div",Z1e,[Pe(k)])):_e("",!0),n.activeTab==="backup-restore"?(L(),B("div",eye,[Pe(T)])):_e("",!0),n.activeTab==="audit-logs"?(L(),B("div",tye,[Pe(x)])):_e("",!0),n.activeTab==="iep-security"?(L(),B("div",rye,[e[10]||(e[10]=d("h2",null,"IEP Data Security",-1)),Pe(m,{"selected-student":t.currentStudent},null,8,["selected-student"])])):_e("",!0),n.activeTab==="security"?(L(),B("div",nye,[Pe(S,{"selected-student":t.currentStudent},null,8,["selected-student"])])):_e("",!0),n.activeTab==="component-health"?(L(),B("div",sye,[Pe(I)])):_e("",!0),n.activeTab==="admin-permissions"?(L(),B("div",aye,[Pe(C)])):_e("",!0),n.activeTab==="app-settings-testing"?(L(),B("div",iye,[Pe(F)])):_e("",!0)])])}const lye=St(F1e,[["render",oye],["__scopeId","data-v-4b2c9f35"]]),cye={class:"aide-schedule-view"},uye={class:"header"},dye={class:"user-info"},fye={class:"content"},hye={key:0,class:"error-message"},pye={key:1,class:"error-message"},mye={key:2,class:"loading"},gye={key:3,class:"schedule-container"},vye={class:"schedule-display"},yye={class:"schedule-timeline"},xye={class:"time-info"},Eye={class:"time"},_ye={class:"type-badge"},bye={class:"assignment-info"},Sye={key:0},Aye={key:1,class:"no-assignment"},Tye={class:"schedule-editor"},wye={class:"editor-content"},Cye={class:"time-block-header"},Iye={class:"time"},kye={class:"type-badge"},Dye={class:"assignment-editor"},Pye=["onUpdate:modelValue"],Rye=["value"],Fye=["value"],Nye={class:"editor-actions"},Oye=["disabled"],Mye={key:0},Lye={key:1},Bye={__name:"AideScheduleView",setup(t){const e=ki(),r=on(),{userList:n,fetchUsers:s}=ba(),{students:i,fetchStudents:a}=Di(),{loadAppSettings:o,saveAppSettings:l}=Ms(),c=se(!0),u=se(!1),f=se({}),h=se({}),p=Se(()=>{var k;return((k=r.currentUser)==null?void 0:k.role)==="paraeducator"}),g=Se(()=>{var k;return(k=r.currentUser)==null?void 0:k.uid}),y=Se(()=>{var k;return((k=n.value)==null?void 0:k.filter(T=>T.role==="teacher"))||[]});async function E(){var k;try{const T=await qt(Ze(qe,"app_settings","global"));if(T.exists()){const x=T.data();f.value=((k=x.timeTables)==null?void 0:k[0])||x.timeTable||{}}}catch(T){console.error("Error loading time table:",T)}}function b(){return f.value.schedule?f.value.schedule.map((k,T)=>({...k,id:k.id||`block-${T}`,assignments:h.value[k.id||`block-${T}`]||{}})):[]}function _(){return b().map(T=>{const x=T.assignments[g.value];let m="";if(x){if(x.startsWith("teacher:")){const S=x.replace("teacher:",""),I=y.value.find(C=>C.id===S);m=I?I.name||I.email:"Unknown Teacher"}else if(x.startsWith("student:")){const S=x.replace("student:",""),I=i.value.find(C=>C.id===S);m=I?`${it(I,"firstName")} ${it(I,"lastName")}`:"Unknown Student"}}return{...T,assignment:m}})}async function v(){try{u.value=!0;const k=await o(),T={...k.detailedAideSchedule};b().forEach(m=>{T[m.id]||(T[m.id]={}),T[m.id][g.value]=m.assignments[g.value]});const x={...k,detailedAideSchedule:T};await l(x),console.log("My schedule saved successfully")}catch(k){console.error("Error saving my schedule:",k)}finally{u.value=!1}}function A(){r.logout(),e.push("/login")}async function D(){try{c.value=!0,await Promise.all([s(),a(),o(),E()]);const k=await qt(Ze(qe,"app_settings","global"));if(k.exists()){const T=k.data();h.value=T.detailedAideSchedule||{}}c.value=!1}catch(k){console.error("Error loading aide schedule data:",k),c.value=!1}}return Gt(D),(k,T)=>{var x,m;return L(),B("div",cye,[d("div",uye,[T[2]||(T[2]=d("h1",null,"My Schedule",-1)),d("div",dye,[d("span",null,Z(((x=q(r).currentUser)==null?void 0:x.name)||((m=q(r).currentUser)==null?void 0:m.email)),1),d("button",{onClick:A,class:"btn btn-secondary"}," Logout ")])]),d("div",fye,[q(r).currentUser?p.value?c.value?(L(),B("div",mye," Loading your schedule... ")):(L(),B("div",gye,[d("div",vye,[T[7]||(T[7]=d("h2",null,"My Daily Schedule",-1)),d("div",yye,[(L(!0),B(De,null,$e(_(),S=>(L(),B("div",{key:S.id,class:Xe(["time-block",S.type])},[d("div",xye,[d("span",Eye,Z(S.startTime)+" - "+Z(S.endTime),1),d("span",_ye,Z(S.type),1)]),d("div",bye,[S.assignment?(L(),B("span",Sye,Z(S.assignment),1)):(L(),B("span",Aye,"No Assignment"))])],2))),128))])]),d("div",Tye,[T[9]||(T[9]=d("h2",null,"Edit My Schedule",-1)),d("div",wye,[(L(!0),B(De,null,$e(b(),S=>(L(),B("div",{key:S.id,class:"time-block-editor"},[d("div",Cye,[d("span",Iye,Z(S.startTime)+" - "+Z(S.endTime),1),d("span",kye,Z(S.type),1)]),d("div",Dye,[Ne(d("select",{"onUpdate:modelValue":I=>S.assignments[g.value]=I,class:"assignment-select"},[T[8]||(T[8]=d("option",{value:""},"No Assignment",-1)),(L(!0),B(De,null,$e(y.value,I=>(L(),B("option",{key:I.id,value:`teacher:${I.id}`},Z(I.name||I.email),9,Rye))),128)),(L(!0),B(De,null,$e(q(i),I=>(L(),B("option",{key:I.id,value:`student:${I.id}`},Z(q(it)(I,"firstName"))+" "+Z(q(it)(I,"lastName")),9,Fye))),128))],8,Pye),[[sr,S.assignments[g.value]]])])]))),128))]),d("div",Nye,[d("button",{onClick:v,class:"btn btn-primary",disabled:u.value},[u.value?(L(),B("span",Mye,"💾")):(L(),B("span",Lye,"💾")),we(" "+Z(u.value?"Saving...":"Save My Schedule"),1)],8,Oye)])])])):(L(),B("div",pye,[T[5]||(T[5]=d("h2",null,"Access Denied",-1)),T[6]||(T[6]=d("p",null,"This page is only available to paraeducators.",-1)),d("button",{onClick:T[1]||(T[1]=S=>q(e).push("/")),class:"btn btn-primary"},"Go Home")])):(L(),B("div",hye,[T[3]||(T[3]=d("h2",null,"Authentication Required",-1)),T[4]||(T[4]=d("p",null,"Please log in to access this page.",-1)),d("button",{onClick:T[0]||(T[0]=S=>q(e).push("/login")),class:"btn btn-primary"},"Go to Login")]))])])}}},Uye=St(Bye,[["__scopeId","data-v-f2c7a0cd"]]),$ye=t=>{t.beforeEach(async(e,r,n)=>{const s=on();if(e.path==="/login"||!e.meta.requiresAuth)return n();if(!s.isLoading&&s.currentUser&&s.currentUser.role)return e.meta.allowedRoles&&!e.meta.allowedRoles.includes(s.currentUser.role)?(console.log("🚪 User role not allowed for route - redirecting to students"),n("/students")):n();let i=0;for(;s.isLoading&&i<100;)await new Promise(a=>setTimeout(a,50)),i++;if(s.isLoading)return console.log("🚪 Auth loading timeout - redirecting to login"),n("/login");if(!s.currentUser)return console.log("🚪 No authenticated user - redirecting to login"),n("/login");if(!s.currentUser.role)return console.log("🚪 User has no role - redirecting to login"),n("/login");if(e.meta.allowedRoles&&!e.meta.allowedRoles.includes(s.currentUser.role))return console.log("🚪 User role not allowed for route - redirecting to students"),n("/students");n()}),console.log("Router guards setup completed")},Vye=[{path:"/login",name:"Login",component:UW},{path:"/",name:"Home",redirect:"/students"},{path:"/students",name:"Students",component:MW,meta:{requiresAuth:!0,allowedRoles:y7}},{path:"/admin",name:"Admin",component:lye,meta:{requiresAuth:!0,allowedRoles:lu}},{path:"/admin/aide-assignment",name:"AdminAideAssignment",component:wI,meta:{requiresAuth:!0,allowedRoles:lu}},{path:"/admin/time-table",name:"AdminTimeTable",component:oD,meta:{requiresAuth:!0,allowedRoles:lu}},{path:"/admin/aide-schedule",name:"AdminAideSchedule",component:xD,meta:{requiresAuth:!0,allowedRoles:lu}},{path:"/admin/backup-restore",name:"AdminBackupRestore",component:ED,meta:{requiresAuth:!0,allowedRoles:lu}},{path:"/aide-schedule",name:"AideSchedule",component:Uye,meta:{requiresAuth:!0,allowedRoles:["paraeducator"]}}],SD=h7({history:HL("/"),routes:Vye});$ye(SD);const Lx=J0(MB),Hye=yF();Lx.use(SD);Lx.use(Hye);Lx.mount("#app");
//# sourceMappingURL=index-DeSqPPcX.js.map
